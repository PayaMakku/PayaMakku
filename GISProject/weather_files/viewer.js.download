//>>built
/*
 @esri/arcgis-html-sanitizer - v2.9.0-next.1 - Tue Oct 19 2021 10:19:42 GMT-0400 (Eastern Daylight Time)
 Copyright (c) 2021 - Environmental Systems Research Institute, Inc.
 Apache-2.0

 js-xss
 Copyright (c) 2012-2017 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 http://ucdok.com
 MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details

 Lodash/isPlainObject
 Copyright (c) JS Foundation and other contributors <https://js.foundation/>
 MIT License, see https://raw.githubusercontent.com/lodash/lodash/4.17.10-npm/LICENSE for details
*/
require({cache:{"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/a11yclick dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager dojo/i18n!./nls/jsapi".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v){var A={up:"panUp",right:"panRight",down:"panDown",
left:"panLeft"},B={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},E=D.connect,G=D.disconnect,I=b.create,L=h.set,K=z.hitch,ba=c.getMarginBox,T=m.deprecated,P=z.mixin,J=0;m=a(x,{declaredClass:"esri.Map",constructor:function(N,Z){Z=Z||{};P(this,{_slider:null,_navDiv:null,_mapParams:P({attributionWidth:.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},Z)});P(this,{isMapNavigation:null!=
Z.isMapNavigation?Z.isMapNavigation:!0,isDoubleClickZoom:null!=Z.isDoubleClickZoom?Z.isDoubleClickZoom:!0,isClickRecenter:null!=Z.isClickRecenter?Z.isClickRecenter:!0,isPan:null!=Z.isPan?Z.isPan:!0,isRubberBandZoom:null!=Z.isRubberBandZoom?Z.isRubberBandZoom:!0,isPinchZoom:null!=Z.isPinchZoom?Z.isPinchZoom:!0,isKeyboardNavigation:null!=Z.isKeyboardNavigation?Z.isKeyboardNavigation:!0,isScrollWheel:null!=Z.isScrollWheel?Z.isScrollWheel:!0,isShiftDoubleClickZoom:!1,isScrollWheelZoom:!1,isPanArrows:!1,
isZoomSlider:!1});z.isFunction(w._css)&&(w._css=w._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);var Y=C("esri-transforms")&&C("esri-transitions");this.navigationMode=this._mapParams.navigationMode||Y&&"css-transforms"||"classic";"css-transforms"!==this.navigationMode||Y||(this.navigationMode="classic");this.fadeOnZoom=u.isDefined(this._mapParams.fadeOnZoom)?this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode;"css-transforms"!==this.navigationMode&&
(this.fadeOnZoom=!1);this.setMapCursor("default");this.smartNavigation=Z&&Z.smartNavigation;if(!(u.isDefined(this.smartNavigation)||!C("mac")||C("esri-touch")||C("esri-pointer")||3.5>=C("ff"))){var qa=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|_)([\d]+)\D/i);qa&&u.isDefined(qa[1])&&u.isDefined(qa[3])&&(Y=parseInt(qa[1],10),qa=parseInt(qa[3],10),this.smartNavigation=10<Y||10===Y&&6<=qa)}this.showAttribution=u.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=
E(this,"onLoad",this,"_onLoadInitNavsHandler");var V=I("div",{"class":"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(Y=z.getObject("esri.dijit.Attribution",!1))this._initAttribution(Y,V);else{var na=J++,ya=this;this._rids&&this._rids.push(na);F(["./dijit/Attribution"],function(S){var ma=ya._rids?y.indexOf(ya._rids,na):-1;-1!==ma&&(ya._rids.splice(ma,1),ya._initAttribution(S,V))})}this._mapParams.logo&&(Y={},6===C("ie")&&(Y.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+
F.toUrl("./images/map/logo-med.png")+"')"),this._ogol=I("div",{style:Y,tabIndex:"0",title:"Esri"},V),this._setLogoSize(),this._onMapResizeLogo_connect=E(this,"onResize",this,"_setLogoSize"),this._ogol_connect=E(this._ogol,g,this,"_openLogoLink"));this.navigationManager=new l(this);Z&&Z.basemap&&(this._onLoadFix=!0,this.setBasemap(Z.basemap),this._onLoadFix=!1);if(this.autoResize=this._mapParams.autoResize)Y=this._getEnclosingResizableWidget(this.container)||window,qa=this.resize,this._rszSignal=q.pausable(Y,
"resize",qa),this._oriSignal=q.pausable(window,"orientationchange",qa),n.after(Y,"resize",qa,!0),this._startResizeTimer()},_startResizeTimer:function(){clearTimeout(this._persistentTimer);this._persistentTimer=setTimeout(this._timedResize,2*this.resizeDelay)},_getEnclosingResizableWidget:function(N){var Z=k.getEnclosingWidget(N);return Z?Z.resize?Z:this._getEnclosingResizableWidget(N.parentNode):Z},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(e.remove(this._ogol,
"logo-med"),e.add(this._ogol,"logo-sm")):(e.remove(this._ogol,"logo-sm"),e.add(this._ogol,"logo-med")))},_initAttribution:function(N,Z){var Y=I("span",{"class":"esriAttribution"},Z,"first");L(Y,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(E(Y,g,function(){e.contains(this,"esriAttributionOpen")?e.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&e.add(this,"esriAttributionOpen")}));this.attribution=new N({map:this},Y)},_cleanUp:function(){this.disableMapNavigation();
this.navigationManager.destroy();var N=this._slider;N&&N.destroy&&!N._destroyed&&N.destroy();N=this._navDiv;var Z=this.attribution;N&&b.destroy(N);Z&&Z.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);y.forEach(this._connects,G);clearInterval(this._persistentTimer);this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=this._persistentTimer=null;this.inherited("_cleanUp",
arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(N){var Z=this.getLevel();return!this.__tileInfo||!(Z===this.getMinZoom()&&0>N||Z===this.getMaxZoom()&&0<N)},_onLoadInitNavsHandler:function(){this._evalMapNavigation();this._createNav();if("small"===this._mapParams.sliderStyle||!this._createSlider)this._createSimpleSlider();else if(this._mapParams.slider){var N=-1!==this._getSliderClass(!0).indexOf("Horizontal");N=[N?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",
N?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",N?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];if(y.some(N,function(qa){return!z.getObject(qa,!1)})){N=y.map(N,function(qa){return qa.replace(/\./g,"/")});var Z=J++,Y=this;this._rids&&this._rids.push(Z);F(N,function(){var qa=Y._rids?y.indexOf(Y._rids,Z):-1;-1!==qa&&(Y._rids.splice(qa,1),Y._createSlider.apply(Y,arguments))})}else N=y.map(N,function(qa){return z.getObject(qa,!1)}),this._createSlider.apply(this,N)}G(this._onLoadHandler_connect)},
_createNav:function(){if(this._mapParams.nav){var N,Z=e.add,Y=this.id;this._navDiv=I("div",{id:Y+"_navdiv"},this.root);Z(this._navDiv,"navDiv");var qa=this.width/2,V=this.height/2;for(N in A){var na=A[N];var ya=I("div",{id:Y+"_pan_"+N},this._navDiv);Z(ya,"fixedPan "+na);if("up"===N||"down"===N){var S=parseInt(ba(ya).w,10)/2;L(ya,{left:qa-S+"px",zIndex:30})}else S=parseInt(ba(ya).h,10)/2,L(ya,{top:V-S+"px",zIndex:30});this._connects.push(E(ya,"onclick",K(this,this[na])))}this._onMapResizeNavHandler_connect=
E(this,"onResize",this,"_onMapResizeNavHandler");for(N in B)na=B[N],ya=I("div",{id:Y+"_pan_"+N,style:{zIndex:30}},this._navDiv),Z(ya,"fixedPan "+na),this._connects.push(E(ya,"onclick",K(this,this[na])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(N,Z,Y){N=this.id;Z/=2;Y/=2;var qa=f.byId,V;for(V in A){var na=qa(N+"_pan_"+V);if("up"===V||"down"===V){var ya=parseInt(ba(na).w,10)/2;L(na,"left",Z-ya+"px")}else ya=parseInt(ba(na).h,10)/2,L(na,"top",Y-ya+"px")}},_createSimpleSlider:function(){if(this._mapParams.slider){var N=
this._slider=I("div",{id:this.id+"_zoom_slider","class":this._getSliderClass(),style:{zIndex:30}}),Z=I("div",{"class":"esriSimpleSliderIncrementButton",tabIndex:"0",role:"button"},N),Y=I("div",{"class":"esriSimpleSliderDecrementButton",tabIndex:"0",role:"button"},N);this._addZoomButtonTooltips(Z,Y);this._incButton=Z;this._decButton=Y;this._simpleSliderZoomHandler(null,null,null,this.getLevel());var qa=v.widgets.zoomSlider;this._addZoomButtonIcon(Z,"+",qa.zoomIn);this._addZoomButtonIcon(Y,"\x26minus;",
qa.zoomOut);8>C("ie")&&e.add(Y,"dj_ie67Fix");this._connects.push(E(Z,g,this,this._simpleSliderChangeHandler));this._connects.push(E(Y,g,this,this._simpleSliderChangeHandler));(-1<this.getMaxZoom()||-1<this.getMinZoom())&&this._connects.push(E(this,"onZoomEnd",this,this._simpleSliderZoomHandler));10>C("ie")&&f.setSelectable(N,!1);this.root.appendChild(N);this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(N){r.stop(N);N=-1!==N.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:N?
1:-1})},_simpleSliderZoomHandler:function(N,Z,Y,qa){var V;N=this._incButton;Z=this._decButton;-1<qa&&qa===this.getMaxZoom()?V=N:-1<qa&&qa===this.getMinZoom()&&(V=Z);V?(e.add(V,"esriSimpleSliderDisabledButton"),e.remove(V===N?Z:N,"esriSimpleSliderDisabledButton")):(e.remove(N,"esriSimpleSliderDisabledButton"),e.remove(Z,"esriSimpleSliderDisabledButton"))},_getSliderClass:function(N){N=N?"Large":"Simple";var Z=this._mapParams.sliderOrientation,Y=this._mapParams.sliderPosition||"";Z=Z&&"horizontal"===
Z.toLowerCase()?"esri"+N+"SliderHorizontal":"esri"+N+"SliderVertical";if(Y)switch(Y.toLowerCase()){case "top-left":Y="esri"+N+"SliderTL";break;case "top-right":Y="esri"+N+"SliderTR";break;case "bottom-left":Y="esri"+N+"SliderBL";break;case "bottom-right":Y="esri"+N+"SliderBR"}return"esri"+N+"Slider "+Z+" "+Y},_addZoomButtonIcon:function(N,Z,Y){b.create("span",{"aria-hidden":"true",role:"presentation",innerHTML:Z},N);b.create("span",{"class":"esriIconFallbackText",innerHTML:Y},N)},_addZoomButtonTooltips:function(N,
Z){var Y=v.widgets.zoomSlider;d.set(N,"title",Y.zoomIn);d.set(Z,"title",Y.zoomOut)},_createSlider:function(N,Z,Y){if(this._mapParams.slider){var qa=I("div",{id:this.id+"_zoom_slider"},this.root),V=t.defaults.map,na=this._getSliderClass(!0),ya=-1!==na.indexOf("Horizontal"),S=this.getNumLevels();if(0<S){var ma,ja,X=this._mapParams.sliderLabels,oa=!!X,xa=!1!==X;if(xa){var Ha=ya?"bottomDecoration":"rightDecoration";if(!X)for(X=[],V=0;V<S;V++)X[V]="";y.forEach([{"class":"esriLargeSliderTicks",container:Ha,
count:S,dijitClass:Z},{"class":oa&&"esriLargeSliderLabels",container:Ha,count:S,labels:X,dijitClass:Y}],function(ia){var ea=I("div"),za=ia.dijitClass;delete ia.dijitClass;qa.appendChild(ea);za===Z?ma=new za(ia,ea):ja=new za(ia,ea)})}N=this._slider=new N({id:qa.id,"class":na,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),discreteValues:S,value:this.getLevel(),clickSelect:!0,intermediateChanges:!0,style:"z-index:30;"},qa);N.startup();xa&&(ma.startup(),ja.startup());this._slider_connect=E(N,"onChange",
this,"_onSliderChangeHandler");this._connects.push(E(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(E(N._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{N=this._slider=new N({id:qa.id,"class":na,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:V.sliderChangeImmediate,style:"height:50px; z-index:30;"},qa);Y=N.domNode.firstChild.childNodes;for(V=1;3>=V;V++)L(Y[V],"visibility","hidden");N.startup();this._slider_connect=E(N,
"onChange",this,"_onDynSliderChangeHandler");this._connects.push(E(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}V=N.incrementButton;Y=N.decrementButton;ya?this._addZoomButtonTooltips(V,Y):this._addZoomButtonTooltips(Y,V);V.style.outline="none";Y.style.outline="none";N.sliderHandle.style.outline="none";N._onKeyPress=function(){};if(ya=N._movable){var Ia=ya.onMouseDown;ya.onMouseDown=function(ia){9>C("ie")&&1!==ia.button||Ia.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){G(this._slider_connect);
G(this._slidermovestop_connect);this._slider_connect=E(this._slider,"onChange",this,"_onSliderChangeDragHandler");this._slidermovestop_connect=E(this._slider._movable,"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(N){this._extentUtil({targetLevel:N})},_onSliderMoveEndHandler:function(){G(this._slider_connect);G(this._slidermovestop_connect)},_onSliderChangeHandler:function(N){this.setLevel(N)},_updateSliderValue:function(N,Z){G(this._slider_connect);var Y=this._slider,
qa=Y._onChangeActive;Y._onChangeActive=!1;Y.set("value",N);Y._onChangeActive=qa;this._slider_connect=E(Y,"onChange",this,Z)},_onExtentChangeSliderHandler:function(N,Z,Y,qa){G(this._slidermovestop_connect);this._updateSliderValue(qa.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(N){this._extentUtil({numLevels:0<N?1:-1})},_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(N){window.open(t.defaults.map.logoLink,
"_blank");r.stop(N)},enableMapNavigation:function(){this.isMapNavigation||(this.isMapNavigation=!0,this._evalMapNavigation())},disableMapNavigation:function(){this.isMapNavigation&&(this.isMapNavigation=!1,this._evalMapNavigation())},_evalMapNavigation:function(){this.isMapNavigation?this.navigationManager.enableNavigation():this.navigationManager.disableNavigation()},_evalNavigationFeature:function(N){if(this.isMapNavigation&&this["is"+N])this.navigationManager["enable"+N]();else this.navigationManager["disable"+
N]()},enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.isDoubleClickZoom=!0,this._evalNavigationFeature("DoubleClickZoom"))},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&(this.isDoubleClickZoom=!1,this._evalNavigationFeature("DoubleClickZoom"))},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(T(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),
this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(T(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!1)},enableClickRecenter:function(){this.isClickRecenter||(this.isClickRecenter=!0,this._evalNavigationFeature("ClickRecenter"))},disableClickRecenter:function(){this.isClickRecenter&&
(this.isClickRecenter=!1,this._evalNavigationFeature("ClickRecenter"))},enablePan:function(){this.isPan||(this.isPan=!0,this._evalNavigationFeature("Pan"))},disablePan:function(){this.isPan&&(this.isPan=!1,this._evalNavigationFeature("Pan"))},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.isRubberBandZoom=!0,this._evalNavigationFeature("RubberBandZoom"))},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.isRubberBandZoom=!1,this._evalNavigationFeature("RubberBandZoom"))},
enablePinchZoom:function(){this.isPinchZoom||(this.isPinchZoom=!0,this._evalNavigationFeature("PinchZoom"))},disablePinchZoom:function(){this.isPinchZoom&&(this.isPinchZoom=!1,this._evalNavigationFeature("PinchZoom"))},enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.isKeyboardNavigation=!0,this._evalNavigationFeature("KeyboardNavigation"))},disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.isKeyboardNavigation=!1,this._evalNavigationFeature("KeyboardNavigation"))},
enableScrollWheel:function(){this.isScrollWheel||(this.isScrollWheel=!0,this._evalNavigationFeature("ScrollWheel"))},disableScrollWheel:function(){this.isScrollWheel&&(this.isScrollWheel=!1,this._evalNavigationFeature("ScrollWheel"))},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&(this.navigationManager.disableScrollWheelZoom(),this.isScrollWheelZoom=!1)},
enableScrollWheelPan:function(){this.isScrollWheelPan||this.navigationManager.enableScrollWheelPan()},disableScrollWheelPan:function(){this.isScrollWheelPan&&this.navigationManager.disableScrollWheelPan()},showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display="none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&(L(this._slider.domNode||this._slider,"visibility","inherit"),
this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(L(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=!1)},onClick:function(N){N.graphic||(N.graphic=this.syncHitTestForWebGL(N))}});return w.Map=m})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(F,m,a){F=function(){return this}();var D=F.location,z=D.pathname;a=D.protocol;D={version:"3.40",_appBaseUrl:a+"//"+D.host+z.substring(0,z.lastIndexOf(z.split("/")[z.split("/").length-
1]))};m.noGlobals||(F.esri=D);(D.dijit=D.dijit||{})._arcgisUrl=("http:"===a||"https:"===a?a:"http:")+"//www.arcgis.com/sharing/rest";return D})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(F,m,a,D){a=function(){return this}();var z={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,
labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,zoomAnimationThrottled:!1,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:a.Worker&&!1,io:{errorHandler:function(y,r){m.publish("esri.Error",[y])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",corsEnabledServers:[/^https?:\/\/.+\.arcgis\.com(\/|$)/i,
"server.arcgisonline.com","services.arcgisonline.com","www.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","tiles.arcgis.com","tiles1.arcgis.com","tiles2.arcgis.com","tiles3.arcgis.com","tiles4.arcgis.com","basemaps.arcgis.com","basemapsbeta.arcgis.com","basemaps-api.arcgis.com","elevation3d.arcgis.com","services.arcgis.com","services1.arcgis.com","services2.arcgis.com","services3.arcgis.com","services4.arcgis.com","services5.arcgis.com","services6.arcgis.com","services7.arcgis.com",
"services8.arcgis.com","services9.arcgis.com","cdn.arcgis.com","cdn-a.arcgis.com","cdn-b.arcgis.com","static.arcgis.com","utility.arcgis.com","utility.arcgisonline.com","geocode.arcgis.com","geoenrich.arcgis.com","qaext.arcgis.com","staticqa.arcgis.com","tilesqa.arcgis.com","servicesqa.arcgis.com","servicesqa1.arcgis.com","servicesqa2.arcgis.com","servicesqa3.arcgis.com","geocodeqa.arcgis.com","geoenrichqa.arcgis.com","dev.arcgis.com","devext.arcgis.com","localvtiles.arcgis.com","staticdev.arcgis.com",
"tilesdevext.arcgis.com","elevation3ddev.arcgis.com","servicesdev.arcgis.com","servicesdev1.arcgis.com","servicesdev2.arcgis.com","servicesdev3.arcgis.com","geocodedev.arcgis.com","geoenrichdev.arcgis.com","basemapsdev.arcgis.com","basemapsdev-api.arcgis.com","basemapsbetadev.arcgis.com"],corsDetection:a.cordova?!1:!0,corsDetectionTimeout:15,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},
workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}}}};D.config=z;F.noGlobals||(a.esriConfig=z);return z})},"esri/sniff":function(){define(["dojo/_base/sniff","dojo/global","./kernel"],function(F,m,a){var D=F("ff"),z=F("ie"),y=void 0===z&&7<=F("trident"),r=F("edge"),q=F("webkit"),n=F("opera"),f=F("chrome"),d=F("safari"),e=navigator.userAgent,b;(b=e.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+_\d+)/i))&&F.add("esri-iphone",parseFloat(b[2].replace("_",".")));(b=e.match(/Android\s+(\d+(\.\d+)*)/i))&&
F.add("esri-android",parseFloat(b[1]));(b=e.match(/Fennec\/(\d+\.\d+)/i))&&F.add("esri-fennec",parseFloat(b[1]));0<=e.indexOf("BlackBerry")&&0<=e.indexOf("WebKit")&&F.add("esri-blackberry",1);F.add("esri-touch",F("esri-iphone")||F("esri-android")||F("esri-blackberry")||6<=F("esri-fennec")||(D||q)&&(document.createTouch||"ontouchstart"in m||m.TouchEvent&&0<navigator.maxTouchPoints)?!0:!1);(b=e.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&F.add("esri-mobile",!!b);F.add("esri-pointer",
!D&&(navigator.pointerEnabled||navigator.msPointerEnabled||!!m.PointerEvent));a._getDOMAccessor=function(h){var g="";D?g="Moz":q?g="Webkit":z?g="ms":n&&(g="O");return g+h.charAt(0).toUpperCase()+h.substr(1)};F.add("esri-phonegap",!!m.cordova);F.add("esri-cors",F("esri-phonegap")||m.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);F.add("esri-file-upload",m.FormData&&m.FileList?!0:!1);F.add("esri-script-sandbox",function(){return"MessageChannel"in m&&"HTMLIFrameElement"in m&&"sandbox"in HTMLIFrameElement.prototype});
F.add("esri-secure-context",function(){if("isSecureContext"in m)return m.isSecureContext;if(m.location&&m.location.origin)return 0===m.location.origin.indexOf("https:")});F.add("esri-wasm","WebAssembly"in m);F.add("esri-workers",m.Worker?!0:!1);F.add("esri-featurelayer-webgl",!1);if(e=F("esri-featurelayer-webgl")){var c=F("esri-mobile");b=c?1:2;c=c?1:3;"object"===typeof e?(e.maxDrillLevel=null==e.maxDrillLevel?b:e.maxDrillLevel,e.maxRecordCountFactor=null==e.maxRecordCountFactor?c:e.maxRecordCountFactor,
e.enablePBFQuery=null==e.enablePBFQuery?!0:e.enablePBFQuery):F.add("esri-featurelayer-webgl",{maxDrillLevel:b,maxRecordCountFactor:c,enablePBFQuery:!0},null,!0)}F.add("esri-featurelayer-webgl-labeling",!1);F.add("esri-pbf",!z||10<=z);F.add("esri-featurelayer-pbf",!0);F.add("esri-transforms",y||r||9<=z||3.5<=D||4<=f||3.1<=d||10.5<=n||3.2<=F("esri-iphone")||2.1<=F("esri-android"));F.add("esri-transitions",y||r||10<=z||4<=D||4<=f||3.1<=d||10.5<=n||3.2<=F("esri-iphone")||2.1<=F("esri-android"));F.add("esri-transforms3d",
y||r||10<=D||12<=f||4<=d||3.2<=F("esri-iphone")||3<=F("esri-android"));F.add("esri-url-encodes-apostrophe",function(){if(!m.document)return!1;var h=m.document.createElement("a");h.href="?'";return-1<h.href.indexOf("?%27")});3>F("esri-android")&&(F.add("esri-transforms",!1,!1,!0),F.add("esri-transitions",!1,!1,!0),F.add("esri-transforms3d",!1,!1,!0));F.add("esri-will-change",F("esri-transforms")&&(52<=f||11.1<=d));a._css=function(h){var g=F("esri-transforms3d");void 0!==h&&null!==h?g=h:g&&(f||d&&!F("esri-iphone"))&&
(g=!1);var k=g?"translate3d(":"translate(",w=g?f?",-1px)":",0px)":")",t=g?"scale3d(":"scale(",C=g?",1)":")",u=g?"rotate3d(0,0,1,":"rotate(",x=g?"matrix3d(":"matrix(",l=g?",0,0,":",",v=g?",0,0,0,0,1,0,":",",A=g?",0,1)":")";return{names:{transition:q&&"-webkit-transition"||D&&"MozTransition"||n&&"OTransition"||z&&"msTransition"||"transition",transform:q&&"-webkit-transform"||D&&"MozTransform"||n&&"OTransform"||z&&"msTransform"||"transform",transformName:q&&"-webkit-transform"||D&&"-moz-transform"||
n&&"-o-transform"||z&&"-ms-transform"||"transform",origin:q&&"-webkit-transform-origin"||D&&"MozTransformOrigin"||n&&"OTransformOrigin"||z&&"msTransformOrigin"||"transformOrigin",endEvent:q&&"webkitTransitionEnd"||D&&"transitionend"||n&&"oTransitionEnd"||z&&"MSTransitionEnd"||"transitionend"},translate:function(B,E){return k+B+"px,"+E+"px"+w},scale:function(B){return t+B+","+B+C},rotate:function(B){return u+B+"deg)"},matrix:function(B){return x+B.xx+","+B.xy+l+B.yx+","+B.yy+v+B.dx.toFixed(10)+(D&&
59>=D?"px,":",")+B.dy.toFixed(10)+(D&&59>=D?"px":"")+A},getScaleFromMatrix:function(B){if(!B)return 1;B=B.toLowerCase();var E=-1<B.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(B.substring(E.length,B.indexOf(",")))}}};a.isiPhone=F("esri-iphone");a.isAndroid=F("esri-android");a.isFennec=F("esri-fennec");a.isBlackBerry=F("esri-blackberry");a.isTouchEnabled=F("esri-touch");a.isPointerEnabled=F("esri-pointer");a._hasCors=F("esri-cors");a._hasFileUpload=F("esri-file-upload");a._hasTransforms=
F("esri-transforms");a._hasTransitions=F("esri-transitions");a._has3DTransforms=F("esri-transforms3d");return F})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(F,m,a,D,z,y,r,q,n){function f(w,t,C,u){(t=t&&t[w])?t={formatType:t.formatType,options:t}:u&&-1!==F.indexOf(u.properties||"",w)?t={formatType:u.formatter||"DateString",options:null}:C&&-1!==F.indexOf(C.properties||
"",w)&&(t={formatType:C.formatter||"NumberFormat",options:null});return t}function d(w,t,C){return[D.isString(w)?w.split(""):w,t||a.global,D.isString(C)?new Function("item","index","array",C):C]}function e(w){return void 0!==w&&null!==w}function b(w){return e(w)?w:""}function c(w,t,C,u){var x=C.match(/([^\(]+)(\([^\)]+\))?/i);C=D.trim(x[1]);var l=x[2]?D.trim(x[2]):null;x=t[w];u=u||(l?m.fromJson(l.replace(/^\(/,"({").replace(/\)$/,"})")):{});l=u.utcOffset;if(-1===F.indexOf(g,C))C=D.getObject(C),D.isFunction(C)&&
(x=C(x,w,t,u));else if("number"===typeof x||"string"===typeof x&&x&&!isNaN(Number(x)))switch(x=Number(x),C){case "NumberFormat":return r.format(x,u);case "DateString":w=new Date(x);if(u.local||u.systemLocale)return u.systemLocale?w.toLocaleDateString()+(u.hideTime?"":" "+w.toLocaleTimeString()):w.toDateString()+(u.hideTime?"":" "+w.toTimeString());w=w.toUTCString();u.hideTime&&(w=w.replace(/\s+\d\d:\d\d:\d\d\s+(utc|gmt)/i,""));return w;case "DateFormat":return w=new Date(x),e(l)&&(w=z.add(w,"minute",
w.getTimezoneOffset()-l)),q.format(w,u)}return b(x)}function h(w,t){var C;if(t)for(C in w)w.hasOwnProperty(C)&&(void 0===w[C]?delete w[C]:w[C]instanceof Object&&h(w[C],!0));else for(C in w)w.hasOwnProperty(C)&&void 0===w[C]&&delete w[C];return w}var g=["NumberFormat","DateString","DateFormat"],k=/<\/?[^>]+>/g;y={valueOf:function(w,t){for(var C in w)if(w[C]==t)return C;return null},stripTags:function(w){if(w){var t=typeof w;if("string"===t)w=w.replace(k,"");else if("object"===t)for(var C in w)(t=w[C])&&
"string"===typeof t&&(t=t.replace(k,"")),w[C]=t}return w},substitute:function(w,t,C){if(e(C))if(D.isObject(C)){var u=C.first;var x=C.dateFormat;var l=C.numberFormat;var v=C.format}else u=C;if(t&&"${*}"!==t)return D.replace(t,D.hitch({obj:w},function(B,E){var G=E.split(":"),I;return 1<G.length?(E=G[0],G.shift(),(I=v&&v[G[0]])?G=I.formatType:(G=G.join(":"),I=null),c(E,this.obj,G,I)):(I=f(E,v,l,x))?c(E,this.obj,I.formatType,I.options):b(this.obj[E])}),/\$\{([^\}]+)\}/g);t=[];for(var A in w)if(C=(C=f(A,
v,l,x))?c(A,w,C.formatType,C.options):w[A],t.push(A+" \x3d "+b(C)+"\x3cbr/\x3e"),u)break;return t.join("")},filter:function(w,t,C){t=d(w,C,t);C={};var u;w=t[0];for(u in w)t[2].call(t[u],w[u],u,w)&&(C[u]=w[u]);return C},startsWith:function(w,t,C){C=C||0;return w.indexOf(t,C)===C},endsWith:function(w,t,C){if("number"!==typeof C||!isFinite(C)||Math.floor(C)!==C||C>w.length)C=w.length;C-=t.length;w=w.indexOf(t,C);return-1!==w&&w===C},isDefined:e,fixJson:h,isObject:function(w){return w&&"object"===typeof w},
isString:function(w){return"string"===typeof w},mixin:function(w,t){for(var C in t)t.hasOwnProperty(C)&&(w[C]=t[C]);return w},clone2DArray:function(w){if(w=w?w.slice(0):null){var t,C=w.length;for(t=0;t<C;t++)w[t]=w[t]?w[t].slice(0):null}return w},clone3DArray:function(w){if(w=w?w.slice(0):null){var t,C=w.length;for(t=0;t<C;t++){w[t]=w[t]?w[t].slice(0):null;var u=w[t];if(u){var x,l=u.length;for(x=0;x<l;x++)u[x]=u[x]?u[x].slice(0):null}}}return w}};D.mixin(n,y);n._isDefined=e;n._getParts=d;n._sanitize=
h;return y})},"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./Color ./promiseList ./arcade/Dictionary ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/support/webglUtils ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K,ba,T,P,J,N,Z,Y,qa,V,na,ya,S,ma,ja,X,oa,xa){function Ha(O,ca){var va=O.lods;va.sort(function(pa,ra){return pa.scale>ra.scale?-1:pa.scale<ra.scale?1:0});var H=[];va=q.filter(va,function(pa){if(-1===ta(H,pa.scale))return H.push(pa.scale),!0});var R=ca.lods=[],W;q.forEach(va,function(pa,ra){W=R[ra]=new S(pa);W.level=ra});ca.tileInfo=new ya(M(O,{lods:R}))}var Ia,ia=qa.toMapPoint,ea=qa.toScreenPoint,za=z.connect,Ca=z.disconnect,Da=r.hitch,
ka=g.set,ta=q.indexOf,M=r.mixin,Ga=0,La=u.defaults.map,aa=La.layerNamePrefix,Ya=La.graphicsLayerNamePrefix,Wa=new RegExp("^"+aa+"(\\d+)$"),Ea=new RegExp("^"+Ya+"(\\d+)$"),U=function(){},fa=0,sa=oa.isWebGLEnabled();D=D([v,I],{declaredClass:"esri._CoreMap",tables:null,resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',
invalidBasemap:'Unable to add basemap: "${basemapName}".',unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,webglEnabled:sa,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],
load:["map"],pan:["extent","delta"],"pan-end":["extent","delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,
"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(O,ca){ca=ca||{};this.registerConnectEvents();M(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_basemapPending:!1,_connects:[],_layerAddPromises:{},
_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,_cursor:null,_ratioW:1,_ratioH:1,_params:null,_minResolution:0,_maxResolution:0,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[],_webglContextOwners:[]});var va=this.container=d.byId(O),H=this.id=e.get(va,"id")||w.getUniqueId(this.declaredClass);b.add(va,"map");
var R=h.getContentBox(va),W=b.add,pa=c.create;this.position=new P(0,0);this._reposition();var ra=this.width=0<R.w?R.w:La.width,Aa=this.height=0<R.h?R.h:La.height,Ba=this.root=pa("div",{id:H+"_root",style:{width:ra+"px",height:Aa+"px",direction:"ltr"}});W(Ba,"esriMapContainer");R=this.__container=pa("div",{id:H+"_container"},Ba);ka(R,"position","absolute");W(R,"esriMapContainer");va.appendChild(Ba);va=this._params=M({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,
displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},ca);this.setWebGLEnabled(null!=va.webglEnabled?va.webglEnabled:this.webglEnabled);this.maxWebGLContexts=null!=va.maxWebGLContexts?va.maxWebGLContexts:-1;this.wrapAround180=va.wrapAround180;this.optimizePanAnimation=va.optimizePanAnimation;this.setBackgroundColor(va.backgroundColor);l.isDefined(va.resizeDelay)&&(this.resizeDelay=va.resizeDelay);va.lods&&(Ha({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,
y:90},spatialReference:{wkid:4326},lods:va.lods},va),this.__tileInfo=va.tileInfo);this.extent=va.extent;this._extentUtil({mapCenter:va.center,targetLevel:va.zoom,targetScale:va.scale});this.__visibleRect=new N(0,0,ra,Aa);this.__visibleDelta=new N(0,0,ra,Aa);H=this._layersDiv=pa("div",{id:H+"_layers"});W(H,"esriMapLayers");R.appendChild(H);this._zoomAnimDiv=pa("div",{style:{position:"absolute"}});va.infoWindow?this.infoWindow=va.infoWindow:(W=this.infoWindow=new xa(va.popupOptions,pa("div")),W.startup(),
W._ootb=!0,ka(W.domNode,"zIndex",40));if(va.showLabels){var Ja=this;F(["./layers/LabelLayer"],function(Ka){Ia=Ka;Ja._createLabelLayer()});this.on("load",function(){Ja._createLabelLayer()})}this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:va.showInfoWindowOnClick});this._zoomStartHandler=Da(this,this._zoomStartHandler);this._zoomingHandler=Da(this,this._zoomingHandler);this._zoomEndHandler=Da(this,this._zoomEndHandler);this._panningHandler=Da(this,this._panningHandler);this._panEndHandler=
Da(this,this._panEndHandler);this._endTranslate=Da(this,this._endTranslate);this._timedResize=Da(this,this._timedResize);this._execResize=Da(this,this._execResize);this._processLabelLayers=Da(this,this._processLabelLayers);this._updateLabelLayers=Da(this,this._updateLabelLayers);this.resize=Da(this,this.resize);f.addOnWindowUnload(this,this.destroy)},_getAbsMid:function(O){return F.toAbsMid?F.toAbsMid(O):m.id.replace(/\/[^\/]*$/ig,"/")+O},_cleanUp:function(){var O=this.infoWindow;O&&(O._ootb&&O.destroy?
O.destroy():O.unsetMap(this),delete this.infoWindow);Ca(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");c.destroy(this.root);this.root=null},_addLayer:function(O,ca,va){if(O.id){var H=O.id.match(O instanceof na?Ea:Wa);H&&H[1]&&(H=Number(H[1]),Ga<=H&&(Ga=H+1))}var R=O.id||(O instanceof na?Ya:aa)+Ga++;O.id=R;this._layers[R]=O;O._isRefLayer="top"===va;va=!l.isDefined(va)||0>va||va>ca.length||"top"===va?ca.length:va;var W;if(!O._isRefLayer)for(;(W=this.getLayer(ca[va-1]))&&
W._isRefLayer;)va--;if(H=!this._firstLayerId&&!this.loaded&&!this._basemapPending&&0===va&&(ca===this.layerIds||ca===this.graphicsLayerIds))this._firstLayerId=R;ca.splice(va,0,R);var pa=Da(this,this._addLayerHandler),ra=this;va=this._connects;W=function(){O.loaded?ra._onLoadFix?(ra._onLoadFix=!1,setTimeout(function(){pa(O)},0)):pa(O):(ra["_"+R+"_addtoken_load"]=za(O,"onLoad",ra,"_addLayerHandler"),ra["_"+R+"_addtoken_err"]=za(O,"onError",ra,function(Aa){pa(O,Aa,ca)}))};this.loaded||H||O.loaded&&-1===
ta(this.graphicsLayerIds,R)?W():va.push(za(this,"onLoad",W));return O},_forgetLayer:function(O){O=O.id;Ca(this["_"+O+"_addtoken_load"]);Ca(this["_"+O+"_addtoken_err"]);var ca=this._layerAddPromises[O];ca&&(delete this._layerAddPromises[O],ca.cancel())},_addLayerHandler:function(O,ca,va){ca?this._attachLayerToMap(O,ca,va):O._prepareToAttach?(this._layerAddPromises[O.id]=O._prepareToAttach(this)).always(r.hitch(this,function(H){H&&"cancel"===H.dojoType||this._attachLayerToMap(O,null,va)})):O.declaredClass&&
(-1<O.declaredClass.toLowerCase().indexOf("vectortilelayer")||-1<O.declaredClass.toLowerCase().indexOf("rasterxlayer")&&O.useWebGL)&&!this.isWebGLContextAvailable()?(ca=Error("Too many WebGL contexts. Unable to add the layer: ",O.url),this._attachLayerToMap(O,ca,this.layerIds)):this._attachLayerToMap(O,ca,va)},_attachLayerToMap:function(O,ca,va){var H=this.id,R=O.id,W=ta(O instanceof na?this.graphicsLayerIds:this.layerIds,R),pa=W,ra=!1,Aa=this._params;this._forgetLayer(O);if(ca)delete this._layers[R],
-1!==W&&(va.splice(W,1),this.onLayerAddResult(O,ca));else{-1===W&&(W=ta(this._internalLayerIds,R),pa=20+W,ra=!0);if(R===this._firstLayerId){ca=O.spatialReference;va=this.extent&&this.extent.spatialReference;!va||va.equals(ca)||!O.tileInfo&&O.url||(va=null);va=this.spatialReference=va||ca;this.wrapAround180=this.wrapAround180&&va&&va._isWrappable()?!0:!1;O.tileInfo&&(this.__tileInfo?(ca=this.__tileInfo.lods,this.__tileInfo=M({},O.tileInfo),this.__tileInfo.lods=ca):(Ha(M({},O.tileInfo),Aa),this.__tileInfo=
Aa.tileInfo));if(this.wrapAround180){ca=this.__tileInfo;va=va._getInfo();if(!ca||Math.abs(va.origin[0]-ca.origin.x)>va.dx)this.wrapAround180=!1;this.wrapAround180&&ca&&E._addFrameInfo(ca,va)}Aa.units=O.units;if((ca=this.__tileInfo&&this.__tileInfo.lods)&&ca.length){va=Aa.minScale;W=Aa.maxScale;var Ba=-1,Ja=-1,Ka=!1,Ra=!1,Va;for(Va=0;Va<ca.length;Va++)0<va&&!Ka&&va>=ca[Va].scale&&(Ba=ca[Va].level,Ka=!0),0<W&&!Ra&&W>=ca[Va].scale&&(Ja=0<Va?ca[Va-1].level:-1,Ra=!0);-1===Aa.minZoom&&(Aa.minZoom=0===va?
ca[0].level:Ba);-1===Aa.maxZoom&&(Aa.maxZoom=0===W?ca[ca.length-1].level:Ja);for(Va=0;Va<ca.length;Va++)Aa.minZoom===ca[Va].level&&(Aa.minScale=ca[Va].scale,this._minResolution=ca[Va].resolution),Aa.maxZoom===ca[Va].level&&(Aa.maxScale=ca[Va].scale,this._maxResolution=ca[Va].resolution)}else Aa.minZoom=Aa.maxZoom=Aa.zoom=-1}O instanceof na?(this._gc||(this._gc=new na._GraphicsContainer,this._gc._setMap(this,this._layersDiv).id=H+"_gc"),this._attachGraphicsLayer(O).id=H+"_"+R):(pa=O._setMap(this,this._layersDiv,
pa,this.__LOD),pa.id=H+"_"+R,this._layerDivs[R]=pa,this._reorderLayers(this.layerIds),ra||-1===O.declaredClass.indexOf("VETiledLayer")||this._onBingLayerAdd(O));R===this._firstLayerId&&(this.graphics=new na({id:H+"_graphics",displayOnPan:Aa.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,20));if(O===this.graphics){va=this._layers[this._firstLayerId];H=Aa.zoom;pa=Aa.scale;ca=Aa.center;va=va.initialExtent||va.fullExtent;this._firstLayerId=null;this.extent&&(this.extent=this._convertGeometry(this,
this.extent));!this.extent&&va&&(ca&&(ca=this._convertGeometry(va,ca)),ca&&(va=va.centerAt(ca),ca=null));if(ca=this.extent||va&&new J(va.toJson()))-1<H?ca=this.__getExtentForLevel(H,null,ca).extent:0<pa&&(ca=Y.getExtentForScale(this,pa,ca));if(!ca)return;Aa=this._fixExtent(ca,Aa.fitExtent);this.extent=Aa.extent;this.__LOD=Aa.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}ra||(this.onLayerAdd(O),this.onLayerAddResult(O));
Ca(this[R+"_addLayerHandler_connect"])}},_convertGeometry:function(O,ca){var va=O&&O.spatialReference,H=ca&&ca.spatialReference;va&&H&&!va.equals(H)&&(va._canProject(H)?va.isWebMercator()?ca=V.geographicToWebMercator(ca):4326===va.wkid&&(ca=V.webMercatorToGeographic(ca,!0)):ca=null);return ca},_attachGraphicsLayer:function(O){var ca=O.id;O=O._setMap(this,this._gc._surface);this._layerDivs[ca]=O;this._reorderLayers(this.graphicsLayerIds);return O},_detachGraphicsLayer:function(O){O.loaded&&O.getMap()&&
O._unsetMap(this,this._gc._surface)},_reorderLayers:function(O){var ca=this.onLayerReorder,va=c.place,H=this._layerDivs,R=this._layers,W=this._gc?this._gc._surface.getEventSource():null;if(O===this.graphicsLayerIds)q.forEach(O,function(Ja,Ka){var Ra=H[Ja],Va=R[Ja];Ra&&(this._gc._reorderLayer(Va,Ra,Ka),ca(Va,Ka))},this);else{var pa=this.graphics,ra=pa?pa.id:null,Aa=this._layersDiv,Ba;q.forEach(O,function(Ja,Ka){Ba=H[Ja];Ja!==ra&&Ba&&(va(Ba,Aa,Ka),ca(R[Ja],Ka))});this._mapImageLyr&&this._placeMapImageLyr();
W&&(W=9>k("ie")?W.parentNode:W,va(W,W.parentNode,"last"))}this.onLayersReordered([].concat(O))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(O){var ca=parseFloat(O.left),va=parseFloat(O.top);O=new J(ca,va-parseFloat(O.height),ca+parseFloat(O.width),va,this.spatialReference);ca=this.extent.getWidth()/O.getWidth();this.__zoom(O,ca,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var O=this._zoomAnimDiv,ca=O.extent,
va=this.extent.getWidth()/ca.getWidth(),H=O.anchor,R=O.newLod,W=O.levelChange;O.extent=O.anchor=O.levelChange=O.startingExtent=O.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(ca,va,H,R,W)},_panningHandler:function(O){if(isNaN(parseFloat(O.left))||isNaN(parseFloat(O.top))){var ca=Math.round,va=this._panAnim.node;O.left=-1*(this._delta.x-ca(this.width/2))+"px";O.top=-1*(this._delta.y-ca(this.height/2))+"px";g.set(va,"left",O.left);g.set(va,"top",O.top)}O=new P(parseFloat(O.left),parseFloat(O.top));
ca=this.toMap(O);this.onPan(this.extent.offset(this.extent.xmin-ca.x,this.extent.ymax-ca.y),O)},_panEndHandler:function(O){this.__panning=!1;var ca=Math.round;O=new P(-ca(parseFloat(O.style.left)),-ca(parseFloat(O.style.top)));ca=O.x;var va=O.y,H=this.__visibleRect,R=this.__visibleDelta;H.x+=-ca;H.y+=-va;R.x+=-ca;R.y+=-va;ka(this._zoomAnimDiv,{left:"0px",top:"0px"});H=this.extent;R=this._ratioW;var W=this._ratioH;H=new J(H.xmin+ca/R,H.ymin-va/W,H.xmax+ca/R,H.ymax-va/W,this.spatialReference);O.setX(-O.x);
O.setY(-O.y);this._delta=this._panAnim=null;this._updateExtent(H);this.onPanEnd(H,O);this._fireExtChg([H,O,!1,this.__LOD])},_fixExtent:function(O,ca){for(var va=this._reshapeExtent(O),H=1.25;!0===ca&&(va.extent.getWidth()<O.getWidth()||va.extent.getHeight()<O.getHeight())&&0<va.lod.level&&3>=H;)va=this._reshapeExtent(O.expand(H)),H+=.25;return va},_getFrameWidth:function(){var O=-1,ca=this.spatialReference._getInfo();this.__LOD?(ca=this.__LOD._frameInfo)&&(O=ca[3]):ca&&(O=Math.round(2*ca.valid[1]/
(this.extent.getWidth()/this.width)));return O},_fixAspectRatio:function(O){var ca=O.getWidth(),va=O.getHeight(),H=ca/va,R=this.width/this.height,W=0,pa=0;this.width>this.height?ca>va?R>H?W=va*R-ca:pa=ca/R-va:W=va*R-ca:this.width<this.height?ca<va?R>H?W=va*R-ca:pa=ca/R-va:pa=ca/R-va:ca<va?W=va-ca:ca>va&&(pa=ca/R-va);W&&(O.xmin-=W/2,O.xmax+=W/2);pa&&(O.ymin-=pa/2,O.ymax+=pa/2);return O},_reshapeExtent:function(O){O=this._fixAspectRatio(O);return this._getAdjustedExtent(O)},_getAdjustedExtent:function(O){if(this.__tileInfo)return E.getCandidateTileInfo(this,
this.__tileInfo,O);var ca=Y.getScale(this,O),va=this.getMinScale(),H=this.getMaxScale();!va||ca<=va?!H||ca>=H||(O=Y.getExtentForScale(this,H,O)):O=Y.getExtentForScale(this,va,O);return{extent:O}},_onBingLayerAdd:function(O){this["__"+O.id+"_vis_connect"]=z.connect(O,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(O.visible)},_onBingLayerRemove:function(O){z.disconnect(this["__"+O.id+"_vis_connect"]);delete this["__"+O.id+"_vis_connect"];var ca=q.some(this.layerIds,function(va){return(O=
this._layers[va])&&O.visible&&-1!==O.declaredClass.indexOf("VETiledLayer")},this);this._toggleBingLogo(ca)},_toggleBingLogo:function(O){O&&!this._bingLogo?(O={left:this._mapParams&&this._mapParams.nav?"25px":""},6===k("ie")&&(O.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+F.toUrl("./images/map/bing-logo-lg.png")+"')"),O=this._bingLogo=c.create("div",{style:O},this.root),b.add(O,"bingLogo-lg")):!O&&this._bingLogo&&(c.destroy(this._bingLogo),
delete this._bingLogo)},__panStart:function(O,ca){var va=this._zoomAnim,H=this._panAnim;if(va&&va._active)va.stop(),va._fire("onEnd",[va.node]);else if(H&&H._active){H.stop();this._panAnim=null;H=H.curve.getValue(H._getStep());va=Math.round(parseFloat(H.left));H=Math.round(parseFloat(H.top));var R=this.navigationManager._dragOrigin;this.__pan(va,H);R&&(R.x-=va,R.y-=H);return}this.__panning=!0;this.onPanStart(this.extent,new P(O,ca))},__pan:function(O,ca){var va=this.extent,H=this._ratioW,R=this._ratioH;
this.onPan(new J(va.xmin-O/H,va.ymin+ca/R,va.xmax-O/H,va.ymax+ca/R,this.spatialReference),new P(O,ca))},__panEnd:function(O,ca){var va=this.__visibleRect,H=this.__visibleDelta;va.x+=O;va.y+=ca;H.x+=O;H.y+=ca;va=new P(O,ca);H=this.extent;var R=this._ratioW,W=this._ratioH;H=new J(H.xmin-O/R,H.ymin+ca/W,H.xmax-O/R,H.ymax+ca/W,this.spatialReference);this.__panning=!1;this._updateExtent(H);this.onPanEnd(H,va);this._fireExtChg([H,va,!1,this.__LOD])},__zoomStart:function(O,ca){this.__zooming=!0;this.onZoomStart(O,
1,ca,this.__LOD?this.__LOD.level:null)},__zoom:function(O,ca,va){this.onZoom(O,ca,va)},__zoomEnd:function(O,ca,va,H,R){ka(this._layersDiv,{left:"0px",top:"0px"});this._delta=new P(0,0);this.__visibleRect.x=this.__visibleRect.y=0;O=new J(O);this.__LOD=H;this._ratioW=this.width/O.getWidth();this._ratioH=this.height/O.getHeight();var W=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(O,R);this.onZoomEnd(O,ca,va,H?H.level:null);this._fireExtChg([O,W,R,H])},_extentUtil:function(O,ca,va,
H,R){var W=new y,pa=this.width,ra=this.height;if(O){var Aa=O.numLevels;var Ba=O.targetLevel;var Ja=l.isDefined(Ba);var Ka=O.factor;var Ra=O.mapAnchor;var Va=O.screenAnchor;var ab=O.mapCenter;var db=O.levelOrFactor;var jb=O.targetScale;var hb=l.isDefined(jb)&&0<jb}if(ca){var fb=ca.dx;var nb=ca.dy;ab=ca.mapCenter}r.isArray(ab)&&(ab=new T(ab));var qb=this._panAnim;ca=(O=this._stopAnim())?O.divExtent:this.extent;var xb=this.__tileInfo,ub=this._params;if(!this.loaded){if(va)ca&&(va=this._convertGeometry(ca,
va)),va&&(this.extent=va,ub.zoom=ub.scale=-1,ub.center=null);else if(ab||Ja||hb){if(ab)if(ca){if(ab=this._convertGeometry(ca,ab))this.extent=ca.centerAt(ab),ub.center=null}else ub.center=ab;Ja&&-1<Ba?(ub.zoom=Ba,ub.scale=-1):hb&&(ub.scale=jb,ub.zoom=-1)}W.resolve();return W}if(ab&&(ab=this._convertGeometry(this,ab),!ab)||Ra&&(Ra=this._convertGeometry(this,Ra),!Ra)||va&&(va=this._convertGeometry(this,va),!va))return W.reject(),W;qb&&Ra&&Va&&(Ra=ia(this.extent,pa,ra,Va));O&&Ra&&Va&&(Ra=ia(O.divExtent,
pa,ra,Va));if(Ja)if(xb)Aa=this.getMinZoom(),Ja=this.getMaxZoom(),Ba<Aa?Ba=Aa:Ba>Ja&&(Ba=Ja),Aa=Ba-(O?O.level:this.getLevel());else{Aa=0<Ba?-1:1;var pb=db?Ba:null}if(!va)if(l.isDefined(Aa))xb?(pa=O?O.level:this.getLevel(),pa=this.__getExtentForLevel(pa+Aa,ab,ca).extent):(pa=(O?O.end:this.extent).expand(pb||(0<Aa?.5*Aa:2*-Aa)),pb&&ab&&(pa=pa.centerAt(ab))),pa&&(ab?va=pa:(fb=Ra||ca.getCenter(),ra=pa.getWidth(),nb=pa.getHeight(),pa=fb.x>=ca.xmin&&fb.x<=ca.xmax?(fb.x-ca.xmin)/ca.getWidth():.5,va=fb.y>=
ca.ymin&&fb.y<=ca.ymax?(fb.y-ca.ymin)/ca.getHeight():.5,pa=fb.x-pa*ra,fb=fb.y-va*nb,va=new J(pa,fb,pa+ra,fb+nb,this.spatialReference)));else if(hb)va=Y.getExtentForScale(this,jb,ca);else if(l.isDefined(Ka))va=ca.expand(Ka);else if(fb||nb)O?(va=O.end,Ra=va.getCenter(),pb=ea(va,pa,ra,Ra),pb.x+=fb,pb.y+=nb,pb=ia(va,pa,ra,pb),va=va.offset(pb.x-Ra.x,pb.y-Ra.y)):(fb=new P(pa/2+fb,ra/2+nb),fb=ia(ca,pa,ra,fb),ra=ca.getWidth(),nb=ca.getHeight(),pa=fb.x-ra/2,fb=fb.y-nb/2,va=new J(pa,fb,pa+ra,fb+nb,this.spatialReference));
va||(ab?(ca=O?O.end:ca,ra=ca.getWidth(),nb=ca.getHeight(),pa=ab.x-ra/2,fb=ab.y-nb/2,va=new J(pa,fb,pa+ra,fb+nb,this.spatialReference)):O&&(va=O.end));va?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,U),this._extentDfd.reject()),this._extentDfd=W,this.__setExtent(va,null,Va,H,O,R)):W.reject();return W},__setExtent:function(O,ca,va,H,R,W){try{if(this._firstLayerId)this.extent=O;else{var pa=!0,ra=this.spatialReference,Aa=R?R.divExtent:this.extent,Ba=this._fixExtent(O,H||!1);
O=Ba.extent;var Ja=O.getWidth(),Ka=O.getHeight(),Ra=Math.round;if(Aa){var Va=Ra(1E6*Aa.getWidth()),ab=Ra(1E6*Ja),db=Ra(1E6*Aa.getHeight()),jb=Ra(1E6*Ka);pa=Va!==ab||db!==jb}var hb,fb=R&&R.rect,nb=R&&R.divExtent;if(La.zoomDuration&&pa&&Aa){nb=nb||new J(Aa);fb=fb||{left:Aa.xmin,top:Aa.ymax,width:Aa.getWidth(),height:Aa.getHeight()};var qb={left:O.xmin,top:O.ymax,width:Ja,height:Ka};var xb=new T(O.xmin,O.ymax,ra),ub=new T(O.xmin,O.ymin,ra),pb=new T(this.extent.xmin,this.extent.ymax,ra),ob=new T(this.extent.xmin,
this.extent.ymin,ra);(hb=Z.getLineIntersection(pb,xb,ob,ub,ra))||R||(pa=!1)}this._ratioW=this.width/Ja;this._ratioH=this.height/Ka;var mb=this._zoomAnimDiv;if(pa)if(ka(this._layersDiv,{left:"0px",top:"0px"}),ca=new P(0,0),this.__visibleRect.x=this.__visibleRect.y=0,fb&&qb){this._delta=ca;mb.id="_zAD";mb.startingExtent=nb;mb.extent=O;mb.levelChange=pa;mb.newLod=Ba.lod;mb.anchor=va?va:!hb&&R?R.anchor:ea(this.extent,this.width,this.height,hb);var Ab=this.extent.getWidth()/O.getWidth();La.zoomAnimationThrottled&&
1024<(1>Ab?1/Ab:Ab)?(this.__zoomStart(nb,mb.anchor),this.__zoom(nb,1,mb.anchor),this._fireOnScale(1,mb.anchor,!0),this.__zoomEnd(O,Ab,mb.anchor,Ba.lod,pa)):(this._zoomAnim=A.resize({node:mb,start:fb,end:qb,duration:La.zoomDuration,rate:La.zoomRate,beforeBegin:R?null:this._zoomStartHandler,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),this._fireOnScale(Ab,mb.anchor,W))}else this._updateExtent(O,pa,W),this._fireExtChg([this.extent,ca,pa,this.__LOD=Ba.lod]);else if(!this.__panning)if(!1===
this.loaded||W)this._updateExtent(O,pa,W),this._fireExtChg([this.extent,ca,pa,this.__LOD=Ba.lod]);else{this.__panning=!0;fb=(new N(0,0,this.width,this.height,this.spatialReference)).getCenter();fb.x=Ra(fb.x);fb.y=Ra(fb.y);var Db=this._delta=this.toScreen(O.getCenter()),Jb=Math.abs(fb.x-Db.x),Ub=Math.abs(fb.y-Db.y);this.optimizePanAnimation&&(Jb>2*this.width||Ub>2*this.height)?(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=
0,this.__panning=!1,this._delta=null,this._updateExtent(O,!1,W),this.onPanEnd(this.extent,new P(0,0)),this._fireExtChg([this.extent,new P(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new P(0,0)),this._panAnim=A.slideTo({node:mb,left:fb.x-Db.x,top:fb.y-Db.y,duration:La.panDuration,rate:La.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}}catch(Nb){}},_fireOnScale:function(O,ca,va){if("css-transforms"===this.navigationMode){var H=this.__visibleDelta;this.onScale(t.scaleAt(O,
{x:-1*(this.width/2-(ca.x-H.x)),y:-1*(this.height/2-(ca.y-H.y))}),va)}},_stopAnim:function(){var O=this._zoomAnim,ca=this._panAnim;if(O&&O._active){O.stop();ca=O.curve.getValue(O._getStep());var va=parseFloat(ca.left),H=parseFloat(ca.top);O=O.node;return{anchor:O.anchor,start:O.startingExtent,end:O.extent,level:O.newLod&&O.newLod.level,rect:ca,divExtent:new J(va,H-parseFloat(ca.height),va+parseFloat(ca.width),H,this.spatialReference)}}ca&&ca._active&&(ca.stop(),ca._fire("onEnd",[ca.node]))},__getExtentForLevel:function(O,
ca,va){var H=this.__tileInfo;H=H&&H.lods;O=l.isDefined(O)?O:0;va=va||this.extent;ca=ca||va&&va.getCenter();if(H){if(ca){va=this.getMinZoom();var R=this.getMaxZoom();O>R&&(O=R);O<va&&(O=va);O=H[O];H=this.width*O.resolution/2;va=this.height*O.resolution/2;return{extent:new J(ca.x-H,ca.y-va,ca.x+H,ca.y+va,ca.spatialReference),lod:O}}}else return va?{extent:va.expand(!O||1>O?1:O).centerAt(ca)}:void 0},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart())},
_decr:function(){var O=--this._jobs;O?0>O&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(O,ca){this[O]&&this[O].apply(this,ca)},_updateExtent:function(O,ca,va){this.extent=O;O=this.spatialReference;this._viewInfo={view:new ba({viewingMode:"map",scale:this.getScale()}),sr:O,version:ca?++fa:fa};(ca||va)&&this._setClipRect();this._calcGeographicExtent()},_calcGeographicExtent:function(){var O=this.spatialReference;O&&(O.isWebMercator()?this.geographicExtent=
V.webMercatorToGeographic(this._getAvailExtent(),!0):4326===O.wkid&&(this.geographicExtent=new J(this._getAvailExtent().toJson())))},_fireExtChg:function(O){this.attr("data-zoom",this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",O);if(O=this._extentDfd)delete this._extentDfd,O.resolve()},attr:function(O,ca){var va=this.container;va&&(null==ca?va.removeAttribute(O):va.setAttribute(O,ca));return this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect();
this._calcGeographicExtent()},onBeforeUnload:function(){},onUnload:function(){},onExtentChange:function(O,ca,va){},onTimeExtentChange:function(){},onWebGLEnabledChange:function(){},onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},
onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},onReposition:function(){},destroy:function(){this._destroyed||(this.onBeforeUnload(this),this.removeAllLayers(),this.releaseAllWebGLContexts(),this._cleanUp(),clearTimeout(this._resizeTimerHandle),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(O){ka(this.__container,"cursor",this.cursor=O)},setMapCursor:function(O){this.setCursor(this._cursor=
O)},resetMapCursor:function(){this.setCursor(this._cursor)},setBackgroundColor:function(O){O&&!O.declaredClass&&(O=new L(O));this.backgroundColor=O||null;var ca="";O&&(ca=9>k("ie")?O.toHex():"rgba("+O.toRgba().join(",")+")");g.set(this.root,{backgroundColor:ca})},setInfoWindow:function(O){var ca=this.infoWindow;ca&&ca.unsetMap(this);this.infoWindow=O;this.loaded&&O&&O.setMap(this)},setInfoWindowOnClick:function(O){this._params.showInfoWindowOnClick=O;this.popupManager&&this.popupManager.set("enabled",
O)},getInfoWindowAnchor:function(O){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(O)||"upperright"},toScreen:function(O,ca){return ea(this.extent,this.width,this.height,O,ca)},toMap:function(O){return ia(this.extent,this.width,this.height,O)},addLayer:function(O,ca){O&&!this.getLayer(O.id)&&this._addLayer(O,O instanceof na?this.graphicsLayerIds:this.layerIds,ca);return O},addLayers:function(O){var ca=[],va=O.length,H,R=O.length;var W=z.connect(this,"onLayerAddResult",
function(pa,ra){-1!==q.indexOf(O,pa)&&(va--,ca.push({layer:pa,success:!ra,error:ra}),va||(z.disconnect(W),this.onLayersAddResult(ca)))});for(H=0;H<R;H++)this.addLayer(O[H]);return this},removeLayer:function(O,ca){var va=O.id,H=O instanceof na?this.graphicsLayerIds:this.layerIds,R=ta(H,va);0<=R&&(this._forgetLayer(O),H.splice(R,1),this.loaded||this._firstLayerId!==va||(this._firstLayerId=null),O instanceof na?this._detachGraphicsLayer(O):O.loaded&&(O.getMap()&&O._unsetMap(this,this._layersDiv),-1!==
O.declaredClass.indexOf("VETiledLayer")&&this._onBingLayerRemove(O)),delete this._layers[va],delete this._layerDivs[va],ca||this._reorderLayers(H),this.onLayerRemove(O))},removeAllLayers:function(){var O=this.layerIds,ca;for(ca=O.length-1;0<=ca;ca--)this.removeLayer(this._layers[O[ca]],1);O=this.graphicsLayerIds;for(ca=O.length-1;0<=ca;ca--)this.removeLayer(this._layers[O[ca]],1);this.onLayersRemoved()},reorderLayer:function(O,ca){r.isString(O)&&(a.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",
null,"v2.0"),O=this.getLayer(O));var va=O.id,H=O instanceof na?this.graphicsLayerIds:this.layerIds;0>ca?ca=0:ca>=H.length&&(ca=H.length-1);var R=ta(H,va);-1!==R&&R!==ca&&(H.splice(R,1),H.splice(ca,0,va),this._reorderLayers(H))},getLayer:function(O){return this._layers[O]},setWebGLEnabled:function(O){var ca=this.webglEnabled;this.webglEnabled=(O||!1)&&sa;if(ca!==this.webglEnabled)this.onWebGLEnabledChange()},isWebGLContextAvailable:function(){return oa.isContextAvailable()&&(-1===this.maxWebGLContexts||
0<this.maxWebGLContexts&&this._webglContextOwners.length<this.maxWebGLContexts)},ownsWebGLContext:function(O){return-1!==q.indexOf(this._webglContextOwners,O)},acquireWebGLContext:function(O){return-1!==q.indexOf(this._webglContextOwners,O)?!0:this.isWebGLContextAvailable()?(oa.acquireContext(O),this._webglContextOwners.push(O),!0):!1},releaseWebGLContext:function(O){var ca=q.indexOf(this._webglContextOwners,O);-1!==ca&&this._webglContextOwners.splice(ca,1);oa.releaseContext(O)},releaseAllWebGLContexts:function(){var O=
this._webglContextOwners.slice(0);q.forEach(O,function(ca){this.releaseWebGLContext(ca)},this)},syncHitTestForWebGL:function(O){var ca,va=O.screenPoint;O=this.graphicsLayerIds.slice(0).reverse();q.some(O,function(H){H=this.getLayer(H);H.loaded&&!H.suspended&&H.hasWebGLSurface()&&(ca=H._div.syncHitTest(va.x,va.y));return!!ca},this);return ca},setExtent:function(O,ca){O=new J(O.toJson());var va=O.getWidth(),H=O.getHeight();return 0===va&&0===H?this.centerAt(new T({x:O.xmin,y:O.ymin,spatialReference:O.spatialReference&&
O.spatialReference.toJson()})):this._extentUtil(null,null,O,ca)},getTargetExtent:function(O){if(O)return O=new J(O.toJson()),0!==O.getWidth()&&0!==O.getHeight()&&(O=(O=this._convertGeometry(this,O))&&this._fixExtent(O).extent),O},centerAt:function(O){return this._extentUtil(null,{mapCenter:O})},centerAndZoom:function(O,ca){return this._extentUtil({targetLevel:ca,mapCenter:O,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:Y.getScale(this)},getResolution:function(){return this.__LOD?
this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*Y.getUnitValueForSR(this.spatialReference)},getResolutionForPopup:function(){var O=this.getResolution(),ca=this.getResolutionInMeters(),va=ca/16;return 10>=va?0:O/ca*va},getMinResolution:function(){return this._minResolution},getMaxResolution:function(){return this._maxResolution},getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},
getViewInfo:function(){return this._viewInfo},setScale:function(O){return this._extentUtil({targetScale:O})},getLayersVisibleAtScale:function(O){var ca=[];(O=O||this.getScale())&&q.forEach(this.layerIds.concat(this.graphicsLayerIds),function(va){va=this.getLayer(va);va.isVisibleAtScale(O)&&ca.push(va)},this);return ca},getNumLevels:function(){var O=this.getMinZoom(),ca=this.getMaxZoom();return O===ca&&0>O?0:ca-O+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(O){if(-1<
O)return this._extentUtil({targetLevel:O})},getZoom:function(){return this.getLevel()},setZoom:function(O){return this.setLevel(O)},getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(O){if(r.isObject(O)){var ca=O;O=ca.title}else ca=x&&x[O];if(ca){this._basemapDfd&&!this._basemapDfd.isFulfilled()&&this._basemapDfd.cancel();var va=[],H=0;q.forEach(ca.baseMapLayers||ca.layers,function(W){var pa={id:W.id,displayLevels:W.displayLevels,
opacity:l.isDefined(W.opacity)?W.opacity:null,visible:l.isDefined(W.visibility)?W.visibility:null};if(pa=this._createBaseLayerInstance(W,pa,O))va.push(pa),W.isReference||H++},this);va.length&&H&&(this._basemapDfd=K(va).otherwise(Da(this,function(W){this._basemapPending=!1;W&&"cancel"===W.dojoType&&q.forEach(va,function(pa){pa.cancel()});throw W;})).then(function(W){var pa=[],ra=[];q.forEach(W,function(Aa){Aa&&(Aa.layerInfo&&pa.push(Aa.layerInfo),Aa.layer&&ra.push(Aa.layer))});return{basemapName:O,
infos:pa,layers:ra}}).then(Da(this,this._waitForBaseLayers)).then(Da(this,this._setBasemap)),this._basemapPending=!this.loaded&&!this._basemapDfd.isFulfilled())}else{ca=[];for(var R in x)ca.push(R)}},_createBaseLayerInstance:function(O,ca,va){var H=new y;if(O.type)switch(O.type){case "OpenStreetMap":H.resolve({layerInfo:O,layer:new X(ca)});break;case "VectorTile":F(["./layers/VectorTileLayer"],function(W){R=G.normalize(O.url);H.promise.isFulfilled()||H.resolve({layerInfo:O,layer:new W(R,ca)})});break;
default:return null}else{var R=G.normalize(O.url);H.resolve({layerInfo:O,layer:new ma(R,ca)})}return H.promise},_waitForBaseLayers:function(O){var ca=new y(B._dfdCanceller);ca.promise.otherwise(function(H){if(H&&"cancel"===H.dojoType){for(var R in ca._layerEvents)H=ca._layerEvents[R],z.disconnect(H[0]),z.disconnect(H[1]);delete ca._layerEvents}});if(!this.loaded)return ca.resolve(O),ca.promise;var va=function(H){ca._pendingLayers--;H=q.indexOf(O.layers,this);-1<H&&(H=ca._layerEvents[H])&&(z.disconnect(H[0]),
z.disconnect(H[1]));0>=ca._pendingLayers&&(delete ca._layerEvents,ca.isFulfilled()||ca.resolve(O))};ca._pendingLayers=0;ca._layerEvents={};q.forEach(O.layers,function(H,R){H&&ca._pendingLayers++});q.forEach(O.layers,function(H,R){H&&(H.loaded?va(H):ca._layerEvents[R]=[z.connect(H,"onLoad",H,va),z.connect(H,"onError",H,va)])});return ca.promise},_setBasemap:function(O){var ca=O.layers,va=O.infos,H=0,R=!0;this._basemapPending=!1;this.loaded&&(q.forEach(ca,function(pa,ra){pa.loaded&&(va[ra].isReference||
H++)}),R=H);if(R){if(R=this._getBasemapLayerIds()){var W={basemapName:this._basemap,infos:x&&x[this._basemap]&&x[this._basemap].baseMapLayers};W.basemapName||(q.forEach(R,function(pa){if(this.getLayer(pa)instanceof X)return W.basemapName="osm",W.infos=x&&x.osm&&x.osm.baseMapLayers,!1},this),W.basemapName||(W=null))}this._removeBasemap(R);this._basemap=O.basemapName;this.basemapLayerIds=this._addBasemapLayers(ca,va);this.attr("data-basemap",this.getBasemap());this.emit("basemap-change",{current:O,
previous:W})}},_getBasemapLayerIds:function(){var O=[];q.forEach(this.layerIds,function(ca){ca=this.getLayer(ca);ca._basemapGalleryLayerType&&O.push(ca.id)},this);return O},_addBasemapLayers:function(O,ca){var va=[],H=[],R=0;q.forEach(O,function(W,pa){ca[pa].isReference?va.push(W):(W._basemapGalleryLayerType="basemap",H.push(W.id),this.addLayer(W,R++))},this);va.length&&q.forEach(va,function(W){W.attr("data-reference",!0);W._basemapGalleryLayerType="reference";H.push(W.id);this.addLayer(W,"top")},
this);return H},_removeBasemap:function(O){q.forEach(O,function(ca){(ca=this.getLayer(ca))&&this.removeLayer(ca)},this)},getBasemap:function(){return this._basemap||""},translate:function(O,ca){O=O||0;ca=ca||0;if(!this._txTimer){this._tx=this._ty=0;var va=this.toScreen(this.extent.getCenter());this.__panStart(va.x,va.y)}this._tx+=O;this._ty+=ca;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);
this._txTimer=null;var O=this._tx,ca=this._ty;this._tx=this._ty=0;this.__panEnd(O,ca)},setTimeExtent:function(O){O=(this.timeExtent=O)?new O.constructor(O.toJson()):null;this.onTimeExtentChange(O)},setTimeSlider:function(O){this.timeSlider&&(Ca(this._tsTimeExtentChange_connect),this.timeSlider=this._tsTimeExtentChange_connect=null);O&&(this.timeSlider=O,this.setTimeExtent(O.getCurrentTimeExtent()),this._tsTimeExtentChange_connect=za(O,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(O){if(this.visible!==
O){this.visible=O;O||(this._display=this.container.style.display);this.container.style.display=O?this._display:"none";if(this.autoResize){var ca=O?"resume":"pause";this._rszSignal[ca]();this._oriSignal[ca]()}O&&this.resize()}return this},resize:function(O){clearTimeout(this._resizeTimerHandle);this._destroyed||(!0===O?this._execResize():this._resizeTimerHandle=setTimeout(this._execResize,this.resizeDelay))},_timedResize:function(){this._resizeTimerHandle||this._execResize()},_execResize:function(){clearTimeout(this._resizeTimerHandle);
this._resizeTimerHandle=null;this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var O=this.width,ca=this.height,va=g.get(this.container,"display"),H=h.getContentBox(this.container);if(!("none"===va||0>=H.w||0>=H.h||O===H.w&&ca===H.h)){if(va=this._zoomAnim||this._panAnim)va.stop(),va._fire("onEnd",[va.node]);ka(this.root,{width:(this.width=H.w)+"px",height:(this.height=H.h)+"px"});H=this.width;va=this.height;this.attribution&&this.attribution.domNode&&g.set(this.attribution.domNode,
"maxWidth",Math.floor(H*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,H,va);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,H,va);var R=new N(this.extent);O=(new N(R.x,R.y,H/O*R.width,va/ca*R.height,this.spatialReference)).getExtent();this.onResize(O,H,va);this._extentUtil(null,null,O,null,!0)}},reposition:function(){var O=this.position,ca=O.x,va=O.y;this._reposition();O=this.position;if(ca!==O.x||va!==O.y)this.onReposition(O.x,
O.y)},_reposition:function(){var O=h.position(this.container,!0),ca=h.getPadBorderExtents(this.container);this.position.update(O.x+ca.l,O.y+ca.t)},_setClipRect:function(){delete this._clip;var O=7>=k("ie")||void 0===k("ie")&&7<=k("trident")?"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var ca=this.width,va=this.height,H=this._getFrameWidth(),R=ca-H;0<R&&(O=R/2,O="rect(0px,"+(O+H)+"px,"+va+"px,"+O+"px)",va=this.extent.getWidth(),ca=H/ca*va,this._clip=[(va-ca)/2,ca])}ka(this.__container,
"clip",O)},_getAvailExtent:function(){var O=this.extent,ca=this._clip;if(ca){if(!O._clip){var va=new N(O);va.width=ca[1];va.x+=ca[0];O._clip=va.getExtent()}return O._clip}return O},_fixedPan:function(O,ca){return this._extentUtil(null,{dx:O,dy:ca})},panUp:function(){return this._fixedPan(0,-.75*this.height)},panUpperRight:function(){return this._fixedPan(.75*this.width,-.75*this.height)},panRight:function(){return this._fixedPan(.75*this.width,0)},panLowerRight:function(){return this._fixedPan(.75*
this.width,.75*this.height)},panDown:function(){return this._fixedPan(0,.75*this.height)},panLowerLeft:function(){return this._fixedPan(-.75*this.width,.75*this.height)},panLeft:function(){return this._fixedPan(-.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-.75*this.width,-.75*this.height)},enableSnapping:function(O){O=O||{};if("esri.SnappingManager"===O.declaredClass)this.snappingManager=O;else{var ca=Ga++,va=this;this._rids&&this._rids.push(ca);F(["./SnappingManager"],function(H){var R=
va._rids?q.indexOf(va._rids,ca):-1;-1!==R&&(va._rids.splice(R,1),va.snappingManager=new H(r.mixin({map:va},O)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){!this._labels&&Ia&&this.loaded&&(this._labels=new Ia({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),this._processLabelLayers(),this.on("layers-reordered",this._processLabelLayers))},_processLabelLayers:function(){null==
this._labelProcessor&&(this._labelProcessor=setTimeout(this._updateLabelLayers,0))},_updateLabelLayers:function(){this._labelProcessor=null;this._labels&&(this._labels.removeAllFeatureLayers(),q.forEach(this.graphicsLayerIds,function(O){O=this.getLayer(O);"function"===typeof O.applyEdits?this._labels.addFeatureLayer(O):"esri.layers.WFSLayer"===O.declaredClass&&this._labels.addFeatureLayer(O)},this))},_getMapImageLyr:function(){this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new ja,this._mapImageLyr._setMap(this,
this._layersDiv),this._placeMapImageLyr());return this._mapImageLyr},_placeMapImageLyr:function(){for(var O=this.layerIds,ca=this._layerDivs,va=!1,H,R,W=O.length-1;0<=W;W--)if(H=O[W],R=this.getLayer(H),H=ca[H],R&&H&&!R._isReference){c.place(this._mapImageLyr._div,H,"after");va=!0;break}va||c.place(this._mapImageLyr._div,this._layersDiv,"first")}});return C._CoreMap=D})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(F,m){var a=F.matrix={},D={};a._degToRad=function(z){return D[z]||
(D[z]=Math.PI*z/180)};a._radToDeg=function(z){return z/Math.PI*180};a.Matrix2D=function(z){if(z)if("number"==typeof z)this.xx=this.yy=z;else if(z instanceof Array){if(0<z.length){for(var y=a.normalize(z[0]),r=1;r<z.length;++r){var q=y,n=a.normalize(z[r]);y=new a.Matrix2D;y.xx=q.xx*n.xx+q.xy*n.yx;y.xy=q.xx*n.xy+q.xy*n.yy;y.yx=q.yx*n.xx+q.yy*n.yx;y.yy=q.yx*n.xy+q.yy*n.yy;y.dx=q.xx*n.dx+q.xy*n.dy+q.dx;y.dy=q.yx*n.dx+q.yy*n.dy+q.dy}m.mixin(this,y)}}else m.mixin(this,z)};m.extend(a.Matrix2D,{xx:1,xy:0,
yx:0,yy:1,dx:0,dy:0});m.mixin(a,{identity:new a.Matrix2D,flipX:new a.Matrix2D({xx:-1}),flipY:new a.Matrix2D({yy:-1}),flipXY:new a.Matrix2D({xx:-1,yy:-1}),translate:function(z,y){return 1<arguments.length?new a.Matrix2D({dx:z,dy:y}):new a.Matrix2D({dx:z.x,dy:z.y})},scale:function(z,y){return 1<arguments.length?new a.Matrix2D({xx:z,yy:y}):"number"==typeof z?new a.Matrix2D({xx:z,yy:z}):new a.Matrix2D({xx:z.x,yy:z.y})},rotate:function(z){var y=Math.cos(z);z=Math.sin(z);return new a.Matrix2D({xx:y,xy:-z,
yx:z,yy:y})},rotateg:function(z){return a.rotate(a._degToRad(z))},skewX:function(z){return new a.Matrix2D({xy:Math.tan(z)})},skewXg:function(z){return a.skewX(a._degToRad(z))},skewY:function(z){return new a.Matrix2D({yx:Math.tan(z)})},skewYg:function(z){return a.skewY(a._degToRad(z))},reflect:function(z,y){1==arguments.length&&(y=z.y,z=z.x);var r=z*z,q=y*y,n=r+q,f=2*z*y/n;return new a.Matrix2D({xx:2*r/n-1,xy:f,yx:f,yy:2*q/n-1})},project:function(z,y){1==arguments.length&&(y=z.y,z=z.x);var r=z*z,q=
y*y,n=r+q,f=z*y/n;return new a.Matrix2D({xx:r/n,xy:f,yx:f,yy:q/n})},normalize:function(z){return z instanceof a.Matrix2D?z:new a.Matrix2D(z)},isIdentity:function(z){return 1==z.xx&&0==z.xy&&0==z.yx&&1==z.yy&&0==z.dx&&0==z.dy},clone:function(z){var y=new a.Matrix2D,r;for(r in z)"number"==typeof z[r]&&"number"==typeof y[r]&&y[r]!=z[r]&&(y[r]=z[r]);return y},invert:function(z){z=a.normalize(z);var y=z.xx*z.yy-z.xy*z.yx;return z=new a.Matrix2D({xx:z.yy/y,xy:-z.xy/y,yx:-z.yx/y,yy:z.xx/y,dx:(z.xy*z.dy-
z.yy*z.dx)/y,dy:(z.yx*z.dx-z.xx*z.dy)/y})},_multiplyPoint:function(z,y,r){return{x:z.xx*y+z.xy*r+z.dx,y:z.yx*y+z.yy*r+z.dy}},multiplyPoint:function(z,y,r){z=a.normalize(z);return"number"==typeof y&&"number"==typeof r?a._multiplyPoint(z,y,r):a._multiplyPoint(z,y.x,y.y)},multiplyRectangle:function(z,y){var r=a.normalize(z);y=y||{x:0,y:0,width:0,height:0};if(a.isIdentity(r))return{x:y.x,y:y.y,width:y.width,height:y.height};var q=a.multiplyPoint(r,y.x,y.y),n=a.multiplyPoint(r,y.x,y.y+y.height),f=a.multiplyPoint(r,
y.x+y.width,y.y);r=a.multiplyPoint(r,y.x+y.width,y.y+y.height);var d=Math.min(q.x,n.x,f.x,r.x),e=Math.min(q.y,n.y,f.y,r.y);return{x:d,y:e,width:Math.max(q.x,n.x,f.x,r.x)-d,height:Math.max(q.y,n.y,f.y,r.y)-e}},multiply:function(z){for(var y=a.normalize(z),r=1;r<arguments.length;++r){var q=y,n=a.normalize(arguments[r]);y=new a.Matrix2D;y.xx=q.xx*n.xx+q.xy*n.yx;y.xy=q.xx*n.xy+q.xy*n.yy;y.yx=q.yx*n.xx+q.yy*n.yx;y.yy=q.yx*n.xy+q.yy*n.yy;y.dx=q.xx*n.dx+q.xy*n.dy+q.dx;y.dy=q.yx*n.dx+q.yy*n.dy+q.dy}return y},
_sandwich:function(z,y,r){return a.multiply(a.translate(y,r),z,a.translate(-y,-r))},scaleAt:function(z,y,r,q){switch(arguments.length){case 4:return a._sandwich(a.scale(z,y),r,q);case 3:return"number"==typeof r?a._sandwich(a.scale(z),y,r):a._sandwich(a.scale(z,y),r.x,r.y)}return a._sandwich(a.scale(z),y.x,y.y)},rotateAt:function(z,y,r){return 2<arguments.length?a._sandwich(a.rotate(z),y,r):a._sandwich(a.rotate(z),y.x,y.y)},rotategAt:function(z,y,r){return 2<arguments.length?a._sandwich(a.rotateg(z),
y,r):a._sandwich(a.rotateg(z),y.x,y.y)},skewXAt:function(z,y,r){return 2<arguments.length?a._sandwich(a.skewX(z),y,r):a._sandwich(a.skewX(z),y.x,y.y)},skewXgAt:function(z,y,r){return 2<arguments.length?a._sandwich(a.skewXg(z),y,r):a._sandwich(a.skewXg(z),y.x,y.y)},skewYAt:function(z,y,r){return 2<arguments.length?a._sandwich(a.skewY(z),y,r):a._sandwich(a.skewY(z),y.x,y.y)},skewYgAt:function(z,y,r){return 2<arguments.length?a._sandwich(a.skewYg(z),y,r):a._sandwich(a.skewYg(z),y.x,y.y)}});F.Matrix2D=
a.Matrix2D;return a})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(F,m,a,D,z,y,r,q,n){var f=m.getObject("dojox.gfx",!0),d=f._base={};f._hasClass=function(k,w){var t=k.getAttribute("className");return t&&0<=(" "+t+" ").indexOf(" "+w+" ")};f._addClass=function(k,w){var t=k.getAttribute("className")||"";(!t||0>(" "+t+" ").indexOf(" "+w+" "))&&
k.setAttribute("className",t+(t?" ":"")+w)};f._removeClass=function(k,w){var t=k.getAttribute("className");t&&k.setAttribute("className",t.replace(new RegExp("(^|\\s+)"+w+"(\\s+|$)"),"$1$2"))};d._getFontMeasurements=function(){var k={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},w;if(D("ie")){var t=z.doc.documentElement.style.fontSize||"";t||(z.doc.documentElement.style.fontSize="100%")}var C=q.create("div",{style:{position:"absolute",
left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},z.body());for(w in k)C.style.fontSize=w,k[w]=16*Math.round(12*C.offsetHeight/16)/12/1E3;D("ie")&&(z.doc.documentElement.style.fontSize=t);z.body().removeChild(C);return k};var e=null;d._getCachedFontMeasurements=function(k){if(k||!e)e=d._getFontMeasurements();return e};var b=null,c={};d._getTextBox=function(k,w,t){var C=arguments.length,u;b||(b=q.create("div",
{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},z.body()));var x=b;x.className="";var l=x.style;l.borderWidth="0";l.margin="0";l.padding="0";l.outline="0";if(1<C&&w)for(u in w)u in c||(l[u]=w[u]);2<C&&t&&(x.className=t);x.innerHTML=k;x.getBoundingClientRect?(l=x.getBoundingClientRect(),l={l:l.left,t:l.top,w:l.width||l.right-l.left,h:l.height||l.bottom-l.top}):l=n.getMarginBox(x);x.innerHTML="";return l};d._computeTextLocation=function(k,w,t,C){var u={};switch(k.align){case "end":u.x=
k.x-w;break;case "middle":u.x=k.x-w/2;break;default:u.x=k.x}u.y=k.y-t*(C?.75:1);return u};d._computeTextBoundingBox=function(k){if(!f._base._isRendered(k))return{x:0,y:0,width:0,height:0};var w=k.getShape();var t=k.getFont()||f.defaultFont;k=k.getTextWidth();t=f.normalizedLength(t.size);w=d._computeTextLocation(w,k,t,!0);return{x:w.x,y:w.y,width:k,height:t}};d._isRendered=function(k){for(k=k.parent;k&&k.getParent;)k=k.parent;return null!==k};var h=0;d._getUniqueId=function(){do var k=F._scopeName+
"xUnique"+ ++h;while(r.byId(k));return k};var g=D("pointer-events")?"touchAction":D("MSPointer")?"msTouchAction":null;d._fixMsTouchAction=g?function(k){k.rawNode.style[g]="none"}:function(){};m.mixin(f,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",
x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,
color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var k={};return function(w){var t=k[w];if(t)return new t;t=k[w]=function(){};t.prototype=f["default"+w];return new t}}(),normalizeColor:function(k){return k instanceof a?k:new a(k)},normalizeParameters:function(k,w){var t;if(w){var C={};for(t in k)t in w&&!(t in C)&&(k[t]=
w[t])}return k},makeParameters:function(k,w){var t=null;if(!w)return m.delegate(k);var C={};for(t in k)t in C||(C[t]=m.clone(t in w?w[t]:k[t]));return C},formatNumber:function(k,w){var t=k.toString();if(0<=t.indexOf("e"))t=k.toFixed(4);else{var C=t.indexOf(".");0<=C&&5<t.length-C&&(t=k.toFixed(4))}return 0>k?t:w?" "+t:t},makeFontString:function(k){return k.style+" "+k.variant+" "+k.weight+" "+k.size+" "+k.family},splitFontString:function(k){var w=f.getDefault("Font");k=k.split(/\s+/);if(!(5>k.length)){w.style=
k[0];w.variant=k[1];w.weight=k[2];var t=k[3].indexOf("/");w.size=0>t?k[3]:k[3].substring(0,t);var C=4;0>t&&("/"==k[4]?C=6:"/"==k[4].charAt(0)&&(C=5));C<k.length&&(w.family=k.slice(C).join(" "))}return w},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return f._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(k){return k*f.px_in_pt()},px2pt:function(k){return k/f.px_in_pt()},normalizedLength:function(k){if(0===k.length)return 0;if(2<k.length){var w=f.px_in_pt(),t=parseFloat(k);
switch(k.slice(-2)){case "px":return t;case "pt":return t*w;case "in":return 72*t*w;case "pc":return 12*t*w;case "mm":return t*f.mm_in_pt*w;case "cm":return t*f.cm_in_pt*w}}return parseFloat(k)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(k,w){return k&&w&&k===w},switchTo:function(k){var w="string"==typeof k?f[k]:k;w&&(y.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath Surface createSurface fixTarget".split(" "),
function(t){f[t]=w[t]}),"string"==typeof k?f.renderer=k:y.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(t){return f.renderer=f[t]&&f[t].Surface===f.Surface?t:null}))}});return f})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(F,m,a){m.switchTo(a);return m})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(F,m,a,D,z){var y=null;a.add("vml",function(r,
q,n){n.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';r="adj"in n.firstChild;n.innerHTML="";return r});return{load:function(r,q,n){function f(){q(["dojox/gfx/"+d],function(c){F.renderer=d;y=c;n(c)})}if(y&&"force"!=r)n(y);else{var d=z.forceGfxRenderer;r=!d&&(m.isString(z.gfxRenderer)?z.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var e,b;!d&&r.length;)switch(r.shift()){case "svg":"SVGAngle"in D.global&&(d="svg");break;case "vml":a("vml")&&(d="vml");break;case "silverlight":try{a("ie")?(e=new ActiveXObject("AgControl.AgControl"),
e.IsVersionSupported("1.0"))&&(b=!0):navigator.plugins["Silverlight Plug-In"]&&(b=!0)}catch(c){b=!1}finally{e=null}b&&(d="silverlight");break;case "canvas":D.global.CanvasRenderingContext2D&&(d="canvas")}"canvas"===d&&!1!==z.canvasEvents&&(d="canvasWithEvents");"svg"==d&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(f):f()}}}})},"dojox/gfx/svg":function(){define("dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e){function b(v,A){return a.doc.createElementNS?a.doc.createElementNS(v,A):a.doc.createElement(A)}function c(v,A,B,E){return v.setAttributeNS?v.setAttributeNS(A,B,E):v.setAttribute(B,E)}function h(v){return g.useSvgWeb?a.doc.createTextNode(v,!0):a.doc.createTextNode(v)}var g=f.svg={};g.useSvgWeb="undefined"!=typeof window.svgweb;var k=navigator.userAgent,w=m("ios"),t=m("android"),C=m("chrome")||t&&4<=t?"auto":"optimizeLegibility";g.xmlns={xlink:"http://www.w3.org/1999/xlink",
svg:"http://www.w3.org/2000/svg"};g.getRef=function(v){return v&&"none"!=v?v.match(/^url\(#.+\)$/)?D.byId(v.slice(5,-1)):v.match(/^#dojoUnique\d+$/)?D.byId(v.slice(1)):null:null};g.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var u=0;g.Shape=z("dojox.gfx.svg.Shape",d.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var v=
this.rawNode.getAttribute("fill");(v=g.getRef(v))&&v.parentNode.removeChild(v)}this.clip&&(v=this.rawNode.getAttribute("clip-path"))&&(v=D.byId(v.match(/gfx_clip[\d]+/)[0]))&&v.parentNode.removeChild(v);d.Shape.prototype.destroy.apply(this,arguments)},setFill:function(v){if(!v)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var A=function(E){this.setAttribute(E,B[E].toFixed(8))};if("object"==typeof v&&"type"in v){switch(v.type){case "linear":var B=
f.makeParameters(f.defaultLinearGradient,v);v=this._setFillObject(B,"linearGradient");y.forEach(["x1","y1","x2","y2"],A,v);break;case "radial":B=f.makeParameters(f.defaultRadialGradient,v);v=this._setFillObject(B,"radialGradient");y.forEach(["cx","cy","r"],A,v);break;case "pattern":B=f.makeParameters(f.defaultPattern,v),v=this._setFillObject(B,"pattern"),y.forEach(["x","y","width","height"],A,v)}this.fillStyle=B;return this}this.fillStyle=B=f.normalizeColor(v);this.rawNode.setAttribute("fill",B.toCss());
this.rawNode.setAttribute("fill-opacity",B.a);this.rawNode.setAttribute("fill-rule","evenodd");return this},setStroke:function(v){var A=this.rawNode;if(!v)return this.strokeStyle=null,A.setAttribute("stroke","none"),A.setAttribute("stroke-opacity",0),this;if("string"==typeof v||F.isArray(v)||v instanceof n)v={color:v};v=this.strokeStyle=f.makeParameters(f.defaultStroke,v);v.color=f.normalizeColor(v.color);if(v){var B=0>v.width?0:v.width;A.setAttribute("stroke",v.color.toCss());A.setAttribute("stroke-opacity",
v.color.a);A.setAttribute("stroke-width",B);A.setAttribute("stroke-linecap",v.cap);"number"==typeof v.join?(A.setAttribute("stroke-linejoin","miter"),A.setAttribute("stroke-miterlimit",v.join)):A.setAttribute("stroke-linejoin",v.join);var E=v.style.toLowerCase();E in g.dasharray&&(E=g.dasharray[E]);if(E instanceof Array){E=F._toArray(E);var G;for(G=0;G<E.length;++G)E[G]*=B;if("butt"!=v.cap){for(G=0;G<E.length;G+=2)E[G]-=B,1>E[G]&&(E[G]=1);for(G=1;G<E.length;G+=2)E[G]+=B}E=E.join(",")}A.setAttribute("stroke-dasharray",
E);A.setAttribute("dojoGfxStrokeStyle",v.style)}return this},_getParentSurface:function(){for(var v=this.parent;v&&!(v instanceof f.Surface);v=v.parent);return v},_setFillObject:function(v,A){var B=g.xmlns.svg;this.fillStyle=v;var E=this._getParentSurface().defNode,G=this.rawNode.getAttribute("fill");if(G=g.getRef(G))if(G.tagName.toLowerCase()!=A.toLowerCase()){var I=G.id;G.parentNode.removeChild(G);G=b(B,A);G.setAttribute("id",I);E.appendChild(G)}else for(;G.childNodes.length;)G.removeChild(G.lastChild);
else G=b(B,A),G.setAttribute("id",f._base._getUniqueId()),E.appendChild(G);if("pattern"==A)G.setAttribute("patternUnits","userSpaceOnUse"),B=b(B,"image"),B.setAttribute("x",0),B.setAttribute("y",0),B.setAttribute("width",(0>v.width?0:v.width).toFixed(8)),B.setAttribute("height",(0>v.height?0:v.height).toFixed(8)),c(B,g.xmlns.xlink,"xlink:href",v.src),G.appendChild(B);else for(G.setAttribute("gradientUnits","userSpaceOnUse"),E=0;E<v.colors.length;++E){I=v.colors[E];var L=b(B,"stop"),K=I.color=f.normalizeColor(I.color);
L.setAttribute("offset",I.offset.toFixed(8));L.setAttribute("stop-color",K.toCss());L.setAttribute("stop-opacity",K.a);G.appendChild(L)}this.rawNode.setAttribute("fill","url(#"+G.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return G},_applyTransform:function(){if(this.matrix){var v=this.matrix;this.rawNode.setAttribute("transform","matrix("+v.xx.toFixed(8)+","+v.yx.toFixed(8)+","+v.xy.toFixed(8)+","+v.yy.toFixed(8)+","+v.dx.toFixed(8)+
","+v.dy.toFixed(8)+")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(v){v=this.rawNode=v;"image"!=this.shape.type&&v.setAttribute("fill","none");v.setAttribute("fill-opacity",0);v.setAttribute("stroke","none");v.setAttribute("stroke-opacity",0);v.setAttribute("stroke-width",1);v.setAttribute("stroke-linecap","butt");v.setAttribute("stroke-linejoin","miter");v.setAttribute("stroke-miterlimit",4);v.__gfxObject__=this},setShape:function(v){this.shape=f.makeParameters(this.shape,
v);for(var A in this.shape)if("type"!=A){v=this.shape[A];if("width"===A||"height"===A)v=0>v?0:v;this.rawNode.setAttribute(A,v)}this.bbox=null;return this},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this},setClip:function(v){this.inherited(arguments);var A=v?"width"in v?"rect":"cx"in v?"ellipse":"points"in v?"polyline":"d"in v?"path":null:null;
if(v&&!A)return this;"polyline"===A&&(v=F.clone(v),v.points=v.points.join(","));var B,E=q.get(this.rawNode,"clip-path");E&&(B=D.byId(E.match(/gfx_clip[\d]+/)[0]))&&B.removeChild(B.childNodes[0]);v?(B?(A=b(g.xmlns.svg,A),B.appendChild(A)):(E="gfx_clip"+ ++u,this.rawNode.setAttribute("clip-path","url(#"+E+")"),B=b(g.xmlns.svg,"clipPath"),A=b(g.xmlns.svg,A),B.appendChild(A),this.rawNode.parentNode.insertBefore(B,this.rawNode),q.set(B,"id",E)),q.set(A,v)):(this.rawNode.removeAttribute("clip-path"),B&&
B.parentNode.removeChild(B));return this},_removeClipNode:function(){var v,A=q.get(this.rawNode,"clip-path");A&&(v=D.byId(A.match(/gfx_clip[\d]+/)[0]))&&v.parentNode.removeChild(v);return v}});g.Group=z("dojox.gfx.svg.Group",g.Shape,{constructor:function(){d.Container._init.call(this)},setRawNode:function(v){this.rawNode=v;this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0);g.Shape.prototype.destroy.apply(this,arguments)}});g.Group.nodeType="g";g.Rect=z("dojox.gfx.svg.Rect",[g.Shape,
d.Rect],{setShape:function(v){this.shape=f.makeParameters(this.shape,v);this.bbox=null;for(var A in this.shape)if("type"!=A&&"r"!=A){v=this.shape[A];if("width"===A||"height"===A)v=0>v?0:v;this.rawNode.setAttribute(A,v)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this}});g.Rect.nodeType="rect";g.Ellipse=z("dojox.gfx.svg.Ellipse",[g.Shape,d.Ellipse],{});g.Ellipse.nodeType="ellipse";g.Circle=z("dojox.gfx.svg.Circle",[g.Shape,
d.Circle],{});g.Circle.nodeType="circle";g.Line=z("dojox.gfx.svg.Line",[g.Shape,d.Line],{});g.Line.nodeType="line";g.Polyline=z("dojox.gfx.svg.Polyline",[g.Shape,d.Polyline],{setShape:function(v,A){v&&v instanceof Array?(this.shape=f.makeParameters(this.shape,{points:v}),A&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=f.makeParameters(this.shape,v);this.bbox=null;this._normalizePoints();for(var B=[],E=this.shape.points,G=0;G<E.length;++G)B.push(E[G].x.toFixed(8),
E[G].y.toFixed(8));this.rawNode.setAttribute("points",B.join(" "));return this}});g.Polyline.nodeType="polyline";g.Image=z("dojox.gfx.svg.Image",[g.Shape,d.Image],{setShape:function(v){this.shape=f.makeParameters(this.shape,v);this.bbox=null;v=this.rawNode;for(var A in this.shape)if("type"!=A&&"src"!=A){var B=this.shape[A];if("width"===A||"height"===A)B=0>B?0:B;v.setAttribute(A,B)}v.setAttribute("preserveAspectRatio","none");c(v,g.xmlns.xlink,"xlink:href",this.shape.src);v.__gfxObject__=this;return this}});
g.Image.nodeType="image";g.Text=z("dojox.gfx.svg.Text",[g.Shape,d.Text],{setShape:function(v){this.shape=f.makeParameters(this.shape,v);this.bbox=null;v=this.rawNode;var A=this.shape;v.setAttribute("x",A.x);v.setAttribute("y",A.y);v.setAttribute("text-anchor",A.align);v.setAttribute("text-decoration",A.decoration);v.setAttribute("rotate",A.rotated?90:0);v.setAttribute("kerning",A.kerning?"auto":0);v.setAttribute("text-rendering",C);v.firstChild?v.firstChild.nodeValue=A.text:v.appendChild(h(A.text));
return this},getTextWidth:function(){var v=this.rawNode,A=v.parentNode;v=v.cloneNode(!0);v.style.visibility="hidden";var B=0,E=v.firstChild.nodeValue;A.appendChild(v);if(""!=E)for(;!B;)B=v.getBBox?parseInt(v.getBBox().width):68;A.removeChild(v);return B},getBoundingBox:function(){var v=null;if(this.getShape().text)try{v=this.rawNode.getBBox()}catch(A){v={x:0,y:0,width:0,height:0}}return v}});g.Text.nodeType="text";g.Path=z("dojox.gfx.svg.Path",[g.Shape,e.Path],{_updateWithSegment:function(v){this.inherited(arguments);
"string"==typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)},setShape:function(v){this.inherited(arguments);this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this}});g.Path.nodeType="path";g.TextPath=z("dojox.gfx.svg.TextPath",[g.Shape,e.TextPath],{_updateWithSegment:function(v){this.inherited(arguments);this._setTextPath()},setShape:function(v){this.inherited(arguments);this._setTextPath();return this},_setTextPath:function(){if("string"==
typeof this.shape.path){var v=this.rawNode;if(!v.firstChild){var A=b(g.xmlns.svg,"textPath"),B=h("");A.appendChild(B);v.appendChild(A)}A=(A=v.firstChild.getAttributeNS(g.xmlns.xlink,"href"))&&g.getRef(A);if(!A&&(B=this._getParentSurface())){B=B.defNode;A=b(g.xmlns.svg,"path");var E=f._base._getUniqueId();A.setAttribute("id",E);B.appendChild(A);c(v.firstChild,g.xmlns.xlink,"xlink:href","#"+E)}A&&A.setAttribute("d",this.shape.path)}},_setText:function(){var v=this.rawNode;if(!v.firstChild){var A=b(g.xmlns.svg,
"textPath"),B=h("");A.appendChild(B);v.appendChild(A)}v=v.firstChild;A=this.text;v.setAttribute("alignment-baseline","middle");switch(A.align){case "middle":v.setAttribute("text-anchor","middle");v.setAttribute("startOffset","50%");break;case "end":v.setAttribute("text-anchor","end");v.setAttribute("startOffset","100%");break;default:v.setAttribute("text-anchor","start"),v.setAttribute("startOffset","0%")}v.setAttribute("baseline-shift","0.5ex");v.setAttribute("text-decoration",A.decoration);v.setAttribute("rotate",
A.rotated?90:0);v.setAttribute("kerning",A.kerning?"auto":0);v.firstChild.data=A.text}});g.TextPath.nodeType="text";var x=534<function(){var v=/WebKit\/(\d*)/.exec(k);return v?v[1]:0}();g.Surface=z("dojox.gfx.svg.Surface",d.Surface,{constructor:function(){d.Container._init.call(this)},destroy:function(){d.Container.clear.call(this,!0);this.defNode=null;this.inherited(arguments)},setDimensions:function(v,A){if(!this.rawNode)return this;var B=0>v?0:v,E=0>A?0:A;this.rawNode.setAttribute("width",B);this.rawNode.setAttribute("height",
E);x&&(this.rawNode.style.width=B,this.rawNode.style.height=E);return this},getDimensions:function(){return this.rawNode?{width:f.normalizedLength(this.rawNode.getAttribute("width")),height:f.normalizedLength(this.rawNode.getAttribute("height"))}:null}});g.createSurface=function(v,A,B){var E=new g.Surface;E.rawNode=b(g.xmlns.svg,"svg");E.rawNode.setAttribute("overflow","hidden");A&&E.rawNode.setAttribute("width",0>A?0:A);B&&E.rawNode.setAttribute("height",0>B?0:B);A=b(g.xmlns.svg,"defs");E.rawNode.appendChild(A);
E.defNode=A;E._parent=D.byId(v);E._parent.appendChild(E.rawNode);f._base._fixMsTouchAction(E);return E};m={_setFont:function(){var v=this.fontStyle;this.rawNode.setAttribute("font-style",v.style);this.rawNode.setAttribute("font-variant",v.variant);this.rawNode.setAttribute("font-weight",v.weight);this.rawNode.setAttribute("font-size",v.size);this.rawNode.setAttribute("font-family",v.family)}};var l=d.Container;z=g.Container={openBatch:function(){if(!this._batch){var v=g.useSvgWeb?a.doc.createDocumentFragment(!0):
a.doc.createDocumentFragment();this.fragment=v}++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment);return this},add:function(v){this!=v.getParent()&&(this.fragment?this.fragment.appendChild(v.rawNode):this.rawNode.appendChild(v.rawNode),l.add.apply(this,arguments),v.setClip(v.clip));return this},remove:function(v,A){this==v.getParent()&&(this.rawNode==v.rawNode.parentNode&&
this.rawNode.removeChild(v.rawNode),this.fragment&&this.fragment==v.rawNode.parentNode&&this.fragment.removeChild(v.rawNode),v._removeClipNode(),l.remove.apply(this,arguments));return this},clear:function(){for(var v=this.rawNode;v.lastChild;)v.removeChild(v.lastChild);var A=this.defNode;if(A){for(;A.lastChild;)A.removeChild(A.lastChild);v.appendChild(A)}return l.clear.apply(this,arguments)},getBoundingBox:l.getBoundingBox,_moveChildToFront:l._moveChildToFront,_moveChildToBack:l._moveChildToBack};
e=g.Creator={createObject:function(v,A){if(!this.rawNode)return null;var B=new v,E=b(g.xmlns.svg,v.nodeType);B.setRawNode(E);B.setShape(A);this.add(B);return B}};F.extend(g.Text,m);F.extend(g.TextPath,m);F.extend(g.Group,z);F.extend(g.Group,d.Creator);F.extend(g.Group,e);F.extend(g.Surface,z);F.extend(g.Surface,d.Creator);F.extend(g.Surface,e);g.fixTarget=function(v,A){v.gfxTarget||(v.gfxTarget=w&&v.target.wholeText?v.target.parentElement.__gfxObject__:v.target.__gfxObject__);return!0};g.useSvgWeb&&
(g.createSurface=function(v,A,B){var E=new g.Surface;A=0>A?0:A;B=0>B?0:B;if(!A||!B){var G=r.position(v);A=A||G.w;B=B||G.h}v=D.byId(v);G=v.id?v.id+"_svgweb":f._base._getUniqueId();var I=b(g.xmlns.svg,"svg");I.id=G;I.setAttribute("width",A);I.setAttribute("height",B);svgweb.appendChild(I,v);I.addEventListener("SVGLoad",function(){E.rawNode=this;E.isLoaded=!0;var L=b(g.xmlns.svg,"defs");E.rawNode.appendChild(L);E.defNode=L;if(E.onLoad)E.onLoad(E)},!1);E.isLoaded=!1;return E},g.Surface.extend({destroy:function(){var v=
this.rawNode;svgweb.removeChild(v,v.parentNode)}}),m={connect:function(v,A,B){"on"===v.substring(0,2)&&(v=v.substring(2));B=2==arguments.length?A:F.hitch(A,B);this.getEventSource().addEventListener(v,B,!1);return[this,v,B]},disconnect:function(v){this.getEventSource().removeEventListener(v[1],v[2],!1);delete v[0]}},F.extend(g.Shape,m),F.extend(g.Surface,m));return g})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),
function(F,m,a,D,z,y,r,q,n,f){function d(b,c){for(var h=b.length-1;c<h;)b[c]=b[++c];b.length=h}var e=F.shape={};e.Shape=a("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(z("gfxRegistry")){var b=e.register(this);this.getUID=function(){return b}}},destroy:function(){z("gfxRegistry")&&e.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=
null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var b=this.getBoundingBox();if(!b)return null;var c=this._getRealMatrix();return[f.multiplyPoint(c,b.x,b.y),f.multiplyPoint(c,b.x+b.width,b.y),f.multiplyPoint(c,b.x+
b.width,b.y+b.height),f.multiplyPoint(c,b.x,b.y+b.height)]},getEventSource:function(){return this.rawNode},setClip:function(b){this.clip=b},getClip:function(){return this.clip},setShape:function(b){this.shape=F.makeParameters(this.shape,b);this.bbox=null;return this},setFill:function(b){if(!b)return this.fillStyle=null,this;var c=null;if("object"==typeof b&&"type"in b)switch(b.type){case "linear":c=F.makeParameters(F.defaultLinearGradient,b);break;case "radial":c=F.makeParameters(F.defaultRadialGradient,
b);break;case "pattern":c=F.makeParameters(F.defaultPattern,b)}else c=F.normalizeColor(b);this.fillStyle=c;return this},setStroke:function(b){if(!b)return this.strokeStyle=null,this;if("string"==typeof b||m.isArray(b)||b instanceof n)b={color:b};b=this.strokeStyle=F.makeParameters(F.defaultStroke,b);b.color=F.normalizeColor(b.color);return this},setTransform:function(b){this.matrix=f.clone(b?f.normalize(b):f.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var b=
this.getParent();b&&(b._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var b=this.getParent();b&&(b._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(b){return b?this.setTransform([this.matrix,b]):this},applyLeftTransform:function(b){return b?this.setTransform([b,this.matrix]):this},applyTransform:function(b){return b?this.setTransform([this.matrix,b]):this},removeShape:function(b){this.parent&&
this.parent.remove(this,b);return this},_setParent:function(b,c){this.parent=b;return this._updateParentMatrix(c)},_updateParentMatrix:function(b){this.parentMatrix=b?f.clone(b):null;return this._applyTransform()},_getRealMatrix:function(){for(var b=this.matrix,c=this.parent;c;)c.matrix&&(b=f.multiply(c.matrix,b)),c=c.parent;return b}});e._eventsProcessing={on:function(b,c){return y(this.getEventSource(),b,e.fixCallback(this,F.fixTarget,c))},connect:function(b,c,h){"on"==b.substring(0,2)&&(b=b.substring(2));
return this.on(b,h?m.hitch(c,h):c)},disconnect:function(b){return b.remove()}};e.fixCallback=function(b,c,h,g){g||(g=h,h=null);if(m.isString(g)){h=h||D.global;if(!h[g])throw['dojox.gfx.shape.fixCallback: scope["',g,'"] is null (scope\x3d"',h,'")'].join("");return function(k){return c(k,b)?h[g].apply(h,arguments||[]):void 0}}return h?function(k){return c(k,b)?g.apply(h,arguments||[]):void 0}:function(k){return c(k,b)?g.apply(h,arguments):void 0}};m.extend(e.Shape,e._eventsProcessing);e.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(b){var c=b.getParent();c&&c.remove(b,!0);this.children.push(b);return b._setParent(this,this._getRealMatrix())},remove:function(b,c){for(var h=0;h<this.children.length;++h)if(this.children[h]==b){c||(b.parent=null,b.parentMatrix=null);d(this.children,h);break}return this},clear:function(b){for(var c,h=0;h<this.children.length;++h)c=this.children[h],c.parent=null,c.parentMatrix=null,b&&c.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var b=null;r.forEach(this.children,function(c){var h=c.getBoundingBox();h&&((c=c.getTransform())&&(h=f.multiplyRectangle(c,h)),b?(b.x=Math.min(b.x,h.x),b.y=Math.min(b.y,h.y),b.endX=Math.max(b.endX,h.x+h.width),b.endY=Math.max(b.endY,h.y+h.height)):b={x:h.x,y:h.y,endX:h.x+h.width,endY:h.y+h.height})});b&&(b.width=b.endX-b.x,b.height=b.endY-b.y);return b}return null},_moveChildToFront:function(b){for(var c=0;c<this.children.length;++c)if(this.children[c]==
b){d(this.children,c);this.children.push(b);break}return this},_moveChildToBack:function(b){for(var c=0;c<this.children.length;++c)if(this.children[c]==b){d(this.children,c);this.children.unshift(b);break}return this}};e.Surface=a("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){r.forEach(this._nodes,q.destroy);this._nodes=[];r.forEach(this._events,function(b){b&&b.remove()});this._events=[];this.rawNode=null;
if(z("ie"))for(;this._parent.lastChild;)q.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(b){},whenLoaded:function(b,c){var h=m.hitch(b,c);if(this.isLoaded)h(this);else y.once(this,"load",function(g){h(g)})}});m.extend(e.Surface,e._eventsProcessing);e.Rect=a("dojox.gfx.shape.Rect",e.Shape,{constructor:function(b){this.shape=F.getDefault("Rect");this.rawNode=
b},getBoundingBox:function(){return this.shape}});e.Ellipse=a("dojox.gfx.shape.Ellipse",e.Shape,{constructor:function(b){this.shape=F.getDefault("Ellipse");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=this.shape;this.bbox={x:b.cx-b.rx,y:b.cy-b.ry,width:2*b.rx,height:2*b.ry}}return this.bbox}});e.Circle=a("dojox.gfx.shape.Circle",e.Shape,{constructor:function(b){this.shape=F.getDefault("Circle");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=this.shape;this.bbox={x:b.cx-
b.r,y:b.cy-b.r,width:2*b.r,height:2*b.r}}return this.bbox}});e.Line=a("dojox.gfx.shape.Line",e.Shape,{constructor:function(b){this.shape=F.getDefault("Line");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=this.shape;this.bbox={x:Math.min(b.x1,b.x2),y:Math.min(b.y1,b.y2),width:Math.abs(b.x2-b.x1),height:Math.abs(b.y2-b.y1)}}return this.bbox}});e.Polyline=a("dojox.gfx.shape.Polyline",e.Shape,{constructor:function(b){this.shape=F.getDefault("Polyline");this.rawNode=b},setShape:function(b,
c){b&&b instanceof Array?(this.inherited(arguments,[{points:b}]),c&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[b]);return this},_normalizePoints:function(){var b=this.shape.points,c=b&&b.length;if(c&&"number"==typeof b[0]){for(var h=[],g=0;g<c;g+=2)h.push({x:b[g],y:b[g+1]});this.shape.points=h}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var b=this.shape.points,c=b.length,h=b[0],g=h.x,k=h.y,w=h.x,t=h.y,C=1;C<c;++C)h=
b[C],g>h.x&&(g=h.x),w<h.x&&(w=h.x),k>h.y&&(k=h.y),t<h.y&&(t=h.y);this.bbox={x:g,y:k,width:w-g,height:t-k}}return this.bbox}});e.Image=a("dojox.gfx.shape.Image",e.Shape,{constructor:function(b){this.shape=F.getDefault("Image");this.rawNode=b},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});e.Text=a(e.Shape,{constructor:function(b){this.fontStyle=null;this.shape=F.getDefault("Text");this.rawNode=b},getFont:function(){return this.fontStyle},
setFont:function(b){this.fontStyle="string"==typeof b?F.splitFontString(b):F.makeParameters(F.defaultFont,b);this._setFont();return this},getBoundingBox:function(){var b=null;this.getShape().text&&(b=F._base._computeTextBoundingBox(this));return b}});e.Creator={createShape:function(b){switch(b.type){case F.defaultPath.type:return this.createPath(b);case F.defaultRect.type:return this.createRect(b);case F.defaultCircle.type:return this.createCircle(b);case F.defaultEllipse.type:return this.createEllipse(b);
case F.defaultLine.type:return this.createLine(b);case F.defaultPolyline.type:return this.createPolyline(b);case F.defaultImage.type:return this.createImage(b);case F.defaultText.type:return this.createText(b);case F.defaultTextPath.type:return this.createTextPath(b)}return null},createGroup:function(){return this.createObject(F.Group)},createRect:function(b){return this.createObject(F.Rect,b)},createEllipse:function(b){return this.createObject(F.Ellipse,b)},createCircle:function(b){return this.createObject(F.Circle,
b)},createLine:function(b){return this.createObject(F.Line,b)},createPolyline:function(b){return this.createObject(F.Polyline,b)},createImage:function(b){return this.createObject(F.Image,b)},createText:function(b){return this.createObject(F.Text,b)},createPath:function(b){return this.createObject(F.Path,b)},createTextPath:function(b){return this.createObject(F.TextPath,{}).setText(b)},createObject:function(b,c){return null}};return e})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/declare","./matrix","./shape"],function(F,m,a,D,z){z=a("dojox.gfx.path.Path",z.Shape,{constructor:function(y){this.shape=m.clone(F.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=y;this.segmented=!1},setAbsoluteMode:function(y){this._confirmSegmented();this.absolute="string"==typeof y?"absolute"==y:y;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&
"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var y=this.bbox,r=this._getRealMatrix();this.bbox=null;for(var q=0,n=this.segments.length;q<n;++q)this._updateWithSegment(this.segments[q],r);r=this.bbox;this.bbox=y;return this.tbbox=r?[{x:r.l,y:r.t},{x:r.r,y:r.t},{x:r.r,y:r.b},{x:r.l,y:r.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in
this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(y,r,q){q&&(r=D.multiplyPoint(q,y,r),y=r.x,r=r.y);this.bbox&&"l"in this.bbox?(this.bbox.l>y&&(this.bbox.l=y),this.bbox.r<y&&(this.bbox.r=y),this.bbox.t>r&&(this.bbox.t=r),this.bbox.b<r&&(this.bbox.b=r)):this.bbox={l:y,b:r,r:y,t:r}},_updateWithSegment:function(y,r){var q=y.args,n=q.length,f;switch(y.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(f=0;f<n;f+=2)this._updateBBox(q[f],
q[f+1],r);this.last.x=q[n-2];this.last.y=q[n-1];this.absolute=!0;break;case "H":for(f=0;f<n;++f)this._updateBBox(q[f],this.last.y,r);this.last.x=q[n-1];this.absolute=!0;break;case "V":for(f=0;f<n;++f)this._updateBBox(this.last.x,q[f],r);this.last.y=q[n-1];this.absolute=!0;break;case "m":f=0;"x"in this.last||(this._updateBBox(this.last.x=q[0],this.last.y=q[1],r),f=2);for(;f<n;f+=2)this._updateBBox(this.last.x+=q[f],this.last.y+=q[f+1],r);this.absolute=!1;break;case "l":case "t":for(f=0;f<n;f+=2)this._updateBBox(this.last.x+=
q[f],this.last.y+=q[f+1],r);this.absolute=!1;break;case "h":for(f=0;f<n;++f)this._updateBBox(this.last.x+=q[f],this.last.y,r);this.absolute=!1;break;case "v":for(f=0;f<n;++f)this._updateBBox(this.last.x,this.last.y+=q[f],r);this.absolute=!1;break;case "c":for(f=0;f<n;f+=6)this._updateBBox(this.last.x+q[f],this.last.y+q[f+1],r),this._updateBBox(this.last.x+q[f+2],this.last.y+q[f+3],r),this._updateBBox(this.last.x+=q[f+4],this.last.y+=q[f+5],r);this.absolute=!1;break;case "s":case "q":for(f=0;f<n;f+=
4)this._updateBBox(this.last.x+q[f],this.last.y+q[f+1],r),this._updateBBox(this.last.x+=q[f+2],this.last.y+=q[f+3],r);this.absolute=!1;break;case "A":for(f=0;f<n;f+=7)this._updateBBox(q[f+5],q[f+6],r);this.last.x=q[n-2];this.last.y=q[n-1];this.absolute=!0;break;case "a":for(f=0;f<n;f+=7)this._updateBBox(this.last.x+=q[f+5],this.last.y+=q[f+6],r);this.absolute=!1}var d=[y.action];for(f=0;f<n;++f)d.push(F.formatNumber(q[f],!0));if("string"==typeof this.shape.path)this.shape.path+=d.join("");else for(f=
0,n=d.length;f<n;++f)this.shape.path.push(d[f])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(y,r){this.tbbox=null;var q=this._validSegments[y.toLowerCase()];"number"==typeof q&&(q?r.length>=q&&(q={action:y,args:r.slice(0,r.length-r.length%q)},this.segments.push(q),this._updateWithSegment(q)):(q={action:y,args:[]},this.segments.push(q),this._updateWithSegment(q)))},_collectArgs:function(y,r){for(var q=0;q<r.length;++q){var n=r[q];"boolean"==typeof n?y.push(n?1:0):
"number"==typeof n?y.push(n):n instanceof Array?this._collectArgs(y,n):"x"in n&&"y"in n&&y.push(n.x,n.y)}},moveTo:function(){this._confirmSegmented();var y=[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?"M":"m",y);return this},lineTo:function(){this._confirmSegmented();var y=[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?"L":"l",y);return this},hLineTo:function(){this._confirmSegmented();var y=[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?
"H":"h",y);return this},vLineTo:function(){this._confirmSegmented();var y=[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?"V":"v",y);return this},curveTo:function(){this._confirmSegmented();var y=[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?"C":"c",y);return this},smoothCurveTo:function(){this._confirmSegmented();var y=[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?"S":"s",y);return this},qCurveTo:function(){this._confirmSegmented();var y=
[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?"Q":"q",y);return this},qSmoothCurveTo:function(){this._confirmSegmented();var y=[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?"T":"t",y);return this},arcTo:function(){this._confirmSegmented();var y=[];this._collectArgs(y,arguments);this._pushSegment(this.absolute?"A":"a",y);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var y=
this.shape.path;this.shape.path=[];this._setPath(y);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(y){y=m.isArray(y)?y:y.match(F.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(y){for(var r="",q=[],n=y.length,f=0;f<n;++f){var d=y[f],e=parseFloat(d);isNaN(e)?(r&&this._pushSegment(r,q),q=[],r=d):q.push(e)}this._pushSegment(r,q)}},setShape:function(y){this.inherited(arguments,["string"==typeof y?{path:y}:y]);this.segmented=!1;this.segments=
[];F.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});a=a("dojox.gfx.path.TextPath",z,{constructor:function(y){"text"in this||(this.text=m.clone(F.defaultTextPath));"fontStyle"in this||(this.fontStyle=m.clone(F.defaultFont))},getText:function(){return this.text},setText:function(y){this.text=F.makeParameters(this.text,"string"==typeof y?{text:y}:y);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(y){this.fontStyle="string"==typeof y?
F.splitFontString(y):F.makeParameters(F.defaultFont,y);this._setFont();return this}});return F.path={Path:z,TextPath:a}})},"dojox/gfx/filters":function(){define(["dojo/_base/lang","dojo/_base/array"],function(F,m){var a={},D={x:"0%",y:"0%",width:"100%",height:"100%"},z={};a.createFilter=function(e,b){var c=F.mixin({},D,e);c.primitives||(c.primitives=[]);b&&Array.prototype.push.apply(c.primitives,b);return c};var y=function(e,b,c){b instanceof Array&&(c=b,b=null);b=F.mixin({},b);b.children=c;b.tag=
e;return b};m.forEach("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feFlood feGaussianBlur feImage feMorphology feOffset feSpecularLighting feTile feTurbulence feDistantLight fePointLight feSpotLight feMergeNode feFuncA feFuncR feFuncG feFuncB".split(" "),function(e){a[e]=function(b,c){return y(e,b,c)}});a.feMerge=function(e,b){if("string"===typeof e){for(var c=[],h=0;h<arguments.length;++h)c.push(a.feMergeNode({"in":arguments[h]}));return y("feMerge",
{},c)}return y("feMerge",e,b)};var r=a.createFilter;z.convolutions=[r({_gfxName:"boxBlur3"},[a.feConvolveMatrix({"in":"SourceGraphic",order:3,divisor:9,kernelMatrix:"1,1,1,1,1,1,1,1,1"})]),r({_gfxName:"boxBlur5"},[a.feConvolveMatrix({"in":"SourceGraphic",order:5,divisor:25,kernelMatrix:"1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"})]),r({_gfxName:"verticalEdges",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"-1 0 1 -1 0 1 -1 0 1"}),
a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",tableValues:"1,1"})])]),r({_gfxName:"horizontalEdges",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"1 1 1 0 0 0 -1 -1 -1"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",tableValues:"1,1"})])]),r({_gfxName:"allEdges3",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"-1 -1 -1 -1 8 -1 -1 -1 -1"}),
a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",tableValues:"1,1"})])]),r({_gfxName:"edgeEnhance",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:-1,kernelMatrix:"0 1 0 1 -5 1 0 1 0"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",tableValues:"1,1"})])])];m.forEach(z.convolutions,function(e){F.mixin(e,D)});z.shadows=[r({_gfxName:"fastSmallDropShadow"},[a.feColorMatrix({"in":"SourceAlpha",type:"matrix",result:"grey",
values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.7,0"}),a.feOffset({dx:3,dy:3,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),r({_gfxName:"fastDropShadow"},[a.feColorMatrix({"in":"SourceAlpha",type:"matrix",result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.7,0"}),a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),r({_gfxName:"fastDropShadowLight"},[a.feColorMatrix({"in":"SourceAlpha",
type:"matrix",result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.4,0"}),a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),r({_gfxName:"dropShadow"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:4}),a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),r({_gfxName:"dropShadowLight"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:4,result:"blur"}),a.feComponentTransfer({"in":"blur",
result:"lessblur"},[a.feFuncA({type:"linear",slope:.5})]),a.feOffset({"in":"lessblur",dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),r({_gfxName:"smallDropShadow"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:3}),a.feOffset({dx:2,dy:2,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),r({_gfxName:"smallDropShadowLight"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:3,result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",
slope:.5})]),a.feOffset({"in":"lessblur",dx:2,dy:2,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")])];var q={x:"-10%",y:"-10%",width:"125%",height:"125%"};m.forEach(z.shadows,function(e){F.mixin(e,q)});z.blurs=[r({_gfxName:"blur1",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:1})]),r({_gfxName:"blur2",x:"-15%",y:"-15%",width:"130%",height:"130%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:2})]),r({_gfxName:"blur4",x:"-15%",
y:"-15%",width:"130%",height:"130%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:4})]),r({_gfxName:"blur8",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:8})]),r({_gfxName:"glow",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:2}),a.feComponentTransfer([a.feFuncA({type:"linear",slope:10})])])];z.colors=[r({_gfxName:"negate"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"1,0"}),
a.feFuncG({type:"table",tableValues:"1,0"}),a.feFuncB({type:"table",tableValues:"1,0"})])]),r({_gfxName:"sepia"},[a.feColorMatrix({result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,1,0"}),a.feComponentTransfer({"in":"grey"},[a.feFuncR({type:"linear",slope:.5,intercept:.5}),a.feFuncB({type:"table",tableValues:"0,0"})])]),r({_gfxName:"grayscale"},[a.feColorMatrix({values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,1,0"})]),
r({_gfxName:"showRed"},[a.feComponentTransfer([a.feFuncG({type:"table",tableValues:"0,0"}),a.feFuncB({type:"table",tableValues:"0,0"})])]),r({_gfxName:"showGreen"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"0,0"}),a.feFuncB({type:"table",tableValues:"0,0"})])]),r({_gfxName:"showBlue"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"0,0"}),a.feFuncG({type:"table",tableValues:"0,0"})])]),r({_gfxName:"hueRotate60"},[a.feColorMatrix({type:"hueRotate",values:60})]),r({_gfxName:"hueRotate120"},
[a.feColorMatrix({type:"hueRotate",values:120})]),r({_gfxName:"hueRotate180"},[a.feColorMatrix({type:"hueRotate",values:180})]),r({_gfxName:"hueRotate270"},[a.feColorMatrix({type:"hueRotate",values:270})])];m.forEach(z.colors,function(e){F.mixin(e,D)});z.miscs=[r({_gfxName:"thinEmbossDropShadow",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:1,result:"blur"}),a.feOffset({"in":"blur",dx:6,dy:6,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:8,
specularConstant:1,specularExponent:12,result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",result:"litPaint",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur","litPaint")]),r({_gfxName:"embossDropShadow",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"4",result:"blur"}),a.feOffset({"in":"blur",
dx:4,dy:4,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:5,specularConstant:.75,specularExponent:20,"lighting-color":"#bbbbbb",result:"specOut"},[a.fePointLight({x:-5E3,y:-1E4,z:2E4})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0,result:"litPaint"}),a.feMerge("offsetBlur","litPaint")]),r({_gfxName:"largeEmbossDropShadow",x:"-20%",y:"-20%",width:"140%",
height:"140%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:5,result:"blur"}),a.feOffset({"in":"blur",dx:6,dy:6,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:8,specularConstant:1,specularExponent:12,result:"spec"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"spec",in2:"SourceGraphic",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",result:"litPaint",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur",
"litPaint")]),r({_gfxName:"thinEmbossDropShadowLight",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:1,result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),a.feSpecularLighting({"in":"lessblur",surfaceScale:8,specularConstant:1,specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",
in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",result:"litPaint",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur","litPaint")]),r({_gfxName:"embossDropShadowLight",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"3",result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),
a.feSpecularLighting({"in":"lessblur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",result:"litPaint",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"}),a.feMerge("offsetBlur","litPaint")]),r({_gfxName:"largeEmbossDropShadowLight",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feGaussianBlur({"in":"SourceAlpha",
stdDeviation:"5",result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"spec"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"spec",in2:"SourceGraphic",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",
k1:"0",k2:"1",k3:"1",k4:"0",result:"litPaint"}),a.feMerge("offsetBlur","litPaint")]),r({_gfxName:"fuzzy",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"turb2"}),a.feDisplacementMap({"in":"SourceGraphic",in2:"turb2",result:"turb2",scale:"20",xChannelSelector:"R",yChannelSelector:"G"})]),r({_gfxName:"veryFuzzy",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",
result:"turb2"}),a.feDisplacementMap({"in":"SourceGraphic",in2:"turb2",result:"turb2",scale:"35",xChannelSelector:"R",yChannelSelector:"G"})]),r({_gfxName:"melting",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"2",result:"turb"}),a.feDisplacementMap({result:"bended","in":"SourceGraphic",in2:"turb",scale:"25",xChannelSelector:"R",yChannelSelector:"G"}),a.feGaussianBlur({"in":"bended",stdDeviation:"1",result:"bb"}),a.feComponentTransfer({"in":"bb",
result:"BendedSource"},[a.feFuncA({type:"linear",slope:10,intercept:"-1"})]),a.feComponentTransfer({"in":"BendedSource",result:"BendedAlpha"},[a.feFuncR({type:"linear",slope:"0",intercept:"0"}),a.feFuncG({type:"linear",slope:"0",intercept:"0"}),a.feFuncB({type:"linear",slope:"0",intercept:"0"}),a.feFuncA({type:"linear",slope:"1",intercept:"0"})]),a.feGaussianBlur({"in":"BendedAlpha",stdDeviation:"1",result:"blur"}),a.feSpecularLighting({"in":"blur","lighting-color":"rgb(80%, 80%, 80%)",surfaceScale:"5",
specularConstant:"1",specularExponent:"10",result:"specularOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"20000"})]),a.feComposite({"in":"specularOut",in2:"BendedAlpha",operator:"in",result:"specularOut"}),a.feComposite({"in":"BendedSource",in2:"specularOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0",result:"litPaint"})]),r({_gfxName:"impressionist",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feMorphology({"in":"SourceGraphic",operator:"dilate",radius:"2"})]),r({_gfxName:"holes",x:"0%",y:"0%",
width:"100%",height:"100%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"texture"}),a.feComponentTransfer({"in":"texture",result:"holes"},[a.feFuncA({type:"discrete",tableValues:"0,1"})]),a.feComposite({"in":"SourceGraphic",in2:"holes",operator:"out"})]),r({_gfxName:"holesComplement",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"texture"}),a.feComponentTransfer({"in":"texture",result:"holes"},
[a.feFuncA({type:"discrete",tableValues:"1,0"})]),a.feComposite({"in":"SourceGraphic",in2:"holes",operator:"out"})])];z.reliefs=[r({_gfxName:"bumpIn",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feColorMatrix({"in":"SourceGraphic",type:"luminanceToAlpha",result:"lumalpha"}),a.feComponentTransfer({"in":"lumalpha",result:"invertedalpha"},[a.feFuncA({type:"table",tableValues:"1,0"})]),a.feDiffuseLighting({"in":"invertedalpha","lighting-color":"rgb(60%, 60%, 60%)",result:"diffuse",surfaceScale:"5"},[a.feDistantLight({azimuth:"135",
elevation:"60"})]),a.feSpecularLighting({"in":"invertedalpha",result:"specular",surfaceScale:"5",specularExponent:"6"},[a.feDistantLight({azimuth:"135",elevation:"30"})]),a.feComposite({"in":"diffuse",in2:"specular",operator:"arithmetic",k2:"1.0",k3:"1.0"})]),r({_gfxName:"bumpOut",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feColorMatrix({"in":"SourceGraphic",type:"luminanceToAlpha",result:"lumalpha"}),a.feDiffuseLighting({"in":"lumalpha","lighting-color":"rgb(60%, 60%, 60%)",result:"diffuse",surfaceScale:"5"},
[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feSpecularLighting({"in":"lumalpha",result:"specular",surfaceScale:"5",specularExponent:"6"},[a.feDistantLight({azimuth:"135",elevation:"30"})]),a.feComposite({"in":"diffuse",in2:"specular",operator:"arithmetic",k2:"1.0",k3:"1.0"})]),r({_gfxName:"thinEmboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"1",result:"blur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",
result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})]),r({_gfxName:"emboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"3",result:"blur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},
[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})]),r({_gfxName:"largeEmboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"5",result:"blur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",
y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})])];z.textures=[r({_gfxName:"paper",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.01",numOctaves:"5",result:"texture"}),a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"diffuse",
in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),r({_gfxName:"swirl",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.05",numOctaves:"1",result:"texture"}),a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"diffuse",in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),r({_gfxName:"swirl2",x:"0%",y:"0%",width:"100%",
height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.15",numOctaves:"1",result:"texture"}),a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"diffuse",in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),r({_gfxName:"gold",x:"-5%",y:"-5%",width:"115%",height:"110%"},[a.feTurbulence({baseFrequency:"0.2",numOctaves:"1",type:"turbulence",result:"turb"}),a.feComposite({"in":"SourceGraphic",
in2:"turb",operator:"arithmetic",k2:"0.6",k3:"0.4",result:"turb"}),a.feComposite({"in":"turb",in2:"SourceGraphic",operator:"in",result:"bump"}),a.feDiffuseLighting({"in":"turb",surfaceScale:"6.0","lighting-color":"rgb(60%, 50%, 0%)",diffuseConstant:"1.0",result:"diffuse"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feSpecularLighting({"in":"bump",surfaceScale:"6.0",specularConstant:"1.0",specularExponent:"10.0",result:"specularOut"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"specularOut",
in2:"SourceGraphic",operator:"in",result:"specularOut"}),a.feComposite({"in":"bump",in2:"diffuse",operator:"arithmetic",k1:"0.7",k2:"0.3",result:"litPaint"}),a.feComposite({"in":"litPaint",in2:"specularOut",operator:"arithmetic",k2:"1.0",k3:"0.7",result:"litPaint"})])];for(var n in z)if(z.hasOwnProperty(n)){a[n]={};for(var f=z[n],d=0;d<f.length;++d)(function(){var e=f[d];a[n][e._gfxName]=function(b){return F.delegate(e,b)}})()}return a})},"dojox/gfx/svgext":function(){define(["dojo/dom","dojo/_base/array",
"dojo/_base/window","./_base","./svg"],function(F,m,a,D,z){function y(q,n){var f=n.ownerDocument.createElementNS(z.xmlns.svg,q.tag);n.appendChild(f);for(var d in q)d in r||f.setAttribute(d,q[d]);q.children&&m.forEach(q.children,function(e){y(e,f)});return f}a=D.svgext={};var r={primitives:null,tag:null,children:null};z.Shape.extend({addRenderingOption:function(q,n){this.rawNode.setAttribute(q,n);return this},setFilter:function(q){if(!q)return this.rawNode.removeAttribute("filter"),this.filter=null,
this;this.filter=q;q.id=q.id||D._base._getUniqueId();var n=F.byId(q.id);if(!n){n=this.rawNode.ownerDocument.createElementNS(z.xmlns.svg,"filter");n.setAttribute("filterUnits","userSpaceOnUse");for(var f in q)f in r||n.setAttribute(f,q[f]);m.forEach(q.primitives,function(d){y(d,n)});(f=this._getParentSurface())&&f.defNode.appendChild(n)}this.rawNode.setAttribute("filter","url(#"+q.id+")");return this},getFilter:function(){return this.filter}});return a})},"dojox/gfx/_gfxBidiSupport":function(){define("./_base dojo/_base/lang dojo/_base/sniff dojo/dom dojo/_base/html dojo/_base/array ./utils ./shape ./path dojox/string/BidiEngine".split(" "),
function(F,m,a,D,z,y,r,q,n,f){function d(c,h){var g=e(h);g&&F.utils.forEach(c,function(k){if(k instanceof F.Surface||k instanceof F.Group)k.textDir=g;k instanceof F.Text&&k.setShape({textDir:g});k instanceof F.TextPath&&k.setText({textDir:g})},c);return c}function e(c){var h=["ltr","rtl","auto"];return c&&(c=c.toLowerCase(),0>y.indexOf(h,c))?null:c}m.getObject("dojox.gfx._gfxBidiSupport",!0);switch(F.renderer){case "vml":F.isVml=!0;break;case "svg":F.isSvg=!0;F.svg.useSvgWeb&&(F.isSvgWeb=!0);break;
case "silverlight":F.isSilverlight=!0;break;case "canvas":case "canvasWithEvents":F.isCanvas=!0}var b=new f;m.extend(F.shape.Surface,{textDir:"",setTextDir:function(c){d(this,c)},getTextDir:function(){return this.textDir}});m.extend(F.Group,{textDir:"",setTextDir:function(c){d(this,c)},getTextDir:function(){return this.textDir}});m.extend(F.Text,{textDir:"",formatText:function(c,h){if(h&&c&&1<c.length){var g="ltr",k=h;if("auto"==k){if(F.isVml)return c;k=b.checkContextual(c)}if(F.isVml)return g=b.checkContextual(c),
k!=g?"rtl"==k?b.hasBidiChar(c)?"\u200f\u200f"+c:b.bidiTransform(c,"IRNNN","ILNNN"):"\u200e"+c:c;if(F.isSvgWeb)return"rtl"==k?b.bidiTransform(c,"IRNNN","ILNNN"):c;if(F.isSilverlight)return"rtl"==k?b.bidiTransform(c,"IRNNN","VLYNN"):b.bidiTransform(c,"ILNNN","VLYNN");if(F.isCanvas)return"rtl"==k?"\u202b"+c+"\u202c":"\u202a"+c+"\u202c";if(F.isSvg)return 4>a("ff")?"rtl"==k?b.bidiTransform(c,"IRYNN","VLNNN"):b.bidiTransform(c,"ILYNN","VLNNN"):"\u200e"+("rtl"==k?"\u202b":"\u202a")+c+"\u202c"}return c},
bidiPreprocess:function(c){return c}});m.extend(F.TextPath,{textDir:"",formatText:function(c,h){if(h&&c&&1<c.length){var g="ltr",k=h;if("auto"==k){if(F.isVml)return c;k=b.checkContextual(c)}if(F.isVml)return g=b.checkContextual(c),k!=g?"rtl"==k?b.hasBidiChar(c)?"\u200f\u200f"+c:b.bidiTransform(c,"IRNNN","ILNNN"):"\u200e"+c:c;if(F.isSvgWeb)return"rtl"==k?b.bidiTransform(c,"IRNNN","ILNNN"):c;F.isSvg&&(c=a("opera")||4<=a("ff")?"\u200e"+("rtl"==k?"\u202b":"\u202a")+c+"\u202c":"rtl"==k?b.bidiTransform(c,
"IRYNN","VLNNN"):b.bidiTransform(c,"ILYNN","VLNNN"))}return c},bidiPreprocess:function(c){c&&"string"==typeof c&&(this.origText=c,c=this.formatText(c,this.textDir));return c}});r=function(c,h,g,k){var w=c.prototype[h];c.prototype[h]=function(){var t;g&&(t=g.apply(this,arguments));t=w.call(this,t);k&&(t=k.call(this,t,arguments));return t}};q=function(c){c&&(c.textDir&&(c.textDir=e(c.textDir)),c.text&&c.text instanceof Array&&(c.text=c.text.join(",")));!c||void 0==c.text&&!c.textDir||this.textDir==
c.textDir&&c.text==this.origText||(this.origText=void 0!=c.text?c.text:this.origText,c.textDir&&(this.textDir=c.textDir),c.text=this.formatText(this.origText,this.textDir));return this.bidiPreprocess(c)};r(F.Text,"setShape",q,null);r(F.TextPath,"setText",q,null);q=function(c){(c=m.clone(c))&&this.origText&&(c.text=this.origText);return c};r(F.Text,"getShape",null,q);r(F.TextPath,"getText",null,q);q=function(c,h){var g;h&&h[0]&&(g=e(h[0]));c.setTextDir(g?g:this.textDir);return c};r(F.Surface,"createGroup",
null,q);r(F.Group,"createGroup",null,q);q=function(c){if(c){var h=c.textDir?e(c.textDir):this.textDir;h&&(c.textDir=h)}return c};r(F.Surface,"createText",q,null);r(F.Surface,"createTextPath",q,null);r(F.Group,"createText",q,null);r(F.Group,"createTextPath",q,null);F.createSurface=function(c,h,g,k){h=F[F.renderer].createSurface(c,h,g);k=e(k);if(F.isSvgWeb)return h.textDir=k?k:z.style(D.byId(c),"direction"),h;if(F.isVml||F.isSvg||F.isCanvas)h.textDir=k?k:z.style(h.rawNode,"direction");F.isSilverlight&&
(h.textDir=k?k:z.style(h._nodes[1],"direction"));return h};return F})},"dojox/gfx/utils":function(){define("dojo/_base/kernel dojo/_base/lang ./_base dojo/_base/html dojo/_base/array dojo/_base/window dojo/_base/json dojo/_base/Deferred dojo/_base/sniff require dojo/_base/config".split(" "),function(F,m,a,D,z,y,r,q,n,f,d){var e=a.utils={};m.mixin(e,{forEach:function(b,c,h){h=h||F.global;c.call(h,b);(b instanceof a.Surface||b instanceof a.Group)&&z.forEach(b.children,function(g){e.forEach(g,c,h)})},
serialize:function(b){var c={},h;if((h=b instanceof a.Surface)||b instanceof a.Group){if(c.children=z.map(b.children,e.serialize),h)return c.children}else c.shape=b.getShape();b.getTransform&&(h=b.getTransform())&&(c.transform=h);b.getStroke&&(h=b.getStroke())&&(c.stroke=h);b.getFill&&(h=b.getFill())&&(c.fill=h);b.getFont&&(h=b.getFont())&&(c.font=h);return c},toJson:function(b,c){return r.toJson(e.serialize(b),c)},deserialize:function(b,c){if(c instanceof Array)return z.map(c,m.hitch(null,e.deserialize,
b));var h="shape"in c?b.createShape(c.shape):b.createGroup();"transform"in c&&h.setTransform(c.transform);"stroke"in c&&h.setStroke(c.stroke);"fill"in c&&h.setFill(c.fill);"font"in c&&h.setFont(c.font);"children"in c&&z.forEach(c.children,m.hitch(null,e.deserialize,h));return h},fromJson:function(b,c){return e.deserialize(b,r.fromJson(c))},toSvg:function(b){var c=new q;if("svg"===a.renderer)try{var h=e._cleanSvg(e._innerXML(b.rawNode));c.callback(h)}catch(k){c.errback(k)}else{e._initSvgSerializerDeferred||
e._initSvgSerializer();var g=e.toJson(b);h=function(){try{var k=b.getDimensions(),w=k.width,t=k.height,C=e._gfxSvgProxy.document.createElement("div");e._gfxSvgProxy.document.body.appendChild(C);y.withDoc(e._gfxSvgProxy.document,function(){D.style(C,"width",w);D.style(C,"height",t)},this);e._gfxSvgProxy[dojox._scopeName].gfx.createSurface(C,w,t).whenLoaded(null,function(u){try{e._gfxSvgProxy[dojox._scopeName].gfx.utils.fromJson(u,g);var x=e._cleanSvg(C.innerHTML);u.clear();u.destroy();e._gfxSvgProxy.document.body.removeChild(C);
c.callback(x)}catch(l){c.errback(l)}})}catch(u){c.errback(u)}};0<e._initSvgSerializerDeferred.fired?h():e._initSvgSerializerDeferred.addCallback(h)}return c},_gfxSvgProxy:null,_initSvgSerializerDeferred:null,_svgSerializerInitialized:function(){e._initSvgSerializerDeferred.callback(!0)},_initSvgSerializer:function(){if(!e._initSvgSerializerDeferred){e._initSvgSerializerDeferred=new q;var b=y.doc.createElement("iframe");D.style(b,{display:"none",position:"absolute",width:"1em",height:"1em",top:"-10000px"});
var c;n("ie")?b.onreadystatechange=function(){"complete"==b.contentWindow.document.readyState&&(b.onreadystatechange=function(){},c=setInterval(function(){b.contentWindow[F.scopeMap.dojo[1]._scopeName]&&b.contentWindow[F.scopeMap.dojox[1]._scopeName].gfx&&b.contentWindow[F.scopeMap.dojox[1]._scopeName].gfx.utils&&(clearInterval(c),b.contentWindow.parent[F.scopeMap.dojox[1]._scopeName].gfx.utils._gfxSvgProxy=b.contentWindow,b.contentWindow.parent[F.scopeMap.dojox[1]._scopeName].gfx.utils._svgSerializerInitialized())},
50))}:b.onload=function(){b.onload=function(){};c=setInterval(function(){b.contentWindow[F.scopeMap.dojo[1]._scopeName]&&b.contentWindow[F.scopeMap.dojox[1]._scopeName].gfx&&b.contentWindow[F.scopeMap.dojox[1]._scopeName].gfx.utils&&(clearInterval(c),b.contentWindow.parent[F.scopeMap.dojox[1]._scopeName].gfx.utils._gfxSvgProxy=b.contentWindow,b.contentWindow.parent[F.scopeMap.dojox[1]._scopeName].gfx.utils._svgSerializerInitialized())},50)};var h=d.dojoxGfxSvgProxyFrameUrl||f.toUrl("dojox/gfx/resources/gfxSvgProxyFrame.html");
b.setAttribute("src",h.toString());y.body().appendChild(b)}},_innerXML:function(b){return b.innerXML?b.innerXML:b.xml?b.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(b):null},_cleanSvg:function(b){b&&(-1==b.indexOf('xmlns\x3d"http://www.w3.org/2000/svg"')&&(b=b.substring(4,b.length),b='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg"'+b),-1==b.indexOf('xmlns:xlink\x3d"http://www.w3.org/1999/xlink"')&&(b=b.substring(4,b.length),b='\x3csvg xmlns:xlink\x3d"http://www.w3.org/1999/xlink"'+
b),-1===b.indexOf("xlink:href")&&(b=b.replace(/href\s*=/g,"xlink:href\x3d")),b=b.replace(/<img\b([^>]*)>/gi,"\x3cimage $1 /\x3e"),b=b.replace(/\bdojoGfx\w*\s*=\s*(['"])\w*\1/g,""),b=b.replace(/\b__gfxObject__\s*=\s*(['"])\w*\1/g,""),b=b.replace(/[=]([^"']+?)(\s|>)/g,'\x3d"$1"$2'),b=b.replace(/\bstroke-opacity\w*\s*=\s*(['"])undefined\1/g,""));return b}});return e})},"dojox/string/BidiEngine":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/Stateful"],function(F,m,a){function D(sa,O,
ca,va,H){var R=sa;void 0===O&&(O=H.defInFormat);void 0===ca&&(ca=H.defOutFormat);void 0===va&&(va=H.defSwap);if(O!==ca){var W=O.substring(0,1);var pa=O.substring(1,4);var ra=ca.substring(0,1),Aa=ca.substring(1,4);"C"===pa.charAt(0)&&(pa=z(R),pa="ltr"===pa||"rtl"===pa?pa.toUpperCase():"L"===O.charAt(2)?"LTR":"RTL",O=W+pa);"C"===Aa.charAt(0)&&(pa=z(R),"rtl"===pa?Aa="RTL":"ltr"===pa?(R=R.split(""),R.reverse(),pa=z(R.join("")),Aa=pa.toUpperCase()):Aa="L"===ca.charAt(2)?"LTR":"RTL",ca=ra+Aa)}if(O===ca)return sa;
ra=O.substring(0,1);R=O.substring(1,4);W=ca.substring(0,1);Aa=ca.substring(1,4);H.inFormat=O;H.outFormat=ca;H.swap=va;if("L"===ra&&"VLTR"===ca){if("LTR"===R)return H.dir=v,y(sa,H);if("RTL"===R)return H.dir=A,y(sa,H)}if("V"===ra&&"V"===W)return H.dir="RTL"===R?A:v,q(sa,H);if("L"===ra&&"VRTL"===ca)return H.dir="LTR"===R?v:A,sa=y(sa,H),q(sa);if("VLTR"===O&&"LLTR"===ca)return H.dir=v,y(sa,H);if("V"===ra&&"L"===W&&R!==Aa)return sa=q(sa),"RTL"===R?D(sa,"LLTR","VLTR",va,H):D(sa,"LRTL","VRTL",va,H);if("VRTL"===
O&&"LRTL"===ca)return D(sa,"LRTL","VRTL",va,H);if("L"===ra&&"L"===W)return O=H.swap,H.swap=O.substr(0,1)+"N","RTL"===R?(H.dir=A,sa=y(sa,H),H.swap="N"+O.substr(1,2),H.dir=v,sa=y(sa,H)):(H.dir=v,sa=y(sa,H),H.swap="N"+O.substr(1,2),sa=D(sa,"VLTR","LRTL",H.swap,H)),sa}function z(sa){return(sa=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(sa))?"z">=sa[0]?"ltr":"rtl":""}function y(sa,O){var ca=sa.split(""),va=[];r(ca,va,O);if(0!==O.hiLevel&&O.swap.substr(0,1)!==O.swap.substr(1,
2))for(var H=0;H<ca.length;H++)if(1===va[H]){var R=H;b:{var W=void 0;for(var pa=ca[H],ra=0,Aa=G.length-1;ra<=Aa;)if(W=Math.floor((ra+Aa)/2),pa<G[W][0])Aa=W-1;else if(pa>G[W][0])ra=W+1;else{W=G[W][1];break b}W=pa}ca[R]=W}d(2,ca,va,O);d(1,ca,va,O);C=va;return ca.join("")}function r(sa,O,ca){var va=sa.length,H=ca.dir?ya:na,R=null,W=null,pa=null;R=0;W=W=null;var ra=-1,Aa=W=null,Ba=[],Ja=[];ca.hiLevel=ca.dir;ca.lastArabic=!1;ca.hasUbatAl=!1;ca.hasUbatB=!1;ca.hasUbatS=!1;for(W=0;W<va;W++){Aa=W;pa=sa[W].charCodeAt(0);
var Ka=U[pa>>8];Ba[Aa]=Ka<Da?Ka:fa[Ka-Da][pa&255]}for(Aa=0;Aa<va;Aa++){Ja[Aa]=W=e(sa,Ba,Ja,Aa,ca);R=H[R][W];W=R&240;R&=15;O[Aa]=pa=H[R][x];if(0<W){if(16===W)for(W=ra;W<Aa;W++)O[W]=1;ra=-1}if(W=H[R][l])-1===ra&&(ra=Aa);else if(-1<ra){for(W=ra;W<Aa;W++)O[W]=pa;ra=-1}Ba[Aa]===xa&&(O[Aa]=0);ca.hiLevel|=pa}if(ca.hasUbatS)for(sa=0;sa<va;sa++)if(Ba[sa]===Ha)for(O[sa]=ca.dir,H=sa-1;0<=H;H--)if(Ba[H]===ia)O[H]=ca.dir;else break}function q(sa,O){var ca=sa.split("");if(O){var va=[];r(ca,va,O);C=va}ca.reverse();
w.reverse();return ca.join("")}function n(sa){for(var O=0;O<qa.length;O++)if(sa>=qa[O]&&sa<=V[O])return!0;return!1}function f(sa,O,ca,va){for(;O*ca<va&&c(sa[O]);)O+=ca;return O*ca<va&&n(sa[O])?!0:!1}function d(sa,O,ca,va){if(!(va.hiLevel<sa))if(1!==sa||va.dir!==A||va.hasUbatB){va=O.length;for(var H=0,R,W,pa;H<va;){if(ca[H]>=sa){for(R=H+1;R<va&&ca[R]>=sa;)R++;for(W=R-1;H<W;H++,W--)pa=O[H],O[H]=O[W],O[W]=pa,pa=w[H],w[H]=w[W],w[W]=pa;H=R}H++}}else O.reverse(),w.reverse()}function e(sa,O,ca,va,H){return{UBAT_L:function(){H.lastArabic=
!1;return S},UBAT_R:function(){H.lastArabic=!1;return ma},UBAT_ON:function(){return oa},UBAT_AN:function(){return X},UBAT_EN:function(){return H.lastArabic?X:ja},UBAT_AL:function(){H.lastArabic=!0;H.hasUbatAl=!0;return ma},UBAT_WS:function(){return oa},UBAT_CS:function(){var R,W;if(1>va||va+1>=O.length||(R=ca[va-1])!==ja&&R!==X||(W=O[va+1])!==ja&&W!==X)return oa;H.lastArabic&&(W=X);return W===R?W:oa},UBAT_ES:function(){return(0<va?ca[va-1]:xa)===ja&&va+1<O.length&&O[va+1]===ja?ja:oa},UBAT_ET:function(){if(0<
va&&ca[va-1]===ja)return ja;if(H.lastArabic)return oa;for(var R=va+1,W=O.length;R<W&&O[R]===ea;)R++;return R<W&&O[R]===ja?ja:oa},UBAT_NSM:function(){if("VLTR"===H.inFormat){for(var R=O.length,W=va+1;W<R&&O[W]===za;)W++;if(W<R&&(R=sa[va],W=O[W],(1425<=R&&2303>=R||64286===R)&&(W===ma||W===Ia)))return ma}return 1>va||O[va-1]===xa?oa:ca[va-1]},UBAT_B:function(){H.lastArabic=!0;H.hasUbatB=!0;return H.dir},UBAT_S:function(){H.hasUbatS=!0;return oa},UBAT_LRE:function(){H.lastArabic=!1;return oa},UBAT_RLE:function(){H.lastArabic=
!1;return oa},UBAT_LRO:function(){H.lastArabic=!1;return oa},UBAT_RLO:function(){H.lastArabic=!1;return oa},UBAT_PDF:function(){H.lastArabic=!1;return oa},UBAT_BN:function(){return oa}}[Ca[O[va]]]()}function b(sa,O){for(var ca=0;ca<ba.length;ca++)if(sa===ba[ca])return O[ca];return sa}function c(sa){return"\u064b"<=sa&&"\u0655">=sa?!0:!1}function h(sa){if("L"===sa)return"LTR";if("R"===sa)return"RTL";if("C"===sa)return"CLR";if("D"===sa)return"CRL"}function g(sa,O){for(var ca=0;ca<I.length;ca++)if(sa===
I[ca])return O[ca];return sa}function k(sa,O,ca,va){for(var H=0;H<sa.length;H++)if(sa[H]>O||!ca&&sa[H]===O)sa[H]+=va}F.getObject("string",!0,dojox);F=m("dojox.string.BidiEngine",a,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],levels:[],bidiTransform:function(sa,O,ca){this.sourceToTarget=[];this.targetToSource=[];if(!sa)return"";var va=this.sourceToTarget,H=this.targetToSource,R=sa.length;w=[];C=[];for(var W=0;W<R;W++)va[W]=W,H[W]=W,w[W]=W;if(!this.checkParameters(O,
ca))return sa;O=this.inputFormat;ca=this.outputFormat;va=sa;va=u;W=h(O.charAt(1));H=h(ca.charAt(1));var pa="I"===O.charAt(0)?"L":O.charAt(0);R="I"===ca.charAt(0)?"L":ca.charAt(0);W=pa+W;H=R+H;R=O.charAt(2)+ca.charAt(2);va.defInFormat=W;va.defOutFormat=H;va.defSwap=R;sa=D(sa,W,H,R,va);va=!1;if("R"===ca.charAt(1))va=!0;else if("C"===ca.charAt(1)||"D"===ca.charAt(1))va=this.checkContextual(sa);H=this.sourceToTarget=w;R=Array(H.length);for(W=0;W<H.length;W++)R[H[W]]=W;t=this.targetToSource=R;if(O.charAt(3)===
ca.charAt(3))va=sa;else if("S"===ca.charAt(3))if(O=va,ca=!0,0===sa.length)va=void 0;else{void 0===O&&(O=!0);void 0===ca&&(ca=!0);sa=String(sa);sa=sa.split("");var ra=0;H=1;va=sa.length;O||(ra=sa.length-1,H=-1,va=1);R=va;W=ca;var Aa=0;va=[];for(pa=0;ra*H<R;ra+=H)if(n(sa[ra])||c(sa[ra])){var Ba;if(Ba="\u0644"===sa[ra])b:{for(var Ja=sa,Ka=ra+H,Ra=H,Va=R;Ka*Ra<Va&&c(Ja[Ka]);)Ka+=Ra;Ba=" ";if(Ka*Ra<Va)for(Ba=Ja[Ka],Ja=0;Ja<I.length;Ja++)if(I[Ja]===Ba){Ba=!0;break b}Ba=!1}if(Ba){sa[ra]=0===Aa?g(sa[ra+H],
L):g(sa[ra+H],K);ra+=H;Aa=sa;Ba=ra;Ja=H;for(Ka=R;Ba*Ja<Ka&&c(Aa[Ba]);)Ba+=Ja;Ba*Ja<Ka&&(Aa[Ba]=" ");W&&(va[pa]=ra,pa++);Aa=0}else{Ba=sa[ra];if(1===Aa){Ja=ra;if(f(sa,ra+H,H,R))b:for(Ka=sa[ra],Ra=0;Ra<ba.length;Ra++){if(Ka===ba[Ra]){Ka=J[Ra];break b}}else Ka=b(sa[ra],P);sa[Ja]=Ka}else!0===f(sa,ra+H,H,R)?sa[ra]=b(sa[ra],N):sa[ra]=b(sa[ra],T);c(Ba)||(Aa=1);b:{for(Ja=0;Ja<Z.length;Ja++)if(Z[Ja]===Ba){Ba=!0;break b}Ba=!1}!0===Ba&&(Aa=0)}}else Aa=0;H="";for(R=0;R<sa.length;R++){if(W=ca){b:{for(W=0;W<va.length;W++)if(va[W]===
R)break b;W=-1}W=-1<W}W?(k(t,R,!O,-1),w.splice(R,1)):H+=sa[R]}va=H}else if(O=sa,ca=va,sa=!0,0===O.length)va=void 0;else for(void 0===sa&&(sa=!0),void 0===ca&&(ca=!0),O=String(O),va="",H=[],H=O.split(""),R=0;R<O.length;R++)W=!1,"\ufe70"<=H[R]&&"\ufeff">H[R]?(pa=O.charCodeAt(R),"\ufef5"<=H[R]&&"\ufefc">=H[R]?(ca?(0<R&&sa&&" "===H[R-1]?va=va.substring(0,va.length-1)+"\u0644":(va+="\u0644",W=!0),va+=I[(pa-65269)/2]):(va+=I[(pa-65269)/2],va+="\u0644",R+1<O.length&&sa&&" "===H[R+1]?R++:W=!0),W&&(k(t,R,
!0,1),w.splice(R,0,w[R]))):va+=Y[pa-65136]):va+=H[R];this.sourceToTarget=w;this.targetToSource=t;this.levels=C;return va},_inputFormatSetter:function(sa){if(!B.test(sa))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=sa},_outputFormatSetter:function(sa){if(!B.test(sa))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=sa},checkParameters:function(sa,O){sa?this.set("inputFormat",sa):sa=this.inputFormat;O?this.set("outputFormat",
O):O=this.outputFormat;return sa===O?!1:!0},checkContextual:function(sa){sa=z(sa);if("ltr"!==sa&&"rtl"!==sa){try{sa=document.dir.toLowerCase()}catch(O){}"ltr"!==sa&&"rtl"!==sa&&(sa="ltr")}return sa},hasBidiChar:function(sa){return E.test(sa)}});var w=[],t=[],C=[],u={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},x=5,l=6,v=0,A=1,B=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,E=/[\u0591-\u06ff\ufb1d-\ufefc]/,
G=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],I=["\u0622",
"\u0623","\u0625","\u0627"],L=["\ufef5","\ufef7","\ufef9","\ufefb"],K=["\ufef6","\ufef8","\ufefa","\ufefc"],ba="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split(""),T="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split(""),
P="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split(""),J="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split(""),
N="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split(""),Z="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split(""),Y="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split(""),
qa=["\u0621","\u0641"],V=["\u063a","\u064a"],na=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ya=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S=0,ma=1,ja=2,X=3,oa=4,xa=5,Ha=6,Ia=7,ia=8,ea=11,za=12,Ca="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" "),Da=100;m=S;a=ma;var ka=ja,ta=X,M=oa,Ga=xa,La=Ha,aa=Ia,Ya=
ia,Wa=ea,Ea=za,U=[Da+0,m,m,m,m,Da+1,Da+2,Da+3,a,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,Da+4,M,M,M,m,M,m,M,m,M,M,M,m,m,M,M,m,m,m,m,m,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,m,m,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,m,m,M,M,m,m,M,M,m,m,M,M,M,M,M,M,M,M,M,
M,M,M,M,M,M,M,M,M,M,M,M,M,M,m,m,m,Da+5,aa,aa,Da+6,Da+7],fa=[[18,18,18,18,18,18,18,18,18,La,Ga,La,Ya,Ga,18,18,18,18,18,18,18,18,18,18,18,18,18,18,Ga,Ga,Ga,La,Ya,M,M,Wa,Wa,Wa,M,M,M,M,M,10,9,10,9,9,ka,ka,ka,ka,ka,ka,ka,ka,ka,ka,9,M,M,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,M,M,18,18,18,18,18,18,Ga,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,M,Wa,Wa,Wa,Wa,M,M,M,M,m,M,M,18,M,M,Wa,
Wa,ka,ka,M,m,M,M,M,ka,m,M,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,M,M,M,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,m,m,m,m,m,m,m,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,m,M,M,M,M,M,M,M,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,
Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,a,Ea,a,Ea,Ea,a,Ea,Ea,a,Ea,M,M,M,M,M,M,M,M,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,M,M,M,M,M,a,a,a,a,a,M,M,M,M,M,M,M,M,M,M,M],[ta,ta,ta,ta,M,M,M,M,aa,Wa,Wa,aa,9,aa,M,M,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,aa,M,M,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,
Ea,ta,ta,ta,ta,ta,ta,ta,ta,ta,ta,Wa,ta,ta,aa,aa,aa,Ea,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,Ea,Ea,Ea,Ea,Ea,Ea,Ea,ta,M,Ea,Ea,Ea,Ea,Ea,Ea,aa,aa,Ea,Ea,M,Ea,Ea,Ea,Ea,aa,aa,ka,ka,ka,ka,ka,ka,ka,ka,ka,ka,aa,aa,aa,aa,aa,aa],[aa,aa,aa,aa,aa,aa,
aa,aa,aa,aa,aa,aa,aa,aa,M,aa,aa,Ea,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,M,M,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,
Ea,Ea,Ea,aa,M,M,M,M,M,M,M,M,M,M,M,M,M,M,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,a,a,M,M,M,M,a,M,M,M,M,M],[Ya,Ya,Ya,Ya,Ya,Ya,Ya,Ya,Ya,Ya,Ya,18,18,18,m,a,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,Ya,Ga,13,14,15,16,17,9,Wa,Wa,Wa,Wa,Wa,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,9,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,Ya,18,18,18,18,18,M,M,M,M,M,18,18,18,18,18,18,ka,m,M,M,ka,ka,ka,ka,ka,ka,10,10,M,M,M,m,ka,ka,ka,ka,ka,ka,ka,
ka,ka,ka,10,10,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,M,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,Wa,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[m,m,m,m,m,m,m,M,M,M,M,M,M,M,M,M,M,M,M,m,m,m,m,m,M,M,M,M,M,a,Ea,a,a,a,a,a,a,a,a,a,a,10,a,a,a,a,a,a,a,a,a,a,a,a,a,M,a,a,a,a,a,M,a,M,a,a,M,a,a,M,a,a,a,a,a,a,a,a,a,a,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,
aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa],[Ea,Ea,Ea,Ea,Ea,Ea,Ea,
Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,Ea,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,Ea,Ea,Ea,Ea,Ea,Ea,Ea,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,9,M,9,M,M,9,M,M,M,M,M,M,M,M,M,Wa,M,M,10,10,M,M,M,M,M,Wa,Wa,M,M,M,M,M,aa,aa,aa,aa,aa,M,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,
aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,aa,M,M,18],[M,M,M,Wa,Wa,Wa,M,M,M,M,M,10,9,10,9,9,ka,ka,ka,ka,ka,ka,ka,ka,ka,ka,9,M,M,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,M,M,M,M,M,M,M,M,M,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,
m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,M,M,M,m,m,m,m,m,m,M,M,m,m,m,m,m,m,M,M,m,m,m,m,m,m,M,M,m,m,m,M,M,M,Wa,Wa,M,M,M,Wa,Wa,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M]];return F})},"esri/basemaps":function(){define(["require","dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(F,m,a,D){F={streets:{title:D.basemaps.streets,thumbnailUrl:F.toUrl("./images/basemap/streets.jpg"),itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},
satellite:{title:D.basemaps.satellite,thumbnailUrl:F.toUrl("./images/basemap/satellite.jpg"),itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},hybrid:{title:D.basemaps.hybrid,thumbnailUrl:F.toUrl("./images/basemap/hybrid.jpg"),itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",
isReference:!0}]},terrain:{title:D.basemaps.terrain,thumbnailUrl:F.toUrl("./images/basemap/terrain.jpg"),itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:D.basemaps.topo,thumbnailUrl:F.toUrl("./images/basemap/topo.jpg"),itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},
gray:{title:D.basemaps.gray,thumbnailUrl:F.toUrl("./images/basemap/gray.jpg"),itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:D.basemaps["dark-gray"],thumbnailUrl:F.toUrl("./images/basemap/dark-gray.jpg"),itemId:"da65bacab5bd4defb576f839b6b28098",
baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:D.basemaps.oceans,thumbnailUrl:F.toUrl("./images/basemap/oceans.jpg"),itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",
isReference:!0}]},"national-geographic":{title:D.basemaps["national-geographic"],thumbnailUrl:F.toUrl("./images/basemap/national-geographic.jpg"),itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},osm:{title:D.basemaps.osm,thumbnailUrl:F.toUrl("./images/basemap/osm.jpg"),itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]},"dark-gray-vector":{title:D.basemaps["dark-gray"],
thumbnailUrl:F.toUrl("./images/basemap/dark-gray.jpg"),itemId:"c11ce4f7801740b2905eb03ddc963ac8",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/c11ce4f7801740b2905eb03ddc963ac8/resources/styles/root.json",type:"VectorTile"}]},"gray-vector":{title:D.basemaps.gray,thumbnailUrl:F.toUrl("./images/basemap/gray.jpg"),itemId:"8a2cba3b0ebf4140b7c0dc5ee149549a",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/8a2cba3b0ebf4140b7c0dc5ee149549a/resources/styles/root.json",
type:"VectorTile"}]},"streets-vector":{title:D.basemaps.streets,thumbnailUrl:F.toUrl("./images/basemap/streets.jpg"),itemId:"de26a3cf4cc9451298ea173c4b324736",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",type:"VectorTile"}]},"topo-vector":{title:D.basemaps.topo,thumbnailUrl:F.toUrl("./images/basemap/topo.jpg"),itemId:"7dc6cea0b1764a1f9af2e679f642f0f5",baseMapLayers:[{url:"https://services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},
{url:"https://www.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",type:"VectorTile"}]},"streets-night-vector":{title:D.basemaps["streets-night-vector"],thumbnailUrl:F.toUrl("./images/basemap/streets-night.jpg"),itemId:"86f556a2d1fd468181855a35e344567f",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",type:"VectorTile"}]},"streets-relief-vector":{title:D.basemaps["streets-relief-vector"],
thumbnailUrl:F.toUrl("./images/basemap/streets-relief.jpg"),itemId:"b266e6d17fc345b498345613930fbd76",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",type:"VectorTile"}]},"streets-navigation-vector":{title:D.basemaps["streets-navigation-vector"],thumbnailUrl:F.toUrl("./images/basemap/streets-navigation.jpg"),itemId:"63c47b7177f946b49902c24129b87252",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",
type:"VectorTile"}]}};return a.basemaps=F})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(F,m,a,D,z,y){F=F([D],{declaredClass:"esri.Evented",registerConnectEvents:function(){var r=this.constructor,q=this.constructor._meta.parents,n=[{}],f={},d,e=function(c,h){m.isArray(c)||(c=[c]);for(var g=0;g<c.length;g++){var k=c[g];k._meta&&k._meta.parents&&e(k._meta.parents,h);k.prototype._eventMap&&h.push(m.mixin({},k.prototype._eventMap))}return h};
if(!r._onMap){e(q,n);n.push(this._eventMap);q=m.mixin.apply(this,n);for(b in this)/^on\w/.test(b)&&m.isFunction(this[b])&&(n=this._hyphenLower(b).toLowerCase(),q[n]||(f[n]={method:b}));for(d in q){var b=this._onCamelCase(d);f[d]={method:b,argKeys:q[d]}}r._onMap=f;return r._onMap}},on:function(r,q){if(-1<r.indexOf(",")){for(var n=r.split(/\s*,\s*/),f=n.length,d=[];f--;)d.push(this.on(n[f],q));d.remove=function(){for(var c=0;c<d.length;c++)d[c].remove()};return d}n=this.constructor._onMap||this.registerConnectEvents();
f="string"==typeof r&&r.toLowerCase();var e=this._onCamelCase(f),b=n&&n[f];return(e=b&&b.method||this[e]&&m.isFunction(this[e])&&e)?b&&m.isArray(b.argKeys)?(n=this._onArr2Obj(q,n[f].argKeys),a.after(this,e,n,!0)):a.after(this,e,function(c){c=c||{};c.target||(c.target=this);q.call(this,c)},!0):this.inherited(arguments)},emit:function(r,q){var n,f,d=r.toLowerCase();var e=this._onCamelCase(r);var b=this.constructor._onMap||this.registerConnectEvents();e=(f=b&&b[d]&&b[d].method||m.isFunction(this[e])&&
e)&&this[f];f&&b&&b[d]&&this._onObj2Arr(function(){n=Array.prototype.slice.call(arguments)},b[d].argKeys)(q);q=q||{};q.target||(q.target=this);if(e){var c=n&&n.length?n:[q];c=e.apply(this,c)}this.inherited(arguments,[r,q]);return c},_onObj2Arr:function(r,q){if(q){var n=this;return function(f){var d,e=[],b=q.length;for(d=0;d<b;d++)e[d]=f[q[d]];r.apply(n,e)}}return r},_onArr2Obj:function(r,q){if(q){var n=this;return function(){var f,d={},e=arguments.length;for(f=0;f<e;f++)d[q[f]]=arguments[f];d.target||
(d.target=n);r.call(n,d)}}return r},_hyphenLower:function(r){return r.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(q,n){return(n?"-":"")+q.toLowerCase()})},_onCamelCase:function(r){return"on"+r.substr(0,1).toUpperCase()+r.substr(1).replace(/\-([a-z])/g,function(q,n){return n.toUpperCase()})}});return y.Evented=F})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),function(F,m,a,D,z,
y,r,q,n){q={animateRange:function(f){var d=f.range;return new m.Animation(a.mixin({curve:new m._Line(d.start,d.end)},f))},resize:function(f){var d=f.node=D.byId(f.node),e=f.start,b=f.end;e||(e=z.getMarginBox(d),d=z.getPadBorderExtents(d),e=f.start={left:e.l+d.l,top:e.t+d.t,width:e.w-d.w,height:e.h-d.h});b||(b=f.anchor?f.anchor:{x:e.left,y:e.top},d=f.size,b=f.end={left:e.left-(d.width-e.width)*(b.x-e.left)/e.width,top:e.top-(d.height-e.height)*(b.y-e.top)/e.height,width:d.width,height:d.height});return m.animateProperty(a.mixin({properties:{left:{start:e.left,
end:b.left},top:{start:e.top,end:b.top},width:{start:e.width,end:b.width},height:{start:e.height,end:b.height}}},f))},slideTo:function(f){var d=f.node=D.byId(f.node),e=y.getComputedStyle,b=null,c=null,h=function(){return function(){var g="absolute"==d.style.position?"absolute":"relative";b="absolute"==g?d.offsetTop:parseInt(e(d).top)||0;c="absolute"==g?d.offsetLeft:parseInt(e(d).left)||0;"absolute"!=g&&"relative"!=g&&(g=z.position(d,!0),b=g.y,c=g.x,d.style.position="absolute",d.style.top=b+"px",d.style.left=
c+"px")}}();h();f=m.animateProperty(a.mixin({properties:{top:{start:b,end:f.top||0},left:{start:c,end:f.left||0}}},f));F.connect(f,"beforeBegin",f,h);return f},flash:function(f){f=a.mixin({end:"#f00",duration:500,count:1},f);f.duration/=2*f.count;var d=D.byId(f.node),e=f.start;e||(e=y.getComputedStyle(d).backgroundColor);var b=f.end,c=[],h=f.count;d={node:d,duration:f.duration};for(f=0;f<h;f++)c.push(m.animateProperty(a.mixin({properties:{backgroundColor:{start:e,end:b}}},d))),c.push(m.animateProperty(a.mixin({properties:{backgroundColor:{start:b,
end:e}}},d)));return r.chain(c)}};a.mixin(a.getObject("fx",!0,n),q);return q})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),function(F,m,a,D,z,y,r,q,n,f,d){a.isAsync||f(0,function(){d(["./fx/Toggler"])});a=a.fx={};f={_fire:function(c,h){this[c]&&this[c].apply(this,h||[]);return this}};var e=function(c){this._index=-1;this._animations=c||[];this._current=this._onAnimateCtx=this._onEndCtx=
null;this.duration=0;D.forEach(this._animations,function(h){h&&("undefined"!=typeof h.duration&&(this.duration+=h.duration),h.delay&&(this.duration+=h.delay))},this)};e.prototype=new m;F.extend(e,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=z.after(this._current,
"onAnimate",F.hitch(this,"_onAnimate"),!0),this._onEndCtx=z.after(this._current,"onEnd",F.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(c,h){this._current||(this._current=this._animations[this._index=0]);if(!h&&"playing"==this._current.status())return this;var g=z.after(this._current,"beforeBegin",F.hitch(this,function(){this._fire("beforeBegin")}),!0),k=z.after(this._current,"onBegin",F.hitch(this,function(t){this._fire("onBegin",arguments)}),!0),w=z.after(this._current,"onPlay",
F.hitch(this,function(t){this._fire("onPlay",arguments);g.remove();k.remove();w.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=z.after(this._current,"onAnimate",F.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=z.after(this._current,"onEnd",F.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var c=z.after(this._current,"onPause",F.hitch(this,function(h){this._fire("onPause",
arguments);c.remove()}),!0);this._current.pause()}return this},gotoPercent:function(c,h){this.pause();var g=this.duration*c;this._current=null;D.some(this._animations,function(k,w){if(g<=k.duration)return this._current=k,this._index=w,!0;g-=k.duration;return!1},this);this._current&&this._current.gotoPercent(g/this._current.duration);h&&this.play();return this},stop:function(c){if(this._current){if(c){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=
this._animations[this._index]}var h=z.after(this._current,"onStop",F.hitch(this,function(g){this._fire("onStop",arguments);h.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});F.extend(e,f);a.chain=function(c){return new e(F.isArray(c)?c:Array.prototype.slice.call(c,0))};var b=function(c){this._animations=c||
[];this._connects=[];this.duration=this._finished=0;D.forEach(c,function(g){var k=g.duration;g.delay&&(k+=g.delay);this.duration<k&&(this.duration=k);this._connects.push(z.after(g,"onEnd",F.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new y.Animation({curve:[0,1],duration:this.duration});var h=this;D.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(g){h._connects.push(z.after(h._pseudoAnimation,g,function(){h._fire(g,arguments)},!0))})};F.extend(b,
{_doAction:function(c,h){D.forEach(this._animations,function(g){g[c].apply(g,h)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(c,h){var g=this._pseudoAnimation;g[c].apply(g,h)},play:function(c,h){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(c,h){var g=this.duration*c;D.forEach(this._animations,
function(k){k.gotoPercent(k.duration<g?1:g/k.duration,h)});this._call("gotoPercent",arguments);return this},stop:function(c){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();D.forEach(this._connects,function(c){c.remove()})}});F.extend(b,f);a.combine=function(c){return new b(F.isArray(c)?c:Array.prototype.slice.call(c,0))};a.wipeIn=function(c){var h=c.node=r.byId(c.node),g=h.style,k;c=
y.animateProperty(F.mixin({properties:{height:{start:function(){k=g.overflow;g.overflow="hidden";if("hidden"==g.visibility||"none"==g.display)return g.height="1px",g.display="",g.visibility="",1;var t=q.get(h,"height");return Math.max(t,1)},end:function(){return h.scrollHeight}}}},c));var w=function(){g.height="auto";g.overflow=k};z.after(c,"onStop",w,!0);z.after(c,"onEnd",w,!0);return c};a.wipeOut=function(c){var h=(c.node=r.byId(c.node)).style,g;c=y.animateProperty(F.mixin({properties:{height:{end:1}}},
c));z.after(c,"beforeBegin",function(){g=h.overflow;h.overflow="hidden";h.display=""},!0);var k=function(){h.overflow=g;h.height="auto";h.display="none"};z.after(c,"onStop",k,!0);z.after(c,"onEnd",k,!0);return c};a.slideTo=function(c){var h=null,g=null,k=function(w){return function(){var t=q.getComputedStyle(w),C=t.position;h="absolute"==C?w.offsetTop:parseInt(t.top)||0;g="absolute"==C?w.offsetLeft:parseInt(t.left)||0;"absolute"!=C&&"relative"!=C&&(t=n.position(w,!0),h=t.y,g=t.x,w.style.position=
"absolute",w.style.top=h+"px",w.style.left=g+"px")}}(c.node=r.byId(c.node));k();c=y.animateProperty(F.mixin({properties:{top:c.top||0,left:c.left||0}},c));z.after(c,"beforeBegin",k,!0);return c};return a})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(F,m,a){m={_dfdCanceller:function(D){D.canceled=!0;var z=D._pendingDfd;if(!D.isFulfilled()&&z&&!z.isFulfilled()){z.cancel();var y=z.results&&z.results[1]}D._pendingDfd=null;return y},_fixDfd:function(D){var z=
D.then;D.then=function(y,r,q){if(y){var n=y;y=function(f){return f&&f._argsArray?n.apply(null,f):n(f)}}return z.call(this,y,r,q)};return D},_resDfd:function(D,z,y){var r=z.length;1===r?y?D.errback(z[0]):D.callback(z[0]):1<r?(z._argsArray=!0,D.callback(z)):D.callback()}};F.mixin(a,m);return m})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point","./geometry/Extent"],function(F,m,a,D,z){m={_addFrameInfo:function(y,r){var q,n,f=2*r.origin[1],d=r.origin[0],
e=y.origin.x,b=y.width,c;F.forEach(y.lods,function(h){q=Math.round(f/h.resolution);n=Math.ceil(q/b);c=Math.floor((d-e)/(b*h.resolution));h._frameInfo||(h._frameInfo=[n,c,c+n-1,q])})},getContainingTileCoords:function(y,r,q){var n=y.origin;q=q.resolution;return{row:Math.floor((n.y-r.y)/(y.height*q)),col:Math.floor((r.x-n.x)/(y.width*q))}},getCandidateTileInfo:function(y,r,q){var n=y.width;var f=y.height,d=q.xmax-q.xmin,e=q.ymax-q.ymin,b=y.__tileInfo===r,c=b?y.getMinZoom():-1;b=b?y.getMaxZoom():-1;var h=
-1,g=r.lods,k=Math.abs,w;b=-1<b?b:g.length-1;for(c=-1<c?c:0;c<=b;c++)if(w=g[c]){var t=d>e?k(e-f*w.resolution):k(d-n*w.resolution);if(0>h||t<=h){var C=w;h=t}else break}n=C;C=n.resolution;f=(q.xmin+q.xmax)/2;d=(q.ymin+q.ymax)/2;e=y.width/2*C;C*=y.height/2;f=new z(f-e,d-C,f+e,d+C,q.spatialReference);q=new D(f.xmin,f.ymax,q.spatialReference);b=n.resolution;e=r.width;d=r.height;r=r.origin;y=y.__visibleDelta;C=Math.floor;g=e*b;k=d*b;b=C((r.y-q.y)/k);h=C((q.x-r.x)/g);c=r.y-b*k;r=C(Math.abs((q.x-(r.x+h*g))*
e/g))+y.x;y=C(Math.abs((q.y-c)*d/k))+y.y;return{tile:{point:q,coords:{row:b,col:h},offsets:{x:r,y:y}},lod:n,extent:f}},getTileExtent:function(y,r,q,n){var f=y.origin;r=y.lods[r].resolution;var d=y.width,e=y.height;return new z(n*r*d+f.x,f.y-(q+1)*r*e,(n+1)*r*d+f.x,f.y-q*r*e,y.spatialReference)}};return a.TileUtils=m})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),function(F,m,a,D,z,y,r,
q){function n(c,h){89.99999<h?h=89.99999:-89.99999>h&&(h=-89.99999);var g=.017453292519943*h;return[111319.49079327169*c,3189068.5*Math.log((1+Math.sin(g))/(1-Math.sin(g)))]}function f(c,h,g){c=c/6378137*57.29577951308232;return g?[c,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*h/6378137)))]:[c-360*Math.floor((c+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*h/6378137)))]}function d(){}function e(){}function b(c){var h=c._json;c._unquantizeFn?(h=c._unquantizeFn({x:h.x,
y:h.y}),c._xVal=h.x,c._yVal=h.y,c._unquantizeFn=null):(c._xVal=h.x,c._yVal=h.y);c._json=null}a={type:"point",x:0,y:0};F=F(r,{declaredClass:"esri.geometry.Point",type:"point",x:0,y:0,constructor:function(c,h,g){m.isArray(c)?(this.x=c[0],this.y=c[1],this.spatialReference=h):z.isObject(c)?(z.mixin(this,c),null!=this.latitude&&(this.y=this.latitude),null!=this.longitude&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=q.createSpatialReference(this.spatialReference))):(this.x=c,this.y=
h,this.spatialReference=g);this.verifySR()},offset:function(c,h){return new this.constructor(this.x+c,this.y+h,this.spatialReference)},setX:function(c){this.x=c;this.clearCache();return this},setY:function(c){this.y=c;this.clearCache();return this},setLongitude:function(c){var h=this.spatialReference;h&&(h._isWebMercator()?this.setX(n(c,this.y)[0]):4326===h.wkid&&this.setX(c));return this},setLatitude:function(c){var h=this.spatialReference;h&&(h._isWebMercator()?this.setY(n(this.x,c)[1]):4326===
h.wkid&&this.setY(c));return this},getLongitude:function(){var c=this.spatialReference;if(c)if(c._isWebMercator())var h=f(this.x,this.y)[0];else 4326===c.wkid&&(h=this.x);return h},getLatitude:function(){var c=this.spatialReference;if(c)if(c._isWebMercator())var h=f(this.x,this.y)[1];else 4326===c.wkid&&(h=this.y);return h},update:function(c,h){this.x=c;this.y=h;this.clearCache();return this},normalize:function(){var c=this.x,h=this.spatialReference;if(h){var g=h._getInfo();g&&(c=this._normalizeX(c,
g))}return new this.constructor(c,this.y,h)},_normalizeX:function(c,h){var g=h.valid[0],k=h.valid[1],w=2*k;c>k?(g=Math.ceil(Math.abs(c-k)/w),c-=g*w):c<g&&(g=Math.ceil(Math.abs(c-g)/w),c+=g*w);return c},toJson:function(){var c={x:this.x,y:this.y},h=this.spatialReference;h&&(c.spatialReference=h.toJson());return c}});d.prototype=F.prototype;e.prototype=new d;Object.defineProperty(e.prototype,"x",{get:function(){this._json&&b(this);return this._xVal},set:function(c){this._xVal=c}});Object.defineProperty(e.prototype,
"y",{get:function(){this._json&&b(this);return this._yVal},set:function(c){this._yVal=c}});e.prototype.setupLazyUnquantization=function(c,h){this._unquantizeFn=c;this._json=h};F.simpleConstructor=d;F.accessorConstructor=e;F.lngLatToXY=n;F.xyToLngLat=f;F.defaultProps=a;F.metersPerDegree=6378137*Math.PI/180;m.setObject("geometry.Point",F,D);D.geometry.defaultPoint=a;return F})},"esri/SpatialReference":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/has","./kernel","./lang"],function(F,
m,a,D,z){function y(){}a=[-2.0037508342788905E7,2.0037508342788905E7];var r=[-2.0037508342787E7,2.0037508342787E7];F=F(null,{declaredClass:"esri.SpatialReference",constructor:function(q){q&&(z.isObject(q)?z.mixin(this,q):z.isString(q)?this.wkt=q:this.wkid=q)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:a,origin:r,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:a,origin:r,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:a,origin:r,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:a,origin:r,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==m.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==m.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(q){var n=!1;q&&(n=this.isWebMercator()&&4326===q.wkid||q.isWebMercator()&&4326===this.wkid);return n},isWebMercator:function(){return this._isWebMercator()},equals:function(q){var n=!1;q&&(this===q&&
(n=!0),this.wkid||q.wkid?n=this.wkid===q.wkid||this.isWebMercator()&&q.isWebMercator()||this.wkid===q.latestWkid||q.wkid===this.latestWkid:this.wkt&&q.wkt&&(n=this.wkt.toUpperCase()===q.wkt.toUpperCase()));return n},toJson:function(){var q=null;null!=this.wkid?q={wkid:this.wkid}:null!=this.wkt&&(q={wkt:this.wkt});q&&null!=this.latestWkid&&(q.latestWkid=this.latestWkid);return q}});y.prototype=F.prototype;F.simpleConstructor=y;return D.SpatialReference=F})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(y){this.spatialReference=y;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new z(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(y){return this.cache&&this.cache[y]},setCacheValue:function(y,r){this.cache||
(this.cache={});this.cache[y]=r}});m.setObject("geometry.Geometry",F,D);return F})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel","./sniff","dojo/_base/lang"],function(F,m,a,D,z){function y(r){var q=!1;r&&(r.ics||r.icsid)&&(q=!0);return q}D={isICS:y,createSpatialReference:function(r){var q=null;r&&(q=y(r)?new m(r):new F(r));return q}};z.mixin(a,D);return D})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),
function(F,m,a,D,z,y){F=F(y,{declaredClass:"esri.ImageSpatialReference",constructor:function(r){r&&m.isObject(r)&&m.mixin(this,r)},icsid:null,icsns:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(r){var q=!1;if(r)if(this.icsid&&r.icsid){if(q=this.icsid===r.icsid,this.icsns||r.icsns)q=q&&this.icsns===r.icsns}else this.ics&&r.ics&&(q=this.ics===r.ics);return q},toJson:function(r){var q=null,n=z.isDefined;r=n(r)?r:!0;n(this.icsid)?(q={icsid:this.icsid},
n(this.icsns)&&(q.icsns=this.icsns)):n(this.ics)&&(q={ics:this.ics});n(this.url)&&n(q)&&r&&(q.url=this.url);return q}});return D.ImageSpatialReference=F})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e){function b(){}D={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0};var c=F(q,{declaredClass:"esri.geometry.Extent",
type:"extent",xmin:0,ymin:0,xmax:0,ymax:0,constructor:function(h,g,k,w,t){y.isObject(h)?(y.mixin(this,h),this.spatialReference&&(this.spatialReference=e.createSpatialReference(this.spatialReference))):this.update(h,g,k,w,t);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new n((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},getTopLeft:function(){return new n(this.xmin,
this.ymax,this.spatialReference)},getTopRight:function(){return new n(this.xmax,this.ymax,this.spatialReference)},getBottomLeft:function(){return new n(this.xmin,this.ymin,this.spatialReference)},getBottomRight:function(){return new n(this.xmax,this.ymin,this.spatialReference)},centerAt:function(h){var g=this.getCenter(),k=h.x-g.x;h=h.y-g.y;return new c(this.xmin+k,this.ymin+h,this.xmax+k,this.ymax+h,this.spatialReference)},update:function(h,g,k,w,t){this.xmin=h;this.ymin=g;this.xmax=k;this.ymax=
w;this.spatialReference=t;this.clearCache();return this},offset:function(h,g){return new c(this.xmin+h,this.ymin+g,this.xmax+h,this.ymax+g,this.spatialReference)},expand:function(h){var g=(1-h)/2;h=this.getWidth()*g;g*=this.getHeight();return new c(this.xmin+h,this.ymin+g,this.xmax-h,this.ymax-g,this.spatialReference)},intersects:function(h){if(!h)return!1;var g=h.type,k=this.spatialReference,w=h.spatialReference;k&&w&&!k.equals(w)&&k._canProject(w)&&(h=k.isWebMercator()?f.geographicToWebMercator(h):
f.webMercatorToGeographic(h,!0));switch(g){case "point":return this.contains(h);case "multipoint":return this._intersectsMultipoint(h);case "extent":return this._intersectsExtent(h);case "polygon":return this._intersectsPolygon(h);case "polyline":return this._intersectsPolyline(h)}},normalize:function(){var h=this._normalize(!1,!0);a.isArray(h)||(h=[h]);return h},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var h=this.spatialReference,g=h&&h._getInfo(),k=[],w=0;if(g&&
this._isOutOfBounds(g)){var t=this;w=t.xmin;var C=t.ymin,u=t.ymax,x=g.valid[0],l=g.valid[1];t.getWidth()>2*l&&(t=t.getCenter(),t=new c(t.x-l,C,t.x+l,u,new r(h.toJson())));w=t.xmin-w;var v=this._normalizeX(t.xmin,g);g=this._normalizeX(t.xmax,g);v.frameId===g.frameId?k.push(new c(v.x,C,g.x,u,new r(h.toJson()))):k.push(new c(v.x,C,l,u,new r(h.toJson())),new c(x,C,g.x,u,new r(h.toJson())))}else k.push(this.getExtent());return{extents:k,marginLeft:w}},_intersectsMultipoint:function(h){var g=h.points.length,
k;for(k=0;k<g;k++)if(this.contains(h.getPoint(k)))return!0;return!1},_intersectsExtent:function(h){var g,k,w=!1;if(this.xmin<=h.xmin){var t=h.xmin;this.xmax<t?w=!0:g=Math.min(this.xmax,h.xmax)-t}else t=this.xmin,h.xmax<t?w=!0:g=Math.min(this.xmax,h.xmax)-t;if(this.ymin<=h.ymin){var C=h.ymin;this.ymax<C?w=!0:k=Math.min(this.ymax,h.ymax)-C}else C=this.ymin,h.ymax<C?w=!0:k=Math.min(this.ymax,h.ymax)-C;return w?null:new c(t,C,t+g,C+k,this.spatialReference)},_intersectsPolygon:function(h){var g=[this.xmin,
this.ymax],k=[this.xmax,this.ymax],w=[this.xmin,this.ymin],t=[this.xmax,this.ymin],C=[g,k,w,t];g=[[w,g],[g,k],[k,t],[t,w]];w=h.rings;t=w.length;var u=new n(0,0,this.spatialReference);var x=C.length;for(k=0;k<x;k++)if(u.update(C[k][0],C[k][1]),h.contains(u))return!0;u.setSpatialReference(h.spatialReference);for(k=0;k<t;k++)if(C=w[k],x=C.length){var l=C[0];u.update(l[0],l[1]);if(this.contains(u))return!0;for(h=1;h<x;h++){var v=C[h];u.update(v[0],v[1]);if(this.contains(u)||this._intersectsLine([l,v],
g))return!0;l=v}}return!1},_intersectsPolyline:function(h){var g=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],k,w=h.paths,t=w.length,C,u=new n(0,0,h.spatialReference);for(h=0;h<t;h++){var x=w[h];if(C=x.length){var l=x[0];u.update(l[0],l[1]);if(this.contains(u))return!0;for(k=1;k<C;k++){var v=x[k];u.update(v[0],v[1]);if(this.contains(u)||this._intersectsLine([l,
v],g))return!0;l=v}}}return!1},_intersectsLine:function(h,g){var k=d._getLineIntersection2,w,t=g.length;for(w=0;w<t;w++)if(k(h,g[w]))return!0;return!1},contains:function(h){if(!h)return!1;var g=h.type;if("point"===g){var k=this.spatialReference,w=h.spatialReference;g=h.x;h=h.y;k&&w&&!k.equals(w)&&k._canProject(w)&&(h=k.isWebMercator()?n.lngLatToXY(g,h):n.xyToLngLat(g,h,!0),g=h[0],h=h[1]);return g>=this.xmin&&g<=this.xmax&&h>=this.ymin&&h<=this.ymax}return"extent"===g?this._containsExtent(h):!1},_containsExtent:function(h){var g=
h.xmin,k=h.ymin,w=h.xmax,t=h.ymax,C=h.spatialReference;h=new n(g,k,C);g=new n(g,t,C);t=new n(w,t,C);k=new n(w,k,C);return this.contains(h)&&this.contains(g)&&this.contains(t)&&this.contains(k)?!0:!1},union:function(h){return new c(Math.min(this.xmin,h.xmin),Math.min(this.ymin,h.ymin),Math.max(this.xmax,h.xmax),Math.max(this.ymax,h.ymax),this.spatialReference)},getExtent:function(){var h=this.spatialReference;return new c(this.xmin,this.ymin,this.xmax,this.ymax,h&&new r(h.toJson()))},_shiftCM:function(h){var g=
this.getCacheValue("_shifted");if(!g){g=new c(this.toJson());var k=g.spatialReference;if(h=h||k._getInfo()){var w=this._getCM(h);if(w){var t=k._isWebMercator()?f.webMercatorToGeographic(w):w;g.xmin-=w.x;g.xmax-=w.x;k._isWebMercator()||(t.x=this._normalizeX(t.x,h).x);g.setSpatialReference(new r(y.substitute({Central_Meridian:t.x},4326===k.wkid?h.altTemplate:h.wkTemplate)))}}this.setCacheValue("_shifted",g)}return g},_getCM:function(h){var g;this._isOutOfBounds(h)&&(g=this.getCenter());return g},_isOutOfBounds:function(h){var g=
h.valid[0];h=h.valid[1];var k=this.xmin,w=this.xmax;return!(k>=g&&k<=h&&w>=g&&w<=h)},_normalize:function(h,g,k){var w=new c(this.toJson()),t=w.spatialReference;if(t&&(k=k||t._getInfo())){var C=m.map(this._getParts(k),function(u){return u.extent});return 2<C.length?h?this._shiftCM(k):w.update(k.valid[0],w.ymin,k.valid[1],w.ymax,t):2===C.length?h?this._shiftCM(k):g?C:{rings:m.map(C,function(u){return[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]]}),spatialReference:t}:
C[0]||w}return w},_getParts:function(h){var g=this.getCacheValue("_parts");if(!g){g=[];var k=this.xmin,w=this.xmax,t=this.ymin,C=this.ymax,u=this.spatialReference,x=this.getWidth(),l=k,v=w,A=0,B=0;h=h||u._getInfo();var E=h.valid[0];var G=h.valid[1];B=this._normalizeX(k,h);k=B.x;A=B.frameId;B=this._normalizeX(w,h);w=B.x;B=B.frameId;h=k===w&&0<x;if(x>2*G){x=new c(l<v?k:w,t,G,C,u);k=new c(E,t,l<v?w:k,C,u);G=new c(0,t,G,C,u);t=new c(E,t,0,C,u);u=[];E=[];x.contains(G)&&u.push(A);x.contains(t)&&E.push(A);
k.contains(G)&&u.push(B);k.contains(t)&&E.push(B);for(C=A+1;C<B;C++)u.push(C),E.push(C);g.push({extent:x,frameIds:[A]},{extent:k,frameIds:[B]},{extent:G,frameIds:u},{extent:t,frameIds:E})}else k>w||h?g.push({extent:new c(k,t,G,C,u),frameIds:[A]},{extent:new c(E,t,w,C,u),frameIds:[B]}):g.push({extent:new c(k,t,w,C,u),frameIds:[A]});this.setCacheValue("_parts",g)}return g},_normalizeX:function(h,g){var k=0,w=g.valid[0],t=g.valid[1],C=2*t;h>t?(k=Math.ceil(Math.abs(h-t)/C),h-=k*C):h<w&&(k=Math.ceil(Math.abs(h-
w)/C),h+=k*C,k=-k);return{x:h,frameId:k}},toJson:function(){var h={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},g=this.spatialReference;g&&(h.spatialReference=g.toJson());return h}});b.prototype=c.prototype;c.simpleConstructor=b;c.defaultProps=D;a.setObject("geometry.Extent",c,z);z.geometry.defaultExtent=D;return c})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(F,m,a,D,z,y){function r(n,
f,d,e){if("point"===n.type){var b=f(n.x,n.y,e);return new n.constructor(b[0],b[1],new z(d))}if("extent"===n.type){b=f(n.xmin,n.ymin,e);var c=f(n.xmax,n.ymax,e);return new n.constructor(b[0],b[1],c[0],c[1],new z(d))}if("polyline"===n.type||"polygon"===n.type){b="polyline"===n.type;var h=[],g;F.forEach(b?n.paths:n.rings,function(w){h.push(g=[]);F.forEach(w,function(t){g.push(f(t[0],t[1],e))})});return b?new n.constructor({paths:h,spatialReference:new z(d)}):new n.constructor({rings:h,spatialReference:new z(d)})}if("multipoint"===
n.type){var k=[];F.forEach(n.points,function(w){k.push(f(w[0],w[1],e))});return new n.constructor({points:k,spatialReference:new z(d)})}}function q(n,f){var d=n&&(null!=n.wkid?n:n.spatialReference),e=f&&(null!=f.wkid?f:f.spatialReference);return d&&e?e.equals(d)?!0:e._canProject(d):!1}a={canProject:q,project:function(n,f){var d=n&&n.spatialReference,e=f&&(null!=f.wkid?f:f.spatialReference);d&&e?d.equals(e)?n=new n.constructor(n.toJson()):q(d,e)?e.isWebMercator()?n=r(n,y.lngLatToXY,{wkid:102100}):
4326===e.wkid&&(n=r(n,y.xyToLngLat,{wkid:4326})):n=null:n=null;return n},lngLatToXY:y.lngLatToXY,xyToLngLat:y.xyToLngLat,metersPerDegree:y.metersPerDegree,geographicToWebMercator:function(n){return r(n,y.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(n,f){return r(n,y.xyToLngLat,{wkid:4326},f)}};m.mixin(m.getObject("geometry",!0,D),a);return a})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(F,m,a,D){function z(q,n,f){return q instanceof
D?new D(q.x+f*(n.x-q.x),q.y+f*(n.y-q.y)):[q[0]+f*(n[0]-q[0]),q[1]+f*(n[1]-q[1])]}function y(q,n){return 1E-8>Math.abs(q-n)}function r(q,n,f,d){var e=y(q[0],n[0])?1E10:(q[1]-n[1])/(q[0]-n[0]),b=y(f[0],d[0])?1E10:(f[1]-d[1])/(f[0]-d[0]),c=q[1]-e*q[0],h=f[1]-b*f[0];if(y(e,b)){if(y(c,h)){if(y(q[0],n[0]))if(Math.min(q[1],n[1])<Math.max(f[1],d[1])||Math.max(q[1],n[1])>Math.min(f[1],d[1])){q=(q[1]+n[1]+f[1]+d[1]-Math.min(q[1],n[1],f[1],d[1])-Math.max(q[1],n[1],f[1],d[1]))/2;var g=(q-c)/e}else return null;
else if(Math.min(q[0],n[0])<Math.max(f[0],d[0])||Math.max(q[0],n[0])>Math.min(f[0],d[0]))g=(q[0]+n[0]+f[0]+d[0]-Math.min(q[0],n[0],f[0],d[0])-Math.max(q[0],n[0],f[0],d[0]))/2,q=e*g+c;else return null;return[g,q]}return null}y(e,1E10)?(g=q[0],q=b*g+h):y(b,1E10)?(g=f[0],q=e*g+c):(g=-(c-h)/(e-b),q=q[1]===n[1]?q[1]:f[1]===d[1]?f[1]:e*g+c);return[g,q]}m={getLength:function(q,n){var f=n.x-q.x,d=n.y-q.y;return Math.sqrt(f*f+d*d)},_getLength:function(q,n){var f=n[0]-q[0],d=n[1]-q[1];return Math.sqrt(f*f+
d*d)},getPointOnLine:z,getMidpoint:function(q,n){return z(q,n,.5)},_equals:y,_getLineIntersection:r,getLineIntersection:function(q,n,f,d,e){(q=r([q.x,q.y],[n.x,n.y],[f.x,f.y],[d.x,d.y]))&&(q=new D(q[0],q[1],e));return q},_getLineIntersection2:function(q,n){var f=q[0],d=q[1],e=n[0],b=n[1],c=f[0];f=f[1];var h=d[0];d=d[1];var g=e[0],k=e[1];e=b[0]-g;g=c-g;var w=h-c;b=b[1]-k;k=f-k;var t=d-f,C=b*w-e*t;if(0===C)return!1;e=(e*k-b*g)/C;g=(w*k-t*g)/C;return 0<=e&&1>=e&&0<=g&&1>=g?[c+e*(h-c),f+e*(d-f)]:!1},
_pointLineDistance:function(q,n){var f=n[0],d=n[1],e=f[0],b=f[1];f=q[0];var c=q[1],h=d[0]-e,g=d[1]-b,k=f-e,w=c-b;d=Math.sqrt;var t=Math.pow,C=d(t(h,2)+t(g,2));k=(k*h+w*g)/(C*C);b+=k*g;return d(t(f-(e+k*h),2)+t(c-b,2))}};F.mixin(F.getObject("geometry",!0,a),m);return m})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/global dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(F,m,a,D,z,y,r,q,n,f){var d={},e=q.defaults.io,
b=/^[a-z][a-z0-9\+\-\.]*:/i,c=/^\s*http:/i,h=/^\s*https:/i,g=/:\d+$/,k=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i;d.isHTTP=function(t){var C=D.location.protocol;return null==t?"http:"===C||"https:"===C:t?"https:"===C:"http:"===C};d.getProtocolForWebResource=function(t){return d.isHTTP()?D.location.protocol:t?"https:":"http:"};d.urlToObject=function(t){var C={},u=new a(t),x=t.indexOf("?");null===u.query?C={path:t,query:null}:(C.path=t.substring(0,x),C.query=z.queryToObject(u.query));u.fragment&&
(C.hash=u.fragment,null===u.query&&(C.path=C.path.substring(0,C.path.length-(u.fragment.length+1))));return C};d.getProxyUrl=function(t,C){var u=F.isString(t)?0===F.trim(t).toLowerCase().indexOf("https:"):t,x=e.proxyUrl,l,v=f.io.proxyNotSet;F.isString(t)&&(l=d.getProxyRule(t))&&(x=l.proxyUrl);if(!x)throw Error(v);if(u&&!1!==C&&0!==D.location.href.toLowerCase().indexOf("https:")&&(u=x,0!==u.toLowerCase().indexOf("http")&&(u=d.getAbsoluteUrl(u)),u=u.replace(/^http:/i,"https:"),d.canUseXhr(u))){x=u;
var A=1}x=d.urlToObject(x);x._xo=A;return x};d.addProxy=function(t){var C=d.getProxyRule(t),u;C?u=d.urlToObject(C.proxyUrl):e.alwaysUseProxy&&(u=d.getProxyUrl());u&&(C=d.urlToObject(t),t=u.path+"?"+C.path,(u=z.objectToQuery(F.mixin(u.query||{},C.query)))&&(t+="?"+u));return t};d.addProxyRule=function(t){var C=t.urlPrefix=d.urlToObject(t.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),u=e.proxyRules,x,l=u.length,v=l;for(x=0;x<l;x++){var A=u[x].urlPrefix;if(0===
C.indexOf(A)){if(C.length===A)return-1;v=x;break}else 0===A.indexOf(C)&&(v=x+1)}u.splice(v,0,t);return v};d.getProxyRule=function(t){var C=e.proxyRules,u=C.length,x=d.urlToObject(t).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase();for(t=0;t<u;t++)if(0===x.indexOf(C[t].urlPrefix)){var l=C[t];break}return l};d.hasSameOrigin=function(t,C,u){t=t.toLowerCase();C=C.toLowerCase();var x=D.location.href.toLowerCase();t=0===t.indexOf("http")?new a(t):x=new a(x);C=0===C.indexOf("http")?
new a(C):F.isString(x)?new a(x):x;return(u||t.scheme===C.scheme)&&t.host===C.host&&t.port===C.port};d.canUseXhr=function(t,C){var u=n("esri-phonegap")?!0:!1,x=d.hasSameOrigin,l=e.corsEnabledServers,v,A=-1;!u&&n("esri-cors")&&l&&l.length&&(u=m.some(l,function(B,E){var G=!B||"object"!==typeof B||B instanceof RegExp?B:B.host;if(G instanceof RegExp){if(G.test(t))return A=E,!0}else if(G&&(v=0!==G.trim().toLowerCase().indexOf("http"),x(t,v?"http://"+G:G)||v&&x(t,"https://"+G)))return A=E,!0;return!1}));
return C?A:u};d.getAbsoluteUrl=function(t){var C=d.getProtocolForWebResource();return F.isString(t)&&!b.test(t)?0===t.indexOf("//")?C+t:0===t.indexOf("/")?C+"//"+D.location.host+t:y._appBaseUrl+t:t};d.fixUrl=function(t){t=F.trim(t);t=d.getAbsoluteUrl(t);t=d.normalizeSlashes(t);t=t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2");t=d.downgradeToHTTP(t);return t=d.upgradeToHTTPS(t)};d.normalize=function(t){return d.fixUrl(t)};d.normalizeSlashes=function(t){if(/^https?:\/\//i.test(t)){var C=t.indexOf("?");
if(-1<C){var u=t.slice(0,C);var x=t.slice(C+1)}else u=t;t=u.replace(/\/{2,}/g,"/");t=t.replace("/","//");x&&(t+="?"+x)}return t};d.downgradeToHTTP=function(t){return d.isHTTP(!1)&&h.test(t)&&d.hasSameOrigin(D.location.href,t,!0)&&!d.canUseXhr(t)?t.replace(h,"http:"):t};d.upgradeToHTTPS=function(t){var C=e.httpsDomains,u=d.isHTTP(!1),x=d.isHTTP(!0);if(!c.test(t))return t;t=F.trim(t);var l=t.indexOf("/",7);l=-1===l?t:t.slice(0,l);l=l.toLowerCase().slice(7);if(g.test(l))if(r.endsWith(l,":80"))l=l.slice(0,
-3),t=t.replace(":80","");else return t;if(u&&l===D.location.host&&(!k.test(t)||!d.canUseXhr(t)))return t;u=!1;if(x&&l===D.location.host)u=!0;else if(C)for(var v=0;v<C.length;v++){var A=C[v];if(l===A||r.endsWith(l,"."+A)){u=!0;break}}u||!x||e.alwaysUseProxy||d.getProxyRule(t)||(u=!0);u&&(t=t.replace(c,"https:"));return t};q=f.widgets.popup;var w=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,label:q.NLS_moreInfo},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,
label:"${hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,appName:"App Studio Player",label:q.NLS_openLinkInApp},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,appName:"Collector",label:q.NLS_openLinkInApp},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,appName:"Explorer",label:q.NLS_openLinkInApp},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,appName:"Navigator",label:q.NLS_openLinkInApp},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,appName:"Survey123",
label:q.NLS_openLinkInApp},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,appName:"Trek2There",label:q.NLS_openLinkInApp},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,appName:"Workforce",label:q.NLS_openLinkInApp},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,appName:"iForm",label:q.NLS_openLinkInApp},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,appName:"FlowFinity",label:q.NLS_openLinkInApp},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,appName:"Laserfische",label:q.NLS_openLinkInApp},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,
appName:"Microsoft Power BI",label:q.NLS_openLinkInApp}];d.getURIInfo=function(t){var C;m.some(w,function(u){u.pattern.test(t)&&(C=u);return!!C});return C};d.isKnownURI=function(t){return!!d.getURIInfo(t)};d.base64UrlEncode=function(t){return btoa(String.fromCharCode.apply(null,t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")};F.mixin(y,d);y._getProxyUrl=d.getProxyUrl;y._getProxiedUrl=d.addProxy;y._hasSameOrigin=d.hasSameOrigin;y._canDoXOXHR=d.canUseXhr;y._getAbsoluteUrl=d.getAbsoluteUrl;
y.fixUrl=d.fixUrl;return d})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),function(F,m,a,D,z,y){function r(){m.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}r.prototype={addPlugin:function(q,n){var f=this,d=this._plugins,e=new z;try{F([q],function(b){q in d?e.resolve({id:d[q].declaredId||q.replace(/\//g,".")}):(d[q]=b,y(b.add(f,n),function(){var c={id:b.declaredId||q.replace(/\//g,".")};
f.emit("plugin-add",c);e.resolve(c)},function(c){e.reject(c)}))})}catch(b){e.reject(b)}return e.promise},removePlugin:function(q){if(q in this._plugins){var n=this._plugins[q];n.remove(this);delete this._plugins[q];this.emit("plugin-remove",{id:n.declaredId||q.replace(/\//g,".")})}},_pluginsHandler:function(){var q=this;a.some(arguments,function(n){if(n&&n.plugins&&n.plugins instanceof Array){n=n.plugins;var f;for(f=0;f<n.length;f++){var d=n[f];var e=d instanceof Object?d.id:d;q.addPlugin(e,d.options)}return!0}})}};
return r})},"esri/Color":function(){define(["dojo/_base/declare","dojo/_base/Color","dojo/has","./kernel"],function(F,m,a,D){var z=F([m],{declaredClass:"esri.Color"});z.toJsonColor=function(y){return y&&[y.r,y.g,y.b,1<y.a?y.a:Math.round(255*y.a)]};z.toDojoColor=function(y){return y&&new z([y[0],y[1],y[2],y[3]/255])};a="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(F=0;F<a.length;F++)z[a[F]]=m[a[F]];return D.Color=z})},"esri/promiseList":function(){define(["dojo/_base/array",
"dojo/Deferred","dojo/when"],function(F,m,a){var D=F.forEach;return function(z){function y(c,h){d[h]=c;e.progress([c,h]);0===--b&&e.resolve(d)}var r,q;z instanceof Array?q=z:z&&"object"===typeof z&&(r=z);var n=[];if(r){q=[];for(var f in r)Object.hasOwnProperty.call(r,f)&&(n.push(f),q.push(r[f]));var d={}}else q&&(d=[]);if(!q||!q.length)return(new m).resolve(d);var e=new m;e.promise.always(function(){d=n=null});var b=q.length;D(q,function(c,h){r||n.push(h);a(c,function(g){e.isFulfilled()||y(g,n[h])},
function(g){e.isFulfilled()||y(g,n[h])})});return e.promise}})},"esri/arcade/Dictionary":function(){define("require exports ./ImmutableArray ./languageUtils ./polyfill/promiseUtils ../geometry/Geometry".split(" "),function(F,m,a,D,z,y){function r(n,f){void 0===f&&(f=!1);if(null===n||void 0===n)return null;if(D.isNumber(n))return D.toNumber(n);if(D.isBoolean(n))return D.toBoolean(n);if(D.isString(n))return D.toString(n);if(D.isDate(n))return D.toDate(n);if(D.isArray(n)){for(var d=[],e=0;e<n.length;e++)d.push(r(n[e],
f));return d}e=new q;e.immutable=!1;for(var b=0,c=Object.keys(n);b<c.length;b++){var h=c[b];d=n[h];void 0!==d&&e.setField(h,r(d,f))}e.immutable=f;return e}var q=function(){function n(f){this.declaredClass="esri.arcade.Dictionary";this.attributes=null;this.plain=!1;this.immutable=!0;this.attributes=f instanceof n?f.attributes:void 0===f?{}:null===f?{}:f}n.prototype.field=function(f){var d=f.toLowerCase(),e=this.attributes[f];if(void 0!==e)return e;for(var b in this.attributes)if(b.toLowerCase()===
d)return this.attributes[b];throw Error("Field not Found : "+f);};n.prototype.setField=function(f,d){if(this.immutable)throw Error("Dictionary is Immutable");var e=f.toLowerCase();if(void 0===this.attributes[f])for(var b in this.attributes)if(b.toLowerCase()===e){this.attributes[b]=d;return}this.attributes[f]=d};n.prototype.hasField=function(f){var d=f.toLowerCase();if(void 0!==this.attributes[f])return!0;for(var e in this.attributes)if(e.toLowerCase()===d)return!0;return!1};n.prototype.keys=function(){var f=
[],d;for(d in this.attributes)f.push(d);return f=f.sort()};n.prototype.castToText=function(){var f="",d;for(d in this.attributes){""!==f&&(f+=",");var e=this.attributes[d];null==e?f+=JSON.stringify(d)+":null":D.isBoolean(e)||D.isNumber(e)||D.isString(e)?f+=JSON.stringify(d)+":"+JSON.stringify(e):e instanceof y?f+=JSON.stringify(d)+":"+D.toStringExplicit(e):e instanceof a?f+=JSON.stringify(d)+":"+D.toStringExplicit(e):e instanceof Array?f+=JSON.stringify(d)+":"+D.toStringExplicit(e):e instanceof Date?
f+=JSON.stringify(d)+":"+JSON.stringify(e):null!==e&&"object"===typeof e&&void 0!==e.castToText&&(f+=JSON.stringify(d)+":"+e.castToText())}return"{"+f+"}"};n.convertObjectToArcadeDictionary=function(f,d){void 0===d&&(d=!0);var e=new n;e.immutable=!1;for(var b in f){var c=f[b];void 0!==c&&e.setField(b.toString(),r(c))}e.immutable=d;return e};n.convertJsonToArcade=function(f,d){void 0===d&&(d=!1);return r(f,d)};n.prototype.castAsJson=function(f){void 0===f&&(f=null);var d={};for(b in this.attributes){var e=
this.attributes[b];if(void 0!==e){if(null===f||void 0===f?0:f.keyTranslate)var b=f.keyTranslate(b);d[b]=D.castAsJson(e,f)}}return d};n.prototype.castDictionaryValueAsJsonAsync=function(f,d,e,b,c){void 0===b&&(b=null);return D.castAsJsonAsync(e,b,c).then(function(h){return f[d]=h})};n.prototype.castAsJsonAsync=function(f,d){void 0===f&&(f=null);void 0===d&&(d=null);var e={},b=[];for(h in this.attributes){var c=this.attributes[h];if(null===d||void 0===d?0:d.keyTranslate)var h=d.keyTranslate(h);void 0!==
c&&(D.isSimpleType(c)||c instanceof y||c instanceof Date?e[h]=D.castAsJson(c,d):b.push(this.castDictionaryValueAsJsonAsync(e,h,c,f,d)))}return 0<b.length?z.all(b).then(function(){return e}):z.resolve(e)};return n}();return q})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(F,m){return function(){function a(D){void 0===D&&(D=[]);this._elements=D}a.prototype.length=function(){return this._elements.length};a.prototype.get=function(D){return this._elements[D]};a.prototype.toArray=
function(){for(var D=[],z=0;z<this.length();z++)D.push(this.get(z));return D};return a}()})},"esri/arcade/languageUtils":function(){define("require exports ./FunctionWrapper ./ImmutableArray ./ImmutablePathArray ./ImmutablePointArray ./polyfill/promiseUtils ../geometry/Extent ../geometry/Geometry ../geometry/Multipoint ../geometry/Point ../geometry/Polygon ../geometry/Polyline ../libs/luxon/luxon dojo/number dojo/_base/kernel".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g){function k(X,oa,xa){return""===
oa||null===oa||void 0===oa||oa===xa||oa===xa?X:X=X.split(oa).join(xa)}function w(X){return X instanceof S||X instanceof a||X instanceof ma}function t(X){return C(X)||x(X)||A(X)||u(X)||null===X||X===m.voidOperation||"number"===typeof X?!0:!1}function C(X){return"string"===typeof X||X instanceof String}function u(X){return"boolean"===typeof X}function x(X){return"number"===typeof X}function l(X){return X instanceof Array}function v(X){return X instanceof D}function A(X){return X instanceof Date}function B(X,
oa){if(!1===isNaN(X)){if(void 0===oa||null===oa||""===oa)return X.toString();oa=k(oa,"\u2030","");oa=k(oa,"\u00a4","");return h.format(X,{pattern:oa})}return X.toString()}function E(X,oa){var xa=c.DateTime.fromJSDate(X);return void 0===oa||null===oa||""===oa?xa.toISO({suppressMilliseconds:!0}):xa.toFormat(G(oa),{locale:g.locale,numberingSystem:"latn"})}function G(X){X=X.replace(/LTS|LT|LL?L?L?|l{1,4}/g,"[$\x26]");var oa="",xa=0;for(X=X.match(/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g);xa<
X.length;xa++){var Ha=X[xa];switch(Ha){case "D":oa+="d";break;case "DD":oa+="dd";break;case "DDD":oa+="o";break;case "d":oa+="c";break;case "ddd":oa+="ccc";break;case "dddd":oa+="cccc";break;case "M":oa+="L";break;case "MM":oa+="LL";break;case "MMM":oa+="LLL";break;case "MMMM":oa+="LLLL";break;case "YY":oa+="yy";break;case "Y":case "YYYY":oa+="yyyy";break;case "Q":oa+="q";break;case "Z":oa+="ZZ";break;case "ZZ":oa+="ZZZ";break;case "S":oa+="'S'";break;case "SS":oa+="'SS'";break;case "SSS":oa+="u";
break;case "A":case "a":oa+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":case "X":case "x":oa+=Ha;break;default:oa=2<=Ha.length&&"["===Ha.slice(0,1)&&"]"===Ha.slice(-1)?oa+("'"+Ha.slice(1,-1)+"'"):oa+("'"+Ha+"'")}}return oa}function I(X,oa,xa){switch(xa){case "\x3e":return X>oa;case "\x3c":return X<oa;case "\x3e\x3d":return X>=oa;case "\x3c\x3d":return X<=oa}return!1}function L(X,oa){if(X===oa||null===X&&oa===m.voidOperation||null===oa&&X===m.voidOperation)return!0;
if(A(X)&&A(oa))return X.getTime()===oa.getTime();if(X instanceof z||X instanceof y)return X.equalityTest(oa);if(X instanceof d&&oa instanceof d){var xa=X.getCacheValue("_arcadeCacheId"),Ha=oa.getCacheValue("_arcadeCacheId");if(void 0!==xa&&null!==xa)return xa===Ha}return void 0!==X&&void 0!==oa&&null!==X&&null!==oa&&"object"===typeof X&&"object"===typeof oa&&(X._arcadeCacheId===oa._arcadeCacheId&&void 0!==X._arcadeCacheId&&null!==X._arcadeCacheId||X._underlyingGraphic===oa._underlyingGraphic&&void 0!==
X._underlyingGraphic&&null!==X._underlyingGraphic)?!0:!1}function K(X,oa){if(C(X))return X;if(null===X)return"";if(x(X))return B(X,oa);if(u(X))return X.toString();if(A(X))return E(X,oa);if(X instanceof n)return JSON.stringify(X.toJson());if(l(X)){for(var xa=[],Ha=0;Ha<X.length;Ha++)xa[Ha]=T(X[Ha]);return"["+xa.join(",")+"]"}if(X instanceof D){xa=[];for(Ha=0;Ha<X.length();Ha++)xa[Ha]=T(X.get(Ha));return"["+xa.join(",")+"]"}return null!==X&&"object"===typeof X&&void 0!==X.castToText?X.castToText():
w(X)?"object, Function":""}function ba(X,oa){if(C(X))return X;if(null===X)return"";if(x(X))return B(X,oa);if(u(X))return X.toString();if(A(X))return E(X,oa);if(X instanceof n)return X instanceof q?'{"xmin":'+X.xmin.toString()+',"ymin":'+X.ymin.toString()+","+(X.hasZ?'"zmin":'+X.zmin.toString()+",":"")+(X.hasM?'"mmin":'+X.mmin.toString()+",":"")+'"xmax":'+X.xmax.toString()+',"ymax":'+X.ymax.toString()+","+(X.hasZ?'"zmax":'+X.zmax.toString()+",":"")+(X.hasM?'"mmax":'+X.mmax.toString()+",":"")+'"spatialReference":'+
Z(X.spatialReference)+"}":Z(X.toJson(),function(Ia,ia){return Ia.key===ia.key?0:"spatialReference"===Ia.key?1:"spatialReference"===ia.key||Ia.key<ia.key?-1:Ia.key>ia.key?1:0});if(l(X)){for(var xa=[],Ha=0;Ha<X.length;Ha++)xa[Ha]=T(X[Ha]);return"["+xa.join(",")+"]"}if(X instanceof D){xa=[];for(Ha=0;Ha<X.length();Ha++)xa[Ha]=T(X.get(Ha));return"["+xa.join(",")+"]"}return null!==X&&"object"===typeof X&&void 0!==X.castToText?X.castToText():w(X)?"object, Function":""}function T(X){return null===X?"null":
u(X)||x(X)||C(X)?JSON.stringify(X):X instanceof n||X instanceof D||X instanceof Array?ba(X):X instanceof Date?JSON.stringify(E(X,"")):null!==X&&"object"===typeof X&&void 0!==X.castToText?X.castToText():"null"}function P(X,oa){return x(X)?X:null===X||""===X?0:A(X)?NaN:u(X)?X?1:0:l(X)||""===X||void 0===X?NaN:void 0!==oa&&C(X)?(oa=k(oa,"\u2030",""),oa=k(oa,"\u00a4",""),h.parse(X,{pattern:oa})):X===m.voidOperation?0:Number(X)}function J(X){var oa=/ (\d\d)/,xa=c.DateTime.fromISO(X);return xa.isValid||
oa.test(X)&&(X=X.replace(oa,"T$1"),xa=c.DateTime.fromISO(X),xa.isValid)?xa:null}function N(X,oa){var xa;oa.fields.some(function(Ha){Ha.name.toLowerCase()===X.toLowerCase()&&(xa=Ha.domain);return!!xa});return xa}function Z(X,oa){oa||(oa={});"function"===typeof oa&&(oa={cmp:oa});var xa="boolean"===typeof oa.cycles?oa.cycles:!1,Ha=oa.cmp&&function(ia){return function(ea){return function(za,Ca){return ia({key:za,value:ea[za]},{key:Ca,value:ea[Ca]})}}}(oa.cmp),Ia=[];return function za(ea){ea&&ea.toJson&&
"function"===typeof ea.toJson&&(ea=ea.toJson());if(void 0!==ea){if("number"===typeof ea)return isFinite(ea)?""+ea:"null";if("object"!==typeof ea)return JSON.stringify(ea);var Ca;if(Array.isArray(ea)){var Da="[";for(Ca=0;Ca<ea.length;Ca++)Ca&&(Da+=","),Da+=za(ea[Ca])||"null";return Da+"]"}if(null===ea)return"null";if(-1!==Ia.indexOf(ea)){if(xa)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var ka=Ia.push(ea)-1,ta=Object.keys(ea).sort(Ha&&Ha(ea));Da=
"";for(Ca=0;Ca<ta.length;Ca++){var M=ta[Ca],Ga=za(ea[M]);Ga&&(Da&&(Da+=","),Da+=JSON.stringify(M)+":"+Ga)}Ia.splice(ka,1);return"{"+Da+"}"}}(X)}function Y(X,oa){if(oa instanceof d)X.push([oa.x,oa.y]);else throw Error("Invalid Argument");}function qa(X,oa){void 0===oa&&(oa=null);if(null!=X){if(u(X)||x(X)||C(X))return X;if(X instanceof n)return!0===(null===oa||void 0===oa?void 0:oa.keepGeometryType)?X:X.toJson();if(X instanceof D)return X.toArray().map(function(xa){return qa(xa,oa)});if(X instanceof
Array)return X.map(function(xa){return qa(xa,oa)});if(X instanceof Date)return X;if(null!==X&&"object"===typeof X&&void 0!==X.castAsJson)return X.castAsJson(oa)}return null}function V(X,oa,xa,Ha,Ia){return na(X,oa,xa).then(function(ia){Ia[Ha]=ia})}function na(X,oa,xa){void 0===oa&&(oa=null);void 0===xa&&(xa=null);X instanceof D&&(X=X.toArray());if(null!=X){if(t(X)||X instanceof n||X instanceof Date)return r.resolve(qa(X,xa));if(X instanceof Array){for(var Ha=[],Ia=[],ia=0;ia<X.length;ia++){var ea=
X[ia];null===ea||t(ea)||ea instanceof n||ea instanceof Date?Ia.push(qa(ea,xa)):(Ia.push(null),Ha.push(V(ea,oa,xa,Ia.length-1,Ia)))}return 0<Ha.length?r.all(Ha).then(function(){return Ia}):r.resolve(Ia)}if(null!==X&&"object"===typeof X&&void 0!==X.castAsJsonAsync)return X.castAsJsonAsync(oa,xa)}return r.resolve(null)}Object.defineProperty(m,"__esModule",{value:!0});m.castAsJsonAsync=m.castAsJson=m.binaryOperator=m.tick=m.toStringArray=m.autoCastArrayOfPointsToMultiPoint=m.autoCastArrayOfPointsToPolyline=
m.autoCastArrayOfPointsToPolygon=m.autoCastFeatureToGeometry=m.stableStringify=m.getDomain=m.getDomainCode=m.getDomainValue=m.fixNullGeometry=m.fixSpatialReference=m.toBoolean=m.toDateTime=m.toDate=m.toNumber=m.toStringExplicit=m.toNumberArray=m.toString=m.equalityTest=m.greaterThanLessThan=m.standardiseDateFormat=m.formatDate=m.formatNumber=m.generateUUID=m.absRound=m.pcCheck=m.isDate=m.isImmutableArray=m.isFeatureSetCollection=m.isFeatureSet=m.isArray=m.isInteger=m.isNumber=m.isBoolean=m.isString=
m.defaultUndefined=m.isSimpleType=m.isFunctionParameter=m.multiReplace=m.continueResult=m.breakResult=m.voidOperation=m.SizzleFunction=m.ReturnResult=m.ImplicitResult=m.NativeFunction=m.SizzleFunctionE=m.NativeFunctionE=m.ImplicitResultE=m.ReturnResultE=void 0;F=function(){return function(X){this.value=X}}();m.ReturnResultE=F;var ya=function(){return function(X){this.value=X}}();m.ImplicitResultE=ya;var S=function(){return function(X){this.fn=X}}();m.NativeFunctionE=S;var ma=function(){return function(X,
oa){this.paramCount=oa;this.fn=X}}();m.SizzleFunctionE=ma;m.NativeFunction=S;m.ImplicitResult=ya;m.ReturnResult=F;m.SizzleFunction=ma;m.voidOperation={type:"VOID"};m.breakResult={type:"BREAK"};m.continueResult={type:"CONTINUE"};m.multiReplace=k;m.isFunctionParameter=w;m.isSimpleType=t;m.defaultUndefined=function(X,oa){return void 0===X?oa:X};m.isString=C;m.isBoolean=u;m.isNumber=x;m.isInteger=function(X){return"number"===typeof X&&isFinite(X)&&Math.floor(X)===X};m.isArray=l;m.isFeatureSet=function(X){return!0===
(X&&X.declaredRootClass&&"esri.arcade.featureset.support.FeatureSet"===X.declaredRootClass)};m.isFeatureSetCollection=function(X){return!0===(X&&X.declaredRootClass&&"esri.arcade.featureSetCollection"===X.declaredRootClass)};m.isImmutableArray=v;m.isDate=A;m.pcCheck=function(X,oa,xa){if(X.length<oa||X.length>xa)throw Error("Function called with wrong number of Parameters");};m.absRound=function(X){return 0>X?-Math.round(-X):Math.round(X)};m.generateUUID=function(){var X=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(oa){var xa=(X+16*Math.random())%16|0;X=Math.floor(X/16);return("x"===oa?xa:xa&3|8).toString(16)})};m.formatNumber=B;m.formatDate=E;m.standardiseDateFormat=G;m.greaterThanLessThan=function(X,oa,xa){if(null===X){if(null===oa||oa===m.voidOperation)return I(null,null,xa);if(x(oa))return I(0,oa,xa);if(C(oa)||u(oa))return I(0,P(oa),xa);if(A(oa))return I(0,oa.getTime(),xa)}if(X===m.voidOperation){if(null===oa||oa===m.voidOperation)return I(null,null,xa);if(x(oa))return I(0,oa,xa);if(C(oa)||u(oa))return I(0,
P(oa),xa);if(A(oa))return I(0,oa.getTime(),xa)}else if(x(X)){if(x(oa))return I(X,oa,xa);if(u(oa))return I(X,P(oa),xa);if(null===oa||oa===m.voidOperation)return I(X,0,xa);if(C(oa))return I(X,P(oa),xa);if(A(oa))return I(X,oa.getTime(),xa)}else if(C(X)){if(C(oa))return I(K(X),K(oa),xa);if(A(oa))return I(P(X),oa.getTime(),xa);if(x(oa))return I(P(X),oa,xa);if(null===oa||oa===m.voidOperation)return I(P(X),0,xa);if(u(oa))return I(P(X),P(oa),xa)}else if(A(X)){if(A(oa))return I(X,oa,xa);if(null===oa||oa===
m.voidOperation)return I(X.getTime(),0,xa);if(x(oa))return I(X.getTime(),oa,xa);if(u(oa)||C(oa))return I(X.getTime(),P(oa),xa)}else if(u(X)){if(u(oa))return I(X,oa,xa);if(x(oa))return I(P(X),P(oa),xa);if(A(oa))return I(P(X),oa.getTime(),xa);if(null===oa||oa===m.voidOperation)return I(P(X),0,xa);if(C(oa))return I(P(X),P(oa),xa)}return!L(X,oa)||"\x3c\x3d"!==xa&&"\x3e\x3d"!==xa?!1:!0};m.equalityTest=L;m.toString=K;m.toNumberArray=function(X){var oa=[];if(!1===l(X))return null;if(X instanceof D){for(var xa=
0;xa<X.length();xa++)oa[xa]=P(X.get(xa));return oa}for(xa=0;xa<X.length;xa++)oa[xa]=P(X[xa]);return oa};m.toStringExplicit=ba;m.toNumber=P;m.toDate=function(X){return A(X)?X:C(X)&&(X=J(X))?X.toJSDate():null};m.toDateTime=function(X){return A(X)?c.DateTime.fromJSDate(X):C(X)?J(X):null};m.toBoolean=function(X){return u(X)?X:C(X)?(X=X.toLowerCase(),"true"===X?!0:!1):x(X)?0===X||isNaN(X)?!1:!0:!1};m.fixSpatialReference=function(X,oa){if(null===X||void 0===X)return null;if(null===X.spatialReference||void 0===
X.spatialReference)X.spatialReference=oa;return X};m.fixNullGeometry=function(X){if(null===X)return null;if(X instanceof d)return"NaN"===X.x||null===X.x||isNaN(X.x)?null:X;if(X instanceof e){if(0===X.rings.length)return null;for(var oa=0,xa=X.rings;oa<xa.length;oa++){var Ha=xa[oa];if(0<Ha.length)return X}return null}if(X instanceof b){if(0===X.paths.length)return null;oa=0;for(xa=X.paths;oa<xa.length;oa++)if(Ha=xa[oa],0<Ha.length)return X;return null}return X instanceof f?0===X.points.length?null:
X:X instanceof q?"NaN"===X.xmin||null===X.xmin||isNaN(X.xmin)?null:X:null};m.getDomainValue=function(X,oa){if(!X||!X.domain)return oa;var xa=null;if("string"===X.field.type||"esriFieldTypeString"===X.field.type)oa=K(oa);else{if(null===oa||void 0===oa)return null;if(""===oa)return oa;oa=P(oa)}for(var Ha=0;Ha<X.domain.codedValues.length;Ha++){var Ia=X.domain.codedValues[Ha];Ia.code===oa&&(xa=Ia)}return null===xa?oa:xa.name};m.getDomainCode=function(X,oa){if(!X||!X.domain)return oa;var xa=null;oa=K(oa);
for(var Ha=0;Ha<X.domain.codedValues.length;Ha++){var Ia=X.domain.codedValues[Ha];Ia.name===oa&&(xa=Ia)}return null===xa?oa:xa.code};m.getDomain=function(X,oa,xa,Ha){void 0===xa&&(xa=null);if(!oa||!oa.fields)return null;for(var Ia=null,ia=0;ia<oa.fields.length;ia++){var ea=oa.fields[ia];ea.name.toLowerCase()===X.toString().toLowerCase()&&(Ia=ea)}if(null===Ia)throw Error("Field not found");var za,Ca;Ha||(Ha=xa&&oa.typeIdField&&xa._field(oa.typeIdField));null!=Ha&&oa.types.some(function(Da){return Da.id===
Ha?((za=Da.domains&&Da.domains[Ia.name])&&"inherited"===za.type&&(za=N(Ia.name,oa),Ca=!0),!0):!1});Ca||za||(za=N(X,oa));return{field:Ia,domain:za}};m.stableStringify=Z;m.autoCastFeatureToGeometry=function(X){if(null===X)return null;for(var oa=[],xa=0;xa<X.length;xa++){var Ha=X[xa];Ha&&(Ha.declaredClass&&"esri.arcade.Feature"===Ha.declaredClass||"FeatureSetReader"===Ha.type)?oa.push(Ha.geometry()):oa.push(Ha)}return oa};m.autoCastArrayOfPointsToPolygon=function(X,oa){if(l(X)||v(X)){var xa=!1,Ha=!1,
Ia=[],ia=oa;if(l(X)){for(var ea=0;ea<X.length;ea++){var za=X[ea];Y(Ia,za)}0<Ia.length&&(ia=X[0].spatialReference,xa=X[0].hasZ,Ha=X[0].hasM)}else if(X instanceof y)Ia=X._elements,0<Ia.length&&(xa=X._hasZ,Ha=X._hasM,ia=X.get(0).spatialReference);else if(v(X)){ea=0;for(var Ca=X.toArray();ea<Ca.length;ea++)za=Ca[ea],Y(Ia,za);0<Ia.length&&(ia=X.get(0).spatialReference,xa=!0===X.get(0).hasZ,Ha=!0===X.get(0).hasM)}else throw Error("Invalid Argument");if(0===Ia.length)return null;!1===(new e({rings:[],spatialReference:{wkid:4326}})).isClockwise(Ia)&&
(Ia=Ia.slice(0).reverse());return new e({rings:[Ia],spatialReference:ia,hasZ:xa,hasM:Ha})}return X};m.autoCastArrayOfPointsToPolyline=function(X,oa){if(l(X)||v(X)){var xa=!1,Ha=!1,Ia=[],ia=oa;if(l(X)){for(var ea=0;ea<X.length;ea++){var za=X[ea];Y(Ia,za)}0<Ia.length&&(ia=X[0].spatialReference,xa=!0===X[0].hasZ,Ha=!0===X[0].hasM)}else if(X instanceof y)Ia=X._elements,0<Ia.length&&(xa=X._hasZ,Ha=X._hasM,ia=X.get(0).spatialReference);else if(v(X)){ea=0;for(var Ca=X.toArray();ea<Ca.length;ea++)za=Ca[ea],
Y(Ia,za);0<Ia.length&&(ia=X.get(0).spatialReference,xa=!0===X.get(0).hasZ,Ha=!0===X.get(0).hasM)}return 0===Ia.length?null:new b({paths:[Ia],spatialReference:ia,hasZ:xa,hasM:Ha})}return X};m.autoCastArrayOfPointsToMultiPoint=function(X,oa){if(l(X)||v(X)){var xa=!1,Ha=!1,Ia=[],ia=oa;if(l(X)){for(var ea=0;ea<X.length;ea++){var za=X[ea];Y(Ia,za)}0<Ia.length&&(ia=X[0].spatialReference,xa=!0===X[0].hasZ,Ha=!0===X[0].hasM)}else if(X instanceof y)Ia=X._elements,0<Ia.length&&(xa=X._hasZ,Ha=X._hasM,ia=X.get(0).spatialReference);
else if(v(X)){ea=0;for(var Ca=X.toArray();ea<Ca.length;ea++)za=Ca[ea],Y(Ia,za);0<Ia.length&&(ia=X.get(0).spatialReference,xa=!0===X.get(0).hasZ,Ha=!0===X.get(0).hasM)}return 0===Ia.length?null:new f({points:Ia,spatialReference:ia,hasZ:xa,hasM:Ha})}return X};m.toStringArray=function(X,oa){void 0===oa&&(oa=!1);var xa=[];if(null===X)return xa;if(!0===l(X)){for(var Ha=0;Ha<X.length;Ha++){var Ia=K(X[Ha]);""===Ia&&!0!==oa||xa.push(Ia)}return xa}if(X instanceof D){for(Ha=0;Ha<X.length();Ha++)Ia=K(X.get(Ha)),
""===Ia&&!0!==oa||xa.push(Ia);return xa}return t(X)?(Ia=K(X),""===Ia&&!0!==oa||xa.push(Ia),xa):[]};var ja=0;m.tick=function(X){ja++;return 0===ja%100?(ja=0,r.create(function(oa){setTimeout(function(){oa(X)},0)})):X};m.binaryOperator=function(X,oa,xa){switch(xa){case "\x26":return X&oa;case "|":return X|oa;case "^":return X^oa;case "\x3c\x3c":return X<<oa;case "\x3e\x3e":return X>>oa;case "\x3e\x3e\x3e":return X>>>oa}};m.castAsJson=qa;m.castAsJsonAsync=na})},"esri/arcade/FunctionWrapper":function(){define(["require",
"exports"],function(F,m){return function(){return function(a,D){this.context=this.definition=null;this.definition=a;this.context=D}}()})},"esri/arcade/ImmutablePathArray":function(){var F=this&&this.__extends||function(){var m=function(a,D){m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,y){z.__proto__=y}||function(z,y){for(var r in y)Object.prototype.hasOwnProperty.call(y,r)&&(z[r]=y[r])};return m(a,D)};return function(a,D){function z(){this.constructor=a}if("function"!==typeof D&&
null!==D)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");m(a,D);a.prototype=null===D?Object.create(D):(z.prototype=D.prototype,new z)}}();define(["require","exports","./ImmutableArray","./ImmutablePointArray"],function(m,a,D,z){return function(y){function r(q,n,f,d,e){q=y.call(this,q)||this;q._lazyPath=[];q._hasZ=!1;q._hasM=!1;q._hasZ=f;q._hasM=d;q._spRef=n;q._cacheId=e;return q}F(r,y);r.prototype.get=function(q){if(void 0===this._lazyPath[q]){var n=this._elements[q];
if(void 0===n)return;this._lazyPath[q]=new z(n,this._spRef,this._hasZ,this._hasM,this._cacheId,q)}return this._lazyPath[q]};r.prototype.equalityTest=function(q){return q===this?!0:null===q||!1===q instanceof r?!1:q.getUniqueHash()===this.getUniqueHash()};r.prototype.getUniqueHash=function(){return this._cacheId.toString()};return r}(D)})},"esri/arcade/ImmutablePointArray":function(){var F=this&&this.__extends||function(){var m=function(a,D){m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&
function(z,y){z.__proto__=y}||function(z,y){for(var r in y)Object.prototype.hasOwnProperty.call(y,r)&&(z[r]=y[r])};return m(a,D)};return function(a,D){function z(){this.constructor=a}if("function"!==typeof D&&null!==D)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");m(a,D);a.prototype=null===D?Object.create(D):(z.prototype=D.prototype,new z)}}();define(["require","exports","./ImmutableArray","../geometry/Point"],function(m,a,D,z){return function(y){function r(q,
n,f,d,e,b){q=y.call(this,q)||this;q._lazyPt=[];q._hasZ=!1;q._hasM=!1;q._spRef=n;q._hasZ=f;q._hasM=d;q._cacheId=e;q._partId=b;return q}F(r,y);r.prototype.get=function(q){if(void 0===this._lazyPt[q]){var n=this._elements[q];if(void 0===n)return;var f=this._hasZ,d=this._hasM,e=null;e=f&&!d?new z(n[0],n[1],n[2],void 0,this._spRef):d&&!f?new z(n[0],n[1],void 0,n[2],this._spRef):f&&d?new z(n[0],n[1],n[2],n[3],this._spRef):new z(n[0],n[1],this._spRef);e.setCacheValue("_arcadeCacheId",this._cacheId.toString()+
"-"+this._partId.toString()+"-"+q.toString());this._lazyPt[q]=e}return this._lazyPt[q]};r.prototype.equalityTest=function(q){return q===this?!0:null===q||!1===q instanceof r?!1:q.getUniqueHash()===this.getUniqueHash()};r.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()};return r}(D)})},"esri/arcade/polyfill/promiseUtils":function(){define(["require","exports","dojo/Deferred","dojo/promise/all"],function(F,m,a,D){function z(n,f){var d=new a(f);n(function(e){return q(e).then(d.resolve)},
d.reject);return d.promise}function y(n){if(n){if("function"!==typeof n.forEach){var f=Object.keys(n),d=f.map(function(b){return n[b]});return y(d).then(function(b){var c={};f.forEach(function(h,g){return c[h]=b[g]});return c})}var e=null;return z(function(b,c){var h=[],g=n.length;0===g&&b(h);n.forEach(function(k){var w={promise:k};h.push(w);k.then(function(t){w.value=t})["catch"](function(t){w.error=t}).then(function(){--g;0===g&&(e?c(Error("AbortError")):b(h))})})},function(b){e=b||"Invocation cancellation";
n.forEach(function(c){return c.cancel(b)})})}}function r(n){void 0===n&&(n=void 0);var f=new a;f.resolve(n);return f.promise}function q(n){return n&&"function"===typeof n.then?n:r(n)}Object.defineProperty(m,"__esModule",{value:!0});m.createResolver=m.when=m.isPromiseLike=m.wrapCallback=m.timeout=m.after=m.resolve=m.reject=m.first=m.eachAlwaysValues=m.eachAlways=m.createDeferred=m.create=m.filter=m.all=void 0;m.all=function(n){return D(n)};m.filter=function(n,f){var d=n.slice();return D(n.map(function(e,
b){return f(e,b)})).then(function(e){return d.filter(function(b,c){return e[c]})})};m.create=z;m.createDeferred=function(n){var f=null;n=z(function(d,e){f={resolve:d,reject:e}},n);f.promise=n;f.cancel=function(){f.reject(Error("AbortError"))};return f};m.eachAlways=y;m.eachAlwaysValues=function(n){return y(n).then(function(f){return f.filter(function(d){return!!d.value}).map(function(d){return d.value})})};m.first=function(n){return n&&n.length?z(function(f,d){for(var e=0;e<n.length;e++)n[e].then(f,
d)}):r()};m.reject=function(n){var f=new a;f.reject(n);return f.promise};m.resolve=r;m.after=function(n,f){void 0===f&&(f=void 0);var d=0;return z(function(e){d=setTimeout(function(){e(f)},n)},function(){d&&(clearTimeout(d),d=0)})};m.timeout=function(n,f,d){var e=0,b=new a(n.cancel);n.then(function(c){b.isFulfilled()||(b.resolve(c),e&&(clearTimeout(e),e=0))});n["catch"](function(c){b.isFulfilled()||(b.reject(c),e&&(clearTimeout(e),e=0))});e=setTimeout(function(){b.reject(d||Error("promiseUtils:timeout"))},
f);return b.promise};m.wrapCallback=function(n){var f=!1;return z(function(){n(function(d){f||r(d)})},function(){return f=!0})};m.isPromiseLike=function(n){return n&&"function"===typeof n.then};m.when=q;m.createResolver=function(n){var f,d;n=z(function(b,c){f=b;d=c},n);var e=function(b){f(b)};e.resolve=function(b){return f(b)};e.reject=function(b){return d(b)};e.promise=n;return e}})},"dojo/promise/all":function(){define(["../_base/array","../_base/lang","../Deferred","../when"],function(F,m,a,D){var z=
F.some;return function(y){var r,q;m.isArray(y)?q=y:y&&"object"===typeof y&&(r=y);var n=[];if(r){q=[];for(var f in r)Object.hasOwnProperty.call(r,f)&&(n.push(f),q.push(r[f]));var d={}}else q&&(d=[]);if(!q||!q.length)return(new a).resolve(d);var e=new a;e.promise.always(function(){d=n=null});var b=q.length;z(q,function(c,h){r||n.push(h);D(c,function(g){e.isFulfilled()||(d[n[h]]=g,0===--b&&e.resolve(d))},e.reject);return e.isFulfilled()});return e.promise}})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(F,m,a,D,z,y,r,q,n,f){function d(){}function e(){}a={type:"multipoint",points:null};F=F(r,{declaredClass:"esri.geometry.Multipoint",type:"multipoint",points:null,constructor:function(b){this.points=[];b&&(b.points?z.mixin(this,b):this.spatialReference=b,this.spatialReference&&(this.spatialReference=f.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(b){this.clearCache();m.isArray(b)?this.points.push(b):this.points.push([b.x,b.y]);return this},removePoint:function(b){if(this._validateInputs(b))return this.clearCache(),
new q(this.points.splice(b,1)[0],this.spatialReference)},getExtent:function(){var b=this.getCacheValue("_extent");if(b)return new n(b);b=this.points;var c=b.length;if(c){var h=b[0],g,k,w=g=h[0],t=k=h[1],C=Math.min,u=Math.max,x=this.spatialReference,l;for(l=0;l<c;l++){h=b[l];var v=h[0];h=h[1];w=C(w,v);t=C(t,h);g=u(g,v);k=u(k,h)}b={xmin:w,ymin:t,xmax:g,ymax:k,spatialReference:x?x.toJson():null};this.setCacheValue("_extent",b);return new n(b)}},_validateInputs:function(b){return null===b||0>b||b>=this.points.length?
!1:!0},getPoint:function(b){if(this._validateInputs(b))return b=this.points[b],new q(b[0],b[1],this.spatialReference)},setPoint:function(b,c){if(this._validateInputs(b))return this.clearCache(),this.points[b]=[c.x,c.y],this},toJson:function(){var b={points:z.clone2DArray(this.points)},c=this.spatialReference;c&&(b.spatialReference=c.toJson());return b}});d.prototype=F.prototype;e.prototype=new d;Object.defineProperty(e.prototype,"points",{get:function(){this._unquantizeFn&&(this._pointsVal=this._unquantizeFn({points:z.clone2DArray(this._pointsVal)}).points,
this._unquantizeFn=null);return this._pointsVal},set:function(b){this._pointsVal=b}});e.prototype.setupLazyUnquantization=function(b,c){this._unquantizeFn=b;this._pointsVal=c.points};F.simpleConstructor=d;F.accessorConstructor=e;F.defaultProps=a;m.setObject("geometry.Multipoint",F,D);D.geometry.defaultMultipoint=a;return F})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e){function b(){}function c(){}D={type:"polygon",rings:null};var h=F(q,{declaredClass:"esri.geometry.Polygon",type:"polygon",rings:null,constructor:function(g){this.rings=[];this._ring=0;g&&(a.isArray(g)?this.rings=a.isArray(g[0][0])?g:[g]:g.rings?y.mixin(this,g):this.spatialReference=g,this.spatialReference&&(this.spatialReference=e.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(g){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=
[];a.isArray(g[0])?m.forEach(g,this._addPointArr,this):m.forEach(g,this._addPoint,this);return this},_addPointArr:function(g){this.rings[this._ring].push(g)},_addPoint:function(g){this.rings[this._ring].push([g.x,g.y])},_insertPoints:function(g,k){this.clearCache();this._ring=k;this.rings[this._ring]||(this.rings[this._ring]=[]);m.forEach(g,this._addPoint,this)},_validateInputs:function(g,k){return null!==g&&void 0!==g&&(0>g||g>=this.rings.length)||null!==k&&void 0!==g&&(0>k||k>=this.rings[g].length)?
!1:!0},getPoint:function(g,k){if(this._validateInputs(g,k))return new n(this.rings[g][k],this.spatialReference)},setPoint:function(g,k,w){if(this._validateInputs(g,k))return this.clearCache(),this.rings[g][k]=[w.x,w.y],this},insertPoint:function(g,k,w){if(this._validateInputs(g)&&null!=k&&0<=k&&k<=this.rings[g].length)return this.clearCache(),this.rings[g].splice(k,0,[w.x,w.y]),this},removeRing:function(g){if(this._validateInputs(g,null)){this.clearCache();g=this.rings.splice(g,1)[0];var k,w=g.length,
t=this.spatialReference;for(k=0;k<w;k++)g[k]=new n(g[k],t);return g}},removePoint:function(g,k){if(this._validateInputs(g,k))return this.clearCache(),new n(this.rings[g].splice(k,1)[0],this.spatialReference)},getExtent:function(){var g=this.getCacheValue("_extent");var k=this.getCacheValue("_partwise");if(g)return g=new f(g),g._partwise=k,g;g=this.rings;var w=g.length;if(w&&g[0].length){var t,C,u,x,l=t=g[0][0][0],v=C=g[0][0][1],A=Math.min,B=Math.max,E=this.spatialReference;k=[];var G,I;for(u=0;u<
w;u++){var L=g[u];var K=G=L[0]&&L[0][0];var ba=I=L[0]&&L[0][1];var T=L.length;for(x=0;x<T;x++){var P=L[x];var J=P[0];P=P[1];l=A(l,J);v=A(v,P);t=B(t,J);C=B(C,P);K=A(K,J);ba=A(ba,P);G=B(G,J);I=B(I,P)}k.push(new f({xmin:K,ymin:ba,xmax:G,ymax:I,spatialReference:E?E.toJson():null}))}g={xmin:l,ymin:v,xmax:t,ymax:C,spatialReference:E?E.toJson():null};k=1<k.length?k:null;this.setCacheValue("_extent",g);this.setCacheValue("_partwise",k);g=new f(g);g._partwise=k;return g}},contains:function(g){var k=this.rings,
w=!1,t,C,u,x=k.length;var l=this.spatialReference;var v=g.spatialReference;var A=g.x;g=g.y;l&&v&&!l.equals(v)&&l._canProject(v)&&(g=l.isWebMercator()?n.lngLatToXY(A,g):n.xyToLngLat(A,g,!0),A=g[0],g=g[1]);for(u=0;u<x;u++){l=k[u];var B=l.length;for(C=t=0;C<B;C++){t++;t===B&&(t=0);v=l[C];var E=l[t];(v[1]<g&&E[1]>=g||E[1]<g&&v[1]>=g)&&v[0]+(g-v[1])/(E[1]-v[1])*(E[0]-v[0])<A&&(w=!w)}}return w},getCentroid:function(){var g=this.getCacheValue("_centroid");if(void 0!==g)return g;g=this.rings;var k,w,t=[],
C,u,x=Infinity,l=-Infinity,v=Infinity,A=-Infinity;m.forEach(g,function(G){B=k=w=0;m.forEach(G,function(I,L){L<G.length-1&&(C=G[L+1],u=I[0]*C[1]-C[0]*I[1],B+=(I[0]+C[0])*u,k+=(I[1]+C[1])*u,w+=u,I[0]<x&&(x=I[0]),I[0]>l&&(l=I[0]),I[1]<v&&(v=I[1]),I[1]>A&&(A=I[1]))});0<w&&(w*=-1);w&&t.push([B,k,w/2])});t.sort(function(G,I){return G[2]-I[2]});var B=k=void 0;if(t[0]){var E=6*t[0][2];B=t[0][0]/E;k=t[0][1]/E;if(B<x||B>l||k<v||k>A)B=k=void 0}if(void 0===B||void 0===k)if(g=g[0]&&g[0].length?this._getLineCentroid(g[0]):
null)B=g.x,k=g.y;g=isNaN(B)||isNaN(k)?null:new n(B,k,this.spatialReference);this.setCacheValue("_centroid",g);return g},_getLineCentroid:function(g){var k=0,w=0,t=0,C={x:0,y:0},u={x:0,y:0},x,l=g.length,v;for(x=0;x<l-1;x++){var A=g[x];var B=g[x+1];if(A&&B){C.x=A[0];C.y=A[1];u.x=B[0];u.y=B[1];var E=d.getLength(C,u);0<E&&(k+=E,A=d.getMidpoint(A,B),w+=E*A[0],t+=E*A[1])}}0<k?v={x:w/k,y:t/k}:g[0]&&(v={x:g[0][0],y:g[0][1]});return v},isClockwise:function(g){var k=0,w,t=g.length,C=a.isArray(g[0])?function(u,
x){return u[0]*x[1]-x[0]*u[1]}:function(u,x){return u.x*x.y-x.x*u.y};for(w=0;w<t;w++)k+=C(g[w],g[(w+1)%t]);return 0>=k/2},isSelfIntersecting:function(g){g=g||this;var k,w,t,C,u,x=g.rings.length;for(t=0;t<x;t++){for(k=0;k<g.rings[t].length-1;k++){var l=[[g.rings[t][k][0],g.rings[t][k][1]],[g.rings[t][k+1][0],g.rings[t][k+1][1]]];for(w=t+1;w<x;w++)for(C=0;C<g.rings[w].length-1;C++){var v=[[g.rings[w][C][0],g.rings[w][C][1]],[g.rings[w][C+1][0],g.rings[w][C+1][1]]];if((u=d._getLineIntersection2(l,v))&&
!(u[0]===l[0][0]&&u[1]===l[0][1]||u[0]===v[0][0]&&u[1]===v[0][1]||u[0]===l[1][0]&&u[1]===l[1][1]||u[0]===v[1][0]&&u[1]===v[1][1]))return!0}}C=g.rings[t].length;if(!(4>=C))for(k=0;k<C-3;k++){var A=C-1;0===k&&(A=C-2);l=[[g.rings[t][k][0],g.rings[t][k][1]],[g.rings[t][k+1][0],g.rings[t][k+1][1]]];for(w=k+2;w<A;w++)if(v=[[g.rings[t][w][0],g.rings[t][w][1]],[g.rings[t][w+1][0],g.rings[t][w+1][1]]],(u=d._getLineIntersection2(l,v))&&!(u[0]===l[0][0]&&u[1]===l[0][1]||u[0]===v[0][0]&&u[1]===v[0][1]||u[0]===
l[1][0]&&u[1]===l[1][1]||u[0]===v[1][0]&&u[1]===v[1][1]))return!0}}return!1},toJson:function(){var g={rings:y.clone3DArray(this.rings)},k=this.spatialReference;k&&(g.spatialReference=k.toJson());return g}});b.prototype=h.prototype;c.prototype=new b;Object.defineProperty(c.prototype,"rings",{get:function(){this._unquantizeFn&&(this._ringsVal=this._unquantizeFn({rings:y.clone3DArray(this._ringsVal)}).rings,this._unquantizeFn=null);return this._ringsVal},set:function(g){this._ringsVal=g}});c.prototype.setupLazyUnquantization=
function(g,k){this._unquantizeFn=g;this._ringsVal=k.rings};h.simpleConstructor=b;h.accessorConstructor=c;h.defaultProps=D;h.createEllipse=function(g){var k=g.center.x,w=g.center.y,t=g.longAxis,C=g.shortAxis,u=g.numberOfPoints,x=g.map,l;g=[];var v=2*Math.PI/u;for(l=0;l<u;l++){var A=Math.cos(l*v);var B=Math.sin(l*v);A=x.toMap({x:t*A+k,y:C*B+w});g.push(A)}g.push(g[0]);k=new h(x.spatialReference);k.addRing(g);return k};h.createCircle=function(g){return h.createEllipse({center:g.center,longAxis:g.r,shortAxis:g.r,
numberOfPoints:g.numberOfPoints,map:g.map})};h.fromExtent=function(g){var k=g.normalize();g=g.spatialReference;return new h({rings:m.map(k,function(w){return[[w.xmin,w.ymin],[w.xmin,w.ymax],[w.xmax,w.ymax],[w.xmax,w.ymin],[w.xmin,w.ymin]]}),spatialReference:g?g.toJson():null})};a.setObject("geometry.Polygon",h,z);z.geometry.defaultPolygon=D;z.geometry.createEllipse=h.createEllipse;z.geometry.createCircle=h.createCircle;z.geometry.isClockwise=h.prototype.isClockwise;z.geometry.polygonSelfIntersecting=
h.prototype.isSelfIntersecting;return h})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d){function e(){}function b(){}D={type:"polyline",paths:null};F=F(q,{declaredClass:"esri.geometry.Polyline",type:"polyline",paths:null,constructor:function(c){this.paths=[];this._path=0;c&&(a.isArray(c)?this.paths=a.isArray(c[0][0])?c:
[c]:c.paths?y.mixin(this,c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=d.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(c){this.clearCache();this._path=this.paths.length;this.paths[this._path]=[];a.isArray(c[0])?m.forEach(c,this._addPointArr,this):m.forEach(c,this._addPoint,this);return this},_addPointArr:function(c){this.paths[this._path].push(c)},_addPoint:function(c){this.paths[this._path].push([c.x,c.y])},_insertPoints:function(c,h){this.clearCache();
this._path=h;this.paths[this._path]||(this.paths[this._path]=[]);m.forEach(c,this._addPoint,this)},_validateInputs:function(c,h){return null!==c&&void 0!==c&&(0>c||c>=this.paths.length)||null!==h&&void 0!==c&&(0>h||h>=this.paths[c].length)?!1:!0},getPoint:function(c,h){if(this._validateInputs(c,h))return new n(this.paths[c][h],this.spatialReference)},setPoint:function(c,h,g){if(this._validateInputs(c,h))return this.clearCache(),this.paths[c][h]=[g.x,g.y],this},insertPoint:function(c,h,g){if(this._validateInputs(c)&&
null!=h&&0<=h&&h<=this.paths[c].length)return this.clearCache(),this.paths[c].splice(h,0,[g.x,g.y]),this},removePath:function(c){if(this._validateInputs(c,null)){this.clearCache();c=this.paths.splice(c,1)[0];var h,g=c.length,k=this.spatialReference;for(h=0;h<g;h++)c[h]=new n(c[h],k);return c}},removePoint:function(c,h){if(this._validateInputs(c,h))return this.clearCache(),new n(this.paths[c].splice(h,1)[0],this.spatialReference)},getExtent:function(){var c=this.getCacheValue("_extent");var h=this.getCacheValue("_partwise");
if(c)return c=new f(c),c._partwise=h,c;c=this.paths;var g=c.length;if(g&&c[0].length){var k,w,t,C,u=k=c[0][0][0],x=w=c[0][0][1],l=Math.min,v=Math.max,A=this.spatialReference;h=[];var B,E;for(t=0;t<g;t++){var G=c[t];var I=B=G[0]&&G[0][0];var L=E=G[0]&&G[0][1];var K=G.length;for(C=0;C<K;C++){var ba=G[C];var T=ba[0];ba=ba[1];u=l(u,T);x=l(x,ba);k=v(k,T);w=v(w,ba);I=l(I,T);L=l(L,ba);B=v(B,T);E=v(E,ba)}h.push(new f({xmin:I,ymin:L,xmax:B,ymax:E,spatialReference:A?A.toJson():null}))}c={xmin:u,ymin:x,xmax:k,
ymax:w,spatialReference:A?A.toJson():null};h=1<h.length?h:null;this.setCacheValue("_extent",c);this.setCacheValue("_partwise",h);c=new f(c);c._partwise=h;return c}},toJson:function(){var c={paths:y.clone3DArray(this.paths)},h=this.spatialReference;h&&(c.spatialReference=h.toJson());return c}});e.prototype=F.prototype;b.prototype=new e;Object.defineProperty(b.prototype,"paths",{get:function(){this._unquantizeFn&&(this._pathsVal=this._unquantizeFn({paths:y.clone3DArray(this._pathsVal)}).paths,this._unquantizeFn=
null);return this._pathsVal},set:function(c){this._pathsVal=c}});b.prototype.setupLazyUnquantization=function(c,h){this._unquantizeFn=c;this._pathsVal=h.paths};F.simpleConstructor=e;F.accessorConstructor=b;F.defaultProps=D;a.setObject("geometry.Polyline",F,z);z.geometry.defaultPolyline=D;return F})},"esri/libs/luxon/luxon":function(){define(["exports"],function(F){function m(ha,ua){for(var Q=0;Q<ua.length;Q++){var la=ua[Q];la.enumerable=la.enumerable||!1;la.configurable=!0;"value"in la&&(la.writable=
!0);Object.defineProperty(ha,la.key,la)}}function a(ha,ua,Q){ua&&m(ha.prototype,ua);Q&&m(ha,Q);return ha}function D(){D=Object.assign||function(ha){for(var ua=1;ua<arguments.length;ua++){var Q=arguments[ua],la;for(la in Q)Object.prototype.hasOwnProperty.call(Q,la)&&(ha[la]=Q[la])}return ha};return D.apply(this,arguments)}function z(ha,ua){ha.prototype=Object.create(ua.prototype);ha.prototype.constructor=ha;r(ha,ua)}function y(ha){y=Object.setPrototypeOf?Object.getPrototypeOf:function(ua){return ua.__proto__||
Object.getPrototypeOf(ua)};return y(ha)}function r(ha,ua){r=Object.setPrototypeOf||function(Q,la){Q.__proto__=la;return Q};return r(ha,ua)}function q(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ha){return!1}}function n(ha,ua,Q){n=q()?Reflect.construct:function(la,wa,Fa){var Qa=[null];Qa.push.apply(Qa,wa);la=new (Function.bind.apply(la,
Qa));Fa&&r(la,Fa.prototype);return la};return n.apply(null,arguments)}function f(ha){var ua="function"===typeof Map?new Map:void 0;f=function(Q){function la(){return n(Q,arguments,y(this).constructor)}if(null===Q||-1===Function.toString.call(Q).indexOf("[native code]"))return Q;if("function"!==typeof Q)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof ua){if(ua.has(Q))return ua.get(Q);ua.set(Q,la)}la.prototype=Object.create(Q.prototype,{constructor:{value:la,
enumerable:!1,writable:!0,configurable:!0}});return r(la,Q)};return f(ha)}function d(ha,ua){if(ha){if("string"===typeof ha)return e(ha,ua);var Q=Object.prototype.toString.call(ha).slice(8,-1);"Object"===Q&&ha.constructor&&(Q=ha.constructor.name);if("Map"===Q||"Set"===Q)return Array.from(ha);if("Arguments"===Q||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Q))return e(ha,ua)}}function e(ha,ua){if(null==ua||ua>ha.length)ua=ha.length;for(var Q=0,la=Array(ua);Q<ua;Q++)la[Q]=ha[Q];return la}function b(ha,
ua){var Q="undefined"!==typeof Symbol&&ha[Symbol.iterator]||ha["@@iterator"];if(Q)return(Q=Q.call(ha)).next.bind(Q);if(Array.isArray(ha)||(Q=d(ha))||ua&&ha&&"number"===typeof ha.length){Q&&(ha=Q);var la=0;return function(){return la>=ha.length?{done:!0}:{done:!1,value:ha[la++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function c(ha){return"undefined"===typeof ha}function h(ha){return"number"===
typeof ha}function g(ha){return"number"===typeof ha&&0===ha%1}function k(){try{return"undefined"!==typeof Intl&&!!Intl.RelativeTimeFormat}catch(ha){return!1}}function w(ha,ua,Q){if(0!==ha.length)return ha.reduce(function(la,wa){var Fa=[ua(wa),wa];return la?Q(la[0],Fa[0])===la[0]?la:Fa:Fa},null)[1]}function t(ha,ua){return ua.reduce(function(Q,la){Q[la]=ha[la];return Q},{})}function C(ha,ua){return Object.prototype.hasOwnProperty.call(ha,ua)}function u(ha,ua,Q){return g(ha)&&ha>=ua&&ha<=Q}function x(ha,
ua){void 0===ua&&(ua=2);var Q=0>ha?"-":"",la=Q?-1*ha:ha;la=la.toString().length<ua?("0".repeat(ua)+la).slice(-ua):la.toString();return""+Q+la}function l(ha){if(!c(ha)&&null!==ha&&""!==ha)return parseInt(ha,10)}function v(ha){if(!c(ha)&&null!==ha&&""!==ha)return ha=1E3*parseFloat("0."+ha),Math.floor(ha)}function A(ha,ua,Q){void 0===Q&&(Q=!1);ua=Math.pow(10,ua);return(Q?Math.trunc:Math.round)(ha*ua)/ua}function B(ha){return 0===ha%4&&(0!==ha%100||0===ha%400)}function E(ha,ua){var Q=ua-1;Q=Q-12*Math.floor(Q/
12)+1;return 2===Q?B(ha+(ua-Q)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][Q-1]}function G(ha){var ua=Date.UTC(ha.year,ha.month-1,ha.day,ha.hour,ha.minute,ha.second,ha.millisecond);100>ha.year&&0<=ha.year&&(ua=new Date(ua),ua.setUTCFullYear(ua.getUTCFullYear()-1900));return+ua}function I(ha){var ua=ha-1;ua=(ua+Math.floor(ua/4)-Math.floor(ua/100)+Math.floor(ua/400))%7;return 4===(ha+Math.floor(ha/4)-Math.floor(ha/100)+Math.floor(ha/400))%7||3===ua?53:52}function L(ha){return 99<ha?ha:60<ha?1900+
ha:2E3+ha}function K(ha,ua,Q,la){void 0===la&&(la=null);ha=new Date(ha);var wa={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};la&&(wa.timeZone=la);ua=D({timeZoneName:ua},wa);return(Q=(new Intl.DateTimeFormat(Q,ua)).formatToParts(ha).find(function(Fa){return"timezonename"===Fa.type.toLowerCase()}))?Q.value:null}function ba(ha,ua){var Q=parseInt(ha,10);Number.isNaN(Q)&&(Q=0);var la=parseInt(ua,10)||0;la=0>Q||Object.is(Q,-0)?-la:la;return 60*Q+la}function T(ha){var ua=
Number(ha);if("boolean"===typeof ha||""===ha||Number.isNaN(ua))throw new Lb("Invalid unit value "+ha);return ua}function P(ha,ua){var Q={},la;for(la in ha)if(C(ha,la)){var wa=ha[la];void 0!==wa&&null!==wa&&(Q[ua(la)]=T(wa))}return Q}function J(ha,ua){var Q=Math.trunc(Math.abs(ha/60)),la=Math.trunc(Math.abs(ha%60)),wa=0<=ha?"+":"-";switch(ua){case "short":return""+wa+x(Q,2)+":"+x(la,2);case "narrow":return""+wa+Q+(0<la?":"+la:"");case "techie":return""+wa+x(Q,2)+x(la,2);default:throw new RangeError("Value format "+
ua+" is out of range for property format");}}function N(ha){return t(ha,["hour","minute","second","millisecond"])}function Z(ha){switch(ha){case "narrow":return[].concat(gc);case "short":return[].concat(Vb);case "long":return[].concat(dc);case "numeric":return"1 2 3 4 5 6 7 8 9 10 11 12".split(" ");case "2-digit":return"01 02 03 04 05 06 07 08 09 10 11 12".split(" ");default:return null}}function Y(ha){switch(ha){case "narrow":return[].concat(Xc);case "short":return[].concat(Fc);case "long":return[].concat(Gc);
case "numeric":return"1234567".split("");default:return null}}function qa(ha){switch(ha){case "narrow":return[].concat(Yc);case "short":return[].concat(Zc);case "long":return[].concat($c);default:return null}}function V(ha,ua,Q,la){void 0===Q&&(Q="always");void 0===la&&(la=!1);var wa={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},Fa=-1===["hours","minutes",
"seconds"].indexOf(ha);if("auto"===Q&&Fa)switch(Q="days"===ha,ua){case 1:return Q?"tomorrow":"next "+wa[ha][0];case -1:return Q?"yesterday":"last "+wa[ha][0];case 0:return Q?"today":"this "+wa[ha][0]}Q=Object.is(ua,-0)||0>ua;ua=Math.abs(ua);Fa=1===ua;var Qa=wa[ha];ha=la?Fa?Qa[1]:Qa[2]||Qa[1]:Fa?wa[ha][0]:ha;return Q?ua+" "+ha+" ago":"in "+ua+" "+ha}function na(ha,ua){for(var Q="",la=b(ha),wa;!(wa=la()).done;)wa=wa.value,Q=wa.literal?Q+wa.val:Q+ua(wa.val);return Q}function ya(ha,ua){var Q;if(c(ha)||
null===ha)return ua;if(ha instanceof ec)return ha;if("string"===typeof ha){var la=ha.toLowerCase();return"local"===la||"system"===la?ua:"utc"===la||"gmt"===la?Pb.utcInstance:null!=(Q=Wb.parseGMTOffset(ha))?Pb.instance(Q):Wb.isValidSpecifier(la)?Wb.create(ha):Pb.parseSpecifier(la)||new sc(ha)}return h(ha)?Pb.instance(ha):"object"===typeof ha&&ha.offset&&"number"===typeof ha.offset?ha:new sc(ha)}function S(ha,ua){void 0===ua&&(ua={});var Q=JSON.stringify([ha,ua]),la=tc[Q];la||(la=new Intl.DateTimeFormat(ha,
ua),tc[Q]=la);return la}function ma(ha){for(var ua=[],Q=1;12>=Q;Q++){var la=Fb.utc(2016,Q,1);ua.push(ha(la))}return ua}function ja(ha){for(var ua=[],Q=1;7>=Q;Q++){var la=Fb.utc(2016,11,13+Q);ua.push(ha(la))}return ua}function X(ha,ua,Q,la,wa){ha=ha.listingMode(Q);return"error"===ha?null:"en"===ha?la(ua):wa(ua)}function oa(){for(var ha=arguments.length,ua=Array(ha),Q=0;Q<ha;Q++)ua[Q]=arguments[Q];ha=ua.reduce(function(la,wa){return la+wa.source},"");return RegExp("^"+ha+"$")}function xa(){for(var ha=
arguments.length,ua=Array(ha),Q=0;Q<ha;Q++)ua[Q]=arguments[Q];return function(la){return ua.reduce(function(wa,Fa){var Qa=wa[0],Xa=wa[1],eb=Fa(la,wa[2]),lb=eb[1],sb=eb[2];return[D({},Qa,eb[0]),Xa||lb,sb]},[{},null,1]).slice(0,2)}}function Ha(ha){if(null==ha)return[null,null];for(var ua=arguments.length,Q=Array(1<ua?ua-1:0),la=1;la<ua;la++)Q[la-1]=arguments[la];for(ua=0;ua<Q.length;ua++){var wa=Q[ua];la=wa[1];if(wa=wa[0].exec(ha))return la(wa)}return[null,null]}function Ia(){for(var ha=arguments.length,
ua=Array(ha),Q=0;Q<ha;Q++)ua[Q]=arguments[Q];return function(la,wa){var Fa={},Qa;for(Qa=0;Qa<ua.length;Qa++)Fa[ua[Qa]]=l(la[wa+Qa]);return[Fa,null,wa+Qa]}}function ia(ha,ua,Q){ha=ha[ua];return c(ha)?Q:l(ha)}function ea(ha,ua){return[{year:ia(ha,ua),month:ia(ha,ua+1,1),day:ia(ha,ua+2,1)},null,ua+3]}function za(ha,ua){return[{hours:ia(ha,ua,0),minutes:ia(ha,ua+1,0),seconds:ia(ha,ua+2,0),milliseconds:v(ha[ua+3])},null,ua+4]}function Ca(ha,ua){var Q=!ha[ua]&&!ha[ua+1],la=ba(ha[ua+1],ha[ua+2]);return[{},
Q?null:Pb.instance(la),ua+3]}function Da(ha,ua){return[{},ha[ua]?Wb.create(ha[ua]):null,ua+1]}function ka(ha){var ua=ha[2],Q=ha[3],la=ha[4],wa=ha[5],Fa=ha[6],Qa=ha[7],Xa=ha[8],eb="-"===ha[0][0],lb=Qa&&"-"===Qa[0],sb=function(Cb,vb){void 0===vb&&(vb=!1);return void 0!==Cb&&(vb||Cb&&eb)?-Cb:Cb};return[{years:sb(l(ha[1])),months:sb(l(ua)),weeks:sb(l(Q)),days:sb(l(la)),hours:sb(l(wa)),minutes:sb(l(Fa)),seconds:sb(l(Qa),"-0"===Qa),milliseconds:sb(v(Xa),lb)}]}function ta(ha,ua,Q,la,wa,Fa,Qa){ua={year:2===
ua.length?L(l(ua)):l(ua),month:Vb.indexOf(Q)+1,day:l(la),hour:l(wa),minute:l(Fa)};Qa&&(ua.second=l(Qa));ha&&(ua.weekday=3<ha.length?Gc.indexOf(ha)+1:Fc.indexOf(ha)+1);return ua}function M(ha){var ua=ha[8],Q=ha[9],la=ha[10],wa=ha[11];ha=ta(ha[1],ha[4],ha[3],ha[2],ha[5],ha[6],ha[7]);ua=ua?ad[ua]:Q?0:ba(la,wa);return[ha,new Pb(ua)]}function Ga(ha){return[ta(ha[1],ha[4],ha[3],ha[2],ha[5],ha[6],ha[7]),Pb.utcInstance]}function La(ha){return[ta(ha[1],ha[7],ha[2],ha[3],ha[4],ha[5],ha[6]),Pb.utcInstance]}
function aa(ha,ua,Q){void 0===Q&&(Q=!1);ha={values:Q?ua.values:D({},ha.values,ua.values||{}),loc:ha.loc.clone(ua.loc),conversionAccuracy:ua.conversionAccuracy||ha.conversionAccuracy};return new Mb(ha)}function Ya(ha,ua,Q,la,wa){ha=ha[wa][Q];var Fa=ua[Q]/ha;Fa=Math.sign(Fa)!==Math.sign(la[wa])&&0!==la[wa]&&1>=Math.abs(Fa)?0>Fa?Math.floor(Fa):Math.ceil(Fa):Math.trunc(Fa);la[wa]+=Fa;ua[Q]-=Fa*ha}function Wa(ha,ua){bd.reduce(function(Q,la){if(c(ua[la]))return Q;Q&&Ya(ha,ua,Q,ua,la);return la},null)}function Ea(ha){if(h(ha))return Mb.fromMillis(ha);
if(Mb.isDuration(ha))return ha;if("object"===typeof ha)return Mb.fromObject(ha);throw new Lb("Unknown duration argument "+ha+" of type "+typeof ha);}function U(ha,ua){var Q=function(la){return la.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()};Q=Q(ua)-Q(ha);return Math.floor(Mb.fromMillis(Q).as("days"))}function fa(ha,ua,Q){for(var la={},wa,Fa,Qa=0,Xa=[["years",function(vb,Bb){return Bb.year-vb.year}],["quarters",function(vb,Bb){return Bb.quarter-vb.quarter}],["months",function(vb,Bb){return Bb.month-
vb.month+12*(Bb.year-vb.year)}],["weeks",function(vb,Bb){var Qb=U(vb,Bb);return(Qb-Qb%7)/7}],["days",U]];Qa<Xa.length;Qa++){var eb=Xa[Qa],lb=eb[0];eb=eb[1];if(0<=Q.indexOf(lb)){var sb;wa=lb;eb=eb(ha,ua);Fa=ha.plus((sb={},sb[lb]=eb,sb));if(Fa>ua){var Cb;ha=ha.plus((Cb={},Cb[lb]=eb-1,Cb));--eb}else ha=Fa;la[lb]=eb}}return[ha,la,Fa,wa]}function sa(ha,ua,Q,la){var wa=fa(ha,ua,Q);ha=wa[0];var Fa=wa[1],Qa=wa[2],Xa=wa[3];wa=ua-ha;Q=Q.filter(function(sb){return 0<=["hours","minutes","seconds","milliseconds"].indexOf(sb)});
if(0===Q.length){if(Qa<ua){var eb;Qa=ha.plus((eb={},eb[Xa]=1,eb))}Qa!==ha&&(Fa[Xa]=(Fa[Xa]||0)+wa/(Qa-ha))}ua=Mb.fromObject(Fa,la);if(0<Q.length){var lb;return(lb=Mb.fromMillis(wa,la)).shiftTo.apply(lb,Q).plus(ua)}return ua}function O(ha,ua){var Q=ha.numberingSystem;void 0===ua&&(ua="");return new RegExp(""+uc[Q||"latn"]+ua)}function ca(ha,ua){void 0===ua&&(ua=function(Q){return Q});return{regex:ha,deser:function(Q){var la=ua;Q=Q[0];var wa=parseInt(Q,10);if(isNaN(wa)){wa="";for(var Fa=0;Fa<Q.length;Fa++){var Qa=
Q.charCodeAt(Fa);if(-1!==Q[Fa].search(uc.hanidec))wa+=cd.indexOf(Q[Fa]);else for(lb in Hc){var Xa=Hc[lb],eb=Xa[0];Xa=Xa[1];Qa>=eb&&Qa<=Xa&&(wa+=Qa-eb)}}var lb=parseInt(wa,10)}else lb=wa;return la(lb)}}}function va(ha){return ha.replace(/\./g,"\\.?").replace(vc,Ic)}function H(ha,ua){return null===ha?null:{regex:RegExp(ha.map(va).join("|")),deser:function(Q){var la=Q[0];return ha.findIndex(function(wa){return la.replace(/\./g,"").replace(vc," ").toLowerCase()===wa.replace(/\./g,"").replace(vc," ").toLowerCase()})+
ua}}}function R(ha,ua){return{regex:ha,deser:function(Q){return ba(Q[1],Q[2])},groups:ua}}function W(ha){return{regex:ha,deser:function(ua){return ua[0]}}}function pa(ha,ua){var Q=O(ua),la=O(ua,"{2}"),wa=O(ua,"{3}"),Fa=O(ua,"{4}"),Qa=O(ua,"{6}"),Xa=O(ua,"{1,2}"),eb=O(ua,"{1,3}"),lb=O(ua,"{1,6}"),sb=O(ua,"{1,9}"),Cb=O(ua,"{2,4}"),vb=O(ua,"{4,6}"),Bb=function(Ob){return{regex:RegExp(Ob.val.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$\x26")),deser:function(dd){return dd[0]},literal:!0}},Qb=function(Ob){if(ha.literal)return Bb(Ob);
switch(Ob.val){case "G":return H(ua.eras("short",!1),0);case "GG":return H(ua.eras("long",!1),0);case "y":return ca(lb);case "yy":return ca(Cb,L);case "yyyy":return ca(Fa);case "yyyyy":return ca(vb);case "yyyyyy":return ca(Qa);case "M":return ca(Xa);case "MM":return ca(la);case "MMM":return H(ua.months("short",!0,!1),1);case "MMMM":return H(ua.months("long",!0,!1),1);case "L":return ca(Xa);case "LL":return ca(la);case "LLL":return H(ua.months("short",!1,!1),1);case "LLLL":return H(ua.months("long",
!1,!1),1);case "d":return ca(Xa);case "dd":return ca(la);case "o":return ca(eb);case "ooo":return ca(wa);case "HH":return ca(la);case "H":return ca(Xa);case "hh":return ca(la);case "h":return ca(Xa);case "mm":return ca(la);case "m":return ca(Xa);case "q":return ca(Xa);case "qq":return ca(la);case "s":return ca(Xa);case "ss":return ca(la);case "S":return ca(eb);case "SSS":return ca(wa);case "u":return W(sb);case "a":return H(ua.meridiems(),0);case "kkkk":return ca(Fa);case "kk":return ca(Cb,L);case "W":return ca(Xa);
case "WW":return ca(la);case "E":case "c":return ca(Q);case "EEE":return H(ua.weekdays("short",!1,!1),1);case "EEEE":return H(ua.weekdays("long",!1,!1),1);case "ccc":return H(ua.weekdays("short",!0,!1),1);case "cccc":return H(ua.weekdays("long",!0,!1),1);case "Z":case "ZZ":return R(new RegExp("([+-]"+Xa.source+")(?::("+la.source+"))?"),2);case "ZZZ":return R(new RegExp("([+-]"+Xa.source+")("+la.source+")?"),2);case "z":return W(/[a-z_+-/]{1,256}?/i);default:return Bb(Ob)}}(ha)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};
Qb.token=ha;return Qb}function ra(ha){return["^"+ha.map(function(ua){return ua.regex}).reduce(function(ua,Q){return ua+"("+Q.source+")"},"")+"$",ha]}function Aa(ha,ua,Q){if(ha=ha.match(ua)){ua={};var la=1,wa;for(wa in Q)if(C(Q,wa)){var Fa=Q[wa],Qa=Fa.groups?Fa.groups+1:1;!Fa.literal&&Fa.token&&(ua[Fa.token.val[0]]=Fa.deser(ha.slice(la,la+Qa)));la+=Qa}return[ha,ua]}return[ha,{}]}function Ba(ha){var ua=function(la){switch(la){case "S":return"millisecond";case "s":return"second";case "m":return"minute";
case "h":case "H":return"hour";case "d":return"day";case "o":return"ordinal";case "L":case "M":return"month";case "y":return"year";case "E":case "c":return"weekday";case "W":return"weekNumber";case "k":return"weekYear";case "q":return"quarter";default:return null}};var Q=c(ha.Z)?c(ha.z)?null:Wb.create(ha.z):new Pb(ha.Z);c(ha.q)||(ha.M=3*(ha.q-1)+1);c(ha.h)||(12>ha.h&&1===ha.a?ha.h+=12:12===ha.h&&0===ha.a&&(ha.h=0));0===ha.G&&ha.y&&(ha.y=-ha.y);c(ha.u)||(ha.S=v(ha.u));return[Object.keys(ha).reduce(function(la,
wa){var Fa=ua(wa);Fa&&(la[Fa]=ha[wa]);return la},{}),Q]}function Ja(){wc||(wc=Fb.fromMillis(1555555555555));return wc}function Ka(ha,ua){if(ha.literal)return ha;var Q=Yb.macroTokenToFormatOpts(ha.val);if(!Q)return ha;var la=Yb.create(ua,Q).formatDateTimeParts(Ja()).map(function(wa){var Fa=wa.type;wa=wa.value;"literal"===Fa?Fa={literal:!0,val:wa}:(wa=Q[Fa],Fa=ed[Fa],"object"===typeof Fa&&(Fa=Fa[wa]),Fa=Fa?{literal:!1,val:Fa}:void 0);return Fa});return la.includes(void 0)?ha:la}function Ra(ha,ua){var Q;
return(Q=Array.prototype).concat.apply(Q,ha.map(function(la){return Ka(la,ua)}))}function Va(ha,ua,Q){Q=Ra(Yb.parseFormat(Q),ha);var la=Q.map(function(eb){return pa(eb,ha)}),wa=la.find(function(eb){return eb.invalidReason});if(wa)return{input:ua,tokens:Q,invalidReason:wa.invalidReason};wa=ra(la);la=RegExp(wa[0],"i");var Fa=Aa(ua,la,wa[1]);wa=Fa[0];var Qa=(Fa=Fa[1])?Ba(Fa):[null,null],Xa=Qa[0];Qa=Qa[1];if(C(Fa,"a")&&C(Fa,"H"))throw new Zb("Can't include meridiem when specifying 24-hour format");return{input:ua,
tokens:Q,regex:la,rawMatches:wa,matches:Fa,result:Xa,zone:Qa}}function ab(ha,ua){return new Sb("unit out of range","you specified "+ua+" (of type "+typeof ua+") as a "+ha+", which is invalid")}function db(ha,ua,Q){ha=(new Date(Date.UTC(ha,ua-1,Q))).getUTCDay();return 0===ha?7:ha}function jb(ha,ua){var Q=B(ha)?xc:yc,la=Q.findIndex(function(wa){return wa<ua});return{month:la+1,day:ua-Q[la]}}function hb(ha){var ua=ha.year,Q=ha.month,la=ha.day;var wa=la+(B(ua)?xc:yc)[Q-1];Q=db(ua,Q,la);wa=Math.floor((wa-
Q+10)/7);1>wa?(--ua,wa=I(ua)):wa>I(ua)&&(ua+=1,wa=1);return D({weekYear:ua,weekNumber:wa,weekday:Q},N(ha))}function fb(ha){var ua=ha.weekYear,Q=ha.weekNumber,la=ha.weekday,wa=db(ua,1,4),Fa=B(ua)?366:365;Q=7*Q+la-wa-3;1>Q?(Fa=ua-1,Q+=B(Fa)?366:365):Q>Fa?(Fa=ua+1,Q-=B(ua)?366:365):Fa=ua;ua=jb(Fa,Q);return D({year:Fa,month:ua.month,day:ua.day},N(ha))}function nb(ha){var ua=ha.year;var Q=ha.month;Q=ha.day+(B(ua)?xc:yc)[Q-1];return D({year:ua,ordinal:Q},N(ha))}function qb(ha){var ua=ha.year,Q=jb(ua,ha.ordinal);
return D({year:ua,month:Q.month,day:Q.day},N(ha))}function xb(ha){var ua=g(ha.year),Q=u(ha.month,1,12),la=u(ha.day,1,E(ha.year,ha.month));return ua?Q?la?!1:ab("day",ha.day):ab("month",ha.month):ab("year",ha.year)}function ub(ha){var ua=ha.hour,Q=ha.minute,la=ha.second;ha=ha.millisecond;var wa=u(ua,0,23)||24===ua&&0===Q&&0===la&&0===ha,Fa=u(Q,0,59),Qa=u(la,0,59),Xa=u(ha,0,999);return wa?Fa?Qa?Xa?!1:ab("millisecond",ha):ab("second",la):ab("minute",Q):ab("hour",ua)}function pb(ha){return new Sb("unsupported zone",
'the zone "'+ha.name+'" is not supported')}function ob(ha){null===ha.weekData&&(ha.weekData=hb(ha.c));return ha.weekData}function mb(ha,ua){var Q={ts:ha.ts,zone:ha.zone,c:ha.c,o:ha.o,loc:ha.loc,invalid:ha.invalid};return new Fb(D({},Q,ua,{old:Q}))}function Ab(ha,ua,Q){var la=ha-6E4*ua,wa=Q.offset(la);if(ua===wa)return[la,ua];la-=6E4*(wa-ua);ua=Q.offset(la);return wa===ua?[la,wa]:[ha-6E4*Math.min(wa,ua),Math.max(wa,ua)]}function Db(ha,ua){var Q=new Date(ha+6E4*ua);return{year:Q.getUTCFullYear(),month:Q.getUTCMonth()+
1,day:Q.getUTCDate(),hour:Q.getUTCHours(),minute:Q.getUTCMinutes(),second:Q.getUTCSeconds(),millisecond:Q.getUTCMilliseconds()}}function Jb(ha,ua,Q){return Ab(G(ha),ua,Q)}function Ub(ha,ua){var Q=ha.o,la=ha.c.year+Math.trunc(ua.years),wa=ha.c.month+Math.trunc(ua.months)+3*Math.trunc(ua.quarters);wa=D({},ha.c,{year:la,month:wa,day:Math.min(ha.c.day,E(la,wa))+Math.trunc(ua.days)+7*Math.trunc(ua.weeks)});la=Mb.fromObject({years:ua.years-Math.trunc(ua.years),quarters:ua.quarters-Math.trunc(ua.quarters),
months:ua.months-Math.trunc(ua.months),weeks:ua.weeks-Math.trunc(ua.weeks),days:ua.days-Math.trunc(ua.days),hours:ua.hours,minutes:ua.minutes,seconds:ua.seconds,milliseconds:ua.milliseconds}).as("milliseconds");wa=G(wa);wa=Ab(wa,Q,ha.zone);Q=wa[0];wa=wa[1];0!==la&&(Q+=la,wa=ha.zone.offset(Q));return{ts:Q,o:wa}}function Nb(ha,ua,Q,la,wa){var Fa=Q.setZone,Qa=Q.zone;return ha&&0!==Object.keys(ha).length?(ha=Fb.fromObject(ha,D({},Q,{zone:ua||Qa})),Fa?ha:ha.setZone(Qa)):Fb.invalid(new Sb("unparsable",
'the input "'+wa+"\" can't be parsed as "+la))}function Rb(ha,ua,Q){void 0===Q&&(Q=!0);return ha.isValid?Yb.create(Ib.create("en-US"),{allowZ:Q,forceSimple:!0}).formatDateTimeFromString(ha,ua):null}function $b(ha,ua){var Q=ua.suppressSeconds,la=ua.suppressMilliseconds;la=void 0===la?!1:la;var wa=ua.includeOffset,Fa=ua.includePrefix;Fa=void 0===Fa?!1:Fa;var Qa=ua.includeZone;Qa=void 0===Qa?!1:Qa;var Xa=ua.spaceZone,eb=ua.format;eb=void 0===eb?"extended":eb;var lb="basic"===eb?"HHmm":"HH:mm";void 0!==
Q&&Q&&0===ha.second&&0===ha.millisecond||(lb+="basic"===eb?"ss":":ss",la&&0===ha.millisecond||(lb+=".SSS"));(Qa||wa)&&(void 0===Xa?0:Xa)&&(lb+=" ");Qa?lb+="z":wa&&(lb+="basic"===eb?"ZZZ":"ZZ");Q=Rb(ha,lb);Fa&&(Q="T"+Q);return Q}function ac(ha){var ua={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",
weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[ha.toLowerCase()];if(!ua)throw new hc(ha);return ua}function cc(ha,ua){var Q=ya(ua.zone,Gb.defaultZone),la=Ib.fromObject(ua),wa=Gb.now();if(!c(ha.year)){var Fa=b(Jc);for(var Qa;!(Qa=Fa()).done;)Qa=Qa.value,c(ha[Qa])&&(ha[Qa]=Kc[Qa]);if(Fa=xb(ha)||ub(ha))return Fb.invalid(Fa);wa=Q.offset(wa);Fa=Jb(ha,wa,Q);wa=Fa[0];Fa=Fa[1]}return new Fb({ts:wa,
zone:Q,loc:la,o:Fa})}function rb(ha,ua,Q){var la=c(Q.round)?!0:Q.round,wa=function(lb,sb){lb=A(lb,la||Q.calendary?0:2,!0);return ua.loc.clone(Q).relFormatter(Q).format(lb,sb)},Fa=function(lb){return Q.calendary?ua.hasSame(ha,lb)?0:ua.startOf(lb).diff(ha.startOf(lb),lb).get(lb):ua.diff(ha,lb).get(lb)};if(Q.unit)return wa(Fa(Q.unit),Q.unit);for(var Qa=b(Q.units),Xa;!(Xa=Qa()).done;){Xa=Xa.value;var eb=Fa(Xa);if(1<=Math.abs(eb))return wa(eb,Xa)}return wa(ha>ua?-0:0,Q.units[Q.units.length-1])}function wb(ha){var ua=
{};0<ha.length&&"object"===typeof ha[ha.length-1]?(ua=ha[ha.length-1],ha=Array.from(ha).slice(0,ha.length-1)):ha=Array.from(ha);return[ua,ha]}function yb(ha){if(Fb.isDateTime(ha))return ha;if(ha&&ha.valueOf&&h(ha.valueOf()))return Fb.fromJSDate(ha);if(ha&&"object"===typeof ha)return Fb.fromObject(ha);throw new Lb("Unknown datetime argument: "+ha+", of type "+typeof ha);}var zb=function(ha){function ua(){return ha.apply(this,arguments)||this}z(ua,ha);return ua}(f(Error)),bc=function(ha){function ua(Q){return ha.call(this,
"Invalid DateTime: "+Q.toMessage())||this}z(ua,ha);return ua}(zb),Tb=function(ha){function ua(Q){return ha.call(this,"Invalid Interval: "+Q.toMessage())||this}z(ua,ha);return ua}(zb),oc=function(ha){function ua(Q){return ha.call(this,"Invalid Duration: "+Q.toMessage())||this}z(ua,ha);return ua}(zb),Zb=function(ha){function ua(){return ha.apply(this,arguments)||this}z(ua,ha);return ua}(zb),hc=function(ha){function ua(Q){return ha.call(this,"Invalid unit "+Q)||this}z(ua,ha);return ua}(zb),Lb=function(ha){function ua(){return ha.apply(this,
arguments)||this}z(ua,ha);return ua}(zb),Xb=function(ha){function ua(){return ha.call(this,"Zone is an abstract class")||this}z(ua,ha);return ua}(zb),ic={year:"numeric",month:"numeric",day:"numeric"},Hb={year:"numeric",month:"short",day:"numeric"},da={year:"numeric",month:"short",day:"numeric",weekday:"short"},Sa={year:"numeric",month:"long",day:"numeric"},Oa={year:"numeric",month:"long",day:"numeric",weekday:"long"},Ma={hour:"numeric",minute:"numeric"},Na={hour:"numeric",minute:"numeric",second:"numeric"},
Ua={hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},Ta={hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"long"},Pa={hour:"numeric",minute:"numeric",hourCycle:"h23"},$a={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23"},cb={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23",timeZoneName:"short"},bb={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23",timeZoneName:"long"},kb={year:"numeric",month:"numeric",day:"numeric",
hour:"numeric",minute:"numeric"},Za={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},gb={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"},ib={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},tb={year:"numeric",month:"short",day:"numeric",weekday:"short",hour:"numeric",minute:"numeric"},Kb={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"},
jc={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},kc={year:"numeric",month:"long",day:"numeric",weekday:"long",hour:"numeric",minute:"numeric",timeZoneName:"long"},lc={year:"numeric",month:"long",day:"numeric",weekday:"long",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"long"},Eb=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/,dc="January February March April May June July August September October November December".split(" "),
Vb="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),gc="JFMAMJJASOND".split(""),Gc="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),Fc="Mon Tue Wed Thu Fri Sat Sun".split(" "),Xc="MTWTFSS".split(""),Lc=["AM","PM"],$c=["Before Christ","Anno Domini"],Zc=["BC","AD"],Yc=["B","A"],fd={D:ic,DD:Hb,DDD:Sa,DDDD:Oa,t:Ma,tt:Na,ttt:Ua,tttt:Ta,T:Pa,TT:$a,TTT:cb,TTTT:bb,f:kb,ff:gb,fff:Kb,ffff:kc,F:Za,FF:ib,FFF:jc,FFFF:lc},Yb=function(){function ha(Q,la){this.opts=la;this.loc=Q;
this.systemLoc=null}ha.create=function(Q,la){void 0===la&&(la={});return new ha(Q,la)};ha.parseFormat=function(Q){for(var la=null,wa="",Fa=!1,Qa=[],Xa=0;Xa<Q.length;Xa++){var eb=Q.charAt(Xa);"'"===eb?(0<wa.length&&Qa.push({literal:Fa,val:wa}),la=null,wa="",Fa=!Fa):Fa?wa+=eb:eb===la?wa+=eb:(0<wa.length&&Qa.push({literal:!1,val:wa}),la=wa=eb)}0<wa.length&&Qa.push({literal:Fa,val:wa});return Qa};ha.macroTokenToFormatOpts=function(Q){return fd[Q]};var ua=ha.prototype;ua.formatWithSystemDefault=function(Q,
la){null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(Q,D({},this.opts,la)).format()};ua.formatDateTime=function(Q,la){void 0===la&&(la={});return this.loc.dtFormatter(Q,D({},this.opts,la)).format()};ua.formatDateTimeParts=function(Q,la){void 0===la&&(la={});return this.loc.dtFormatter(Q,D({},this.opts,la)).formatToParts()};ua.resolvedOptions=function(Q,la){void 0===la&&(la={});return this.loc.dtFormatter(Q,D({},this.opts,la)).resolvedOptions()};
ua.num=function(Q,la){void 0===la&&(la=0);if(this.opts.forceSimple)return x(Q,la);var wa=D({},this.opts);0<la&&(wa.padTo=la);return this.loc.numberFormatter(wa).format(Q)};ua.formatDateTimeFromString=function(Q,la){var wa=this,Fa="en"===this.loc.listingMode(),Qa=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,Xa=function(vb,Bb){return wa.loc.extract(Q,vb,Bb)},eb=function(vb){return Q.isOffsetFixed&&0===Q.offset&&vb.allowZ?"Z":Q.isValid?Q.zone.formatOffset(Q.ts,vb.format):""},lb=function(vb,
Bb){return Fa?Z(vb)[Q.month-1]:Xa(Bb?{month:vb}:{month:vb,day:"numeric"},"month")},sb=function(vb,Bb){return Fa?Y(vb)[Q.weekday-1]:Xa(Bb?{weekday:vb}:{weekday:vb,month:"long",day:"numeric"},"weekday")},Cb=function(vb){return Fa?qa(vb)[0>Q.year?0:1]:Xa({era:vb},"era")};return na(ha.parseFormat(la),function(vb){switch(vb){case "S":return wa.num(Q.millisecond);case "u":case "SSS":return wa.num(Q.millisecond,3);case "s":return wa.num(Q.second);case "ss":return wa.num(Q.second,2);case "m":return wa.num(Q.minute);
case "mm":return wa.num(Q.minute,2);case "h":return wa.num(0===Q.hour%12?12:Q.hour%12);case "hh":return wa.num(0===Q.hour%12?12:Q.hour%12,2);case "H":return wa.num(Q.hour);case "HH":return wa.num(Q.hour,2);case "Z":return eb({format:"narrow",allowZ:wa.opts.allowZ});case "ZZ":return eb({format:"short",allowZ:wa.opts.allowZ});case "ZZZ":return eb({format:"techie",allowZ:wa.opts.allowZ});case "ZZZZ":return Q.zone.offsetName(Q.ts,{format:"short",locale:wa.loc.locale});case "ZZZZZ":return Q.zone.offsetName(Q.ts,
{format:"long",locale:wa.loc.locale});case "z":return Q.zoneName;case "a":return Fa?Lc[12>Q.hour?0:1]:Xa({hour:"numeric",hourCycle:"h12"},"dayperiod");case "d":return Qa?Xa({day:"numeric"},"day"):wa.num(Q.day);case "dd":return Qa?Xa({day:"2-digit"},"day"):wa.num(Q.day,2);case "c":return wa.num(Q.weekday);case "ccc":return sb("short",!0);case "cccc":return sb("long",!0);case "ccccc":return sb("narrow",!0);case "E":return wa.num(Q.weekday);case "EEE":return sb("short",!1);case "EEEE":return sb("long",
!1);case "EEEEE":return sb("narrow",!1);case "L":return Qa?Xa({month:"numeric",day:"numeric"},"month"):wa.num(Q.month);case "LL":return Qa?Xa({month:"2-digit",day:"numeric"},"month"):wa.num(Q.month,2);case "LLL":return lb("short",!0);case "LLLL":return lb("long",!0);case "LLLLL":return lb("narrow",!0);case "M":return Qa?Xa({month:"numeric"},"month"):wa.num(Q.month);case "MM":return Qa?Xa({month:"2-digit"},"month"):wa.num(Q.month,2);case "MMM":return lb("short",!1);case "MMMM":return lb("long",!1);
case "MMMMM":return lb("narrow",!1);case "y":return Qa?Xa({year:"numeric"},"year"):wa.num(Q.year);case "yy":return Qa?Xa({year:"2-digit"},"year"):wa.num(Q.year.toString().slice(-2),2);case "yyyy":return Qa?Xa({year:"numeric"},"year"):wa.num(Q.year,4);case "yyyyyy":return Qa?Xa({year:"numeric"},"year"):wa.num(Q.year,6);case "G":return Cb("short");case "GG":return Cb("long");case "GGGGG":return Cb("narrow");case "kk":return wa.num(Q.weekYear.toString().slice(-2),2);case "kkkk":return wa.num(Q.weekYear,
4);case "W":return wa.num(Q.weekNumber);case "WW":return wa.num(Q.weekNumber,2);case "o":return wa.num(Q.ordinal);case "ooo":return wa.num(Q.ordinal,3);case "q":return wa.num(Q.quarter);case "qq":return wa.num(Q.quarter,2);case "X":return wa.num(Math.floor(Q.ts/1E3));case "x":return wa.num(Q.ts);default:var Bb=ha.macroTokenToFormatOpts(vb);vb=Bb?wa.formatWithSystemDefault(Q,Bb):vb;return vb}})};ua.formatDurationFromString=function(Q,la){var wa=this,Fa=function(eb){switch(eb[0]){case "S":return"millisecond";
case "s":return"second";case "m":return"minute";case "h":return"hour";case "d":return"day";case "M":return"month";case "y":return"year";default:return null}},Qa=ha.parseFormat(la),Xa=Qa.reduce(function(eb,lb){var sb=lb.val;return lb.literal?eb:eb.concat(sb)},[]);Xa=Q.shiftTo.apply(Q,Xa.map(Fa).filter(function(eb){return eb}));return na(Qa,function(eb){return function(lb){var sb=Fa(lb);return sb?wa.num(eb.get(sb),lb.length):lb}}(Xa))};return ha}(),Sb=function(){function ha(ua,Q){this.reason=ua;this.explanation=
Q}ha.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason};return ha}(),ec=function(){function ha(){}var ua=ha.prototype;ua.offsetName=function(Q,la){throw new Xb;};ua.formatOffset=function(Q,la){throw new Xb;};ua.offset=function(Q){throw new Xb;};ua.equals=function(Q){throw new Xb;};a(ha,[{key:"type",get:function(){throw new Xb;}},{key:"name",get:function(){throw new Xb;}},{key:"isUniversal",get:function(){throw new Xb;}},{key:"isValid",get:function(){throw new Xb;
}}]);return ha}(),zc=null,Mc=function(ha){function ua(){return ha.apply(this,arguments)||this}z(ua,ha);var Q=ua.prototype;Q.offsetName=function(la,wa){return K(la,wa.format,wa.locale)};Q.formatOffset=function(la,wa){return J(this.offset(la),wa)};Q.offset=function(la){return-(new Date(la)).getTimezoneOffset()};Q.equals=function(la){return"system"===la.type};a(ua,[{key:"type",get:function(){return"system"}},{key:"name",get:function(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}},{key:"isUniversal",
get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){null===zc&&(zc=new ua);return zc}}]);return ua}(ec),gd=RegExp("^"+Eb.source+"$"),pc={},hd={year:0,month:1,day:2,hour:3,minute:4,second:5},qc={},Wb=function(ha){function ua(la){var wa=ha.call(this)||this;wa.zoneName=la;wa.valid=ua.isValidZone(la);return wa}z(ua,ha);ua.create=function(la){qc[la]||(qc[la]=new ua(la));return qc[la]};ua.resetCache=function(){qc={};pc={}};ua.isValidSpecifier=function(la){return!(!la||
!la.match(gd))};ua.isValidZone=function(la){try{return(new Intl.DateTimeFormat("en-US",{timeZone:la})).format(),!0}catch(wa){return!1}};ua.parseGMTOffset=function(la){return la&&(la=la.match(/^Etc\/GMT(0|[+-]\d{1,2})$/i))?-60*parseInt(la[1]):null};var Q=ua.prototype;Q.offsetName=function(la,wa){return K(la,wa.format,wa.locale,this.name)};Q.formatOffset=function(la,wa){return J(this.offset(la),wa)};Q.offset=function(la){la=new Date(la);if(isNaN(la))return NaN;var wa=this.name;pc[wa]||(pc[wa]=new Intl.DateTimeFormat("en-US",
{hourCycle:"h23",timeZone:wa,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}));wa=pc[wa];if(wa.formatToParts){wa=wa.formatToParts(la);for(var Fa=[],Qa=0;Qa<wa.length;Qa++){var Xa=wa[Qa],eb=Xa.value;Xa=hd[Xa.type];c(Xa)||(Fa[Xa]=parseInt(eb,10))}wa=Fa}else wa=wa.format(la).replace(/\u200E/g,""),wa=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(wa),wa=[wa[3],wa[1],wa[2],wa[4],wa[5],wa[6]];wa=G({year:wa[0],month:wa[1],day:wa[2],hour:wa[3],minute:wa[4],second:wa[5],
millisecond:0});la=+la;Fa=la%1E3;return(wa-(la-(0<=Fa?Fa:1E3+Fa)))/6E4};Q.equals=function(la){return"iana"===la.type&&la.name===this.name};a(ua,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]);return ua}(ec),Ac=null,Pb=function(ha){function ua(la){var wa=ha.call(this)||this;wa.fixed=la;return wa}z(ua,ha);ua.instance=function(la){return 0===la?ua.utcInstance:
new ua(la)};ua.parseSpecifier=function(la){return la&&(la=la.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i))?new ua(ba(la[1],la[2])):null};var Q=ua.prototype;Q.offsetName=function(){return this.name};Q.formatOffset=function(la,wa){return J(this.fixed,wa)};Q.offset=function(){return this.fixed};Q.equals=function(la){return"fixed"===la.type&&la.fixed===this.fixed};a(ua,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+J(this.fixed,"narrow")}},{key:"isUniversal",
get:function(){return!0}},{key:"isValid",get:function(){return!0}}],[{key:"utcInstance",get:function(){null===Ac&&(Ac=new ua(0));return Ac}}]);return ua}(ec),sc=function(ha){function ua(la){var wa=ha.call(this)||this;wa.zoneName=la;return wa}z(ua,ha);var Q=ua.prototype;Q.offsetName=function(){return null};Q.formatOffset=function(){return""};Q.offset=function(){return NaN};Q.equals=function(){return!1};a(ua,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},
{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]);return ua}(ec),Nc=function(){return Date.now()},Oc="system",Pc=null,Qc=null,Rc=null,Sc,Gb=function(){function ha(){}ha.resetCaches=function(){Ib.resetCache();Wb.resetCache()};a(ha,null,[{key:"now",get:function(){return Nc},set:function(ua){Nc=ua}},{key:"defaultZone",get:function(){return ya(Oc,Mc.instance)},set:function(ua){Oc=ua}},{key:"defaultLocale",get:function(){return Pc},set:function(ua){Pc=ua}},{key:"defaultNumberingSystem",
get:function(){return Qc},set:function(ua){Qc=ua}},{key:"defaultOutputCalendar",get:function(){return Rc},set:function(ua){Rc=ua}},{key:"throwOnInvalid",get:function(){return Sc},set:function(ua){Sc=ua}}]);return ha}(),id=["base"],tc={},Bc={},Cc={},rc=null,jd=function(){function ha(ua,Q,la){this.padTo=la.padTo||0;this.floor=la.floor||!1;if(!Q){Q={useGrouping:!1};0<la.padTo&&(Q.minimumIntegerDigits=la.padTo);la=Q;void 0===la&&(la={});Q=JSON.stringify([ua,la]);var wa=Bc[Q];wa||(wa=new Intl.NumberFormat(ua,
la),Bc[Q]=wa);this.inf=wa}}ha.prototype.format=function(ua){if(this.inf)return this.inf.format(this.floor?Math.floor(ua):ua);ua=this.floor?Math.floor(ua):A(ua,3);return x(ua,this.padTo)};return ha}(),kd=function(){function ha(Q,la,wa){this.opts=wa;if(Q.zone.isUniversal){var Fa=Q.offset/60*-1;Fa=0<=Fa?"Etc/GMT+"+Fa:"Etc/GMT"+Fa;var Qa=Wb.isValidZone(Fa);0!==Q.offset&&Qa?this.dt=Q:(Fa="UTC",this.dt=wa.timeZoneName?Q:0===Q.offset?Q:Fb.fromMillis(Q.ts+6E4*Q.offset))}else"system"===Q.zone.type?this.dt=
Q:(this.dt=Q,Fa=Q.zone.name);Q=D({},this.opts);Fa&&(Q.timeZone=Fa);this.dtf=S(la,Q)}var ua=ha.prototype;ua.format=function(){return this.dtf.format(this.dt.toJSDate())};ua.formatToParts=function(){return this.dtf.formatToParts(this.dt.toJSDate())};ua.resolvedOptions=function(){return this.dtf.resolvedOptions()};return ha}(),ld=function(){function ha(Q,la,wa){this.opts=D({style:"long"},wa);if(!la&&k()){la=wa;void 0===la&&(la={});wa=la;wa.base;if(null==wa)wa={};else{var Fa={},Qa=Object.keys(wa),Xa;
for(Xa=0;Xa<Qa.length;Xa++){var eb=Qa[Xa];0<=id.indexOf(eb)||(Fa[eb]=wa[eb])}wa=Fa}wa=JSON.stringify([Q,wa]);Fa=Cc[wa];Fa||(Fa=new Intl.RelativeTimeFormat(Q,la),Cc[wa]=Fa);this.rtf=Fa}}var ua=ha.prototype;ua.format=function(Q,la){return this.rtf?this.rtf.format(Q,la):V(la,Q,this.opts.numeric,"long"!==this.opts.style)};ua.formatToParts=function(Q,la){return this.rtf?this.rtf.formatToParts(Q,la):[]};return ha}(),Ib=function(){function ha(Q,la,wa,Fa){var Qa=Q.indexOf("-u-");if(-1===Qa)Q=[Q];else{Qa=
Q.substring(0,Qa);try{var Xa=S(Q).resolvedOptions()}catch(eb){Xa=S(Qa).resolvedOptions()}Q=Xa;Q=[Qa,Q.numberingSystem,Q.calendar]}Xa=Q[1];Qa=Q[2];this.locale=Q[0];this.numberingSystem=la||Xa||null;this.outputCalendar=wa||Qa||null;la=this.locale;wa=this.numberingSystem;if((Q=this.outputCalendar)||wa)la+="-u",Q&&(la+="-ca-"+Q),wa&&(la+="-nu-"+wa);this.intl=la;this.weekdaysCache={format:{},standalone:{}};this.monthsCache={format:{},standalone:{}};this.meridiemCache=null;this.eraCache={};this.specifiedLocale=
Fa;this.fastNumbersCached=null}ha.fromOpts=function(Q){return ha.create(Q.locale,Q.numberingSystem,Q.outputCalendar,Q.defaultToEN)};ha.create=function(Q,la,wa,Fa){void 0===Fa&&(Fa=!1);Q=Q||Gb.defaultLocale;var Qa;(Qa=Q)||(Fa?Fa="en-US":(rc||(rc=(new Intl.DateTimeFormat).resolvedOptions().locale),Fa=rc),Qa=Fa);return new ha(Qa,la||Gb.defaultNumberingSystem,wa||Gb.defaultOutputCalendar,Q)};ha.resetCache=function(){rc=null;tc={};Bc={};Cc={}};ha.fromObject=function(Q){Q=void 0===Q?{}:Q;return ha.create(Q.locale,
Q.numberingSystem,Q.outputCalendar)};var ua=ha.prototype;ua.listingMode=function(Q){Q=this.isEnglish();var la=(null===this.numberingSystem||"latn"===this.numberingSystem)&&(null===this.outputCalendar||"gregory"===this.outputCalendar);return Q&&la?"en":"intl"};ua.clone=function(Q){return Q&&0!==Object.getOwnPropertyNames(Q).length?ha.create(Q.locale||this.specifiedLocale,Q.numberingSystem||this.numberingSystem,Q.outputCalendar||this.outputCalendar,Q.defaultToEN||!1):this};ua.redefaultToEN=function(Q){void 0===
Q&&(Q={});return this.clone(D({},Q,{defaultToEN:!0}))};ua.redefaultToSystem=function(Q){void 0===Q&&(Q={});return this.clone(D({},Q,{defaultToEN:!1}))};ua.months=function(Q,la,wa){var Fa=this;void 0===la&&(la=!1);void 0===wa&&(wa=!0);return X(this,Q,wa,Z,function(){var Qa=la?{month:Q,day:"numeric"}:{month:Q},Xa=la?"format":"standalone";Fa.monthsCache[Xa][Q]||(Fa.monthsCache[Xa][Q]=ma(function(eb){return Fa.extract(eb,Qa,"month")}));return Fa.monthsCache[Xa][Q]})};ua.weekdays=function(Q,la,wa){var Fa=
this;void 0===la&&(la=!1);void 0===wa&&(wa=!0);return X(this,Q,wa,Y,function(){var Qa=la?{weekday:Q,year:"numeric",month:"long",day:"numeric"}:{weekday:Q},Xa=la?"format":"standalone";Fa.weekdaysCache[Xa][Q]||(Fa.weekdaysCache[Xa][Q]=ja(function(eb){return Fa.extract(eb,Qa,"weekday")}));return Fa.weekdaysCache[Xa][Q]})};ua.meridiems=function(Q){var la=this;void 0===Q&&(Q=!0);return X(this,void 0,Q,function(){return Lc},function(){if(!la.meridiemCache){var wa={hour:"numeric",hourCycle:"h12"};la.meridiemCache=
[Fb.utc(2016,11,13,9),Fb.utc(2016,11,13,19)].map(function(Fa){return la.extract(Fa,wa,"dayperiod")})}return la.meridiemCache})};ua.eras=function(Q,la){var wa=this;void 0===la&&(la=!0);return X(this,Q,la,qa,function(){var Fa={era:Q};wa.eraCache[Q]||(wa.eraCache[Q]=[Fb.utc(-40,1,1),Fb.utc(2017,1,1)].map(function(Qa){return wa.extract(Qa,Fa,"era")}));return wa.eraCache[Q]})};ua.extract=function(Q,la,wa){return(Q=this.dtFormatter(Q,la).formatToParts().find(function(Fa){return Fa.type.toLowerCase()===
wa}))?Q.value:null};ua.numberFormatter=function(Q){void 0===Q&&(Q={});return new jd(this.intl,Q.forceSimple||this.fastNumbers,Q)};ua.dtFormatter=function(Q,la){void 0===la&&(la={});return new kd(Q,this.intl,la)};ua.relFormatter=function(Q){void 0===Q&&(Q={});return new ld(this.intl,this.isEnglish(),Q)};ua.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||(new Intl.DateTimeFormat(this.intl)).resolvedOptions().locale.startsWith("en-us")};ua.equals=function(Q){return this.locale===
Q.locale&&this.numberingSystem===Q.numberingSystem&&this.outputCalendar===Q.outputCalendar};a(ha,[{key:"fastNumbers",get:function(){if(null==this.fastNumbersCached){var Q=this.numberingSystem&&"latn"!==this.numberingSystem?!1:"latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||"latn"===(new Intl.DateTimeFormat(this.intl)).resolvedOptions().numberingSystem;this.fastNumbersCached=Q}return this.fastNumbersCached}}]);return ha}(),Tc=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Dc=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,
Uc=RegExp(""+Dc.source+Tc.source+"?"),Ec=RegExp("(?:T"+Uc.source+")?"),md=Ia("weekYear","weekNumber","weekDay"),nd=Ia("year","ordinal"),Vc=RegExp(Dc.source+" ?(?:"+Tc.source+"|("+Eb.source+"))?"),od=RegExp("(?: "+Vc.source+")?"),pd=RegExp("^T?"+Dc.source+"$"),qd=/^-?P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,9}))?S)?)?)$/,ad={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480},
rd=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/,sd=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,td=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ud=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/,
vd=oa(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Ec),wd=oa(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Ec),xd=oa(/(\d{4})-?(\d{3})/,Ec),yd=oa(Uc),zd=xa(ea,za,Ca),Ad=xa(md,za,Ca),Bd=xa(nd,za,Ca),Cd=xa(za,Ca),Dd=xa(za),Ed=oa(/(\d{4})-(\d\d)-(\d\d)/,od),Fd=oa(Vc),Gd=xa(ea,za,Ca,Da),Hd=xa(za,Ca,Da),Wc={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048E5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864E5},hours:{minutes:60,seconds:3600,milliseconds:36E5},minutes:{seconds:60,milliseconds:6E4},
seconds:{milliseconds:1E3}},Id=D({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536E3,milliseconds:31536E6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624E5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592E3,milliseconds:2592E6}},Wc),Jd=D({years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:31556952,milliseconds:31556952E3},quarters:{months:3,weeks:13.044375,
days:91.310625,hours:2191.455,minutes:131487.3,seconds:7889238,milliseconds:7889238E3},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746E3}},Wc),fc="years quarters months weeks days hours minutes seconds milliseconds".split(" "),bd=fc.slice(0).reverse(),Mb=function(){function ha(Q){var la="longterm"===Q.conversionAccuracy||!1;this.values=Q.values;this.loc=Q.loc||Ib.create();this.conversionAccuracy=la?"longterm":"casual";this.invalid=Q.invalid||
null;this.matrix=la?Jd:Id;this.isLuxonDuration=!0}ha.fromMillis=function(Q,la){return ha.fromObject({milliseconds:Q},la)};ha.fromObject=function(Q,la){void 0===la&&(la={});if(null==Q||"object"!==typeof Q)throw new Lb("Duration.fromObject: argument expected to be an object, got "+(null===Q?"null":typeof Q));return new ha({values:P(Q,ha.normalizeUnit),loc:Ib.fromObject(la),conversionAccuracy:la.conversionAccuracy})};ha.fromISO=function(Q,la){var wa=Ha(Q,[qd,ka])[0];return wa?ha.fromObject(wa,la):ha.invalid("unparsable",
'the input "'+Q+"\" can't be parsed as ISO 8601")};ha.fromISOTime=function(Q,la){var wa=Ha(Q,[pd,Dd])[0];return wa?ha.fromObject(wa,la):ha.invalid("unparsable",'the input "'+Q+"\" can't be parsed as ISO 8601")};ha.invalid=function(Q,la){void 0===la&&(la=null);if(!Q)throw new Lb("need to specify a reason the Duration is invalid");var wa=Q instanceof Sb?Q:new Sb(Q,la);if(Gb.throwOnInvalid)throw new oc(wa);return new ha({invalid:wa})};ha.normalizeUnit=function(Q){var la={year:"years",years:"years",quarter:"quarters",
quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[Q?Q.toLowerCase():Q];if(!la)throw new hc(Q);return la};ha.isDuration=function(Q){return Q&&Q.isLuxonDuration||!1};var ua=ha.prototype;ua.toFormat=function(Q,la){void 0===la&&(la={});var wa=D({},la,{floor:!1!==la.round&&!1!==la.floor});return this.isValid?
Yb.create(this.loc,wa).formatDurationFromString(this,Q):"Invalid Duration"};ua.toObject=function(){return this.isValid?D({},this.values):{}};ua.toISO=function(){if(!this.isValid)return null;var Q="P";0!==this.years&&(Q+=this.years+"Y");if(0!==this.months||0!==this.quarters)Q+=this.months+3*this.quarters+"M";0!==this.weeks&&(Q+=this.weeks+"W");0!==this.days&&(Q+=this.days+"D");if(0!==this.hours||0!==this.minutes||0!==this.seconds||0!==this.milliseconds)Q+="T";0!==this.hours&&(Q+=this.hours+"H");0!==
this.minutes&&(Q+=this.minutes+"M");if(0!==this.seconds||0!==this.milliseconds)Q+=A(this.seconds+this.milliseconds/1E3,3)+"S";"P"===Q&&(Q+="T0S");return Q};ua.toISOTime=function(Q){void 0===Q&&(Q={});if(!this.isValid)return null;var la=this.toMillis();if(0>la||864E5<=la)return null;Q=D({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},Q);la=this.shiftTo("hours","minutes","seconds","milliseconds");var wa="basic"===Q.format?"hhmm":"hh:mm";Q.suppressSeconds&&0===la.seconds&&
0===la.milliseconds||(wa+="basic"===Q.format?"ss":":ss",Q.suppressMilliseconds&&0===la.milliseconds||(wa+=".SSS"));la=la.toFormat(wa);Q.includePrefix&&(la="T"+la);return la};ua.toJSON=function(){return this.toISO()};ua.toString=function(){return this.toISO()};ua.toMillis=function(){return this.as("milliseconds")};ua.valueOf=function(){return this.toMillis()};ua.plus=function(Q){if(!this.isValid)return this;Q=Ea(Q);for(var la={},wa=b(fc),Fa;!(Fa=wa()).done;)if(Fa=Fa.value,C(Q.values,Fa)||C(this.values,
Fa))la[Fa]=Q.get(Fa)+this.get(Fa);return aa(this,{values:la},!0)};ua.minus=function(Q){if(!this.isValid)return this;Q=Ea(Q);return this.plus(Q.negate())};ua.mapUnits=function(Q){if(!this.isValid)return this;for(var la={},wa=0,Fa=Object.keys(this.values);wa<Fa.length;wa++){var Qa=Fa[wa];la[Qa]=T(Q(this.values[Qa],Qa))}return aa(this,{values:la},!0)};ua.get=function(Q){return this[ha.normalizeUnit(Q)]};ua.set=function(Q){if(!this.isValid)return this;Q=D({},this.values,P(Q,ha.normalizeUnit));return aa(this,
{values:Q})};ua.reconfigure=function(Q){var la=void 0===Q?{}:Q;Q=la.conversionAccuracy;la={loc:this.loc.clone({locale:la.locale,numberingSystem:la.numberingSystem})};Q&&(la.conversionAccuracy=Q);return aa(this,la)};ua.as=function(Q){return this.isValid?this.shiftTo(Q).get(Q):NaN};ua.normalize=function(){if(!this.isValid)return this;var Q=this.toObject();Wa(this.matrix,Q);return aa(this,{values:Q},!0)};ua.shiftTo=function(){for(var Q=arguments.length,la=Array(Q),wa=0;wa<Q;wa++)la[wa]=arguments[wa];
if(!this.isValid||0===la.length)return this;la=la.map(function(Qb){return ha.normalizeUnit(Qb)});Q={};wa={};for(var Fa=this.toObject(),Qa,Xa=b(fc),eb;!(eb=Xa()).done;)if(eb=eb.value,0<=la.indexOf(eb)){Qa=eb;var lb=0,sb;for(sb in wa)lb+=this.matrix[sb][eb]*wa[sb],wa[sb]=0;h(Fa[eb])&&(lb+=Fa[eb]);var Cb=Math.trunc(lb);Q[eb]=Cb;wa[eb]=lb-Cb;for(var vb in Fa)fc.indexOf(vb)>fc.indexOf(eb)&&Ya(this.matrix,Fa,vb,Q,eb)}else h(Fa[eb])&&(wa[eb]=Fa[eb]);for(var Bb in wa)0!==wa[Bb]&&(Q[Qa]+=Bb===Qa?wa[Bb]:wa[Bb]/
this.matrix[Qa][Bb]);return aa(this,{values:Q},!0).normalize()};ua.negate=function(){if(!this.isValid)return this;for(var Q={},la=0,wa=Object.keys(this.values);la<wa.length;la++){var Fa=wa[la];Q[Fa]=-this.values[Fa]}return aa(this,{values:Q},!0)};ua.equals=function(Q){if(!this.isValid||!Q.isValid||!this.loc.equals(Q.loc))return!1;for(var la=b(fc),wa;!(wa=la()).done;){var Fa=wa.value;wa=this.values[Fa];Fa=Q.values[Fa];wa=void 0===wa||0===wa?void 0===Fa||0===Fa:wa===Fa;if(!wa)return!1}return!0};a(ha,
[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?
this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",
get:function(){return this.invalid?this.invalid.explanation:null}}]);return ha}(),mc=function(){function ha(Q){this.s=Q.start;this.e=Q.end;this.invalid=Q.invalid||null;this.isLuxonInterval=!0}ha.invalid=function(Q,la){void 0===la&&(la=null);if(!Q)throw new Lb("need to specify a reason the Interval is invalid");var wa=Q instanceof Sb?Q:new Sb(Q,la);if(Gb.throwOnInvalid)throw new Tb(wa);return new ha({invalid:wa})};ha.fromDateTimes=function(Q,la){var wa=yb(Q),Fa=yb(la);var Qa=wa&&wa.isValid?Fa&&Fa.isValid?
Fa<wa?mc.invalid("end before start","The end of an interval must be after its start, but you had start\x3d"+wa.toISO()+" and end\x3d"+Fa.toISO()):null:mc.invalid("missing or invalid end"):mc.invalid("missing or invalid start");return null==Qa?new ha({start:wa,end:Fa}):Qa};ha.after=function(Q,la){var wa=Ea(la),Fa=yb(Q);return ha.fromDateTimes(Fa,Fa.plus(wa))};ha.before=function(Q,la){var wa=Ea(la),Fa=yb(Q);return ha.fromDateTimes(Fa.minus(wa),Fa)};ha.fromISO=function(Q,la){var wa=(Q||"").split("/",
2),Fa=wa[0];wa=wa[1];if(Fa&&wa){try{var Qa=Fb.fromISO(Fa,la);var Xa=Qa.isValid}catch(sb){Xa=!1}try{var eb=Fb.fromISO(wa,la);var lb=eb.isValid}catch(sb){lb=!1}if(Xa&&lb)return ha.fromDateTimes(Qa,eb);if(Xa){if(eb=Mb.fromISO(wa,la),eb.isValid)return ha.after(Qa,eb)}else if(lb&&(Qa=Mb.fromISO(Fa,la),Qa.isValid))return ha.before(eb,Qa)}return ha.invalid("unparsable",'the input "'+Q+"\" can't be parsed as ISO 8601")};ha.isInterval=function(Q){return Q&&Q.isLuxonInterval||!1};var ua=ha.prototype;ua.length=
function(Q){void 0===Q&&(Q="milliseconds");return this.isValid?this.toDuration.apply(this,[Q]).get(Q):NaN};ua.count=function(Q){void 0===Q&&(Q="milliseconds");if(!this.isValid)return NaN;var la=this.start.startOf(Q),wa=this.end.startOf(Q);return Math.floor(wa.diff(la,Q).get(Q))+1};ua.hasSame=function(Q){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,Q):!1};ua.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()};ua.isAfter=function(Q){return this.isValid?this.s>Q:!1};
ua.isBefore=function(Q){return this.isValid?this.e<=Q:!1};ua.contains=function(Q){return this.isValid?this.s<=Q&&this.e>Q:!1};ua.set=function(Q){Q=void 0===Q?{}:Q;return this.isValid?ha.fromDateTimes(Q.start||this.s,Q.end||this.e):this};ua.splitAt=function(){var Q=this;if(!this.isValid)return[];for(var la=arguments.length,wa=Array(la),Fa=0;Fa<la;Fa++)wa[Fa]=arguments[Fa];la=wa.map(yb).filter(function(eb){return Q.contains(eb)}).sort();wa=[];Fa=this.s;for(var Qa=0;Fa<this.e;){var Xa=la[Qa]||this.e;
Xa=+Xa>+this.e?this.e:Xa;wa.push(ha.fromDateTimes(Fa,Xa));Fa=Xa;Qa+=1}return wa};ua.splitBy=function(Q){Q=Ea(Q);if(!this.isValid||!Q.isValid||0===Q.as("milliseconds"))return[];for(var la=this.s,wa=1,Fa,Qa=[];la<this.e;)Fa=this.start.plus(Q.mapUnits(function(Xa){return Xa*wa})),Fa=+Fa>+this.e?this.e:Fa,Qa.push(ha.fromDateTimes(la,Fa)),la=Fa,wa+=1;return Qa};ua.divideEqually=function(Q){return this.isValid?this.splitBy(this.length()/Q).slice(0,Q):[]};ua.overlaps=function(Q){return this.e>Q.s&&this.s<
Q.e};ua.abutsStart=function(Q){return this.isValid?+this.e===+Q.s:!1};ua.abutsEnd=function(Q){return this.isValid?+Q.e===+this.s:!1};ua.engulfs=function(Q){return this.isValid?this.s<=Q.s&&this.e>=Q.e:!1};ua.equals=function(Q){return this.isValid&&Q.isValid?this.s.equals(Q.s)&&this.e.equals(Q.e):!1};ua.intersection=function(Q){if(!this.isValid)return this;var la=this.s>Q.s?this.s:Q.s;Q=this.e<Q.e?this.e:Q.e;return la>=Q?null:ha.fromDateTimes(la,Q)};ua.union=function(Q){return this.isValid?ha.fromDateTimes(this.s<
Q.s?this.s:Q.s,this.e>Q.e?this.e:Q.e):this};ha.merge=function(Q){var la=Q.sort(function(wa,Fa){return wa.s-Fa.s}).reduce(function(wa,Fa){var Qa=wa[0],Xa=wa[1];return Xa?Xa.overlaps(Fa)||Xa.abutsStart(Fa)?[Qa,Xa.union(Fa)]:[Qa.concat([Xa]),Fa]:[Qa,Fa]},[[],null]);Q=la[0];(la=la[1])&&Q.push(la);return Q};ha.xor=function(Q){var la,wa=null,Fa=0,Qa=[];Q=Q.map(function(Xa){return[{time:Xa.s,type:"s"},{time:Xa.e,type:"e"}]});Q=(la=Array.prototype).concat.apply(la,Q).sort(function(Xa,eb){return Xa.time-eb.time});
for(la=b(Q);!(Q=la()).done;)Q=Q.value,Fa+="s"===Q.type?1:-1,1===Fa?wa=Q.time:(wa&&+wa!==+Q.time&&Qa.push(ha.fromDateTimes(wa,Q.time)),wa=null);return ha.merge(Qa)};ua.difference=function(){for(var Q=this,la=arguments.length,wa=Array(la),Fa=0;Fa<la;Fa++)wa[Fa]=arguments[Fa];return ha.xor([this].concat(wa)).map(function(Qa){return Q.intersection(Qa)}).filter(function(Qa){return Qa&&!Qa.isEmpty()})};ua.toString=function(){return this.isValid?"["+this.s.toISO()+" \u2013 "+this.e.toISO()+")":"Invalid Interval"};
ua.toISO=function(Q){return this.isValid?this.s.toISO(Q)+"/"+this.e.toISO(Q):"Invalid Interval"};ua.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():"Invalid Interval"};ua.toISOTime=function(Q){return this.isValid?this.s.toISOTime(Q)+"/"+this.e.toISOTime(Q):"Invalid Interval"};ua.toFormat=function(Q,la){var wa=(void 0===la?{}:la).separator;wa=void 0===wa?" \u2013 ":wa;return this.isValid?""+this.s.toFormat(Q)+wa+this.e.toFormat(Q):"Invalid Interval"};ua.toDuration=
function(Q,la){return this.isValid?this.e.diff(this.s,Q,la):Mb.invalid(this.invalidReason)};ua.mapEndpoints=function(Q){return ha.fromDateTimes(Q(this.s),Q(this.e))};a(ha,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?
this.invalid.explanation:null}}]);return ha}(),nc=function(){function ha(){}ha.hasDST=function(ua){void 0===ua&&(ua=Gb.defaultZone);var Q=Fb.now().setZone(ua).set({month:12});return!ua.isUniversal&&Q.offset!==Q.set({month:6}).offset};ha.isValidIANAZone=function(ua){return Wb.isValidSpecifier(ua)&&Wb.isValidZone(ua)};ha.normalizeZone=function(ua){return ya(ua,Gb.defaultZone)};ha.months=function(ua,Q){void 0===ua&&(ua="long");var la=void 0===Q?{}:Q,wa=la.locale,Fa=la.numberingSystem,Qa=la.locObj;la=
la.outputCalendar;return((void 0===Qa?null:Qa)||Ib.create(void 0===wa?null:wa,void 0===Fa?null:Fa,void 0===la?"gregory":la)).months(ua)};ha.monthsFormat=function(ua,Q){void 0===ua&&(ua="long");var la=void 0===Q?{}:Q,wa=la.locale,Fa=la.numberingSystem,Qa=la.locObj;la=la.outputCalendar;return((void 0===Qa?null:Qa)||Ib.create(void 0===wa?null:wa,void 0===Fa?null:Fa,void 0===la?"gregory":la)).months(ua,!0)};ha.weekdays=function(ua,Q){void 0===ua&&(ua="long");var la=void 0===Q?{}:Q,wa=la.locale,Fa=la.numberingSystem;
la=la.locObj;return((void 0===la?null:la)||Ib.create(void 0===wa?null:wa,void 0===Fa?null:Fa,null)).weekdays(ua)};ha.weekdaysFormat=function(ua,Q){void 0===ua&&(ua="long");var la=void 0===Q?{}:Q,wa=la.locale,Fa=la.numberingSystem;la=la.locObj;return((void 0===la?null:la)||Ib.create(void 0===wa?null:wa,void 0===Fa?null:Fa,null)).weekdays(ua,!0)};ha.meridiems=function(ua){ua=(void 0===ua?{}:ua).locale;return Ib.create(void 0===ua?null:ua).meridiems()};ha.eras=function(ua,Q){void 0===ua&&(ua="short");
var la=(void 0===Q?{}:Q).locale;return Ib.create(void 0===la?null:la,null,"gregory").eras(ua)};ha.features=function(){return{relative:k()}};return ha}(),uc={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",
mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},Hc={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,
3881]},cd=uc.hanidec.replace(/[\[|\]]/g,"").split(""),Ic="( |"+String.fromCharCode(160)+")",vc=new RegExp(Ic,"g"),ed={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM","short":"MMM","long":"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{"short":"EEE","long":"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}},wc=null,yc=[0,31,59,90,120,151,181,212,243,273,304,334],xc=[0,31,60,91,121,152,
182,213,244,274,305,335],Kc={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Kd={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Ld={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Jc="year month day hour minute second millisecond".split(" "),Md="weekYear weekNumber weekday hour minute second millisecond".split(" "),Nd="year ordinal hour minute second millisecond".split(" "),Fb=function(){function ha(Q){var la=Q.zone||Gb.defaultZone,wa=Q.invalid||(Number.isNaN(Q.ts)?new Sb("invalid input"):
null)||(la.isValid?null:pb(la));this.ts=c(Q.ts)?Gb.now():Q.ts;var Fa=null,Qa=null;wa||(Q.old&&Q.old.ts===this.ts&&Q.old.zone.equals(la)?(Qa=[Q.old.c,Q.old.o],Fa=Qa[0],Qa=Qa[1]):(Qa=la.offset(this.ts),Fa=Db(this.ts,Qa),Fa=(wa=Number.isNaN(Fa.year)?new Sb("invalid input"):null)?null:Fa,Qa=wa?null:Qa));this._zone=la;this.loc=Q.loc||Ib.create();this.invalid=wa;this.weekData=null;this.c=Fa;this.o=Qa;this.isLuxonDateTime=!0}ha.now=function(){return new ha({})};ha.local=function(){var Q=wb(arguments),la=
Q[1];return cc({year:la[0],month:la[1],day:la[2],hour:la[3],minute:la[4],second:la[5],millisecond:la[6]},Q[0])};ha.utc=function(){var Q=wb(arguments),la=Q[0],wa=Q[1];Q=wa[0];var Fa=wa[1],Qa=wa[2],Xa=wa[3],eb=wa[4],lb=wa[5];wa=wa[6];la.zone=Pb.utcInstance;return cc({year:Q,month:Fa,day:Qa,hour:Xa,minute:eb,second:lb,millisecond:wa},la)};ha.fromJSDate=function(Q,la){void 0===la&&(la={});var wa="[object Date]"===Object.prototype.toString.call(Q)?Q.valueOf():NaN;if(Number.isNaN(wa))return ha.invalid("invalid input");
var Fa=ya(la.zone,Gb.defaultZone);return Fa.isValid?new ha({ts:wa,zone:Fa,loc:Ib.fromObject(la)}):ha.invalid(pb(Fa))};ha.fromMillis=function(Q,la){void 0===la&&(la={});if(h(Q))return-864E13>Q||864E13<Q?ha.invalid("Timestamp out of range"):new ha({ts:Q,zone:ya(la.zone,Gb.defaultZone),loc:Ib.fromObject(la)});throw new Lb("fromMillis requires a numerical input, but received a "+typeof Q+" with value "+Q);};ha.fromSeconds=function(Q,la){void 0===la&&(la={});if(h(Q))return new ha({ts:1E3*Q,zone:ya(la.zone,
Gb.defaultZone),loc:Ib.fromObject(la)});throw new Lb("fromSeconds requires a numerical input");};ha.fromObject=function(Q,la){void 0===la&&(la={});Q=Q||{};var wa=ya(la.zone,Gb.defaultZone);if(!wa.isValid)return ha.invalid(pb(wa));var Fa=Gb.now(),Qa=wa.offset(Fa),Xa=P(Q,ac),eb=!c(Xa.ordinal),lb=!c(Xa.year),sb=!c(Xa.month)||!c(Xa.day);lb=lb||sb;var Cb=Xa.weekYear||Xa.weekNumber,vb=Ib.fromObject(la);if((lb||eb)&&Cb)throw new Zb("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(sb&&
eb)throw new Zb("Can't mix ordinal dates with month/day");sb=Cb||Xa.weekday&&!lb;Cb=Db(Fa,Qa);if(sb){var Bb=Md;Fa=Kd;Cb=hb(Cb)}else eb?(Bb=Nd,Fa=Ld,Cb=nb(Cb)):(Bb=Jc,Fa=Kc);var Qb=!1;Bb=b(Bb);for(var Ob;!(Ob=Bb()).done;)Ob=Ob.value,c(Xa[Ob])?Xa[Ob]=Qb?Fa[Ob]:Cb[Ob]:Qb=!0;sb?(Fa=g(Xa.weekYear),Cb=u(Xa.weekNumber,1,I(Xa.weekYear)),Qb=u(Xa.weekday,1,7),Fa=Fa?Cb?Qb?!1:ab("weekday",Xa.weekday):ab("week",Xa.week):ab("weekYear",Xa.weekYear)):eb?(Fa=g(Xa.year),Cb=u(Xa.ordinal,1,B(Xa.year)?366:365),Fa=Fa?
Cb?!1:ab("ordinal",Xa.ordinal):ab("year",Xa.year)):Fa=xb(Xa);if(Fa=Fa||ub(Xa))return ha.invalid(Fa);eb=sb?fb(Xa):eb?qb(Xa):Xa;Qa=Jb(eb,Qa,wa);wa=new ha({ts:Qa[0],zone:wa,o:Qa[1],loc:vb});return Xa.weekday&&lb&&Q.weekday!==wa.weekday?ha.invalid("mismatched weekday","you can't specify both a weekday of "+Xa.weekday+" and a date of "+wa.toISO()):wa};ha.fromISO=function(Q,la){void 0===la&&(la={});var wa=Ha(Q,[vd,zd],[wd,Ad],[xd,Bd],[yd,Cd]);return Nb(wa[0],wa[1],la,"ISO 8601",Q)};ha.fromRFC2822=function(Q,
la){void 0===la&&(la={});var wa=Ha(Q.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim(),[rd,M]);return Nb(wa[0],wa[1],la,"RFC 2822",Q)};ha.fromHTTP=function(Q,la){void 0===la&&(la={});var wa=Ha(Q,[sd,Ga],[td,Ga],[ud,La]);return Nb(wa[0],wa[1],la,"HTTP",la)};ha.fromFormat=function(Q,la,wa){void 0===wa&&(wa={});if(c(Q)||c(la))throw new Lb("fromFormat requires an input string and a format");var Fa=wa,Qa=Fa.locale;Fa=Fa.numberingSystem;Qa=Ib.fromOpts({locale:void 0===Qa?null:Qa,numberingSystem:void 0===
Fa?null:Fa,defaultToEN:!0});Qa=Va(Qa,Q,la);var Xa=[Qa.result,Qa.zone,Qa.invalidReason];Qa=Xa[0];Fa=Xa[1];return(Xa=Xa[2])?ha.invalid(Xa):Nb(Qa,Fa,wa,"format "+la,Q)};ha.fromString=function(Q,la,wa){void 0===wa&&(wa={});return ha.fromFormat(Q,la,wa)};ha.fromSQL=function(Q,la){void 0===la&&(la={});var wa=Ha(Q,[Ed,Gd],[Fd,Hd]);return Nb(wa[0],wa[1],la,"SQL",Q)};ha.invalid=function(Q,la){void 0===la&&(la=null);if(!Q)throw new Lb("need to specify a reason the DateTime is invalid");var wa=Q instanceof Sb?
Q:new Sb(Q,la);if(Gb.throwOnInvalid)throw new bc(wa);return new ha({invalid:wa})};ha.isDateTime=function(Q){return Q&&Q.isLuxonDateTime||!1};var ua=ha.prototype;ua.get=function(Q){return this[Q]};ua.resolvedLocaleOptions=function(Q){void 0===Q&&(Q={});Q=Yb.create(this.loc.clone(Q),Q).resolvedOptions(this);return{locale:Q.locale,numberingSystem:Q.numberingSystem,outputCalendar:Q.calendar}};ua.toUTC=function(Q,la){void 0===Q&&(Q=0);void 0===la&&(la={});return this.setZone(Pb.instance(Q),la)};ua.toLocal=
function(){return this.setZone(Gb.defaultZone)};ua.setZone=function(Q,la){var wa=void 0===la?{}:la,Fa=wa.keepLocalTime;Fa=void 0===Fa?!1:Fa;wa=wa.keepCalendarTime;wa=void 0===wa?!1:wa;Q=ya(Q,Gb.defaultZone);if(Q.equals(this.zone))return this;if(Q.isValid){var Qa=this.ts;if(Fa||wa)Fa=Q.offset(this.ts),wa=this.toObject(),Qa=Jb(wa,Fa,Q)[0];return mb(this,{ts:Qa,zone:Q})}return ha.invalid(pb(Q))};ua.reconfigure=function(Q){Q=void 0===Q?{}:Q;Q=this.loc.clone({locale:Q.locale,numberingSystem:Q.numberingSystem,
outputCalendar:Q.outputCalendar});return mb(this,{loc:Q})};ua.setLocale=function(Q){return this.reconfigure({locale:Q})};ua.set=function(Q){if(!this.isValid)return this;Q=P(Q,ac);var la=!c(Q.weekYear)||!c(Q.weekNumber)||!c(Q.weekday),wa=!c(Q.ordinal),Fa=!c(Q.year),Qa=!c(Q.month)||!c(Q.day),Xa=Q.weekYear||Q.weekNumber;if((Fa||Qa||wa)&&Xa)throw new Zb("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(Qa&&wa)throw new Zb("Can't mix ordinal dates with month/day");la?la=fb(D({},
hb(this.c),Q)):c(Q.ordinal)?(la=D({},this.toObject(),Q),c(Q.day)&&(la.day=Math.min(E(la.year,la.month),la.day))):la=qb(D({},nb(this.c),Q));Q=Jb(la,this.o,this.zone);return mb(this,{ts:Q[0],o:Q[1]})};ua.plus=function(Q){if(!this.isValid)return this;Q=Ea(Q);return mb(this,Ub(this,Q))};ua.minus=function(Q){if(!this.isValid)return this;Q=Ea(Q).negate();return mb(this,Ub(this,Q))};ua.startOf=function(Q){if(!this.isValid)return this;var la={};Q=Mb.normalizeUnit(Q);switch(Q){case "years":la.month=1;case "quarters":case "months":la.day=
1;case "weeks":case "days":la.hour=0;case "hours":la.minute=0;case "minutes":la.second=0;case "seconds":la.millisecond=0}"weeks"===Q&&(la.weekday=1);"quarters"===Q&&(la.month=3*(Math.ceil(this.month/3)-1)+1);return this.set(la)};ua.endOf=function(Q){var la;return this.isValid?this.plus((la={},la[Q]=1,la)).startOf(Q).minus(1):this};ua.toFormat=function(Q,la){void 0===la&&(la={});return this.isValid?Yb.create(this.loc.redefaultToEN(la)).formatDateTimeFromString(this,Q):"Invalid DateTime"};ua.toLocaleString=
function(Q,la){void 0===Q&&(Q=ic);void 0===la&&(la={});return this.isValid?Yb.create(this.loc.clone(la),Q).formatDateTime(this):"Invalid DateTime"};ua.toLocaleParts=function(Q){void 0===Q&&(Q={});return this.isValid?Yb.create(this.loc.clone(Q),Q).formatDateTimeParts(this):[]};ua.toISO=function(Q){void 0===Q&&(Q={});return this.isValid?this.toISODate(Q)+"T"+this.toISOTime(Q):null};ua.toISODate=function(Q){Q=(void 0===Q?{}:Q).format;Q="basic"===(void 0===Q?"extended":Q)?"yyyyMMdd":"yyyy-MM-dd";9999<
this.year&&(Q="+"+Q);return Rb(this,Q)};ua.toISOWeekDate=function(){return Rb(this,"kkkk-'W'WW-c")};ua.toISOTime=function(Q){var la=void 0===Q?{}:Q;Q=la.suppressMilliseconds;var wa=la.suppressSeconds,Fa=la.includeOffset,Qa=la.includePrefix;la=la.format;return $b(this,{suppressSeconds:void 0===wa?!1:wa,suppressMilliseconds:void 0===Q?!1:Q,includeOffset:void 0===Fa?!0:Fa,includePrefix:void 0===Qa?!1:Qa,format:void 0===la?"extended":la})};ua.toRFC2822=function(){return Rb(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",
!1)};ua.toHTTP=function(){return Rb(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")};ua.toSQLDate=function(){return Rb(this,"yyyy-MM-dd")};ua.toSQLTime=function(Q){var la=void 0===Q?{}:Q;Q=la.includeOffset;la=la.includeZone;return $b(this,{includeOffset:void 0===Q?!0:Q,includeZone:void 0===la?!1:la,spaceZone:!0})};ua.toSQL=function(Q){void 0===Q&&(Q={});return this.isValid?this.toSQLDate()+" "+this.toSQLTime(Q):null};ua.toString=function(){return this.isValid?this.toISO():"Invalid DateTime"};ua.valueOf=
function(){return this.toMillis()};ua.toMillis=function(){return this.isValid?this.ts:NaN};ua.toSeconds=function(){return this.isValid?this.ts/1E3:NaN};ua.toJSON=function(){return this.toISO()};ua.toBSON=function(){return this.toJSDate()};ua.toObject=function(Q){void 0===Q&&(Q={});if(!this.isValid)return{};var la=D({},this.c);Q.includeConfig&&(la.outputCalendar=this.outputCalendar,la.numberingSystem=this.loc.numberingSystem,la.locale=this.loc.locale);return la};ua.toJSDate=function(){return new Date(this.isValid?
this.ts:NaN)};ua.diff=function(Q,la,wa){void 0===la&&(la="milliseconds");void 0===wa&&(wa={});if(!this.isValid||!Q.isValid)return Mb.invalid("created by diffing an invalid DateTime");wa=D({locale:this.locale,numberingSystem:this.numberingSystem},wa);var Fa=(Array.isArray(la)?la:[la]).map(Mb.normalizeUnit);la=Q.valueOf()>this.valueOf();Q=sa(la?this:Q,la?Q:this,Fa,wa);return la?Q.negate():Q};ua.diffNow=function(Q,la){void 0===Q&&(Q="milliseconds");void 0===la&&(la={});return this.diff(ha.now(),Q,la)};
ua.until=function(Q){return this.isValid?mc.fromDateTimes(this,Q):this};ua.hasSame=function(Q,la){if(!this.isValid)return!1;var wa=Q.valueOf(),Fa=this.setZone(Q.zone,{keepLocalTime:!0});return Fa.startOf(la)<=wa&&wa<=Fa.endOf(la)};ua.equals=function(Q){return this.isValid&&Q.isValid&&this.valueOf()===Q.valueOf()&&this.zone.equals(Q.zone)&&this.loc.equals(Q.loc)};ua.toRelative=function(Q){void 0===Q&&(Q={});if(!this.isValid)return null;var la=Q.base||ha.fromObject({},{zone:this.zone}),wa=Q.padding?
this<la?-Q.padding:Q.padding:0,Fa="years months days hours minutes seconds".split(" "),Qa=Q.unit;Array.isArray(Q.unit)&&(Fa=Q.unit,Qa=void 0);return rb(la,this.plus(wa),D({},Q,{numeric:"always",units:Fa,unit:Qa}))};ua.toRelativeCalendar=function(Q){void 0===Q&&(Q={});return this.isValid?rb(Q.base||ha.fromObject({},{zone:this.zone}),this,D({},Q,{numeric:"auto",units:["years","months","days"],calendary:!0})):null};ha.min=function(){for(var Q=arguments.length,la=Array(Q),wa=0;wa<Q;wa++)la[wa]=arguments[wa];
if(!la.every(ha.isDateTime))throw new Lb("min requires all arguments be DateTimes");return w(la,function(Fa){return Fa.valueOf()},Math.min)};ha.max=function(){for(var Q=arguments.length,la=Array(Q),wa=0;wa<Q;wa++)la[wa]=arguments[wa];if(!la.every(ha.isDateTime))throw new Lb("max requires all arguments be DateTimes");return w(la,function(Fa){return Fa.valueOf()},Math.max)};ha.fromFormatExplain=function(Q,la,wa){void 0===wa&&(wa={});var Fa=wa;wa=Fa.locale;Fa=Fa.numberingSystem;wa=Ib.fromOpts({locale:void 0===
wa?null:wa,numberingSystem:void 0===Fa?null:Fa,defaultToEN:!0});return Va(wa,Q,la)};ha.fromStringExplain=function(Q,la,wa){void 0===wa&&(wa={});return ha.fromFormatExplain(Q,la,wa)};a(ha,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",
get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?
this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?ob(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?ob(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?
ob(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?nb(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?nc.months("short",{locObj:this.loc})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?nc.months("long",{locObj:this.loc})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?nc.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?nc.weekdays("long",
{locObj:this.loc})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.isUniversal:null}},{key:"isInDST",get:function(){return this.isOffsetFixed?
!1:this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset}},{key:"isInLeapYear",get:function(){return B(this.year)}},{key:"daysInMonth",get:function(){return E(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?B(this.year)?366:365:NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?I(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return ic}},{key:"DATE_MED",get:function(){return Hb}},{key:"DATE_MED_WITH_WEEKDAY",get:function(){return da}},
{key:"DATE_FULL",get:function(){return Sa}},{key:"DATE_HUGE",get:function(){return Oa}},{key:"TIME_SIMPLE",get:function(){return Ma}},{key:"TIME_WITH_SECONDS",get:function(){return Na}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return Ua}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return Ta}},{key:"TIME_24_SIMPLE",get:function(){return Pa}},{key:"TIME_24_WITH_SECONDS",get:function(){return $a}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return cb}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return bb}},
{key:"DATETIME_SHORT",get:function(){return kb}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return Za}},{key:"DATETIME_MED",get:function(){return gb}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return ib}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return tb}},{key:"DATETIME_FULL",get:function(){return Kb}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return jc}},{key:"DATETIME_HUGE",get:function(){return kc}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return lc}}]);return ha}();
F.DateTime=Fb;F.Duration=Mb;F.FixedOffsetZone=Pb;F.IANAZone=Wb;F.Info=nc;F.Interval=mc;F.InvalidZone=sc;F.Settings=Gb;F.SystemZone=Mc;F.VERSION="2.0.2";F.Zone=ec;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Point"],function(F,m,a,D,z){F=F(z,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}});m.setObject("geometry.ScreenPoint",F,D);return F})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(F,m,a,D,z,y,r,q,n){function f(e){return new q(parseFloat(e.x),parseFloat(e.y)-parseFloat(e.height),parseFloat(e.x)+parseFloat(e.width),parseFloat(e.y),e.spatialReference)}var d=F(y,{declaredClass:"esri.geometry.Rect",type:"rect",x:0,y:0,width:100,height:100,constructor:function(e,b,c,h,g){z.isObject(e)&&"extent"===e.type&&(b=e.ymax,c=e.getWidth(),h=e.getHeight(),g=e.spatialReference,e=e.xmin);z.isObject(e)?(z.mixin(this,e),this.spatialReference&&(this.spatialReference=n.createSpatialReference(this.spatialReference))):
(this.x=e,this.y=b,this.width=c,this.height=h,this.spatialReference=g);this.verifySR()},getCenter:function(){return new r(this.x+this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(e,b){return new d(this.x+e,this.y+b,this.width,this.height,this.spatialReference)},intersects:function(e){return e.x+e.width<=this.x||e.y+e.height<=this.y||e.y>=this.y+this.height||e.x>=this.x+this.width?!1:!0},getExtent:function(){return f(this)},update:function(e,b,c,h,g){this.x=e;this.y=b;this.width=
c;this.height=h;this.spatialReference=g;this.clearCache();return this}});m.setObject("geometry.Rect",d,D);D.geometry._rectToExtent=f;D.geometry._extentToRect=function(e){return new d(e)};return d})},"esri/geometry/scaleUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","../config","../WKIDUnitConversion"],function(F,m,a,D,z){function y(e,b,c){return e&&b?e.getWidth()/b*(c||q)*39.37*n.screenDPI:0}function r(e,b,c,h,g){return e.expand(h*b/(39.37*((g?c:f.values[f[c]])||q)*n.screenDPI)/
e.getWidth())}var q=6370997*Math.PI/180,n=D.defaults,f=z,d={getUnitValueForSR:function(e){return this.getUnitValue(e)||q},getUnitValue:function(e){if(e)if("object"===typeof e){var b=e.wkid;var c=e.wkt}else"number"===typeof e?b=e:"string"===typeof e&&(c=e);if(b)var h=f.values[f[b]];else c&&-1!==c.search(/^PROJCS/i)&&(e=/UNIT\[([^\]]+)\]\]$/i.exec(c))&&e[1]&&(h=parseFloat(e[1].split(",")[1]));return h},getScale:function(e,b,c){if(1<arguments.length&&null!=b&&!b.declaredClass){var h=e;var g=b;b=null;
var k=d.getUnitValue(c)}else h=b||e.extent,g=e.width,k=d.getUnitValue(h&&h.spatialReference);return y(h,g,k)},getExtentForScale:function(e,b,c){return r(c||e.extent,e.width,d.getUnitValue(e.spatialReference),b,!0)}};F.mixin(F.getObject("geometry",!0,a),d);a.geometry._getScale=y;a.geometry._getExtentForScale=r;return d})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(F,m){var a,D={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,
.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5E4,15E4],units:"Meter Foot Foot_US Foot_Clarke Yard_Clarke Link_Clarke Yard_Sears Foot_Sears Chain_Sears Chain_Benoit_1895_B Yard_Indian Yard_Indian_1937 Foot_Gold_Coast Chain Chain_Sears_1922_Truncated 50_Kilometers 150_Kilometers".split(" "),2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,
2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,
3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,
3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,
3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,
5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,
6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,
6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,
6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,
6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,
7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,
7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,
8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,
8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,
9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,
24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,
31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,
102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,
103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,
103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,
103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(a=2E3;2045>=a;a++)D[a]=0;for(a=2056;2065>=a;a++)D[a]=0;for(a=2067;2135>=a;a++)D[a]=
0;for(a=2137;2154>=a;a++)D[a]=0;for(a=2161;2170>=a;a++)D[a]=0;for(a=2172;2193>=a;a++)D[a]=0;for(a=2195;2198>=a;a++)D[a]=0;for(a=2200;2203>=a;a++)D[a]=0;for(a=2205;2217>=a;a++)D[a]=0;for(a=2222;2224>=a;a++)D[a]=1;for(a=2225;2250>=a;a++)D[a]=2;for(a=2251;2253>=a;a++)D[a]=1;for(a=2257;2264>=a;a++)D[a]=2;for(a=2274;2279>=a;a++)D[a]=2;for(a=2280;2282>=a;a++)D[a]=1;for(a=2283;2289>=a;a++)D[a]=2;for(a=2290;2292>=a;a++)D[a]=0;for(a=2308;2313>=a;a++)D[a]=0;for(a=2315;2491>=a;a++)D[a]=0;for(a=2494;2866>=a;a++)D[a]=
0;for(a=2867;2869>=a;a++)D[a]=1;for(a=2870;2888>=a;a++)D[a]=2;for(a=2891;2895>=a;a++)D[a]=2;for(a=2896;2898>=a;a++)D[a]=1;for(a=2902;2908>=a;a++)D[a]=2;for(a=2915;2920>=a;a++)D[a]=2;for(a=2921;2923>=a;a++)D[a]=1;for(a=2924;2930>=a;a++)D[a]=2;for(a=2931;2962>=a;a++)D[a]=0;for(a=2964;2968>=a;a++)D[a]=2;for(a=2969;2973>=a;a++)D[a]=0;for(a=2975;2991>=a;a++)D[a]=0;for(a=2995;3051>=a;a++)D[a]=0;for(a=3054;3079>=a;a++)D[a]=0;for(a=3081;3088>=a;a++)D[a]=0;for(a=3092;3101>=a;a++)D[a]=0;for(a=3106;3138>=a;a++)D[a]=
0;for(a=3146;3151>=a;a++)D[a]=0;for(a=3153;3166>=a;a++)D[a]=0;for(a=3168;3172>=a;a++)D[a]=0;for(a=3174;3203>=a;a++)D[a]=0;for(a=3294;3358>=a;a++)D[a]=0;for(a=3367;3403>=a;a++)D[a]=0;for(a=3408;3416>=a;a++)D[a]=0;for(a=3417;3438>=a;a++)D[a]=2;for(a=3441;3446>=a;a++)D[a]=2;for(a=3447;3450>=a;a++)D[a]=0;for(a=3451;3459>=a;a++)D[a]=2;for(a=3460;3478>=a;a++)D[a]=0;for(a=3554;3559>=a;a++)D[a]=0;for(a=3560;3570>=a;a++)D[a]=2;for(a=3571;3581>=a;a++)D[a]=0;for(a=3594;3597>=a;a++)D[a]=0;for(a=3601;3604>=a;a++)D[a]=
0;for(a=3637;3639>=a;a++)D[a]=0;for(a=3665;3667>=a;a++)D[a]=0;for(a=3693;3695>=a;a++)D[a]=0;for(a=3701;3727>=a;a++)D[a]=0;for(a=3728;3739>=a;a++)D[a]=2;for(a=3740;3751>=a;a++)D[a]=0;for(a=3753;3760>=a;a++)D[a]=2;for(a=3761;3773>=a;a++)D[a]=0;for(a=3775;3777>=a;a++)D[a]=0;for(a=3779;3781>=a;a++)D[a]=0;for(a=3783;3785>=a;a++)D[a]=0;for(a=3788;3791>=a;a++)D[a]=0;for(a=3797;3802>=a;a++)D[a]=0;for(a=3814;3816>=a;a++)D[a]=0;for(a=3825;3829>=a;a++)D[a]=0;for(a=3832;3841>=a;a++)D[a]=0;for(a=3844;3852>=a;a++)D[a]=
0;for(a=3873;3885>=a;a++)D[a]=0;for(a=3890;3893>=a;a++)D[a]=0;for(a=3907;3912>=a;a++)D[a]=0;for(a=3942;3950>=a;a++)D[a]=0;for(a=3968;3970>=a;a++)D[a]=0;for(a=3973;3976>=a;a++)D[a]=0;for(a=3986;3989>=a;a++)D[a]=0;for(a=3994;3997>=a;a++)D[a]=0;for(a=4048;4051>=a;a++)D[a]=0;for(a=4056;4063>=a;a++)D[a]=0;for(a=4093;4096>=a;a++)D[a]=0;for(a=4390;4398>=a;a++)D[a]=0;for(a=4399;4413>=a;a++)D[a]=2;for(a=4418;4433>=a;a++)D[a]=2;for(a=4455;4457>=a;a++)D[a]=2;for(a=4484;4489>=a;a++)D[a]=0;for(a=4491;4554>=a;a++)D[a]=
0;for(a=4568;4589>=a;a++)D[a]=0;for(a=4652;4656>=a;a++)D[a]=0;for(a=4766;4800>=a;a++)D[a]=0;for(a=5014;5016>=a;a++)D[a]=0;for(a=5069;5072>=a;a++)D[a]=0;for(a=5105;5130>=a;a++)D[a]=0;for(a=5173;5188>=a;a++)D[a]=0;for(a=5253;5259>=a;a++)D[a]=0;for(a=5269;5275>=a;a++)D[a]=0;for(a=5292;5311>=a;a++)D[a]=0;for(a=5329;5331>=a;a++)D[a]=0;for(a=5343;5349>=a;a++)D[a]=0;for(a=5355;5357>=a;a++)D[a]=0;for(a=5387;5389>=a;a++)D[a]=0;for(a=5459;5463>=a;a++)D[a]=0;for(a=5479;5482>=a;a++)D[a]=0;for(a=5518;5520>=a;a++)D[a]=
0;for(a=5530;5539>=a;a++)D[a]=0;for(a=5550;5552>=a;a++)D[a]=0;for(a=5562;5583>=a;a++)D[a]=0;for(a=5623;5625>=a;a++)D[a]=2;for(a=5631;5639>=a;a++)D[a]=0;for(a=5649;5653>=a;a++)D[a]=0;for(a=5663;5680>=a;a++)D[a]=0;for(a=5682;5685>=a;a++)D[a]=0;for(a=5875;5877>=a;a++)D[a]=0;for(a=5896;5899>=a;a++)D[a]=0;for(a=5921;5940>=a;a++)D[a]=0;for(a=6050;6125>=a;a++)D[a]=0;for(a=6244;6275>=a;a++)D[a]=0;for(a=6328;6348>=a;a++)D[a]=0;for(a=6350;6356>=a;a++)D[a]=0;for(a=6366;6372>=a;a++)D[a]=0;for(a=6381;6387>=a;a++)D[a]=
0;for(a=6393;6404>=a;a++)D[a]=0;for(a=6480;6483>=a;a++)D[a]=0;for(a=6511;6514>=a;a++)D[a]=0;for(a=6579;6581>=a;a++)D[a]=0;for(a=6619;6624>=a;a++)D[a]=0;for(a=6625;6627>=a;a++)D[a]=2;for(a=6628;6632>=a;a++)D[a]=0;for(a=6634;6637>=a;a++)D[a]=0;for(a=6669;6692>=a;a++)D[a]=0;for(a=6707;6709>=a;a++)D[a]=0;for(a=6720;6723>=a;a++)D[a]=0;for(a=6732;6738>=a;a++)D[a]=0;for(a=6931;6933>=a;a++)D[a]=0;for(a=6956;6959>=a;a++)D[a]=0;for(a=7005;7007>=a;a++)D[a]=0;for(a=7057;7070>=a;a++)D[a]=2;for(a=7074;7082>=a;a++)D[a]=
0;for(a=7109;7118>=a;a++)D[a]=0;for(a=7119;7127>=a;a++)D[a]=1;for(a=7374;7376>=a;a++)D[a]=0;for(a=7528;7586>=a;a++)D[a]=0;for(a=7587;7645>=a;a++)D[a]=2;for(a=7692;7696>=a;a++)D[a]=0;for(a=7755;7787>=a;a++)D[a]=0;for(a=7791;7795>=a;a++)D[a]=0;for(a=7799;7801>=a;a++)D[a]=0;for(a=7803;7805>=a;a++)D[a]=0;for(a=7825;7831>=a;a++)D[a]=0;for(a=7845;7859>=a;a++)D[a]=0;for(a=8013;8032>=a;a++)D[a]=0;for(a=8065;8068>=a;a++)D[a]=1;for(a=8518;8529>=a;a++)D[a]=2;for(a=8533;8536>=a;a++)D[a]=2;for(a=8538;8540>=a;a++)D[a]=
2;for(a=8677;8679>=a;a++)D[a]=0;for(a=8836;8840>=a;a++)D[a]=0;for(a=8857;8859>=a;a++)D[a]=0;for(a=8908;8910>=a;a++)D[a]=0;for(a=9154;9159>=a;a++)D[a]=0;for(a=9205;9218>=a;a++)D[a]=0;for(a=9271;9273>=a;a++)D[a]=0;for(a=9295;9297>=a;a++)D[a]=0;for(a=9356;9360>=a;a++)D[a]=0;for(a=9404;9407>=a;a++)D[a]=0;for(a=9476;9482>=a;a++)D[a]=0;for(a=9487;9494>=a;a++)D[a]=0;for(a=9697;9699>=a;a++)D[a]=0;for(a=20002;20032>=a;a++)D[a]=0;for(a=20062;20092>=a;a++)D[a]=0;for(a=20135;20138>=a;a++)D[a]=0;for(a=20248;20258>=
a;a++)D[a]=0;for(a=20348;20358>=a;a++)D[a]=0;for(a=20436;20440>=a;a++)D[a]=0;for(a=20822;20824>=a;a++)D[a]=0;for(a=20904;20932>=a;a++)D[a]=0;for(a=20934;20936>=a;a++)D[a]=0;for(a=21004;21032>=a;a++)D[a]=0;for(a=21035;21037>=a;a++)D[a]=0;for(a=21095;21097>=a;a++)D[a]=0;for(a=21148;21150>=a;a++)D[a]=0;for(a=21207;21264>=a;a++)D[a]=0;for(a=21307;21364>=a;a++)D[a]=0;for(a=21413;21423>=a;a++)D[a]=0;for(a=21453;21463>=a;a++)D[a]=0;for(a=21473;21483>=a;a++)D[a]=0;for(a=21780;21782>=a;a++)D[a]=0;for(a=21891;21894>=
a;a++)D[a]=0;for(a=21896;21899>=a;a++)D[a]=0;for(a=22171;22177>=a;a++)D[a]=0;for(a=22181;22187>=a;a++)D[a]=0;for(a=22191;22197>=a;a++)D[a]=0;for(a=22234;22236>=a;a++)D[a]=0;for(a=22521;22525>=a;a++)D[a]=0;for(a=22991;22994>=a;a++)D[a]=0;for(a=23028;23038>=a;a++)D[a]=0;for(a=23830;23853>=a;a++)D[a]=0;for(a=23866;23872>=a;a++)D[a]=0;for(a=23877;23884>=a;a++)D[a]=0;for(a=23886;23894>=a;a++)D[a]=0;for(a=23946;23948>=a;a++)D[a]=0;for(a=24311;24313>=a;a++)D[a]=0;for(a=24342;24347>=a;a++)D[a]=0;for(a=24370;24374>=
a;a++)D[a]=10;for(a=24375;24381>=a;a++)D[a]=0;for(a=24718;24721>=a;a++)D[a]=0;for(a=24817;24821>=a;a++)D[a]=0;for(a=24877;24882>=a;a++)D[a]=0;for(a=24891;24893>=a;a++)D[a]=0;for(a=25391;25395>=a;a++)D[a]=0;for(a=25828;25838>=a;a++)D[a]=0;for(a=26191;26195>=a;a++)D[a]=0;for(a=26391;26393>=a;a++)D[a]=0;for(a=26701;26722>=a;a++)D[a]=0;for(a=26729;26799>=a;a++)D[a]=2;for(a=26801;26803>=a;a++)D[a]=2;for(a=26811;26813>=a;a++)D[a]=2;for(a=26847;26870>=a;a++)D[a]=2;for(a=26891;26899>=a;a++)D[a]=0;for(a=26901;26923>=
a;a++)D[a]=0;for(a=26929;26946>=a;a++)D[a]=0;for(a=26948;26998>=a;a++)D[a]=0;for(a=27037;27040>=a;a++)D[a]=0;for(a=27205;27232>=a;a++)D[a]=0;for(a=27258;27260>=a;a++)D[a]=0;for(a=27391;27398>=a;a++)D[a]=0;for(a=27561;27564>=a;a++)D[a]=0;for(a=27571;27574>=a;a++)D[a]=0;for(a=27581;27584>=a;a++)D[a]=0;for(a=27591;27594>=a;a++)D[a]=0;for(a=28191;28193>=a;a++)D[a]=0;for(a=28348;28358>=a;a++)D[a]=0;for(a=28402;28432>=a;a++)D[a]=0;for(a=28462;28492>=a;a++)D[a]=0;for(a=29118;29122>=a;a++)D[a]=0;for(a=29168;29172>=
a;a++)D[a]=0;for(a=29177;29185>=a;a++)D[a]=0;for(a=29187;29195>=a;a++)D[a]=0;for(a=29900;29903>=a;a++)D[a]=0;for(a=30161;30179>=a;a++)D[a]=0;for(a=30491;30494>=a;a++)D[a]=0;for(a=30729;30732>=a;a++)D[a]=0;for(a=31251;31259>=a;a++)D[a]=0;for(a=31265;31268>=a;a++)D[a]=0;for(a=31275;31279>=a;a++)D[a]=0;for(a=31281;31297>=a;a++)D[a]=0;for(a=31461;31469>=a;a++)D[a]=0;for(a=31491;31495>=a;a++)D[a]=0;for(a=31917;31922>=a;a++)D[a]=0;for(a=31965;32E3>=a;a++)D[a]=0;for(a=32001;32003>=a;a++)D[a]=2;for(a=32005;32031>=
a;a++)D[a]=2;for(a=32033;32060>=a;a++)D[a]=2;for(a=32064;32067>=a;a++)D[a]=2;for(a=32074;32077>=a;a++)D[a]=2;for(a=32081;32086>=a;a++)D[a]=0;for(a=32107;32130>=a;a++)D[a]=0;for(a=32133;32158>=a;a++)D[a]=0;for(a=32164;32167>=a;a++)D[a]=2;for(a=32180;32199>=a;a++)D[a]=0;for(a=32201;32260>=a;a++)D[a]=0;for(a=32301;32360>=a;a++)D[a]=0;for(a=32601;32662>=a;a++)D[a]=0;for(a=32664;32667>=a;a++)D[a]=2;for(a=32701;32761>=a;a++)D[a]=0;for(a=53001;53004>=a;a++)D[a]=0;for(a=53008;53019>=a;a++)D[a]=0;for(a=53021;53032>=
a;a++)D[a]=0;for(a=53034;53037>=a;a++)D[a]=0;for(a=53042;53046>=a;a++)D[a]=0;for(a=53074;53080>=a;a++)D[a]=0;for(a=54001;54004>=a;a++)D[a]=0;for(a=54008;54019>=a;a++)D[a]=0;for(a=54021;54032>=a;a++)D[a]=0;for(a=54034;54037>=a;a++)D[a]=0;for(a=54042;54046>=a;a++)D[a]=0;for(a=54048;54053>=a;a++)D[a]=0;for(a=54074;54080>=a;a++)D[a]=0;for(a=54098;54101>=a;a++)D[a]=0;for(a=102001;102040>=a;a++)D[a]=0;for(a=102042;102063>=a;a++)D[a]=0;for(a=102065;102067>=a;a++)D[a]=0;for(a=102070;102117>=a;a++)D[a]=0;
for(a=102122;102216>=a;a++)D[a]=0;for(a=102221;102377>=a;a++)D[a]=0;for(a=102382;102388>=a;a++)D[a]=0;for(a=102389;102398>=a;a++)D[a]=2;for(a=102399;102444>=a;a++)D[a]=0;for(a=102445;102447>=a;a++)D[a]=2;for(a=102448;102458>=a;a++)D[a]=0;for(a=102459;102468>=a;a++)D[a]=2;for(a=102469;102499>=a;a++)D[a]=0;for(a=102500;102519>=a;a++)D[a]=1;for(a=102520;102524>=a;a++)D[a]=0;for(a=102525;102529>=a;a++)D[a]=2;for(a=102530;102588>=a;a++)D[a]=0;for(a=102590;102598>=a;a++)D[a]=0;for(a=102601;102603>=a;a++)D[a]=
0;for(a=102605;102628>=a;a++)D[a]=0;for(a=102629;102646>=a;a++)D[a]=2;for(a=102648;102700>=a;a++)D[a]=2;for(a=102701;102703>=a;a++)D[a]=0;for(a=102707;102730>=a;a++)D[a]=2;for(a=102733;102758>=a;a++)D[a]=2;for(a=102767;102900>=a;a++)D[a]=0;for(a=102901;102933>=a;a++)D[a]=2;for(a=102934;102950>=a;a++)D[a]=13;for(a=102951;102960>=a;a++)D[a]=0;for(a=102965;102969>=a;a++)D[a]=0;for(a=102971;102973>=a;a++)D[a]=0;for(a=102975;102989>=a;a++)D[a]=0;for(a=102990;102992>=a;a++)D[a]=1;for(a=102997;103002>=a;a++)D[a]=
0;for(a=103003;103008>=a;a++)D[a]=2;for(a=103009;103011>=a;a++)D[a]=0;for(a=103012;103014>=a;a++)D[a]=2;for(a=103019;103021>=a;a++)D[a]=0;for(a=103022;103024>=a;a++)D[a]=2;for(a=103029;103031>=a;a++)D[a]=0;for(a=103032;103034>=a;a++)D[a]=2;for(a=103065;103068>=a;a++)D[a]=0;for(a=103074;103076>=a;a++)D[a]=0;for(a=103077;103079>=a;a++)D[a]=1;for(a=103080;103082>=a;a++)D[a]=0;for(a=103083;103085>=a;a++)D[a]=2;for(a=103090;103093>=a;a++)D[a]=0;for(a=103097;103099>=a;a++)D[a]=0;for(a=103100;103102>=a;a++)D[a]=
2;for(a=103107;103109>=a;a++)D[a]=0;for(a=103110;103112>=a;a++)D[a]=2;for(a=103113;103116>=a;a++)D[a]=0;for(a=103117;103120>=a;a++)D[a]=2;for(a=103153;103157>=a;a++)D[a]=0;for(a=103158;103162>=a;a++)D[a]=2;for(a=103163;103165>=a;a++)D[a]=0;for(a=103166;103168>=a;a++)D[a]=1;for(a=103169;103171>=a;a++)D[a]=2;for(a=103186;103188>=a;a++)D[a]=0;for(a=103189;103191>=a;a++)D[a]=2;for(a=103192;103195>=a;a++)D[a]=0;for(a=103196;103199>=a;a++)D[a]=2;for(a=103200;103224>=a;a++)D[a]=0;for(a=103225;103227>=a;a++)D[a]=
1;for(a=103232;103237>=a;a++)D[a]=0;for(a=103238;103243>=a;a++)D[a]=2;for(a=103244;103246>=a;a++)D[a]=0;for(a=103247;103249>=a;a++)D[a]=2;for(a=103254;103256>=a;a++)D[a]=0;for(a=103257;103259>=a;a++)D[a]=2;for(a=103264;103266>=a;a++)D[a]=0;for(a=103267;103269>=a;a++)D[a]=2;for(a=103300;103375>=a;a++)D[a]=0;for(a=103381;103383>=a;a++)D[a]=0;for(a=103384;103386>=a;a++)D[a]=1;for(a=103387;103389>=a;a++)D[a]=0;for(a=103390;103392>=a;a++)D[a]=2;for(a=103397;103399>=a;a++)D[a]=0;for(a=103400;103471>=a;a++)D[a]=
2;for(a=103476;103478>=a;a++)D[a]=0;for(a=103479;103481>=a;a++)D[a]=2;for(a=103486;103488>=a;a++)D[a]=0;for(a=103489;103491>=a;a++)D[a]=2;for(a=103492;103495>=a;a++)D[a]=0;for(a=103496;103499>=a;a++)D[a]=2;for(a=103528;103543>=a;a++)D[a]=0;for(a=103544;103548>=a;a++)D[a]=2;for(a=103549;103551>=a;a++)D[a]=0;for(a=103552;103554>=a;a++)D[a]=1;for(a=103555;103557>=a;a++)D[a]=2;for(a=103558;103560>=a;a++)D[a]=0;for(a=103571;103573>=a;a++)D[a]=0;for(a=103574;103576>=a;a++)D[a]=2;for(a=103577;103580>=a;a++)D[a]=
0;for(a=103581;103583>=a;a++)D[a]=2;for(a=103595;103694>=a;a++)D[a]=0;for(a=103696;103699>=a;a++)D[a]=0;for(a=103700;103793>=a;a++)D[a]=2;for(a=103794;103872>=a;a++)D[a]=0;for(a=103900;103971>=a;a++)D[a]=2;return m.WKIDUnitConversion=D})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(F,m,a,D,z,y,r,q,n,f){var d=function(){return 9>a("ie")?function(b,c,h,g,k,w,
t,C,u){var x=[],l=Math.round,v,A=t.length,B;for(v=0;v<A;v++){var E=t[v];var G=C?C(E[0][0],E[0][1],u):E[0];if(1<(B=E.length)){var I=l((G[0]-b)*h+k);var L=l((c-G[1])*g+w);G=C?C(E[1][0],E[1][1],u):E[1];var K=l((G[0]-b)*h+k);G=l((c-G[1])*g+w);x.push("M",I+","+L,"L",K+","+G);for(K=2;K<B;K++)G=C?C(E[K][0],E[K][1],u):E[K],I=l((G[0]-b)*h+k),L=l((c-G[1])*g+w),x.push(I+","+L)}else I=l((G[0]-b)*h+k),L=l((c-G[1])*g+w),x.push("M",I+","+L)}return x}:function(b,c,h,g,k,w,t,C,u,x){var l=[],v,A,B=Math.round;var E=
0;for(v=t?t.length:0;E<v;E++){var G=t[E];l.push("M");var I=0;for(A=G?G.length:0;I<A;I++){var L=C?C(G[I][0],G[I][1],u):G[I];l.push(B((L[0]-b)*h+k)+","+B((c-L[1])*g+w))}x||l.push("Z")}return l}}(),e={toScreenPoint:function(b,c,h,g,k){var w=b.spatialReference,t=g.spatialReference,C=g.x;g=g.y;w&&t&&!w.equals(t)&&w._canProject(t)&&(w=w.isWebMercator()?z.lngLatToXY(C,g):z.xyToLngLat(C,g,!0),C=w[0],g=w[1]);C=(C-b.xmin)*(c/b.getWidth());g=(b.ymax-g)*(h/b.getHeight());k||(C=Math.round(C),g=Math.round(g));
return new y(C,g)},toScreenGeometry:function(b,c,h,g){var k=b.xmin,w=b.ymax,t=c/b.getWidth(),C=h/b.getHeight(),u=F.forEach,x=Math.round;if(g instanceof z)return new z(x((g.x-k)*t),x((w-g.y)*C));if(g instanceof n){b=new n;var l=b.points;u(g.points,function(G,I){l[I]=[x((G[0]-k)*t),x((w-G[1])*C)]});return b}if(g instanceof f)return new f(x((g.xmin-k)*t),x((w-g.ymin)*C),x((g.xmax-k)*t),x((w-g.ymax)*t));if(g instanceof r){b=new r;var v=b.paths,A;u(g.paths,function(G,I){A=v[I]=[];u(G,function(L,K){A[K]=
[x((L[0]-k)*t),x((w-L[1])*C)]})});return b}if(g instanceof q){b=new q;var B=b.rings,E;u(g.rings,function(G,I){E=B[I]=[];u(G,function(L,K){E[K]=[x((L[0]-k)*t),x((w-L[1])*C)]})});return b}},_toScreenPath:function(b,c,h,g,k,w){var t=g instanceof r,C=b.spatialReference,u=g.spatialReference;if(C&&u&&!C.equals(u)&&C._canProject(u))if(C.isWebMercator())var x=z.lngLatToXY;else{x=z.xyToLngLat;var l=!0}return d(b.xmin,b.ymax,c/b.getWidth(),h/b.getHeight(),k,w,t?g.paths:g.rings,x,l,t)},toMapPoint:function(b,
c,h,g){return new z(b.xmin+g.x/(c/b.getWidth()),b.ymax-g.y/(h/b.getHeight()),b.spatialReference)},toMapGeometry:function(b,c,h,g){var k=b.xmin,w=b.ymax,t=b.spatialReference,C=c/b.getWidth(),u=h/b.getHeight(),x=F.forEach;if(g instanceof z)return new z(k+g.x/C,w-g.y/u,t);if(g instanceof n){b=new n(t);var l=b.points;x(g.points,function(G,I){l[I]=[k+G[0]/C,w-G[1]/u]});return b}if(g instanceof f)return new f(k+g.xmin/C,w-g.ymin/u,k+g.xmax/C,w-g.ymax/u,t);if(g instanceof r){b=new r(t);var v=b.paths,A;x(g.paths,
function(G,I){A=v[I]=[];x(G,function(L,K){A[K]=[k+L[0]/C,w-L[1]/u]})});return b}if(g instanceof q){b=new q(t);var B=b.rings,E;x(g.rings,function(G,I){E=B[I]=[];x(G,function(L,K){E[K]=[k+L[0]/C,w-L[1]/u]})});return b}}};m.mixin(m.getObject("geometry",!0,D),e);return e})},"esri/layers/GraphicsLayer":function(){define("require dojo/_base/declare dojo/_base/Deferred dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/window dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ./support/webglUtils ./support/WebGLSurface ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/utils ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K){var ba=-1!==e.renderer.toLowerCase().indexOf("svg"),T=-1!==e.renderer.toLowerCase().indexOf("canvas"),P=T?"canvas-2d":e.renderer,J=9>C("ie");r=10===C("ie");var N=void 0===C("ie")&&7==C("trident"),Z=r||N,Y=C("esri-touch"),qa=!!C("chrome"),V=g.isWebGLEnabled(),na=ba&&C("esri-will-change"),ya=V||T;g=m(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(S,ma){var ja=this._connects=[];this._map=S;this._useWillChange=
this._useGlobalTransform="css-transforms"===S.navigationMode&&na;if(ya){var X=n.create("div",{style:{position:"absolute",overflow:"visible"}},ma);this._surface={getEventSource:function(){return X}};T&&(ja.push(D.connect(X,"onmousedown",this,this._canvasDownHandler)),ja.push(D.connect(X,"onmouseup",this,this._canvasUpHandler)),ja.push(D.connect(X,"onclick",this,this._canvasClickHandler)));V&&(this._webglSurface=new k({map:S,node:X}))}else X=(this._surface=e.createSurface(ma,S.width,S.height)).getEventSource(),
this._useWillChange&&f.set(X,"will-change","transform"),f.set(X=J?X.parentNode:X,{overflow:"visible",position:"absolute"});ja.push(D.connect(S,"onResize",this,"_onResizeHandler"));this._useGlobalTransform&&(ja.push(D.connect(S,"onPan",this,"_onPanHandler")),ja.push(D.connect(S,"onPanEnd",this,"_onPanEndHandler")),ja.push(D.connect(S,"onExtentChange",this,"_onExtentChangeHandler")));return X},_reorderLayer:function(S,ma,ja){ma=ma.getEventSource();ya&&"svg"===S.surfaceType&&(ma=ma.parentNode);n.place(ma,
this._surface.getEventSource(),ja)},_onPanHandler:function(S,ma){var ja=this._map.__visibleRect,X=ja.x+ma.x;ja=ja.y+ma.y;this._panDx=X;this._panDy=ja;ya||f.set(this._surface.getEventSource(),w._css.names.transform,w._css.translate(X,ja))},_onPanEndHandler:function(S,ma){var ja=this._map.__visibleRect,X=ja.x;ja=ja.y;this._panDx=X;this._panDy=ja;ya||f.set(this._surface.getEventSource(),w._css.names.transform,w._css.translate(X,ja))},_onExtentChangeHandler:function(S,ma,ja,X){ja&&(this._panDy=this._panDx=
0,ya||f.set(this._surface.getEventSource(),w._css.names.transform,w._css.translate(0,0)))},_getTransform:function(){return{dx:this._panDx||0,dy:this._panDy||0}},_onResizeHandler:function(S,ma,ja){S=this._surface.getEventSource();var X=this._map,oa;J&&f.set(S=S.parentNode,{width:ma+"px",height:ja+"px",clip:"rect(0px "+ma+"px "+ja+"px 0px)"});q.set(S,"width",ma);q.set(S,"height",ja);this._surface.declaredClass||y.forEach(S.childNodes,function(xa){q.set(xa,"width",ma);q.set(xa,"height",ja)});X.loaded&&
(X.graphics.suspended||(X.graphics._resized=!0),y.forEach(X.graphicsLayerIds,function(xa){oa=X.getLayer(xa);oa.suspended||(oa._resized=!0,oa._childLayer&&(oa._childLayer._resized=!0));oa._updateSVGFilters(null,null,ma,ja)}),X.graphics._updateSVGFilters(null,null,ma,ja),X._labels&&X._labels._updateSVGFilters(null,null,ma,ja))},_cleanUp:function(){y.forEach(this._connects,D.disconnect,D);this._map=this._surface=null},_processEvent:function(S){var ma=this._map;S.screenPoint=new E(S.pageX-ma.position.x,
S.pageY-ma.position.y);S.mapPoint=ma.toMap(S.screenPoint)},_canvasDownHandler:function(S){this._processEvent(S);this._downPt=S.screenPoint.x+","+S.screenPoint.y},_canvasUpHandler:function(S){this._processEvent(S);this._upPt=S.screenPoint.x+","+S.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(S,ma,ja,X){if(!S.visible||!ma)return!1;var oa=ma.getTransformedBoundingBox();if(oa){var xa=new G(oa[0].x,oa[0].y,oa[2].x,oa[2].y);delete xa.spatialReference;return Y?xa.intersects(ja):xa.contains(X)}return y.some(ma.children||
[],function(Ha){oa=Ha.getTransformedBoundingBox();xa=new G(oa[0].x,oa[0].y,oa[2].x,oa[2].y);delete xa.spatialReference;return Y?xa.intersects(ja):xa.contains(X)})},_canvasClickHandler:function(S){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(S);var ma=this._map,ja=y.map(ma.graphicsLayerIds,function(Ca){return ma.getLayer(Ca)});ja.push(ma.graphics);ja.reverse();ja=y.filter(ja,function(Ca){return Ca.loaded&&!Ca.hasWebGLSurface()&&Ca._mouseEvents&&!Ca.suspended&&(!t.isDefined(Ca.opacity)||
0<Ca.opacity)});var X=S.screenPoint,oa=this._tolerance,xa=X.x-oa,Ha=X.y+oa,Ia=X.x+oa;oa=X.y-oa;var ia=new G(xa,oa,Ia,Ha);xa=ma.toMap(new E(xa,Ha));Ia=ma.toMap(new E(Ia,oa));Ha=xa.spatialReference._getInfo();var ea=new G(G.prototype._normalizeX(xa.x,Ha).x,xa.y,G.prototype._normalizeX(Ia.x,Ha).x,Ia.y,xa.spatialReference),za;delete ia.spatialReference;y.some(ja,function(Ca){Ca=y.filter(Ca.graphics,function(ka){return this._isPrimaryMatch(ka,ka.getDojoShape(),ia,X)||!(!ka._bgShape||!this._isPrimaryMatch(ka,
ka._bgShape,ia,X))},this);Ca.reverse();if(0<Ca.length){var Da;y.some(Ca,function(ka){return ka.geometry&&ea.intersects(ka.geometry)?(Da=ka,!0):!1});if(Da)return za=Da,!0}return!1},this);za&&(ja=za.getLayer())&&(S.graphic=za,ja.onClick(S))}}});h=m(h,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:P,webglEnabled:V,renderer:null,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},_suspendGraphics:!1,constructor:function(S,ma){S=
S||{};if(z.isString(S)||z.isObject(S)&&(S.layerDefinition||S.query))S=ma;this._params=z.mixin({displayOnPan:!0,drawMode:!0,styling:!0},S);var ja=this._params.dataAttributes;"string"===typeof ja&&(ja=[ja]);this.styling=ba?this._params.styling:!0;this.dataAttributes=ja;this.infoTemplate=S&&S.infoTemplate;this.graphics=[];this._draw=z.hitch(this,this._draw);this._refresh=z.hitch(this,this._refresh);this._acquireSVGMarker=z.hitch(this,this._acquireSVGMarker);this._evalSurfaceType=z.hitch(this,this._evalSurfaceType);
this._setSurfaceType=z.hitch(this,this._setSurfaceType);this.setWebGLEnabled(null!=this._params.webglEnabled?this._params.webglEnabled:this.webglEnabled);this.registerConnectEvents()},getNode:function(){return this._div&&this._div.getEventSource()},setDrawMode:function(S){this._params.drawMode=S},suspendGraphics:function(S){this._suspendGraphics=S;y.forEach(this.graphics,function(ma){ma._suspended=S})},setWebGLEnabled:function(S){var ma=this.webglEnabled;this.webglEnabled=(S||!1)&&V;ma!==this.webglEnabled&&
(this._evalSurfaceType(),this.onWebGLEnabledChange())},hasWebGLSurface:function(){return"webgl"===this.surfaceType},_getSurfaceType:function(S){return S&&"webgl"===S.surfaceType?"webgl":P},_evalSurfaceType:function(S){V&&(S?this._setSurfaceType():null==this._evalSurfaceTimerHandle&&(this._evalSurfaceTimerHandle=setTimeout(this._setSurfaceType,0)))},_hasPendingSurfaceEval:function(){return!!this._evalSurfaceTimerHandle},_setSurfaceType:function(){clearTimeout(this._evalSurfaceTimerHandle);this._evalSurfaceTimerHandle=
null;var S=this._canUseWebGLSurface()?"webgl":P;this.surfaceType!==S?(this.surfaceType=S,this._handleSurfaceChange(),this.onSurfaceChange()):this._pendingRedraw&&this._redraw()},_handleSurfaceChange:function(){this._cancelWebGLDepsLoad();this._webglDepsPromise=this._prepareToAttach(this._map);this._webglDepsPromise.always(z.hitch(this,function(S){this._webglDepsPromise=null;S&&"cancel"===S.dojoType||this._evalSurface()}))},_cancelWebGLDepsLoad:function(){this._webglDepsPromise&&!this._webglDepsPromise.isFulfilled()&&
this._webglDepsPromise.cancel();this._webglDepsPromise=null},_evalSurface:function(){var S=this._map,ma=this._div;S&&ma&&this._getSurfaceType(ma)!==this.surfaceType&&(S._detachGraphicsLayer(this),S._attachGraphicsLayer(this))},_canUseWebGLSurface:function(S){S=S||this._map;return this.webglEnabled&&(!S||S.webglEnabled&&(S.ownsWebGLContext(this)||S.isWebGLContextAvailable()))&&this._params.drawMode&&this._isWebGLCompatible()},_isWebGLCompatible:function(){return!1},_prepareToAttach:function(S){var ma=
new a;!this.webglDeps&&this._canUseWebGLSurface(S)?F(["./support/webglDeps"],z.hitch(this,function(ja){this.webglDeps=ja;ma.isFulfilled()||ma.resolve()})):ma.resolve();return ma.promise},_setMap:function(S,ma){this.inherited(arguments);this._map=S;this._evalSurfaceType(!0);this._webglChangeMapHandle=S.on("webgl-enabled-change",z.hitch(this,function(){this._evalSurfaceType()}));this._wrap=S.wrapAround180;this._srInfo=S.spatialReference._getInfo();this._svgFilters={};this._lineMarkers={};if(this.hasWebGLSurface())S.acquireWebGLContext(this),
this._div=S._gc._webglSurface.createRenderer(this.webglDeps.WebGLRenderer,S.width,S.height,this);else{if("svg"===this.surfaceType)if(ya){ma=e.createSurface(ma.getEventSource(),S.width,S.height);var ja=ma.getEventSource();f.set(ja,{position:"absolute",overflow:"visible",pointerEvents:"none"});S._gc._useWillChange&&f.set(ja,"will-change","transform");this._div=ma.createGroup();f.set(this._div.getEventSource(),"pointer-events","auto")}else this._div=ma.createGroup();else ma=e.createSurface(ma.getEventSource(),
S.width,S.height),f.set(ma.rawNode,"position","absolute"),this._div=ma.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=z.hitch(this,this._canvasRender);this._bgGroup=this._div.createGroup()}this._div.getEventSource().id=this.id+"_layer";this._initOpacity();return this._div},_unsetMap:function(S,ma){S.releaseWebGLContext(this);"webgl"===this._div.surfaceType?S._gc._webglSurface.destroyRenderer(this._div):(y.forEach(this.graphics,function(ja){ja._shape=null}),
"svg"===this.surfaceType?ya?(ma=this._div.parent,this._div.clear(),ma.remove(this._div),n.destroy(this._div.getEventSource()),n.destroy(ma.getEventSource())):(this._div.clear(),ma.remove(this._div),n.destroy(this._div.getEventSource())):(ma=this._div.getParent(),ma._parent={},n.destroy(ma.rawNode),ma.destroy()));this._map=this._div=this._svgFilters=this._lineMarkers=null;this._pendingRedraw=!1;clearTimeout(this._wakeTimer);this._wakeTimer=null;clearTimeout(this._evalSurfaceTimerHandle);this._evalSurfaceTimerHandle=
null;this._webglChangeMapHandle&&this._webglChangeMapHandle.remove();this._cancelWebGLDepsLoad();this._disableDrawConnectors();this.inherited(arguments)},_initOpacity:function(){var S=this.opacity;t.isDefined(S)&&1>S&&this.setOpacity(S,!0)},_onZoomStartHandler:function(){this.hasWebGLSurface()||x.hide(this._div.getEventSource())},_onExtentChangeHandler:function(S,ma,ja,X){clearTimeout(this._wakeTimer);this._wakeTimer=null;ja?(S=this._map.__visibleRect,ma=this._div,this._evalSDRenderer(),this._refresh(!0),
this._params._child||this._updateTransform(ma,S.x,S.y,!0),this._renderProto&&ma.surface.pendingRender?this._dirty=!0:this.suspended||x.show(ma.getEventSource())):this._resized&&(this._resized=!1,this._refresh(!1));if(0<this.graphics.length)this.onUpdate()},_canvasRender:function(){var S=this._div;this._dirty&&(delete this._dirty,this.suspended||x.show(S.getEventSource()));return this._renderProto.apply(S,arguments)},_refresh:function(S){if(!this.hasWebGLSurface()){var ma=this.graphics,ja=ma.length,
X,oa=this._draw;for(X=0;X<ja;X++)oa(ma[X],S)}},refresh:function(){this._refresh(!0)},_redraw:function(){this._pendingRedraw=!1;this.hasWebGLSurface()?this._div&&this._div.redraw():this._refresh(!0)},redraw:function(){this._hasPendingSurfaceEval()?this._pendingRedraw=!0:this._redraw()},hasLocalNavigationTransform:function(){return!(this._map&&this._map._gc._useGlobalTransform)},getNavigationTransform:function(){var S={dx:0,dy:0};this._map&&(this.hasLocalNavigationTransform()?this._div&&!this.hasWebGLSurface()&&
(S=this._div.getTransform()):S=this._map._gc._getTransform());return S},_onPanHandler:function(S,ma){this._panDx=ma.x;this._panDy=ma.y;var ja=this._map.__visibleRect;this._updateTransform(this._div,ja.x+ma.x,ja.y+ma.y);N&&this._updateSVGMarkers()},_onPanEndUpdateHandler:function(S,ma){var ja=this._map.__visibleRect;this._params._child||ma.x===this._panDx&&ma.y===this._panDy?(this._updateSVGFilters(-ja.x,-ja.y),this._updateSVGMarkers()):this._updateTransform(this._div,ja.x,ja.y,!0);this._refresh(!1);
if(this.graphics.length)this.onUpdate()},_onPanStartHandler:function(){x.hide(this._div.getEventSource())},_onPanEndHandler:function(){var S=this._map.__visibleRect,ma=this._div;this._updateTransform(ma,S.x,S.y,!0);this._refresh(!1);this._renderProto&&ma.surface.pendingRender?this._dirty=!0:x.show(ma.getEventSource());if(this.graphics.length)this.onUpdate()},_updateTransform:function(S,ma,ja,X){this.hasWebGLSurface()||(this.hasLocalNavigationTransform()?S.setTransform(b.translate({x:ma,y:ja})):ya&&
f.set(this._div.parent.getEventSource(),w._css.names.transform,w._css.translate(ma,ja)),X&&(this._updateSVGFilters(-ma,-ja),this._updateSVGMarkers()))},onSuspend:function(){this.inherited(arguments);x.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(S){this.inherited(arguments);S.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(z.hitch(this,function(){this.suspended||
this._map.__zooming||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var S=this._map,ma=D.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||(this._onPanHandler_connect=ma(S,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=ma(S,"onPanEnd",this,"_onPanEndUpdateHandler")):(this._onPanStartHandler_connect=ma(S,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=ma(S,"onPanEnd",this,"_onPanEndHandler"));
this._onZoomStartHandler_connect=ma(S,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=ma(S,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var S=D.disconnect;S(this._onExtentChangeHandler_connect);S(this._onZoomStartHandler_connect);S(this._onPanHandler_connect);S(this._onPanStartHandler_connect);S(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=
this._onPanEndHandler_connect=null},_updateExtent:function(S){var ma=S.geometry;if(!ma)S._extent=null;else if(!(S._extent=ma.getExtent())){if("esri.geometry.Point"===ma.declaredClass){var ja=ma.x;var X=ma.y}else if("esri.geometry.Multipoint"===ma.declaredClass)ja=ma.points[0][0],X=ma.points[0][1];else{S._extent=null;return}S._extent=new G(ja,X,ja,X,ma.spatialReference)}},_intersects:function(S,ma,ja){var X=S.spatialReference,oa=ma.spatialReference,xa=X&&oa&&!X.equals(oa)&&X._canProject(oa)&&4326===
oa.wkid;if(this._wrap&&!ja){ja=[];X=S._getFrameWidth();var Ha=this._srInfo,Ia=S._clip?S._getAvailExtent():S.extent,ia,ea=[];var za=ma._partwise;xa&&(Ia=S.geographicExtent,Ha=oa._getInfo());S=Ia._getParts(Ha);if(za&&za.length)for(ma=[],oa=0,xa=za.length;oa<xa;oa++)ma=ma.concat(za[oa]._getParts(Ha));else ma=ma._getParts(Ha);oa=0;for(xa=ma.length;oa<xa;oa++){var Ca=ma[oa];Ha=0;for(Ia=S.length;Ha<Ia;Ha++){var Da=S[Ha];if(Da.extent.intersects(Ca.extent))for(za=0,ia=Ca.frameIds.length;za<ia;za++)ja.push((Da.frameIds[0]-
Ca.frameIds[za])*X)}}oa=0;for(xa=ja.length;oa<xa;oa++)za=ja[oa],y.indexOf(ja,za)===oa&&ea.push(za);return ea.length?ea:null}return(xa?S.geographicExtent:S.extent).intersects(ma)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(S,ma){if(!this.hasWebGLSurface()&&this._params.drawMode&&this._map&&!this.suspended&&!this._map.__zooming&&!this._resized)try{var ja=S._extent,X,oa,xa=!ba||this.styling,Ha=ba&&this.dataAttributes,Ia=S.getDojoShape(),
ia;if(!S._suspended&&S.visible&&ja&&(X=this._intersects(this._map,ja,S.geometry._originOnly))&&(oa=xa?this._getSymbol(S):this._defaultMarker)){if(S._offsets&&S._offsets.join(",")===X.join(",")?ia=!0:S._offsets=X,!Ia||ma||!ia){var ea=S.geometry.type;ja={graphic:S};var za=S._bgShape,Ca=xa&&!S.symbol?this._getRenderer(S):null,Da=Ca&&Ca.backgroundFillSymbol;if("point"===ea)this._isInvalidShape(oa,Ia)&&this._removeShape(S),S._shape=this._drawPoint(this._div,S.geometry,oa,S.getDojoShape(),X,Ca,S),xa&&this._symbolizePoint(S.getDojoShape(),
oa,Ca,S);else if("multipoint"===ea)this._drawMarkers(S,oa,X,Ca),xa&&this._symbolizeMarkers(S,oa,Ca);else{var ka;ea=oa;var ta;xa&&(ea=(ka="simplemarkersymbol"===oa.type||"picturemarkersymbol"===oa.type||"textsymbol"===oa.type?oa:null)?Da:oa);if(xa&&ea&&-1<ea.type.indexOf("fillsymbol")){var M=this._bgGroup;var Ga=!(!M||!ka)}za&&!Ga&&this._removeBgShape(S);if(ea){!Ga&&(this._isInvalidShape(ea,S._shape)||S._shape&&S._shape._isCentroidMarker)&&this._removeShape(S,!1);if(ta=this._drawShape(S,X,M||this._div,
Ga?za:S.getDojoShape()))ta._isCentroidMarker=!1;xa&&this._symbolizeShape(ta,ea,Ca,ea===Da,S);S[Ga?"_bgShape":"_shape"]=ta}if(ka){(this._isInvalidShape(ka,S._shape)||S._shape&&!S._shape._isCentroidMarker)&&this._removeShape(S,!1);var La=S.geometry.getCentroid();if(ta=La&&this._drawPoint(this._div,La,ka,S._shape,X,Ca,S))ta._isCentroidMarker=!0,this._symbolizePoint(ta,ka,Ca,S);S._shape=ta}}T||(S._bgShape&&this._initNode(S,S._bgShape,S._bgShape!==za,ja,Ha),S._shape&&this._initNode(S,S._shape,S._shape!==
Ia,ja,Ha));S._applyDataAttrs();ja.node=S.getNode();this.onGraphicDraw(ja)}}else Ia&&this._removeShape(S)}catch(aa){this._errorHandler(aa,S)}},_initNode:function(S,ma,ja,X,oa){if(ma=ma&&ma.getNode())ma.e_graphic=S,this._addDataAttrs(S,oa,ma),ja&&(X.node=ma,this.onGraphicNodeAdd(X))},_removeShape:function(S,ma,ja){var X=S.getDojoShape(),oa=X&&X.getNode();X&&!ja&&(X.removeShape(),X.destroy());S._shape=S._offsets=null;!1!==ma&&this._removeBgShape(S,ja);if(oa&&(oa.e_graphic=null,!T))this.onGraphicNodeRemove({graphic:S,
node:oa})},_removeBgShape:function(S,ma){var ja=S._bgShape,X=ja&&ja.getNode();ja&&!ma&&(ja.removeShape(),ja.destroy());S._bgShape=null;if(X&&(X.e_graphic=null,!T))this.onGraphicNodeRemove({graphic:S,node:X})},_addDataAttrs:function(S,ma,ja){var X=S.attributes,oa,xa=ma?ma.length:0,Ha=this._getRenderer(S);if(ja&&X){for(oa=0;oa<xa;oa++)(ja=ma[oa])&&S.attr("data-"+ja,X[ja]);!this.styling&&Ha&&(Ha.getBreakIndex?(ma=Ha.getBreakIndex(S),S.attr("data-class-break",-1!==ma?ma:null)):Ha.getUniqueValueInfo&&
(ma=Ha.getUniqueValueInfo(S),S.attr("data-unique-value",ma?ma.value:null)))}},_drawShape:function(S,ma,ja,X){S=S.geometry;var oa=S.type,xa=this._map,Ha=xa.extent,Ia=xa.width,ia=xa.height;xa=xa.__visibleRect;var ea=[],za;var Ca="extent"===oa;if("rect"===oa||Ca)ea={x:0,y:0,spatialReference:S.spatialReference},ea.x=Ca?S.xmin:S.x,ea.y=Ca?S.ymax:S.y,oa=L.toScreenPoint(Ha,Ia,ia,ea),ea.x=Ca?S.xmax:S.x+S.width,ea.y=Ca?S.ymin:S.y+S.height,S=L.toScreenPoint(Ha,Ia,ia,ea),ma={x:oa.x-xa.x+ma[0],y:oa.y-xa.y,width:Math.abs(S.x-
oa.x),height:Math.abs(S.y-oa.y)},0===ma.width&&(ma.width=1),0===ma.height&&(ma.height=1),X=this._drawRect(ja,X,ma);else if("polyline"===oa||"polygon"===oa){Ca=0;for(za=ma.length;Ca<za;Ca++)ea=ea.concat(L._toScreenPath(Ha,Ia,ia,S,-xa.x+ma[Ca],-xa.y));X=this._drawPath(ja,X,ea);this._rendererLimits&&("polyline"===oa?this._clipPolyline(X,S):this._clipPolygon(X,S))}return X},_drawRect:function(S,ma,ja){return ma?ma.setShape(ja):S.createRect(ja)},_drawImage:function(S,ma,ja){return ma?ma.setShape(ja):S.createImage(ja)},
_drawCircle:function(S,ma,ja){return ma?ma.setShape(ja):S.createCircle(ja)},_drawPath:function(){return J?function(S,ma,ja,X){ja=X?ja:ja.join(" ");if(ma)return ma.setShape(ja);ma=S.createObject(X?e.Path:e.EsriPath,ja);S._overrideSize(ma.getEventSource());return ma}:function(S,ma,ja,X){ja=X?ja:ja.join(" ");return ma?ma.setShape(ja):S.createPath(ja)}}(),_drawText:function(S,ma,ja){return ma?ma.setShape(ja):S.createText(ja)},_evalSDRenderer:function(S){var ma=this._map,ja=this.renderer,X,oa=this._rndForScale;
ma&&ma.loaded&&ja&&ja.getRendererInfo&&(X="zoom"===ja.rangeType?ja.getRendererInfoByZoom(ma.getZoom()):ja.getRendererInfoByScale(ma.getScale()));this._rndForScale=X&&X.renderer;S||this._rndForScale==oa||this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(S){var ma=this._rndForScale||this.renderer;S&&ma&&ma.getObservationRenderer&&(ma=ma.getObservationRenderer(S));return ma},_getSymbol:function(S){var ma=this._getRenderer();return S.symbol||ma&&ma.getSymbol(S)},_getVariable:function(S,
ma,ja){if(S)var X=(S=S.getVisualVariablesForType(ma,ja))&&S[0];return X},_applyOpacity:function(S,ma,ja,X){ma=ma.getOpacity(X,{opacityInfo:ja});null!=ma&&(S=new u(S),S.a=ma);return S},_symbolizeShape:function(S,ma,ja,X,oa){var xa=ma.getStroke(),Ha=ma.getFill(),Ia=ma.type,ia=-1!==Ia.indexOf("linesymbol"),ea=-1!==Ia.indexOf("fillsymbol")?null:this._getVariable(ja,"sizeInfo",!1),za=this._getVariable(ja,"colorInfo",!1),Ca=this._getVariable(ja,"opacityInfo",!1),Da=ia?"none"!==ma.style:ma.outline&&"none"!==
ma.outline.style,ka=ia?null:this._getVariable(ja,"sizeInfo","outline");ea=(ea=X?ka:ka||ea)?ja.getSize(oa,{sizeInfo:ea,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;X&&(za=Ca=null);if((za||Ca)&&"picturefillsymbol"!==Ia)if(ia){var ta=xa&&xa.color;za&&(ta=ja.getColor(oa,{colorInfo:za})||ta);ta&&Ca&&(ta=this._applyOpacity(ta,ja,Ca,oa))}else if(Ha&&Ha.toCss){var M=Ha;za&&(M=ja.getColor(oa,{colorInfo:za})||M);M&&Ca&&(M=this._applyOpacity(M,ja,Ca,oa))}S.setStroke(!Da||null==
ea&&!ta?xa:z.mixin({},xa,null!=ea?{width:ea}:null,ta&&{color:ta})).setFill(M||Ha);ia&&A.applyLineMarker(S,ma,ta,this._acquireSVGMarker)},_smsToPath:function(){return J?function(S,ma,ja,X,oa,xa,Ha,Ia,ia){switch(ma){case S.STYLE_SQUARE:return["M",oa+","+Ha,"L",xa+","+Ha,xa+","+Ia,oa+","+Ia,"X","E"];case S.STYLE_CROSS:return["M",ja+","+Ha,"L",ja+","+Ia,"M",oa+","+X,"L",xa+","+X,"E"];case S.STYLE_X:return["M",oa+","+Ha,"L",xa+","+Ia,"M",oa+","+Ia,"L",xa+","+Ha,"E"];case S.STYLE_DIAMOND:return["M",ja+
","+Ha,"L",xa+","+X,ja+","+Ia,oa+","+X,"X","E"];case S.STYLE_TARGET:return["M",oa+","+Ha,"L",xa+","+Ha,xa+","+Ia,oa+","+Ia,oa+","+Ha,"M",oa-ia+","+X,"L",oa+","+X,"M",ja+","+(Ha-ia),"L",ja+","+Ha,"M",xa+ia+","+X,"L",xa+","+X,"M",ja+","+(Ia+ia),"L",ja+","+Ia,"E"]}}:function(S,ma,ja,X,oa,xa,Ha,Ia,ia){switch(ma){case S.STYLE_SQUARE:return["M",oa+","+Ha,xa+","+Ha,xa+","+Ia,oa+","+Ia,"Z"];case S.STYLE_TRIANGLE:return["M",ja+","+Ha,xa+","+Ia,oa+","+Ia,"Z"];case S.STYLE_CROSS:return["M",ja+","+Ha,ja+","+
Ia,"M",oa+","+X,xa+","+X];case S.STYLE_X:return["M",oa+","+Ha,xa+","+Ia,"M",oa+","+Ia,xa+","+Ha];case S.STYLE_DIAMOND:return["M",ja+","+Ha,xa+","+X,ja+","+Ia,oa+","+X,"Z"];case S.STYLE_TARGET:return S=["M",oa+","+Ha,xa+","+Ha,xa+","+Ia,oa+","+Ia,oa+","+Ha],ia&&S.push("M",oa-ia+","+X,oa+","+X,"M",ja+","+(Ha-ia),ja+","+Ha,"M",xa+ia+","+X,xa+","+X,"M",ja+","+(Ia+ia),ja+","+Ia),S}}}(),_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",
simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(S,ma){var ja=ma&&ma.shape&&ma.shape.type,X=S&&S.type,oa=S&&S.style;"rect"===ja&&(ja="path");X&&(oa=this._typeMaps[X]||oa);this._pathStyles[oa]&&(oa="path");return"shieldlabelsymbol"===X?!0:!(!ja||!oa||ja===oa)},_reArialFont:/\s*(^|,)\s*arial\s*(,|$)\s*/i,_fallbackFont:"Arial",_drawPoint:function(S,ma,ja,X,oa,xa,Ha){var Ia=ja.type,ia=this._map,ea=ia.__visibleRect,za=L.toScreenPoint(ia.extent,
ia.width,ia.height,ma).offset(-ea.x+oa[0],-ea.y);ea=za.x;var Ca=za.y;ma=[];var Da=this._getVariable(xa,"rotationInfo",!1);Da=Da?xa.getRotationAngle(Ha,{rotationInfo:Da}):null;var ka=this._getVariable(xa,"sizeInfo",!1);ia=null!=Ha.size?Ha.size:ka&&xa.getSize(Ha,{sizeInfo:ka,shape:ja.style,resolution:ia.getResolutionInMeters(),scale:ia.getScale()});Da&&ma.push(b.rotategAt(Da,za));if(0!==ja.xoffset||0!==ja.yoffset){var ta=b.translate(ja.xoffset,-ja.yoffset);ma.push(ta)}0!==ja.angle&&ma.push(b.rotategAt(ja.angle,
za));if("simplemarkersymbol"===Ia){var M=ja.style;xa=Math.round;null!=ia?ta&&(null!=ta.dx&&(ta.dx=ta.dx/ja.size*ia),null!=ta.dy&&(ta.dy=ta.dy/ja.size*ia)):ia=ja.size;switch(M){case v.STYLE_SQUARE:case v.STYLE_TRIANGLE:case v.STYLE_CROSS:case v.STYLE_X:case v.STYLE_DIAMOND:ja=isNaN(ia)?16:ia/2;M=this._drawPath(S,X,this._smsToPath(v,M,ea,Ca,xa(ea-ja),xa(ea+ja),xa(Ca-ja),xa(Ca+ja)));break;case v.STYLE_TARGET:Ha=ja._targetWidth/2;ta=ja._targetHeight/2;M=this._drawPath(S,X,this._smsToPath(v,M,ea,Ca,xa(ea-
Ha),xa(ea+Ha),xa(Ca-ta),xa(Ca+ta),ja._spikeSize));break;case v.STYLE_PATH:M=this._drawPath(S,X,ja.path,!0);ja=M.getBoundingBox();S=this._getScaleMatrix(ja,ia);1===S.xx&&1===S.yy||ma.push(b.scaleAt(S.xx,S.yy,za));ma.push(b.translate(-(ja.x+ja.width/2)+ea,-(ja.y+ja.height/2)+Ca));break;default:ja=isNaN(ia)?16:ia/2,M=this._drawCircle(S,X,{cx:ea,cy:Ca,r:ja})}}else if("shieldlabelsymbol"===Ia)M=ja.width,za=ja.height,X=S.createGroup(),M=S.createImage({x:ea-M/2,y:Ca-za/2,width:M,height:za,src:ja.url}),X.add(M),
null!=ja.font&&(Ca+=.2*ja.getHeight(),S=S.createText({type:"text",text:ja.text,x:ea,y:Ca,align:"middle",decoration:ja.decoration,rotated:ja.rotated,kerning:ja.kerning}),S.setFont(ja.font),S.setFill(ja.color),X.add(S)),M=X;else if("picturemarkersymbol"===Ia){if(null==ia?(M=ja.width,za=ja.height):(za=ia,M=ja.width/ja.height*za,ta&&(null!=ta.dx&&(ta.dx=ta.dx/ja.width*M),null!=ta.dy&&(ta.dy=ta.dy/ja.height*za))),M=this._drawImage(S,X,{x:ea-M/2,y:Ca-za/2,width:M,height:za,src:ja.url}),ba&&(S=M.getNode()))ja=
(ja=this._getVariable(xa,"opacityInfo",!1))?xa.getOpacity(Ha,{opacityInfo:ja}):null,null!=ja?S.setAttribute("opacity",ja):S.setAttribute("opacity",1)}else if("textsymbol"===Ia){if(xa=ja.font){M=null!=ia;Ha=xa.family&&!this._reArialFont.test(xa.family);if(M||Ha||T)xa=new xa.constructor(xa.toJson());M&&xa.setSize(ia);T&&(xa.size+="px");Ha&&xa.setFamily(xa.family+","+this._fallbackFont)}M=this._drawText(S,X,{type:"text",text:ja.text,x:ea,y:Ca,align:ja.getSVGAlign(),decoration:ja.decoration||xa&&xa.decoration,
rotated:ja.rotated,kerning:ja.kerning});xa&&M.setFont(xa);ba&&(S=M.getNode(),ea=ja.getSVGBaseline(),Ca=ja.getSVGBaselineShift(),S&&(S.setAttribute("dominant-baseline",ea),Ca&&S.setAttribute("baseline-shift",Ca),this._applyHalo(M,ja.haloColor,ja.haloSize)))}M.setTransform(b.multiply(ma));M._wrapOffsets=oa;return M},_acquireSVGMarker:function(S,ma,ja,X){S=this._getSVGMarkerId(ma,X);var oa=this._getSVGMarker(S);oa||(oa=A.createSVGMarker(ma,S,ja,X),this._div.getParent().defNode.appendChild(oa),this._lineMarkers[S]=
oa);return oa},_getSVGMarkerId:function(S,ma){return"marker_"+this._map.id+"_"+S.r+"_"+S.g+"_"+S.b+"_"+ma},_getSVGMarker:function(S){return this._lineMarkers[S]},_updateSVGMarkers:function(){if(ba&&Z){var S=this._lineMarkers,ma;for(ma in S){var ja=S[ma];ja.setAttribute("id",ma+"_temp");ja.setAttribute("id",ma)}}},_applyHalo:function(S,ma,ja){var X=ma&&ja?this._getHaloId(ma,ja):null;S.setFilter(ma&&ja?C("webkit")||C("ff")?this._getDilateFilter(ma,ja,X):this._getOffsetFilter(ma,ja,X):null)},_getDilateFilter:function(S,
ma,ja){var X=this._getSVGFilter(ja);X||(X=this._createSVGFilter({id:ja},[c.feMorphology({operator:"dilate",radius:ma,result:"dilated"}),c.feFlood({"flood-color":S.toCss(!0)}),c.feComposite({in2:"dilated",operator:"in",result:"composite"}),c.feMerge("composite","SourceGraphic")]));return X},_getOffsetFilter:function(S,ma,ja){var X=this._getSVGFilter(ja);if(!X){S=S.toCss(!0);X=this._offsetPrimitives;var oa,xa=X.length,Ha=[],Ia=[];for(oa=0;oa<xa;oa++){var ia=X[oa],ea="offset"+ia.dir,za="composite"+ia.dir;
Ia.push(za);Ha.push(c.feOffset({dx:ia.dx*ma,dy:ia.dy*ma,"in":"SourceAlpha",result:ea}),c.feFlood({"flood-color":S}),c.feComposite({in2:ea,operator:"in",result:za}))}Ia.push("SourceGraphic");Ha.push(c.feMerge.apply(c.feMerge,Ia));X=this._createSVGFilter({id:ja},Ha)}return X},_offsetPrimitives:[{dir:"L",dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(S,ma){return"halo_"+
this._map.id+"_"+this.id+"_"+S.r+"_"+S.g+"_"+S.b+"_"+S.a+"_"+ma},_getSVGFilter:function(S){return this._svgFilters[S]},_createSVGFilter:function(S,ma){var ja=c.createFilter(S,ma),X=this._map,oa=X.__visibleRect;ja.x=-oa.x;ja.y=-oa.y;ja.width=X.width;ja.height=X.height;return this._svgFilters[S.id]=ja},_updateSVGFilters:function(S,ma,ja,X){var oa=this._svgFilters,xa,Ha,Ia;for(Ha in oa)if(xa=oa[Ha]){if(Ia=d.byId(Ha))null!=S&&Ia.setAttribute("x",S),null!=ma&&Ia.setAttribute("y",ma),null!=ja&&Ia.setAttribute("width",
ja),null!=X&&Ia.setAttribute("height",X);null!=S&&(xa.x=S);null!=ma&&(xa.y=ma);null!=ja&&(xa.width=ja);null!=X&&(xa.height=X)}},_getScaleMatrix:function(S,ma){var ja=S.width/S.height,X=1,oa=1;isNaN(ma)||(1<ja?(X=ma/S.width,oa=ma/ja/S.height):(oa=ma/S.height,X=ma*ja/S.width));return{xx:X,yy:oa}},_symbolizePoint:function(S,ma,ja,X){var oa=ma.type,xa=ma.style;if("shieldlabelsymbol"!==oa&&"picturemarkersymbol"!==oa){var Ha=ma.getStroke();ma=ma.getFill();xa=xa===v.STYLE_X||xa===v.STYLE_CROSS;var Ia=Ha&&
Ha.color,ia=xa?Ia:ma;if(ja){var ea=this._getVariable(ja,"colorInfo",!1),za=this._getVariable(ja,"opacityInfo",!1);ea&&(ia=ja.getColor(X,{colorInfo:ea})||ia);ia&&za&&(ia=this._applyOpacity(ia,ja,za,X));ia&&(xa?ia!==Ia&&(Ha=Ha?z.mixin({},Ha):{},Ha.color=ia):ia!==ma&&(ma=ia))}"textsymbol"===oa?S.setFill(ma):"simplemarkersymbol"===oa&&S.setFill(ma).setStroke(Ha)}},_drawMarkers:function(S,ma,ja,X){var oa=S.geometry,xa=oa.points,Ha=S.getDojoShape()||this._div.createGroup(),Ia,ia=xa.length,ea=[],za=0,Ca,
Da=ja?ja.length:0;Ha.children[0]&&this._isInvalidShape(ma,Ha.children[0])&&Ha.clear();for(Ia=0;Ia<ia;Ia++){var ka=xa[Ia];for(Ca=0;Ca<Da;Ca++)ea[0]=ja[Ca],this._drawPoint(Ha,{x:ka[0],y:ka[1],spatialReference:oa.spatialReference},ma,Ha.children[za++],ea,X,S)}ma=Ha.children.length;if(ia*ja.length<ma)for(Ia=ma-1;Ia>=ia*ja.length;Ia--)Ha.children[Ia].removeShape();S._shape=Ha},_symbolizeMarkers:function(S,ma,ja){var X=S.getDojoShape().children,oa,xa=X.length;for(oa=0;oa<xa;oa++)this._symbolizePoint(X[oa],
ma,ja,S)},_errorHandler:function(S,ma){ma&&(S.message="Unable to draw graphic (geometry:"+(ma.geometry?ma.geometry.declaredClass:null)+", symbol:"+(ma.symbol?ma.symbol.declaredClass:null)+"): "+S.message);this.inherited(arguments)},_rendererLimits:function(){if(J){var S=1E5;var ma=-1E5;var ja=1E5}else C("chrome")&&6>C("chrome")&&(S=8150,ma=-1E4,ja=1E4);if(S)return{clipLimit:S,rangeMin:ma,rangeMax:ja,clipBBox:[-S,-S,S,S],clipSegments:[[[-S,-S],[S,-S]],[[S,-S],[S,S]],[[S,S],[-S,S]],[[-S,S],[-S,-S]]]}}(),
_clipPolyline:function(S,ma){var ja=this._getCorners(S,ma),X=ja.br,oa=this._rendererLimits,xa=oa.rangeMin,Ha=oa.rangeMax,Ia=oa.clipBBox,ia=oa.clipSegments;oa=this._isPointWithinRange;var ea=this._isPointWithinBBox,za=this._getClipperIntersection,Ca=this._getPlaneIndex;if(!oa(ja.tl,xa,Ha)||!oa(X,xa,Ha)){J&&this._createSegments(S);var Da=[];y.forEach(S.segments,function(ka){ka=ka.args;var ta=ka.length,M=[],Ga;for(Ga=0;Ga<ta;Ga+=2){var La=[ka[Ga],ka[Ga+1]],aa=[ka[Ga+2],ka[Ga+3]],Ya=ea(La,Ia),Wa=ea(aa,
Ia);if(Ya^Wa){if(Wa=za([La,aa],ia))Ya?(Ga?M.push(Wa[1]):M.push(La,Wa[1]),Da.push(M),M=[]):M.push(Wa[1],aa)}else Ya?Ga?M.push(aa):M.push(La,aa):(Wa=Ca(La,Ia),Ya=Ca(aa,Ia),-1!==Wa&&-1!==Ya&&Wa!==Ya&&(La=za([La,aa],ia,!0),0<La.length&&(La[Wa]||(Wa=La[Wa[0]]?Wa[0]:Wa[1]),La[Ya]||(Ya=La[Ya[0]]?Ya[0]:Ya[1]),aa=La[Wa],La=La[Ya],aa&&M.push(aa),La&&(M.push(La),Da.push(M),M=[]))))}Da.push(M)});S.setShape(this._getPathStringFromPaths(Da))}},_clipPolygon:function(S,ma){var ja=this._getCorners(S,ma),X=ja.br,oa=
this._rendererLimits,xa=oa.clipLimit,Ha=oa.rangeMin,Ia=oa.rangeMax,ia=oa.clipBBox,ea=oa.clipSegments;oa=this._isPointWithinRange;var za=this._isPointWithinBBox,Ca=this._getClipperIntersection,Da=this._getPlaneIndex,ka=I._pointLineDistance;oa(ja.tl,Ha,Ia)&&oa(X,Ha,Ia)||(J&&this._createSegments(S),ja=y.filter(S.segments,function(ta){return ta.args&&ta.args.length}),ja=y.map(ja,function(ta){var M=ta.args,Ga=M.length,La=[];ta=[];var aa;for(aa=0;aa<Ga;aa+=2){var Ya=[M[aa],M[aa+1]],Wa=[M[aa+2],M[aa+3]];
if(aa===Ga-2){La.push(Ya);break}var Ea=za(Ya,ia),U=za(Wa,ia);La.push(Ya);if(Ea^U){if(U=Ca([Ya,Wa],ea))Ya=U[1],Ya[Ea?"inOut":"outIn"]=!0,La.push(Ya),ta.push([Ea?"INOUT":"OUTIN",La.length-1,U[0]])}else if(!Ea){Ea=Da(Ya,ia);var fa=Da(Wa,ia);-1!==Ea&&-1!==fa&&Ea!==fa&&(U=Ca([Ya,Wa],ea,!0),0<U.length?(U[Ea]||(Ea=U[Ea[0]]?Ea[0]:Ea[1]),U[fa]||(fa=U[fa[0]]?fa[0]:fa[1]),Ya=U[Ea],Wa=U[fa],Ya&&(Ya.outIn=!0,La.push(Ya),ta.push(["OUTIN",La.length-1,Ea])),Wa&&(Wa.inOut=!0,La.push(Wa),ta.push(["INOUT",La.length-
1,fa]))):z.isArray(Ea)&&z.isArray(fa)&&(U=Ea.concat(fa),U.sort(),"0123"===U.join("")&&(U=[],3===Ea[0]+Ea[1]?U.push([xa,-xa],[-xa,xa]):U.push([-xa,-xa],[xa,xa]),Ea=ka(U[0],[Ya,Wa]),Ya=ka(U[1],[Ya,Wa]),La.push(Ea<Ya?U[0]:U[1]))))}}var sa=ia[0],O=ia[1],ca=ia[2],va=ia[3];y.forEach(La,function(W){W[0]<sa&&(W[1]>=O&&W[1]<=va?W[0]=sa:(W[0]=sa,W[1]=W[1]<O?O:va))});y.forEach(La,function(W){W[1]<O&&(W[0]>=sa&&W[0]<=ca?W[1]=O:(W[1]=O,W[0]=W[0]<sa?sa:ca))});y.forEach(La,function(W){W[0]>ca&&(W[1]>=O&&W[1]<=va?
W[0]=ca:(W[0]=ca,W[1]=W[1]<O?O:va))});y.forEach(La,function(W){W[1]>va&&(W[0]>=sa&&W[0]<=ca?W[1]=va:(W[1]=va,W[0]=W[0]<sa?sa:ca))});M=0;Ga=ta.length;if(0<Ga){do{Wa=ta[M];aa=ta[(M+1)%Ga];if(Wa[2]===aa[2]&&"INOUT"===Wa[0]&&"OUTIN"===aa[0])if(Ya=Wa[1],aa=aa[1],Ya<aa)for(Ya+=1;Ya<aa;Ya++)La[Ya][2]=!0;else if(Ya>aa){for(Ya+=1;Ya<La.length;Ya++)La[Ya][2]=!0;for(Ya=0;Ya<aa;Ya++)La[Ya][2]=!0}M=(M+1)%Ga}while(0!==M)}Ga=La[0];M=La[La.length-1];Ga[2]&&(M[2]=!0,y.some(ta,function(W){return 1===W[1]?(La.splice(La.length-
1,0,z.clone(La[1])),!0):!1}));La=y.filter(La,function(W){return W[2]?!1:!0});for(M=0;M<La.length-1;M++)Ga=La[M],(aa=La[M+1])&&Ga[0]===aa[0]&&Ga[1]===aa[1]&&(aa.outIn?Ga.outIn=!0:aa.inOut&&(Ga.inOut=!0),La.splice(M+1,1));Ga=Math.abs;ta=[];for(M=0;M<La.length-1;M++){Wa=La[M];Ya=Wa[0];Wa=Wa[1];Ea=Ga(Ya)===xa;U=Ga(Wa)===xa;aa=La[M+1];fa=aa[0];aa=aa[1];var H=Ga(fa)===xa,R=Ga(aa)===xa;Ea&&R?ta.push([M+1,[Ya,aa]]):U&&H&&ta.push([M+1,[fa,Wa]])}for(M=ta.length-1;0<=M;M--)aa=ta[M],Ya=La[aa[0]-1],Ga=La[aa[0]],
Ya.outIn||Ya.inOut||Ga.outIn||Ga.inOut||La.splice(aa[0],0,aa[1]);Ga=La[0];M=La[La.length-1];Ga[0]===M[0]&&Ga[1]===M[1]||La.push(Ga);return La}),S.setShape(this._getPathStringFromPaths(ja)))},_getCorners:function(S,ma){if(J){var ja=this._map,X=ma.getExtent(),oa=X.spatialReference,xa=ja.toScreen(new B(X.xmin,X.ymax,oa));ja=ja.toScreen(new B(X.xmax,X.ymin,oa));return{tl:xa,br:ja}}xa=S.getTransformedBoundingBox();return{tl:xa[0],br:xa[2]}},_createSegments:function(S){S.shape.path=S.vmlPath;S.segmented=
!1;S._confirmSegmented();var ma=S.segments;1<ma.length&&(S.segments=y.filter(ma,function(ja,X,oa){X=oa[X+1];return"M"===ja.action&&X&&"L"===X.action?(ja.args=ja.args.concat(X.args),!0):!1}))},_getPathStringFromPaths:function(S){J?(S=y.map(S,function(ma){return"m "+y.map(ma,function(ja,X){return(1===X?"l ":"")+ja.join(",")}).join(" ")}),S.push("e")):S=y.map(S,function(ma){return"M "+y.map(ma,function(ja){return ja.join(",")}).join(" ")});return S.join(" ")},_isPointWithinBBox:function(S,ma){var ja=
ma[1],X=ma[2],oa=ma[3],xa=S[0],Ha=S[1];return xa>ma[0]&&xa<X&&Ha>ja&&Ha<oa?!0:!1},_isPointWithinRange:function(S,ma,ja){var X=S.x;S=S.y;return X<ma||S<ma||X>ja||S>ja?!1:!0},_getClipperIntersection:function(S,ma,ja){var X,oa=I._getLineIntersection2,xa=Math.round,Ha={length:0};for(X=0;4>X;X++){var Ia=oa(S,ma[X]);if(Ia)if(Ia[0]=xa(Ia[0]),Ia[1]=xa(Ia[1]),ja)Ha[X]=Ia,Ha.length++;else return[X,Ia]}return ja?Ha:null},_getPlaneIndex:function(S,ma){var ja=S[0],X=S[1],oa=ma[0],xa=ma[1],Ha=ma[2],Ia=ma[3];return ja<=
oa?X>=xa&&X<=Ia?3:X<xa?[0,3]:[2,3]:X<=xa?ja>=oa&&ja<=Ha?0:ja<oa?[3,0]:[1,0]:ja>=Ha?X>=xa&&X<=Ia?1:X<xa?[0,1]:[2,1]:X>=Ia?ja>=oa&&ja<=Ha?2:ja<oa?[3,2]:[1,2]:-1},onGraphicAdd:function(){},onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},onInfoTemplateChange:function(){},onSurfaceChange:function(){},onWebGLEnabledChange:function(){},setInfoTemplate:function(S){this.infoTemplate=
S;this._evalSurfaceType();this.onInfoTemplateChange()},add:function(S,ma){if(S._graphicsLayer===this)return S;S._suspended=this._suspendGraphics;ma||this.graphics.push(S);S._graphicsLayer=this;S._sourceLayer||(S._layer&&"esri.layers.GraphicsLayer"!==S._layer.declaredClass?S._sourceLayer=S._layer:"esri.layers.GraphicsLayer"!==this.declaredClass&&(S._sourceLayer=this));S._layer=this;this.hasWebGLSurface()||(this._updateExtent(S),this._draw(S));if(!ma)this.onGraphicAdd(S);return S},remove:function(S,
ma,ja){if(!ma&&!ja){ma=this.graphics;var X;if(-1===(X=y.indexOf(ma,S)))return null;if(!qa||64<=qa)ma.splice(X,1);else{var oa=ma.length;if(oa){for(;X<oa;)ma[X]=ma[X+1],X++;ma.length--}}}this.hasWebGLSurface()||S.getDojoShape()&&this._removeShape(S,null,ja);S._shape=S._graphicsLayer=null;this.onGraphicRemove(S);return S},clear:function(S,ma){var ja=this.graphics,X,oa=!J;for(X=ja.length-1;0<=X;X--)this.remove(ja[X],null,oa);this.graphics=[];this.hasWebGLSurface()||this._destroyAllNodes();if(!ma)this.onGraphicsClear()},
_destroyAllNodes:function(){if(!J&&this._div){var S;this._childLayer&&(S=this._childLayer.getNode())&&S.parentNode&&S.parentNode.removeChild(S);this._bgGroup.clear();this._div.clear();this._bgGroup=this._div.createGroup();S&&this._div.getEventSource().appendChild(S);this._initOpacity()}},clearNodes:function(){if(!this.hasWebGLSurface()){var S=this.graphics,ma=S.length,ja;for(ja=0;ja<ma;ja++)this._removeShape(S[ja],!0,!0);this._destroyAllNodes()}},_graphicVisibilityChanged:function(S){},_setIEOpacity:function(S,
ma){var ja=S&&S.getNode();if(ja){var X=S.strokeStyle,oa=ja.stroke;X&&oa&&(oa.opacity=X.color.a*ma);X=S.fillStyle;oa=ja.fill;X&&oa&&("tile"===oa.type?f.set(ja,"opacity",ma):oa.opacity=X.a*ma)}},setOpacity:function(S,ma){if(ma||this.opacity!=S){var ja=this._div;ja&&!this.hasWebGLSurface()&&(J?(y.forEach(this.graphics,function(X){this._setIEOpacity(X._shape,S);this._setIEOpacity(X._bgShape,S)},this),ja._esriIeOpacity=S,this._bgGroup._esriIeOpacity=S):"canvas-2d"===this.surfaceType?f.set(ja.getEventSource(),
"opacity",S):ja.getEventSource().setAttribute("opacity",S));this.opacity=S;if(!ma)this.onOpacityChange(S)}},setRenderer:function(S){this.renderer=S;this._evalSDRenderer(!0);this._evalSurfaceType();this.emit("renderer-change",{renderer:this._rndForScale||S})}});m=m([h,K],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this._processEvent=z.hitch(this,this._processEvent);this._initLayer()},_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var S=this.inherited("_setMap",
arguments);this.enableMouseEvents();return S},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",arguments)},_processEvent:function(S){var ma=this._map,ja=S.target,X;S.screenPoint=new E(S.pageX-ma.position.x,S.pageY-ma.position.y);for(S.mapPoint=ma.toMap(S.screenPoint);ja&&!(X=ja.e_graphic);)ja=ja.parentNode;if(X)return S.graphic=X,S},_onMouseOverHandler:function(S){if(this._processEvent(S))this.onMouseOver(S)},_onMouseMoveHandler:function(S){if(this._processEvent(S))this.onMouseMove(S)},
_onMouseDragHandler:function(S){if(this._processEvent(S))this.onMouseDrag(S)},_onMouseOutHandler:function(S){if(this._processEvent(S))this.onMouseOut(S)},_onMouseDownHandler:function(S){this._downGr=this._downPt=null;this._processEvent(S)&&(D.disconnect(this._onmousemove_connect),D.disconnect(this._onmousedrag_connect),this._onmousedrag_connect=D.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),this._downGr=S.graphic,this._downPt=S.screenPoint.x+","+S.screenPoint.y,this.onMouseDown(S))},
_onMouseUpHandler:function(S){this._upGr=this._upPt=null;this._processEvent(S)&&(D.disconnect(this._onmousedrag_connect),D.disconnect(this._onmousemove_connect),this._onmousemove_connect=D.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=S.graphic,this._upPt=S.screenPoint.x+","+S.screenPoint.y,this.onMouseUp(S))},_onClickHandler:function(S){if(this._processEvent(S)){var ma=this._downGr,ja=this._upGr;ma&&ja&&ma===ja&&this._downPt===this._upPt&&(J&&(w._ieGraphic=
S.graphic),this.onClick(S))}},_onDblClickHandler:function(S){if(this._processEvent(S))this.onDblClick(S)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var S=D.connect,ma=this._div.getEventSource();T||(this._onmouseover_connect=S(ma,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=S(ma,
"onmousemove",this,"_onMouseMoveHandler"),this._onmouseout_connect=S(ma,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=S(ma,"onmousedown",this,"_onMouseDownHandler"),this._onmouseup_connect=S(ma,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=S(ma,"onclick",this,"_onClickHandler"),this._ondblclick_connect=S(ma,"ondblclick",this,"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var S=D.disconnect;S(this._onmouseover_connect);
S(this._onmousemove_connect);S(this._onmousedrag_connect);S(this._onmouseout_connect);S(this._onmousedown_connect);S(this._onmouseup_connect);S(this._onclick_connect);S(this._ondblclick_connect);this._mouseEvents=!1}}});m._GraphicsContainer=g;m._GraphicsLayer=h;z.setObject("layers.GraphicsLayer",m,w);z.setObject("layers._GraphicsContainer",g,w);z.setObject("layers._GraphicsLayer",h,w);return m})},"esri/layers/gfxSniff":function(){define(["dojo/has","dojox/gfx"],function(F,m){F.add("esri-svg",function(){return-1!==
m.renderer.toLowerCase().indexOf("svg")});return F})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h){var g=F([q],{declaredClass:"esri.layers.Layer",_eventMap:{error:["error"],load:["layer"],"opacity-change":["opacity"],"update-end":["error"],
"visibility-change":["visible"]},constructor:function(k,w){this._attrs={};k&&D.isString(k)?this._url=b.urlToObject(this.url=b.normalize(k)):(this.url=this._url=null,(w=w||k)&&(w.layerDefinition||w.query)&&(w=null));this.spatialReference=new c(4326);this.initialExtent=new h(-180,-90,180,90,new c(4326));this._map=this._div=null;this.normalization=!0;w&&(w.id&&(this.id=w.id),this.arcgisProps=w.arcgisProps,this.parentLayer=w.parentLayer,!1===w.visible&&(this.visible=!1),f.isDefined(w.opacity)&&(this.opacity=
w.opacity),f.isDefined(w.minScale)&&this.setMinScale(w.minScale),f.isDefined(w.maxScale)&&this.setMaxScale(w.maxScale),this.attributionDataUrl=w.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,f.isDefined(w.showAttribution)&&(this.showAttribution=w.showAttribution),this.className=w.className,this.refreshInterval=w.refreshInterval||0);this._errorHandler=D.hitch(this,this._errorHandler);this._scheduledRefresh=D.hitch(this,this._scheduledRefresh);this.refresh=D.hitch(this,this.refresh);
if(this.managedSuspension){var t=this._setMap;this._setMap=function(C){var u=t.apply(this,arguments);this._fireAttach(C);this.evaluateSuspension();if(this.suspended&&!C.loaded)var x=a.connect(C,"onLoad",this,function(){a.disconnect(x);x=null;this.evaluateSuspension()});return u}}this.registerConnectEvents()},id:null,visible:!0,opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attached:!1,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,refreshInterval:0,
_errorHandler:function(k){this.loaded||(this.loadError=k);this.onError(k)},_setMap:function(k,w,t,C){this._map=k;this._lyrZEHandle=a.connect(k,"onZoomEnd",this,this._processMapScale);if(k.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var u=a.connect(k,"onLoad",this,function(){a.disconnect(u);u=null;this._processMapScale()})},_unsetMap:function(k,w){a.disconnect(this._lyrZEHandle);this._map=this._lyrZEHandle=null;this._resumedOnce=void 0;this.suspended=!0;this._fireDetach(k)},_fireAttach:function(k){this.attached=
!0;this.onAttach({map:k})},_fireDetach:function(k){this.attached=!1;this.onDetach({map:k})},_cleanUp:function(){this._map=this._div=null},_fireUpdateStart:function(){this.updating||(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(k,w){this.updating&&(this.updating=!1,this.attr("data-updating"),this._refreshRT(),this.onUpdateEnd(k,w),this._map&&this._map._decr())},_getToken:function(){var k=this._url,w=this.credential;return k&&
k.query&&k.query.token||w&&w.token||void 0},_findCredential:function(){this.credential=n.id&&this._url&&n.id.findCredential(this._url.path)},_useSSL:function(){var k=this._url,w=/^http:/i;this.url&&(this.url=this.url.replace(w,"https:"));k&&k.path&&(k.path=k.path.replace(w,"https:"))},refresh:function(k){},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(k){this.setScaleRange(k)},setMaxScale:function(k){this.setScaleRange(null,k)},setScaleRange:function(k,
w){var t=f.isDefined(k),C=f.isDefined(w);this.loaded||(this._hasMin=this._hasMin||t,this._hasMax=this._hasMax||C);var u=this.minScale,x=this.maxScale;this.minScale=(t?k:this.minScale)||0;this.maxScale=(C?w:this.maxScale)||0;if(u!==this.minScale||x!==this.maxScale)this.onScaleRangeChange(),this._processMapScale()},suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&
this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?this.suspended&&this._resume():this.suspended||this._suspend()},_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this.onSuspend();if(this._map)this._map.onLayerSuspend(this)},_resume:function(){this.suspended=!1;this.attr("data-suspended");var k=void 0===this._resumedOnce,w=this.className,t=this._attrs,C=this.getNode(),u;if(k){this._resumedOnce=!0;if(w&&C){var x=C.getAttribute("class")||
"";(new RegExp("(^|\\s)"+w+"(\\s|$)","i")).test(x)||C.setAttribute("class",x+((x?" ":"")+w))}if(t&&C)for(u in t)t.hasOwnProperty(u)&&C.setAttribute(u,t[u])}this._refreshRT();this.onResume({firstOccurrence:k});if(this._map)this._map.onLayerResume(this)},_processMapScale:function(){var k=this.visibleAtMapScale;this.visibleAtMapScale=this._isMapAtVisibleScale();k!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(k){return k?g.prototype._isMapAtVisibleScale.apply(this,
arguments):!1},_isMapAtVisibleScale:function(k,w){if(!(k||this._map&&this._map.loaded))return!1;var t=this._map;k=k||t.getScale();var C=this.minScale,u=this.maxScale,x=!C,l=!u,v;w&&(v=t.width>t.height?t.width:t.height);x||(k<=C?x=!0:w&&(x=Math.abs(C-k)/C<1/v));l||(k>=u?l=!0:w&&(l=Math.abs(u-k)/u<1/v));return x&&l},getAttributionData:function(){var k=this.attributionDataUrl,w=new z(e._dfdCanceller);this.hasAttributionData&&k?(w._pendingDfd=d({url:k,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),
w._pendingDfd.then(function(t){w.callback(t)},function(t){w.errback(t)})):(k=Error("Layer does not have attribution data"),k.log=!!m.isDebug,w.errback(k));return w},getResourceInfo:function(){var k=this.resourceInfo;return D.isString(k)?y.fromJson(k):D.clone(k)},getMap:function(){return this._map},getNode:function(){return this._div},attr:function(k,w){var t=this.getNode();if("data-reference"===k&&11>r("ie"))return this;t&&(null==w?t.removeAttribute(k):t.setAttribute(k,w));this._attrs&&(null==w?delete this._attrs[k]:
this._attrs[k]=w);return this},setRefreshInterval:function(k){var w=this.refreshInterval;this.refreshInterval=k;this._toggleRT(!1);k&&this._toggleRT(!0);if(w!==k)this.onRefreshIntervalChange();return this},_toggleRT:function(k){k&&this.refreshInterval?(clearInterval(this._refreshTimer),this._refreshTimer=setInterval(this._scheduledRefresh,6E4*this.refreshInterval)):this._refreshTimer&&(clearInterval(this._refreshTimer),this._refreshTimer=null)},_refreshRT:function(){this._toggleRT(!1);this._toggleRT(!0)},
_scheduledRefresh:function(){this.onRefreshTick();!this._map||this.suspended||this.updating||this.refresh({scheduled:!0})},_refreshTS:null,_reCheckTS:/[\?&]_ts=/ig,_reReplaceTS:/([\?&]_ts=)[0-9]+/ig,addTimestampToURL:function(k){var w=this._refreshTS;w&&(k=this._reCheckTS.test(k)?k.replace(this._reReplaceTS,"$$$1"+w):k+((-1===k.indexOf("?")?"?":"\x26")+"_ts\x3d"+w));return k},setNormalization:function(k){this.normalization=k},setVisibility:function(k){this.visible!==k&&(this.visible=k,this.onVisibilityChange(this.visible),
this.evaluateSuspension());this.attr("data-hidden",k?null:"")},onLoad:function(){},onAttach:function(k){},onDetach:function(k){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onRefreshTick:function(){},onError:function(){}});D.setObject("layers.Layer",g,n);return g})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/request/xhr ./core/request/script dojo/request/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w){function t(J){J=new y(J);return(J.host+(J.port?":"+J.port:"")).toLowerCase()}function C(J){return this._xhr?this._xhr.getResponseHeader(J):null}function u(J,N){var Z=e.objectToQuery(J.content);Z&&(J.url+=(-1===J.url.indexOf("?")?"?":"\x26")+Z);if(2E3<J.url.length){if("data:"!==J.url.toLowerCase().slice(0,5))return Z=new D,Z.reject(z.mixin(Error(),{message:"When using responseType 'image', URL length cannot exceed 2000 characters."})),Z;if(3E6<J.url.length)return Z=
new D,Z.reject(z.mixin(Error(),{message:"When using responseType 'image', data URL length cannot exceed 3000000 characters."})),Z}var Y=new Image;N.allowImageDataAccess&&(Y.crossOrigin=J.withCredentials?"use-credentials":"anonymous");var qa=!1,V=new D(function(na){qa=!0;Y.onload=Y.onerror=Y.onabort=null;Y.src=""});Z=function(na){Y.onload=Y.onerror=Y.onabort=null;qa||V.reject(Error("Unable to load the resource"))};Y.onload=function(){Y.onload=Y.onerror=Y.onabort=null;qa||V.resolve(this)};Y.onerror=
Z;Y.onabort=Z;Y.alt="";Y.src=J.url;return V}function x(J,N,Z,Y){var qa=!1,V=!1,na=!1;if(g.isDefined(N))if(z.isObject(N)){qa=!!N.useProxy;V=!!N.usePost;na=!!N.returnProgress;var ya=N.crossOrigin}else qa=!!N;J=z.mixin({},J);delete J._credential;J._ssl&&(J.url=J.url.replace(/^http:/i,"https:"));10>h("ie")&&!T.test(J.url)&&(J.url=encodeURI(J.url));var S=J.content,ma=J.url,ja=Z&&J.form,X=L;ya=g.isDefined(ya)?ya:X.useCors;J.load=function(Ba){if(Ba){if(Ba.error){var Ja=z.mixin(Error(),Ba.error);Ja.log=!!a.isDebug}else"error"===
Ba.status&&(Ja=z.mixin(Error(),Ba),Ja.log=!!a.isDebug);Ja&&(J.failOk=!Ja.log,g.isDefined(Ja.httpCode)||(Ja.httpCode=Ja.code))}return Ja||Ba};J.error=function(Ba,Ja){Ja&&Ja.xhr&&Ja.xhr.abort();Ba instanceof Error||(Ba=z.mixin(Error(),Ba));Ba.log=!!a.isDebug;J.failOk=!Ba.log;X.errorHandler(Ba,Ja);return Ba};J._token&&(J.content=J.content||{},J.content.token=J._token);var oa=0;if(S&&ma){var xa=e.objectToQuery(S);oa=xa.length+ma.length+1;h("esri-url-encodes-apostrophe")&&(oa=xa.replace(/'/g,"%27").length+
ma.length+1)}J.timeout=g.isDefined(J.timeout)?J.timeout:X.timeout;J.handleAs=J.handleAs||"json";try{var Ha=ya&&k.canUseXhr(J.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(J.url),Ia=k.hasSameOrigin(J.url,window.location.href)||Ha,ia=V||Z||oa>X.postLength?!0:!1,ea=Ia||-1===J.handleAs.indexOf("json")||!J.callbackParamName||Z?!1:!0,za=k.getProxyRule(J.url)||X.alwaysUseProxy||qa||!("image"===J.handleAs&&!N.allowImageDataAccess||ea&&!ia||Ia)?!0:!1;Z&&!h("esri-file-upload")&&!za&&Ha&&(za=!0);
if(za){var Ca=k.getProxyUrl(ma,ya);var Da=Ca.path;Ca._xo&&(Ha=!0);!ia&&Da.length+1+oa>X.postLength&&(ia=!0);J.url=Da+"?"+ma;if(ia)J.content=z.mixin(Ca.query||{},S);else{var ka=e.objectToQuery(z.mixin(Ca.query||{},S));ka&&(J.url+="?"+ka);J.content=null}}if(!ea||ia||za){var ta=J.headers;!Ha||ta&&ta.hasOwnProperty("X-Requested-With")||(ta=J.headers=ta||{},ta["X-Requested-With"]=null);if(Z){var M=J.callbackParamName||"callback.html",Ga=J.callbackElementName||"textarea",La,aa,Ya=ja.elements?ja.elements.length:
0;if(S=J.content)for(La in S.token&&-1<ma.toLowerCase().indexOf("/sharing/servers/")&&(ma+=(-1===ma.indexOf("?")?"?":"\x26")+"token\x3d"+S.token,J.url=za?Da+"?"+ma:ma,delete S.token),S){var Wa=S[La];if(g.isDefined(Wa)){var Ea=null;for(aa=0;aa<Ya;aa++){var U=ja.elements[aa];if(U.name===La){Ea=U;break}}Ea?Ea.value=Wa:Y?ja.append(La,Wa):ja.appendChild(d.create("input",{type:"hidden",name:La,value:Wa}))}}if(h("esri-file-upload")){m.forEach(ja.elements,function(Ba){Ba.name===M&&ja.removeChild(Ba)});var fa=
Y?ja:new FormData(ja);if(11<=h("safari")&&"entries"in fa&&"delete"in fa){Y=[];for(var sa=fa.entries(),O=sa.next();!O.done;){var ca=O.value;ca[1]instanceof File&&""===ca[1].name&&Y.push(ca[0]);O=sa.next()}Y.forEach(function(Ba){fa["delete"](Ba)})}J.contentType=!1;J.postData=fa;delete J.form}else{ja.enctype="multipart/form-data";9>h("ie")&&(ja.encoding="multipart/form-data");ja.method="post";m.some(ja.elements,function(Ba){return Ba.name===M})||ja.appendChild(d.create("input",{type:"hidden",name:M,
value:Ga}));if(-1!==ma.toLowerCase().indexOf("addattachment")||-1!==ma.toLowerCase().indexOf("updateattachment"))ma+=(-1===ma.indexOf("?")?"?":"\x26")+M+"\x3d"+Ga,J.url=za?Da+"?"+ma:ma;delete J.content}}if(Ha&&!J.hasOwnProperty("withCredentials")&&"with-credentials"===L.useCors){ma=za?Da:ma;var va=k.canUseXhr(ma,!0),H=-1<va?L.corsEnabledServers[va]:null;if(H&&H.hasOwnProperty("withCredentials"))H.withCredentials&&(J.withCredentials=!0);else if(b.id){var R=b.id.findServerInfo(ma);R&&R.webTierAuth&&
(J.withCredentials=!0)}}J=I?I(J):J;if("image"===J.handleAs)return u(J,N);if(ia){if(Z&&!h("esri-file-upload")){var W=new D(function(){pa.cancel()});var pa=f.post(J.url,J).then(function(Ba){W.resolve(Ba)}).otherwise(function(Ba){W.reject(Ba)});W.addCallback(function(Ba){return J.load(Ba)});W.addErrback(function(Ba){return J.error(Ba)});return W}!za&&h("safari")&&(J.url+=(-1===J.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+ba++);if(na){J.uploadProgress=!0;J.data=J.postData;J.query=J.content;
W=new D(function(){ra.cancel()});var ra=q.post(J.url,J).then(function(Ba){W.resolve(Ba)},function(Ba){W.reject(Ba)},function(Ba){W.progress({transferType:Ba.transferType,loaded:Ba.loaded,total:Ba.total})});W.addCallback(function(Ba){return J.load(Ba)});W.addErrback(function(Ba){return J.error(Ba)});return W}return r.post(J)}return r.get(J)}J=I?I(J):J;J.jsonp=J.callbackParamName;J.query=J.content;W=new D(function(){Aa.cancel()});var Aa=n.get(J.url,J).then(function(Ba){W.resolve(Ba)}).otherwise(function(Ba){W.reject(Ba)});
W.addCallback(function(Ba){return J.load(Ba)});W.addErrback(function(Ba){return J.error(Ba)});return W}catch(Ba){return W=new D,W.errback(J.error(Ba)),W}}function l(J){var N=L.corsStatus,Z=k.canUseXhr(J,!0);-1<Z&&L.corsEnabledServers.splice(Z,1);var Y=new D;Y.reject({log:!!a.isDebug});N[t(J)]=Y.promise;return Z}function v(J){var N=L.corsStatus;try{var Z=t(J);if(L.corsDetection&&L.useCors&&h("esri-cors")&&J&&-1!==J.toLowerCase().indexOf("/rest/services")&&!k.hasSameOrigin(J,window.location.href)&&
!k.canUseXhr(J)){if(N[Z]&&!N[Z].isCanceled())return N[Z];var Y=new D(w._dfdCanceller);N[Z]=Y.promise;var qa=r.get({url:J.substring(0,J.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null},timeout:1E3*L.corsDetectionTimeout});Y._pendingDfd=qa;qa.then(function(V){V?(k.canUseXhr(J)||L.corsEnabledServers.push(Z),Y.resolve()):Y.reject()},function(V){Y.reject(V)});return Y.promise}}catch(V){}return P}function A(J){I=J}function B(J,N,Z,
Y){function qa(Ia){Ia._pendingDfd=x(Z,Y,X,ja);if(!Ia._pendingDfd){Ia.ioArgs=Ia._pendingDfd&&Ia._pendingDfd.ioArgs;var ia=Error("Deferred object is missing");ia.log=!!a.isDebug;Ia.errback(ia);Ia._pendingDfd=null;return Ia}Ia._pendingDfd.addCallback(function(ea){if(!ea)return ea;var za=Ia._pendingDfd&&Ia._pendingDfd.ioArgs&&Ia._pendingDfd.ioArgs.xhr;if(!za)return ea;if(za=za.getResponseHeader("Content-Type"))if(za=za.toLowerCase(),-1===za.indexOf("text/plain")&&-1===za.indexOf("application/json"))return ea;
if(ea instanceof ArrayBuffer&&750>=ea.byteLength)za=new Blob([ea]);else if(ea instanceof Blob&&750>=ea.size)za=ea;else return ea;var Ca=new D,Da=new FileReader;Da.readAsText(za);Da.onloadend=function(){if(!Da.error)try{var ka=JSON.parse(Da.result);if(ka.error)var ta=ka.error}catch(M){}ta?(ta=z.mixin(Error(),ta),ta.log=!!a.isDebug,null==ta.httpCode&&(ta.httpCode=ta.code),Ca.reject(ta)):Ca.resolve(ea)};return Ca.promise}).addCallback(function(ea){Ia.ioArgs=Ia._pendingDfd&&Ia._pendingDfd.ioArgs;Y.returnFullResponse&&
(ea={data:ea,_xhr:Ia.ioArgs&&Ia.ioArgs.xhr,getHeader:C});Ia.callback(ea);Ia._pendingDfd=null}).addErrback(function(ea){if(ea){var za=ea.code;var Ca=ea.subcode;var Da=(Da=ea.messageCode)&&Da.toUpperCase()}if(ea&&403==za&&(4==Ca||ea.message&&-1<ea.message.toLowerCase().indexOf("ssl")&&-1===ea.message.toLowerCase().indexOf("permission"))){if(!Z._ssl){Z._ssl=Z._sslFromServer=!0;B(Ia,!0,Z,Y);return}}else if(ea&&415==ea.status){if(l(Z.url),!Z._err415){Z._err415=1;B(Ia,!0,Z,Y);return}}else if(b.id&&-1!==
m.indexOf(b.id._errorCodes,za)&&!b.id._isPublic(Z.url)&&!na&&(403!=za||-1===m.indexOf(K,Da)&&(!g.isDefined(Ca)||2==Ca&&Z._token))){Ia._pendingDfd=b.id.getCredential(Z.url,{token:Z._token,error:ea});Ia._pendingDfd.addCallback(function(ka){Z._token=ka.token;Z._credential=ka;Z._ssl=Z._sslFromServer||ka.ssl;B(Ia,!0,Z,Y)}).addErrback(function(ka){Ia.errback(ka);Ia._pendingDfd=null});return}Ia.ioArgs=Ia._pendingDfd&&Ia._pendingDfd.ioArgs;Ia.isFulfilled()||Ia.errback(ea);Ia._pendingDfd=null}).then(null,
null,function(ea){Ia.progress(ea)})}var V=Z.form,na=Y.disableIdentityLookup,ya=Y._preLookup,S=!1;if(h("esri-workers")&&!1!==L.useWorkers)if(!0===Y.useWorkers||!0===L.useWorkers)S=!0;else if(Y.workerOptions){var ma=Y.workerOptions;if(ma.callback||ma.worker&&ma.worker.worker instanceof Worker)S=!0}var ja=V&&h("esri-file-upload")&&V instanceof FormData,X=V&&(V.elements?m.some(V.elements,function(Ia){return"file"===Ia.type}):ja),oa=-1!==Z.url.toLowerCase().indexOf("token\x3d")||Z.content&&Z.content.token||
X&&m.some(V.elements,function(Ia){return"token"===Ia.name})?1:0;if(!N){J.addCallback(function(Ia){if((/\/sharing\/rest\/accounts\/self/i.test(Z.url)||/\/sharing\/rest\/portals\/self/i.test(Z.url))&&!oa&&!Z._token&&Ia&&Ia.user&&Ia.user.username){L.webTierAuthServers.push(t(Z.url));Ia=L.corsEnabledServers;var ia=k.canUseXhr(Z.url,!0),ea={host:t(Z.url),withCredentials:!0};if(-1===ia)Ia.push(ea);else{var za=Ia[ia];za instanceof RegExp?(ea.host=za,Ia.splice(ia,1,ea)):"object"===typeof za?za.withCredentials=
!0:Ia.splice(ia,1,ea)}}if(Ia=Z._credential)if(ia=(ia=b.id.findServerInfo(Ia.server))&&ia.owningSystemUrl)ia=ia.replace(/\/?$/,"/sharing"),(Ia=b.id.findCredential(ia,Ia.userId))&&-1===b.id._getIdenticalSvcIdx(ia,Ia)&&Ia.resources.splice(0,0,ia)});J.addBoth(function(Ia){delete Z._credential;!Ia||h("ie")&&Ia.nodeType||(Ia._ssl=Z._ssl)});var xa=Z.load,Ha=Z.error;xa&&J.addCallback(function(Ia){var ia=J._pendingDfd;ia=ia&&ia.ioArgs;return xa.call(ia&&ia.args,Ia,ia)});Ha&&J.addErrback(function(Ia){var ia=
J._pendingDfd;ia=ia&&ia.ioArgs;return Ha.call(ia&&ia.args,Ia,ia)})}!b.id||oa||Z._token||b.id._isPublic(Z.url)||na&&!ya||!(N=b.id.findCredential(Z.url))||(Z._token=N.token,Z._ssl=N.ssl);S?Y.workerOptions&&Y.workerOptions.worker?(G||(G=r),r=Y.workerOptions.worker,qa(J)):F(["./workers/RequestClient"],function(Ia){G||(G=r);if(Y.workerOptions){var ia=Y.workerOptions;r=Ia.getClient(ia.callback,ia.cbFunction)}else r=Ia.getClient();qa(J)}):(G&&(r=G,G=null),qa(J));return J}function E(J,N){J.url=k.fixUrl(J.url);
N=N||{};var Z=new D(w._dfdCanceller),Y=v(J.url);Z._pendingDfd=Y;Y.always(function(qa){qa&&"cancel"===qa.dojoType?Z.reject(qa):B(Z,!1,J,N)});return Z}var G=null,I,L=c.defaults.io,K=["COM_0056","COM_0057","SB_0008"],ba=0,T=/%[0-9A-F]{2}/i,P=function(){var J=new D;J.resolve();return J.promise}();E._makeRequest=x;E._processRequest=B;E._disableCors=l;E._detectCors=v;E.setRequestPreCallback=A;b.request=E;b._makeRequest=x;b._processRequest=B;b._disableCors=l;b._detectCors=v;b.setRequestPreCallback=A;return E})},
"esri/core/request/script":function(){define("require exports dojo/Deferred dojo/request/script dojo/text!./iframe.html ../sniff".split(" "),function(F,m,a,D,z,y){function r(){var k=document.createElement("iframe");k.name="esri_core_jsonp_iframe";k.style.display="none";k.setAttribute("sandbox","allow-scripts");if(!y("ff")&&"srcdoc"in k){var w=F.toUrl("dojo/dojo.js"),t=z.replace("../../../dojo/dojo.js",w);w=w.slice(0,-7);t=t.replace("../../../dojo/",w);k.srcdoc=t}else t=F.toUrl("./iframe.html"),"http:"===
window.location.protocol&&0===t.indexOf("https:")&&(t=t.replace("https:","http:")),k.src=t;document.body.appendChild(k);return k}function q(){var k=new MessageChannel;k.port1.addEventListener("message",n);k.port1.start();return k}function n(k){var w=k.data;if("ready"===w){w=0;for(var t=h;w<t.length;w++)k=t[w],d(k,b);h=null}else if(k=g[w.id])delete g[w.id],w.isError?k.dfd.reject(Error(w.message)):k.dfd.resolve(w.response)}function f(k,w){k.addEventListener("load",function(){k.contentWindow.postMessage("init",
"*",[w.port2])})}function d(k,w){g[k.message.id]=k;w.port1.postMessage(k.message)}Object.defineProperty(m,"__esModule",{value:!0});var e,b,c=0,h=[],g={};m.get=function(k,w){if(!y("esri-script-sandbox"))return D.get(k,w);var t=null;w&&(t={jsonp:w.jsonp,preventCache:w.preventCache,query:w.query,timeout:w.timeout});var C=new a(function(){if(h){var x=h.indexOf(u);-1<x&&h.splice(x,1)}else u.message.id in g&&delete g[u.message.id]}),u={dfd:C,message:{id:"id"+(++c+Math.random()),url:k,options:t}};e||(e=
r(),b=q(),f(e,b));h?h.push(u):d(u,b);return C.promise}})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),function(F,m,a,D,z,y,r,q,n,f,d){function e(v,A){v.canDelete&&k._remove(v.id,A.options.frameDoc,!0)}function b(v){l&&l.length&&(z.forEach(l,function(A){k._remove(A.id,A.frameDoc);A.frameDoc=null}),l=[]);return v.options.jsonp?!v.data:!0}function c(v){return!!this.scriptLoaded}
function h(v){return(v=v.options.checkString)&&eval("typeof("+v+') !\x3d\x3d "undefined"')}function g(v,A){if(this.canDelete){var B=this.response.options;l.push({id:this.id,frameDoc:B.ioArgs?B.ioArgs.frameDoc:B.frameDoc});B.ioArgs&&(B.ioArgs.frameDoc=null);B.frameDoc=null}A?this.reject(A):this.resolve(v)}function k(v,A,B){var E=a.parseArgs(v,a.deepCopy({},A));v=E.url;A=E.options;var G=a.deferred(E,e,b,A.jsonp?null:A.checkString?h:c,g);y.mixin(G,{id:w+t++,canDelete:!1});A.jsonp&&((new RegExp("[?\x26]"+
A.jsonp+"\x3d")).test(v)||(v+=(~v.indexOf("?")?"\x26":"?")+A.jsonp+"\x3d"+(A.frameDoc?"parent.":"")+w+"_callbacks."+G.id),G.canDelete=!0,x[G.id]=function(K){E.data=K;G.handleResponse(E)});a.notify&&a.notify.emit("send",E,G.promise.cancel);if(!A.canAttach||A.canAttach(G)){var I=k._attach(G.id,v,A.frameDoc,function(K){if(!(K instanceof Error)){var ba=Error("Error loading "+(K.target?K.target.src:"script"));ba.source=K;K=ba}G.reject(K);k._remove(G.id,A.frameDoc,!0)});if(!A.jsonp&&!A.checkString)var L=
r(I,C,function(K){if("load"===K.type||u.test(I.readyState))L.remove(),G.scriptLoaded=K})}m(G);return B?G:G.promise}f.add("script-readystatechange",function(v,A){return"undefined"!==typeof A.createElement("script").onreadystatechange&&("undefined"===typeof v.opera||"[object Opera]"!==v.opera.toString())});var w=F.id.replace(/[\/\.\-]/g,"_"),t=0,C=f("script-readystatechange")?"readystatechange":"load",u=/complete|loaded/,x=D.global[w+"_callbacks"]={},l=[];k.get=k;k._attach=function(v,A,B,E){B=B||d.doc;
var G=B.createElement("script");if(E)r.once(G,"error",E);G.type="text/javascript";try{G.src=A}catch(I){E&&E(G)}G.id=v;G.async=!0;G.charset="utf-8";return B.getElementsByTagName("head")[0].appendChild(G)};k._remove=function(v,A,B){n.destroy(q.byId(v,A));x[v]&&(B?x[v]=function(){delete x[v]}:delete x[v])};k._callbacksProperty=w+"_callbacks";return k})},"esri/core/sniff":function(){define(["../sniff"],function(F){return F})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom ../NodeList-manipulate".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e){function b(u){return!this.isFulfilled()}function c(u){return!!this._finished}function h(u,x){if(!x)try{var l=u.options,v=k.doc(k._frame),A=l.handleAs;if("html"!==A){if("xml"===A)if("html"===v.documentElement.tagName.toLowerCase()){q("a",v.documentElement).orphan();var B=v.documentElement.innerText||v.documentElement.textContent;B=B.replace(/>\s+</g,"\x3e\x3c");u.text=y.trim(B)}else u.data=v;else u.text=v.getElementsByTagName("textarea")[0].value;z(u)}else u.data=
v}catch(E){x=E}x?this.reject(x):this._finished?this.resolve(u):this.reject(Error("Invalid dojo/request/iframe request state"))}function g(u){this._callNext()}function k(u,x,l){var v=D.parseArgs(u,D.deepCreate(C,x),!0);u=v.url;x=v.options;if("GET"!==x.method&&"POST"!==x.method)throw Error(x.method+" not supported by dojo/request/iframe");k._frame||(k._frame=k.create(k._iframeName,t+"();"));u=D.deferred(v,null,b,c,h,g);u._callNext=function(){this._calledNext||(this._calledNext=!0,k._currentDfd=null,
k._fireNextRequest())};u._legacy=l;k._dfdQueue.push(u);k._fireNextRequest();a(u);return l?u:u.promise}var w=F.id.replace(/[\/\.\-]/g,"_"),t=w+"_onload";e.global[t]||(e.global[t]=function(){var u=k._currentDfd;if(u){var x=f.byId(u.response.options.form)||u._tmpForm;if(x){for(var l=u._contentToClean,v=0;v<l.length;v++)for(var A=l[v],B=0;B<x.childNodes.length;B++){var E=x.childNodes[B];if(E.name===A){d.destroy(E);break}}u._originalAction&&x.setAttribute("action",u._originalAction);u._originalMethod&&
(x.setAttribute("method",u._originalMethod),x.method=u._originalMethod);u._originalTarget&&(x.setAttribute("target",u._originalTarget),x.target=u._originalTarget)}u._tmpForm&&(d.destroy(u._tmpForm),delete u._tmpForm);u._finished=!0}else k._fireNextRequest()});var C={method:"POST"};k.create=function(u,x,l){if(e.global[u])return e.global[u];if(e.global.frames[u])return e.global.frames[u];l||(n("config-useXDomain")&&n("config-dojoBlankHtmlUrl"),l=n("config-dojoBlankHtmlUrl")||m.toUrl("dojo/resources/blank.html"));
x=d.place('\x3ciframe id\x3d"'+u+'" name\x3d"'+u+'" src\x3d"'+l+'" onload\x3d"'+x+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',e.body());return e.global[u]=x};k.doc=function(u){if(u.contentDocument)return u.contentDocument;var x=u.name;if(x){var l=e.doc.getElementsByTagName("iframe");if(u.document&&l[x].contentWindow&&l[x].contentWindow.document)return l[x].contentWindow.document;if(e.doc.frames[x]&&e.doc.frames[x].document)return e.doc.frames[x].document}return null};
k.setSrc=function(u,x,l){u=e.global.frames[u.name];u.contentWindow&&(u=u.contentWindow);try{l?u.location.replace(x):u.location=x}catch(v){}};k._iframeName=w+"_IoIframe";k._notifyStart=function(){};k._dfdQueue=[];k._currentDfd=null;k._fireNextRequest=function(){try{if(!k._currentDfd&&k._dfdQueue.length){do var u=k._currentDfd=k._dfdQueue.shift();while(u&&(u.canceled||u.isCanceled&&u.isCanceled())&&k._dfdQueue.length);if(!u||u.canceled||u.isCanceled&&u.isCanceled())k._currentDfd=null;else{var x=u.response,
l=x.options,v=u._contentToClean=[],A=f.byId(l.form),B=D.notify,E=l.data||null;if(!u._legacy&&"POST"===l.method&&!A)A=u._tmpForm=d.create("form",{name:w+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},e.body());else if("GET"===l.method&&A&&-1<x.url.indexOf("?")){var G=x.url.slice(x.url.indexOf("?")+1);E=y.mixin(r.queryToObject(G),E)}if(A){if(!u._legacy){var I=A;do I=I.parentNode;while(I&&I!==e.doc.documentElement);I||(A.style.position="absolute",A.style.left="-1000px",A.style.top=
"-1000px",e.body().appendChild(A));A.name||(A.name=w+"_form")}if(E){I=function(N,Z){d.create("input",{type:"hidden",name:N,value:Z},A);v.push(N)};for(var L in E){var K=E[L];if(y.isArray(K)&&1<K.length)for(G=0;G<K.length;G++)I(L,K[G]);else{var ba=q("input[name\x3d'"+L+"']",A);-1==ba.indexOf()?I(L,K):ba.val(K)}}}var T=A.getAttributeNode("action"),P=A.getAttributeNode("method"),J=A.getAttributeNode("target");x.url&&(u._originalAction=T?T.value:null,T?T.value=x.url:A.setAttribute("action",x.url));u._legacy?
P&&P.value||(P?P.value=l.method:A.setAttribute("method",l.method)):(u._originalMethod=P?P.value:null,P?P.value=l.method:A.setAttribute("method",l.method));u._originalTarget=J?J.value:null;J?J.value=k._iframeName:A.setAttribute("target",k._iframeName);A.target=k._iframeName;B&&B.emit("send",x,u.promise.cancel);k._notifyStart(x);A.submit()}else l="",x.options.data&&(l=x.options.data,"string"!==typeof l&&(l=r.objectToQuery(l))),I=x.url+(-1<x.url.indexOf("?")?"\x26":"?")+l,B&&B.emit("send",x,u.promise.cancel),
k._notifyStart(x),k.setSrc(k._frame,I,!0)}}}catch(N){u.reject(N)}};D.addCommonMethods(k,["GET","POST"]);return k})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(F,m,a,D,z){function y(n){for(;n.childNodes[0]&&1==n.childNodes[0].nodeType;)n=n.childNodes[0];return n}function r(n,f){"string"==typeof n?(n=D.toDom(n,f&&f.ownerDocument),11==n.nodeType&&(n=n.childNodes[0])):1==n.nodeType&&n.parentNode&&(n=n.cloneNode(!1));
return n}var q=F.NodeList;m.extend(q,{_placeMultiple:function(n,f){for(var d="string"==typeof n||n.nodeType?F(n):n,e=[],b=0;b<d.length;b++)for(var c=d[b],h=this.length,g=h-1,k;k=this[g];g--)0<b&&(k=this._cloneNode(k),e.unshift(k)),g==h-1?D.place(k,c,f):c.parentNode.insertBefore(k,c),c=k;e.length&&(e.unshift(0),e.unshift(this.length-1),Array.prototype.splice.apply(this,e));return this},innerHTML:function(n){return arguments.length?this.addContent(n,"only"):this[0].innerHTML},text:function(n){if(arguments.length){for(var f=
0,d;d=this[f];f++)1==d.nodeType&&z.set(d,"textContent",n);return this}var e="";for(f=0;d=this[f];f++)e+=z.get(d,"textContent");return e},val:function(n){if(arguments.length){for(var f=m.isArray(n),d=0,e;e=this[d];d++){var b=e.nodeName.toUpperCase(),c=e.type,h=f?n[d]:n;if("SELECT"==b)for(b=e.options,c=0;c<b.length;c++){var g=b[c];g.selected=e.multiple?-1!=a.indexOf(n,g.value):g.value==h}else"checkbox"==c||"radio"==c?e.checked=e.value==h:e.value=h}return this}if((e=this[0])&&1==e.nodeType){n=e.value||
"";if("SELECT"==e.nodeName.toUpperCase()&&e.multiple){n=[];b=e.options;for(c=0;c<b.length;c++)g=b[c],g.selected&&n.push(g.value);n.length||(n=null)}return n}},append:function(n){return this.addContent(n,"last")},appendTo:function(n){return this._placeMultiple(n,"last")},prepend:function(n){return this.addContent(n,"first")},prependTo:function(n){return this._placeMultiple(n,"first")},after:function(n){return this.addContent(n,"after")},insertAfter:function(n){return this._placeMultiple(n,"after")},
before:function(n){return this.addContent(n,"before")},insertBefore:function(n){return this._placeMultiple(n,"before")},remove:q.prototype.orphan,wrap:function(n){if(this[0]){n=r(n,this[0]);for(var f=0,d;d=this[f];f++){var e=this._cloneNode(n);d.parentNode&&d.parentNode.replaceChild(e,d);y(e).appendChild(d)}}return this},wrapAll:function(n){if(this[0]){n=r(n,this[0]);this[0].parentNode.replaceChild(n,this[0]);n=y(n);for(var f=0,d;d=this[f];f++)n.appendChild(d)}return this},wrapInner:function(n){if(this[0]){n=
r(n,this[0]);for(var f=0;f<this.length;f++){var d=this._cloneNode(n);this._wrap(m._toArray(this[f].childNodes),null,this._NodeListCtor).wrapAll(d)}}return this},replaceWith:function(n){n=this._normalize(n,this[0]);for(var f=0,d;d=this[f];f++)this._place(n,d,"before",0<f),d.parentNode.removeChild(d);return this},replaceAll:function(n){n=F(n);for(var f=this._normalize(this,this[0]),d=0,e;e=n[d];d++)this._place(f,e,"before",0<d),e.parentNode.removeChild(e);return this},clone:function(){for(var n=[],
f=0;f<this.length;f++)n.push(this._cloneNode(this[f]));return this._wrap(n,this,this._NodeListCtor)}});q.prototype.html||(q.prototype.html=q.prototype.innerHTML);return q})},"esri/layers/support/webglUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],function(F,m,a,D){var z=!1,y=a("esri-webgl-max-contexts");y=null!=y?y:a("esri-mobile")?8:16;var r={isWebGLSupported:function(){return!!z},isWebGLEnabled:function(){return this.isWebGLSupported()&&!!a("esri-featurelayer-webgl")},
createCanvas:function(q,n){var f=document.createElement("canvas");f.style.width=q+"px";f.style.height=n+"px";return f},createWebGLContext:function(q){var n;m.some(["webgl","experimental-webgl","webkit-3d","moz-webgl"],function(f){try{n=q.getContext?q.getContext(f):null}catch(d){n=null}return!!n});return n},_contextOwners:[],isContextAvailable:function(){return-1===y||0<y&&r._contextOwners.length<y},acquireContext:function(q){return-1!==m.indexOf(r._contextOwners,q)?!0:r.isContextAvailable()?(r._contextOwners.push(q),
!0):!1},releaseContext:function(q){q=m.indexOf(r._contextOwners,q);-1!==q&&r._contextOwners.splice(q,1)}};z=r.createWebGLContext(r.createCanvas());F.setObject("layers.support.webglUtils",r,D);return r})},"esri/layers/support/WebGLSurface":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],function(F,m,a,D,z){F=F(null,{map:null,node:null,renderers:null,constructor:function(y){m.mixin(this,y);this.renderers=[]},destroy:function(){a.forEach(this.renderers,
function(y){y.destroy()});this.renderers=null},getEventSource:function(){return this.node},createRenderer:function(y,r,q,n){y=new y({surface:this,width:r,height:q,map:this.map,layer:n});this.renderers.push(y);return y},destroyRenderer:function(y){var r=a.indexOf(this.renderers,y);-1<r&&(y.destroy(),this.renderers.splice(r,1))},_createNode:function(){var y=document.createElement("div");y.style.pointerEvents="auto";y.style.position="absolute";return y}});m.setObject("layers.support.WebGLSurface",F,
z);return F})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(F,m,a,D,z){var y={show:function(r){if(r=y.getNode(r))r.style.display="block"},getNode:function(r){return r&&r.domNode||r},hide:function(r){if(r=y.getNode(r))r.style.display="none"},toggle:function(r){if(r=y.getNode(r))r.style.display="none"===r.style.display?"block":"none"},documentBox:8>=z("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:
{w:window.innerWidth,h:window.innerHeight},setScrollable:function(r){if(r=this.getNode(r)){var q=0,n=0,f=0,d=0,e=0,b=0;return[m.connect(r,"ontouchstart",function(c){q=c.touches[0].screenX;n=c.touches[0].screenY;f=r.scrollWidth;d=r.scrollHeight;e=r.clientWidth;b=r.clientHeight}),m.connect(r,"ontouchmove",function(c){c.preventDefault();var h=r.firstChild;h instanceof Text&&(h=r.childNodes[1]);var g=h._currentX||0,k=h._currentY||0;g+=c.touches[0].screenX-q;0<g?g=0:0>g&&Math.abs(g)+e>f&&(g=-1*(f-e));
h._currentX=g;k+=c.touches[0].screenY-n;0<k?k=0:0>k&&Math.abs(k)+b>d&&(k=-1*(d-b));h._currentY=k;D.set(h,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+g+"px, "+k+"px)"});q=c.touches[0].screenX;n=c.touches[0].screenY})]}}};a.mixin(F,y);return y})},"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(F,m,a,D,z,y){F=F(y,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,
xoffset:0,yoffset:0,size:12,constructor:function(r){r&&m.isObject(r)&&(this.size="auto"===this.size?this.size:D.pt2px(this.size),this.xoffset=D.pt2px(this.xoffset),this.yoffset=D.pt2px(this.yoffset),this.angle&&(this.angle*=-1))},setAngle:function(r){this.angle=r;return this},setSize:function(r){this.size=r;return this},setOffset:function(r,q){this.xoffset=r;this.yoffset=q;return this},toJson:function(){var r=D.px2pt(this.size);r=isNaN(r)?void 0:r;var q=D.px2pt(this.xoffset);q=isNaN(q)?void 0:q;var n=
D.px2pt(this.yoffset);n=isNaN(n)?void 0:n;return m.mixin(this.inherited("toJson",arguments),{size:"auto"===this.size?this.size:r,angle:this.angle&&-1*this.angle,xoffset:q,yoffset:n})}});m.setObject("symbol.MarkerSymbol",F,z);return F})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.symbol.Symbol",color:new y([0,0,0,1]),type:null,constructor:function(r){r&&m.isObject(r)&&
(m.mixin(this,r),this.color&&z.isDefined(this.color[0])&&(this.color=y.toDojoColor(this.color)),(r=this.type)&&0===r.indexOf("esri")&&(this.type={esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[r]))},setColor:function(r){this.color=r;return this},toJson:function(){return{color:y.toJsonColor(this.color)}}});m.setObject("symbol.Symbol",
F,D);return F})},"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),function(F,m,a,D,z,y,r,q,n){var f={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_TRIANGLE:"triangle",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},d={style:f.STYLE_CIRCLE,color:[255,255,255,.25],size:12,angle:0,xoffset:0,yoffset:0};F=F(q,
{declaredClass:"esri.symbol.SimpleMarkerSymbol",type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",triangle:"esriSMSTriangle",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(e,b,c,h){e?m.isString(e)?(this.style=e,b&&(this.size=b),c&&(this.outline=c),h&&(this.color=h)):(this.style=r.valueOf(this._styles,this.style),e.outline&&(this.outline=new n(e.outline))):(m.mixin(this,d),this.size=z.pt2px(this.size),this.outline=
new n(this.outline),this.color=new a(this.color));this.style||(this.style=f.STYLE_CIRCLE)},setStyle:function(e){this.style=e;return this},setPath:function(e){this.path=e;this.setStyle(f.STYLE_PATH);return this},setOutline:function(e){this.outline=e;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(e,b,c){this._targetWidth=e;this._targetHeight=b;this._spikeSize=c},getShapeDescriptors:function(){var e,b=this.style,
c=(this.size||z.pt2px(d.size))/2,h=0-c,g=0+c,k=0-c,w=0+c;switch(b){case f.STYLE_CIRCLE:var t={type:"circle",cx:0,cy:0,r:c};var C=this.getFill();if(e=this.getStroke())e.style=e.style||"Solid";break;case f.STYLE_CROSS:t={type:"path",path:"M "+h+",0 L "+g+",0 M 0,"+k+" L 0,"+w+" E"};C=null;e=this.getStroke();break;case f.STYLE_DIAMOND:t={type:"path",path:"M "+h+",0 L 0,"+k+" L "+g+",0 L 0,"+w+" L "+h+",0 Z"};C=this.getFill();e=this.getStroke();break;case f.STYLE_SQUARE:t={type:"path",path:"M "+h+","+
w+" L "+h+","+k+" L "+g+","+k+" L "+g+","+w+" L "+h+","+w+" Z"};C=this.getFill();e=this.getStroke();break;case f.STYLE_TRIANGLE:t={type:"path",path:"M "+h+","+w+" L 0,"+k+" L "+g+","+w+" L "+h+","+w+" Z"};C=this.getFill();e=this.getStroke();break;case f.STYLE_X:t={type:"path",path:"M "+h+","+w+" L "+g+","+k+" M "+h+","+k+" L "+g+","+w+" E"};C=null;e=this.getStroke();break;case f.STYLE_PATH:t={type:"path",path:this.path||""},C=this.getFill(),e=this.getStroke()}return{defaultShape:t,fill:C,stroke:e}},
toJson:function(){var e=this.style,b=this.outline,c=m.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[e]||"esriSMSCircle"});b&&(c.outline=b.toJson());"x"===e||"cross"===e?delete c.color:"target"===e&&(c.style="esriSMSSquare",delete c.color,0<this._targetHeight&&0<this._targetWidth&&(c.size=z.px2pt(Math.max(this._targetHeight,this._targetWidth))));c.path=this.path;return r.fixJson(c)}});m.mixin(F,f);F.defaultProps=d;m.setObject("symbol.SimpleMarkerSymbol",F,y);y.symbol.defaultSimpleMarkerSymbol=
d;return F})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),function(F,m,a,D,z,y,r,q){var n={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",
STYLE_LONGDASHDOT:"longdashdot"},f={color:[0,0,0,1],style:n.STYLE_SOLID,width:1};F=F(q,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",marker:null,_styles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",longdash:"esriSLSLongDash",
longdashdot:"esriSLSLongDashDot"},constructor:function(d,e,b){d?m.isString(d)?(this.style=d,e&&(this.color=e),b&&(this.width=b)):(this.style=r.valueOf(this._styles,d.style)||n.STYLE_SOLID,this.marker=d.marker):(m.mixin(this,f),this.color=new a(this.color),this.width=z.pt2px(this.width))},setStyle:function(d){this.style=d;return this},setMarker:function(d){this.marker=d},getStroke:function(){return this.style===n.STYLE_NULL||0===this.width?null:{color:this.color,style:this.style,width:this.width}},
getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return r.fixJson(m.mixin(this.inherited("toJson",arguments),{type:"esriSLS",style:this._styles[this.style],marker:this.marker?m.clone(this.marker):void 0}))}});m.mixin(F,n);F.defaultProps=f;m.setObject("symbol.SimpleLineSymbol",F,y);y.symbol.defaultSimpleLineSymbol=f;return F})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),
function(F,m,a,D,z,y){F=F(y,{declaredClass:"esri.symbol.LineSymbol",constructor:function(r){m.isObject(r)?this.width=D.pt2px(this.width):this.width=12},setWidth:function(r){this.width=r;return this},toJson:function(){var r=D.px2pt(this.width);r=isNaN(r)?void 0:r;return m.mixin(this.inherited("toJson",arguments),{width:r})}});m.setObject("symbol.LineSymbol",F,z);return F})},"esri/symbols/utils":function(){define("dojo/_base/lang dojo/_base/window dojo/has dojox/gfx ../kernel ../Color".split(" "),function(F,
m,a,D,z,y){function r(b){b.removeAttribute("marker-start");b.removeAttribute("marker-end");b.removeAttribute("opacity")}function q(b,c){for(var h in c)b.setAttribute(h,c[h])}function n(b,c,h){c="url(#"+c.getAttribute("id")+")";b.rawNode.setAttribute("marker-"+h,c)}var f=-1!==D.renderer.toLowerCase().indexOf("svg"),d=9===a("ie"),e={marker:{markerWidth:"6",markerHeight:"6",markerUnits:"strokeWidth",orient:"auto"},spear:{marker:{end:{viewBox:"0 0 25.4 23.43",refX:"20",refY:"12.76"},start:{viewBox:"-25.4 0 25.4 23.43",
refX:"-20",refY:"12.76"}},path:{common:{d:"M1.63 23.43 L5.37 16.6 L5.37 8.93 L1.63 2.09 L25.4 12.76 L1.63 23.43 Z","stroke-width":"0","fill-opacity":"1"},start:{transform:"matrix(-1, 0, 0, 1, 0, 0)"}}}};a={applyLineMarker:function(b,c,h,g){if(f&&!d){var k=b&&b.rawNode,w=c.marker;h=h||c.color;k&&"none"!==c.style&&h&&w&&"arrow"===w.style&&w.placement?k.getTotalLength&&0===k.getTotalLength()?r(k):(c=-1!==w.placement.indexOf("begin"),w=-1!==w.placement.indexOf("end"),c||w?(k.removeAttribute("stroke-opacity"),
k.setAttribute("opacity",h.a),c?(c=g(b,h,"spear","start"),n(b,c,"start")):k.removeAttribute("marker-start"),w?(h=g(b,h,"spear","end"),n(b,h,"end")):k.removeAttribute("marker-end")):r(k)):k&&r(k)}},createSVGMarker:function(b,c,h,g){h=e[h];var k=m.doc.createElementNS("http://www.w3.org/2000/svg","marker");k.setAttribute("id",c);q(k,e.marker);q(k,h.marker[g]);c=m.doc.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("fill",b.toCss());q(c,h.path.common);q(c,h.path[g]);k.appendChild(c);
return k},create2DColorRamp:function(b){var c=b.surface.createGroup(),h=b.colors,g=b.numClasses;b=(b.size||75)/g;for(var k=0;k<g;k++)for(var w=k*b,t=0;t<g;t++){var C=h[k][t];c.createRect({x:t*b,y:w,width:b,height:b}).setFill(C).setStroke(null)}return c},setSymbolFillColor:function(b,c){if(b)switch(c=c?new y(c):null,b.type){case "simplemarkersymbol":"cross"===b.style||"x"===b.style?b.outline&&b.outline.setColor(c):b.setColor(c);break;case "simplelinesymbol":case "cartographiclinesymbol":case "simplefillsymbol":case "shieldlabelsymbol":case "textsymbol":b.setColor(c)}}};
F.setObject("renderer.utils",a,z);return a})},"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),function(F,m,a,D,z,y,r,q,n){F=F(null,{declaredClass:"esri.layers.TileInfo",constructor:function(f){m.mixin(this,f);this.width=this.cols;this.height=this.rows;this._levelToLOD={};f=this.spatialReference;var d=this.origin;f&&(f=this.spatialReference=new r(f.toJson?f.toJson():f));
d&&(this.origin=new q(d.toJson?d.toJson():d),!d.spatialReference&&f&&this.origin.setSpatialReference(new r(f.toJson())));this.lods=a.map(this.lods,function(c){return new n(c)});a.forEach(this.lods,function(c){this._levelToLOD[c.level]=c},this);f=!1;d=this.spatialReference;var e=this.origin;if(d&&e){var b=d._getInfo();b&&(f=d._isWrappable()&&Math.abs(b.origin[0]-e.x)<=b.dx)}this.isWrappable=f;this._initializeUpsampleLevels()},toJson:function(){return y.fixJson({rows:this.rows,cols:this.cols,dpi:this.dpi,
format:this.format,compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),lods:this.lods&&a.map(this.lods,function(f){return f.toJson()})})},lodAt:function(f){return this._levelToLOD&&this._levelToLOD[f]||null},updateTileInfo:function(f){var d=this.lodAt(f.level),e=d.resolution*this.width;d=d.resolution*this.height;f.id=f.level+"/"+f.row+"/"+f.col;f.extent||(f.extent=[0,0,0,0]);f.extent[0]=this.origin.x+
f.col*e;f.extent[1]=this.origin.y-(f.row+1)*d;f.extent[2]=f.extent[0]+e;f.extent[3]=f.extent[1]+d},upsampleTile:function(f){var d=this._upsampleLevels[f.level];if(!d||-1===d.parentLevel)return!1;f.level=d.parentLevel;f.row=Math.floor(f.row/d.factor+.001);f.col=Math.floor(f.col/d.factor+.001);this.updateTileInfo(f);return!0},_initializeUpsampleLevels:function(){var f=this.lods;this._upsampleLevels=[];for(var d=null,e=0;e<f.length;e++){var b=f[e];this._upsampleLevels[b.level]={parentLevel:d?d.level:
-1,factor:d?d.resolution/b.resolution:0};d=b}}});m.setObject("layers.TileInfo",F,z);return F})},"esri/layers/LOD":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.layers.LOD",constructor:function(y){m.mixin(this,y)},toJson:function(){return z.fixJson({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}});m.setObject("layers.LOD",F,D);return F})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h){m=m([d,e],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_isReference:!1,_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),constructor:function(g,k){k&&(k.roundrobin&&(F.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),k.tileServers=k.roundrobin),this._setTileServers(k.tileServers),
this._loadCallback=k.loadCallback);this._params=a.mixin({},this._url.query);this._initLayer=a.hitch(this,this._initLayer);var w=k&&k.resourceInfo;w?this._initLayer(w):(this._load=a.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_setTileServers:function(g){if(g&&0<g.length){this.tileServers=g;var k,w=g.length;for(k=0;k<w;k++)g[k]=n.urlToObject(g[k]).path}},_initLayer:function(g,k){this.inherited(arguments);this.resourceInfo=
z.toJson(g);this.tileInfo=new b(g.tileInfo);!1!==this.resampling&&(g.capabilities&&-1<g.capabilities.indexOf("Tilemap")?(this.resampling=!0,this.tileMap=new h(this)):this.resampling=!!g.resampling);!this.spatialReference&&this.tileInfo.spatialReference&&(this.spatialReference=new f(this.tileInfo.spatialReference.toJson()));this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;g.timeInfo&&(this.timeInfo=new c(g.timeInfo));g.mensurationCapabilities&&(this.mensurationCapabilities=
g.mensurationCapabilities);var w=this._url.path,t=this._loadCallback,C=n.getProtocolForWebResource(!0),u=w.match(/^https?:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i);u=u&&u[2];if(!this.tileServers)if(g.tileServers)this._setTileServers(g.tileServers);else{var x=-1!==w.search(/^https?:\/\/server\.arcgisonline\.com/i),l=-1!==w.search(/^https?:\/\/services\.arcgisonline\.com/i);(x||l)&&this._setTileServers([w,w.replace(x?/server\.arcgisonline/i:
/services\.arcgisonline/i,x?"services.arcgisonline":"server.arcgisonline")])}if(u){u=u.toLowerCase();for(w=0;w<this._agolAttrs.length;w++)if(x=this._agolAttrs[w],x.toLowerCase()===u){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||C+"//static.arcgis.com/attribution/"+x;break}for(w=0;w<this._referenceLayers.length;w++)if(x=this._referenceLayers[w],x.toLowerCase()===u){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);t&&(delete this._loadCallback,t(this))},getTileUrl:function(g,
k,w){var t=this.tileServers,C=this._getToken(),u=this._url.query;g=(t?t[k%t.length]:this._url.path)+"/tile/"+g+"/"+k+"/"+w;g=n.upgradeToHTTPS(g);this.resampling&&!this.tileMap&&(g+="?blankTile\x3dfalse");u&&(g=this.resampling&&!this.tileMap?g+("\x26"+r.objectToQuery(u)):g+("?"+r.objectToQuery(u)));!C||u&&u.token||(g+=(-1===g.indexOf("?")?"?":"\x26")+"token\x3d"+C);g=this.addTimestampToURL(g);return n.addProxy(g)}});a.setObject("layers.ArcGISTiledMapServiceLayer",m,q);return m})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/dom dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u){F=F(u,{declaredClass:"esri.layers.TiledMapServiceLayer",constructor:function(x,l){m.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=l?l.displayLevels:null)?this._displayLevels[0]:0;this.resampling=l?l.resampling:void 0;this._resamplingTolerance=l?l.resamplingTolerance:null;this.exclusionAreas=l?l.exclusionAreas:null;var v=a.hitch;this._addImage=v(this,this._addImage);this._tileLoadHandler=v(this,this._tileLoadHandler);
this._tileErrorHandler=v(this,this._tileErrorHandler);this._popTile=v(this,this._popTile);this._cleanUpRemovedImages=v(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=v(this,this._fireOnUpdateEvent);this._transitionEnd=v(this,this._transitionEnd);this._tileMapCallback=v(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var x=this.tileInfo,l=x.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=x.width;this._tileH=
x.height;var v=this.scales=[],A=this._displayLevels,B=-Infinity,E=Infinity,G=this.fullExtent,I=new w(G.xmin,G.ymax);G=new w(G.xmax,G.ymin);var L=k.getContainingTileCoords,K,ba=l.length;for(K=0;K<ba;K++){var T=l[K];var P=L(x,I,T);T.startTileRow=0>P.row?0:P.row;T.startTileCol=0>P.col?0:P.col;P=L(x,G,T);T.endTileRow=P.row;T.endTileCol=P.col;A&&-1===D.indexOf(A,T.level)||(v[K]=T.scale,B=T.scale>B?T.scale:B,E=T.scale<E?T.scale:E)}-Infinity===B||this._hasMin||this.setMinScale(B);Infinity===E||this._hasMax||
this.setMaxScale(E);this.setExclusionAreas(this.exclusionAreas);this._patchIE=6<=h("ie")&&7>h("ie")&&(this.isPNG32||"Mixed"===x.format)},isVisibleAtScale:function(x){return x?u.prototype._isMapAtVisibleScale.call(this,x,!0):!1},_isMapAtVisibleScale:function(x){var l=this.inherited(arguments,[x,!0]);if(l){var v=this._map;l=this.scales;var A=v.getScale(),B=!1,E=v.width>v.height?v.width:v.height;for(v=0;v<l.length;v++)if(Math.abs(l[v]-A)/l[v]<1/E){B=!0;break}l=B}return l},_setMap:function(x,l,v,A){this.inherited(arguments);
this._map=x;var B=this._div=y.create("div",null,l),E=x.__visibleDelta,G=m.connect,I=b._css.names,L={position:"absolute",width:x.width+"px",height:x.height+"px",overflow:"visible"},K=c.defaults.map.zoomDuration;"css-transforms"===x.navigationMode?(L[I.transform]=b._css.translate(-E.x,-E.y),n.set(B,L),delete L[I.transform],L[I.transition]=I.transformName+" "+K+"ms ease",n.set(this._active=y.create("div",null,B),L),this._active._remove=0,this._passives=[]):(L.left=-E.x+"px",L.top=-E.y+"px",n.set(B,L));
this._onResizeHandler_connect=G(x,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=G(this,"onOpacityChange",this,"_opacityChangeHandler");E=this.tileInfo;G=E.spatialReference;I=G._getInfo();(this._wrap=x.wrapAround180&&G._isWrappable()&&Math.abs(I.origin[0]-E.origin.x)<=I.dx)&&k._addFrameInfo(E,I);this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension();if(this.suspended&&!x.loaded)var ba=m.connect(x,"onLoad",this,function(){m.disconnect(ba);ba=null;this.setExclusionAreas(this.exclusionAreas);
this.evaluateSuspension()});return B},_unsetMap:function(x,l){this.suspended||this._suspendImpl();y.destroy(this._div);this._map=this._div=null;var v=m.disconnect;v(this._onResizeHandler_connect);v(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){g.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var x=this._tiles,l=this._tileIds,v=this._loadingList,
A,B,E=m.disconnect,G=y.destroy;v&&0<v.count&&(v.forEach(function(L){if(A=x[L])E(A._onload_connect),E(A._onerror_connect),E(A._onabort_connect),A._onload_connect=A._onerror_connect=A._onabort_connect=null}),v.clear(),this._fireUpdateEnd());this._removeList.clear();for(v=l.length-1;0<=v;v--)(A=(B=l[v])&&x[B])&&G(A);if("css-transforms"===this._map.navigationMode){l=this._active;B=this._passives;this._noDom=0;for(v=B.length-1;0<=v;v--){var I=B[v];I._endHandle&&E(I._endHandle);I._matrix=I._multiply=I._endHandle=
null;I._marked=I._remove=0;B.splice(v,1);G(I)}l._matrix=l._multiply=null;l._marked=l._remove=0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new d;this._loadingList=new d;g.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,
null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var x=this._map,l=m.connect;if("css-transforms"===x.navigationMode){if(this._onScaleHandler_connect=l(x,"onScale",this,this._onScaleHandler),h("esri-mobile")){this._standby=[];var v=this,A=function(){v._noDom=1};this._onPanStartHandler_connect=l(x,"onPanStart",A);this._onZoomStartHandler_connect=l(x,"onZoomStart",A)}}else this._onZoomHandler_connect=l(x,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=l(x,"onPan",this,"_onPanHandler");
this._onExtentChangeHandler_connect=l(x,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var x=m.disconnect;x(this._onPanHandler_connect);x(this._onZoomHandler_connect);x(this._onScaleHandler_connect);x(this._onExtentChangeHandler_connect);x(this._onPanStartHandler_connect);x(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=this._onZoomStartHandler_connect=
null},_onResizeHandler:function(x,l,v){x={width:l+"px",height:v+"px"};l=n.set;l(this._div,x);if("css-transforms"===this._map.navigationMode)for(this._active&&l(this._active,x),v=this._passives.length-1;0<=v;v--)l(this._passives[v],x)},_onExtentChangeHandler:function(x,l,v,A){l=this._map;var B=this._standby;clearTimeout(this._wakeTimer);this._wakeTimer=null;if(!l._isPanningOrZooming()){if("css-transforms"===l.navigationMode){if(v)for(A=this._passives.length-1;0<=A;A--){var E=this._passives[A];n.set(E,
b._css.names.transition,"none");E._marked?(this._passives.splice(A,1),E.parentNode&&E.parentNode.removeChild(E),y.destroy(E)):0<E.childNodes.length&&(E._multiply=E._multiply?e.multiply(E._matrix,E._multiply):E._matrix)}this._noDom=0;if(B&&B.length)for(A=B.length-1;0<=A;A--)E=B[A],n.set(E,"visibility","inherit"),this._popTile(E),B.splice(A,1)}this._fireUpdateStart();this._rrIndex=0;A=k.getCandidateTileInfo(l,this.tileInfo,x);x=l.__visibleDelta;if(!this._ct||A.lod.level!==this._ct.lod.level||v){E=A&&
this._ct&&A.lod.level!==this._ct.lod.level;this._ct=A;var G=this._tiles,I=this._tileIds,L=this._tileBounds,K=this._removeList,ba=I.length;this._cleanUpRemovedImages();for(A=0;A<ba;A++){B=I[A];var T=G[B];L[B]=I[A]=null;"css-transforms"===l.navigationMode&&E&&T.parentNode&&l.fadeOnZoom&&(T._fadeOut=E,T.parentNode._remove++);K.add(T)}v&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}A=x.x;v=x.y;"css-transforms"===l.navigationMode?(B={},B[b._css.names.transform]=b._css.translate(A,v),n.set(this._div,
B)):n.set(this._div,{left:A+"px",top:v+"px"});this.__coords_dx=A;this.__coords_dy=v;this._updateImages(new t(0,0,x.width,x.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;v=this._tileW;G=this._tileH;x=new t(-x.x,-x.y,x.width,x.height);for(A=this._tileIds.length-1;0<=A;A--)(B=this._tileIds[A])?(E=this._tiles[B],I=q.getMarginBox(E),I=new t(I.l,I.t,v,G),"css-transforms"===l.navigationMode&&(I.x=E._left,I.y=E._top),x.intersects(I)?
this._tileBounds[B]=I:(this._loadingList.contains(B)&&this._popTile(E),y.destroy(E),this._tileIds.splice(A,1),delete this._tileBounds[B],delete this._tiles[B])):(this._tileIds.splice(A,1),delete this._tileBounds[B],delete this._tiles[B])}},_onPanHandler:function(x,l){var v=this._map,A=v.__visibleDelta.offset(l.x,l.y);this.__coords_dx=this.__coords_dy=0;"css-transforms"===v.navigationMode?(v={},v[b._css.names.transform]=b._css.translate(A.x,A.y),n.set(this._div,v),h("esri-mobile")||this._updateImages({x:-A.x,
y:-A.y,width:A.width,height:A.height})):(n.set(this._div,{left:A.x+"px",top:A.y+"px"}),this._updateImages({x:-A.x,y:-A.y,width:A.width,height:A.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(x,l){var v,A={},B=b._css.names,E=this._map,G=c.defaults.map.zoomDuration;for(v=this._passives.length-1;0<=v;v--){var I=this._passives[v];0===I.childNodes.length?(this._passives.splice(v,1),y.destroy(I)):("none"===I.style[B.transition]&&n.set(I,B.transition,
B.transformName+" "+G+"ms ease"),n.set(I,B.transition,l?"none":B.transformName+" "+G+"ms ease"),I._matrix=x,A[B.transform]=b._css.matrix(I._multiply?e.multiply(x,I._multiply):x),n.set(I,A))}this._active&&0===this._active.childNodes.length||(n.set(this._active,B.transition,l?"none":B.transformName+" "+G+"ms ease"),this._active._matrix=x,A[B.transform]=b._css.matrix(this._active._matrix),n.set(this._active,A),this._passives.push(this._active),A={position:"absolute",width:E.width+"px",height:E.height+
"px",overflow:"visible"},A[B.transition]=B.transformName+" "+G+"ms ease",n.set(this._active=y.create("div",null,this._div),A),this._active._remove=0,E.fadeOnZoom&&y.place(this._active,this._div,"first"))},_onZoomHandler:function(x,l,v){x=q.getMarginBox(this._div);v=v.offset(-x.l,-x.t);this._previousScale&&1!==l||(this._previousScale=1);var A,B=this._tileW*l,E=this._tileH*l,G=this._tileBounds,I=this._tiles,L=this._previousScale,K=this._multiple,ba=n.set,T,P;if((x=h("ie"))&&8>x)D.forEach(this._tileIds,
function(qa){P="";A=G[qa];T=I[qa].style.margin.split(" ");D.forEach(T,function(V){""!==P&&(P+=" ");V=parseFloat(V);P+=V/L*l+"px"});ba(I[qa],{left:A.x-(B-A.width)*(v.x-A.x)/A.width+"px",top:A.y-(E-A.height)*(v.y-A.y)/A.height+"px",margin:1!==K&&-1===P.indexOf("NaN")?P:"",zoom:l})});else{var J=B*K,N=E*K,Z,Y;D.forEach(this._tileIds,function(qa){P="";A=G[qa];Z=A.x-(B-A.width)*(v.x-A.x)/A.width;Y=A.y-(E-A.height)*(v.y-A.y)/A.height;T=I[qa].style.margin.split(" ");D.forEach(T,function(V){""!==P&&(P+=" ");
V=parseFloat(V);P+=V/L*l+"px"});ba(I[qa],{left:Z+"px",top:Y+"px",margin:1!==K&&-1===P.indexOf("NaN")?P:"",width:J+"px",height:N+"px"})})}this._previousScale=l},_updateImages:function(x){if(this._ct){var l=this._tileW,v=this._tileH,A=this._ct;var B=A.lod;A=A.tile;var E=A.offsets,G=A.coords,I=G.row;G=G.col;var L=B.level,K=this.opacity,ba=this._tileIds,T=this._loadingList,P=this._addImage,J=this._map.id,N=this.id,Z=x.x,Y=x.y,qa=B.startTileRow,V=B.endTileRow,na=B.startTileCol,ya=B.endTileCol,S=D.indexOf,
ma=E.x-this.__coords_dx,ja=E.y-this.__coords_dy;var X=l-ma+-x.x;var oa=v-ja+-x.y;var xa=Math.ceil;X=0<X?X%l:l-Math.abs(X)%l;oa=0<oa?oa%v:v-Math.abs(oa)%v;Z=0<Z?Math.floor((Z+ma)/l):xa((Z-(l-ma))/l);Y=0<Y?Math.floor((Y+ja)/v):xa((Y-(v-ja))/v);ja=Z+xa((x.width-X)/l);x=Y+xa((x.height-oa)/v);if(this._wrap){var Ha=B._frameInfo;var Ia=Ha[0];var ia=Ha[1];Ha=Ha[2]}for(oa=Z;oa<=ja;oa++)for(Z=Y;Z<=x;Z++)xa=I+Z,X=G+oa,this._wrap&&(X<ia?(X%=Ia,X=X<ia?X+Ia:X):X>Ha&&(X%=Ia)),!this._isExcluded(L,xa,X)&&xa>=qa&&
xa<=V&&X>=na&&X<=ya&&(B=J+"_"+N+"_tile_"+L+"_"+Z+"_"+oa,-1===S(ba,B)&&(T.add(B),ba.push(B),P(L,Z,xa,oa,X,B,l,v,K,A,E)))}},_cleanUpRemovedImages:function(){var x=this._removeList,l=y.destroy,v,A=b._css.names;x.forEach(function(E){E._fadeOut||(E.style.filter="",E.style.zoom=1,l(E))});if("css-transforms"===this._map.navigationMode)for(v=this._passives.length-1;0<=v;v--){var B=this._passives[v];0===B.childNodes.length?(this._passives.splice(v,1),l(B)):this._map.fadeOnZoom&&!B._marked&&B._remove===B.childNodes.length&&
(B._marked=1,2048>b._css.getScaleFromMatrix(n.get(B,A.transform))?(n.set(B,A.transition,"opacity 0.65s"),n.set(B,"opacity",0),m.disconnect(B._endHandle),B._endHandle=m.connect(B,A.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:B}))}x.clear()},_transitionEnd:function(x){var l=x.target;"opacity"===x.propertyName&&(m.disconnect(l._endHandle),l._endHandle=null,x=D.indexOf(this._passives,l),-1<x&&this._passives.splice(x,1),l.parentNode&&l.parentNode.removeChild(l),y.destroy(l))},
_addImage:function(x,l,v,A,B,E,G,I,L,K,ba){if(this._patchIE)K=this._tiles[E]=y.create("div"),K.id=E,r.add(K,"layerTile"),n.set(K,{left:G*A-ba.x+"px",top:I*l-ba.y+"px",width:G+"px",height:I+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(x,v,B)+"', sizingMethod\x3d'scale')"}),1>L&&n.set(K,"opacity",L),x=K.appendChild(y.create("div")),n.set(x,{opacity:0,width:G+"px",height:I+"px"}),this._div.appendChild(K),K=null,this._loadingList.remove(E),this._fireOnUpdateEvent();
else{K=this._tiles[E]=y.create("img");var T=m.connect;K.id=E;K._uid=x+"_"+v+"_"+B;K.alt="";r.add(K,"layerTile");A=G*A-ba.x;ba=I*l-ba.y;l=this._map;var P=b._css.names;G={width:G+"px",height:I+"px",visibility:"hidden"};"css-transforms"===l.navigationMode?(G[P.transform]=b._css.translate(A,ba),n.set(K,G),K._left=A,K._top=ba):(G.left=A+"px",G.top=ba+"px",n.set(K,G));1>L&&n.set(K,"opacity",L);K._onload_connect=T(K,"onload",this,"_tileLoadHandler");K._onerror_connect=T(K,"onerror",a.hitch(this,"_tileErrorHandler",
v,B));K._onabort_connect=T(K,"onabort",this,"_tileAbortHandler");if(this.tileMap)this.tileMap.getTile(x,v,B,E,this._tileMapCallback);else if(E=this.getTileUrl(x,v,B,K))this._failedRequests&&this._failedRequests[E]?(n.set(K,this._failedRequests[E].css),K.src=this._failedRequests[E].src,this._multiple=parseInt(this._failedRequests[E].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,K.src=E);"css-transforms"===l.navigationMode?this._active.appendChild(K):
this._div.appendChild(K);K=null}},_tileMapCallback:function(x,l){if(!this.suspended){var v=this._tiles[l.id]||f.byId(l.id);var A=l.level+"_"+l.row+"_"+l.col;v&&v._uid===A?(this._multiple=2*(l.level-x.level)||1,this.isResampling=1!==this._multiple,A=this.tileMap.style(x,l),n.set(v,A),v.src=this.getTileUrl(x.level,x.row,x.col)):this._popTile(l)}},getTileUrl:function(x,l,v){},refresh:function(){this.suspended||(this._refreshTS=Date.now(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},
_popTile:function(x){var l=m.disconnect;l(x._onload_connect);l(x._onerror_connect);l(x._onabort_connect);x._onload_connect=x._onerror_connect=x._onabort_connect=null;this._loadingList.remove(x.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(x){x=x.currentTarget;this._noDom?this._standby.push(x):(n.set(x,"visibility","inherit"),this._popTile(x))},_tileAbortHandler:function(x){x=x.currentTarget;this.onError(Error("Unable to load tile: "+x.src));n.set(x,"visibility","hidden");this._popTile(x)},
_tileErrorHandler:function(x,l,v){v=v.currentTarget;var A=!0;if(this.tileMap||!this.resampling)A=!1;else{var B=new z(v.src);B=B.path.split("/");B=parseInt(B[B.length-3]);var E=this._ct.lod.level-B+1;this._multiple=Math.pow(2,E);if(B===this._lowestLevel||0===this._resamplingTolerance||this._resamplingTolerance&&Math.log(this._multiple)/Math.LN2>this._resamplingTolerance)A=!1}A?(this.isResampling=!0,this._resample(v,x,l)):(this.onError(Error("Unable to load tile: "+v.src)),n.set(v,"visibility","hidden"),
this._popTile(v))},_resample:function(x,l,v){var A=(new z(x.src)).path.split("/"),B=this._multiple,E=parseInt(A[A.length-3])-1,G=parseInt(l/B),I=parseInt(v/B);A=v%B;var L=l%B;G=this.getTileUrl(E,G,I);l=this.getTileUrl(E+Math.log(B)/Math.LN2,l,v);B={width:this._tileW*B+"px",height:this._tileH*B+"px",margin:"-"+this._tileW*L+"px 0 0 -"+(this._tileH*A+"px")};this._failedRequests||(this._failedRequests={});this._failedRequests[l]={src:G,css:B};n.set(x,B);h("chrome")&&x.setAttribute("src",null);x.src=
G},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(x){if(this.opacity!=x)this.onOpacityChange(this.opacity=x)},onOpacityChange:function(){},_opacityChangeHandler:function(x){var l=n.set,v,A;if("css-transforms"===this._map.navigationMode){if(this._active){var B=this._active.childNodes;for(v=B.length-1;0<=v;v--)l(B[v],"opacity",x)}for(v=this._passives.length-
1;0<=v;v--)for(B=this._passives[v].childNodes,A=B.length-1;0<=A;A--)l(B[A],"opacity",x)}else for(B=this._div.childNodes,v=B.length-1;0<=v;v--)l(B[v],"opacity",x)},setExclusionAreas:function(x){this.exclusionAreas=x;if(this.loaded&&this._map&&this._map.loaded){var l=this._map.spatialReference,v=this.tileInfo,A=v.origin,B=v.lods,E=B[0].level,G=B[B.length-1].level,I,L,K;if(this.exclusionAreas&&this.exclusionAreas.length){this._exclusionsPerZoom=[];var ba=0;for(I=x.length;ba<I;ba++){var T=x[ba];if((K=
T.geometry)&&"extent"===K.type&&K.xmin<=K.xmax&&K.ymin<=K.ymax){if(!l.equals(K.spatialReference))if(l._canProject(K.spatialReference)){if(l.isWebMercator()){var P=w.lngLatToXY(K.xmin,K.ymin);K=w.lngLatToXY(K.xmax,K.ymax)}else P=w.xyToLngLat(K.xmin,K.ymin,!0),K=w.xyToLngLat(K.xmax,K.ymax,!0);K=new C(P[0],P[1],K[0],K[1],l)}else continue;var J=-1;if(T.minZoom&&-1!==T.minZoom)J=T.minZoom;else if(T.minScale&&-1!==T.minScale){var N=0;for(L=B.length;N<L;N++)if(B[N].scale<=T.minScale){J=B[N].level;break}}J=
Math.max(J,E);P=-1;if(T.maxZoom&&-1!==T.maxZoom)P=T.maxZoom;else if(T.maxScale&&-1!==T.maxScale)for(N=0,L=B.length;N<L;N++)if(B[N].scale<T.maxScale){P=B[N-1].level;break}else if(B[N].scale===T.maxScale){P=B[N].level;break}P=-1===P?G:Math.min(P,G);for(T=J;T<=P;T++){N=0;for(L=B.length;N<L;N++)if(B[N].level===T){var Z=B[N];break}Z&&(this._exclusionsPerZoom[T]||(this._exclusionsPerZoom[T]=[]),N=1/Z.resolution/v.rows,L=1/Z.resolution/v.cols,this._exclusionsPerZoom[T].push({rowFrom:Math.floor((A.y-K.ymax)*
N),rowTo:Math.ceil((A.y-K.ymin)*N),colFrom:Math.floor((K.xmin-A.x)*L),colTo:Math.ceil((K.xmax-A.x)*L)}))}}}}else this._exclusionsPerZoom=null;this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(x,l,v){var A;if(!this._exclusionsPerZoom)return!1;var B=this._exclusionsPerZoom[x];if(!B)return!1;var E=0;for(A=B.length;E<A;E++)if(x=B[E],l>=x.rowFrom&&l<x.rowTo&&v>=x.colFrom&&v<x.colTo)return!0;return!1}});a.setObject("layers.TiledMapServiceLayer",
F,b);return F})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(F,m,a){a.ArrayList=function(D){var z=[];D&&(z=z.concat(D));this.count=z.length;this.add=function(y){z.push(y);this.count=z.length};this.addRange=function(y){if(y.getIterator)for(y=y.getIterator();!y.atEnd();)this.add(y.get());else for(var r=0;r<y.length;r++)z.push(y[r]);this.count=z.length};this.clear=function(){z.splice(0,z.length);this.count=0};this.clone=function(){return new a.ArrayList(z)};
this.contains=function(y){for(var r=0;r<z.length;r++)if(z[r]==y)return!0;return!1};this.forEach=function(y,r){F.forEach(z,y,r)};this.getIterator=function(){return new a.Iterator(z)};this.indexOf=function(y){for(var r=0;r<z.length;r++)if(z[r]==y)return r;return-1};this.insert=function(y,r){z.splice(y,0,r);this.count=z.length};this.item=function(y){return z[y]};this.remove=function(y){y=this.indexOf(y);0<=y&&z.splice(y,1);this.count=z.length};this.removeAt=function(y){z.splice(y,1);this.count=z.length};
this.reverse=function(){z.reverse()};this.sort=function(y){y?z.sort(y):z.sort()};this.setByIndex=function(y,r){z[y]=r;this.count=z.length};this.toArray=function(){return[].concat(z)};this.toString=function(y){return z.join(y||",")}};return a.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(F,m,a){F=m.getObject("dojox.collections",!0);F.DictionaryEntry=function(D,z){this.key=D;this.value=z;this.valueOf=function(){return this.value};
this.toString=function(){return String(this.value)}};F.Iterator=function(D){var z=0;this.element=D[z]||null;this.atEnd=function(){return z>=D.length};this.get=function(){return this.atEnd()?null:this.element=D[z++]};this.map=function(y,r){return a.map(D,y,r)};this.reset=function(){z=0;this.element=D[z]}};F.DictionaryIterator=function(D){var z=[],y={},r;for(r in D)y[r]||z.push(D[r]);var q=0;this.element=z[q]||null;this.atEnd=function(){return q>=z.length};this.get=function(){return this.atEnd()?null:
this.element=z[q++]};this.map=function(n,f){return a.map(z,n,f)};this.reset=function(){q=0;this.element=z[q]}};return F})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(F,m,a,D,z,y,r,q,n,f){F=F(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",infoTemplates:null,constructor:function(d,e){this.layerInfos=[];e&&(this.infoTemplates=
e.infoTemplates||null);var b=this._params={},c=this._url.query?this._url.query.token:null;c&&(b.token=c)},setInfoTemplates:function(d){this.infoTemplates=d},_load:function(){r({url:this._url.path,content:m.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(d,e){try{this._findCredential();(this.credential&&this.credential.ssl||d&&d._ssl)&&
this._useSSL();this.description=d.description;this.copyright=d.copyrightText;this.spatialReference=d.spatialReference&&new q(d.spatialReference);this.initialExtent=d.initialExtent&&new n(d.initialExtent);this.fullExtent=d.fullExtent&&new n(d.fullExtent);this.units=d.units;this.maxRecordCount=d.maxRecordCount;this.maxImageHeight=d.maxImageHeight;this.maxImageWidth=d.maxImageWidth;this.supportsDynamicLayers=d.supportsDynamicLayers;var b=this.layerInfos=[],c=d.layers,h=this._defaultVisibleLayers=[];
a.forEach(c,function(g,k){b[k]=new f(g);g.defaultVisibility&&h.push(g.id)});this.visibleLayers||(this.visibleLayers=h);this.version=d.currentVersion;this.cimVersion=d.cimVersion;this.version||(this.version="capabilities"in d||"tables"in d?10:"supportedImageFormatTypes"in d?9.31:9.3);this.capabilities=d.capabilities;y.isDefined(d.minScale)&&!this._hasMin&&this.setMinScale(d.minScale);y.isDefined(d.maxScale)&&!this._hasMax&&this.setMaxScale(d.maxScale)}catch(g){this._errorHandler(g)}}});m.setObject("layers.ArcGISMapServiceLayer",
F,z);return F})},"esri/layers/LayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(y){m.mixin(this,y)},toJson:function(){return z.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}});m.setObject("layers.LayerInfo",F,D);return F})},
"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(q){null!==q&&(m.mixin(this,q),q.exportOptions&&(this.exportOptions=new r(q.exportOptions)),this.timeExtent=null,q.timeExtent&&2===q.timeExtent.length&&(this.timeExtent=new z(q.timeExtent)),this.timeReference=new y(q.timeReference))}});m.mixin(F,{UNIT_CENTURIES:"esriTimeUnitsCenturies",
UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",UNIT_YEARS:"esriTimeUnitsYears"});m.setObject("layers.TimeInfo",F,D);return F})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(F,
m,a,D){var z=F(null,{declaredClass:"esri.TimeExtent",constructor:function(y){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(y)if(m.isArray(y)){var r=y[0],q=y[1];this.startTime=null===r||"null"===r?null:new Date(r);this.endTime=null===q||"null"===q?null:new Date(q)}else y instanceof Date&&this._create(y,null)},offset:function(y,r){var q=new z,n=this.startTime,f=this.endTime;n&&(q.startTime=this._getOffsettedDate(n,y,r));f&&(q.endTime=this._getOffsettedDate(f,y,r));return q},
intersection:function(y){return this._intersection(this,y)},toJson:function(){var y=[],r=this.startTime;y.push(r?r.getTime():"null");r=this.endTime;y.push(r?r.getTime():"null");return y},_create:function(y,r){this.startTime=y?new Date(y.getTime()):null;this.endTime=r?new Date(r.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",
setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},
esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(y,r){if(y&&r){var q=y.startTime,n=y.endTime,f=r.startTime,d=r.endTime;q=q?q.getTime():-Infinity;f=f?f.getTime():-Infinity;n=n?n.getTime():Infinity;d=d?d.getTime():Infinity;var e,b;f>=q&&f<=n?e=f:q>=f&&q<=d&&(e=q);n>=f&&n<=d?b=n:d>=q&&d<=n&&(b=d);if(isNaN(e)||isNaN(b))return null;q=new z;q.startTime=-Infinity===e?null:new Date(e);q.endTime=Infinity===b?null:new Date(b);return q}return null},
_getOffsettedDate:function(y,r,q){var n=this._refData;y=new Date(y.getTime());r&&q&&(n=n[q],y[n.setter](y[n.getter]()+r*n.multiplier));return y}});return D.TimeExtent=z})},"esri/layers/TimeReference":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.layers.TimeReference",constructor:function(z){z&&m.mixin(this,z)}});m.setObject("layers.TimeReference",F,D);return F})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../lang"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(y){y&&m.mixin(this,y)},toJson:function(){return z.fixJson({timeDataCumulative:this.timeDataCumulative,timeOffset:this.timeOffset,timeOffsetUnits:this.timeOffsetUnits,useTime:this.useTime})}});m.setObject("layers.LayerTimeOptions",F,D);return F})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils".split(" "),
function(F,m,a,D,z,y,r){return F(null,{declaredClass:"esri.layers.TileMap",constructor:function(q){this.layer=q;this._tileMaps={}},getTile:function(q,n,f,d,e){q={id:d,level:q,row:n,col:f};n=this._getResamplingBudget();0<n?this._process({tile:q,requestedTile:q,callback:e,resamplingBudget:n}):(e||this.callback).call(this,q,q)},statusOf:function(q,n,f){var d=this._getResamplingBudget();q={level:q,row:n,col:f};if(0===d)return 1;for(;0<=d;){n=this._tileToTileMap(q);if(!this._tileMaps[n.uid])return-1;n=
this._tileMaps[n.uid];if(!n.promise.isFulfilled())return-1;if(this._isTileAvailable(q,n))return 1;q=this._parentTile(q);if(!q)break;d--}return 0},style:function(q,n){if(q.level!==n.level||q.row!==n.row||q.col!==n.col){var f=this.layer.tileInfo,d=f.lods,e=f.cols;f=f.rows;for(var b,c,h=d.length-1;!b||!c;)b||d[h].level!==q.level||(b=d[h]),c||d[h].level!==n.level||(c=d[h]),h--;b=Math.round(b.resolution/c.resolution);c=n.col%b*-1*e;d=n.row%b*-1*f;b={width:e*b+"px",height:f*b+"px",margin:d+"px 0 0 "+c+
"px","will-change":"transform"};c=0===c?0:-1*c;d=0===d?0:-1*d;b.clip="rect("+d+"px,"+(c+e)+"px,"+(d+f)+"px,"+c+"px)";return b}},_process:function(q){var n=q.tile,f=this._tileToTileMap(n),d=this._parentTile(n);this._getTileMap(f).then(m.hitch(this,function(e){f=e;this._isTileAvailable(n,f)?(q.callback||this.callback).call(this,n,q.requestedTile):0<q.resamplingBudget&&d?(q.resamplingBudget--,q.tile=d,this._process(q)):(q.callback||this.callback).call(this,q.requestedTile,q.requestedTile)}),m.hitch(this,
function(){(q.callback||this.callback).call(this,q.requestedTile,q.requestedTile)}))},_getTileMap:function(q){var n,f,d=null;if(this._tileMaps[q.uid]){q=this._tileMaps[q.uid];var e=q.promise}else{this._tileMaps[q.uid]=q;var b=new D;y({url:this._getTileMapUrl(q.level,q.row,q.col),handleAs:"json",content:{f:"json"},callbackParamName:"callback",timeout:3E3,load:function(c){m.mixin(q,c);if(q.data&&0<q.data.length){f=q.data.length;if(1===f)d=q.data[0];else for(d=q.data[0],n=1;n<f;n++)if(q.data[n]!==d){d=
null;break}null!==d&&(delete q.data,q.value=d);null==q.valid&&(q.valid=!0)}b.resolve(q)},error:function(c){c&&422===c.code?(m.mixin(q,{location:{top:q.row,left:q.col,width:8,height:8},valid:!0,value:0}),b.resolve(q)):b.reject()}});e=q.promise=b.promise}return e},_parentTile:function(q){var n=this.layer.tileInfo.lods,f,d,e=null;a.some(n,function(b,c){return q.level===b.level?(f=b,d=c,!0):!1});0<d&&(n=n[d-1],e={id:q.id,level:n.level,row:Math.floor(q.row*f.resolution/n.resolution+.01),col:Math.floor(q.col*
f.resolution/n.resolution+.01)});return e},_tileToTileMap:function(q){var n=8*Math.floor(q.row/8),f=8*Math.floor(q.col/8);return{uid:q.level+"_"+n+"_"+f,level:q.level,row:n,col:f}},_isTileAvailable:function(q,n){if(n.valid)if(void 0!==n.value)var f=n.value;else{f=n.location.left;var d=n.location.top;f=(q.row-d)*n.location.width+(q.col-f);f=f<n.data.length?n.data[f]:0}else f=0;return f},_getTileMapUrl:function(q,n,f){var d=this.layer,e=d.tileServers,b=d._getToken(),c=d._url.query;q=(e?e[n%e.length]:
d._url.path)+"/tilemap/"+q+"/"+n+"/"+f+"/8/8";c&&(q+="?"+z.objectToQuery(c));!b||c&&c.token||(q+=(-1===q.indexOf("?")?"?":"\x26")+"token\x3d"+b);return q=d.addTimestampToURL(q)},_getResamplingBudget:function(){var q=this.layer,n=0;q.resampling&&(n=q._resamplingTolerance,null===n||void 0===n)&&(n=q.tileInfo.lods.length);return n}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b){var c=F([b],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(h){this.inherited(arguments,[null,h]);this._mapImages=[];var g=a.hitch;this._panStart=g(this,this._panStart);this._pan=g(this,this._pan);this._extentChange=g(this,this._extentChange);this._zoom=g(this,this._zoom);this._zoomStart=g(this,this._zoomStart);this._scale=g(this,this._scale);this._resize=g(this,this._resize);m.connect(this,"onSuspend",this,this._onSuspend);
m.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(h){var g=this._mapImages.push(h);--g;h._idx=g;h._layer=this;this._div&&this._createImage(h,g)},removeImage:function(h){if(h){var g=h._idx,k=this._mapImages;if(k[g]===h){delete k[g];if(g=h._node)this._clearEvents(g),g.e_idx=g.e_bl=g.e_tr=g.e_l=g.e_t=g.e_w=g.e_h=null,g.parentNode&&(g.parentNode.removeChild(g),z.destroy(g));h._node=h._idx=h._layer=null}}},removeAllImages:function(){var h=this._mapImages,
g,k=h.length;for(g=0;g<k;g++){var w=h[g];w&&this.removeImage(w)}this._mapImages=[]},getImages:function(){var h=this._mapImages,g=[],k,w=h.length;for(k=0;k<w;k++)h[k]&&g.push(h[k]);return g},setOpacity:function(h){this.opacity!=h&&(this._opacityChanged(this.opacity=h),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(h){var g=this._div;if(g)if(!n("ie")||8<n("ie"))y.set(g,"opacity",h);else{var k=g.childNodes;var w=k.length;for(g=0;g<w;g++)y.set(k[g],"opacity",h)}},_createImage:function(h,
g){var k=z.create("img");y.set(k,{position:"absolute"});1>h.opacity?y.set(k,"opacity",h.opacity):8>=n("ie")&&y.set(k,"opacity",this.opacity);!h.rotation||9>n("ie")||y.set(k,r._css.names.transform,r._css.rotate(360-h.rotation));h._node=k;k.e_idx=g;k.e_layer=this;k.e_load=m.connect(k,"onload",c.prototype._imageLoaded);k.e_error=m.connect(k,"onerror",c.prototype._imageError);k.e_abort=m.connect(k,"onabort",c.prototype._imageError);k.src=h.href},_imageLoaded:function(h,g){var k=g||h.target||h.currentTarget,
w=k.e_layer,t=w._mapImages[k.e_idx],C=w._map;C&&(C.__zooming||C.__panning||!w._sr)?w._standby.push(k):(w._clearEvents(k),t&&t._node===k&&C&&w._attach(t))},_imageError:function(h){h=h.target||h.currentTarget;var g=h.e_layer,k=g._mapImages[h.e_idx];g._clearEvents(h);k&&(k._node=null)},_clearEvents:function(h){var g=m.disconnect;g(h.e_load);g(h.e_error);g(h.e_abort);h.e_load=h.e_error=h.e_abort=h.e_layer=null},_attach:function(h){var g=h.extent,k=g.spatialReference,w=this._sr,t=this._div,C=h._node,u=
new d({x:g.xmin,y:g.ymin,spatialReference:k});g=new d({x:g.xmax,y:g.ymax,spatialReference:k});w.equals(k)||(w.isWebMercator()&&4326===k.wkid?(u=e.geographicToWebMercator(u),g=e.geographicToWebMercator(g)):k.isWebMercator()&&4326===w.wkid&&(u=e.webMercatorToGeographic(u),g=e.webMercatorToGeographic(g)));C.e_bl=u;C.e_tr=g;h.visible&&(this._setPos(C,t._left,t._top),(this._active||t).appendChild(C))},_setPos:function(h,g,k){var w=h.e_bl,t=h.e_tr,C=this._map;w=C.toScreen(w);t=C.toScreen(t);g=w.x-g;k=t.y-
k;var u=Math.abs(t.x-w.x);w=Math.abs(w.y-t.y);t={width:u+"px",height:w+"px"};var x=this._mapImages[h.e_idx];"css-transforms"===C.navigationMode?t[r._css.names.transform]=r._css.translate(g,k)+(x.rotation?" "+r._css.rotate(360-x.rotation):""):(t.left=g+"px",t.top=k+"px");y.set(h,t);h.e_l=g;h.e_t=k;h.e_w=u;h.e_h=w},managedSuspension:!0,_setMap:function(h,g){this.inherited(arguments);var k=this._div=z.create("div",null,g),w=r._css.names,t={position:"absolute"},C=h.__visibleDelta;if(!n("ie")||8<n("ie"))t.opacity=
this.opacity;"css-transforms"===h.navigationMode?(t[w.transform]=r._css.translate(C.x,C.y),y.set(k,t),k._left=C.x,k._top=C.y,t={position:"absolute",width:h.width+"px",height:h.height+"px",overflow:"visible"},this._active=z.create("div",null,k),y.set(this._active,t),this._passive=z.create("div",null,k),y.set(this._passive,t)):(k._left=0,k._top=0,y.set(k,t));this._standby=[];w=this._mapImages;C=w.length;for(t=0;t<C;t++){var u=w[t];u._node||this._createImage(u,u._idx)}f.hide(k);return k},_unsetMap:function(h,
g){this._disconnect();var k=this._div;if(k){var w=this._mapImages,t,C=w.length;for(t=0;t<C;t++){var u=w[t];if(u){var x=u._node;x&&(this._clearEvents(x),x.e_idx=x.e_bl=x.e_tr=x.e_l=x.e_t=x.e_w=x.e_h=null);u._node=null}}g.removeChild(k);z.destroy(k)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();f.hide(this._div)},_onResume:function(h){h.firstOccurrence&&(this._sr=this._map.spatialReference,this._processStandbyList());
h=this._map;var g=this._div,k=h.__visibleDelta;"css-transforms"===h.navigationMode&&(g._left=k.x,g._top=k.y,y.set(g,r._css.names.transform,r._css.translate(g._left,g._top)));this._redraw("css-transforms"===h.navigationMode);this._connect(h);f.show(g)},_connect:function(h){if(!this._connections){var g=m.connect,k="css-transforms"===h.navigationMode;this._connections=[g(h,"onPanStart",this._panStart),g(h,"onPan",this._pan),g(h,"onExtentChange",this._extentChange),k&&g(h,"onZoomStart",this._zoomStart),
k?g(h,"onScale",this._scale):g(h,"onZoom",this._zoom),k&&g(h,"onResize",this._resize)];k&&this._resize(h.extent,h.width,h.height)}},_disconnect:function(){this._connections&&(D.forEach(this._connections,m.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(h,g){var k=this._div;k._left=this._panL+g.x;k._top=this._panT+g.y;"css-transforms"===this._map.navigationMode?y.set(k,r._css.names.transform,r._css.translate(k._left,k._top)):
y.set(k,{left:k._left+"px",top:k._top+"px"})},_extentChange:function(h,g,k){k?this._redraw("css-transforms"===this._map.navigationMode):g&&this._pan(h,g);this._processStandbyList()},_processStandbyList:function(){var h,g=this._standby;if(g&&g.length)for(h=g.length-1;0<=h;h--)this._imageLoaded(null,g[h]),g.splice(h,1)},_redraw:function(h){if(h){h=this._passive;var g=r._css.names;y.set(h,g.transition,"none");this._moveImages(h,this._active);y.set(h,g.transform,"none")}h=this._active||this._div;g=this._div._left;
var k=this._div._top,w,t=h.childNodes.length;for(w=0;w<t;w++){var C=h.childNodes[w];this._setPos(C,g,k)}},_zoom:function(h,g,k){h=this._div;var w=h._left,t=h._top,C,u=h.childNodes.length;for(C=0;C<u;C++){var x=h.childNodes[C];var l=x.e_w*g,v=x.e_h*g,A=(k.x-w-x.e_l)*(l-x.e_w)/x.e_w,B=(k.y-t-x.e_t)*(v-x.e_h)/x.e_h;A=isNaN(A)?0:A;B=isNaN(B)?0:B;y.set(x,{left:x.e_l-A+"px",top:x.e_t-B+"px",width:l+"px",height:v+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(h,
g){var k=h.childNodes;var w=k.length;if(0<w)for(--w;0<=w;w--)g.appendChild(k[w])},_scale:function(h,g){var k=r._css.names,w=this._passive;y.set(w,k.transition,g?"none":k.transformName+" "+q.defaults.map.zoomDuration+"ms ease");({})[k.transform]=r._css.matrix(h);y.set(w,k.transform,r._css.matrix(h))},_resize:function(h,g,k){y.set(this._active,{width:g+"px",height:k+"px"});y.set(this._passive,{width:g+"px",height:k+"px"})}});a.setObject("layers.MapImageLayer",c,r);return c})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(F,m,a,D,z,y,r,q,n){F=F(q,{declaredClass:"esri.layers.OpenStreetMapLayer",constructor:function(f){this.spatialReference=new y({wkid:102100});this.tileInfo=new n({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},
{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,
resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:.597164283559817},{level:19,scale:1128.497176,resolution:.298582141647617}]});this.fullExtent=
new r({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.initialExtent=new r({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=f&&f.tileServers||["//a.tile.openstreetmap.org","//b.tile.openstreetmap.org","//c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=f?f.displayLevels:null;this.copyright=f&&f.copyright||"Map data \u00a9 OpenStreetMap contributors, CC-BY-SA";
this.loaded=!0;this.onLoad(this);(f=f&&f.loadCallback)&&f(this)},getTileUrl:function(f,d,e){f=this.tileServers[d%this.serversLength]+"/"+f+"/"+e+"/"+d+".png";f=z.normalize(f);f=this.addTimestampToURL(f);return z.addProxy(f)}});m.setObject("layers.OpenStreetMapLayer",F,D);return F})},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/normalizeUtils ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom ./PopupTemplate ./PopupRenderer".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B){F=F([v,A,q],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(E,G){this.initialize();m.mixin(this,E);this.domNode=f.byId(G);var I=this._nls=m.mixin({},B.widgets.popup),L=this.domNode;e.add(L,"esriPopup");(this._isRTL=
!c.isBodyLtr())&&h.set(L,"direction","rtl");d.set(L,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+I.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+I.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+I.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
I.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+I.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d'"+I.NLS_zoomTo+"' class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+I.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=z.query(".sizer",L);I=z.query(".titlePane",L)[0];this._title=z.query(".title",I)[0];this._prevFeatureButton=z.query(".prev",I)[0];this._nextFeatureButton=z.query(".next",I)[0];this._maxButton=z.query(".maximize",I)[0];this._spinner=z.query(".spinner",I)[0];this._contentPane=z.query(".contentPane",L)[0];this._positioner=z.query(".esriPopupWrapper",L)[0];this._pointer=z.query(".pointer",L)[0];this._outerPointer=z.query(".outerPointer",L)[0];this._actionList=z.query(".actionsPane .actionList",
L)[0];this._contentUpdateHandles={};this._eventConnections=[D.connect(z.query(".close",I)[0],"onclick",this,this.hide),D.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),D.connect(this._nextFeatureButton,"onclick",this,this.selectNext),D.connect(this._maxButton,"onclick",this,this._toggleSize),D.connect(z.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),D.connect(this,"onClearFeatures",this,this._featuresCleared),D.connect(this,"onSelectionChange",this,this._featureSelected),
D.connect(this,"onDfdComplete",this,this._updateUI)];y("esri-touch")&&(L=t.setScrollable(this._contentPane),this._eventConnections.push(L[0],L[1]));this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(E){this.inherited(arguments);b.place(this.domNode,E.root);this.highlight&&this.enableHighlight(E);this._maxHeight=h.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(E){this.popupWindow&&
(w.isDefined(E)&&""!==E||(E="\x26nbsp;"),this.destroyDijits(this._title),this.place(E,this._title),this.isShowing&&(this.startupDijits(this._title),this.reposition()))},setContent:function(E){this.popupWindow&&(w.isDefined(E)&&""!==E||(E="\x26nbsp;"),this._destroyContent(),this.place(E,this._contentPane),this.isShowing&&(this._startupContent(),this.reposition()))},show:function(E,G){if(this.popupWindow)if(this._delayHide=!1,E){var I=this.map;if(E.spatialReference){this.location=E;var L=I.toScreen(E)}else this.location=
I.toMap(E),L=E;var K=I._getFrameWidth();if(-1!==K&&(L.x%=K,0>L.x&&(L.x+=K),I.width>K))for(I=(I.width-K)/2;L.x<I;)L.x+=K;this._maximized?this.restore():this._setPosition(L);G&&G.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this._startupContent(),this.reposition(),this.showHighlight(),this.onShow())}else this._toggleVisibility(!0)},hide:function(){this.isShowing&&(this._toggleVisibility(!1),this._unfollowMap(),
this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(E,G){this.popupWindow&&(this._sizers.style({width:E+"px"}),h.set(this._contentPane,"maxHeight",G+"px"),this._maxHeight=G,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&this.location&&!this._maximized&&this.isShowing&&this._setPosition(this.map.toScreen(this.location))},addActions:function(E){return a.map(E,function(G){var I=b.create("a",{href:"javascript:void(0);",className:"action "+
G.className,title:G.title,innerHTML:G.title},this._actionList);D.connect(I,"onclick",G.callback);return{action:G,node:I}},this)},removeActions:function(E){a.forEach(E,function(G){b.destroy(G.node)})},getCurrentAnchor:function(){return this._anchor},maximize:function(){var E=this.map;if(E&&!this._maximized&&this.popupWindow){this._maximized=!0;var G=this._maxButton;e.remove(G,"maximize");e.add(G,"restore");d.set(G,"title",this._nls.NLS_restore);G=this.marginLeft;var I=this.marginTop,L=E.width-2*G;
E=E.height-2*I;h.set(this.domNode,{left:this._isRTL?null:G+"px",right:this._isRTL?G+"px":null,top:I+"px",bottom:null});h.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=h.get(this._sizers[0],"width");this._savedHeight=h.get(this._contentPane,"maxHeight");this._sizers.style({width:L+"px"});h.set(this._contentPane,{maxHeight:E-65+"px",height:E-65+"px"});this._showPointer("");this._unfollowMap();e.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&
this._maximized&&this.popupWindow){this._maximized=!1;var E=this._maxButton;e.remove(E,"restore");e.add(E,"maximize");d.set(E,"title",this._nls.NLS_maximize);h.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();e.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);
this._destroyContent();a.forEach(this._eventConnections,D.disconnect);b.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(E,G){this._transientAnchor=
G&&G.anchor;this.inherited(arguments);this._updateUI()},clearFeatures:function(E){E||(this._transientAnchor=null);this.inherited(arguments)},postscript:null,_highlightSetter:function(E){var G=this.highlight,I=this.map;this.highlight=E;if(I&&E!==G)if(E){if(this.enableHighlight(I),E=this.features&&this.features[this.selectedIndex])this.updateHighlight(I,E),this.showHighlight()}else this.disableHighlight(I)},_pagingControlsSetter:function(E){var G=this.pagingControls,I=this.map;this.pagingControls=E;
I&&E!==G&&this._updatePagingControls()},_pagingInfoSetter:function(E){var G=this.pagingInfo,I=this.map;this.pagingInfo=E;I&&E!==G&&this.features&&this.features.length&&this._updatePagingInfo()},_popupWindowSetter:function(E){var G=this.popupWindow,I=this.map;this.popupWindow=E;I&&E!==G&&(E?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(E){var G=this.anchor;this.anchor=E;this.map&&E!==G&&this.reposition()},_startupContent:function(){var E=this._contentPane;
this.startupDijits(E);a.forEach(this._getPopupRendererDijits(E),function(G){if(!this._contentUpdateHandles[G.id]){var I=G.on("content-update",m.hitch(this,function(){this.reposition()}));this._contentUpdateHandles[G.id]=I}},this)},_destroyContent:function(){var E=this._contentPane;a.forEach(this._getPopupRendererDijits(E),function(G){var I=this._contentUpdateHandles[G.id];I&&(I.remove(),delete this._contentUpdateHandles[G.id])},this);this.destroyDijits(E)},_getPopupRendererDijits:function(E){E=this.getDijits(E);
return E=a.filter(E,function(G){return G&&G.set&&/_PopupRenderer/.test(G.declaredClass)})},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var E=this.selectedIndex;if(0<=E){var G=this.features[E].getContent();if(!this.titleInBody&&G&&m.isString(G.id)){var I=g.byId(G.id);I&&I.set&&/_PopupRenderer/.test(I.declaredClass)&&
I.set("showTitle",!1)}this.setContent(G);this.updateHighlight(this.map,this.features[E]);this.showHighlight()}},_toggleVisibility:function(E){this._setVisibility(E);this.isShowing=E},_setVisibility:function(E){e.toggle(this.domNode,"esriPopupVisible",E);e.toggle(this.domNode,"esriPopupHidden",!E)},_waitAndHide:function(E){var G=this;this._delayHide=!0;setTimeout(function(){G._delayHide&&(G._delayHide=!1,G.hide())},E)},_followMap:function(){this._unfollowMap();var E=this.map;this._handles=[D.connect(E,
"onPanStart",this,this._onPanStart),D.connect(E,"onPan",this,this._onPan),D.connect(E,"onZoomStart",this,this._onZoomStart),D.connect(E,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var E=this._handles;E&&(a.forEach(E,D.disconnect),this._handles=null)},_onPanStart:function(){var E=this.domNode.style;this._panOrigin={left:E.left,top:E.top,right:E.right,bottom:E.bottom}},_onPan:function(E,G){var I=this._panOrigin,L=G.x,K=G.y,ba=I.left,T=I.top,P=I.right;I=I.bottom;ba&&(ba=parseFloat(ba)+
L+"px");T&&(T=parseFloat(T)+K+"px");P&&(P=parseFloat(P)-L+"px");I&&(I=parseFloat(I)-K+"px");h.set(this.domNode,{left:ba,top:T,right:P,bottom:I})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(E,G,I){I&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_getTargetAnchor:function(){return this._transientAnchor||this.anchor},_setPosition:function(E){var G=
E.x,I=E.y;E=this.offsetX||0;var L=this.offsetY||0,K=0,ba=0,T=this.map,P=T.position.x,J=T.position.y,N=T.width,Z=T.height;T="Left";var Y="bottom",qa="right",V="top",na=c.getContentBox(this._positioner),ya=na.w/2,S=na.h/2,ma=h.get(this._sizers[0],"height")+this._maxHeight+h.get(this._sizers[2],"height"),ja=ma/2,X=0,oa=0,xa=N,Ha=Z,Ia=G,ia=I,ea=this._getTargetAnchor().toLowerCase();if("auto"===ea){if(ea=r.getBox)ea=ea(),X=Math.max(ea.l,P),xa=Math.min(ea.l+ea.w,P+N),oa=Math.max(ea.t,J),Ha=Math.min(ea.t+
ea.h,J+Z),Ia+=P,ia+=J;P=ia-oa>=ma;J=Ha-ia>=ma;N=xa-Ia>=na.w;na=Ia-X>=na.w;ia-oa>ja&&Ha-ia>=ja&&(N?(Y="",T="Left",V="",qa="right"):na&&(Y="",T="Right",V="",qa="left"));T&&Y&&Ia-X>ya&&xa-Ia>=ya&&(P?(T="",Y="bottom",qa="",V="top"):J&&(T="",Y="top",qa="",V="bottom"));T&&Y&&(N&&P?(T="Left",Y="bottom",qa="right",V="top"):N&&J?(T="Left",Y="top",qa="right",V="bottom"):na&&J?(T="Right",Y="top",qa="left",V="bottom"):na&&P&&(T="Right",Y="bottom",qa="left",V="top"));this._anchor=V&&qa?V+"-"+qa:V||qa}else Y=T=
"",-1!==ea.indexOf("top")?Y="bottom":-1!==ea.indexOf("bottom")&&(Y="top"),-1!==ea.indexOf("left")?T="Right":-1!==ea.indexOf("right")&&(T="Left"),this._anchor=this._getTargetAnchor();qa=Y+T;switch(qa){case "top":case "bottom":ba=14;break;case "Left":case "Right":K=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":ba=14,K=-16}h.set(this.domNode,{left:G+"px",top:I+"px",right:null,bottom:null});G={left:null,right:null,top:null,bottom:null};T?G[T.toLowerCase()]=K+E+"px":G.left=
-ya+"px";Y?G[Y]=ba+L+"px":G.top=-S+"px";h.set(this._positioner,G);this._showPointer(qa)},_showPointer:function(E){e.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));e.remove(this._outerPointer,["right","left","hidden"]);"Right"===E||"Left"===E?(E=E.toLowerCase(),e.add(this._outerPointer,E)):e.add(this._pointer,E)},_setPagerCallbacks:function(E,G,I){if(this.pagingControls&&(E!==this||this._pagerScope&&this._pagerScope!==this)&&E!==this._pagerScope){this._pagerScope=
E;E===this&&(G=this.selectPrevious,I=this.selectNext);var L=this._eventConnections;D.disconnect(L[1]);D.disconnect(L[2]);G&&(L[1]=D.connect(this._prevFeatureButton,"onclick",E,G));I&&(L[2]=D.connect(this._nextFeatureButton,"onclick",E,I))}},_getLocation:function(E){var G=E&&E.geometry;if(G)switch(G.type){case "point":var I=G;if(E.isAggregate()){E=E.getChildGraphics();var L=E[0];E=(L=L.geometry&&L.geometry.spatialReference)&&new x({points:a.map(E,function(K){K=K.geometry;return[K.x,K.y]}),spatialReference:L.toJson()});
L=l.getDenormalizedExtent(E)}break;case "multipoint":I=G.getPoint(0);L=l.getDenormalizedExtent(G);break;case "polyline":case "polygon":I=G.getPoint(0,0),L=l.getDenormalizedExtent(G)}return[I,L]},_zoomToFeature:function(E){E.preventDefault();var G=this.features,I=this.selectedIndex;E=this.map;if(G)if(I=this._getLocation(G[I]),G=I[0],I=I[1],G||(G=this.location),I&&I.intersects(this.location)||(this.location=G),I&&I.getWidth()&&I.getHeight())E.setExtent(I,!0);else{var L=E.getNumLevels();I=E.getLevel();
var K=E.getMaxZoom(),ba=this.zoomFactor||1;0<L?I!==K&&(L=I+ba,L>K&&(L=K),E.navigationManager._wheelZoom({value:L-I,mapPoint:G},!0)):E.navigationManager._wheelZoom({value:1/Math.pow(2,ba)*2,mapPoint:G},!0)}},_updatePagingControls:function(){var E=this._prevFeatureButton,G=this._nextFeatureButton,I=this.selectedIndex,L=this.features?this.features.length:0;this.pagingControls&&1<L?(0===I?e.add(E,"hidden"):e.remove(E,"hidden"),I===L-1?e.add(G,"hidden"):e.remove(G,"hidden")):(e.add(E,"hidden"),e.add(G,
"hidden"))},_updatePagingInfo:function(){var E=this.features?this.features.length:0,G=this._nls,I="\x26nbsp;";this.pagingInfo&&1<E&&G.NLS_pagingInfo&&(I=w.substitute({index:this.selectedIndex+1,total:E},G.NLS_pagingInfo));E&&(G=this.getSelectedFeature(),E=G.getInfoTemplate(),G=G.getTitle(),E&&!/esri\.InfoTemplate/.test(E.declaredClass)&&this.titleInBody||!G||(I=G+("\x26nbsp;"===I?"":" "+I)));this.setTitle(I)},_updateUI:function(){if(this.popupWindow){var E=this.features,G=this.deferreds,I=E?E.length:
0,L=this._spinner,K=this._actionList,ba=this._nls;this._updatePagingControls();this._updatePagingInfo();I?e.remove(K,"hidden"):e.add(K,"hidden");G&&G.length?E?e.remove(L,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+ba.NLS_searching+"...\x3c/div\x3e"):e.add(L,"hidden");I||G&&G.length?this._delayHide=!1:(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+ba.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay))}}});m.setObject("dijit.Popup",
F,k);return F})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Extent ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e){function b(v,A){return Math.ceil((v-A)/(2*A))}function c(v,A){var B=v.paths||v.rings,E,G,I=B.length;for(E=0;E<I;E++){var L=B[E].length;for(G=0;G<L;G++){var K=v.getPoint(E,G);v.setPoint(E,G,K.offset(A,0))}}return v}function h(v,A){if(!(v instanceof
n||v instanceof f))throw Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var B=v instanceof n,E=[],G;F.forEach(B?v.paths:v.rings,function(I){E.push(G=[]);G.push([I[0][0],I[0][1]]);var L,K;for(L=0;L<I.length-1;L++){var ba=I[L][0];var T=I[L][1];var P=I[L+1][0];var J=I[L+1][1];var N=Math.sqrt((P-ba)*(P-ba)+(J-T)*(J-T));var Z=(J-T)/N;var Y=(P-ba)/N;var qa=N/A;if(1<qa){for(K=1;K<=qa-1;K++){var V=K*A;var na=Y*V+ba;V=Z*V+T;G.push([na,V])}K=(N+Math.floor(qa-1)*A)/2;na=Y*
K+ba;V=Z*K+T;G.push([na,V])}G.push([P,J])}});return B?new n({paths:E,spatialReference:v.spatialReference}):new f({rings:E,spatialReference:v.spatialReference})}function g(v,A,B){A&&(v=h(v,1E6),v=d.webMercatorToGeographic(v,!0));B&&(v=c(v,B));return v}function k(v,A,B){var E=v.x||v[0];if(E>A){var G=b(E,A);v.x?v=v.offset(-2*G*A,0):v[0]=E+-2*G*A}else E<B&&(G=b(E,B),v.x?v=v.offset(-2*G*B,0):v[0]=E+-2*G*B);return v}function w(v,A){var B=-1;F.forEach(A.cutIndexes,function(E,G){var I=A.geometries[G];F.forEach(I.rings||
I.paths,function(L,K){F.some(L,function(ba){if(!(180>ba[0])){ba=0;var T,P=L.length;for(T=0;T<P;T++){var J=L[T][0];ba=J>ba?J:ba}ba=Number(ba.toFixed(9));ba=-360*b(ba,180);P=L.length;for(T=0;T<P;T++)J=I.getPoint(K,T),I.setPoint(K,T,J.offset(ba,0))}return!0})});E===B?I.rings?F.forEach(I.rings,function(L){v[E]=v[E].addRing(L)}):F.forEach(I.paths,function(L){v[E]=v[E].addPath(L)}):(B=E,v[E]=I)});return v}function t(v,A,B,E){var G=new a;G.addCallbacks(B,E);A=A||y.defaults.geometryService;var I=[],L=[],
K,ba,T,P,J,N,Z,Y,qa=0;F.forEach(v,function(S){if(S)if(K||(K=S.spatialReference,ba=K._getInfo(),P=(T=K._isWebMercator())?2.0037508342788905E7:180,J=T?-2.0037508342788905E7:-180,N=T?102100:4326,Z=new n({paths:[[[P,J],[P,P]]],spatialReference:{wkid:N}}),Y=new n({paths:[[[J,J],[J,P]]],spatialReference:{wkid:N}})),ba){var ma=e.fromJson(S.toJson()),ja=S.getExtent();"point"===S.type?I.push(k(ma,P,J)):"multipoint"===S.type?(ma.points=F.map(ma.points,function(X){return k(X,P,J)}),I.push(ma)):"extent"===S.type?
(ma=ja._normalize(null,null,ba),I.push(ma.rings?new f(ma):ma)):ja?(S=2*b(ja.xmin,J)*P,ma=0===S?ma:c(ma,S),ja=ja.offset(S,0),ja.intersects(Z)&&ja.xmax!==P?(qa=ja.xmax>qa?ja.xmax:qa,ma=g(ma,T),L.push(ma),I.push("cut")):ja.intersects(Y)&&ja.xmin!==J?(qa=2*ja.xmax*P>qa?2*ja.xmax*P:qa,ma=g(ma,T,360),L.push(ma),I.push("cut")):I.push(ma)):I.push(ma)}else I.push(S);else I.push(S)});B=new n;E=b(qa,P);for(var V=-90,na=E;0<E;){var ya=-180+360*E;B.addPath([[ya,V],[ya,-1*V]]);V*=-1;E--}0<L.length&&0<na?A?A.cut(L,
B,function(S){L=w(L,S);var ma=[];F.forEach(I,function(ja,X){if("cut"===ja){var oa=L.shift();v[X].rings&&1<v[X].rings.length&&oa.rings.length>=v[X].rings.length?(I[X]="simplify",ma.push(oa)):I[X]=!0===T?d.geographicToWebMercator(oa):oa}});0<ma.length?A.simplify(ma,function(ja){F.forEach(I,function(X,oa){"simplify"===X&&(I[oa]=!0===T?d.geographicToWebMercator(ja.shift()):ja.shift())});G.callback(I)},function(ja){G.errback(ja)}):G.callback(I)},function(S){G.errback(S)}):G.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):
(F.forEach(I,function(S,ma){if("cut"===S){var ja=L.shift();I[ma]=!0===T?d.geographicToWebMercator(ja):ja}}),G.callback(I));return G}function C(v,A,B,E){var G=!1,I;m.isObject(v)&&v&&(m.isArray(v)?v.length&&((I=v[0]&&v[0].declaredClass)&&-1!==I.indexOf("Graphic")?(v=F.map(v,function(L){return L.geometry}),G=v.length?!0:!1):I&&-1!==I.indexOf("esri.geometry.")&&(G=!0)):(I=v.declaredClass)&&-1!==I.indexOf("FeatureSet")?(v=F.map(v.features||[],function(L){return L.geometry}),G=v.length?!0:!1):I&&-1!==I.indexOf("esri.geometry.")&&
(G=!0));G&&A.push({index:B,property:E,value:v})}function u(v,A){var B=[];F.forEach(A,function(E){var G=E.i,I=v[G];E=E.p;var L;if(m.isObject(I)&&I)if(E)if("*"===E[0])for(L in I)I.hasOwnProperty(L)&&C(I[L],B,G,L);else F.forEach(E,function(K){C(m.getObject(K,!1,I),B,G,K)});else C(I,B,G)});return B}function x(v,A){var B=0,E={};F.forEach(A,function(G){var I=G.index,L=G.property,K=G.value,ba=K.length||1,T=v.slice(B,B+ba);m.isArray(K)||(T=T[0]);B+=ba;delete G.value;L?(E[I]=E[I]||{},E[I][L]=T):E[I]=T});return E}
function l(v){for(var A=[],B=0,E=0,G=Math.min,I=Math.max,L=0;L<v.length;L++){for(var K=v[L],ba=null,T=0;T<K.length;T++)ba=K[T],A.push(ba),0===T?E=B=ba[0]:(B=G(B,ba[0]),E=I(E,ba[0]));ba&&A.push([(B+E)/2,0])}return A}D={normalizeCentralMeridian:t,_foldCutResults:w,_prepareGeometryForCut:g,_offsetMagnitude:b,_pointNormalization:k,_updatePolyGeometry:c,_straightLineDensify:h,_createWrappers:function(v){var A=m.isObject(v)?v.prototype:m.getObject(v+".prototype");F.forEach(A.__msigns,function(B){var E=
A[B.n];A[B.n]=function(){var G=this,I=[],L,K=new a(r._dfdCanceller);B.f&&r._fixDfd(K);for(L=0;L<B.c;L++)I[L]=arguments[L];var ba={dfd:K};I.push(ba);var T=[],P;if(G.normalization&&!G._isTable){var J=u(I,B.a);F.forEach(J,function(N){T=T.concat(N.value)});T.length&&(P=t(T))}P?(K._pendingDfd=P,P.addCallbacks(function(N){K.canceled||(ba.assembly=x(N,J),K._pendingDfd=E.apply(G,I))},function(N){var Z=G.declaredClass;Z&&-1!==Z.indexOf("FeatureLayer")?G._resolve([N],null,I[B.e],K,!0):G._errorHandler(N,I[B.e],
K)})):K._pendingDfd=E.apply(G,I);return K}})},_disassemble:u,_addToBucket:C,_reassemble:x,getDenormalizedExtent:function(v){if(!v)return null;var A=v.getExtent();if(!A)return null;var B=v.spatialReference&&v.spatialReference._getInfo();if(!B)return A;var E=B.valid[0];B=B.valid[1];var G=2*B,I=A.getWidth(),L=A.xmax,K=A.xmin;if("extent"===v.type||0===I||I<=B||I>G||L<E||K>B)return A;switch(v.type){case "polygon":if(1<v.rings.length)var ba=l(v.rings);else return A;break;case "polyline":if(1<v.paths.length)ba=
l(v.paths);else return A;break;case "multipoint":ba=v.points}v=Math.min;E=Math.max;G=new q(A.toJson());for(var T=0;T<ba.length;T++){var P=ba[T][0];0>P?(P+=B,K=E(P,K)):(P-=B,L=v(P,L))}G.xmin=L;G.xmax=K;return G.getWidth()<I?(G.xmin-=B,G.xmax-=B,G):A}};m.mixin(m.getObject("geometry",!0,z),D);return D})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../lang ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(F,m,a,D,z,y,r,q,n){function f(c,h,g){var k=
c.rings||c.paths,w,t;var C=0;for(w=k.length;C<w;C++){var u=k[C];var x=0;for(t=u.length;x<t;x++){var l=u[x];if(0<x)v+=l[0],A+=l[1];else{var v=l[0];var A=l[1]}l[0]=h(v);l[1]=g(A)}}return c}var d={esriGeometryPoint:function(c,h,g){c.x=h(c.x);c.y=g(c.y);return c},esriGeometryPolyline:f,esriGeometryPolygon:f,esriGeometryEnvelope:function(c,h,g){c.xmin=h(c.xmin);c.ymin=g(c.ymin);c.xmax=h(c.xmax);c.ymax=g(c.ymax);return c},esriGeometryMultipoint:function(c,h,g){var k=c.points,w;var t=0;for(w=k.length;t<
w;t++){var C=k[t];if(0<t)u+=C[0],x+=C[1];else{var u=C[0];var x=C[1]}C[0]=h(u);C[1]=g(x)}return c}},e={esriGeometryPoint:function(c,h,g){c.x=h(c.x);c.y=g(c.y);return c}},b={createInstance:function(c,h){var g=new c;h&&D.mixin(g,h);return g},fromJson:function(c){if(void 0!==c.x&&void 0!==c.y)return new z(c);if(void 0!==c.paths)return new y(c);if(void 0!==c.rings)return new r(c);if(void 0!==c.points)return new q(c);if(void 0!==c.xmin&&void 0!==c.ymin&&void 0!==c.xmax&&void 0!==c.ymax)return new n(c)},
getJsonType:function(c){return c instanceof z?"esriGeometryPoint":c instanceof y?"esriGeometryPolyline":c instanceof r?"esriGeometryPolygon":c instanceof n?"esriGeometryEnvelope":c instanceof q?"esriGeometryMultipoint":null},getGeometryType:function(c){return"esriGeometryPoint"===c?z:"esriGeometryPolyline"===c?y:"esriGeometryPolygon"===c?r:"esriGeometryEnvelope"===c?n:"esriGeometryMultipoint"===c?q:null},supportsLazyUnquantization:function(c){return"esriGeometryPoint"===c||"esriGeometryPolyline"===
c||"esriGeometryPolygon"===c||"esriGeometryMultipoint"===c},unquantizeFunction:function(c,h){if(c&&h){var g=h.translate[0],k=h.translate[1],w=h.scale[0],t=h.scale[1],C=function(l){return l*w+g},u=function(l){return k-l*t},x=d[c];return function(l){return l?x(l,C,u):null}}},unquantize:function(c,h,g){if(h=b.unquantizeFunction(h,g)){var k=c.length;for(g=0;g<k;g++)h(c[g].geometry)}},quantizeFunction:function(c,h){if(c&&"esriGeometryPoint"===c&&h){var g=h.translate[0],k=h.translate[1],w=h.scale[0],t=
h.scale[1],C=function(l){return Math.round((l-g)/w)},u=function(l){return Math.round((k-l)/t)},x=e[c];return function(l){return l?x(l,C,u):null}}},quantize:function(c,h,g){if(h=b.quantizeFunction(h,g)){var k=c.length;for(g=0;g<k;g++)h(c[g].geometry)}}};F.mixin(F.getObject("geometry",!0,a),b);return b})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d){F=F(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var e=m.hitch;this.__set_title=e(this,this.__set_title);this.__err_title=e(this,this.__err_title);this.__set_content=e(this,this.__set_content);this.__err_content=e(this,this.__err_content)},setMap:function(e){this.map=e},unsetMap:function(e){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},
place:function(e,b){f.isDefined(e)?m.isObject(e)?y.place(e,b,"only"):b.innerHTML=e:b.innerHTML=""},startupDijits:function(e){this._processDijits(e)},destroyDijits:function(e){this._processDijits(e,!0)},getDijits:function(e){var b=[];e&&1===e.children.length&&(e=e.children[0])&&(b=(b=q.byNode(e))?[b]:q.findWidgets(e));return b},_processDijits:function(e,b){var c=this.getDijits(e);a.forEach(c,function(h){if(b){if(h._started&&!h._destroyed)try{h.destroyRecursive?h.destroyRecursive():h.destroy&&h.destroy()}catch(g){}}else if(!h._started)try{h.startup()}catch(g){}})},
__registerMapListeners:function(){this.__unregisterMapListeners();var e=this.map;this.__handles=[D.connect(e,"onPan",this,this.__onMapPan),D.connect(e,"onZoomStart",this,this.__onMapZmStart),D.connect(e,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var e=this.__handles;e&&(a.forEach(e,D.disconnect,D),this.__handles=null)},__onMapPan:function(e,b){this.move(b,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new d(this.coords));this.hide(null,
!0)},__onMapExtChg:function(e,b,c){e=this.map;var h=this.mapCoords;h?this.show(h,null,!0):(b=c?e.toScreen(this.__mcoords):this.coords.offset(b&&b.x||0,b&&b.y||0),this.show(b,null,!0))},__setValue:function(e,b){this[e].innerHTML="";var c="_dfd"+e,h=this[c];h&&-1===h.fired&&(h.cancel(),this[c]=null);f.isDefined(b)&&(b instanceof z?(this[c]=b,b.addCallbacks(this["__set"+e],this["__err"+e])):this.__render(e,b))},__set_title:function(e){this._dfd_title=null;this.__render("_title",e)},__err_title:function(e){this._dfd_title=
null},__set_content:function(e){this._dfd_content=null;this.__render("_content",e)},__err_content:function(e){this._dfd_content=null},__render:function(e,b){var c=this[e];this.place(b,c);this.isShowing&&(this.startupDijits(c),"_title"===e&&this._adjustContentArea&&this._adjustContentArea())}});return n.InfoWindowBase=F})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented ./PopupInfo".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w){function t(C){return"sizeInfo"===C.type}F=F(w,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_mapLevelChangeHandle:null,_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",m.hitch(this,this._resetUpdateEndListeners));
this.on("dfd-complete",m.hitch(this,this._processFeatures));this.on("set-features",m.hitch(this,this._processFeatures));this.on("selection-change",m.hitch(this,this._checkFeatureResolution))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners();this._untrackMapLevelChange()},setFeatures:function(C){if(C&&C.length){this.clearFeatures(!0);var u,x;C[0]instanceof z?x=C:u=C;u?this._updateFeatures(null,u):(this.deferreds=x,x=x.slice(0),a.forEach(x,function(l){l.addBoth(m.hitch(this,
this._updateFeatures,l))},this))}},clearFeatures:function(C){this.features=this.deferreds=this._marked=null;this.count=0;var u=this.selectedIndex;this.selectedIndex=-1;if(-1<u)this.onSelectionChange();this.onClearFeatures({isIntermediate:!!C})},getSelectedFeature:function(){var C=this.features;if(C)return C[this.selectedIndex]},select:function(C){0>C||C>=this.count||(this.selectedIndex=C,this.onSelectionChange())},enableHighlight:function(C){this._highlighted=C.graphics.add(new q(new n(0,0,C.spatialReference)));
this._highlighted.attr("data-popup-highlight","");this._highlighted.hide();this._trackMapLevelChange(C);this.markerSymbol||(C=this.markerSymbol=new b,C.setStyle(b.STYLE_TARGET),C._setDim(16,16,0),C.setOutline(new h(c.STYLE_SOLID,new D([0,255,255]),2,h.CAP_ROUND,h.JOIN_ROUND)),C.setColor(new D([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new c(c.STYLE_SOLID,new D([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new g(g.STYLE_NULL,new c(c.STYLE_SOLID,new D([0,255,255]),2),new D([0,0,0,0])));this.clusterFillSymbol||
(this.clusterFillSymbol=new g(g.STYLE_SOLID,new c(c.STYLE_SOLID,new D([0,255,255]),1.33),null))},disableHighlight:function(C){var u=this._highlighted;u&&(u.hide(),C.graphics.remove(u),delete this._highlighted);this._untrackMapLevelChange();this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var C=this.features&&this.features[this.selectedIndex];this._highlighted&&C&&C.geometry&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},
updateHighlight:function(C,u){var x=u.geometry,l=this._highlighted;if(x&&l){l.hide();!l._graphicsLayer&&C&&C.graphics.add(l);l.setGeometry(f.fromJson(x.toJson()));switch(x.type){case "point":case "multipoint":var v=u.getLayer(),A=u.symbol||v&&v._getSymbol(u);if(v&&A){var B;x=A.xoffset||0;var E=A.yoffset||0,G=A.angle||0;switch(A.type){case "simplemarkersymbol":var I=B=A.size||0;break;case "picturemarkersymbol":I=A.width||0;B=A.height||0;break;case "textsymbol":I=B=A.font&&A.font.size||0}var L=u.symbol?
null:v._getRenderer(u);(v=this._getSizeInfo(L))?A=v=L.getSize(u,{sizeInfo:v,shape:A.style,resolution:C&&C.getResolutionInMeters&&C.getResolutionInMeters()}):null!=u.size?A=v=u.size:(A=I,v=B);L=this.markerSymbol;A&&v&&(x&&(x=x/I*A),E&&(E=E/B*v),L._setDim(A+4,v+4,0));L.setOffset(x,E);L.setAngle(G)}break;case "polyline":L=this.lineSymbol;break;case "polygon":L=this.fillSymbol}l.setSymbol(L)}else l&&l.hide()},showClosestFirst:function(C){var u=this.features;if(u&&u.length){if(1<u.length){var x,l=Infinity,
v=-1,A,B=d.getLength,E=C.spatialReference;C=C.normalize();for(x=u.length-1;0<=x;x--)if(A=u[x].geometry){var G=A.spatialReference;var I=0;try{var L="point"===A.type?A:A.getExtent().getCenter();L=L.normalize();E&&G&&!E.equals(G)&&E._canProject(G)&&(L=E.isWebMercator()?e.geographicToWebMercator(L):e.webMercatorToGeographic(L));I=B(C,L)}catch(K){}0<I&&I<l&&(l=I,v=x)}0<v&&(u.splice(0,0,u.splice(v,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=C)},_trackMapLevelChange:function(C){this._untrackMapLevelChange();
this._mapLevelChangeHandle=C.on("extent-change",m.hitch(this,function(u){u.levelChange&&this._checkFeatureResolution()}))},_untrackMapLevelChange:function(){this._mapLevelChangeHandle&&(this._mapLevelChangeHandle.remove(),this._mapLevelChangeHandle=null)},_unbind:function(C){C=a.indexOf(this.deferreds,C);if(-1!==C)return this.deferreds.splice(C,1),this.deferreds.length?1:(this.deferreds=null,2)},_fireComplete:function(C){var u=this._marked;u&&(this._marked=null,this.showClosestFirst(u));this.onDfdComplete(C)},
_updateFeatures:function(C,u){if(C){if(this.deferreds){var x=this._unbind(C);if(x)if(u&&u instanceof Error){if(this._fireComplete(u),2===x)this.onSetFeatures()}else if(u&&u.length)if(this.features){var l=a.filter(u,function(v){return-1===a.indexOf(this.features,v)},this);this.features=this.features.concat(l);this.count=this.features.length;this._fireComplete();if(2===x)this.onSetFeatures()}else{this.features=u;this.count=u.length;this.selectedIndex=0;this._fireComplete();if(2===x)this.onSetFeatures();
this.select(0)}else if(this._fireComplete(),2===x)this.onSetFeatures()}}else this.features=u,this.count=u.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(C){return C?C.sizeInfo||a.filter(C.visualVariables,t)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers={};a.forEach(this._updateEndHandles,function(C){C.remove()});this._updateEndHandles=[]},_processFeatures:function(){a.forEach(this.features,function(C){(C=C.getLayer())&&!this._featureLayers[C.id]&&
(1===C.currentMode||0===C.currentMode&&6===C.mode)&&C.objectIdField&&C.hasXYFootprint&&C.queryFeatures&&(this._featureLayers[C.id]=C,C=C.on("update-end",m.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(C))},this)},_fLyrUpdateEndHandler:function(C){if(!C.error){var u=this,x=C.target,l=x.getSelectedFeatures(),v=0===x.currentMode&&6===x.mode,A={},B=[];a.forEach(this.features,function(E){if(E.getLayer()===x){var G=E.attributes[x.objectIdField];A[G]=E;B.push(G)}});B.length&&(C=new k,
C.objectIds=B,x.queryFeatures(C,function(E){a.forEach(E.features,function(G){var I=A[G.attributes[x.objectIdField]],L=!1;I.geometry!==G.geometry||x.hasWebGLSurface()?(I.setGeometry(G.geometry),L=!0):v&&l&&-1!==a.indexOf(l,G)&&(L=!0);L&&this._highlighted&&I===this.getSelectedFeature()&&this._highlighted.setGeometry(G.geometry)},u)}))}},_checkFeatureResolution:function(){var C=this.getSelectedFeature(),u=this.map;if(C&&u){var x=C.getLayer();if(x){var l=C.getResolution();2===x.currentMode&&C.geometry&&
l&&l>u.getResolution()&&(u=u.getResolutionForPopup(),(x=this._refetchFeature(C,u,x))&&x.then(m.hitch(this,this._updateFeatureResolution,C,u)))}}},_refetchFeature:function(C,u,x){if(C=this._createQueryForCustomResolution(C,u,x))return x.queryFeatures(C).then(function(l){return l&&l.features[0]})},_createQueryForCustomResolution:function(C,u,x){x=x.objectIdField;var l=C.attributes;l=l&&x&&l[x];if(null==l)return null;var v=new k;v.objectIds=[l];v.maxAllowableOffset=u;v.outFields=[x];v.outSpatialReference=
C.geometry.spatialReference;return v},_updateFeatureResolution:function(C,u,x){C.getResolution()!==u&&(C.setResolution(u),C.setGeometry(x.geometry),this._highlighted&&C===this.getSelectedFeature()&&this._highlighted.setGeometry(C.geometry))}});return r.PopupBase=F})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),function(F,m,a,D,z,y,r,q,n){function f(){}F=F(null,{declaredClass:"esri.Graphic",
constructor:function(d,e,b,c){this._construct();d&&!d.declaredClass?(this.geometry=d.geometry?q.fromJson(d.geometry):null,this.symbol=d.symbol?n.fromJson(d.symbol):null,this.attributes=d.attributes||null,this.infoTemplate=d.infoTemplate?new r(d.infoTemplate):null):(this.geometry=d,this.symbol=e,this.attributes=b,this.infoTemplate=c)},_geomVersion:0,_resolution:null,_shape:null,_bgShape:null,_dataAttrs:null,_layer:null,_sourceLayer:null,_graphicsLayer:null,_parentGraphic:null,_suspended:!1,size:null,
visible:!0,_aggregationSourceLayer:null,_aggregationInfo:null,_computedAttributes:null,_computedVersion:null,_computedGeomVersion:null,_isSnapTarget:!0,getParentGraphic:function(){return this._parentGraphic},setParentGraphic:function(d){this._parentGraphic=d},setSize:function(d){this.size=d;return this},getAggregationSourceLayer:function(){return this._aggregationSourceLayer},setAggregationSourceLayer:function(d){this._aggregationSourceLayer=d;return this},isAggregate:function(){return!!this._aggregationInfo},
getAggregationInfo:function(){return this._aggregationInfo},setAggregationInfo:function(d){this._aggregationInfo=d;return this},getChildGraphics:function(){var d=this.getAggregationSourceLayer();return d?d.getChildGraphics(this):[]},getDojoShape:function(){return this._shape},getShapes:function(){var d=[];this._shape&&d.push(this._shape);this._bgShape&&d.push(this._bgShape);return d},getNode:function(){var d=this._shape&&this._shape.getNode();return d&&d.nodeType?d:null},getNodes:function(){var d=
this.getShapes(),e,b,c=d.length,h=[];for(b=0;b<c;b++)(e=d[b]&&d[b].getNode())&&e.nodeType&&h.push(e);return h},getLayer:function(){return this._layer},getSourceLayer:function(){return this._sourceLayer||this._layer},clone:function(){var d=new this.constructor(this.toJson());d.visible=this.visible;d._layer=this._layer;d._sourceLayer=this._sourceLayer;d._aggregationSourceLayer=this._aggregationSourceLayer;d._aggregationInfo=this._aggregationInfo;d._resolution=this._resolution;return d},draw:function(){var d=
this._graphicsLayer;d&&d._draw(this,!0);return this},setGeometry:function(d){this.geometry=d;this._geomVersion++;var e=this._graphicsLayer;e&&(e._updateExtent(this),this.draw(),d&&"polyline"===d.type&&e._updateSVGMarkers());return this},setResolution:function(d){this._resolution=d;return this},getResolution:function(){return this._resolution},setSymbol:function(d,e){var b=this._graphicsLayer,c=this._shape;this.symbol=d;b&&(e&&c&&b._removeShape(this),this.draw());return this},setAttributes:function(d){this.attributes=
d;this.clearCache();return this},setInfoTemplate:function(d){this.infoTemplate=d;return this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var d=this.getLayer();return this.infoTemplate||d&&d.infoTemplate},getTitle:function(){var d=this.getInfoTemplate(),e=d&&d.title;if(m.isFunction(e))e=e.call(d,this);else if(m.isString(e)){var b=(d=this.getLayer())&&d._getDateOpts;e=y.substitute(this.attributes,e,{first:!0,dateFormat:b&&b.call(d)})}return e},getContent:function(){var d=
this.getInfoTemplate(),e=d&&d.content;if(m.isFunction(e))e=e.call(d,this);else if(m.isString(e)){var b=(d=this.getLayer())&&d._getDateOpts;e=y.substitute(this.attributes,e,{dateFormat:b&&b.call(d)})}return e},attr:function(d,e){null==e||this._dataAttrs||(this._dataAttrs={});this._dataAttrs&&(this._dataAttrs[d]=e,this._setDataAttr(d,e));return this},_isSuspended:function(){return this._suspended},_suspend:function(){this._suspended=!0;this.draw()},_resume:function(){this._suspended=!1;this.draw()},
show:function(){this.visible=!0;this.attr("data-hidden");var d;if(this.getShapes().length){var e=this.getNodes();var b=e.length;for(d=0;d<b;d++)z.show(e[d])}else this.draw();(e=this._graphicsLayer)&&e._graphicVisibilityChanged(this);return this},hide:function(){this.visible=!1;this.attr("data-hidden","");var d=this._graphicsLayer,e,b;if(d){if("canvas-2d"===d.surfaceType)d._removeShape(this);else{var c=this.getNodes();if(b=c.length)for(e=0;e<b;e++)z.hide(c[e])}d._graphicVisibilityChanged(this)}return this},
toJson:function(){var d={};this.geometry&&(d.geometry=this.geometry.toJson());this.attributes&&(d.attributes=m.mixin({},this.attributes));this.symbol&&(d.symbol=this.symbol.toJson());this.infoTemplate&&(d.infoTemplate=this.infoTemplate.toJson());return d},_setDataAttr:function(d,e){var b=this.getNodes(),c,h=b.length;for(c=0;c<h;c++)this._setDOMDataAttr(b[c],d,e)},_setDOMDataAttr:function(d,e,b){null==b?d.removeAttribute(e):d.setAttribute(e,b)},_applyDataAttrs:function(){var d=this._dataAttrs;if(d){var e=
this.getNodes(),b,c=e.length;for(b=0;b<c;b++)for(var h in d)this._setDOMDataAttr(e[b],h,d[h])}},_getViewInfo:function(d){return(d=(d=d||this.getLayer())&&d.getMap())&&d.getViewInfo()},evaluateExpression:function(d,e){return this._getDataValue(d._attributeDef,d._attributeCache,null,null,d,e)},_getDataValue:function(d,e,b,c,h,g){var k=e.id,w=this.attributes,t=d.field,C=e.isNumeric,u=null;if(k){var x=this._computedAttributes,l=this._computedVersion,v=this._computedGeomVersion;c=this._getViewInfo(c);
var A=!(!h||!h.async),B=g&&g.skipCache||A,E=!g||!1!==g.strictReturnType,G=e.dependsOnView||e.isJSFunc,I=e.dependsOnGeometry;x||(x=this._computedAttributes={});G&&!l&&(l=this._computedVersion={});I&&!v&&(v=this._computedGeomVersion={});var L=G&&l[k]!==c.version||I&&v[k]!==this._geomVersion;u=x[k];if(void 0===u||L||B)u=null,e.hasExpr?u=h?h.evaluate(g&&g.context):b.executeFunction(e.compiledFunc,b.createExecContext(this,c)):e.isJSFunc?u=t(this,d):w&&(u=w[t],C&&this._isValidNumber(u)&&(e=d.normalizationType||
"field",b=u,u=null,h=d.normalizationTotal,d=w[d.normalizationField],"log"===e&&0!==b?u=Math.log(b)*Math.LOG10E:"percent-of-total"===e&&this._isValidNumber(h)&&0!==h?u=b/h*100:"field"===e&&this._isValidNumber(d)&&0!==d&&(u=b/d))),E&&(A?C&&(this._construct(),u=u.then(this._sanitizeNumericValue)):u=this._sanitizeValue(u,C)),B||(x[k]=u,G&&(l[k]=c.version),I&&(v[k]=this._geomVersion))}else w&&(u=this._sanitizeValue(w[t],C));return u},_sanitizeValue:function(d,e){e&&!this._isValidNumber(d)&&(d=null);return d},
_sanitizeNumericValue:function(d){return this._sanitizeValue(d,!0)},_construct:function(){this._constructed||(this._sanitizeNumericValue=m.hitch(this,this._sanitizeNumericValue),this._constructed=!0)},_isValidNumber:function(d){return"number"===typeof d&&!isNaN(d)&&Infinity!==d&&-Infinity!==d},clearCache:function(d){if(null!=d){var e=this._computedAttributes,b=this._computedVersion,c=this._computedGeomVersion;e&&(e[d]=void 0);b&&(b[d]=void 0);c&&(c[d]=void 0)}else this._computedAttributes=this._computedVersion=
this._computedGeomVersion=null}});F.prototype.getShape=F.prototype.getDojoShape;f.prototype=F.prototype;F.simpleConstructor=f;return D.Graphic=F})},"esri/InfoTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.InfoTemplate",constructor:function(y,r){y&&m.isObject(y)&&!m.isFunction(y)?m.mixin(this,y):(this.title=y||"${*}",this.content=r||"${*}")},setTitle:function(y){this.title=y;return this},setContent:function(y){this.content=
y;return this},toJson:function(){return z.fixJson({title:this.title,content:this.content})}});return D.InfoTemplate=F})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),function(F,m,a,D,z,y,r,q,n,f,d){var e={createDefaultSymbol:function(b){switch(b){case "esriGeometryPoint":case "esriGeometryMultipoint":var c=
e.createDefaultMarkerSymbol();break;case "esriGeometryPolyline":c=e.createDefaultLineSymbol();break;case "esriGeometryPolygon":case "esriGeometryEnvelope":case "esriGeometryMultiPatch":c=e.createDefaultFillSymbol()}return c},createDefaultMarkerSymbol:function(){return new z},createDefaultLineSymbol:function(){return new r},createDefaultFillSymbol:function(){return new n},getFirstSupportedSymbol:function(b){var c;m.some(b,function(h){h&&-1<e.supportedSymbolTypes.indexOf(h.type)&&(c=h);return!!c});
return c},isPointSymbol:function(b){return b?-1<e.supportedPointSymbolTypes.indexOf(b.type):!1},supportedPointSymbolTypes:["esriSMS","esriPMS","esriTS"],supportedSymbolTypes:"esriSMS esriPMS esriTS esriSLS esriCLS esriSFS esriPFS".split(" "),fromJson:function(b,c){var h=null;switch(b.type){case "esriSMS":h=new z(b);break;case "esriPMS":h=new y(b);break;case "esriTS":h=new d(b);break;case "esriSLS":h=void 0!==b.cap?new q(b):new r(b);break;case "esriCLS":h=new q(b);break;case "esriSFS":h=new n(b);break;
case "esriPFS":h=new f(b);break;default:h=(h=c&&c.geometryType)?e.createDefaultSymbol(h):null}return h},getShapeDescriptors:function(b){return b&&b.getShapeDescriptors?b.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}};F.mixin(F.getObject("symbol",!0,D),e);return e})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),function(F,m,a,D,z,y,r,q){var n={url:"",width:12,
height:12,angle:0,xoffset:0,yoffset:0};F=F(q,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(f,d,e){f?m.isString(f)?(this.url=f,d&&(this.width=d),e&&(this.height=e)):(this.width=D.pt2px(null==f.width?n.width:f.width),this.height=D.pt2px(null==f.height?n.height:f.height),d=f.imageData,9>a("ie")||!d||(e=this.url,this.url="data:"+(f.contentType||"image")+";base64,"+d,this.imageData=e)):(m.mixin(this,n),this.width=D.pt2px(this.width),this.height=D.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(f){this.width=f;return this},setHeight:function(f){this.height=f;return this},setUrl:function(f){f!==this.url&&(delete this.imageData,delete this.contentType);this.url=f;return this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var f=this.url,d=
this.imageData;if(0===f.indexOf("data:")){var e=f;f=d;d=e.indexOf(";base64,")+8;d=e.substr(d)}!m.isString(f)||0!==f.indexOf("/")&&0!==f.indexOf("//")&&0!==f.indexOf("./")&&0!==f.indexOf("../")||(f=r.getAbsoluteUrl(f));e=D.px2pt(this.width);e=isNaN(e)?void 0:e;var b=D.px2pt(this.height);b=isNaN(b)?void 0:b;f=y.fixJson(m.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:f,imageData:d,contentType:this.contentType,width:e,height:b}));delete f.color;delete f.size;f.imageData||delete f.imageData;
return f}});F.defaultProps=n;m.setObject("symbol.PictureMarkerSymbol",F,z);z.symbol.defaultPictureMarkerSymbol=n;return F})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(F,m,a,D,z,y,r,q){var n={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",
STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},f={color:[0,0,0,1],style:n.STYLE_SOLID,width:1,cap:n.CAP_BUTT,join:n.JOIN_MITER,miterLimit:10};F=F(q,{declaredClass:"esri.symbol.CartographicLineSymbol",type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",
round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",bevel:"esriLJSBevel"},constructor:function(d,e,b,c,h,g){d?m.isString(d)?(this.style=d,e&&(this.color=e),void 0!==b&&(this.width=b),c&&(this.cap=c),h&&(this.join=h),void 0!==g&&(this.miterLimit=g)):(this.cap=r.valueOf(this._caps,d.cap),this.join=r.valueOf(this._joins,d.join),this.width=z.pt2px(d.width),this.miterLimit=z.pt2px(d.miterLimit)):(m.mixin(this,f),this.color=new a(this.color),this.width=z.pt2px(this.width),
this.miterLimit=z.pt2px(this.miterLimit))},setCap:function(d){this.cap=d;return this},setJoin:function(d){this.join=d;return this},setMiterLimit:function(d){this.miterLimit=d;return this},getStroke:function(){return m.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===n.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){var d=
z.px2pt(this.miterLimit);d=isNaN(d)?void 0:d;return r.fixJson(m.mixin(this.inherited("toJson",arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:d}))}});m.mixin(F,n);F.defaultProps=f;m.setObject("symbol.CartographicLineSymbol",F,y);y.symbol.defaultCartographicLineSymbol=f;return F})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),
function(F,m,a,D,z,y,r,q,n,f){var d={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},e={style:d.STYLE_SOLID,color:[0,0,0,.25]};F=F(q,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",
_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal",cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(b,c,h){b?m.isString(b)?(this.style=b,void 0!==c&&(this.outline=c),void 0!==h&&(this.color=h)):this.style=r.valueOf(this._styles,b.style):(m.mixin(this,e),this.outline=new n(this.outline),this.color=new a(this.color))},setStyle:function(b){this.style=
b;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var b=this.style;return b===d.STYLE_NULL?null:b===d.STYLE_SOLID?this.color:m.mixin({},z.defaultPattern,{src:f.toUrl("../images/symbol/sfs/"+b+".png"),width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return r.fixJson(m.mixin(this.inherited("toJson",
arguments),{type:"esriSFS",style:this._styles[this.style]}))}});m.mixin(F,d);F.defaultProps=e;m.setObject("symbol.SimpleFillSymbol",F,y);y.symbol.defaultSimpleFillSymbol=e;return F})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),function(F,m,a,D,z,y){F=F(z,{declaredClass:"esri.symbol.FillSymbol",constructor:function(r){r&&m.isObject(r)&&r.outline&&(this.outline=new y(r.outline))},setOutline:function(r){this.outline=
r;return this},toJson:function(){var r=this.inherited("toJson",arguments);this.outline&&(r.outline=this.outline.toJson());return r}});m.setObject("symbol.FillSymbol",F,D);return F})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),function(F,m,a,D,z,y,r,q){var n={xoffset:0,yoffset:0,width:12,height:12};F=F(q,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",
xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(f,d,e,b){f?m.isString(f)?(this.url=f,void 0!==d&&(this.outline=d),void 0!==e&&(this.width=e),void 0!==b&&(this.height=b)):(this.xoffset=D.pt2px(f.xoffset),this.yoffset=D.pt2px(f.yoffset),this.width=D.pt2px(f.width),this.height=D.pt2px(f.height),d=f.imageData,9>a("ie")||!d||(e=this.url,this.url="data:"+(f.contentType||"image")+";base64,"+d,this.imageData=e)):(m.mixin(this,n),this.width=D.pt2px(this.width),this.height=D.pt2px(this.height))},
setWidth:function(f){this.width=f;return this},setHeight:function(f){this.height=f;return this},setOffset:function(f,d){this.xoffset=f;this.yoffset=d;return this},setUrl:function(f){f!==this.url&&(delete this.imageData,delete this.contentType);this.url=f;return this},setXScale:function(f){this.xscale=f;return this},setYScale:function(f){this.yscale=f;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return m.mixin({},D.defaultPattern,{src:this.url,
width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var f=this.url,d=this.imageData;if(0===f.indexOf("data:")){var e=f;f=d;d=e.indexOf(";base64,")+8;d=e.substr(d)}!m.isString(f)||0!==f.indexOf("/")&&0!==f.indexOf("//")&&0!==f.indexOf("./")&&0!==f.indexOf("../")||(f=r.getAbsoluteUrl(f));
e=D.px2pt(this.width);e=isNaN(e)?void 0:e;var b=D.px2pt(this.height);b=isNaN(b)?void 0:b;var c=D.px2pt(this.xoffset);c=isNaN(c)?void 0:c;var h=D.px2pt(this.yoffset);h=isNaN(h)?void 0:h;f=y.fixJson(m.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:f,imageData:d,contentType:this.contentType,width:e,height:b,xoffset:c,yoffset:h,xscale:this.xscale,yscale:this.yscale}));f.imageData||delete f.imageData;return f}});F.defaultProps=n;m.setObject("symbol.PictureFillSymbol",F,z);z.symbol.defaultPictureFillSymbol=
n;return F})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(F,m,a,D,z,y,r,q,n){var f={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:D.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},d={start:"left",middle:"center",end:"right"},e={left:"start",center:"middle",right:"end",justify:"start"},b={top:"text-before-edge",middle:"central",
baseline:"alphabetic",bottom:"text-after-edge"},c=document.createElement("canvas");F=F(q,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(h,g,k){m.mixin(this,f);this.font=new n(this.font);this.color=new r(this.color);h&&(m.isObject(h)?(m.mixin(this,h),this.color&&y.isDefined(this.color[0])&&(this.color=r.toDojoColor(this.color)),this.type="textsymbol",this.font=new n(this.font),this.xoffset=D.pt2px(this.xoffset),this.yoffset=D.pt2px(this.yoffset),this.angle&&
(this.angle*=-1),this.haloSize&&(this.haloSize=D.pt2px(this.haloSize)),this.haloColor&&(this.haloColor=r.toDojoColor(this.haloColor))):(this.text=h,g&&(this.font=g),k&&(this.color=k)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(h){this.font=h;return this},setSize:function(h){this.font.size=h;return this},setAngle:function(h){this.angle=h;return this},setOffset:function(h,g){this.xoffset=h;this.yoffset=g;return this},setHaloColor:function(h){this.haloColor=h;return this},setHaloSize:function(h){this.haloSize=
h;return this},setAlign:function(h){this.align=h;this.setHorizontalAlignment(h&&d[h.toLowerCase()]||"center");return this},setHorizontalAlignment:function(h){this.horizontalAlignment=h;return this},getSVGAlign:function(){var h=this.horizontalAlignment;return h=h&&e[h.toLowerCase()]||"middle"},setVerticalAlignment:function(h){this.verticalAlignment=h;return this},getSVGBaseline:function(){var h=this.verticalAlignment;return h&&b[h.toLowerCase()]||"alphabetic"},getSVGBaselineShift:function(){return"bottom"===
this.verticalAlignment?"super":null},setDecoration:function(h){this.decoration=h;this.font||this.setFont(new n);this.font.setDecoration(h);return this},setRotated:function(h){this.rotated=h;return this},setKerning:function(h){this.kerning=h;return this},setText:function(h){this.text=h;return this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var h=c&&c.getContext&&c.getContext("2d");if(h){var g=this.font;h.font=(g.style?g.style:D.defaultFont.style)+" "+
(g.weight?g.weight:D.defaultFont.weight)+" "+(g.size?g.size:D.defaultFont.size)+"px "+(g.family?g.family:D.defaultFont.family);return h.measureText(this.text).width}h=this.getHeight();g=0;var k;for(k=0;k<this.text.length;k++){var w=this.text.charAt(k);g=w==w.toUpperCase()?g+.7*h:g+.5*h}return g},getHeight:function(){return D.normalizedLength(this.font.size)},getShapeDescriptors:function(){var h=this.font;if(h){var g={};h.size&&(g.size=h.size);h.style&&(g.style=h.style);h.variant&&(g.variant=h.variant);
h.decoration&&(g.decoration=h.decoration);h.weight&&(g.weight=h.weight);h.family&&(g.family=h.family)}return{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",decoration:this.decoration||h&&h.decoration,rotated:this.rotated,kerning:this.kerning},font:g,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var h=D.px2pt(this.xoffset),g=D.px2pt(this.yoffset),k=D.px2pt(this.haloSize);h=isNaN(h)?void 0:h;g=isNaN(g)?void 0:g;k=isNaN(k)?void 0:k;return y.fixJson(m.mixin(this.inherited("toJson",
arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:k,haloColor:this.haloColor&&r.toJsonColor(this.haloColor),verticalAlignment:this.verticalAlignment,horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:h,yoffset:g,text:this.text,rotated:this.rotated,kerning:this.kerning,font:this.font.toJson()}))}});m.mixin(F,{ALIGN_START:"start",
ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});F.defaultProps=f;m.setObject("symbol.TextSymbol",F,z);z.symbol.defaultTextSymbol=f;return F})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.symbol.Font",constructor:function(r,q,n,f,d){r?m.isObject(r)?
m.mixin(this,r):(this.size=r,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==q&&(this.style=q),void 0!==n&&(this.variant=n),void 0!==f&&(this.weight=f),void 0!==d&&(this.family=d)):m.mixin(this,D.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>a("ie")&&this.size&&m.isString(this.size)&&-1<this.size.indexOf("em")&&(this.size=D.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},setSize:function(r){this.size=this._convert2PxSize(r);return this},
_convert2PxSize:function(r){var q;parseFloat(r)==r?q=r:m.isString(r)&&(-1<r.indexOf("pt")?q=D.pt2px(parseFloat(r)):-1<r.indexOf("px")?q=parseFloat(r):-1<r.indexOf("em")?q=D.pt2px(12*parseFloat(r)):-1<r.indexOf("%")&&(q=D.pt2px(.12*parseFloat(r))));return q},setStyle:function(r){this.style=r;return this},setVariant:function(r){this.variant=r;return this},setWeight:function(r){this.weight=r;return this},setFamily:function(r){this.family=r;return this},setDecoration:function(r){this.decoration=r;return this},
toJson:function(){return y.fixJson({size:D.px2pt(this.size),style:this.style,decoration:this.decoration,weight:this.weight,family:this.family})}});m.mixin(F,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});m.setObject("symbol.Font",F,z);return F})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship ./QueryTask ./RelationshipQuery ./StatisticDefinition".split(" "),
function(F,m,a,D,z,y,r,q){var n=F(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=n.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnCentroid:null,returnDistinctValues:!1,returnExceededLimitFeatures:null,maxRecordCountFactor:null,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,
resultOffset:null,resultRecordCount:null,resultType:null,cacheHint:null,sqlFormat:null,quantizationParameters:null,_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(f){var d={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,
geometryPrecision:this.geometryPrecision,sqlFormat:this.sqlFormat},e=f&&f.geometry||this.geometry,b=this.objectIds,c=this.outFields,h=this.outSpatialReference,g=this.groupByFieldsForStatistics,k=this.orderByFields,w=this.outStatistics;f=this.distance;e&&(d.geometry=e,d.geometryType=r.getJsonType(e),d.inSR=e.spatialReference.wkid||D.toJson(e.spatialReference.toJson()));b&&(d.objectIds=b.join(","));c&&(d.outFields=c.join(","));null!=this.returnCentroid&&(d.returnCentroid=this.returnCentroid);this.returnDistinctValues&&
(d.returnDistinctValues=!0);null!=this.returnExceededLimitFeatures&&(d.returnExceededLimitFeatures=this.returnExceededLimitFeatures);null!=this.maxRecordCountFactor&&(d.maxRecordCountFactor=this.maxRecordCountFactor);g&&(d.groupByFieldsForStatistics=g.join(","));k&&(d.orderByFields=k.join(","));if(w){var t=[];a.forEach(w,function(C){t.push(C.toJson())});d.outStatistics=D.toJson(t)}h?d.outSR=h.wkid||D.toJson(h.toJson()):e&&(d.outSR=e.spatialReference.wkid||D.toJson(e.spatialReference.toJson()));e=
this.timeExtent;d.time=e?e.toJson().join(","):null;(e=this.relationParam)&&this.spatialRelationship===n.SPATIAL_REL_RELATION&&(d.relationParam=e);f&&(d.distance=this.distance,this.hasOwnProperty("units")?d.units=this._units[this.units]||this._units.meters:d.units=this._units.meters);this.hasOwnProperty("start")&&(d.resultOffset=this.start,d.resultRecordCount=10,""===d.where&&(d.where="1\x3d1"));this.hasOwnProperty("num")&&(d.resultRecordCount=this.num);d.resultType=this.resultType;null!=this.cacheHint&&
(d.cacheHint=this.cacheHint);d.pixelSize=this.pixelSize?D.toJson(this.pixelSize.toJson()):null;d.multipatchOption=this.multipatchOption;this.quantizationParameters&&(d.quantizationParameters=D.toJson(this.quantizationParameters));d._ts=this._ts;return d}});m.mixin(n,q);m.setObject("tasks.Query",n,y);return n})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(F,m,a){m={SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",
SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"};F.setObject("tasks._SpatialRelationship",m,a);return m})},"esri/tasks/QueryTask":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/DeferredList ../kernel ../sniff ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h){var g=n("esri-pbf"),k=m(null,{url:null,query:null,requestOptions:null,pagination:null,pageSize:null,_fetchDfd:null,_startPage:null,_result:null,constructor:function(t){this._handleSuccess=a.hitch(this,this._handleSuccess);this._handleError=a.hitch(this,this._handleError);a.mixin(this,t);null==this.pagination&&(this.pagination=!1);null==this.pageSize&&(this.pageSize=1E3)},execute:function(){var t=new z(this._canceler);this._fetchDfd=t;this._result=null;this._sendRequest();
return t.promise},_canceler:function(t){var C=t._pendingRequest;if(!t.isFulfilled()&&C&&!C.isFulfilled()){C.cancel();var u=C.results&&C.results[1]}t._pendingRequest=null;return u},_sendRequest:function(t){var C=this.query;this.pagination&&(this._startPage=C.resultOffset=null==t?0:t,C.resultRecordCount=this.pageSize);t=this.requestOptions;this._fetchDfd._pendingRequest=f({url:this.url,content:C,handleAs:"pbf"===C.f?"arraybuffer":"json",callbackParamName:"callback",timeout:t&&t.timeout},t);this._fetchDfd._pendingRequest.then(this._handleSuccess).otherwise(this._handleError)},
_handleSuccess:function(t){this.pagination?(t.exceededTransferLimit&&this._sendRequest(this._startPage+this.pageSize),this._result?this._result.features=this._result.features.concat(t.features):this._result=t,this._fetchDfd.progress(t),t.exceededTransferLimit||this._fetchDfd.resolve(this._result)):(this._fetchDfd.progress(t),this._fetchDfd.resolve(t))},_handleError:function(t){this._fetchDfd.reject(t)}}),w=m(c,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],
"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},constructor:function(t,C){this._handler=a.hitch(this,this._handler);this._relationshipQueryHandler=a.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=a.hitch(this,this._executeForIdsHandler);this._countHandler=a.hitch(this,this._countHandler);this._extentHandler=a.hitch(this,this._extentHandler);this.source=C&&C.source;this.gdbVersion=C&&C.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",
c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"rawExecute",c:2,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onRawExecuteComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},execute:function(t,C,u,x,l){var v=
l.assembly;t=this._encode(a.mixin({},this._url.query,{f:x&&x.format||"json"},t.toJson(v&&v[0])));var A=this._handler,B=this._errorHandler;this.source&&(x={source:this.source.toJson()},t.layer=y.toJson(x));this.gdbVersion&&(t.gdbVersion=this.gdbVersion);var E="pbf"===t.f;if(E){var G;g||(G="QueryTask.execute: 'pbf' format is not supported in your browser.");if(G)return t=new z,t.addErrback(function(I){B(I,u,l.dfd)}),t.reject(Error(G)),t}G=this.requestOptions;G=f({url:this._url.path+"/query",content:t,
callbackParamName:"callback",handleAs:E?"arraybuffer":"json",timeout:G&&G.timeout},G);t=[G];E&&t.push(w.loadPBFReader());(new r(t)).then(function(I){l.dfd.isFulfilled()||(I=I[0],I[0]?A(I[1],E,C,u,l.dfd):B(I[1],u,l.dfd))});return G},rawExecute:function(t,C,u){C=C||{};t=this._encode(a.mixin({},this._url.query,{f:C.format||"json"},t.toJson(u.assembly&&u.assembly[0])));this.source&&(t.layer=y.toJson({source:this.source.toJson()}));this.gdbVersion&&(t.gdbVersion=this.gdbVersion);return(new k({url:this._url.path+
"/query",query:t,requestOptions:this.requestOptions,pagination:C.pagination,pageSize:C.pageSize})).execute().then(null,null,function(x){u.dfd.progress(x)}).then(a.hitch(this,function(x){this._successHandler([x],"onRawExecuteComplete",null,u.dfd)})).otherwise(a.hitch(this,function(x){this._errorHandler(x,null,u.dfd)}))},executeRelationshipQuery:function(t,C,u){t=this._encode(a.mixin({},this._url.query,{f:"json"},t.toJson()));var x=this._relationshipQueryHandler,l=this._errorHandler;this.gdbVersion&&
(t.gdbVersion=this.gdbVersion);var v=new z(d._dfdCanceller),A=this.requestOptions,B=this._url.path;this.source&&void 0!==this.source.mapLayerId&&null!==this.source.mapLayerId&&B.endsWith("/dynamicLayer")&&(B=B.slice(0,-13),B=B+"/"+this.source.mapLayerId);v._pendingDfd=f({url:B+"/queryRelatedRecords",content:t,callbackParamName:"callback",timeout:A&&A.timeout,load:function(E,G){x(E,G,C,u,v)},error:function(E){l(E,u,v)}},A);return v},executeForIds:function(t,C,u,x){var l=x.assembly;t=this._encode(a.mixin({},
this._url.query,{f:"json",returnIdsOnly:!0},t.toJson(l&&l[0])));var v=this._executeForIdsHandler,A=this._errorHandler;this.source&&(l={source:this.source.toJson()},t.layer=y.toJson(l));this.gdbVersion&&(t.gdbVersion=this.gdbVersion);l=this.requestOptions;return f({url:this._url.path+"/query",content:t,callbackParamName:"callback",timeout:l&&l.timeout,load:function(B,E){v(B,E,C,u,x.dfd)},error:function(B){A(B,u,x.dfd)}},l)},executeForCount:function(t,C,u,x){var l=x.assembly;t=this._encode(a.mixin({},
this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},t.toJson(l&&l[0])));var v=this._countHandler,A=this._errorHandler;this.source&&(l={source:this.source.toJson()},t.layer=y.toJson(l));this.gdbVersion&&(t.gdbVersion=this.gdbVersion);l=this.requestOptions;return f({url:this._url.path+"/query",content:t,callbackParamName:"callback",timeout:l&&l.timeout,load:function(B,E){v(B,E,C,u,x.dfd)},error:function(B){A(B,u,x.dfd)}},l)},executeForExtent:function(t,C,u,x){var l=x.assembly;t=this._encode(a.mixin({},
this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},t.toJson(l&&l[0])));var v=this._extentHandler,A=this._errorHandler;this.source&&(l={source:this.source.toJson()},t.layer=y.toJson(l));this.gdbVersion&&(t.gdbVersion=this.gdbVersion);l=this.requestOptions;return f({url:this._url.path+"/query",content:t,callbackParamName:"callback",timeout:l&&l.timeout,load:function(B,E){v(B,E,C,u,x.dfd)},error:function(B){A(B,u,x.dfd)}},l)},_handler:function(t,C,u,x,l){try{t&&C&&(t=w.pbfDeps.optimizedFeatures.convertToFeatureSet(w.pbfDeps.pbfQueryUtils.parsePBFFeatureQuery(t)));
var v=new h(t);this._successHandler([v],"onComplete",u,l)}catch(A){this._errorHandler(A,x,l)}},_relationshipQueryHandler:function(t,C,u,x,l){try{var v=t.geometryType,A=t.spatialReference,B={};D.forEach(t.relatedRecordGroups,function(E){var G={};G.geometryType=v;G.spatialReference=A;G.features=E.relatedRecords;G=new h(G);if(null!=E.objectId)B[E.objectId]=G;else for(var I in E)E.hasOwnProperty(I)&&"relatedRecords"!==I&&(B[E[I]]=G)});this._successHandler([B],"onExecuteRelationshipQueryComplete",u,l)}catch(E){this._errorHandler(E,
x,l)}},_executeForIdsHandler:function(t,C,u,x,l){try{this._successHandler([t.objectIds],"onExecuteForIdsComplete",u,l)}catch(v){this._errorHandler(v,x,l)}},_countHandler:function(t,C,u,x,l){try{var v=t.features,A=t.objectIds;if(A)var B=A.length;else{if(v)throw Error("Unable to perform query. Please check your parameters.");B=t.count}this._successHandler([B],"onExecuteForCountComplete",u,l)}catch(E){this._errorHandler(E,x,l)}},_extentHandler:function(t,C,u,x,l){try{t.extent&&(t.extent=new e(t.extent)),
this._successHandler([t],"onExecuteForExtentComplete",u,l)}catch(v){this._errorHandler(v,x,l)}}});w.loadPBFReader=function(){var t=new z;w.pbfDeps?t.resolve():F(["./support/pbfDeps"],function(C){w.pbfDeps=C;t.isFulfilled()||t.resolve()});return t.promise};b._createWrappers(w);a.setObject("tasks.QueryTask",w,q);return w})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(F,m,a){F.DeferredList=function(D,z,y,r,q){var n=[];m.call(this);var f=this;0!==
D.length||z||this.resolve([0,[]]);var d=0;a.forEach(D,function(e,b){function c(h,g){n[b]=[h,g];d++;d===D.length&&f.resolve(n)}e.then(function(h){z?f.resolve([b,h]):c(!0,h)},function(h){y?f.reject(h):c(!1,h);if(r)return null;throw h;})})};F.DeferredList.prototype=new m;F.DeferredList.prototype.gatherResults=function(D){D=new F.DeferredList(D,!1,!0,!1);D.addCallback(function(z){var y=[];a.forEach(z,function(r){y.push(r[1])});return y});return D};return F.DeferredList})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),
function(F,m,a,D,z,y,r,q){F=F(q,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(n,f){n&&m.isString(n)&&(this._url=r.urlToObject(this.url=n));f&&f.requestOptions&&(this.requestOptions=f.requestOptions);this.normalization=!0;this._errorHandler=m.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var n=this._url,f=/^http:/i;this.url&&(this.url=this.url.replace(f,"https:"));n&&n.path&&(n.path=n.path.replace(f,"https:"))},
_encode:function(n,f,d){var e={},b;for(b in n)if("declaredClass"!==b){var c=n[b];var h=typeof c;if(null!==c&&void 0!==c&&"function"!==h)if(m.isArray(c)){e[b]=[];var g=c.length;for(h=0;h<g;h++)e[b][h]=this._encode(c[h])}else"object"===h?c.toJson&&(h=c.toJson(d&&d[b]),"esri.tasks.FeatureSet"===c.declaredClass&&h.spatialReference&&(h.sr=h.spatialReference,delete h.spatialReference),e[b]=f?h:a.toJson(h)):e[b]=c}return e},_successHandler:function(n,f,d,e){f&&this[f].apply(this,n);d&&d.apply(null,n);e&&
y._resDfd(e,n)},_errorHandler:function(n,f,d){this.onError(n);f&&f(n);d&&d.errback(n)},setNormalization:function(n){this.normalization=n},onError:function(){}});return z.Task=F})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/Polygon ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e){F=F(null,{declaredClass:"esri.tasks.FeatureSet",
constructor:function(b,c){if(b){m.mixin(this,b);var h=this.features=this.features||[],g=b.spatialReference;g=this.spatialReference=d.createInstance(q.simpleConstructor,g);var k=d.getGeometryType(b.geometryType);this.geometryType=b.geometryType;b.fields&&(this.fields=b.fields);var w=d.supportsLazyUnquantization(this.geometryType),t=d.unquantizeFunction(this.geometryType,this.transform),C=!!(c&&w&&t),u=k&&(C?k.accessorConstructor:k.simpleConstructor);a.forEach(h,function(x,l){var v=d.createInstance(r.simpleConstructor),
A=x.geometry;if(k&&A){var B=v.geometry=d.createInstance(u,C?null:A);B.setSpatialReference(A.spatialReference?d.createInstance(q.simpleConstructor,A.spatialReference):g);C&&B.setupLazyUnquantization(t,A)}v.symbol=x.symbol?e.fromJson(x.symbol):null;v.attributes=x.attributes;h[l]=v});C||this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(b){var c={};this.displayFieldName&&(c.displayFieldName=this.displayFieldName);this.fields&&
(c.fields=this.fields);this.spatialReference?c.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(c.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(c.geometryType=d.getJsonType(this.features[0].geometry)),c.features=n._encodeGraphics(this.features,b));c.geometryType=c.geometryType||this.geometryType;c.exceededTransferLimit=this.exceededTransferLimit;c.transform=this.transform;return y.fixJson(c)},
_hydrate:function(){d.unquantize(this.features,this.geometryType,this.transform);this.transform=null},quantize:function(b){if(!this.geometryType)return this.transform=null,this;var c=b.translate[0],h=b.translate[1],g=b.scale[0],k=b.scale[1],w=this.features,t=function(l,v,A){var B,E=[];var G=0;for(B=l.length;G<B;G++){var I=l[G];if(0<G){var L=v(I[0]);I=A(I[1]);if(L!==K||I!==ba){E.push([L-K,I-ba]);var K=L;var ba=I}}else K=v(I[0]),ba=A(I[1]),E.push([K,ba])}return 0<E.length?E:null},C=function(l,v,A){if("esriGeometryPoint"===
l)return function(B){B.x=v(B.x);B.y=A(B.y);return B};if("esriGeometryPolyline"===l||"esriGeometryPolygon"===l)return function(B){var E;var G=B.rings||B.paths;var I=[];var L=0;for(E=G.length;L<E;L++){var K=G[L];(K=t(K,v,A))&&I.push(K)}return 0<I.length?(B.rings?B.rings=I:B.paths=I,B):null};if("esriGeometryMultipoint"===l)return function(B){var E=t(B.points,v,A);return 0<E.length?(B.points=E,B):null};if("esriGeometryEnvelope"===l)return function(B){return B}}(this.geometryType,function(l){return Math.round((l-
c)/g)},function(l){return Math.round((h-l)/k)}),u;var x=0;for(u=w.length;x<u;x++)w[x].geometry&&(C(w[x].geometry)||w[x].setGeometry(null));this.transform=b;return this}});F.createGraphics=function(b){var c=b.geometryType,h=d.createInstance(q.simpleConstructor,b.spatialReference),g=d.getGeometryType(c).accessorConstructor,k=d.unquantizeFunction(c,b.transform);return a.map(b.features,function(w,t){var C=d.createInstance(r.simpleConstructor),u=w.geometry;if(u){var x=C.geometry=d.createInstance(g);x.setSpatialReference(h);
x.setupLazyUnquantization(k,u)}C.attributes=w.attributes;return C})};F.createPolygon=function(b,c,h){if(b){var g=d.createInstance(f.accessorConstructor);g.setSpatialReference(c);c=d.unquantizeFunction("esriGeometryPolygon",h);g.setupLazyUnquantization(c,b)}return g};m.setObject("tasks.FeatureSet",F,z);return F})},"esri/graphicsUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(F,m,a,D,z){a={graphicsExtent:function(y){if(!y||!y.length)return null;
var r=null,q,n=y.length;for(q=0;q<n;q++){var f=y[q].geometry;if(f){var d=f.getExtent();d||"point"!==f.type||null==f.x||null==f.y||(d=new z(f.x,f.y,f.x,f.y,f.spatialReference));d&&(r=r?r.union(d):d)}}return 0>r.getWidth()&&0>r.getHeight()?null:r},getGeometries:function(y){return m.map(y,function(r){return r.geometry})},_encodeGraphics:function(y,r){return m.map(y,function(q,n){var f=q.toJson(),d={};if(f.geometry){var e=r&&r[n];d.geometry=e&&e.toJson()||f.geometry}f.attributes&&(d.attributes=f.attributes);
return d})}};F.mixin(D,a);return a})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,orderByFields:null,toJson:function(){var y={definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,
maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},r=this.objectIds,q=this.outFields,n=this.outSpatialReference,f=this.orderByFields;r&&(y.objectIds=r.join(","));q&&(y.outFields=q.join(","));n&&(y.outSR=n.wkid||a.toJson(n.toJson()));f&&(y.orderByFields=f.join(","));y._ts=this._ts;return y}});m.setObject("tasks.RelationshipQuery",F,z);return F})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,
m,a,D){F=F(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}});m.setObject("tasks.StatisticDefinition",F,D);return F})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all dojox/html/entities ./lang ./kernel ./request ./promiseList ./ArcadeExpression ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition ./arcadeProfiles/popupProfile ./layers/support/attributeUtils dojo/i18n!dojo/cldr/nls/number".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x){F=F(null,{declaredClass:"esri.PopupInfo",_reNewline:/(\n)/ig,_reExprField:/^\s*expression\//i,_reExprFieldPattern:/\{expression\/([^\}]+)\}/ig,_exprPrefix:"expression/",_relatedFieldPrefix:"relationships/",_aggregatedFeaturesVariable:"$aggregatedfeatures",initialize:function(l,v){if(l){m.mixin(this,v);this.info=l;this.title=this.getTitle;this.content=this.getContent;this._exprCache=this._compileExpressions(this.info.expressionInfos);var A=this._fieldLabels=
{},B=this._fieldsMap={};this.info.fieldInfos&&a.forEach(this.info.fieldInfos,function(E){var G=E.fieldName.toLowerCase(),I=this._isExpressionField(G)?this.getExpressionInfo(G):null;A[G]=I?I.title:E.label;B[G]=E},this);this.titleHasRelatedFields=!(!this.info.title||-1===this.info.title.indexOf("{"+this._relatedFieldPrefix));this.titleHasAsyncExpressions=this._titleHasAsyncExpressions();this.contentHasAsyncExpressions=this._contentHasAyncExpressions()}},toJson:function(){return D.fromJson(D.toJson(this.info))},
getTitle:function(){},getContent:function(){},getFieldInfo:function(l){var v;a.some(this.info&&this.info.fieldInfos,function(A){A.fieldName===l&&(v=A);return!!v});return v},getExpressionInfo:function(l){if(l=this._getExprField(l)){l=l.toLowerCase();var v;a.some(this.info.expressionInfos,function(A){A.name.toLowerCase()===l&&(v=A);return!!v});return v}},getExpressionFieldsInTitle:function(){return this._getExprFieldsFromTemplatedString(this.info.title)},getExpressionFieldsInContent:function(){var l=
this._collectExprFieldsFromTemplatedString(this.info.description,[]);this.info.description||a.forEach(this.info.fieldInfos,function(v){v.visible&&this._collectExprField(v.fieldName,l)},this);a.forEach(this.info.mediaInfos,function(v){this._collectExprFieldsFromTemplatedString(v.title,l);this._collectExprFieldsFromTemplatedString(v.caption,l);if(v=v.value)this._collectExprFieldsFromTemplatedString(v.linkURL,l),this._collectExprFieldsFromTemplatedString(v.sourceURL,l),a.forEach(v.fields,function(A){this._collectExprField(A,
l)},this),this._collectExprField(v.normalizeField,l),this._collectExprField(v.tooltipField,l)},this);return l},getRequiredExpressionFields:function(){return this.getExpressionFieldsInTitle().concat(this.getExpressionFieldsInContent())},hasGeometryOperations:function(){return a.some(this._getArcadeExpressions(),function(l){return l.hasGeometryOperations()})},hasAsyncExpressions:function(){return a.some(this._getArcadeExpressions(),function(l){return l.async})},initializeArcadeEngine:function(){return C.initialize(this._getArcadeExpressions())},
getComponents:function(l,v){var A=this.info,B={initArcadeEngine:this.initializeArcadeEngine()};A.fieldInfos&&(A=a.filter(A.fieldInfos,function(E){return-1!==E.fieldName.indexOf(this._relatedFieldPrefix)},this))&&0<A.length&&(B.relatedInfo=this._getRelatedRecords({graphic:l,fieldsInfo:A}));this._needFullResolutionFeature(l)&&(B.fullResolutionFeature=this._getFullResolutionFeature(l));this._needAggregatedFeaturesLayer(l)&&(B.aggregatedFeaturesLayer=this._getAggregatedFeaturesLayer(l));return c(B).then(m.hitch(this,
function(E){var G=E.fullResolutionFeature,I=v&&v.evaluateAllExpressions,L=I?null:this.getRequiredExpressionFields();E=(I?this.hasAsyncExpressions():this._hasAsyncExpressions(L))?this._fetchAttributesAsync(l,G,L,E.aggregatedFeaturesLayer):this._fetchAttributes(l,G,L);return c([E]).then(m.hitch(this,function(K){return this._getPopupValues(l,K[0])}))}))},getAttachments:function(l){var v=l.getSourceLayer();l=l.attributes;if(this.info.showAttachments&&v&&v.hasAttachments&&v.objectIdField&&(l=l&&l[v.objectIdField]))return v.queryAttachmentInfos(l)},
_needAggregatedFeaturesLayer:function(l){return l.isAggregate()?a.some(this._getArcadeExpressions(),function(v){return v.hasVariable(this._aggregatedFeaturesVariable)},this):!1},_getAggregatedFeaturesLayer:function(l){return l.getAggregationSourceLayer().getFeatureCollectionLayer(l.getChildGraphics()).always(function(v){return v instanceof Error?null:v})},_needFullResolutionFeature:function(l){return(l=l.getSourceLayer())?"function"===typeof l.getMaxAllowableOffset&&0<l.getMaxAllowableOffset()&&this.hasGeometryOperations():
!1},_getFullResolutionFeature:function(l){var v=l.getSourceLayer(),A=v.objectIdField;l=(l=l.attributes)&&A&&l[A];if(null==l)return null;var B=new g;B.where=A+"\x3d"+l;B.maxAllowableOffset=0;B.outFields=[A];v._enableCacheHint(B);return v.queryFeatures(B).then(function(E){return E.features&&E.features[0]})},_isExpressionField:function(l){return this._reExprField.test(l)},_getExprField:function(l){return this._isExpressionField(l)?l.replace(this._reExprField,""):null},_collectExprField:function(l,v){var A=
this._getExprField(l);A&&v.push(A);return v},_collectExprFieldsFromTemplatedString:function(l,v){var A=this._getExprFieldsFromTemplatedString(l);A.length&&Array.prototype.push.apply(v,A);return v},_getExprFieldsFromTemplatedString:function(l){l=l?l.match(this._reExprFieldPattern):null;return a.map(l,function(v){return v.replace(this._reExprFieldPattern,"$1")},this)},_titleHasAsyncExpressions:function(){return this._hasAsyncExpressions(this.getExpressionFieldsInTitle())},_contentHasAyncExpressions:function(){return this._hasAsyncExpressions(this.getExpressionFieldsInContent())},
_hasAsyncExpressions:function(l){return a.some(l,function(v){v=this._exprCache[v];return!(!v||!v.async)},this)},_compileExpressions:function(l){var v={};a.forEach(l,function(A){var B=A.returnType&&A.returnType.toLowerCase();v[A.name]=new h({expression:A.expression,returnType:"number"===B?"number":"string",profile:C})});return v},_getArcadeExpressions:function(){var l=[],v;for(v in this._exprCache)l.push(this._exprCache[v]);return l},_fetchAttributesAsync:function(l,v,A,B){var E=this._fetchAttributes(l,
v,A,B);l={};for(var G in E)(v=E[G])&&v.then&&(l[G]=v);return c(l).then(m.hitch(this,function(I){for(var L in I){var K=I[L];E[L]=K instanceof Error?null:this._processArcadeResult(K)}return E}))},_processArcadeResult:function(l){"string"===typeof l&&(l=f.encode(l));return l},_fetchAttributes:function(l,v,A,B){var E=m.clone(l.attributes)||{},G=v&&v.geometry,I=this._exprPrefix,L=this._exprCache;A=A||a.map(this.info.expressionInfos,function(K){return K.name});a.forEach(A,function(K){var ba=I+K;K=(K=L[K])?
l.evaluateExpression(K,this._getEvalOptions(K,l,G,B)):null;E[ba]=this._processArcadeResult(K)},this);return E},_getEvalOptions:function(l,v,A,B){var E=l.hasGeometryOperations(),G=v.getSourceLayer(),I=G&&(G.getMap()||G.parentLayer&&G.parentLayer.getMap());B&&(B._map=I);l=C.getEvalOptions({expression:l,feature:v,layer:G,aggregatedFeaturesLayer:B,map:I,spatialReference:I&&I.spatialReference});v=l.context.vars.$feature;E=!(!E||!A);v&&E&&(v._geometry=A);l.skipCache=E;return l},_getPopupValues:function(l,
v,A){v=v||this._fetchAttributes(l);var B=this.info,E=l.getSourceLayer(),G=m.clone(v),I="",L="",K,ba,T=E&&E._getDateOpts&&E._getDateOpts().properties;T=T&&T.slice(0);var P={dateFormat:{properties:T,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)},format:null};if(this._relatedInfo)for(Z in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(Z)){var J=this._relatedInfo[Z],N=this._relatedLayersInfo[Z];J&&(a.forEach(J.relatedFeatures,function(ya){for(ba in ya.attributes)if(ya.attributes.hasOwnProperty(ba)&&
"esriRelCardinalityOneToOne"===N.relation.cardinality){var S=this._toRelatedFieldName([N.relation.id,ba]);v[S]=G[S]=ya.attributes[ba]}},this),a.forEach(J.relatedStatsFeatures,function(ya){for(ba in ya.attributes)if(ya.attributes.hasOwnProperty(ba)){var S=this._toRelatedFieldName([N.relation.id,ba]);v[S]=G[S]=ya.attributes[ba]}},this))}for(K in G){var Z=this._fieldsMap[K.toLowerCase()];J=this._getLayerFieldInfo(E,K);Z&&J&&(Z.fieldName=J.name);G[K]=this._formatValue(G[K],K,P);T&&Z&&Z.format&&Z.format.dateFormat&&
(Z=a.indexOf(T,K),-1<Z&&T.splice(Z,1))}if(E)for(K in T=E.typeIdField,v)if(v.hasOwnProperty(K)&&-1===K.indexOf(this._relatedFieldPrefix)){var Y=v[K];d.isDefined(Y)&&(Z=this._getDomainName(E,l,K,Y),d.isDefined(Z)?G[K]=Z:K===T&&(Z=this._getTypeName(E,l,Y),d.isDefined(Z)&&(G[K]=Z)))}B.title&&(I=this._processFieldsInLinks(this._fixTokens(B.title,E),v),I=m.trim(this._removeEmptyHref(d.substitute(G,I,P)||"")));if(A)return{title:I};B.description&&(L=this._processFieldsInLinks(this._fixTokens(B.description,
E),v),L=m.trim(this._removeEmptyHref(d.substitute(G,L,P)||"")));if(B.fieldInfos){var qa=[];a.forEach(B.fieldInfos,function(ya){(K=ya.fieldName)&&ya.visible&&qa.push([this._fieldLabels[K.toLowerCase()]||K,d.substitute(G,"${"+K+"}",P)||""])},this)}var V;if(B.mediaInfos){var na=[];a.forEach(B.mediaInfos,function(ya){V=0;Y=ya.value;switch(ya.type){case "image":var S=Y.sourceURL;S=S&&m.trim(this._removeEmptyHref(d.substitute(v,this._fixTokens(S,E))));V=!!S;break;case "piechart":case "linechart":case "columnchart":case "barchart":S=
Y.normalizeField;Y.fields=a.map(Y.fields,function(xa){return(ma=this._getLayerFieldInfo(E,xa))?ma.name:xa},this);if(S){var ma=this._getLayerFieldInfo(E,S);Y.normalizeField=ma?ma.name:S}V=a.some(Y.fields,function(xa){return d.isDefined(v[xa])||-1!==xa.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(V){ya=m.clone(ya);Y=ya.value;S=ya.title?this._processFieldsInLinks(this._fixTokens(ya.title,E),v):"";var ja=ya.caption?this._processFieldsInLinks(this._fixTokens(ya.caption,
E),v):"";ya.title=S?m.trim(this._removeEmptyHref(d.substitute(G,S,P)||"")):"";ya.caption=ja?m.trim(this._removeEmptyHref(d.substitute(G,ja,P)||"")):"";if("image"===ya.type)Y.sourceURL=d.substitute(v,this._fixTokens(Y.sourceURL,E)),Y.linkURL&&(Y.linkURL=m.trim(d.substitute(v,this._fixTokens(Y.linkURL,E))||""));else{var X,oa;a.forEach(Y.fields,function(xa,Ha){if(-1!==xa.indexOf(this._relatedFieldPrefix))oa=this._getRelatedChartInfos(xa,Y,v,P),oa instanceof Array?Y.fields=oa:Y.fields[Ha]=oa;else{var Ia=
v[xa];Ia=void 0===Ia?null:Ia;X=v[Y.normalizeField]||0;Ia&&X&&(Ia/=X);Y.fields[Ha]={y:Ia,tooltip:(this._fieldLabels[xa.toLowerCase()]||xa)+":\x3cbr/\x3e"+this._formatValue(Ia,xa,P,!!X)}}},this)}na.push(ya)}},this)}return{title:I,description:L,hasDescription:!!B.description,fields:qa&&qa.length?qa:null,mediaInfos:na&&na.length?na:null,formatted:G,editSummary:!1!==B.showLastEditInfo&&E&&E.getEditSummary?E.getEditSummary(l):""}},_getRelatedChartInfos:function(l,v,A,B){var E,G;var I=[];var L=this._fromRelatedFieldName(l);
var K=L[0];var ba=this._relatedInfo[K];K=this._relatedLayersInfo[K];ba&&a.forEach(ba.relatedFeatures,function(T){T=T.attributes;var P;for(P in T)if(T.hasOwnProperty(P)&&P===L[1]){var J={};G=T[P];v.normalizeField&&(E=-1!==v.normalizeField.indexOf(this._relatedFieldPrefix)?T[this._fromRelatedFieldName(v.normalizeField)[1]]:A[v.normalizeField]);G&&E&&(G/=E);if(v.tooltipField)if(-1!==v.tooltipField.indexOf(this._relatedFieldPrefix)){var N=this._fromRelatedFieldName(v.tooltipField)[1],Z=d.isDefined(T[N])?
this._formatValue(T[N],v.tooltipField,B,!!E):N;J.tooltip=Z+":\x3cbr/\x3e"+this._formatValue(G,N,B,!!E)}else J.tooltip=(this._fieldLabels[l.toLowerCase()]||l)+":\x3cbr/\x3e"+this._formatValue(G,v.tooltipField,B,!!E);else J.tooltip=G;J.y=G;I.push(J)}},this);return"esriRelCardinalityOneToMany"===K.relation.cardinality||"esriRelCardinalityManyToMany"===K.relation.cardinality?I:I[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",
shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",longMonthDayYearShortTime:"(datePattern: 'MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')",longMonthDayYearShortTime24:"(datePattern: 'MMMM d, y', timePattern: 'H:mm', selector: 'date and time')",longMonthDayYearLongTime:"(datePattern: 'MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')",
longMonthDayYearLongTime24:"(datePattern: 'MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",dayShortMonthYearShortTime:"(datePattern: 'd MMM y', timePattern: 'h:mm a', selector: 'date and time')",dayShortMonthYearShortTime24:"(datePattern: 'd MMM y', timePattern: 'H:mm', selector: 'date and time')",dayShortMonthYearLongTime:"(datePattern: 'd MMM y', timePattern: 'h:mm:ss a', selector: 'date and time')",dayShortMonthYearLongTime24:"(datePattern: 'd MMM y', timePattern: 'H:mm:ss', selector: 'date and time')",
longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",longDateShortTime:"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')",longDateShortTime24:"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm', selector: 'date and time')",longDateLongTime:"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')",longDateLongTime24:"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",
shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_dateFormatsJson:{shortDate:{datePattern:"M/d/y",selector:"date"},shortDateShortTime:{datePattern:"M/d/y",timePattern:"h:mm a",selector:"date and time"},shortDateShortTime24:{datePattern:"M/d/y",timePattern:"H:mm",selector:"date and time"},shortDateLongTime:{datePattern:"M/d/y",timePattern:"h:mm:ss a",selector:"date and time"},shortDateLongTime24:{datePattern:"M/d/y",timePattern:"H:mm:ss",selector:"date and time"},
shortDateLE:{datePattern:"d/M/y",selector:"date"},shortDateLEShortTime:{datePattern:"d/M/y",timePattern:"h:mm a",selector:"date and time"},shortDateLEShortTime24:{datePattern:"d/M/y",timePattern:"H:mm",selector:"date and time"},shortDateLELongTime:{datePattern:"d/M/y",timePattern:"h:mm:ss a",selector:"date and time"},shortDateLELongTime24:{datePattern:"d/M/y",timePattern:"H:mm:ss",selector:"date and time"},longMonthDayYear:{datePattern:"MMMM d, y",selector:"date"},longMonthDayYearShortTime:{datePattern:"MMMM d, y",
timePattern:"h:mm a",selector:"date and time"},longMonthDayYearShortTime24:{datePattern:"MMMM d, y",timePattern:"H:mm",selector:"date and time"},longMonthDayYearLongTime:{datePattern:"MMMM d, y",timePattern:"h:mm:ss a",selector:"date and time"},longMonthDayYearLongTime24:{datePattern:"MMMM d, y",timePattern:"H:mm:ss",selector:"date and time"},dayShortMonthYear:{datePattern:"d MMM y",selector:"date"},dayShortMonthYearShortTime:{datePattern:"d MMM y",timePattern:"h:mm a",selector:"date and time"},dayShortMonthYearShortTime24:{datePattern:"d MMM y",
timePattern:"H:mm",selector:"date and time"},dayShortMonthYearLongTime:{datePattern:"d MMM y",timePattern:"h:mm:ss a",selector:"date and time"},dayShortMonthYearLongTime24:{datePattern:"d MMM y",timePattern:"H:mm:ss",selector:"date and time"},longDate:{datePattern:"EEEE, MMMM d, y",selector:"date"},longDateShortTime:{datePattern:"EEEE, MMMM d, y",timePattern:"h:mm a",selector:"date and time"},longDateShortTime24:{datePattern:"EEEE, MMMM d, y",timePattern:"H:mm",selector:"date and time"},longDateLongTime:{datePattern:"EEEE, MMMM d, y",
timePattern:"h:mm:ss a",selector:"date and time"},longDateLongTime24:{datePattern:"EEEE, MMMM d, y",timePattern:"H:mm:ss",selector:"date and time"},longMonthYear:{datePattern:"MMMM y",selector:"date"},shortMonthYear:{datePattern:"MMM y",selector:"date"},year:{datePattern:"y",selector:"date"}},_reHref:/href\s*=\s*(")([^"]+)"/ig,_reHrefApos:/href\s*=\s*(')([^']+)'/ig,_fixTokens:function(l,v){var A=this;return l.replace(/(\{([^\{\r\n]+)\})/g,function(B,E,G){B=A._getLayerFieldInfo(v,G);return"$"+(B?"{"+
B.name+"}":E)})},_encodeAttributes:function(l,v){var A=m.clone(l)||{},B,E;for(B in A)(E=A[B])&&"string"===typeof E&&(E=v?E:encodeURIComponent(E),E=E.replace(/'/g,"\x26apos;"),A[B]=E);return A},_processFieldsInLinks:function(l,v){var A=this._encodeAttributes(v),B=this._encodeAttributes(v,!0);A=m.hitch(this,this._addValuesToHref,v,A,B);l&&(l=l.replace(this._reHref,A).replace(this._reHrefApos,A));return l},_addValuesToHref:function(l,v,A,B,E,G){G=G&&m.trim(G);return B=d.substitute(G&&0===G.indexOf("${")?
"'"===E?A:l:v,B)},_getLayerFieldInfo:function(l,v){return l&&l.getField?l.getField(v):null},_formatValue:function(l,v,A,B){var E=this._fieldsMap[v.toLowerCase()],G=E&&E.format;v=-1!==a.indexOf(A.dateFormat.properties,v);var I="number"===typeof l&&!v&&(!G||!G.dateFormat);if(!d.isDefined(l)||!E||!d.isDefined(G))return this._applyFormatting(l,I);E=G.hasOwnProperty("places")||G.hasOwnProperty("digitSeparator");var L=G.hasOwnProperty("digitSeparator")?G.digitSeparator:!0;if(E&&!v)var K={formatType:"NumberFormat",
places:d.isDefined(G.places)&&(!B||0<G.places)?Number(G.places):Infinity};else if(G.dateFormat)K=m.mixin({formatType:"DateFormat",utcOffset:this.utcOffset},this._dateFormatsJson[G.dateFormat]||this._dateFormatsJson.shortDateShortTime);else return this._applyFormatting(l,I);var ba=this._applyFormatFunctions(l,K,A);E&&-1<l.constructor.toString().indexOf("Array")&&(ba="",a.forEach(l,m.hitch(this,function(T,P){P&&(ba+=" ");ba+=this._applyFormatFunctions(T,K,A)})));E&&!L&&x.group&&(ba=ba.replace(new RegExp("\\"+
x.group,"g"),""));v&&(ba='\x3cspan class\x3d"esriDateValue"\x3e'+ba+"\x3c/span\x3e");return this._applyFormatting(ba,I)},_applyFormatFunctions:function(l,v,A){v&&A&&(A.format={myKey:v});l=d.substitute({myKey:l},"${myKey}",A)||"";v&&A&&(A.format=null);return l},_applyFormatting:function(l,v){return v?this._forceLTR(l):this._applyPreWrap(l)},_forceLTR:function(l){var v=q("ie");return v&&10>=v?l:"\x3cspan class\x3d'esriNumericValue'\x3e"+l+"\x3c/span\x3e"},_applyPreWrap:function(l){return"string"===
typeof l?l.replace(this._reNewline,"\x3cspan class\x3d'charNewLine'\x3e$1\x3c/span\x3e"):l},_insertOffset:function(l){l&&(l=d.isDefined(this.utcOffset)?l.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+")"):l);return l},_getDomainName:function(l,v,A,B){return(l=l.getDomain&&l.getDomain(A,{feature:v}))&&l.codedValues?l.getName(B):null},_getTypeName:function(l,v,A){return(l=l.getType&&l.getType(v))&&l.name},_getRelatedRecords:function(l){var v=l.graphic,A;this._relatedLayersInfoPromise||(this._relatedLayersInfoPromise=
this._getRelatedLayersInfo(l).then(m.hitch(this,function(B){for(A in B)B.hasOwnProperty(A)&&B[A]&&(this._relatedLayersInfo[A].relatedLayerInfo=B[A])})));return this._relatedLayersInfoPromise.then(m.hitch(this,function(){return this._queryRelatedLayers(v)})).then(m.hitch(this,function(B){this._setRelatedRecords(v,B);return B}))},_getRelatedLayersInfo:function(l){var v=l.fieldsInfo,A,B={};var E=l.graphic.getSourceLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});a.forEach(v,function(G){var I;
var L=this._fromRelatedFieldName(G.fieldName);var K=L[0];L=L[1];if(K&&(!this._relatedLayersInfo[K]&&E&&E.relationships&&(a.some(E.relationships,function(T){if(T.id==K)return I=T,!0}),I&&(this._relatedLayersInfo[K]={relation:I,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[K]&&(this._relatedLayersInfo[K].relatedFields.push(L),G.statisticType))){var ba=new t;ba.statisticType=G.statisticType;ba.onStatisticField=L;ba.outStatisticFieldName=L;this._relatedLayersInfo[K].outStatistics.push(ba)}},
this);for(A in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(A)&&this._relatedLayersInfo[A]&&(l=this._relatedLayersInfo[A].relation,l=E.url.replace(/[0-9]+$/,l.relatedTableId),this._relatedLayersInfo[A].relatedLayerUrl=l,B[A]=b({url:l,content:{f:"json"},callbackParamName:"callback"}));return n(B)},_queryRelatedLayers:function(l){var v={},A;for(A in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(A)&&(v[A]=this._queryRelatedLayer({graphic:l,relatedInfo:this._relatedLayersInfo[A]}));
return n(v)},_queryRelatedLayer:function(l){var v,A;var B=l.graphic;var E=B.getSourceLayer();var G=E.url.match(/[0-9]+$/g)[0];var I=l.relatedInfo;var L=I.relatedLayerInfo;var K=I.relatedLayerUrl;var ba=I.relation;l=a.filter(L.relationships,function(Y){return Y.relatedTableId===parseInt(G,10)});1===l.length?v=l[0]:1<l.length&&a.some(l,function(Y){Y.id===ba.id&&(v=Y);return!!v});if(v){var T=new g;a.some(L.fields,function(Y){if(Y.name===v.keyField)return A=-1!==a.indexOf(["esriFieldTypeSmallInteger",
"esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],Y.type)?"number":"string",!0});if(v.relationshipTableId&&v.keyFieldInRelationshipTable){var P=new r;this._queryRelatedRecords(B,v).then(m.hitch(this,function(Y){var qa;(qa=Y[B.attributes[E.objectIdField]])?(Y=a.map(qa.features,function(V){return V.attributes[L.objectIdField]},this),I.outStatistics&&0<I.outStatistics.length&&L.supportsStatistics&&(N=new g,N.where=this._chunkWhereInClause(L.objectIdField,Y,1E3),N.outFields=T.outFields,
N.outStatistics=I.outStatistics),N&&(Z=new k(K),Z.execute(N).then(m.hitch(this,function(V){var na=[];na.push(qa);na.push(V);P.resolve(na)})))):P.resolve()}))}else{var J="string"===A?v.keyField+"\x3d'"+B.attributes[ba.keyField]+"'":v.keyField+"\x3d"+B.attributes[ba.keyField];T.where=J;T.outFields=I.relatedFields;if(I.outStatistics&&0<I.outStatistics.length&&L.supportsStatistics){var N=new g;N.where=T.where;N.outFields=T.outFields;N.outStatistics=I.outStatistics}var Z=new k(K);J=[];J.push(Z.execute(T));
N&&J.push(Z.execute(N))}}return J?n(J):P?P.promise:void 0},_setRelatedRecords:function(l,v){this._relatedInfo=[];for(var A in v)if(v.hasOwnProperty(A)&&v[A]){var B=v[A];this._relatedInfo[A]={};this._relatedInfo[A].relatedFeatures=B[0].features;d.isDefined(B[1])&&(this._relatedInfo[A].relatedStatsFeatures=B[1].features)}},_handlerErrorResponse:function(l,v){l.reject(v)},_fromRelatedFieldName:function(l){var v=[];-1!==l.indexOf(this._relatedFieldPrefix)&&(l=l.split("/"),v=l.slice(1));return v},_toRelatedFieldName:function(l){var v=
"";l&&0<l.length&&(v=this._relatedFieldPrefix+l[0]+"/"+l[1]);return v},_queryRelatedRecords:function(l,v){var A=l.getSourceLayer(),B=new w;B.outFields=["*"];B.relationshipId=v.id;B.objectIds=[l.attributes[A.objectIdField]];return A.queryRelatedFeatures(B)},_removeEmptyHref:function(l){return l.replace(/href=(""|'')/gi,"")},_chunkWhereInClause:function(l,v,A){for(var B=0,E=[];B<v.length;)E.push(l+" IN ("+v.slice(B,A+B)+")"),B+=A;return E.join(" OR ")}});return e.PopupInfo=e.PopupInfoTemplate=F})},
"dojox/html/entities":function(){define(["dojo/_base/lang"],function(F){var m=F.getObject("dojox.html.entities",!0),a=function(z,y){if(y._encCache&&y._encCache.regexp&&y._encCache.mapper&&y.length==y._encCache.length){var r=y._encCache.mapper;var q=y._encCache.regexp}else{r={};q=["["];var n;for(n=0;n<y.length;n++)r[y[n][0]]="\x26"+y[n][1]+";",q.push(y[n][0]);q.push("]");q=new RegExp(q.join(""),"g");y._encCache={mapper:r,regexp:q,length:y.length}}return z=z.replace(q,function(f){return r[f]})},D=function(z,
y){if(y._decCache&&y._decCache.regexp&&y._decCache.mapper&&y.length==y._decCache.length){var r=y._decCache.mapper;var q=y._decCache.regexp}else{r={};q=["("];var n;for(n=0;n<y.length;n++){var f="\x26"+y[n][1]+";";n&&q.push("|");r[f]=y[n][0];q.push(f)}q.push(")");q=new RegExp(q.join(""),"g");y._decCache={mapper:r,regexp:q,length:y.length}}return z=z.replace(q,function(d){return r[d]})};m.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];m.latin=[["\u00a1","iexcl"],["\u00a2",
"cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],
["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],
["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1",
"ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],
["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],
["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],
["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],
["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665",
"hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039",
"lsaquo"],["\u203a","rsaquo"]];m.encode=function(z,y){z&&(y?z=a(z,y):(z=a(z,m.html),z=a(z,m.latin)));return z};m.decode=function(z,y){z&&(y?z=D(z,y):(z=D(z,m.html),z=D(z,m.latin)));return z};return m})},"esri/ArcadeExpression":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./layers/support/attributeUtils ./support/expressionUtils".split(" "),function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.ArcadeExpression",expression:null,profile:null,returnType:null,async:null,id:null,
syntaxTree:null,_traits:null,_attributeDef:null,_attributeCache:null,_compiled:!1,constructor:function(r){m.mixin(this,r);this.returnType=this.returnType||"string";this.id=z.getAttributeId(this.expression);this._setSyntaxTree(this.profile.parse(this));this.async=this.async||this.profile.isAsync(this)},hasGeometryOperations:function(){var r=this._traits.geometryOperations;void 0===r&&(r=this._traits.geometryOperations=y.hasGeometryOperations(this.syntaxTree));return r},hasFeatureSetOperations:function(){var r=
this._traits.featureSetOperations;void 0===r&&(r=this._traits.featureSetOperations=y.hasFeatureSetOperations(this.syntaxTree));return r},hasVariable:function(r){var q=this._traits.variables;void 0===q[r]&&(q[r]=y.hasVariable(this.syntaxTree,r));return q[r]},hasFunction:function(r){var q=this._traits.functions;void 0===q[r]&&(q[r]=y.hasFunction(this.syntaxTree,r));return q[r]},evaluate:function(r){this._compile();var q=this._attributeCache.compiledFunc;return this.async?y.executeAsyncFunction(q,r):
y.executeFunction(q,r)},_setSyntaxTree:function(r){this.syntaxTree=r;this._compiled=!1;this._traits={variables:{},functions:{}};this._createLegacyValueObjects()},_createLegacyValueObjects:function(){this._attributeDef={valueExpression:this.expression};this._attributeCache={attributeInfo:this._attributeDef,isNumeric:"number"===this.returnType,idSource:this.expression,id:this.id,hasExpr:!0,compiledFunc:null,syntaxTree:this.syntaxTree,isScaleDriven:!1,dependsOnView:this.hasVariable("$view"),dependsOnGeometry:this.hasGeometryOperations(),
isJSFunc:!1}},_compile:function(){this._compiled||(this._attributeCache.compiledFunc=this.profile.compile(this),this._compiled=!0)}});return D.ArcadeExpression=F})},"esri/layers/support/attributeUtils":function(){define("dojo/_base/lang dojo/has dojox/encoding/digests/_base dojox/encoding/digests/MD5 ../../kernel ../../support/expressionUtils".split(" "),function(F,m,a,D,z,y){var r={viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,getAttributeId:function(q){return"string"===typeof q?D(q,a.outputTypes.Hex):
null},getAttributeIdSource:function(q){if(!q)return null;var n=q.field,f=q.valueExpression,d=null;if(f)d=f;else if(F.isFunction(n))d=n.toString();else if(n){var e=(f=q.normalizationField)?"field":q.normalizationType;q=parseFloat(q.normalizationTotal);e&&(e=e.toLowerCase(),d=n.toLowerCase()+",norm:"+e,f?d+=","+f.toLowerCase():"percent-of-total"===e&&(n=q,"number"===typeof n&&!isNaN(n)&&Infinity!==n&&-Infinity!==n&&0!==q||(q=null),d+=","+q))}return d},createAttributeCache:function(q,n){if(!q)return null;
var f=q.valueExpression,d=y.createSyntaxTree(f),e=r.getAttributeIdSource(q);return{attributeInfo:q,isNumeric:!n,idSource:e,id:r.getAttributeId(e),hasExpr:!!f,compiledFunc:y.createFunction(d),syntaxTree:d,isScaleDriven:!!q.expression||r.viewScaleRE.test(f),dependsOnView:d?y.dependsOnView(d):!1,dependsOnGeometry:d?y.hasGeometryOperations(d):!1,isJSFunc:F.isFunction(q.field)}}};F.setObject("layers.support.attributeUtils",r,z);return r})},"dojox/encoding/digests/_base":function(){define(["dojo/_base/lang"],
function(F){F=F.getObject("dojox.encoding.digests",!0);F.outputTypes={Base64:0,Hex:1,String:2,Raw:3};F.addWords=function(m,a){var D=(m&65535)+(a&65535);return(m>>16)+(a>>16)+(D>>16)<<16|D&65535};F.stringToWord=function(m){for(var a=[],D=0,z=8*m.length;D<z;D+=8)a[D>>5]|=(m.charCodeAt(D/8)&255)<<D%32;return a};F.wordToString=function(m){for(var a=[],D=0,z=32*m.length;D<z;D+=8)a.push(String.fromCharCode(m[D>>5]>>>D%32&255));return a.join("")};F.wordToHex=function(m){for(var a=[],D=0,z=4*m.length;D<z;D++)a.push("0123456789abcdef".charAt(m[D>>
2]>>D%4*8+4&15)+"0123456789abcdef".charAt(m[D>>2]>>D%4*8&15));return a.join("")};F.wordToBase64=function(m){for(var a=[],D=0,z=4*m.length;D<z;D+=3)for(var y=(m[D>>2]>>D%4*8&255)<<16|(m[D+1>>2]>>(D+1)%4*8&255)<<8|m[D+2>>2]>>(D+2)%4*8&255,r=0;4>r;r++)8*D+6*r>32*m.length?a.push("\x3d"):a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(y>>6*(3-r)&63));return a.join("")};F.stringToUtf8=function(m){for(var a="",D=-1,z,y;++D<m.length;)z=m.charCodeAt(D),y=D+1<m.length?m.charCodeAt(D+
1):0,55296<=z&&56319>=z&&56320<=y&&57343>=y&&(z=65536+((z&1023)<<10)+(y&1023),D++),127>=z?a+=String.fromCharCode(z):2047>=z?a+=String.fromCharCode(192|z>>>6&31,128|z&63):65535>=z?a+=String.fromCharCode(224|z>>>12&15,128|z>>>6&63,128|z&63):2097151>=z&&(a+=String.fromCharCode(240|z>>>18&7,128|z>>>12&63,128|z>>>6&63,128|z&63));return a};return F})},"dojox/encoding/digests/MD5":function(){define(["./_base"],function(F){function m(q,n){return q<<n|q>>>32-n}function a(q,n,f,d,e,b){return F.addWords(m(F.addWords(F.addWords(n,
q),F.addWords(d,b)),e),f)}function D(q,n,f,d,e,b,c){return a(n&f|~n&d,q,n,e,b,c)}function z(q,n,f,d,e,b,c){return a(n&d|f&~d,q,n,e,b,c)}function y(q,n,f,d,e,b,c){return a(f^(n|~d),q,n,e,b,c)}function r(q,n){q[n>>5]|=128<<n%32;q[(n+64>>>9<<4)+14]=n;for(var f=1732584193,d=-271733879,e=-1732584194,b=271733878,c=0;c<q.length;c+=16){var h=f,g=d,k=e,w=b;f=D(f,d,e,b,q[c+0],7,-680876936);b=D(b,f,d,e,q[c+1],12,-389564586);e=D(e,b,f,d,q[c+2],17,606105819);d=D(d,e,b,f,q[c+3],22,-1044525330);f=D(f,d,e,b,q[c+
4],7,-176418897);b=D(b,f,d,e,q[c+5],12,1200080426);e=D(e,b,f,d,q[c+6],17,-1473231341);d=D(d,e,b,f,q[c+7],22,-45705983);f=D(f,d,e,b,q[c+8],7,1770035416);b=D(b,f,d,e,q[c+9],12,-1958414417);e=D(e,b,f,d,q[c+10],17,-42063);d=D(d,e,b,f,q[c+11],22,-1990404162);f=D(f,d,e,b,q[c+12],7,1804603682);b=D(b,f,d,e,q[c+13],12,-40341101);e=D(e,b,f,d,q[c+14],17,-1502002290);d=D(d,e,b,f,q[c+15],22,1236535329);f=z(f,d,e,b,q[c+1],5,-165796510);b=z(b,f,d,e,q[c+6],9,-1069501632);e=z(e,b,f,d,q[c+11],14,643717713);d=z(d,e,
b,f,q[c+0],20,-373897302);f=z(f,d,e,b,q[c+5],5,-701558691);b=z(b,f,d,e,q[c+10],9,38016083);e=z(e,b,f,d,q[c+15],14,-660478335);d=z(d,e,b,f,q[c+4],20,-405537848);f=z(f,d,e,b,q[c+9],5,568446438);b=z(b,f,d,e,q[c+14],9,-1019803690);e=z(e,b,f,d,q[c+3],14,-187363961);d=z(d,e,b,f,q[c+8],20,1163531501);f=z(f,d,e,b,q[c+13],5,-1444681467);b=z(b,f,d,e,q[c+2],9,-51403784);e=z(e,b,f,d,q[c+7],14,1735328473);d=z(d,e,b,f,q[c+12],20,-1926607734);f=a(d^e^b,f,d,q[c+5],4,-378558);b=a(f^d^e,b,f,q[c+8],11,-2022574463);
e=a(b^f^d,e,b,q[c+11],16,1839030562);d=a(e^b^f,d,e,q[c+14],23,-35309556);f=a(d^e^b,f,d,q[c+1],4,-1530992060);b=a(f^d^e,b,f,q[c+4],11,1272893353);e=a(b^f^d,e,b,q[c+7],16,-155497632);d=a(e^b^f,d,e,q[c+10],23,-1094730640);f=a(d^e^b,f,d,q[c+13],4,681279174);b=a(f^d^e,b,f,q[c+0],11,-358537222);e=a(b^f^d,e,b,q[c+3],16,-722521979);d=a(e^b^f,d,e,q[c+6],23,76029189);f=a(d^e^b,f,d,q[c+9],4,-640364487);b=a(f^d^e,b,f,q[c+12],11,-421815835);e=a(b^f^d,e,b,q[c+15],16,530742520);d=a(e^b^f,d,e,q[c+2],23,-995338651);
f=y(f,d,e,b,q[c+0],6,-198630844);b=y(b,f,d,e,q[c+7],10,1126891415);e=y(e,b,f,d,q[c+14],15,-1416354905);d=y(d,e,b,f,q[c+5],21,-57434055);f=y(f,d,e,b,q[c+12],6,1700485571);b=y(b,f,d,e,q[c+3],10,-1894986606);e=y(e,b,f,d,q[c+10],15,-1051523);d=y(d,e,b,f,q[c+1],21,-2054922799);f=y(f,d,e,b,q[c+8],6,1873313359);b=y(b,f,d,e,q[c+15],10,-30611744);e=y(e,b,f,d,q[c+6],15,-1560198380);d=y(d,e,b,f,q[c+13],21,1309151649);f=y(f,d,e,b,q[c+4],6,-145523070);b=y(b,f,d,e,q[c+11],10,-1120210379);e=y(e,b,f,d,q[c+2],15,
718787259);d=y(d,e,b,f,q[c+9],21,-343485551);f=F.addWords(f,h);d=F.addWords(d,g);e=F.addWords(e,k);b=F.addWords(b,w)}return[f,d,e,b]}F.MD5=function(q,n){var f=n||F.outputTypes.Base64,d=r(F.stringToWord(q),8*q.length);switch(f){case F.outputTypes.Raw:return d;case F.outputTypes.Hex:return F.wordToHex(d);case F.outputTypes.String:return F.wordToString(d);default:return F.wordToBase64(d)}};F.MD5._hmac=function(q,n,f){f=f||F.outputTypes.Base64;var d=F.stringToWord(n);16<d.length&&(d=r(d,8*n.length));
var e=[];n=[];for(var b=0;16>b;b++)e[b]=d[b]^909522486,n[b]=d[b]^1549556828;q=r(e.concat(F.stringToWord(q)),512+8*q.length);q=r(n.concat(q),640);switch(f){case F.outputTypes.Raw:return q;case F.outputTypes.Hex:return F.wordToHex(q);case F.outputTypes.String:return F.wordToString(q);default:return F.wordToBase64(q)}};return F.MD5})},"esri/support/expressionUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/has dojo/Deferred ../kernel ../arcade/arcade ../arcade/Feature".split(" "),function(F,
m,a,D,z,y,r){function q(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$\x26")}var n={vars:{$feature:"any",$view:"any"}},f=/^\$(feature|aggregatedFeatures)\./i,d={_getSyntaxTree:function(e){return"string"===typeof e?d.createSyntaxTree(e):e},createSyntaxTree:function(e){try{var b=e?y.parseScript(e):null}catch(c){b=null}return b},createFunction:function(e,b){b=b||F.clone(n);var c=d._getSyntaxTree(e);try{var h=c?y.compileScript(c,b):null}catch(g){h=null}return h},createExecContext:function(e,b){return{vars:{$feature:e?
r.createFromGraphic(e):new r,$view:b&&b.view},spatialReference:b&&b.sr}},evalSyntaxTree:function(e,b){try{var c=y.executeScript(e,b)}catch(h){c=null}return c},executeFunction:function(e,b){try{var c=e?e(b):null}catch(h){c=null}return c},executeAsyncFunction:function(e,b){try{var c=e?e(b):(new D).reject(Error("expressionUtils.executeAsyncFunction: Invalid argument. compiledFunc is missing."))}catch(h){c=(new D).reject(h)}return c},extractFieldNames:function(e,b){var c=d._getSyntaxTree(e);c=y.extractExpectedFieldLiterals(c);
var h=[];m.forEach(c,function(k){f.test(k)&&(k=k.replace(f,""),h.push(k))});var g=m.filter(h,function(k){return-1!==k.indexOf("*")});h=m.filter(h,function(k){return-1===g.indexOf(k)});b&&m.forEach(g,function(k){var w=new RegExp("^"+k.split(/\*+/).map(q).join(".*")+"$","i");m.forEach(b,function(t){w.test(t)&&h.push(t)})});h.sort();return m.filter(h,function(k,w){return 0===w||h[w-1]!==k})},dependsOnView:function(e){return d.hasVariable(e,"$view")},hasGeometryFunctions:function(e){return(e=d._getSyntaxTree(e))?
y.scriptTouchesGeometry(e):!1},hasGeometryOperations:function(e){return(e=d._getSyntaxTree(e))?y.scriptUsesGeometryEngine(e):!1},enableGeometryOperations:function(){return y.enableGeometrySupport()},hasVariable:function(e,b){var c=d._getSyntaxTree(e);return c?y.referencesMember(c,b):!1},hasFunction:function(e,b){var c=d._getSyntaxTree(e);return c?y.referencesFunction(c,b):!1},createFeatureSetFromLayer:function(e,b){b=b||{};var c=y.featureSetUtils();return c?c.constructFeatureSet(e,b.spatialReference,
b.outFields,b.returnGeometry,b.cache):null},createFeatureSetFromLayerUrl:function(e,b){b=b||{};var c=y.featureSetUtils();return c?c.constructFeatureSetFromUrlRaw(e,b.spatialReference,b.outFields,b.returnGeometry,b.cache):null},createFeatureSetCollectionFromMap:function(e,b){var c=y.featureSetUtils();return c?c.createFeatureSetCollectionFromMap(e,e.spatialReference,b&&b.cache):null},createFeatureSetCollectionFromServiceUrl:function(e,b){b=b||{};var c=y.featureSetUtils();return c?c.createFeatureSetCollectionFromService(e,
b.spatialReference,b.cache):null},hasFeatureSetOperations:function(e){return(e=d._getSyntaxTree(e))?y.scriptUsesFeatureSet(e):!1},enableFeatureSetOperations:function(){return y.enableFeatureSetSupport().then(function(){var e=y.featureSetUtils();e&&e.initialiseMetaDataCache()})},enableAsyncOperations:function(){return y.enableAsyncSupport()}};F.setObject("support.expressionUtils",d,z);return d})},"esri/arcade/arcade":function(){define("require exports ./arcadeCompiler ./arcadeRuntime ./parser ./treeAnalysis dojo/has ./polyfill/promiseUtils".split(" "),
function(F,m,a,D,z,y,r,q){function n(L,K){if(null===v)throw Error("Async Arcade must be enabled for this script");return r("esri-csp-restrictions")||!1===u?function(ba){return v.executeScript(L,ba)}:a.compileScript(L,K,!0)}function f(L,K){void 0===K&&(K=[]);return z.parseScript(L,K)}function d(L,K){if(!0===K.useAsync||!0===L.isAsync){if(null===v)throw Error("Async Arcade must be enabled for this script");return v.executeScript(L,K)}return D.executeScript(L,K)}function e(L,K){return D.referencesMember(L,
K)}function b(L,K){void 0===K&&(K=[]);void 0===L.usesGeometry&&y.findScriptDependencies(L,K);return!0===L.usesGeometry}function c(){return B?B:B=q.create(function(L,K){F(["../geometry/geometryEngine","./functions/geomsync"],function(ba,T){l=!0;T.setGeometryEngine(ba);L(!0)},function(ba){K(ba)})})}function h(){return null!==E?E:E=a.enableAsyncSupport().then(function(){return q.create(function(L,K){F(["./arcadeAsyncRuntime"],function(ba){try{v=ba;ba=0;for(var T=A;ba<T.length;ba++){var P=T[ba];v.extend(P);
a.extend(P,"async")}A=null;L(!0)}catch(J){K(J)}},K)})})}function g(){return v?!0:!1}function k(){return G?G:G=h().then(function(){return q.create(function(L,K){F(["./featureSetUtils","./functions/featuresetbase","./functions/featuresetgeom","./functions/featuresetstats","./functions/featuresetstring"],function(ba,T,P,J,N){try{I=ba,v.extend([T,P,J,N]),a.extend([T,P,J,N],"async"),x=!0,L(!0)}catch(Z){K(Z)}},K)})})}function w(L,K){void 0===K&&(K=[]);void 0===L.usesFeatureSet&&y.findScriptDependencies(L,
K);return!0===L.usesFeatureSet}function t(L,K){if(K)for(var ba=0;ba<K.length;ba++)if(e(L,K[ba]))return!0;return!1}Object.defineProperty(m,"__esModule",{value:!0});m.featureSetUtils=m.scriptTouchesGeometry=m.loadScriptDependencies=m.scriptIsAsync=m.scriptUsesFeatureSet=m.enableFeatureSetSupport=m.isGeometryEnabled=m.isAsyncEnabled=m.isFeatureSetSupportEnabled=m.enableAsyncSupport=m.enableGeometrySupport=m.scriptUsesGeometryEngine=m.extractExpectedFieldLiterals=m.extractFieldLiterals=m.referencesFunction=
m.referencesMember=m.executeScript=m.parseAndExecuteScript=m.scriptCheck=m.validateScript=m.parseScript=m.extend=m.compileScript=void 0;var C="feature angle bearing centroid envelopeintersects extent geometry isselfintersecting ringisclockwise".split(" "),u=function(){if(r("csp-restrictions"))return!1;try{return(new Function("function* test() {}; return true"))()}catch(L){return!1}}(),x=!1,l=!1,v=null,A=[];m.compileScript=function(L,K){return!0===K.useAsync||!0===L.isAsync?n(L,K):r("esri-csp-restrictions")?
function(ba){return D.executeScript(L,ba)}:a.compileScript(L,K)};m.extend=function(L){D.extend(L);a.extend(L,"sync");null===v?A.push(L):(a.extend(L,"async"),v.extend(L))};m.parseScript=f;m.validateScript=function(L,K,ba){void 0===ba&&(ba="");return z.validateScript(L,K,ba)};m.scriptCheck=function(L,K,ba,T){void 0===T&&(T="");return z.scriptCheck(L,K,ba,T)};m.parseAndExecuteScript=function(L,K,ba){void 0===ba&&(ba=[]);L=z.parseScript(L,ba);return d(L,K)};m.executeScript=d;m.referencesMember=e;m.referencesFunction=
function(L,K){return D.referencesFunction(L,K)};m.extractFieldLiterals=function(L,K){void 0===K&&(K=!1);return z.extractFieldLiterals(L,K)};m.extractExpectedFieldLiterals=function(L){return z.extractExpectedFieldLiterals(L)};m.scriptUsesGeometryEngine=b;var B=null;m.enableGeometrySupport=c;var E=null;m.enableAsyncSupport=h;m.isFeatureSetSupportEnabled=function(){return x};m.isAsyncEnabled=g;m.isGeometryEnabled=function(){return l};var G=null;m.enableFeatureSetSupport=k;m.scriptUsesFeatureSet=w;m.scriptIsAsync=
function(L,K){void 0===K&&(K=[]);void 0===L.isAsync&&y.findScriptDependencies(L,K);return!0===L.isAsync};m.loadScriptDependencies=function(L,K,ba,T){void 0===ba&&(ba=[]);void 0===T&&(T=!1);return q.create(function(P,J){var N="string"===typeof L?f(L):L,Z=[];N&&(!1===l&&(b(N)||T)&&Z.push(c()),!1===g()&&(!0===N.isAsync||K)&&Z.push(h()),!1===x&&(w(N)||t(N,ba))&&Z.push(k()));Z.length?q.all(Z).then(function(){P(!0)},J):P(!0)})};m.scriptTouchesGeometry=function(L){if(b(L))return!0;L=y.findFunctionCalls(L);
for(var K=!1,ba=0;ba<L.length;ba++)if(-1<C.indexOf(L[ba])){K=!0;break}return K};var I=null;m.featureSetUtils=function(){return I}})},"esri/arcade/arcadeCompiler":function(){define("require exports ./ArcadePortal ./Attachment ./Dictionary ./Feature ./ImmutablePathArray ./ImmutablePointArray ./languageUtils ./treeAnalysis ./functions/array ./functions/date ./functions/geometry ./functions/geomsync ./functions/maths ./functions/stats ./functions/string ./polyfill/promiseUtils ../geometry/Extent ../geometry/Geometry ../geometry/Multipoint ../geometry/Point ../geometry/Polygon ../geometry/Polyline ../SpatialReference".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A){function B(ka,ta,M){try{return M(ka,null,ta.arguments)}catch(Ga){throw Ga;}}function E(ka){return ka instanceof Error?w.reject(ka):w.reject(Error(ka))}function G(ka,ta){try{switch(ta.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return T(ka,ta);case "VariableDeclaration":for(var M=[],Ga=0;Ga<ta.declarations.length;Ga++)M.push(G(ka,ta.declarations[Ga]));return M.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";
case "BlockStatement":return ba(ka,ta);case "FunctionDeclaration":var La=ta.id.name.toLowerCase(),aa={isAsync:ka.isAsync,spatialReference:ka.spatialReference,console:ka.console,lrucache:ka.lrucache,interceptor:ka.interceptor,services:ka.services,symbols:ka.symbols,mangleMap:ka.mangleMap,localScope:{_SymbolsMap:{}},depthCounter:ka.depthCounter+1,globalScope:ka.globalScope};if(64<aa.depthCounter)throw Error("Exceeded maximum function depth");M="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; \n   var lscope \x3d runtimeCtx.localStack[runtimeCtx.localStack.length-1];\n";
for(Ga=0;Ga<ta.params.length;Ga++){var Ya=ta.params[Ga].name.toLowerCase(),Wa=ya(ka);aa.localScope._SymbolsMap[Ya]=Wa;aa.mangleMap[Ya]=Wa;M+="lscope['"+Wa+"']\x3darguments["+Ga.toString()+"];\n"}!0===ka.isAsync?(M=M+"return lang.__awaiter(this, void 0, void 0, function* () {\n"+(ba(aa,ta.body)+"\n return lastStatement; "),M=M+"});  }, runtimeCtx),"+(ta.params.length+")")):M+=ba(aa,ta.body)+"\n return lastStatement; }, runtimeCtx),"+ta.params.length+")";M+="\n lastStatement \x3d lc.voidOperation; \n";
if(void 0!==ka.globalScope[La])var Ea="gscope['"+La+"']\x3d"+M;else void 0!==ka.globalScope._SymbolsMap[La]?Ea="gscope['"+ka.globalScope._SymbolsMap[La]+"']\x3d"+M:(Wa=ya(ka),ka.globalScope._SymbolsMap[La]=Wa,ka.mangleMap[La]=Wa,Ea="gscope['"+Wa+"']\x3d"+M);return Ea;case "ReturnStatement":var U=null===ta.argument?"return lc.voidOperation":"return "+G(ka,ta.argument);return U;case "IfStatement":if("AssignmentExpression"===ta.test.type||"UpdateExpression"===ta.test.type)throw Error(f.nodeErrorMessage(ta.test,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var fa=G(ka,ta.test),sa=S(ka),O="var "+sa+" \x3d "+fa+";\n if ("+sa+" \x3d\x3d\x3d true) {\n"+K(ka,ta.consequent)+"\n }\n";O=null!==ta.alternate?O+("else if ("+sa+"\x3d\x3d\x3dfalse)   { \n"+K(ka,ta.alternate)+"}\n"):O+("else if ("+sa+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n");return O+="else { lang.error({type: '"+ta.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";case "ExpressionStatement":var ca="AssignmentExpression"===
ta.expression.type?"lastStatement \x3d lc.voidOperation; "+G(ka,ta.expression)+"; \n ":"lastStatement \x3d "+G(ka,ta.expression)+"; ";return ca;case "AssignmentExpression":return L(ka,ta);case "UpdateExpression":return I(ka,ta);case "BreakStatement":return"break";case "ContinueStatement":return"continue";case "TemplateLiteral":try{var va=[];La=Ea=0;for(Ga=ta.quasis;La<Ga.length;La++){var H=Ga[La];va.push(H.value?JSON.stringify(H.value.cooked):JSON.stringify(""));!1===H.tail&&(va.push(ta.expressions[Ea]?
"lang.castString(lang.aCheck("+G(ka,ta.expressions[Ea])+", 'TemplateLiteral'))":""),Ea++)}M="(["+va.join(",")+"]).join('')"}catch(qb){throw qb;}return M;case "TemplateElement":return JSON.stringify(ta.value?ta.value.cooked:"");case "ForStatement":M="lastStatement \x3d lc.voidOperation; \n";null!==ta.init&&(M+=G(ka,ta.init)+"; ");var R=S(ka),W=S(ka);M+="var "+R+" \x3d true; \n do { ";null!==ta.update&&(M+=" if ("+R+"\x3d\x3d\x3dfalse) {\n "+G(ka,ta.update)+"  \n}\n "+R+"\x3dfalse; \n");null!==ta.test&&
(M+="var "+W+" \x3d "+G(ka,ta.test)+"; ",M+="if ("+W+"\x3d\x3d\x3dfalse) { break; } else if ("+W+"!\x3d\x3dtrue) { lang.error({type: '"+ta.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n");M+=G(ka,ta.body);null!==ta.update&&(M+="\n "+G(ka,ta.update));return M+("\n"+R+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation; ");case "ForInStatement":var pa=S(ka),ra=S(ka),Aa=S(ka),Ba="var "+pa+" \x3d "+G(ka,ta.right)+";\n";"VariableDeclaration"===ta.left.type&&(Ba+=G(ka,ta.left));
var Ja="VariableDeclaration"===ta.left.type?ta.left.declarations[0].id.name:ta.left.name;Ja=Ja.toLowerCase();M="";null!==ka.localScope&&(void 0!==ka.localScope[Ja]?M="lscope['"+Ja+"']":void 0!==ka.localScope._SymbolsMap[Ja]&&(M="lscope['"+ka.localScope._SymbolsMap[Ja]+"']"));""===M&&(void 0!==ka.globalScope[Ja]?M="gscope['"+Ja+"']":void 0!==ka.globalScope._SymbolsMap[Ja]&&(M="gscope['"+ka.globalScope._SymbolsMap[Ja]+"']"));Ba=Ba+("if ("+pa+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n else if (lc.isArray(")+
(pa+") || lc.isString("+pa+")) {var ")+(ra+"\x3d"+pa+".length; \nfor(var ")+(Aa+"\x3d0; "+Aa+"\x3c"+ra+"; "+Aa+"++) {\n");Ba+=M+"\x3d"+Aa+";\n";Ba+=G(ka,ta.body);Ba+="\n}\n";Ba+=" lastStatement \x3d lc.voidOperation; \n";Ba+=" \n}\n";Ba+="else if (lc.isImmutableArray("+pa+")) {";Ba=Ba+("var "+ra+"\x3d"+pa+".length(); \nfor(var ")+(Aa+"\x3d0; "+Aa+"\x3c"+ra+"; "+Aa+"++) {\n");Ba+=M+"\x3d"+Aa+";\n";Ba+=G(ka,ta.body);Ba+="\n}\n";Ba+=" lastStatement \x3d lc.voidOperation; \n";Ba+=" \n}\n";Ba+="else if (( "+
pa+" instanceof lang.Dictionary) || ( "+pa+" instanceof lang.Feature)) {";Ba=Ba+("var "+ra+"\x3d"+pa+".keys(); \nfor(var ")+(Aa+"\x3d0; "+Aa+"\x3c"+ra+".length; "+Aa+"++) {\n");Ba+=M+"\x3d"+ra+"["+Aa+"];\n";Ba+=G(ka,ta.body);Ba+="\n}\n";Ba+=" lastStatement \x3d lc.voidOperation; \n";Ba+=" \n}\n";ka.isAsync&&(Ba+="else if (lc.isFeatureSet("+pa+")) {",Ba=Ba+("var "+ra+"\x3d"+pa+".iterator(runtimeCtx.abortSignal); \nfor(var ")+(Aa+"\x3dlang. graphicToFeature( yield "+ra+".next(),"+pa+"); "+Aa+"!\x3dnull; "+
Aa+"\x3dlang. graphicToFeature( yield "+ra+".next(),"+pa+")) {\n")+(M+"\x3d"+Aa+";\n"),Ba+=G(ka,ta.body),Ba+="\n}\n",Ba+=" lastStatement \x3d lc.voidOperation; \n",Ba+=" \n}\n");return Ba+"else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return J(ka,ta);case "MemberExpression":try{M=void 0;M=!0===ta.computed?G(ka,ta.property):"'"+ta.property.name+"'";var Ka="lang.member("+G(ka,ta.object)+","+M+")"}catch(qb){throw qb;}return Ka;case "Literal":return null===ta.value||void 0===ta.value?
"null":JSON.stringify(ta.value);case "ThisExpression":throw Error(f.nodeErrorMessage(ta,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==ta.callee.type)throw Error(f.nodeErrorMessage(ta,"RUNTIME","ONLYNODESSUPPORTED"));var Ra=ta.callee.name.toLowerCase();M="";null!==ka.localScope&&(void 0!==ka.localScope[Ra]?M="lscope['"+Ra+"']":void 0!==ka.localScope._SymbolsMap[Ra]&&(M="lscope['"+ka.localScope._SymbolsMap[Ra]+"']"));""===M&&(void 0!==ka.globalScope[Ra]?M="gscope['"+Ra+"']":
void 0!==ka.globalScope._SymbolsMap[Ra]&&(M="gscope['"+ka.globalScope._SymbolsMap[Ra]+"']"));if(""!==M){Ga="[";for(H=0;H<ta.arguments.length;H++)0<H&&(Ga+=", "),Ga+=G(ka,ta.arguments[H]);Ga+="]";va=ka.isAsync?"(yield lang.callfunc("+M+","+Ga+",runtimeCtx) )":"lang.callfunc("+M+","+Ga+",runtimeCtx)"}else throw Error(f.nodeErrorMessage(ta,"RUNTIME","NOTFOUND"));}catch(qb){throw qb;}return va;case "UnaryExpression":try{var Va="lang.unary("+G(ka,ta.argument)+",'"+ta.operator+"')"}catch(qb){throw qb;}return Va;
case "BinaryExpression":try{var ab="lang.binary("+G(ka,ta.left)+","+G(ka,ta.right)+",'"+ta.operator+"')"}catch(qb){throw qb;}return ab;case "LogicalExpression":try{if("AssignmentExpression"===ta.left.type||"UpdateExpression"===ta.left.type)throw Error(f.nodeErrorMessage(ta.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===ta.right.type||"UpdateExpression"===ta.right.type)throw Error(f.nodeErrorMessage(ta.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("\x26\x26"===
ta.operator||"||"===ta.operator)var db="(lang.logicalCheck("+G(ka,ta.left)+") "+ta.operator+" lang.logicalCheck("+G(ka,ta.right)+"))";else throw Error(f.nodeErrorMessage(ta,"RUNTIME","ONLYORORAND"));}catch(qb){throw qb;}return db;case "ConditionalExpression":throw Error(f.nodeErrorMessage(ta,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{M=[];for(Ga=0;Ga<ta.elements.length;Ga++)"Literal"===ta.elements[Ga].type?M.push(G(ka,ta.elements[Ga])):M.push("lang.aCheck("+G(ka,ta.elements[Ga])+",'ArrayExpression')");
var jb="["+M.join(",")+"]"}catch(qb){throw qb;}return jb;case "ObjectExpression":M="lang.dictionary([";for(Ga=0;Ga<ta.properties.length;Ga++){var hb=ta.properties[Ga],fb="Identifier"===hb.key.type?"'"+hb.key.name+"'":G(ka,hb.key),nb=G(ka,hb.value);0<Ga&&(M+=",");M+="lang.strCheck("+fb+",'ObjectExpression'),lang.aCheck("+nb+", 'ObjectExpression')"}return M+"])";case "Property":throw Error("Should not get here");case "Array":throw Error(f.nodeErrorMessage(ta,"RUNTIME","NOTSUPPORTED"));default:throw Error(f.nodeErrorMessage(ta,
"RUNTIME","UNREOGNISED"));}}catch(qb){throw qb;}}function I(ka,ta){var M=null,Ga="";if("MemberExpression"===ta.argument.type)return M=G(ka,ta.argument.object),Ga=!0===ta.argument.computed?G(ka,ta.argument.property):"'"+ta.argument.property.name+"'","lang.memberupdate("+M+","+Ga+",'"+ta.operator+"',"+ta.prefix+")";M=ta.argument.name.toLowerCase();if(null!==ka.localScope){if(void 0!==ka.localScope[M])return"lang.update(lscope, '"+M+"','"+ta.operator+"',"+ta.prefix+")";if(void 0!==ka.localScope._SymbolsMap[M])return"lang.update(lscope, '"+
ka.localScope._SymbolsMap[M]+"','"+ta.operator+"',"+ta.prefix+")"}if(void 0!==ka.globalScope[M])return"lang.update(gscope, '"+M+"','"+ta.operator+"',"+ta.prefix+")";if(void 0!==ka.globalScope._SymbolsMap[M])return"lang.update(gscope, '"+ka.globalScope._SymbolsMap[M]+"','"+ta.operator+"',"+ta.prefix+")";throw Error("Variable not recognised");}function L(ka,ta){var M=G(ka,ta.right),Ga=null,La="";if("MemberExpression"===ta.left.type)return Ga=G(ka,ta.left.object),La=!0===ta.left.computed?G(ka,ta.left.property):
"'"+ta.left.property.name+"'","lang.assignmember("+Ga+","+La+",'"+ta.operator+"',"+M+")";Ga=ta.left.name.toLowerCase();if(null!==ka.localScope){if(void 0!==ka.localScope[Ga])return"lscope['"+Ga+"']\x3dlang.assign("+M+",'"+ta.operator+"', lscope['"+Ga+"'])";if(void 0!==ka.localScope._SymbolsMap[Ga])return"lscope['"+ka.localScope._SymbolsMap[Ga]+"']\x3dlang.assign("+M+",'"+ta.operator+"', lscope['"+ka.localScope._SymbolsMap[Ga]+"'])"}if(void 0!==ka.globalScope[Ga])return"gscope['"+Ga+"']\x3dlang.assign("+
M+",'"+ta.operator+"', gscope['"+Ga+"'])";if(void 0!==ka.globalScope._SymbolsMap[Ga])return"gscope['"+ka.globalScope._SymbolsMap[Ga]+"']\x3dlang.assign("+M+",'"+ta.operator+"', gscope['"+ka.globalScope._SymbolsMap[Ga]+"'])";throw Error("Variable not recognised");}function K(ka,ta){return"BlockStatement"===ta.type?G(ka,ta):"ReturnStatement"===ta.type||"BreakStatement"===ta.type||"ContinueStatement"===ta.type?G(ka,ta)+"; ":"UpdateExpression"===ta.type?"lastStatement \x3d "+G(ka,ta)+"; ":"ExpressionStatement"===
ta.type?G(ka,ta):"ObjectExpression"===ta.type?"lastStatement \x3d "+G(ka,ta)+"; ":G(ka,ta)+"; "}function ba(ka,ta){for(var M="",Ga=0;Ga<ta.body.length;Ga++)M="ReturnStatement"===ta.body[Ga].type?M+(G(ka,ta.body[Ga])+"; \n"):"BreakStatement"===ta.body[Ga].type?M+(G(ka,ta.body[Ga])+"; \n"):"ContinueStatement"===ta.body[Ga].type?M+(G(ka,ta.body[Ga])+"; \n"):"UpdateExpression"===ta.body[Ga].type?M+("lastStatement \x3d "+G(ka,ta.body[Ga])+"; \n"):"ObjectExpression"===ta.body[Ga].type?M+("lastStatement \x3d "+
G(ka,ta.body[Ga])+"; \n"):M+(G(ka,ta.body[Ga])+" \n");return M}function T(ka,ta){var M=null===ta.init?null:G(ka,ta.init);M===n.voidOperation&&(M=null);var Ga=ta.id.name.toLowerCase();if(null!==ka.localScope){if(void 0!==ka.localScope[Ga])return"lscope['"+Ga+"']\x3d"+M+"; ";if(void 0!==ka.localScope._SymbolsMap[Ga])return"lscope['"+ka.localScope._SymbolsMap[Ga]+"']\x3d"+M+"; ";var La=ya(ka);ka.localScope._SymbolsMap[Ga]=La;ka.mangleMap[Ga]=La;return"lscope['"+La+"']\x3d"+M+"; "}if(void 0!==ka.globalScope[Ga])return"gscope['"+
Ga+"']\x3d"+M+"; ";if(void 0!==ka.globalScope._SymbolsMap[Ga])return"gscope['"+ka.globalScope._SymbolsMap[Ga]+"']\x3d"+M+"; ";La=ya(ka);ka.globalScope._SymbolsMap[Ga]=La;ka.mangleMap[Ga]=La;return"gscope['"+La+"']\x3d"+M+"; "}function P(ka,ta,M){ta=ta.toLowerCase();switch(ta){case "hasz":return ka=ka.hasZ,void 0===ka?!1:ka;case "hasm":return ka=ka.hasM,void 0===ka?!1:ka;case "spatialreference":return ta=ka.spatialReference._arcadeCacheId,void 0===ta&&(M=!0,Object.freeze&&Object.isFrozen(ka.spatialReference)&&
(M=!1),M&&(xa++,ta=ka.spatialReference._arcadeCacheId=xa)),ka=new z({wkt:ka.spatialReference.wkt,wkid:ka.spatialReference.wkid}),void 0!==ta&&(ka._arcadeCacheId="SPREF"+ta.toString()),ka}switch(ka.type){case "extent":switch(ta){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return ka=ka[ta],void 0!==ka?ka:null;case "type":return"Extent"}break;case "polygon":switch(ta){case "rings":return ta=ka.getCacheValue("_arcadeCacheId"),void 0===ta&&(xa++,ta=xa,
ka.setCacheValue("_arcadeCacheId",ta)),ka=new r(ka.rings,ka.spatialReference,!0===ka.hasZ,!0===ka.hasM,ta);case "type":return"Polygon"}break;case "point":switch(ta){case "x":case "y":case "z":case "m":return void 0!==ka[ta]?ka[ta]:null;case "type":return"Point"}break;case "polyline":switch(ta){case "paths":return ta=ka.getCacheValue("_arcadeCacheId"),void 0===ta&&(xa++,ta=xa,ka.setCacheValue("_arcadeCacheId",ta)),ka=new r(ka.paths,ka.spatialReference,!0===ka.hasZ,!0===ka.hasM,ta);case "type":return"Polyline"}break;
case "multipoint":switch(ta){case "points":return ta=ka.getCacheValue("_arcadeCacheId"),void 0===ta&&(xa++,ta=xa,ka.setCacheValue("_arcadeCacheId",ta)),ka=new q(ka.points,ka.spatialReference,!0===ka.hasZ,!0===ka.hasM,ta,1);case "type":return"Multipoint"}}throw Error(f.nodeErrorMessage(M,"RUNTIME","PROPERTYNOTFOUND"));}function J(ka,ta){try{var M=ta.name.toLowerCase();if(null!==ka.localScope){if(void 0!==ka.localScope[M])return"lscope['"+M+"']";if(void 0!==ka.localScope._SymbolsMap[M])return"lscope['"+
ka.localScope._SymbolsMap[M]+"']"}if(void 0!==ka.globalScope[M])return"gscope['"+M+"']";if(void 0!==ka.globalScope._SymbolsMap[M])return"gscope['"+ka.globalScope._SymbolsMap[M]+"']";throw Error(f.nodeErrorMessage(ta,"RUNTIME","VARIABLENOTFOUND"));}catch(Ga){throw Ga;}}function N(ka){return null===ka?"":n.isArray(ka)||n.isImmutableArray(ka)?"Array":n.isDate(ka)?"Date":n.isString(ka)?"String":n.isBoolean(ka)?"Boolean":n.isNumber(ka)?"Number":ka instanceof D?"Attachment":ka instanceof a?"Portal":ka instanceof
z?"Dictionary":ka instanceof y?"Feature":ka instanceof x?"Point":ka instanceof l?"Polygon":ka instanceof v?"Polyline":ka instanceof u?"Multipoint":ka instanceof t?"Extent":n.isFunctionParameter(ka)?"Function":n.isFeatureSet(ka)?"FeatureSet":n.isFeatureSetCollection(ka)?"FeatureSetCollection":ka===n.voidOperation?"":"number"===typeof ka&&isNaN(ka)?"Number":"Unrecognised Type"}function Z(ka,ta,M,Ga){try{if(n.equalityTest(ta[M],Ga))return ta[M+1];var La=ta.length-M;return 1===La?ta[M]:2===La?null:3===
La?ta[M+2]:Z(ka,ta,M+2,Ga)}catch(aa){throw aa;}}function Y(ka,ta,M,Ga){try{if(!0===Ga)return ta[M+1];if(3===ta.length-M)return ta[M+2];var La=ta[M+2];if(!1===n.isBoolean(La))throw Error("WHEN needs boolean test conditions");return Y(ka,ta,M+2,La)}catch(aa){throw aa;}}function qa(ka,ta){var M=ka.length,Ga=Math.floor(M/2);if(0===M)return[];if(1===M)return[ka[0]];var La=qa(ka.slice(0,Ga),ta);M=qa(ka.slice(Ga,M),ta);for(Ga=[];0<La.length||0<M.length;)if(0<La.length&&0<M.length){var aa=ta(La[0],M[0]);
isNaN(aa)&&(aa=0);0>=aa?(Ga.push(La[0]),La=La.slice(1)):(Ga.push(M[0]),M=M.slice(1))}else 0<La.length?(Ga.push(La[0]),La=La.slice(1)):0<M.length&&(Ga.push(M[0]),M=M.slice(1));return Ga}function V(ka,ta){try{var M=ka.length,Ga=Math.floor(M/2);if(0===M)return w.resolve([]);if(1===M)return w.resolve([ka[0]]);var La=[V(ka.slice(0,Ga),ta),V(ka.slice(Ga,M),ta)];return w.all(La).then(function(aa){return na(aa[0],aa[1],ta,[])})}catch(aa){return w.reject(aa)}}function na(ka,ta,M,Ga){return w.create(function(La,
aa){0<ka.length||0<ta.length?0<ka.length&&0<ta.length?M(ka[0],ta[0]).then(function(Ya){try{isNaN(Ya)&&(Ya=1),0>=Ya?(Ga.push(ka[0]),ka=ka.slice(1)):(Ga.push(ta[0]),ta=ta.slice(1)),na(ka,ta,M,Ga).then(function(Wa){La(Wa)},aa)}catch(Wa){aa(Wa)}},aa):0<ka.length?(Ga.push(ka[0]),ka=ka.slice(1),na(ka,ta,M,Ga).then(function(Ya){La(Ya)},aa)):0<ta.length&&(Ga.push(ta[0]),ta=ta.slice(1),na(ka,ta,M,Ga).then(function(Ya){La(Ya)},aa)):La(Ga)})}function ya(ka){ka.symbols.symbolCounter++;return"_T"+ka.symbols.symbolCounter.toString()}
function S(ka){ka.symbols.symbolCounter++;return"_Tvar"+ka.symbols.symbolCounter.toString()}function ma(ka,ta,M){var Ga={};ka||(ka={});M||(M={});Ga._SymbolsMap={};Ga.textformatting=1;Ga.infinity=1;Ga.pi=1;for(var La in ta)Ga[La]=1;for(La in M)Ga[La]=1;for(La in ka)Ga[La]=1;return Ga}function ja(ka,ta){for(var M={mode:ta,compiled:!0,functions:{},signatures:[],failDefferred:E,standardFunction:B,standardFunctionAsync:B,evaluateIdentifier:X},Ga=0;Ga<ka.length;Ga++)ka[Ga].registerFunctions(M);if("sync"===
ta){for(var La in M.functions)Ha[La]=new n.NativeFunction(M.functions[La]),ea.prototype[La]=Ha[La];for(Ga=0;Ga<M.signatures.length;Ga++)f.addFunctionDeclaration(M.signatures[Ga],"sync")}else{for(La in M.functions)Ia[La]=new n.NativeFunction(M.functions[La]),za.prototype[La]=Ia[La];for(Ga=0;Ga<M.signatures.length;Ga++)f.addFunctionDeclaration(M.signatures[Ga],"async")}}function X(ka,ta){var M=ta.name;if("_SymbolsMap"===M)throw"Illegal";if(0<ka.localStack.length){if("_t"!==M.substr(0,2).toLowerCase()&&
void 0!==ka.localStack[ka.localStack.length-1][M])return ka.localStack[ka.localStack.length-1][M];var Ga=ka.mangleMap[M];if(void 0!==Ga&&void 0!==ka.localStack[ka.localStack.length-1][Ga])return ka.localStack[ka.localStack.length-1][Ga]}if("_t"!==M.substr(0,2).toLowerCase()&&void 0!==ka.globalScope[M]||1===ka.globalScope._SymbolsMap[M])return ka.globalScope[M];M=ka.mangleMap[M];if(void 0!==M)return ka.globalScope[M]}function oa(ka){}Object.defineProperty(m,"__esModule",{value:!0});m.enableAsyncSupport=
m.compileScript=m.referencesFunction=m.referencesMember=m.validateScript=m.extractExpectedFieldLiterals=m.extractFieldLiterals=m.executeScript=m.extend=m.functionHelper=void 0;var xa=0,Ha={};e.registerFunctions(Ha,B);k.registerFunctions(Ha,B);h.registerFunctions(Ha,B);b.registerFunctions(Ha,B);g.registerFunctions(Ha,B);Ha["typeof"]=function(ka,ta){return B(ka,ta,function(M,Ga,La){n.pcCheck(La,1,1);M=N(La[0]);if("Unrecognised Type"===M)throw Error("Unrecognised Type");return M})};Ha.iif=function(ka,
ta){try{return B(ka,ta,function(M,Ga,La){n.pcCheck(La,3,3);if(!1===n.isBoolean(La[0]))throw Error("IF Function must have a boolean test condition");return La[0]?La[1]:La[2]})}catch(M){throw M;}};Ha.decode=function(ka,ta){try{return B(ka,ta,function(M,Ga,La){if(2>La.length)throw Error("Missing Parameters");if(2===La.length)return La[1];if(0===(La.length-1)%2)throw Error("Must have a default value result.");return Z(ka,La,1,La[0])})}catch(M){throw M;}};Ha.when=function(ka,ta){try{return B(ka,ta,function(M,
Ga,La){if(3>La.length)throw Error("Missing Parameters");if(0===La.length%2)throw Error("Must have a default value result.");M=La[0];if(!1===n.isBoolean(M))throw Error("WHEN needs boolean test conditions");return Y(ka,La,0,M)})}catch(M){throw M;}};Ha.top=function(ka,ta){return B(ka,ta,function(M,Ga,La){n.pcCheck(La,2,2);if(n.isArray(La[0]))return n.toNumber(La[1])>=La[0].length?La[0].slice(0):La[0].slice(0,n.toNumber(La[1]));if(n.isImmutableArray(La[0]))return n.toNumber(La[1])>=La[0].length()?La[0].slice(0):
La[0].slice(0,n.toNumber(La[1]));throw Error("Top cannot accept this parameter type");})};Ha.first=function(ka,ta){return B(ka,ta,function(M,Ga,La){n.pcCheck(La,1,1);return n.isArray(La[0])?0===La[0].length?null:La[0][0]:n.isImmutableArray(La[0])?0===La[0].length()?null:La[0].get(0):null})};Ha.sort=function(ka,ta){return B(ka,ta,function(M,Ga,La){n.pcCheck(La,1,2);Ga=La[0];n.isImmutableArray(Ga)&&(Ga=Ga.toArray());if(!1===n.isArray(Ga))throw Error("Illegal Argument");if(1<La.length){if(!1===n.isFunctionParameter(La[1]))throw Error("Illegal Argument");
var aa=function(fa,sa){return Da.callfunc(La[1],[fa,sa],M)};return ka.isAsync?V(Ga,aa):Ga=qa(Ga,function(fa,sa){return aa(fa,sa)})}if(0===Ga.length)return[];for(var Ya={},Wa=0;Wa<Ga.length;Wa++){var Ea=N(Ga[Wa]);""!==Ea&&(Ya[Ea]=!0)}if(!0===Ya.Array||!0===Ya.Dictionary||!0===Ya.Feature||!0===Ya.Point||!0===Ya.Polygon||!0===Ya.Polyline||!0===Ya.Multipoint||!0===Ya.Extent||!0===Ya.Function)return Ga.slice(0);Wa=0;Ea="";for(var U in Ya)Wa++,Ea=U;return Ga=1<Wa||"String"===Ea?qa(Ga,function(fa,sa){if(null===
fa||void 0===fa||fa===n.voidOperation)return null===sa||void 0===sa||sa===n.voidOperation?0:1;if(null===sa||void 0===sa||sa===n.voidOperation)return-1;var O=n.toString(fa),ca=n.toString(sa);return O<ca?-1:O===ca?0:1}):"Number"===Ea?qa(Ga,function(fa,sa){return fa-sa}):"Boolean"===Ea?qa(Ga,function(fa,sa){return fa===sa?0:sa?-1:1}):"Date"===Ea?qa(Ga,function(fa,sa){return sa-fa}):Ga.slice(0)})};var Ia={},ia;for(ia in Ha)Ia[ia]=new n.NativeFunction(Ha[ia]);c.registerFunctions(Ha,B);for(ia in Ha)Ha[ia]=
new n.NativeFunction(Ha[ia]);var ea=function(){};ea.prototype=Ha;var za=function(){};za.prototype=Ia;m.functionHelper={fixSpatialReference:n.fixSpatialReference,parseArguments:function(ka,ta){for(var M=[],Ga=0;Ga<ta.arguments.length;Ga++)M.push(G(ka,ta.arguments[Ga]));return M},standardFunction:B};m.extend=ja;ja([d],"sync");ja([d],"async");m.executeScript=function(ka,ta){return ka(ta)};m.extractFieldLiterals=function(ka,ta){void 0===ta&&(ta=!1);return f.findFieldLiterals(ka)};m.extractExpectedFieldLiterals=
function(ka){return f.findExpectedFieldLiterals(ka)};m.validateScript=function(ka,ta){return f.validateScript(ka,ta,"sync")};m.referencesMember=function(ka,ta){return f.referencesMember(ka,ta)};m.referencesFunction=function(ka,ta){return f.referencesFunction(ka,ta)};var Ca=0,Da={error:function(ka,ta,M){throw Error(f.nodeErrorMessage(ka,ta,M));},__awaiter:function(ka,ta,M,Ga){return w.create(function(La,aa){function Ya(U){try{Ea(Ga.next(U))}catch(fa){aa(fa)}}function Wa(U){try{Ea(Ga["throw"](U))}catch(fa){aa(fa)}}
function Ea(U){U.done?La(U.value):U.value&&U.value.then?U.value.then(Ya,Wa):(Ca++,0===Ca%100?setTimeout(function(){Ca=0;Ya(U.value)},0):Ya(U.value))}Ea((Ga=Ga.apply(ka,ta||[])).next())})},functionDepthchecker:function(ka,ta){return function(){ta.depthCounter++;ta.localStack.push([]);if(64<ta.depthCounter)throw Error("Exceeded maximum function depth");var M=ka.apply(this,arguments);if(w.isPromiseLike(M))return M.then(function(Ga){ta.depthCounter--;--ta.localStack.length;return Ga});ta.depthCounter--;
--ta.localStack.length;return M}},castString:function(ka){return n.toString(ka)},aCheck:function(ka,ta){if(n.isFunctionParameter(ka))throw Error(f.nodeErrorMessage({type:ta},"RUNTIME","FUNCTIONCONTEXTILLEGAL"));return ka===n.voidOperation?null:ka},Dictionary:z,Feature:y,dictionary:function(ka){for(var ta={},M=0;M<ka.length;M+=2){if(n.isFunctionParameter(ka[M+1]))throw Error("Illegal Argument");if(!1===n.isString(ka[M]))throw Error("Illegal Argument");ta[ka[M].toString()]=ka[M+1]===n.voidOperation?
null:ka[M+1]}ka=new z(ta);ka.immutable=!1;return ka},strCheck:function(ka){if(!1===n.isString(ka))throw Error("Illegal Argument");return ka},unary:function(ka,ta){if(n.isBoolean(ka)){if("!"===ta)return!ka;if("-"===ta)return-1*n.toNumber(ka);if("+"===ta)return 1*n.toNumber(ka);if("~"===ta)return~n.toNumber(ka);throw Error(f.nodeErrorMessage({type:"UnaryExpression",operator:ta,prefix:null,argument:null},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===ta)return-1*n.toNumber(ka);if("+"===ta)return 1*
n.toNumber(ka);if("~"===ta)return~n.toNumber(ka);throw Error(f.nodeErrorMessage({type:"UnaryExpression",operator:ta,prefix:null,argument:null},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logicalCheck:function(ka){if(!1===n.isBoolean(ka))throw Error(f.nodeErrorMessage({type:"LogicalExpression",operator:null,left:null,right:null},"RUNTIME","ONLYORORAND"));return ka},logical:function(ka,ta,M){if(n.isBoolean(ka)&&n.isBoolean(ta))switch(M){case "||":return ka||ta;case "\x26\x26":return ka&&ta}throw Error(f.nodeErrorMessage({type:"LogicalExpression",
operator:null,left:null,right:null},"RUNTIME","ONLYORORAND"));},binary:function(ka,ta,M){switch(M){case "|":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":case "^":case "\x26":return n.binaryOperator(n.toNumber(ka),n.toNumber(ta),M);case "\x3d\x3d":return n.equalityTest(ka,ta);case "\x3d":return n.equalityTest(ka,ta);case "!\x3d":return!n.equalityTest(ka,ta);case "\x3c":return n.greaterThanLessThan(ka,ta,M);case "\x3e":return n.greaterThanLessThan(ka,ta,M);case "\x3c\x3d":return n.greaterThanLessThan(ka,
ta,M);case "\x3e\x3d":return n.greaterThanLessThan(ka,ta,M);case "+":return n.isString(ka)||n.isString(ta)?n.toString(ka)+n.toString(ta):n.toNumber(ka)+n.toNumber(ta);case "-":return n.toNumber(ka)-n.toNumber(ta);case "*":return n.toNumber(ka)*n.toNumber(ta);case "/":return n.toNumber(ka)/n.toNumber(ta);case "%":return n.toNumber(ka)%n.toNumber(ta);default:throw Error(f.nodeErrorMessage({type:"BinaryExpression",operator:M,left:ka,right:ta},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(ka,
ta,M){switch(ta){case "\x3d":return ka===n.voidOperation?null:ka;case "/\x3d":return n.toNumber(M)/n.toNumber(ka);case "*\x3d":return n.toNumber(M)*n.toNumber(ka);case "-\x3d":return n.toNumber(M)-n.toNumber(ka);case "+\x3d":return n.isString(M)||n.isString(ka)?n.toString(M)+n.toString(ka):n.toNumber(M)+n.toNumber(ka);case "%\x3d":return n.toNumber(M)%n.toNumber(ka);default:throw Error(f.nodeErrorMessage({type:"AssignmentExpression",operator:ta,left:null,right:null},"RUNTIME","OPERATORNOTRECOGNISED"));
}},update:function(ka,ta,M,Ga){var La=n.toNumber(ka[ta]);ka[ta]="++"===M?La+1:La-1;return!1===Ga?La:"++"===M?La+1:La-1},graphicToFeature:function(ka,ta){return null===ka?null:y.createFromGraphicLikeObject(ka.geometry,ka.attributes,ta)},memberupdate:function(ka,ta,M,Ga){if(n.isArray(ka))if(n.isNumber(ta)){0>ta&&(ta=ka.length+ta);if(0>ta||ta>=ka.length)throw Error("Assignment outside of array bounds");var La=n.toNumber(ka[ta]);ka[ta]="++"===M?La+1:La-1}else throw Error("Invalid Parameter");else if(ka instanceof
z){if(!1===n.isString(ta))throw Error("Dictionary accessor must be a string");if(!0===ka.hasField(ta))La=n.toNumber(ka.field(ta)),ka.setField(ta,"++"===M?La+1:La-1);else throw Error("Invalid Parameter");}else if(ka instanceof y){if(!1===n.isString(ta))throw Error("Feature accessor must be a string");if(!0===ka.hasField(ta))La=n.toNumber(ka.field(ta)),ka.setField(ta,"++"===M?La+1:La-1);else throw Error("Invalid Parameter");}else{if(n.isImmutableArray(ka))throw Error("Array is Immutable");throw Error("Invalid Parameter");
}return!1===Ga?La:"++"===M?La+1:La-1},assignmember:function(ka,ta,M,Ga){if(n.isArray(ka))if(n.isNumber(ta)){0>ta&&(ta=ka.length+ta);if(0>ta||ta>ka.length)throw Error("Assignment outside of array bounds");if(ta===ka.length&&"\x3d"!==M)throw Error("Invalid Parameter");ka[ta]=this.assign(Ga,M,ka[ta])}else throw Error("Invalid Parameter");else if(ka instanceof z){if(!1===n.isString(ta))throw Error("Dictionary accessor must be a string");if(!0===ka.hasField(ta))ka.setField(ta,this.assign(Ga,M,ka.field(ta)));
else{if("\x3d"!==M)throw Error("Invalid Parameter");ka.setField(ta,this.assign(Ga,M,null))}}else if(ka instanceof y){if(!1===n.isString(ta))throw Error("Feature accessor must be a string");if(!0===ka.hasField(ta))ka.setField(ta,this.assign(Ga,M,ka.field(ta)));else{if("\x3d"!==M)throw Error("Invalid Parameter");ka.setField(ta,this.assign(Ga,M,null))}}else{if(n.isImmutableArray(ka))throw Error("Array is Immutable");throw Error("Invalid Parameter");}},member:function(ka,ta){if(null===ka)throw Error(f.nodeErrorMessage({type:"MemberExpression",
object:null,property:null,computed:null},"RUNTIME","NOTFOUND"));if(ka instanceof z||ka instanceof y){if(n.isString(ta))return ka.field(ta);throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));}if(ka instanceof C){if(n.isString(ta))return P(ka,ta,"MemberExpression");throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));}if(n.isArray(ka)){if(n.isNumber(ta)&&isFinite(ta)&&
Math.floor(ta)===ta){0>ta&&(ta=ka.length+ta);if(ta>=ka.length||0>ta)throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","OUTOFBOUNDS"));return ka[ta]}throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));}if(n.isString(ka)){if(n.isNumber(ta)&&isFinite(ta)&&Math.floor(ta)===ta){0>ta&&(ta=ka.length+ta);if(ta>=ka.length||0>ta)throw Error(f.nodeErrorMessage({type:"MemberExpression",
object:null,property:null,computed:null},"RUNTIME","OUTOFBOUNDS"));return ka[ta]}throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));}if(n.isImmutableArray(ka)&&n.isNumber(ta)&&isFinite(ta)&&Math.floor(ta)===ta){0>ta&&(ta=ka.length()+ta);if(ta>=ka.length()||0>ta)throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","OUTOFBOUNDS"));return ka.get(ta)}throw Error(f.nodeErrorMessage({type:"MemberExpression",
object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));},callfunc:function(ka,ta,M){return ka instanceof n.NativeFunction?ka.fn(M,{arguments:ta,preparsed:!0}):ka instanceof n.SizzleFunction?ka.fn.apply(this,ta):ka.apply(this,ta)}};m.compileScript=function(ka,ta,M){void 0===ta&&(ta=null);void 0===M&&(M=!1);null===ta&&(ta={vars:{},customfunctions:{}});ta={isAsync:M,globalScope:ma(ta.vars,M?Ia:Ha,ta.customfunctions),localScope:null,mangleMap:{},console:oa,lrucache:ta.lrucache,interceptor:ta.interceptor,
services:ta.services,symbols:{symbolCounter:0}};ka=G(ta,ka.body[0].body);""===ka&&(ka="lc.voidOperation; ");ta={lc:n,lang:Da,mangles:ta.mangleMap,postProcess:function(Ga){Ga instanceof n.ReturnResult&&(Ga=Ga.value);Ga instanceof n.ImplicitResult&&(Ga=Ga.value);Ga===n.voidOperation&&(Ga=null);if(Ga===n.breakResult)throw Error("Cannot return BREAK");if(Ga===n.continueResult)throw Error("Cannot return CONTINUE");if(n.isFunctionParameter(Ga))throw Error("Cannot return FUNCTION");return Ga},prepare:function(Ga,
La){var aa=Ga.spatialReference;if(null===aa||void 0===aa)aa=new A({wkid:102100});var Ya=Ga.vars,Wa=Ga.customfunctions,Ea=La?new za:new ea;Ya||(Ya={});Wa||(Wa={});var U=new z({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});U.immutable=!1;Ea._SymbolsMap={textformatting:1,infinity:1,pi:1};Ea.textformatting=U;Ea.infinity=Number.POSITIVE_INFINITY;Ea.pi=Math.PI;for(var fa in Wa)Ea[fa]=Wa[fa],Ea._SymbolsMap[fa]=1;for(fa in Ya)Ea._SymbolsMap[fa]=1,Ea[fa]=Ya[fa]&&
"esri.Graphic"===Ya[fa].declaredClass?y.createFromGraphic(Ya[fa]):Ya[fa];return{localStack:[],isAsync:La,mangleMap:this.mangles,spatialReference:aa,globalScope:Ea,abortSignal:void 0===Ga.abortSignal||null===Ga.abortSignal?{aborted:!1}:Ga.abortSignal,localScope:null,services:Ga.services,console:Ga.console?Ga.console:oa,lrucache:Ga.lrucache,interceptor:Ga.interceptor,symbols:{symbolCounter:0},depthCounter:1}}};return(new Function("context","spatialReference",M?"var runtimeCtx\x3dthis.prepare(context, true);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \nreturn lang.__awaiter(this, void 0, void 0, function* () {\n\n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n return lang.__awaiter(this, void 0, void 0, function* () {\n"+
ka+"\n return lastStatement; }); } \n return this.postProcess(yield mainBody()); }); ":"var runtimeCtx\x3dthis.prepare(context, false);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+ka+"\n return lastStatement; } \n return this.postProcess(mainBody()); ")).bind(ta)};m.enableAsyncSupport=function(){return w.create(function(ka,ta){F(["./functions/geomasync"],function(M){ja([M],"async");ka(!0)},
function(M){ta(M)})})}})},"esri/arcade/ArcadePortal":function(){var F=this&&this.__extends||function(){var m=function(a,D){m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,y){z.__proto__=y}||function(z,y){for(var r in y)Object.prototype.hasOwnProperty.call(y,r)&&(z[r]=y[r])};return m(a,D)};return function(a,D){function z(){this.constructor=a}if("function"!==typeof D&&null!==D)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");m(a,D);a.prototype=
null===D?Object.create(D):(z.prototype=D.prototype,new z)}}();define(["require","exports","./Dictionary"],function(m,a,D){return function(z){function y(r){var q=z.call(this)||this;q.immutable=!1;q.setField("url",r);q.immutable=!0;return q}F(y,z);return y}(D)})},"esri/arcade/Attachment":function(){var F=this&&this.__extends||function(){var m=function(a,D){m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,y){z.__proto__=y}||function(z,y){for(var r in y)Object.prototype.hasOwnProperty.call(y,
r)&&(z[r]=y[r])};return m(a,D)};return function(a,D){function z(){this.constructor=a}if("function"!==typeof D&&null!==D)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");m(a,D);a.prototype=null===D?Object.create(D):(z.prototype=D.prototype,new z)}}();define(["require","exports","./Dictionary"],function(m,a,D){return function(z){function y(r,q,n,f,d,e){var b=z.call(this)||this;b.attachmentUrl=d;b.immutable=!1;b.setField("id",r);b.setField("name",q);b.setField("contenttype",
n);b.setField("size",f);b.setField("exifinfo",e);b.immutable=!0;return b}F(y,z);return y}(D)})},"esri/arcade/Feature":function(){var F=this&&this.__assign||function(){F=Object.assign||function(m){for(var a,D=1,z=arguments.length;D<z;D++){a=arguments[D];for(var y in a)Object.prototype.hasOwnProperty.call(a,y)&&(m[y]=a[y])}return m};return F.apply(this,arguments)};define("require exports ./Dictionary ./ImmutableArray ./languageUtils ./polyfill/promiseUtils ../geometry/Geometry ../geometry/Point ../geometry/jsonUtils ./featureset/support/shared".split(" "),
function(m,a,D,z,y,r,q,n,f,d){return function(){function e(){this.declaredClass="esri.arcade.Feature";this._layer=this.attributes=this._geometry=this._adapter=null;this.immutable=this._datesfixed=!0;this._datefields=null;this.immutable=!0}e.createFromGraphic=function(b){var c=new e;c._geometry=b.geometry?b.geometry:null;c.attributes=void 0===b.attributes?{}:null===b.attributes?{}:b.attributes;b._sourceLayer?(c._layer=b._sourceLayer,c._datesfixed=!1):b._layer?(c._layer=b._layer,c._datesfixed=!1):b.layer&&
"fields"in b.layer?(c._layer=b.layer,c._datesfixed=!1):b.sourceLayer&&"fields"in b.sourceLayer&&(c._layer=b.sourceLayer,c._datesfixed=!1);return c};e.createFromArcadeFeature=function(b){var c=new e;c._datesfixed=b._datesfixed;c.attributes=b.attributes;c._geometry=b._geometry;b._layer&&(c._layer=b._layer);return c};e.createFromArcadeDictionary=function(b){var c=new e;c.attributes=b.field("attributes");null!==c.attributes?c.attributes instanceof D?(c.attributes=c.attributes.attributes,null===c.attributes&&
(c.attributes={})):c.attributes={}:c.attributes={};c._geometry=b.field("geometry");null!==c._geometry&&(c._geometry instanceof D?c._geometry=e.parseGeometryFromDictionary(c._geometry):c._geometry instanceof q||(c._geometry=null));return c};e.createFromGraphicLikeObject=function(b,c,h){void 0===h&&(h=null);var g=new e;null===c&&(c={});g.attributes=c;g._geometry=b?b:null;g._layer=h;g._layer&&(g._datesfixed=!1);g._adapter=null;return g};e.prototype.repurposeFromGraphicLikeObject=function(b,c,h){void 0===
h&&(h=null);null===c&&(c={});this.attributes=c;this._geometry=b?b:null;this._datesfixed=(this._layer=h)?!1:!0};e.prototype.castToText=function(){if(this._adapter)return this._adapter.castToText();var b="";!1===this._datesfixed&&this._fixDates();for(var c in this.attributes){""!==b&&(b+=",");var h=this.attributes[c];null==h?b+=JSON.stringify(c)+":null":y.isBoolean(h)||y.isNumber(h)||y.isString(h)?b+=JSON.stringify(c)+":"+JSON.stringify(h):h instanceof q?b+=JSON.stringify(c)+":"+y.toStringExplicit(h):
h instanceof z?b+=JSON.stringify(c)+":"+y.toStringExplicit(h):h instanceof Array?b+=JSON.stringify(c)+":"+y.toStringExplicit(h):h instanceof Date?b+=JSON.stringify(c)+":"+JSON.stringify(h):null!==h&&"object"===typeof h&&void 0!==h.castToText&&(b+=JSON.stringify(c)+":"+h.castToText())}return'{"geometry":'+(null===this.geometry()?"null":y.toStringExplicit(this.geometry()))+',"attributes":{'+b+"}}"};e.prototype._fixDates=function(){if(null!==this._datefields)0<this._datefields.length&&this._fixDateFields(this._datefields);
else{for(var b=[],c=0;c<this._layer.fields.length;c++){var h=this._layer.fields[c];"date"!==h.type&&"esriFieldTypeDate"!==h.type||b.push(h.name)}this._datefields=b;0<b.length&&this._fixDateFields(b)}this._datesfixed=!0};e.prototype._fixDateFields=function(b){this.attributes=F({},this.attributes);for(var c=0;c<b.length;c++){var h=this.attributes[b[c]];if(null!==h)if(void 0===h)for(var g in this.attributes){if(g.toLowerCase()===b[c].toLowerCase()){h=this.attributes[g];null===h||h instanceof Date||(this.attributes[g]=
new Date(h));break}}else h instanceof Date||(this.attributes[b[c]]=new Date(h))}};e.prototype.geometry=function(){if(this._adapter)return this._adapter.geometry();if(null===this._geometry)return this._geometry;this._geometry instanceof q||(this._geometry=f.fromJson(this._geometry));return this._geometry};e.prototype.field=function(b){if(this._adapter)return this._adapter.field(b);!1===this._datesfixed&&this._fixDates();var c=this.attributes[b];if(void 0!==c)return c;c=b.toLowerCase();for(var h in this.attributes)if(h.toLowerCase()===
c)return this.attributes[h];if(this._hasFieldDefinition(c))return null;throw Error("Field not Found : "+b);};e.prototype._hasFieldDefinition=function(b){if(null===this._layer)return!1;for(var c=0;c<this._layer.fields.length;c++)if(this._layer.fields[c].name.toLowerCase()===b)return!0;return!1};e.prototype._field=function(b){var c;if(this._adapter)return null!==(c=this._adapter.field(b))&&void 0!==c?c:null;!1===this._datesfixed&&this._fixDates();c=b.toLowerCase();b=this.attributes[b];if(void 0!==b)return b;
for(var h in this.attributes)if(h.toLowerCase()===c)return this.attributes[h];return null};e.prototype.setField=function(b,c){if(this.immutable)throw Error("Feature is Immutable");if(!1===y.isSimpleType(c))throw Error("Illegal Value Assignment to Feature");if(this._adapter)this._adapter.setField(b,c);else{var h=b.toLowerCase();if(void 0===this.attributes[b])for(var g in this.attributes)if(g.toLowerCase()===h){this.attributes[g]=c;return}this.attributes[b]=c}};e.prototype.hasField=function(b){if(this._adapter)return this._adapter.hasField(b);
var c=b.toLowerCase();if(void 0!==this.attributes[b])return!0;for(var h in this.attributes)if(h.toLowerCase()===c)return!0;return this._hasFieldDefinition(c)?!0:!1};e.prototype.keys=function(){if(this._adapter)return this._adapter.keys();var b=[],c={},h;for(h in this.attributes)b.push(h),c[h.toLowerCase()]=1;if(null!==this._layer)for(h=0;h<this._layer.fields.length;h++){var g=this._layer.fields[h];1!==c[g.name.toLowerCase()]&&b.push(g.name)}return b=b.sort()};e.parseGeometryFromDictionary=function(b){b=
e.convertDictionaryToJson(b,!0);void 0!==b.hasm&&(b.hasM=b.hasm,delete b.hasm);void 0!==b.hasz&&(b.hasZ=b.hasz,delete b.hasz);void 0!==b.spatialreference&&(b.spatialReference=b.spatialreference,delete b.spatialreference);void 0!==b.rings&&(b.rings=this.fixPathArrays(b.rings,!0===b.hasZ,!0===b.hasZ));void 0!==b.paths&&(b.paths=this.fixPathArrays(b.paths,!0===b.hasZ,!0===b.hasM));void 0!==b.points&&(b.points=this.fixPointArrays(b.points,!0===b.hasZ,!0===b.hasM));return f.fromJson(b)};e.fixPathArrays=
function(b,c,h){var g=[];if(b instanceof Array)for(var k=0;k<b.length;k++)g.push(this.fixPointArrays(b[k],c,h));else if(b instanceof z)for(k=0;k<b.length();k++)g.push(this.fixPointArrays(b.get(k),c,h));return g};e.fixPointArrays=function(b,c,h){var g=[];if(b instanceof Array)for(var k=0;k<b.length;k++){var w=b[k];w instanceof n?c&&h?g.push([w.x,w.y,w.z,w.m]):c?g.push([w.x,w.y,w.z]):h?g.push([w.x,w.y,w.m]):g.push([w.x,w.y]):w instanceof z?g.push(w.toArray()):g.push(w)}else if(b instanceof z)for(k=
0;k<b.length();k++)w=b.get(k),w instanceof n?c&&h?g.push([w.x,w.y,w.z,w.m]):c?g.push([w.x,w.y,w.z]):h?g.push([w.x,w.y,w.m]):g.push([w.x,w.y]):w instanceof z?g.push(w.toArray()):g.push(w);return g};e.convertDictionaryToJson=function(b,c){void 0===c&&(c=!1);var h={},g;for(g in b.attributes){var k=b.attributes[g];k instanceof D&&(k=e.convertDictionaryToJson(k));c?h[g.toLowerCase()]=k:h[g]=k}return h};e.parseAttributesFromDictionary=function(b){var c={},h;for(h in b.attributes){var g=b.attributes[h];
if(y.isSimpleType(g))c[h]=g;else throw Error("Illegal Argument");}return c};e.fromJson=function(b){var c=null;null!==b.geometry&&void 0!==b.geometry&&(c=f.fromJson(b.geometry));var h={};if(null!==b.attributes&&void 0!==b.attributes)for(var g in b.attributes){var k=b.attributes[g];if(null===k)h[g]=k;else if(y.isString(k)||y.isNumber(k)||y.isBoolean(k)||y.isDate(k))h[g]=k;else throw Error("Illegal Argument");}return e.createFromGraphicLikeObject(c,h,null)};e.prototype.fullDomain=function(b,c){return null!==
this._layer&&this._layer.fields?y.getDomain(b,this._layer,this,c):null};e.prototype.subtypes=function(){return null!==this._layer&&this._layer.fields?this._layer.typeIdField?{subtypeField:this._layer.typeIdField,subtypes:this._layer.types?this._layer.types.map(function(b){return{name:b.name,code:b.id}}):[]}:null:null};e.prototype.domainValueLookup=function(b,c,h){if(null===this._layer||!this._layer.fields)return null;h=y.getDomain(b,this._layer,this,h);if(void 0===c)try{c=this.field(b)}catch(g){return null}return y.getDomainValue(h,
c)};e.prototype.gdbVersion=function(){if(null===this._layer)return"";var b=this._layer.gdbVersion;return void 0===b?"":""===b&&this._layer.capabilities&&this._layer.capabilities.isVersioned?"SDE.DEFAULT":b};e.prototype.domainCodeLookup=function(b,c,h){if(null===this._layer||!this._layer.fields)return null;if(void 0===c){try{c=this.field(b)}catch(g){return null}return c}b=y.getDomain(b,this._layer,this,h);return y.getDomainCode(b,c)};e.prototype.schema=function(){if(null===this._layer||!this._layer.fields)return null;
for(var b=[],c=0,h=this._layer.fields;c<h.length;c++)b.push(d.esriFieldToJson(h[c]));return{objectIdField:this._layer.objectIdField,globalIdField:this._layer.globalIdField,geometryType:void 0===d.layerGeometryEsriRestConstants[this._layer.geometryType]?"":d.layerGeometryEsriRestConstants[this._layer.geometryType],fields:b}};e.prototype.castAsJson=function(b){void 0===b&&(b=null);var c={attributes:{},geometry:!0===(null===b||void 0===b?void 0:b.keepGeometryType)?this.geometry():this.geometry().toJson()},
h;for(h in this.attributes){var g=this.attributes[h];void 0!==g&&(c.attributes[h]=y.castAsJson(g,b))}return c};e.prototype.castAsJsonAsync=function(b,c){void 0===b&&(b=null);void 0===c&&(c=null);return r.resolve(this.castAsJson(c))};return e}()})},"esri/arcade/featureset/support/shared":function(){var F=this&&this.__assign||function(){F=Object.assign||function(m){for(var a,D=1,z=arguments.length;D<z;D++){a=arguments[D];for(var y in a)Object.prototype.hasOwnProperty.call(a,y)&&(m[y]=a[y])}return m};
return F.apply(this,arguments)};define(["require","exports","../../polyfill/promiseUtils","../../../geometry/Extent","../../../layers/Field"],function(m,a,D,z,y){function r(n){var f=null;n.domain&&(f="range"===n.domain.type?{type:"range",range:[n.domain.minValue,n.domain.maxValue]}:{type:"codedValue",codedValues:n.domain.toJson().codedValues});return F(F({name:n.name,type:n.type,alias:n.alias},void 0!==n.length?{length:n.length}:{}),{editable:!0===n.editable,nullable:!0===n.nullable,domain:f})}function q(n){return n instanceof
Date}Object.defineProperty(a,"__esModule",{value:!0});a.stableStringify=a.extractServiceUrl=a.reduceArrayWithPromises=a.toEsriGeometryType=a.layerFieldEsriConstants=a.layerGeometryEsriRestConstants=a.layerGeometryEsriConstants=a.callback=a.errback=a.defaultMaxRecords=a.sameGeomType=a.convertLinearUnitsToCode=a.shapeExtent=a.convertSquareUnitsToCode=a.cloneAttributes=a.equalityTest=a.isDate=a.isArray=a.isNumber=a.isBoolean=a.isString=a.IdState=a.esriFieldToJson=a.cloneField=a.FeatureServiceDatabaseType=
void 0;(function(n){n[n.Standardised=0]="Standardised";n[n.StandardisedNoInterval=1]="StandardisedNoInterval";n[n.SqlServer=2]="SqlServer";n[n.Oracle=3]="Oracle";n[n.Postgres=4]="Postgres";n[n.PGDB=5]="PGDB";n[n.FILEGDB=6]="FILEGDB";n[n.NotEvaluated=7]="NotEvaluated"})(a.FeatureServiceDatabaseType||(a.FeatureServiceDatabaseType={}));a.cloneField=function(n){return new y(r(n))};a.esriFieldToJson=r;(function(n){n[n.InFeatureSet=0]="InFeatureSet";n[n.NotInFeatureSet=1]="NotInFeatureSet";n[n.Unknown=
2]="Unknown"})(a.IdState||(a.IdState={}));a.isString=function(n){return"string"===typeof n||n instanceof String};a.isBoolean=function(n){return"boolean"===typeof n};a.isNumber=function(n){return"number"===typeof n};a.isArray=function(n){return n instanceof Array};a.isDate=q;a.equalityTest=function(n,f){return n===f?!0:q(n)&&q(f)?n.getTime()===f.getTime():!1};a.cloneAttributes=function(n){var f={},d;for(d in n)f[d]=n[d];return f};a.convertSquareUnitsToCode=function(n){if(void 0===n)return null;if("number"===
typeof n)return n;switch(n.toLowerCase()){case "meters":case "meter":return 109404;case "miles":case "mile":return 109413;case "kilometers":case "kilometer":case "km":return 109414}return null};a.shapeExtent=function(n){if(null===n)return null;switch(n.type){case "polygon":case "multipoint":case "polyline":return n.getExtent();case "point":return new z({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});case "extent":return n}return null};a.convertLinearUnitsToCode=function(n){if(void 0===
n)return null;if("number"===typeof n||"number"===typeof n)return n;switch(n.toLowerCase()){case "meters":case "meter":return 9001;case "miles":case "mile":return 9035;case "kilometers":case "kilometer":case "km":return 9036}return null};a.sameGeomType=function(n,f){return n===f||"point"===n&&"esriGeometryPoint"===f||"polyline"===n&&"esriGeometryPolyline"===f||"polygon"===n&&"esriGeometryPolygon"===f||"extent"===n&&"esriGeometryEnvelope"===f||"multipoint"===n&&"esriGeometryMultipoint"===f||"point"===
f&&"esriGeometryPoint"===n||"polyline"===f&&"esriGeometryPolyline"===n||"polygon"===f&&"esriGeometryPolygon"===n||"extent"===f&&"esriGeometryEnvelope"===n||"multipoint"===f&&"esriGeometryMultipoint"===n?!0:!1};a.defaultMaxRecords=1E3;a.errback=function(n){return function(f){n.reject(f)}};a.callback=function(n,f){return function(){try{n.apply(null,arguments)}catch(d){f.reject(d)}}};a.layerGeometryEsriConstants={point:"point",polygon:"polygon",polyline:"polyline",multipoint:"multipoint",extent:"extent",
esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint",esriGeometryEnvelope:"extent",envelope:"extent"};a.layerGeometryEsriRestConstants={point:"esriGeometryPoint",polygon:"esriGeometryPolygon",polyline:"esriGeometryPolyline",multipoint:"esriGeometryMultipoint",extent:"esriGeometryEnvelope",esriGeometryPoint:"esriGeometryPoint",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryPolyline:"esriGeometryPolyline",esriGeometryMultipoint:"esriGeometryMultipoint",
esriGeometryEnvelope:"esriGeometryEnvelope",envelope:"esriGeometryEnvelope"};a.layerFieldEsriConstants={"small-integer":"esriFieldTypeSmallInteger",integer:"esriFieldTypeInteger","long":"esriFieldTypeLong",single:"esriFieldTypeSingle","double":"esriFieldTypeDouble",string:"esriFieldTypeString",date:"esriFieldTypeDate",oid:"esriFieldTypeOID",geometry:"esriFieldTypeGeometry",blob:"esriFieldTypeBlob",raster:"esriFieldTypeRaster",guid:"esriFieldTypeGUID","global-id":"esriFieldTypeGlobalID",xml:"eesriFieldTypeXML",
esriFieldTypeSmallInteger:"esriFieldTypeSmallInteger",esriFieldTypeInteger:"esriFieldTypeInteger",esriFieldTypeLong:"esriFieldTypeLong",esriFieldTypeSingle:"esriFieldTypeSingle",esriFieldTypeDouble:"esriFieldTypeDouble",esriFieldTypeString:"esriFieldTypeString",esriFieldTypeDate:"esriFieldTypeDate",esriFieldTypeOID:"esriFieldTypeOID",esriFieldTypeGeometry:"esriFieldTypeGeometry",esriFieldTypeBlob:"esriFieldTypeBlob",esriFieldTypeRaster:"esriFieldTypeRaster",esriFieldTypeGUID:"esriFieldTypeGUID",esriFieldTypeGlobalID:"esriFieldTypeGlobalID",
esriFieldTypeXML:"eesriFieldTypeXML"};a.toEsriGeometryType=function(n){switch(n){case "point":return"esriGeometryPoint";case "polygon":return"esriGeometryPolygon";case "multipoint":return"esriGeometryMultipoint";case "polyline":return"esriGeometryPolyline";default:return"esriGeometryPoint"}};a.reduceArrayWithPromises=function(n,f){return D.create(function(d,e){var b=D.resolve(!0);n.reduce(function(c,h,g,k){return c.then(function(w){try{return f(w,h,g,k)}catch(t){return D.reject(t)}},function(w){return D.reject(w)})},
b).then(d,e)})};a.extractServiceUrl=function(n){if(void 0===n)return"";n=n.replace(/\/featureserver\/[0-9]*/i,"/FeatureServer");n=n.replace(/\/mapserver\/[0-9]*/i,"/MapServer");return n=n.split("?")[0]};a.stableStringify=function(n,f){f||(f={});"function"===typeof f&&(f={cmp:f});var d="boolean"===typeof f.cycles?f.cycles:!1,e=f.cmp&&function(c){return function(h){return function(g,k){return c({key:g,value:h[g]},{key:k,value:h[k]})}}}(f.cmp),b=[];return function g(h){h&&h.toJson&&"function"===typeof h.toJson&&
(h=h.toJson());if(void 0!==h){if("number"===typeof h)return isFinite(h)?""+h:"null";if("object"!==typeof h)return JSON.stringify(h);var k;if(Array.isArray(h)){var w="[";for(k=0;k<h.length;k++)k&&(w+=","),w+=g(h[k])||"null";return w+"]"}if(null===h)return"null";if(-1!==b.indexOf(h)){if(d)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var t=b.push(h)-1,C=Object.keys(h).sort(e&&e(h));w="";for(k=0;k<C.length;k++){var u=C[k],x=g(h[u]);x&&(w&&(w+=","),w+=
JSON.stringify(u)+":"+x)}b.splice(t,1);return"{"+w+"}"}}(n)}})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./RangeDomain ./CodedValueDomain".split(" "),function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.layers.Field",constructor:function(q){if(q&&m.isObject(q)&&(this.name=q.name,this.type=q.type,this.alias=q.alias,this.length=q.length,this.editable=q.editable,this.nullable=q.nullable,this.defaultValue=q.defaultValue,this.description=q.description?
JSON.parse(q.description):null,this.isViewOverride=!!q.isViewOverride,(q=q.domain)&&m.isObject(q)))switch(q.type){case "range":this.domain=new y(q);break;case "codedValue":this.domain=new r(q)}},toJson:function(){return z.fixJson({name:this.name,type:this.type,alias:this.alias,length:this.length,editable:this.editable,nullable:this.nullable,defaultValue:this.defaultValue,description:this.description?JSON.stringify(this.description):null,domain:this.domain?this.domain.toJson():null,isViewOverride:this.isViewOverride||
void 0})},toJSON:function(){return this.toJson()}});m.setObject("layers.Field",F,D);return F})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(F,m,a,D,z,y){F=F([y],{declaredClass:"esri.layers.RangeDomain",constructor:function(r){r&&m.isObject(r)&&(this.minValue=r.range[0],this.maxValue=r.range[1])},toJson:function(){var r=this.inherited(arguments);r.range=[this.minValue,this.maxValue];return z.fixJson(r)}});
m.setObject("layers.RangeDomain",F,D);return F})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.layers.Domain",constructor:function(y){y&&m.isObject(y)&&(this.name=y.name,this.type=y.type)},toJson:function(){return z.fixJson({name:this.name,type:this.type})}});m.setObject("layers.Domain",F,D);return F})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),
function(F,m,a,D,z,y,r){F=F([r],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(q){q&&m.isObject(q)&&(this.codedValues=q.codedValues)},getName:function(q){var n;a.some(this.codedValues,function(f){f.code==q&&(n=f.name);return!!n});return n},toJson:function(){var q=this.inherited(arguments);q.codedValues=m.clone(this.codedValues);return y.fixJson(q)}});m.setObject("layers.CodedValueDomain",F,z);return F})},"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(F,
m){function a(u,x){return"0"!==u.min&&x.length<Number(u.min)||"*"!==u.max&&x.length>Number(u.max)?-2:1}function D(u,x,l){if(null!==l.localScope&&void 0!==l.localScope[u.toLowerCase()]){var v=l.localScope[u.toLowerCase()];if("FormulaFunction"===v.type||"any"===v.type)return void 0===v.signature&&(v.signature={min:"0",max:"*"}),a(v.signature,x)}return void 0!==l.globalScope[u.toLowerCase()]&&(v=l.globalScope[u.toLowerCase()],"FormulaFunction"===v.type||"any"===v.type)?(void 0===v.signature&&(v.signature=
{min:"0",max:"*"}),a(v.signature,x)):-1}function z(u,x){if(u)for(var l=0;l<u.length;l++)y(u[l],x)}function y(u,x){if(u&&!1!==x(u))switch(u.type){case "ArrayExpression":z(u.elements,x);break;case "AssignmentExpression":case "BinaryExpression":y(u.left,x);y(u.right,x);break;case "BlockStatement":z(u.body,x);break;case "CallExpression":y(u.callee,x);z(u.arguments,x);break;case "ExpressionStatement":y(u.expression,x);break;case "ForInStatement":y(u.left,x);y(u.right,x);y(u.body,x);break;case "ForStatement":y(u.init,
x);y(u.test,x);y(u.update,x);y(u.body,x);break;case "FunctionDeclaration":y(u.id,x);z(u.params,x);y(u.body,x);break;case "IfStatement":y(u.test,x);y(u.consequent,x);y(u.alternate,x);break;case "LogicalExpression":y(u.left,x);y(u.right,x);break;case "MemberExpression":y(u.object,x);y(u.property,x);break;case "ObjectExpression":z(u.properties,x);break;case "Program":z(u.body,x);break;case "Property":y(u.key,x);y(u.value,x);break;case "ReturnStatement":y(u.argument,x);break;case "UnaryExpression":y(u.argument,
x);break;case "UpdateExpression":y(u.argument,x);break;case "VariableDeclaration":z(u.declarations,x);break;case "VariableDeclarator":y(u.id,x);y(u.init,x);break;case "TemplateLiteral":z(u.expressions,x),z(u.quasis,x)}}function r(u,x){void 0===x&&(x=!0);var l=b(u,"SYNTAX","UNREOGNISED");try{switch(u.type){case "VariableDeclarator":return"Identifier"!==u.id.type?b(u,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):null!==u.init?r(u.init,!1):"";case "VariableDeclaration":for(var v=0;v<u.declarations.length;v++)if(l=
r(u.declarations[v],x),""!==l)return l;return"";case "ForInStatement":l=r(u.left,x);if(""!==l)break;if("VariableDeclaration"===u.left.type){if(1<u.left.declarations.length)return b(u,"SYNTAX","ONLY1VAR");if(null!==u.left.declarations[0].init)return b(u,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==u.left.type)return b(u,"SYNTAX","LEFTNOTVAR");l=r(u.right,x);if(""!==l)break;l=r(u.body,x);if(""!==l)break;return"";case "ForStatement":if(null!==u.test&&(l=r(u.test,x),""!==l))break;if(null!==u.init&&
(l=r(u.init,x),""!==l))break;if(null!==u.update&&(l=r(u.update,x),""!==l))break;if(null!==u.body&&(l=r(u.body,x),""!==l))break;return"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":l=r(u.test,x);if(""!==l)break;if(null!==u.consequent&&(l=r(u.consequent,!1),""!==l))break;if(null!==u.alternate&&(l=r(u.alternate,!1),""!==l))break;return"";case "BlockStatement":var A=[];for(v=0;v<u.body.length;v++)"EmptyStatement"!==u.body[v].type&&
A.push(u.body[v]);u.body=A;for(v=0;v<u.body.length;v++)if(l=r(u.body[v],x),""!==l)return l;return"";case "FunctionDeclaration":return!1===x?b(u,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==u.id.type?b(u,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):r(u.body,!1);case "ReturnStatement":return null!==u.argument?r(u.argument,x):"";case "UpdateExpression":return"Identifier"!==u.argument.type&&"MemberExpression"!==u.argument.type?b(u,"SYNTAX","ASSIGNMENTTOVARSONLY"):r(u.argument,x);case "AssignmentExpression":if("Identifier"!==
u.left.type&&"MemberExpression"!==u.left.type)return b(u,"SYNTAX","ASSIGNMENTTOVARSONLY");l=r(u.left,x);if(""!==l)break;switch(u.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return b(u,"SYNTAX","OPERATORNOTRECOGNISED")}return r(u.right,!1);case "ExpressionStatement":return r(u.expression,!1);case "Identifier":l="";break;case "MemberExpression":l=r(u.object,x);if(""!==l)break;return!0===u.computed?r(u.property,x):"";case "Literal":return"";case "TemplateElement":return"";
case "CallExpression":if("Identifier"!==u.callee.type)return b(u,"SYNTAX","ONLYNODESSUPPORTED");l="";for(v=0;v<u.arguments.length;v++)if(l=r(u.arguments[v],x),""!==l)return l;return"";case "UnaryExpression":l=r(u.argument,x);break;case "BinaryExpression":l=r(u.left,x);if(""!==l)break;l=r(u.right,x);if(""!==l)break;switch(u.operator){case "|":case "\x26":case "\x3e\x3e":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":case "^":case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;
default:return b(u,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":l=r(u.left,x);if(""!==l)break;l=r(u.right);if(""!==l)break;switch(u.operator){case "\x26\x26":case "||":break;default:return b(u,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ArrayExpression":l="";for(v=0;v<u.elements.length&&(l=r(u.elements[v],x),""===l);v++);break;case "TemplateLiteral":l="";for(v=0;v<u.quasis.length;v++)if(l=r(u.quasis[v],x),""!==l)return l;for(v=0;v<u.expressions.length&&(l=r(u.expressions[v],
x),""===l);v++);break;case "ObjectExpression":l="";for(v=0;v<u.properties.length;v++){l="";if(null!==u.properties[v].key&&("Literal"!==u.properties[v].key.type&&"Identifier"!==u.properties[v].key.type&&(l=b(u,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===u.properties[v].key.type)){A=u.properties[v].key;var B="value"in A?A.value:null;"string"===typeof B||B instanceof String||(l=b(u,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===l&&(l=r(u.properties[v],x));if(""!==l)break}break;case "Property":if("Literal"!==
u.key.type&&"Identifier"!==u.key.type)return b(u,"SYNTAX","ONLYLITERAL");if("Identifier"!==u.key.type&&(l=r(u.key,x),""!==l))break;l=r(u.value,x)}return l}catch(E){throw E;}}function q(u,x){var l=b(u,"SYNTAX","UNREOGNISED"),v=null,A="";try{switch(u.type){case "VariableDeclarator":var B=null===u.init?"":q(u.init,x);if(""!==B)return B;"Identifier"===u.id.type&&(null===x.localScope?x.globalScope[u.id.name.toLowerCase()]={type:"any"}:x.localScope[u.id.name.toLowerCase()]={type:"any"});return"";case "FunctionDeclaration":v=
f(u.id.name.toLowerCase(),u);A=d(u,x);if(""!==A)return A;if(null!==x.localScope)return b(u,"SYNTAX","GLOBALFUNCTIONSONLY");v.isnative=!1;x.globalScope[u.id.name.toLowerCase()]={type:"FormulaFunction",signature:[v]};return"";case "VariableDeclaration":l="";for(var E=0;E<u.declarations.length&&(l=q(u.declarations[E],x),""===l);E++);break;case "IfStatement":l=q(u.test,x);if(""!==l)break;if("AssignmentExpression"===u.test.type||"UpdateExpression"===u.test.type)return b(u.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");
if(null!==u.consequent&&(l=q(u.consequent,x),""!==l))break;if(null!==u.alternate&&(l=q(u.alternate,x),""!==l))break;return"";case "EmptyStatement":return"";case "BlockStatement":for(E=0;E<u.body.length;E++)if(l=q(u.body[E],x),""!==l)return l;return"";case "ReturnStatement":return null!==u.argument?q(u.argument,x):"";case "ForInStatement":if("VariableDeclaration"===u.left.type){if(1<u.left.declarations.length)return b(u,"SYNTAX","ONLY1VAR");if(null!==u.left.declarations[0].init)return b(u,"SYNTAX",
"CANNOTDECLAREVAL")}else if("Identifier"!==u.left.type)return b(u,"SYNTAX","LEFTNOTVAR");l=q(u.left,x);if(""!==l)break;l=q(u.right,x);if(""!==l)break;l=q(u.body,x);if(""!==l)break;return"";case "ForStatement":if(null!==u.init&&(l=q(u.init,x),""!==l))break;if(null!==u.test&&(l=q(u.test,x),""!==l))break;if(null!==u.body&&(l=q(u.body,x),""!==l))break;if(null!==u.update&&(l=q(u.update,x),""!==l))break;return"";case "BreakStatement":return"";case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==
u.argument.type&&"MemberExpression"!==u.argument.type)return b(u,"SYNTAX","ASSIGNMENTTOVARSONLY");var G=!1;if("MemberExpression"===u.argument.type)return q(u.argument,x);null!==x.localScope&&void 0!==x.localScope[u.argument.name.toLowerCase()]&&(G=!0);void 0!==x.globalScope[u.argument.name.toLowerCase()]&&(G=!0);return!1===G?"Identifier "+u.argument.name+" has not been declared.":"";case "AssignmentExpression":if("Identifier"!==u.left.type&&"MemberExpression"!==u.left.type)return b(u,"SYNTAX","ASSIGNMENTTOVARSONLY");
var I=q(u.right,x);if(""!==I)return I;G=!1;if("MemberExpression"===u.left.type)return I=q(u.left,x),""!==I?I:"";null!==x.localScope&&void 0!==x.localScope[u.left.name.toLowerCase()]&&(G=!0);void 0!==x.globalScope[u.left.name.toLowerCase()]&&(G=!0);return!1===G?"Identifier "+u.left.name+" has not been declared.":"";case "ExpressionStatement":return q(u.expression,x);case "Identifier":var L=u.name.toLowerCase();if(null!==x.localScope&&void 0!==x.localScope[L])return"";l=void 0!==x.globalScope[L]?"":
b(u,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":l=q(u.object,x);if(""!==l)break;return!0===u.computed?q(u.property,x):"";case "Literal":return"";case "TemplateElement":return"";case "CallExpression":if("Identifier"!==u.callee.type)return b(u,"SYNTAX","ONLYNODESSUPPORTED");l="";for(E=0;E<u.arguments.length;E++)if(l=q(u.arguments[E],x),""!==l)return l;var K=D(u.callee.name,u.arguments,x);-1===K&&(l=b(u,"SYNTAX","NOTFOUND"));-2===K&&(l=b(u,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":l=
q(u.argument,x);break;case "BinaryExpression":l=q(u.left,x);if(""!==l)break;l=q(u.right,x);if(""!==l)break;return"";case "LogicalExpression":l=q(u.left,x);if(""!==l)break;if("AssignmentExpression"===u.left.type||"UpdateExpression"===u.left.type)return b(u.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");l=q(u.right,x);if(""!==l)break;return"AssignmentExpression"===u.right.type||"UpdateExpression"===u.right.type?b(u.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):"";case "ArrayExpression":l=
"";for(E=0;E<u.elements.length&&(l=q(u.elements[E],x),""===l);E++);break;case "TemplateLiteral":l="";for(E=0;E<u.quasis.length;E++)if(l=q(u.quasis[E],x),""!==l)return l;for(E=0;E<u.expressions.length&&(l=q(u.expressions[E],x),""===l);E++);break;case "ObjectExpression":l="";for(E=0;E<u.properties.length;E++){l="";if(null!==u.properties[E].key&&("Literal"!==u.properties[E].key.type&&"Identifier"!==u.properties[E].key.type&&(l=b(u,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===u.properties[E].key.type)){var ba=
u.properties[E].key,T="value"in ba?ba.value:null;"string"===typeof T||T instanceof String||(l=b(u,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===l&&(l=q(u.properties[E],x));if(""!==l)break}break;case "Property":if("Literal"!==u.key.type&&"Identifier"!==u.key.type)return b(u,"SYNTAX","ONLYLITERAL");if("Identifier"!==u.key.type&&(l=q(u.key,x),""!==l))break;l=q(u.value,x)}return l}catch(P){throw P;}}function n(u,x){var l=!1,v=x.toLowerCase();y(u,function(A){if(l)return!1;"Identifier"===A.type&&A.name&&
A.name.toLowerCase()===v&&(l=!0);return!0});return l}function f(u,x){var l=[];if(void 0!==x.params&&null!==x.params)for(var v=0;v<x.params.length;v++)l.push("any");return{name:u,"return":"any",params:l}}function d(u,x){for(var l={globalScope:x.globalScope,localScope:{}},v=0;v<u.params.length;v++)l.localScope[u.params[v].name.toLowerCase()]={type:"any"};return q(u.body,l)}function e(u,x,l,v){var A={};if(void 0===u||null===u)u={};if(void 0===l||null===l)l={};A.infinity={type:"any"};A.textformatting=
{type:"any"};A.pi={type:"any"};for(var B in x)"sync"===v&&void 0!==x[B].min?A[B]={type:"FormulaFunction",signature:{min:x[B].min,max:x[B].max}}:"sync"!==v&&void 0!==x[B].fmin&&(A[B]={type:"FormulaFunction",signature:{min:x[B].fmin,max:x[B].fmax}});for(x=0;x<l.length;x++)B=l[x],A[B.name]={type:"FormulaFunction",signature:B};for(B in u)A[B]=u[B],A[B].type="any";return A}function b(u,x,l){var v="";switch(x){case "SYNTAX":v="Syntax Error: ";break;case "RUNTIME":v="Runtime Error: ";break;default:v="Syntax Error: "}try{switch(u.type){case "IfStatement":switch(l){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":v+=
" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":v+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(l){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":v+=" Assignments not be made in logical tests";break;case "ASSIGNMENTTOVARSONLY":v+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":v+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(l){case "GLOBALFUNCTIONSONLY":v+=
" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":v+=" Function Definition must have an identifier"}break;case "VariableDeclaration":v+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(l){case "FUNCTIONVARIABLEDECLARATOR":v+=" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":v+=" Variable Definition must have an identifier"}break;case "Identifier":v+=" Identifier Not Found. ";v+=u.name;break;case "ObjectExpression":switch(l){case "OBJECTPROPERTYMUSTBESTRING":v+=
" Property name must be a string"}break;case "ForStatement":switch(l){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":v+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(l){case "ONLY1VAR":v+=" Can only declare 1 var for use with IN";break;case "CANNOTDECLAREVAL":v+=" Can only declare value for use with IN";break;case "LEFTNOVAR":v+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":v+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":v+=
"This type cannot be used in an IN loop"}break;case "MemberExpression":switch(l){case "PROPERTYNOTFOUND":v+="Cannot find member property. ";v+=!1===u.computed?"Identifier"===u.property.type?u.property.name:"":"";break;case "OUTOFBOUNDS":v+="Out of Bounds. ";v+=!1===u.computed?"Identifier"===u.property.type?u.property.name:"":"";break;case "NOTFOUND":v+="Cannot call member method on null. ";v+=!1===u.computed?"Identifier"===u.property.type?u.property.name:"":"";break;case "INVALIDTYPE":v+="Cannot call member property on object of this type. ",
v+=!1===u.computed?"Identifier"===u.property.type?u.property.name:"":""}break;case "Property":switch(l){case "ONLYLITERAL":v+="Property names must be literals or identifiers"}break;case "Literal":break;case "CallExpression":switch(l){case "WRONGSIGNATURE":v+="Function signature does not match: ";v+="Identifier"===u.callee.type?u.callee.name:"";break;case "ONLYNODESUPPORTED":v+="Functions must be declared.";v+="Identifier"===u.callee.type?u.callee.name:"";break;case "NOTAFUNCTION":v+="Not a Function: ";
v+="Identifier"===u.callee.type?u.callee.name:"";break;case "NOTFOUND":v+="Function Not Found: "+("Identifier"===u.callee.type?u.callee.name:"")}break;case "UnaryExpression":switch(l){case "NOTSUPPORTEDUNARYOPERATOR":v+="Operator "+u.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":v+="Unary operator "+u.operator+" cannot be used with this argument."}case "BinaryExpression":switch(l){case "OPERATORNOTRECOGNISED":v+="Binary Operator not recognised "+
u.operator}break;case "LogicalExpression":switch(l){case "ONLYBOOLEAN":v+="Operator "+u.operator+" cannot be used. Only || or \x26\x26 are allowed values";break;case "ONLYORORAND":v+="Logical Expression "+u.operator+" being applied to parameters that are not boolean."}break;case "ArrayExpression":switch(l){case "FUNCTIONCONTEXTILLEGAL":v+=" Cannot Put Function inside Array."}break;default:v+="Expression contains unrecognised code structures."}}catch(A){throw A;}return v}function c(u,x,l){return{line:u.loc.start.line,
character:u.loc.start.column,reason:b(u,x,l)}}function h(u,x,l,v){x={globalScope:x.globalScope,localScope:{}};for(var A=0;A<u.params.length;A++)x.localScope[u.params[A].name.toLowerCase()]={type:"any"};g(u.body,x,l,v,!1)}function g(u,x,l,v,A){void 0===A&&(A=!0);if(null===u)throw Error("Unnexpexted Expression Syntax");var B=null;try{switch(u.type){case "VariableDeclarator":"Identifier"!==u.id.type?v.push(c(u,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(u.id.name.toLowerCase(),null===x.localScope?x.globalScope[u.id.name.toLowerCase()]=
{type:"any"}:x.localScope[u.id.name.toLowerCase()]={type:"any"});null!==u.init&&g(u.init,x,l,v,A);break;case "FunctionDeclaration":!1===A&&v.push(c(u,"SYNTAX","GLOBALFUNCTIONSONLY"));"Identifier"!==u.id.type&&v.push(c(u,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"));B=f("",u);h(u,x,l,v);null!==x.localScope&&v.push(c(u,"SYNTAX","GLOBALFUNCTIONSONLY"));B.isnative=!1;"Identifier"===u.id.type&&(x.globalScope[u.id.name.toLowerCase()]={type:"FormulaFunction",signature:[B]});break;case "VariableDeclaration":for(var E=
0;E<u.declarations.length;E++)g(u.declarations[E],x,l,v,A);break;case "IfStatement":null!==u.test&&(g(u.test,x,l,v,A),"AssignmentExpression"!==u.test.type&&"UpdateExpression"!==u.test.type||v.push(c(u.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));null!==u.consequent&&g(u.consequent,x,l,v,A);null!==u.alternate&&g(u.alternate,x,l,v,A);break;case "EmptyStatement":break;case "BlockStatement":if(null!==u.body)for(E=0;E<u.body.length;E++)g(u.body[E],x,l,v,A);break;case "ReturnStatement":null!==
u.argument&&g(u.argument,x,l,v,A);break;case "ForInStatement":"VariableDeclaration"===u.left.type?(1<u.left.declarations.length&&v.push(c(u,"SYNTAX","ONLY1VAR")),null!==u.left.declarations[0].init&&v.push(c(u,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==u.left.type&&v.push(c(u,"SYNTAX","LEFTNOTVAR"));g(u.left,x,l,v,A);g(u.right,x,l,v,A);g(u.body,x,l,v,A);break;case "ForStatement":null!==u.init&&g(u.init,x,l,v,A);null!==u.test&&g(u.test,x,l,v,A);null!==u.body&&g(u.body,x,l,v,A);null!==u.update&&g(u.update,
x,l,v,A);break;case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":if("Identifier"!==u.argument.type&&"MemberExpression"!==u.argument.type)v.push(c(u,"SYNTAX","ASSIGNMENTTOVARSONLY"));else{if("Identifier"===u.argument.type){var G=!1;!1===l&&(null!==x.localScope&&void 0!==x.localScope[u.argument.name.toLowerCase()]&&(G=!0),void 0!==x.globalScope[u.argument.name.toLowerCase()]&&(G=!0),!1===G&&v.push({line:null===u?0:u.loc.start.line,character:null===u?0:u.loc.start.column,
reason:"Identifier "+u.argument.name+" has not been declared."}))}"MemberExpression"===u.argument.type&&g(u.argument,x,l,v,A)}break;case "AssignmentExpression":"Identifier"!==u.left.type&&"MemberExpression"!==u.left.type&&v.push(c(u,"SYNTAX","ASSIGNMENTTOVARSONLY"));switch(u.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:v.push(c(u,"SYNTAX","OPERATORNOTRECOGNISED"))}g(u.right,x,l,v,A);G=!1;"Identifier"===u.left.type&&(null!==x.localScope&&void 0!==
x.localScope[u.left.name.toLowerCase()]&&(G=!0),void 0!==x.globalScope[u.left.name.toLowerCase()]&&(G=!0),!1===l&&!1===G&&v.push({line:null===u?0:u.loc.start.line,character:null===u?0:u.loc.start.column,reason:"Identifier "+u.left.name+" has not been declared."}));"MemberExpression"===u.left.type&&g(u.left,x,l,v,A);break;case "ExpressionStatement":g(u.expression,x,l,v,A);break;case "Identifier":var I=u.name.toLowerCase();if(null!==x.localScope&&void 0!==x.localScope[I]||void 0!==x.globalScope[I])break;
!1===l&&v.push(c(u,"SYNTAX","VARIABLENOTFOUND"));break;case "MemberExpression":g(u.object,x,l,v,A);!0===u.computed&&g(u.property,x,l,v,A);break;case "Literal":break;case "TemplateElement":break;case "CallExpression":"Identifier"!==u.callee.type&&v.push(c(u,"SYNTAX","ONLYNODESSUPPORTED"));for(E=0;E<u.arguments.length;E++)g(u.arguments[E],x,l,v,A);if("Identifier"===u.callee.type){var L=D(u.callee.name,u.arguments,x);!1===l&&-1===L&&v.push(c(u,"SYNTAX","NOTFOUND"));-2===L&&v.push(c(u,"SYNTAX","WRONGSIGNATURE"))}break;
case "UnaryExpression":g(u.argument,x,l,v,A);break;case "BinaryExpression":g(u.left,x,l,v,A);g(u.right,x,l,v,A);switch(u.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":case "\x26":case "|":case "^":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":break;default:v.push(c(u,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(u.operator){case "\x26\x26":case "||":break;default:v.push(c(u,
"SYNTAX","OPERATORNOTRECOGNISED"))}g(u.left,x,l,v,A);"AssignmentExpression"!==u.left.type&&"UpdateExpression"!==u.left.type||v.push(c(u,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));g(u.right,x,l,v,A);"AssignmentExpression"!==u.right.type&&"UpdateExpression"!==u.right.type||v.push(c(u,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));break;case "ArrayExpression":for(E=0;E<u.elements.length;E++)g(u.elements[E],x,l,v,A);break;case "TemplateLiteral":for(E=0;E<u.quasis.length;E++)g(u.quasis[E],x,l,v,
A);for(E=0;E<u.expressions.length;E++)g(u.expressions[E],x,l,v,A);break;case "ObjectExpression":for(E=0;E<u.properties.length;E++)g(u.properties[E],x,l,v,A);break;case "Property":"Literal"!==u.key.type&&"Identifier"!==u.key.type&&v.push(c(u,"SYNTAX","ONLYLITERAL"));"Literal"===u.key.type&&g(u.key,x,l,v,A);g(u.value,x,l,v,A);break;default:v.push(c(u,"SYNTAX","UNRECOGNISED"))}}catch(K){v.push({line:null===u?0:u.loc.start.line,character:null===u?0:u.loc.start.column,reason:"Unnexpected Syntax"})}}function k(u){var x=
[];y(u,function(l){"CallExpression"===l.type&&"Identifier"===l.callee.type&&x.push(l.callee.name.toLowerCase());return!0});return x}Object.defineProperty(m,"__esModule",{value:!0});m.scriptUsesFeatureSet=m.findScriptDependencies=m.findFunctionCalls=m.checkScript=m.extractAllIssues=m.extractAllIssuesInFunction=m.makeError=m.nodeErrorMessage=m.validateLanguage=m.validateScript=m.constructGlobalScope=m.validateFunction=m.extractFunctionDeclaration=m.findExpectedFieldLiterals=m.findFieldLiterals=m.referencesFunction=
m.referencesMember=m.testValidityOfExpression=m.validateLanguageNode=m.walk=m.findFunction=m.checkFunctionSignature=m.addFunctionDeclaration=m.functionDecls=void 0;m.functionDecls={all:{min:"2",max:"2"},none:{min:"2",max:"2"},any:{min:"2",max:"2"},reduce:{min:"2",max:"3"},map:{min:"2",max:"2"},filter:{min:"2",max:"2"},fromcodepoint:{min:"1",max:"*"},fromcharcode:{min:"1",max:"*"},tocodepoint:{min:"1",max:"2"},tocharcode:{min:"1",max:"2"},concatenate:{min:"0",max:"*"},expects:{min:"1",max:"*"},getfeatureset:{min:"1",
max:"2"},week:{min:"1",max:"2"},fromjson:{min:"1",max:"1"},length3d:{min:"1",max:"2"},tohex:{min:"1",max:"1"},hash:{min:"1",max:"1"},isoweek:{min:"1",max:"1"},isoweekday:{min:"1",max:"1"},isomonth:{min:"1",max:"1"},isoyear:{min:"1",max:"1"},resize:{min:"2",max:"3"},slice:{min:"0",max:"*"},splice:{min:"0",max:"*"},push:{min:"2",max:"2"},pop:{min:"1",max:"1"},includes:{min:"2",max:"2"},array:{min:"1",max:"2"},front:{min:"1",max:"1"},back:{min:"1",max:"1"},insert:{min:"3",max:"3"},erase:{min:"2",max:"2"},
split:{min:"2",max:"4"},guid:{min:"0",max:"1"},today:{min:"0",max:"0"},angle:{min:"2",max:"3"},bearing:{min:"2",max:"3"},urlencode:{min:"1",max:"1"},now:{min:"0",max:"0"},timestamp:{min:"0",max:"0"},day:{min:"1",max:"1"},month:{min:"1",max:"1"},year:{min:"1",max:"1"},hour:{min:"1",max:"1"},second:{min:"1",max:"1"},millisecond:{min:"1",max:"1"},minute:{min:"1",max:"1"},weekday:{min:"1",max:"1"},toutc:{min:"1",max:"1"},tolocal:{min:"1",max:"1"},date:{min:"0",max:"7"},datediff:{min:"2",max:"3"},dateadd:{min:"2",
max:"3"},trim:{min:"1",max:"1"},text:{min:"1",max:"2"},left:{min:"2",max:"2"},right:{min:"2",max:"2"},mid:{min:"2",max:"3"},upper:{min:"1",max:"1"},proper:{min:"1",max:"2"},lower:{min:"1",max:"1"},find:{min:"2",max:"3"},iif:{min:"3",max:"3"},decode:{min:"2",max:"*"},when:{min:"2",max:"*"},defaultvalue:{min:"2",max:"2"},isempty:{min:"1",max:"1"},domaincode:{min:"2",max:"4"},domainname:{min:"2",max:"4"},polygon:{min:"1",max:"1"},point:{min:"1",max:"1"},polyline:{min:"1",max:"1"},extent:{min:"1",max:"1"},
multipoint:{min:"1",max:"1"},ringisclockwise:{min:"1",max:"1"},geometry:{min:"1",max:"1"},count:{min:"0",max:"*"},number:{min:"1",max:"2"},acos:{min:"1",max:"1"},asin:{min:"1",max:"1"},atan:{min:"1",max:"1"},atan2:{min:"2",max:"2"},ceil:{min:"1",max:"2"},floor:{min:"1",max:"2"},round:{min:"1",max:"2"},cos:{min:"1",max:"1"},exp:{min:"1",max:"1"},log:{min:"1",max:"1"},min:{min:"0",max:"*"},constrain:{min:"3",max:"3"},console:{min:"0",max:"*"},max:{min:"0",max:"*"},pow:{min:"2",max:"2"},random:{min:"0",
max:"0"},sqrt:{min:"1",max:"1"},sin:{min:"1",max:"1"},tan:{min:"1",max:"1"},abs:{min:"1",max:"1"},isnan:{min:"1",max:"1"},stdev:{min:"0",max:"*"},average:{min:"0",max:"*"},mean:{min:"0",max:"*"},sum:{min:"0",max:"*"},variance:{min:"0",max:"*"},distinct:{min:"0",max:"*"},first:{min:"1",max:"1"},top:{min:"2",max:"2"},"boolean":{min:"1",max:"1"},dictionary:{min:"0",max:"*"},"typeof":{min:"1",max:"1"},reverse:{min:"1",max:"1"},replace:{min:"3",max:"4"},sort:{min:"1",max:"2"},feature:{min:"1",max:"*"},
haskey:{min:"2",max:"2"},indexof:{min:"2",max:"2"},disjoint:{min:"2",max:"2"},intersects:{min:"2",max:"2"},touches:{min:"2",max:"2"},crosses:{min:"2",max:"2"},within:{min:"2",max:"2"},contains:{min:"2",max:"2"},overlaps:{min:"2",max:"2"},equals:{min:"2",max:"2"},relate:{min:"3",max:"3"},intersection:{min:"2",max:"2"},union:{min:"1",max:"2"},difference:{min:"2",max:"2"},symmetricdifference:{min:"2",max:"2"},clip:{min:"2",max:"2"},cut:{min:"2",max:"2"},area:{min:"1",max:"2"},areageodetic:{min:"1",max:"2"},
length:{min:"1",max:"2"},lengthgeodetic:{min:"1",max:"2"},distancegeodetic:{min:"2",max:"3"},distance:{min:"2",max:"3"},densify:{min:"2",max:"3"},densifygeodetic:{min:"2",max:"3"},generalize:{min:"2",max:"4"},buffer:{min:"2",max:"3"},buffergeodetic:{min:"2",max:"3"},offset:{min:"2",max:"6"},rotate:{min:"2",max:"3"},issimple:{min:"1",max:"1"},simplify:{min:"1",max:"1"},centroid:{min:"1",max:"1"},isselfintersecting:{min:"1",max:"1"},multiparttosinglepart:{min:"1",max:"1"},setgeometry:{min:"2",max:"2"},
portal:{min:"1",max:"1"},getuser:{min:"1",max:"2"},subtypes:{min:"1",max:"1"},subtypecode:{min:"1",max:"1"},subtypename:{min:"1",max:"1"},domain:{min:"2",max:"3"},convertdirection:{min:"3",max:"3"},schema:{min:"1",max:"1"}};for(var w in m.functionDecls)m.functionDecls[w].fmin=m.functionDecls[w].min,m.functionDecls[w].fmax=m.functionDecls[w].max;var t="featureset getuser featuresetbyid featuresetbyname featuresetbyassociation featuresetbyrelationshipname featuresetbyurl getfeatureset attachments featuresetbyportalitem".split(" "),
C="disjoint intersects touches crosses within contains overlaps equals relate intersection union difference symmetricdifference clip cut area areageodetic length length3d lengthgeodetic distance distancegeodetic densify densifygeodetic generalize buffer buffergeodetic offset rotate issimple simplify multiparttosinglepart".split(" ");m.addFunctionDeclaration=function(u,x){var l=m.functionDecls[u.name.toLowerCase()];void 0===l?"sync"===x?m.functionDecls[u.name.toLowerCase()]={min:u.min,max:u.max}:m.functionDecls[u.name.toLowerCase()]=
{fmin:u.min,fmax:u.max}:"sync"===x?(l.min=u.min,l.max=u.max):(l.fmin=u.min,l.fmax=u.max)};m.checkFunctionSignature=a;m.findFunction=D;m.walk=y;m.validateLanguageNode=r;m.testValidityOfExpression=q;m.referencesMember=n;m.referencesFunction=function(u,x){var l=!1,v=x.toLowerCase();y(u,function(A){return l?!1:"CallExpression"===A.type&&"Identifier"===A.callee.type&&A.callee.name&&A.callee.name.toLowerCase()===v?(l=!0,!1):!0});return l};m.findFieldLiterals=function(u){var x=[];y(u,function(l){if("MemberExpression"!==
l.type||"Identifier"!==l.object.type)return!0;!1===l.computed&&l.object&&l.object.name&&l.property&&"Identifier"===l.property.type&&l.property.name?x.push(l.object.name.toLowerCase()+"."+l.property.name.toLowerCase()):l.object&&l.object.name&&l.property&&"Literal"===l.property.type&&"string"===typeof l.property.value&&x.push(l.object.name.toLowerCase()+"."+l.property.value.toString().toLowerCase());return!1});return x};m.findExpectedFieldLiterals=function(u){var x=[];y(u,function(l){if("CallExpression"===
l.type&&"Identifier"===l.callee.type&&"expects"===l.callee.name.toLowerCase()){for(var v="",A=0;A<(l.arguments||[]).length;A++)if(0===A)"Identifier"===l.arguments[A].type&&(v=l.arguments[A].name.toLowerCase());else{var B;if(B=v&&"Literal"===l.arguments[A].type)B=l.arguments[A].value,B="string"===typeof B||B instanceof String;B&&x.push(v+"."+l.arguments[A].value.toLowerCase())}return!1}if("MemberExpression"!==l.type||"Identifier"!==l.object.type)return!0;!1===l.computed&&l.object&&l.object.name&&l.property&&
"Identifier"===l.property.type&&l.property.name?x.push(l.object.name.toLowerCase()+"."+l.property.name.toLowerCase()):l.object&&l.object.name&&l.property&&"Literal"===l.property.type&&"string"===typeof l.property.value&&x.push(l.object.name.toLowerCase()+"."+l.property.value.toString().toLowerCase());return!1});return x};m.extractFunctionDeclaration=f;m.validateFunction=d;m.constructGlobalScope=e;m.validateScript=function(u,x,l,v){void 0===l&&(l="async");void 0===v&&(v=m.functionDecls);x={globalScope:e(x.vars,
v,x.customFunctions,l),localScope:null};return q(u.body[0].body,x)};m.validateLanguage=function(u){return"BlockStatement"!==u.body[0].body.type?"Invalid formula content.":r(u.body[0].body)};m.nodeErrorMessage=b;m.makeError=c;m.extractAllIssuesInFunction=h;m.extractAllIssues=g;m.checkScript=function(u,x,l,v,A){void 0===v&&(v="async");void 0===A&&(A=m.functionDecls);var B=[];if("BlockStatement"!==u.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];if(null===x||void 0===x)x={vars:{},
customFunctions:[]};x={globalScope:e(x.vars,A,x.customFunctions,v),localScope:null};try{g(u.body[0].body,x,l,B)}catch(E){}return B};m.findFunctionCalls=k;m.findScriptDependencies=function(u,x){void 0===x&&(x=[]);var l=null;if(void 0===u.usesFeatureSet){null===l&&(l=k(u));u.usesFeatureSet=!1;for(var v=0;v<l.length;v++)-1<t.indexOf(l[v])&&(u.usesFeatureSet=!0,u.isAsync=!0);if(!1===u.usesFeatureSet&&x&&0<x.length){v=0;for(var A=x;v<A.length;v++)if(n(u,A[v])){u.usesFeatureSet=!0;u.isAsync=!0;break}}}if(void 0===
u.usesGeometry)for(u.usesGeometry=!1,null===l&&(l=k(u)),v=0;v<l.length;v++)-1<C.indexOf(l[v])&&(u.usesGeometry=!0)};m.scriptUsesFeatureSet=function(u){u=k(u);for(var x=0;x<u.length;x++)if(-1<t.indexOf(u[x]))return!0;return!1}})},"esri/arcade/functions/array":function(){define("require exports ../FunctionWrapper ../ImmutableArray ../languageUtils ../polyfill/promiseUtils".split(" "),function(F,m,a,D,z,y){Object.defineProperty(m,"__esModule",{value:!0});m.registerFunctions=void 0;m.registerFunctions=
function(r){function q(f,d){if(d instanceof a)return r.arcadeCustomFunctionHandler(d);if(d instanceof z.NativeFunction)return function(){for(var e=[],b=0;b<arguments.length;b++)e[b]=arguments[b];return d.fn(f,{preparsed:!0,arguments:e})};if(d instanceof z.SizzleFunction)return function(){for(var e=[],b=0;b<arguments.length;b++)e[b]=arguments[b];if(e.length!==d.paramCount)throw Error("Invalid parameters");return d.fn.apply(d,e)};throw Error("Invalid Parameter");}function n(f){if(f instanceof D)return f.toArray();
if(z.isArray(f))return f;throw Error("Invalid Parameter");}r.functions.array=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,1,2);e=z.toNumber(c[0]);if(isNaN(e)||!1===z.isInteger(e))throw Error("Invalid Parameter");c=z.defaultUndefined(c[1],null);e=Array(e);e.fill(c);return e})};r.functions.front=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,1,1);if(z.isImmutableArray(c[0])){if(0>=c[0].length())throw Error("Array is empty");return c[0].get(0)}if(z.isArray(c[0])){if(0>=
c[0].length)throw Error("Array is empty");return c[0][0]}throw Error("Invalid Parameter");})};r.functions.back=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,1,1);if(z.isImmutableArray(c[0])){if(0>=c[0].length())throw Error("Array is empty");return c[0].get(c[0].length()-1)}if(z.isArray(c[0])){if(0>=c[0].length)throw Error("Array is empty");return c[0][c[0].length-1]}throw Error("Invalid Parameter");})};r.functions.push=function(f,d){return r.standardFunction(f,d,function(e,
b,c){z.pcCheck(c,1,2);if(z.isArray(c[0]))return c[0][c[0].length]=c[1],c[0].length;throw Error("Invalid Parameter");})};r.functions.pop=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,1,1);if(z.isArray(c[0])){if(0>=c[0].length)throw Error("Array is empty");e=c[0][c[0].length-1];--c[0].length;return e}throw Error("Invalid Parameter");})};r.functions.erase=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,2,2);if(z.isArray(c[0])){e=z.toNumber(c[1]);if(isNaN(e)||
!1===z.isInteger(e))throw Error("Invalid Parameter");c=c[0];if(0>=c.length)throw Error("Array is empty");0>e&&(e=c.length+e);if(0>e)throw Error("Element not found");if(e>=c.length)throw Error("Index is greater than array");c.splice(e,1);return z.voidOperation}throw Error("Invalid Parameter");})};r.functions.insert=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,3,3);if(z.isArray(c[0])){e=z.toNumber(c[1]);if(isNaN(e)||!1===z.isInteger(e))throw Error("Invalid Parameter");b=c[2];
c=c[0];if(e>c.length)throw Error("Index is greater than array");if(0>e&&e<-1*c.length)throw Error("Index is greater than array");if(e===c.length)return c[e]=b,z.voidOperation;c.splice(e,0,b);return z.voidOperation}throw Error("Invalid Parameter");})};r.functions.resize=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,2,3);if(z.isArray(c[0])){b=z.toNumber(c[1]);if(isNaN(b)||!1===z.isInteger(b))throw Error("Invalid Parameter");if(0>b)throw Error("Size cannot be negative");e=z.defaultUndefined(c[2],
null);c=c[0];if(c.length>=b)return c.length=b,z.voidOperation;var h=c.length;c.length=b;for(b=h;b<c.length;b++)c[b]=e;return z.voidOperation}throw Error("Invalid Parameter");})};r.functions.includes=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,2,2);if(z.isArray(c[0])){var h=c[1];e=c[0];return-1<e.findIndex(function(k){return z.equalityTest(k,h)})?!0:!1}if(z.isImmutableArray(c[0])){var g=c[1];e=c[0].toArray();return-1<e.findIndex(function(k){return z.equalityTest(k,g)})?
!0:!1}throw Error("Invalid Parameter");})};r.functions.slice=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,1,3);if(z.isArray(c[0])){e=z.toNumber(z.defaultUndefined(c[1],0));b=z.toNumber(z.defaultUndefined(c[2],c[0].length));if(isNaN(e)||!1===z.isInteger(e))throw Error("Invalid Parameter");if(isNaN(b)||!1===z.isInteger(b))throw Error("Invalid Parameter");var h=c[0];return h.slice(e,b)}if(z.isImmutableArray(c[0])){h=c[0];e=z.toNumber(z.defaultUndefined(c[1],0));b=z.toNumber(z.defaultUndefined(c[2],
h.length()));if(isNaN(e)||!1===z.isInteger(e))throw Error("Invalid Parameter");if(isNaN(b)||!1===z.isInteger(b))throw Error("Invalid Parameter");return h.toArray().slice(e,b)}throw Error("Invalid Parameter");})};r.functions.splice=function(f,d){return r.standardFunction(f,d,function(e,b,c){e=[];for(b=0;b<c.length;b++)z.isArray(c[b])?e.push.apply(e,c[b]):z.isImmutableArray(c[b])?e.push.apply(e,c[b].toArray()):e.push(c[b]);return e})};"sync"===r.mode&&(r.functions.any=function(f,d){return r.standardFunction(f,
d,function(e,b,c){z.pcCheck(c,2,2);e=q(f,c[1]);b=0;for(c=n(c[0]);b<c.length;b++){var h=e(c[b]);if(z.isBoolean(h)&&!0===h)return!0}return!1})},r.functions.all=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,2,2);e=q(f,c[1]);b=0;for(c=n(c[0]);b<c.length;b++)if(!0!==e(c[b]))return!1;return!0})},r.functions.none=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,2,2);e=q(f,c[1]);b=0;for(c=n(c[0]);b<c.length;b++)if(!0===e(c[b]))return!1;return!0})},r.functions.reduce=
function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,2,3);var h=q(f,c[1]);e=n(c[0]);return 2===c.length?0===e.length?null:e.reduce(function(g,k){var w=h(g,k);return g=void 0!==w&&w!==z.voidOperation?w:null}):e.reduce(function(g,k){var w=h(g,k);return g=void 0!==w&&w!==z.voidOperation?w:null},c[2])})},r.functions.map=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,2,2);e=q(f,c[1]);b=[];var h=0;for(c=n(c[0]);h<c.length;h++){var g=e(c[h]);void 0!==g&&g!==z.voidOperation?
b.push(g):b.push(null)}return b})},r.functions.filter=function(f,d){return r.standardFunction(f,d,function(e,b,c){z.pcCheck(c,2,2);e=q(f,c[1]);b=[];var h=0;for(c=n(c[0]);h<c.length;h++){var g=c[h];!0===e(g)&&b.push(g)}return b})});"async"===r.mode&&(r.functions.any=function(f,d){return r.standardFunctionAsync(f,d,function(e,b,c){z.pcCheck(c,2,2);var h=q(f,c[1]),g=!1;return n(c[0]).reduce(function(k,w,t){return k.then(function(C){0<t&&!0===C&&(g=!0);if(!0===g)return y.resolve(!0);C=h(w);return y.isPromiseLike(C)?
C:y.resolve(C)})},Promise.resolve(!1)).then(function(k){!0===k&&(g=!0);return g})})},r.functions.all=function(f,d){return r.standardFunctionAsync(f,d,function(e,b,c){z.pcCheck(c,2,2);var h=q(f,c[1]),g=!0;return n(c[0]).reduce(function(k,w,t){return k.then(function(C){0<t&&!0!==C&&(g=!1);if(!1===g)return y.resolve(!1);C=h(w);return y.isPromiseLike(C)?C:y.resolve(C)})},Promise.resolve(!0)).then(function(k){!0!==k&&(g=!1);return g})})},r.functions.none=function(f,d){return r.standardFunctionAsync(f,
d,function(e,b,c){z.pcCheck(c,2,2);var h=q(f,c[1]),g=!0;return n(c[0]).reduce(function(k,w,t){return k.then(function(C){0<t&&!0===C&&(g=!1);if(!1===g)return y.resolve(!0);C=h(w);return y.isPromiseLike(C)?C:y.resolve(C)})},Promise.resolve(!1)).then(function(k){!0===k&&(g=!1);return g})})},r.functions.filter=function(f,d){return r.standardFunctionAsync(f,d,function(e,b,c){z.pcCheck(c,2,2);var h=q(f,c[1]),g=n(c[0]),k=[];return g.reduce(function(w,t,C){return w.then(function(u){0<C&&!0===u&&k.push(g[C-
1]);u=h(t);return y.isPromiseLike(u)?u:y.resolve(u)})},Promise.resolve(!1)).then(function(w){!0===w&&0<g.length&&k.push(g[g.length-1]);return k})})},r.functions.reduce=function(f,d){return r.standardFunctionAsync(f,d,function(e,b,c){z.pcCheck(c,2,3);var h=q(f,c[1]);e=n(c[0]);b=null;if(2<c.length)c=z.defaultUndefined(c[2],null),b=e.reduce(function(g,k){return g.then(function(w){if(void 0===w||w===z.voidOperation)w=null;w=h(w,k);return y.isPromiseLike(w)?w:y.resolve(w)})},Promise.resolve(c));else{if(0===
e.length)return null;b=e.reduce(function(g,k,w){return 1>=w?(g=h(g,k),y.isPromiseLike(g)?g:y.resolve(g)):g.then(function(t){if(void 0===t||t===z.voidOperation)t=null;t=h(t,k);return y.isPromiseLike(t)?t:y.resolve(t)})})}return b.then(function(g){return void 0!==g&&g!==z.voidOperation?g:null})})},r.functions.map=function(f,d){return r.standardFunctionAsync(f,d,function(e,b,c){z.pcCheck(c,2,2);var h=q(f,c[1]),g=n(c[0]),k=[];return g.reduce(function(w,t,C){return w.then(function(u){0<C&&(void 0!==u&&
u!==z.voidOperation?k.push(u):k.push(null));u=h(t);return y.isPromiseLike(u)?u:y.resolve(u)})},Promise.resolve()).then(function(w){0<g.length&&(void 0!==w&&w!==z.voidOperation?k.push(w):k.push(null));return k})})})}})},"esri/arcade/functions/date":function(){define(["require","exports","../languageUtils","../../libs/luxon/luxon","dojo/_base/kernel"],function(F,m,a,D,z){function y(d){d=new Date(d.getTime());var e=d.getFullYear(),b=new Date(0);b.setFullYear(e+1,0,4);b.setHours(0,0,0,0);b=r(b);var c=
new Date(0);c.setFullYear(e,0,4);c.setHours(0,0,0,0);c=r(c);return d.getTime()>=b.getTime()?e+1:d.getTime()>=c.getTime()?e:e-1}function r(d){d=new Date(d.getTime());var e=d.getDay();e=(1>e?7:0)+e-1;d.setDate(d.getDate()-e);d.setHours(0,0,0,0);return d}function q(d){return null===d?d:isNaN(d.getTime())?null:d}Object.defineProperty(m,"__esModule",{value:!0});m.registerFunctions=void 0;var n=[0,31,59,90,120,151,181,212,243,273,304,334],f=[0,31,60,91,121,152,182,213,244,274,305,335];m.registerFunctions=
function(d,e){d.today=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,0,0);h=new Date;h.setHours(0,0,0,0);return h})};d.now=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,0,0);return new Date})};d.timestamp=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,0,0);h=new Date;return h=new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds())})};d.toutc=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,
1,1);h=a.toDate(k[0]);return null===h?null:new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds())})};d.tolocal=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?null:D.DateTime.utc(h.getFullYear(),h.getMonth()+1,h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds(),h.getMilliseconds()).toJSDate()})};d.day=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);
return null===h?NaN:h.getDate()})};d.month=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?NaN:h.getMonth()})};d.year=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?NaN:h.getFullYear()})};d.hour=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?NaN:h.getHours()})};d.second=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?
NaN:h.getSeconds()})};d.millisecond=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?NaN:h.getMilliseconds()})};d.minute=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?NaN:h.getMinutes()})};d.week=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,2);h=a.toDate(k[0]);if(null===h)return NaN;k=a.toNumber(a.defaultUndefined(k[1],0));if(0>k||6<k)throw Error("Invalid Parameter");g=h.getDate();var w=h.getMonth(),
t=h.getFullYear();h=h.getDay();g=g+(0!==t%4||0===t%100&&0!==t%400?n:f)[w]-1;w=Math.floor(g/7);return h-k+(0>h-k?7:0)<g-7*w?w+1:w})};d.weekday=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?NaN:h.getDay()})};d.isoweekday=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);if(null===h)return NaN;h=h.getDay();0===h&&(h=7);return h})};d.isomonth=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===
h?NaN:h.getMonth()+1})};d.isoweek=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);g=a.toDate(k[0]);if(null===g)return NaN;h=r(g).getTime();g=y(g);k=new Date(0);k.setFullYear(g,0,4);k.setHours(0,0,0,0);g=r(k);h-=g.getTime();return Math.round(h/6048E5)+1})};d.isoyear=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,1,1);h=a.toDate(k[0]);return null===h?NaN:y(h)})};d.date=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,0,7);if(3===k.length)return q(new Date(a.toNumber(k[0]),
a.toNumber(k[1]),a.toNumber(k[2]),0,0,0,0));if(4===k.length)return q(new Date(a.toNumber(k[0]),a.toNumber(k[1]),a.toNumber(k[2]),a.toNumber(k[3]),0,0,0));if(5===k.length)return q(new Date(a.toNumber(k[0]),a.toNumber(k[1]),a.toNumber(k[2]),a.toNumber(k[3]),a.toNumber(k[4]),0,0));if(6===k.length)return q(new Date(a.toNumber(k[0]),a.toNumber(k[1]),a.toNumber(k[2]),a.toNumber(k[3]),a.toNumber(k[4]),a.toNumber(k[5]),0));if(7===k.length)return q(new Date(a.toNumber(k[0]),a.toNumber(k[1]),a.toNumber(k[2]),
a.toNumber(k[3]),a.toNumber(k[4]),a.toNumber(k[5]),a.toNumber(k[6])));if(2===k.length){h=a.toString(k[1]);if(""===h)return null;h=a.standardiseDateFormat(h);g=void 0;g="X"===h?D.DateTime.fromSeconds(a.toNumber(k[0])):"x"===h?D.DateTime.fromMillis(a.toNumber(k[0])):D.DateTime.fromFormat(a.toString(k[0]),h,{locale:z.locale,numberingSystem:"latn"});return g.isValid?g.toJSDate():null}if(1===k.length){if(a.isString(k[0])){if(""===k[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;if(!0===
/^[0-9][0-9][0-9][0-9]$/.test(k[0]))return a.toDate(k[0]+"-01-01")}h=a.toNumber(k[0]);return!1===isNaN(h)?q(new Date(h)):a.toDate(k[0])}if(0===k.length)return new Date})};d.datediff=function(b,c){return e(b,c,function(h,g,k){a.pcCheck(k,2,3);h=a.toDateTime(k[0]);g=a.toDateTime(k[1]);if(null===h||null===g)return NaN;switch(a.toString(k[2]).toLowerCase()){case "days":case "day":case "d":return h.diff(g,"days").days;case "months":case "month":return h.diff(g,"months").months;case "minutes":case "minute":case "m":return"M"===
k[2]?h.diff(g,"months").months:h.diff(g,"minutes").minutes;case "seconds":case "second":case "s":return h.diff(g,"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return h.diff(g).milliseconds;case "hours":case "hour":case "h":return h.diff(g,"hours").hours;case "years":case "year":case "y":return h.diff(g,"years").years;default:return h.diff(g).milliseconds}})};d.dateadd=function(b,c){return e(b,c,function(h,g,k){var w;a.pcCheck(k,2,3);h=a.toDateTime(k[0]);if(null===h)return null;
g=a.toNumber(k[1]);if(isNaN(g))return h.toJSDate();var t="milliseconds";switch(a.toString(k[2]).toLowerCase()){case "days":case "day":case "d":t="days";g=a.absRound(g);break;case "months":case "month":t="months";g=a.absRound(g);break;case "minutes":case "minute":case "m":t="M"===k[2]?"months":"minutes";break;case "seconds":case "second":case "s":t="seconds";break;case "milliseconds":case "millisecond":case "ms":t="milliseconds";break;case "hours":case "hour":case "h":t="hours";break;case "years":case "year":case "y":t=
"years"}return h.plus((w={},w[t]=g,w)).toJSDate()})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../Dictionary ../Feature ../ImmutablePointArray ../languageUtils ../../geometry/Extent ../../geometry/Geometry ../../geometry/Multipoint ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline ./centroid ../../geometry/jsonUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c){function h(g){return g&&(g instanceof D||"object"===typeof g&&"FeatureSetReader"===g.type)}
Object.defineProperty(m,"__esModule",{value:!0});m.registerFunctions=void 0;m.registerFunctions=function(g,k){g.ringisclockwise=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,1,1);C=[];if(null===x[0])return!1;if(y.isArray(x[0])){var l=0;for(x=x[0];l<x.length;l++)if(u=x[l],u instanceof f)C.push([u.x,u.y]);else throw Error("Invalid Argument");}else if(x[0]instanceof z)C=x[0]._elements;else if(y.isImmutableArray(x[0])){l=0;for(var v=x[0].toArray();l<v.length;l++)if(u=v[l],u instanceof f)C.push([u.x,
u.y]);else throw Error("Invalid Argument");0<C.length&&(x[0].get(0),x[0].get(0))}else throw Error("Invalid Argument");return 3>C.length?!1:(new d({rings:[],spatialReference:{wkid:4326}})).isClockwise(C)})};g.polygon=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,1,1);C=null;if(x[0]instanceof a){if(C=y.fixSpatialReference(D.parseGeometryFromDictionary(x[0]),w.spatialReference),!1===C instanceof d)throw Error("Illegal Parameter");}else C=x[0]instanceof d?c.fromJson(x[0].toJson()):y.fixSpatialReference(new d(JSON.parse(x[0])),
w.spatialReference);if(null!==C&&!1===C.spatialReference.equals(w.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return y.fixNullGeometry(C)})};g.polyline=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,1,1);C=null;if(x[0]instanceof a){if(C=y.fixSpatialReference(D.parseGeometryFromDictionary(x[0]),w.spatialReference),!1===C instanceof e)throw Error("Illegal Parameter");}else C=x[0]instanceof e?c.fromJson(x[0].toJson()):
y.fixSpatialReference(new e(JSON.parse(x[0])),w.spatialReference);if(null!==C&&!1===C.spatialReference.equals(w.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return y.fixNullGeometry(C)})};g.point=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,1,1);C=null;if(x[0]instanceof a){if(C=y.fixSpatialReference(D.parseGeometryFromDictionary(x[0]),w.spatialReference),!1===C instanceof f)throw Error("Illegal Parameter");
}else C=x[0]instanceof f?c.fromJson(x[0].toJson()):y.fixSpatialReference(new f(JSON.parse(x[0])),w.spatialReference);if(null!==C&&!1===C.spatialReference.equals(w.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return y.fixNullGeometry(C)})};g.multipoint=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,1,1);C=null;if(x[0]instanceof a){if(C=y.fixSpatialReference(D.parseGeometryFromDictionary(x[0]),w.spatialReference),
!1===C instanceof n)throw Error("Illegal Parameter");}else C=x[0]instanceof n?c.fromJson(x[0].toJson()):y.fixSpatialReference(new n(JSON.parse(x[0])),w.spatialReference);if(null!==C&&!1===C.spatialReference.equals(w.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return y.fixNullGeometry(C)})};g.extent=function(w,t){return k(w,t,function(C,u,x){x=y.autoCastFeatureToGeometry(x);y.pcCheck(x,1,1);C=null;x[0]instanceof a?
C=y.fixSpatialReference(D.parseGeometryFromDictionary(x[0]),w.spatialReference):x[0]instanceof f?(C={xmin:x[0].x,ymin:x[0].y,xmax:x[0].x,ymax:x[0].y,spatialReference:x[0].spatialReference.toJson()},x=x[0],x.hasZ?(C.zmin=x.z,C.zmax=x.z):x.hasM&&(C.mmin=x.m,C.mmax=x.m),C=c.fromJson(C)):C=x[0]instanceof d?c.fromJson(x[0].getExtent().toJson()):x[0]instanceof e?c.fromJson(x[0].getExtent().toJson()):x[0]instanceof n?c.fromJson(x[0].getExtent().toJson()):x[0]instanceof r?c.fromJson(x[0].toJson()):y.fixSpatialReference(new r(JSON.parse(x[0])),
w.spatialReference);if(null!==C&&!1===C.spatialReference.equals(w.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return y.fixNullGeometry(C)})};g.geometry=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,1,1);C=null;if(null===x[0])return null;C=h(x[0])?y.fixSpatialReference(x[0].geometry(),w.spatialReference):x[0]instanceof a?y.fixSpatialReference(D.parseGeometryFromDictionary(x[0]),w.spatialReference):y.fixSpatialReference(c.fromJson(JSON.parse(x[0])),
w.spatialReference);if(null!==C&&!1===C.spatialReference.equals(w.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return y.fixNullGeometry(C)})};g.setgeometry=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,2,2);if(h(x[0])){if(!0===x[0].immutable)throw Error("Feature is Immutable");if(x[1]instanceof q||null===x[1])x[0]._geometry=x[1];else throw Error("Illegal Argument");}else throw Error("Illegal Argument");return y.voidOperation})};
g.feature=function(w,t){return k(w,t,function(C,u,x){if(0===x.length)throw Error("Missing Parameters");C=null;if(1===x.length)if(y.isString(x[0]))C=D.fromJson(JSON.parse(x[0]));else if(h(x[0]))C=D.createFromArcadeFeature(x[0]);else if(x[0]instanceof q)C=D.createFromGraphicLikeObject(x[0],null,null);else if(x[0]instanceof a)C=x[0].hasField("geometry")?x[0].field("geometry"):null,u=x[0].hasField("attributes")?x[0].field("attributes"):null,null!==C&&C instanceof a&&(C=D.parseGeometryFromDictionary(C)),
null!==u&&(u=D.parseAttributesFromDictionary(u)),C=D.createFromGraphicLikeObject(C,u,null);else throw Error("Illegal Argument");else{if(2===x.length){u=C=null;if(null!==x[0])if(x[0]instanceof q)C=x[0];else if(C instanceof a)C=D.parseGeometryFromDictionary(x[0]);else throw Error("Illegal Argument");if(null!==x[1])if(x[1]instanceof a)u=D.parseAttributesFromDictionary(x[1]);else throw Error("Illegal Argument");}else{C=null;u={};if(null!==x[0])if(x[0]instanceof q)C=x[0];else if(C instanceof a)C=D.parseGeometryFromDictionary(x[0]);
else throw Error("Illegal Argument");for(var l=1;l<x.length;l+=2){var v=y.toString(x[l]),A=x[l+1];if(null===A||void 0===A||y.isString(A)||isNaN(A)||y.isDate(A)||y.isNumber(A)||y.isBoolean(A)){if(y.isFunctionParameter(A)||!1===y.isSimpleType(A))throw Error("Illegal Argument");u[v]=A===y.voidOperation?null:A}else throw Error("Illegal Argument");}}C=D.createFromGraphicLikeObject(C,u,null)}C._geometry=y.fixSpatialReference(C.geometry(),w.spatialReference);C.immutable=!1;return C})};g.dictionary=function(w,
t){return k(w,t,function(C,u,x){if(0===x.length)return x=new a,x.immutable=!1,x;if(1===x.length&&y.isString(x[0]))try{var l=JSON.parse(x[0]),v=a.convertObjectToArcadeDictionary(l,!1);v.immutable=!1;return v}catch(A){throw Error("Missing Parameters or Illegal Json");}if(0!==x.length%2)throw Error("Missing Parameters");C={};for(u=0;u<x.length;u+=2)if(l=y.toString(x[u]),v=x[u+1],null===v||void 0===v||y.isString(v)||isNaN(v)||y.isDate(v)||y.isNumber(v)||y.isBoolean(v)||y.isArray(v)||y.isImmutableArray(v)){if(y.isFunctionParameter(v))throw Error("Illegal Argument");
C[l]=v===y.voidOperation?null:v}else throw Error("Illegal Argument");x=new a(C);x.immutable=!1;return x})};g.haskey=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,2,2);C=y.toString(x[1]);if(h(x[0])||x[0]instanceof a)return x[0].hasField(C);throw Error("Illegal Argument");})};g.indexof=function(w,t){return k(w,t,function(C,u,x){y.pcCheck(x,2,2);C=x[1];if(y.isArray(x[0])){for(u=0;u<x[0].length;u++)if(y.equalityTest(C,x[0][u]))return u;return-1}if(y.isImmutableArray(x[0])){var l=x[0].length();
for(u=0;u<l;u++)if(y.equalityTest(C,x[0].get(u)))return u;return-1}throw Error("Illegal Argument");})};g.angle=function(w,t){return k(w,t,function(C,u,x){x=y.autoCastFeatureToGeometry(x);y.pcCheck(x,2,3);if(!(x[0]instanceof f))throw Error("Illegal Argument");if(!(x[1]instanceof f))throw Error("Illegal Argument");if(2<x.length&&!(x[2]instanceof f))throw Error("Illegal Argument");return 2===x.length?b.angle2D(x[0],x[1]):b.angleBetween2D(x[0],x[1],x[2])})};g.bearing=function(w,t){return k(w,t,function(C,
u,x){x=y.autoCastFeatureToGeometry(x);y.pcCheck(x,2,3);if(!(x[0]instanceof f))throw Error("Illegal Argument");if(!(x[1]instanceof f))throw Error("Illegal Argument");if(2<x.length&&!(x[2]instanceof f))throw Error("Illegal Argument");return 2===x.length?b.bearing2D(x[0],x[1]):b.bearingBetween2D(x[0],x[1],x[2])})};g.isselfintersecting=function(w,t){return k(w,t,function(C,u,x){x=y.autoCastFeatureToGeometry(x);y.pcCheck(x,1,1);C=x[0];if(C instanceof d)return C.isSelfIntersecting(C);if(C instanceof e)return C=
C.paths,b.pathsSelfIntersecting(C);if(C instanceof n)for(u=C.points,x=0;x<u.length;x++)for(var l=0;l<u.length;l++)if(l!==x){for(var v=!0,A=0;A<u[x].length;A++)if(u[x][A]!==u[l][A]){v=!1;break}if(!0===v)return!0}return y.isArray(C)||y.isImmutableArray(C)?(C=y.autoCastArrayOfPointsToPolyline(C,w.spatialReference),null!==C&&(C=C.paths),b.pathsSelfIntersecting(C)):!1})}}})},"esri/arcade/functions/centroid":function(){define(["require","exports","../../geometry/Point"],function(F,m,a){function D(d,e,b){var c=
{x:0,y:0};e&&(c.z=0);b&&(c.m=0);for(var h=0,g=d[0],k=0;k<d.length;k++){var w=d[k];a:if(w.length!==g.length)var t=!1;else{for(t=0;t<w.length;t++)if(w[t]!==g[t]){t=!1;break a}t=!0}if(!1===t){t=z(g,w,e);var C=w,u=e,x=b,l={x:(g[0]+C[0])/2,y:(g[1]+C[1])/2};u&&(l.z=(g[2]+C[2])/2);u&&x?l.m=(g[3]+C[3])/2:x&&(l.m=(g[2]+C[2])/2);g=l;g.x*=t;g.y*=t;c.x+=g.x;c.y+=g.y;e&&(g.z*=t,c.z+=g.z);b&&(g.m*=t,c.m+=g.m);h+=t;g=w}}0<h?(c.x/=h,c.y/=h,e&&(c.z/=h),b&&(c.m/=h)):(c.x=d[0][0],c.y=d[0][1],e&&(c.z=d[0][2]),b&&e?c.m=
d[0][3]:b&&(c.m=d[0][2]));return c}function z(d,e,b){var c=e[0]-d[0];d=e[1]-d[1];return b?(e=e[2]-e[2],Math.sqrt(c*c+d*d+e*e)):Math.sqrt(c*c+d*d)}function y(d,e,b){for(void 0===b&&(b=0);d<b;)d+=e;for(b+=e;d>=b;)d-=e;return d}function r(d,e){return Math.atan2(e.y-d.y,e.x-d.x)}function q(d,e,b){var c=d.x-e.x;d=d.y-e.y;var h=b.x-e.x;e=b.y-e.y;return Math.atan2(c*e-h*d,c*h+d*e)}function n(d,e,b,c,h){var g=d[0];d=d[1];var k=e[0];e=e[1];var w=b[0],t=b[1];b=c[0]-w;w=g-w;var C=k-g;c=c[1]-t;t=d-t;var u=e-
d,x=c*C-b*u;if(0===x)return!1;b=(b*t-c*w)/x;w=(C*t-u*w)/x;return 0<=b&&1>=b&&0<=w&&1>=w?(h&&(h[0]=g+b*(k-g),h[1]=d+b*(e-d)),!0):!1}Object.defineProperty(m,"__esModule",{value:!0});m.pathsSelfIntersecting=m.bearingBetween2D=m.angleBetween2D=m.angleBetweenRad=m.bearing2D=m.angle2D=m.angleRad=m.centroidMultiPoint=m.centroidPolyline=void 0;m.centroidPolyline=function(d){for(var e={x:0,y:0,spatialReference:d.spatialReference.toJson()},b={x:0,y:0,spatialReference:d.spatialReference.toJson()},c=0,h=0,g=
0;g<d.paths.length;g++)if(0!==d.paths[g].length){var k=d.paths[g];var w=!0===d.hasZ;if(1>=k.length)k=0;else{for(var t=0,C=1;C<k.length;C++)t+=z(k[C-1],k[C],w);k=t}0===k?(w=D(d.paths[g],!0===d.hasZ,!0===d.hasM),e.x+=w.x,e.y+=w.y,!0===d.hasZ&&(e.z+=w.z),!0===d.hasM&&(e.m+=w.m),++c):(w=D(d.paths[g],!0===d.hasZ,!0===d.hasM),b.x+=w.x*k,b.y+=w.y*k,!0===d.hasZ&&(b.z+=w.z*k),!0===d.hasM&&(b.m+=w.m*k),h+=k)}return 0<h?(b.x/=h,b.y/=h,!0===d.hasZ&&(b.z/=h),!0===d.hasM&&(b.m/=h),new a(b)):0<c?(e.x/=c,e.y/=c,
!0===d.hasZ&&(b.z/=c),!0===d.hasM&&(e.m/=c),new a(e)):null};m.centroidMultiPoint=function(d){if(0===d.points.length)return null;for(var e=0,b=0,c=0,h=0,g=0;g<d.points.length;g++){var k=d.getPoint(g);!0===k.hasZ&&(c+=k.z);!0===k.hasM&&(h+=k.m);e+=k.x;b+=k.y;h+=k.m}e={x:e/d.points.length,y:b/d.points.length,spatialReference:null};e.spatialReference=d.spatialReference.toJson();!0===d.hasZ&&(e.z=c/d.points.length);!0===d.hasM&&(e.m=h/d.points.length);return new a(e)};m.angleRad=r;m.angle2D=function(d,
e){return y(r(d,e),2*Math.PI)*(180/Math.PI)};m.bearing2D=function(d,e){return y(Math.PI/2-r(d,e),2*Math.PI)*(180/Math.PI)};m.angleBetweenRad=q;m.angleBetween2D=function(d,e,b){return y(q(d,e,b),2*Math.PI)*(180/Math.PI)};m.bearingBetween2D=function(d,e,b){return y(-1*q(d,e,b),2*Math.PI)*(180/Math.PI)};var f=[0,0];m.pathsSelfIntersecting=function(d){for(var e=0;e<d.length;e++){for(var b=d[e],c=0;c<b.length-1;c++)for(var h=b[c],g=b[c+1],k=e+1;k<d.length;k++)for(var w=0;w<d[k].length-1;w++){var t=d[k][w],
C=d[k][w+1],u=n(h,g,t,C,f);if(u&&!(f[0]===h[0]&&f[1]===h[1]||f[0]===t[0]&&f[1]===t[1]||f[0]===g[0]&&f[1]===g[1]||f[0]===C[0]&&f[1]===C[1]))return!0}w=b.length;if(!(3>w))for(c=0;c<=w-2;c++)for(h=b[c],g=b[c+1],k=c+2;k<=w-2;k++)if(t=b[k],C=b[k+1],(u=n(h,g,t,C,f))&&!(f[0]===h[0]&&f[1]===h[1]||f[0]===t[0]&&f[1]===t[1]||f[0]===g[0]&&f[1]===g[1]||f[0]===C[0]&&f[1]===C[1]))return!0}return!1}})},"esri/arcade/functions/geomsync":function(){define("require exports ../../kernel ../kernel ../languageUtils ./centroid ../../geometry/Extent ../../geometry/Geometry ../../geometry/Multipoint ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline ../../geometry/jsonUtils".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b){function c(g){return 0===a.version.indexOf("4.")?d.fromExtent(g):new d({spatialReference:g.spatialReference,rings:[[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]]]})}Object.defineProperty(m,"__esModule",{value:!0});m.registerFunctions=m.setGeometryEngine=void 0;var h=null;m.setGeometryEngine=function(g){h=g};m.registerFunctions=function(g,k){function w(t){z.pcCheck(t,2,2);if(!(t[0]instanceof q&&t[1]instanceof q||t[0]instanceof q&&
null===t[1]||t[1]instanceof q&&null===t[0]||null===t[0]&&null===t[1]))throw Error("Illegal Argument");}g.disjoint=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null===l[0]||null===l[1]?!0:h.disjoint(l[0],l[1])})};g.intersects=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null===l[0]||null===l[1]?!1:h.intersects(l[0],l[1])})};g.touches=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);
return null===l[0]||null===l[1]?!1:h.touches(l[0],l[1])})};g.crosses=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null===l[0]||null===l[1]?!1:h.crosses(l[0],l[1])})};g.within=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null===l[0]||null===l[1]?!1:h.within(l[0],l[1])})};g.contains=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null===l[0]||null===l[1]?!1:h.contains(l[0],l[1])})};
g.overlaps=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null===l[0]||null===l[1]?!1:h.overlaps(l[0],l[1])})};g.equals=function(t,C){return k(t,C,function(u,x,l){z.pcCheck(l,2,2);return l[0]===l[1]?!0:l[0]instanceof q&&l[1]instanceof q?h.equals(l[0],l[1]):z.isDate(l[0])&&z.isDate(l[1])?l[0].getTime()===l[1].getTime():!1})};g.relate=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,3,3);if(l[0]instanceof q&&l[1]instanceof
q)return h.relate(l[0],l[1],z.toString(l[2]));if(l[0]instanceof q&&null===l[1]||l[1]instanceof q&&null===l[0]||null===l[0]&&null===l[1])return!1;throw Error("Illegal Argument");})};g.intersection=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null===l[0]||null===l[1]?null:h.intersect(l[0],l[1])})};g.union=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);u=[];if(0===l.length)throw Error("Function called with wrong number of Parameters");
if(1===l.length)if(z.isArray(l[0]))for(l=z.autoCastFeatureToGeometry(l[0]),x=0;x<l.length;x++){if(null!==l[x]){if(!(l[x]instanceof q))throw Error("Illegal Argument");u.push(l[x])}}else if(z.isImmutableArray(l[0]))for(l=z.autoCastFeatureToGeometry(l[0].toArray()),x=0;x<l.length;x++){if(null!==l[x]){if(!(l[x]instanceof q))throw Error("Illegal Argument");u.push(l[x])}}else{if(l[0]instanceof q)return z.fixSpatialReference(D.cloneGeometry(l[0]),t.spatialReference);if(null===l[0])return null;throw Error("Illegal Argument");
}else for(x=0;x<l.length;x++)if(null!==l[x]){if(!(l[x]instanceof q))throw Error("Illegal Argument");u.push(l[x])}return 0===u.length?null:h.union(u)})};g.difference=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null!==l[0]&&null===l[1]?D.cloneGeometry(l[0]):null===l[0]?null:h.difference(l[0],l[1])})};g.symmetricdifference=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);w(l);return null===l[0]&&null===l[1]?null:null===l[0]?D.cloneGeometry(l[1]):
null===l[1]?D.cloneGeometry(l[0]):h.symmetricDifference(l[0],l[1])})};g.clip=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,2);if(!(l[1]instanceof r)&&null!==l[1])throw Error("Illegal Argument");if(null===l[0])return null;if(!(l[0]instanceof q))throw Error("Illegal Argument");return null===l[1]?null:h.clip(l[0],l[1])})};g.cut=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,2);if(!(l[1]instanceof e)&&null!==l[1])throw Error("Illegal Argument");
if(null===l[0])return[];if(!(l[0]instanceof q))throw Error("Illegal Argument");return null===l[1]?[D.cloneGeometry(l[0])]:h.cut(l[0],l[1])})};g.area=function(t,C){return k(t,C,function(u,x,l){z.pcCheck(l,1,2);l=z.autoCastFeatureToGeometry(l);if(null===l[0])return 0;if(z.isArray(l[0])||z.isImmutableArray(l[0]))return u=z.autoCastArrayOfPointsToPolygon(l[0],t.spatialReference),null===u?0:h.planarArea(u,D.convertSquareUnitsToCode(z.defaultUndefined(l[1],-1)));if(!(l[0]instanceof q))throw Error("Illegal Argument");
return h.planarArea(l[0],D.convertSquareUnitsToCode(z.defaultUndefined(l[1],-1)))})};g.areageodetic=function(t,C){return k(t,C,function(u,x,l){z.pcCheck(l,1,2);l=z.autoCastFeatureToGeometry(l);if(null===l[0])return 0;if(z.isArray(l[0])||z.isImmutableArray(l[0]))return u=z.autoCastArrayOfPointsToPolygon(l[0],t.spatialReference),null===u?0:h.geodesicArea(u,D.convertSquareUnitsToCode(z.defaultUndefined(l[1],-1)));if(!(l[0]instanceof q))throw Error("Illegal Argument");return h.geodesicArea(l[0],D.convertSquareUnitsToCode(z.defaultUndefined(l[1],
-1)))})};g.length=function(t,C){return k(t,C,function(u,x,l){z.pcCheck(l,1,2);l=z.autoCastFeatureToGeometry(l);if(null===l[0])return 0;if(z.isArray(l[0])||z.isImmutableArray(l[0]))return u=z.autoCastArrayOfPointsToPolyline(l[0],t.spatialReference),null===u?0:h.planarLength(u,D.convertLinearUnitsToCode(z.defaultUndefined(l[1],-1)));if(!(l[0]instanceof q))throw Error("Illegal Argument");return h.planarLength(l[0],D.convertLinearUnitsToCode(z.defaultUndefined(l[1],-1)))})};g.length3d=function(t,C){return k(t,
C,function(u,x,l){z.pcCheck(l,1,2);l=z.autoCastFeatureToGeometry(l);if(null===l[0])return 0;if(z.isArray(l[0])||z.isImmutableArray(l[0]))return u=z.autoCastArrayOfPointsToPolyline(l[0],t.spatialReference),null===u?0:h.planarLength(u,D.convertLinearUnitsToCode(z.defaultUndefined(l[1],-1)));if(!(l[0]instanceof q))throw Error("Illegal Argument");return h.planarLength(l[0],D.convertLinearUnitsToCode(z.defaultUndefined(l[1],-1)))})};g.lengthgeodetic=function(t,C){return k(t,C,function(u,x,l){z.pcCheck(l,
1,2);l=z.autoCastFeatureToGeometry(l);if(null===l[0])return 0;if(z.isArray(l[0])||z.isImmutableArray(l[0]))return u=z.autoCastArrayOfPointsToPolyline(l[0],t.spatialReference),null===u?0:h.geodesicLength(u,D.convertLinearUnitsToCode(z.defaultUndefined(l[1],-1)));if(!(l[0]instanceof q))throw Error("Illegal Argument");return h.geodesicLength(l[0],D.convertLinearUnitsToCode(z.defaultUndefined(l[1],-1)))})};g.distance=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,
2,3);u=l[0];if(z.isArray(l[0])||z.isImmutableArray(l[0]))u=z.autoCastArrayOfPointsToMultiPoint(l[0],t.spatialReference);x=l[1];if(z.isArray(l[1])||z.isImmutableArray(l[1]))x=z.autoCastArrayOfPointsToMultiPoint(l[1],t.spatialReference);if(!(u instanceof q))throw Error("Illegal Argument");if(!(x instanceof q))throw Error("Illegal Argument");return h.distance(u,x,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],-1)))})};g.distancegeodetic=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);
z.pcCheck(l,2,3);u=l[0];x=l[1];if(!(u instanceof f))throw Error("Illegal Argument");if(!(x instanceof f))throw Error("Illegal Argument");var v=new e({paths:[],spatialReference:u.spatialReference});v.addPath([u,x]);return h.geodesicLength(v,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],-1)))})};g.densify=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,3);if(null===l[0])return null;if(!(l[0]instanceof q))throw Error("Illegal Argument");u=z.toNumber(l[1]);
if(isNaN(u))throw Error("Illegal Argument");if(0>=u)throw Error("Illegal Argument");return l[0]instanceof d||l[0]instanceof e?h.densify(l[0],u,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],-1))):l[0]instanceof r?h.densify(c(l[0]),u,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],-1))):l[0]})};g.densifygeodetic=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,3);if(null===l[0])return null;if(!(l[0]instanceof q))throw Error("Illegal Argument");u=z.toNumber(l[1]);
if(isNaN(u))throw Error("Illegal Argument");if(0>=u)throw Error("Illegal Argument");return l[0]instanceof d||l[0]instanceof e?h.geodesicDensify(l[0],u,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],-1))):l[0]instanceof r?h.geodesicDensify(c(l[0]),u,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],-1))):l[0]})};g.generalize=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,4);if(null===l[0])return null;if(!(l[0]instanceof q))throw Error("Illegal Argument");
u=z.toNumber(l[1]);if(isNaN(u))throw Error("Illegal Argument");return h.generalize(l[0],u,z.toBoolean(z.defaultUndefined(l[2],!0)),D.convertLinearUnitsToCode(z.defaultUndefined(l[3],-1)))})};g.buffer=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,3);if(null===l[0])return null;if(!(l[0]instanceof q))throw Error("Illegal Argument");u=z.toNumber(l[1]);if(isNaN(u))throw Error("Illegal Argument");return 0===u?D.cloneGeometry(l[0]):h.buffer(l[0],u,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],
-1)))})};g.buffergeodetic=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,3);if(null===l[0])return null;if(!(l[0]instanceof q))throw Error("Illegal Argument");u=z.toNumber(l[1]);if(isNaN(u))throw Error("Illegal Argument");return 0===u?D.cloneGeometry(l[0]):h.geodesicBuffer(l[0],u,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],-1)))})};g.offset=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,6);if(null===l[0])return null;
if(!(l[0]instanceof d||l[0]instanceof e))throw Error("Illegal Argument");u=z.toNumber(l[1]);if(isNaN(u))throw Error("Illegal Argument");x=z.toNumber(z.defaultUndefined(l[4],10));if(isNaN(x))throw Error("Illegal Argument");var v=z.toNumber(z.defaultUndefined(l[5],0));if(isNaN(v))throw Error("Illegal Argument");return h.offset(l[0],u,D.convertLinearUnitsToCode(z.defaultUndefined(l[2],-1)),z.toString(z.defaultUndefined(l[3],"round")).toLowerCase(),x,v)})};g.rotate=function(t,C){return k(t,C,function(u,
x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,2,3);u=l[0];if(null===u)return null;if(!(u instanceof q))throw Error("Illegal Argument");u instanceof r&&(u=d.fromExtent(u));x=z.toNumber(l[1]);if(isNaN(x))throw Error("Illegal Argument");l=z.defaultUndefined(l[2],null);if(null===l)return h.rotate(u,x);if(l instanceof f)return h.rotate(u,x,l);throw Error("Illegal Argument");})};g.centroid=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,1,1);if(null===l[0])return null;
u=l[0];if(z.isArray(l[0])||z.isImmutableArray(l[0]))u=z.autoCastArrayOfPointsToMultiPoint(l[0],t.spatialReference);if(null===u)return null;if(!(u instanceof q))throw Error("Illegal Argument");return u instanceof f?z.fixSpatialReference(D.cloneGeometry(l[0]),t.spatialReference):u instanceof d?u.getCentroid():u instanceof e?y.centroidPolyline(u):u instanceof n?y.centroidMultiPoint(u):u instanceof r?u.getCenter():null})};g.multiparttosinglepart=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);
z.pcCheck(l,1,1);x=[];if(null===l[0])return null;if(!(l[0]instanceof q))throw Error("Illegal Argument");if(l[0]instanceof f||l[0]instanceof r)return[z.fixSpatialReference(D.cloneGeometry(l[0]),t.spatialReference)];u=h.simplify(l[0]);if(u instanceof d){x=[];var v=[];for(l=0;l<u.rings.length;l++)if(u.isClockwise(u.rings[l])){var A=b.fromJson({rings:[u.rings[l]],hasZ:!0===u.hasZ,hasM:!0===u.hasM,spatialReference:u.spatialReference.toJson()});x.push(A)}else v.push({ring:u.rings[l],pt:u.getPoint(l,0)});
for(u=0;u<v.length;u++)for(l=0;l<x.length;l++)if(x[l].contains(v[u].pt)){x[l].addRing(v[u].ring);break}return x}if(u instanceof e){x=[];for(l=0;l<u.paths.length;l++)v=b.fromJson({paths:[u.paths[l]],hasZ:!0===u.hasZ,hasM:!0===u.hasM,spatialReference:u.spatialReference.toJson()}),x.push(v);return x}if(l[0]instanceof n){u=z.fixSpatialReference(D.cloneGeometry(l[0]),t.spatialReference);for(l=0;l<u.points.length;l++)x.push(u.getPoint(l));return x}return null})};g.issimple=function(t,C){return k(t,C,function(u,
x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,1,1);if(null===l[0])return!0;if(!(l[0]instanceof q))throw Error("Illegal Argument");return h.isSimple(l[0])})};g.simplify=function(t,C){return k(t,C,function(u,x,l){l=z.autoCastFeatureToGeometry(l);z.pcCheck(l,1,1);if(null===l[0])return null;if(!(l[0]instanceof q))throw Error("Illegal Argument");return h.simplify(l[0])})}}})},"esri/arcade/kernel":function(){define(["require","exports","../geometry/Extent","../geometry/jsonUtils"],function(F,m,a,D){Object.defineProperty(m,
"__esModule",{value:!0});m.cloneGeometry=m.sameGeomType=m.convertLinearUnitsToCode=m.shapeExtent=m.convertSquareUnitsToCode=void 0;m.convertSquareUnitsToCode=function(z){if(void 0===z)return null;if("number"===typeof z)return z;z=z.toLowerCase();z=z.replace(/\s/g,"");z=z.replace(/-/g,"");switch(z){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109413;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;
case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nm":case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};m.shapeExtent=function(z){if(null===z)return null;switch(z.type){case "polygon":case "multipoint":case "polyline":return z.extent;
case "point":return new a({xmin:z.x,ymin:z.y,xmax:z.x,ymax:z.y,spatialReference:z.spatialReference});case "extent":return z}return null};m.convertLinearUnitsToCode=function(z){if(void 0===z)return null;if("number"===typeof z)return z;z=z.toLowerCase();z=z.replace(/\s/g,"");z=z.replace(/-/g,"");switch(z){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;case "miles":case "mile":case "squaremile":case "squaremiles":return 9035;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nm":case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};m.sameGeomType=function(z,y){return z===y||"point"===z&&"esriGeometryPoint"===y||"polyline"===z&&"esriGeometryPolyline"===y||"polygon"===z&&"esriGeometryPolygon"===y||"extent"===z&&"esriGeometryEnvelope"===
y||"multipoint"===z&&"esriGeometryMultipoint"===y||"point"===y&&"esriGeometryPoint"===z||"polyline"===y&&"esriGeometryPolyline"===z||"polygon"===y&&"esriGeometryPolygon"===z||"extent"===y&&"esriGeometryEnvelope"===z||"multipoint"===y&&"esriGeometryMultipoint"===z?!0:!1};m.cloneGeometry=function(z){if(null===z)return null;var y=D.fromJson(z.toJson());z.getCacheValue("_geVersion")&&y.setCacheValue("_geVersion",z.getCacheValue("_geVersion"));return y}})},"esri/arcade/functions/maths":function(){define(["require",
"exports","../languageUtils","dojo/number"],function(F,m,a,D){function z(y,r,q){if("undefined"===typeof q||0===+q)return Math[y](r);r=+r;q=+q;if(isNaN(r)||"number"!==typeof q||0!==q%1)return NaN;r=r.toString().split("e");r=Math[y](+(r[0]+"e"+(r[1]?+r[1]-q:-q)));r=r.toString().split("e");return+(r[0]+"e"+(r[1]?+r[1]+q:q))}Object.defineProperty(m,"__esModule",{value:!0});m.registerFunctions=void 0;m.registerFunctions=function(y,r){function q(n,f,d){n=a.toNumber(n);return isNaN(n)?n:isNaN(f)||isNaN(d)||
f>d?NaN:n<f?f:n>d?d:n}y.number=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,2);d=b[0];return a.isNumber(d)?d:null===d?0:a.isDate(d)||a.isBoolean(d)?Number(d):a.isArray(d)?NaN:""===d||void 0===d?Number(d):a.isString(d)?void 0!==b[1]?(b=a.multiReplace(b[1],"\u2030",""),b=a.multiReplace(b,"\u00a4",""),D.parse(d,{pattern:b})):Number(d.trim()):Number(d)})};y.abs=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return Math.abs(a.toNumber(b[0]))})};y.acos=function(n,f){return r(n,
f,function(d,e,b){a.pcCheck(b,1,1);return Math.acos(a.toNumber(b[0]))})};y.asin=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return Math.asin(a.toNumber(b[0]))})};y.atan=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return Math.atan(a.toNumber(b[0]))})};y.atan2=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,2,2);return Math.atan2(a.toNumber(b[0]),a.toNumber(b[1]))})};y.ceil=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,2);return 2===b.length?(d=a.toNumber(b[1]),
isNaN(d)&&(d=0),z("ceil",a.toNumber(b[0]),-1*d)):Math.ceil(a.toNumber(b[0]))})};y.round=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,2);return 2===b.length?(d=a.toNumber(b[1]),isNaN(d)&&(d=0),z("round",a.toNumber(b[0]),-1*d)):Math.round(a.toNumber(b[0]))})};y.floor=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,2);return 2===b.length?(d=a.toNumber(b[1]),isNaN(d)&&(d=0),z("floor",a.toNumber(b[0]),-1*d)):Math.floor(a.toNumber(b[0]))})};y.cos=function(n,f){return r(n,f,function(d,
e,b){a.pcCheck(b,1,1);return Math.cos(a.toNumber(b[0]))})};y.isnan=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return"number"===typeof b[0]&&isNaN(b[0])})};y.exp=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return Math.exp(a.toNumber(b[0]))})};y.log=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return Math.log(a.toNumber(b[0]))})};y.pow=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,2,2);return Math.pow(a.toNumber(b[0]),a.toNumber(b[1]))})};y.random=
function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,0,0);return Math.random()})};y.sin=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return Math.sin(a.toNumber(b[0]))})};y.sqrt=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return Math.sqrt(a.toNumber(b[0]))})};y.tan=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return Math.tan(a.toNumber(b[0]))})};y.defaultvalue=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,2,2);return null===b[0]||""===b[0]||
void 0===b[0]?b[1]:b[0]})};y.isempty=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return null===b[0]||""===b[0]||void 0===b[0]?!0:!1})};y["boolean"]=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,1,1);return a.toBoolean(b[0])})};y.constrain=function(n,f){return r(n,f,function(d,e,b){a.pcCheck(b,3,3);d=a.toNumber(b[1]);e=a.toNumber(b[2]);if(a.isArray(b[0])){var c=[],h=0;for(b=b[0];h<b.length;h++)c.push(q(b[h],d,e));return c}if(a.isImmutableArray(b[0])){c=[];for(h=0;h<b[0].length();h++)c.push(q(b[0].get(h),
d,e));return c}return q(b[0],d,e)})}}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(F,m,a,D){function z(y,r,q,n){if(1===n.length){if(a.isArray(n[0]))return D.calculateStat(y,n[0],-1);if(a.isImmutableArray(n[0]))return D.calculateStat(y,n[0].toArray(),-1)}return D.calculateStat(y,n,-1)}Object.defineProperty(m,"__esModule",{value:!0});m.registerFunctions=void 0;m.registerFunctions=function(y,r){y.stdev=function(q,n){return r(q,n,
function(f,d,e){return z("stdev",f,d,e)})};y.variance=function(q,n){return r(q,n,function(f,d,e){return z("variance",f,d,e)})};y.average=function(q,n){return r(q,n,function(f,d,e){return z("mean",f,d,e)})};y.mean=function(q,n){return r(q,n,function(f,d,e){return z("mean",f,d,e)})};y.sum=function(q,n){return r(q,n,function(f,d,e){return z("sum",f,d,e)})};y.min=function(q,n){return r(q,n,function(f,d,e){return z("min",f,d,e)})};y.max=function(q,n){return r(q,n,function(f,d,e){return z("max",f,d,e)})};
y.distinct=function(q,n){return r(q,n,function(f,d,e){return z("distinct",f,d,e)})};y.count=function(q,n){return r(q,n,function(f,d,e){a.pcCheck(e,1,1);if(a.isArray(e[0])||a.isString(e[0]))return e[0].length;if(a.isImmutableArray(e[0]))return e[0].length();throw Error("Invalid Parameters for Count");})}}})},"esri/arcade/functions/fieldStats":function(){define(["require","exports","../languageUtils"],function(F,m,a){function D(y){for(var r=0,q=0;q<y.length;q++)r+=y[q];return r/y.length}function z(y){for(var r=
D(y),q=0,n=0;n<y.length;n++)q+=Math.pow(r-y[n],2);return q/y.length}Object.defineProperty(m,"__esModule",{value:!0});m.calculateStat=m.decodeStatType=void 0;m.decodeStatType=function(y){switch(y.toLowerCase()){case "distinct":return"distinct";case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";case "count":return"count"}return""};m.calculateStat=function(y,r,q){void 0===
q&&(q=1E3);switch(y.toLowerCase()){case "distinct":a:{y=q;q=[];for(var n={},f=[],d=0;d<r.length;d++){if(void 0!==r[d]&&null!==r[d]&&r[d]!==a.voidOperation){var e=r[d];if(a.isNumber(e)||a.isString(e))void 0===n[e]&&(q.push(e),n[e]=1);else{for(var b=!1,c=0;c<f.length;c++)!0===a.equalityTest(f[c],e)&&(b=!0);!1===b&&(f.push(e),q.push(e))}}if(q.length>=y&&-1!==y){r=q;break a}}r=q}return r;case "avg":case "mean":return D(a.toNumberArray(r));case "min":return Math.min.apply(Math,a.toNumberArray(r));case "sum":r=
a.toNumberArray(r);for(q=y=0;q<r.length;q++)y+=r[q];return y;case "max":return Math.max.apply(Math,a.toNumberArray(r));case "stdev":case "stddev":return Math.sqrt(z(a.toNumberArray(r)));case "var":case "variance":return z(a.toNumberArray(r));case "count":return r.length}return 0}})},"esri/arcade/functions/string":function(){define("require exports ../ArcadePortal ../Attachment ../Dictionary ../Feature ../languageUtils ../featureset/support/shared ./convertdirection ./hash ../../geometry/Extent ../../geometry/Multipoint ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline ../../SpatialReference".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g){function k(w,t,C){if(null===w)t.updateUint8Array([0,139]);else if(r.isArray(w)){t.updateUint8Array([61]);if(C.map.has(w))w=C.map.get(w),t.updateIntArray([w^61237541]);else{C.map.set(w,C.currentLength++);for(var u=0;u<w.length;u++){var x=w[u];k(x,t,C)}C.map["delete"](w);C.currentLength--}t.updateUint8Array([199])}else if(r.isImmutableArray(w)){t.updateUint8Array([61]);if(C.map.has(w))w=C.map.get(w),t.updateIntArray([w^61237541]);else{C.map.set(w,C.currentLength++);
u=0;for(var l=w.toArray();u<l.length;u++)x=l[u],k(x,t,C);C.map["delete"](w);C.currentLength--}t.updateUint8Array([199])}else if(r.isDate(w))t.updateIntArray([w.getTime()]),t.updateUint8Array([241]);else if(r.isString(w))t.updateIntArray([w.length]),t.updateWithString(w),t.updateUint8Array([41]);else if(r.isBoolean(w))t.updateUint8Array([!0===w?1:0,113]);else if(r.isNumber(w))t.updateFloatArray([w]),t.updateUint8Array([173]);else{if(w instanceof D)throw Error("Type not supported in Hash");if(w instanceof
a)throw Error("Type not supported in Hash");if(w instanceof z){t.updateUint8Array([223]);if(C.map.has(w))w=C.map.get(w),t.updateIntArray([w^61237541]);else{C.map.set(w,C.currentLength++);u=0;for(l=w.keys();u<l.length;u++)x=l[u],t.updateIntArray([x.length]),t.updateWithString(x),t.updateUint8Array([251]),x=w.field(x),k(x,t,C),t.updateUint8Array([239]);C.map["delete"](w);C.currentLength--}t.updateUint8Array([73])}else{if(w instanceof y)throw Error("Type not supported in Hash");if(w instanceof b)t.updateIntArray([3833836621]),
t.updateIntArray([0]),t.updateFloatArray([w.x]),t.updateIntArray([1]),t.updateFloatArray([w.y]),t.updateIntArray([3765347959]),k(w.spatialReference.wkid,t,C);else if(w instanceof c){t.updateIntArray([1266616829]);for(u=0;u<w.rings.length;u++){l=w.rings[u];var v=[],A=null,B=null;for(x=0;x<l.length;x++){var E=w.getPoint(u,x);if(0===x)A=E;else if(B.x===E.x&&B.y===E.y)continue;B=E;x===l.length-1&&A.x===E.x&&A.y===E.y||v.push(E)}t.updateIntArray([1397116793,v.length]);for(x=0;x<v.length;x++)E=v[x],t.updateIntArray([3962308117,
x]),k(E,t,C),t.updateIntArray([2716288009]);t.updateIntArray([2278822459])}t.updateIntArray([3878477243]);k(w.spatialReference.wkid,t,C)}else if(w instanceof h){t.updateIntArray([4106883559]);for(u=0;u<w.paths.length;u++){l=w.paths[u];t.updateIntArray([1397116793,l.length]);for(x=0;x<l.length;x++)t.updateIntArray([3962308117,x]),k(w.getPoint(u,x),t,C),t.updateIntArray([2716288009]);t.updateIntArray([2278822459])}t.updateIntArray([2568784753]);k(w.spatialReference.wkid,t,C)}else if(w instanceof e){t.updateIntArray([588535921,
w.points.length]);for(x=0;x<w.points.length;x++)u=w.getPoint(x),t.updateIntArray([x]),k(u,t,C);t.updateIntArray([1700171621]);k(w.spatialReference.wkid,t,C)}else if(w instanceof d)t.updateIntArray([3483648373]),t.updateIntArray([0]),t.updateFloatArray([w.xmax]),t.updateIntArray([1]),t.updateFloatArray([w.xmin]),t.updateIntArray([2]),t.updateFloatArray([w.ymax]),t.updateIntArray([3]),t.updateFloatArray([w.ymin]),t.updateIntArray([3622027469]),k(w.spatialReference.wkid,t,C);else if(w instanceof g)t.updateIntArray([14]),
void 0!==w.wkid&&null!==w.wkid&&t.updateIntArray([w.wkid]),w.wkt&&t.updateWithString(w.wkt);else{if(r.isFunctionParameter(w))throw Error("Type not supported in Hash");if(r.isFeatureSet(w))throw Error("Type not supported in Hash");r.isFeatureSetCollection(w);throw Error("Type not supported in Hash");}}}}Object.defineProperty(m,"__esModule",{value:!0});m.registerFunctions=void 0;m.registerFunctions=function(w,t){w.portal=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);return new a(r.toString(v[0]))})};
w.trim=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);return r.toString(v[0]).trim()})};w.tohex=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);x=r.toNumber(v[0]);return isNaN(x)?x:x.toString(16)})};w.upper=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);return r.toString(v[0]).toUpperCase()})};w.proper=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,2);x=1;2===v.length&&"firstword"===r.toString(v[1]).toLowerCase()&&(x=2);l=/\s/;v=r.toString(v[0]);for(var A=
"",B=!0,E=0;E<v.length;E++){var G=v[E];l.test(G)?1===x&&(B=!0):G.toUpperCase()!==G.toLowerCase()&&(B?(G=G.toUpperCase(),B=!1):G=G.toLowerCase());A+=G}return A})};w.lower=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);return r.toString(v[0]).toLowerCase()})};w.guid=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,0,1);if(0<v.length)switch(r.toString(v[0]).toLowerCase()){case "digits":return r.generateUUID().replace("-","").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return r.generateUUID();
case "digits-hyphen-parentheses":return"("+r.generateUUID()+")"}return"{"+r.generateUUID()+"}"})};w.console=function(C,u){return t(C,u,function(x,l,v){0!==v.length&&(1===v.length?C.console(r.toString(v[0])):C.console(r.toString(v)));return r.voidOperation})};w.mid=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,2,3);x=r.toNumber(v[1]);if(isNaN(x))return"";0>x&&(x=0);if(2===v.length)return r.toString(v[0]).substr(x);l=r.toNumber(v[2]);if(isNaN(l))return"";0>l&&(l=0);return r.toString(v[0]).substr(x,
l)})};w.find=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,2,3);x=0;if(2<v.length){x=r.toNumber(r.defaultUndefined(v[2],0));if(isNaN(x))return-1;0>x&&(x=0)}return r.toString(v[1]).indexOf(r.toString(v[0]),x)})};w.left=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,2,2);x=r.toNumber(v[1]);if(isNaN(x))return"";0>x&&(x=0);return r.toString(v[0]).substr(0,x)})};w.right=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,2,2);x=r.toNumber(v[1]);if(isNaN(x))return"";0>x&&(x=0);return r.toString(v[0]).substr(-1*
x,x)})};w.split=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,2,4);x=r.toNumber(r.defaultUndefined(v[2],-1));l=r.toBoolean(r.defaultUndefined(v[3],!1));-1===x||null===x||!0===l?v=r.toString(v[0]).split(r.toString(v[1])):(isNaN(x)&&(x=-1),-1>x&&(x=-1),v=r.toString(v[0]).split(r.toString(v[1]),x));if(!1===l)return v;l=[];for(var A=0;A<v.length&&!(-1!==x&&l.length>=x);A++)""!==v[A]&&void 0!==v[A]&&l.push(v[A]);return l})};w.text=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,2);return r.toStringExplicit(v[0],
v[1])})};w.concatenate=function(C,u){return t(C,u,function(x,l,v){x=[];if(1>v.length)return"";if(r.isArray(v[0])){l=r.defaultUndefined(v[2],"");for(var A=0;A<v[0].length;A++)x[A]=r.toStringExplicit(v[0][A],l);return 1<v.length?x.join(v[1]):x.join("")}if(r.isImmutableArray(v[0])){l=r.defaultUndefined(v[2],"");for(A=0;A<v[0].length();A++)x[A]=r.toStringExplicit(v[0].get(A),l);return 1<v.length?x.join(v[1]):x.join("")}for(A=0;A<v.length;A++)x[A]=r.toStringExplicit(v[A]);return x.join("")})};w.reverse=
function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);if(r.isArray(v[0]))return x=v[0].slice(0),x.reverse(),x;if(r.isImmutableArray(v[0]))return x=v[0].toArray().slice(0),x.reverse(),x;throw Error("Invalid Parameter");})};w.replace=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,3,4);x=r.toString(v[0]);l=r.toString(v[1]);var A=r.toString(v[2]);return(4===v.length?r.toBoolean(v[3]):1)?r.multiReplace(x,l,A):x.replace(l,A)})};w.schema=function(C,u){return t(C,u,function(x,l,v){if(v[0]instanceof
y)return(x=v[0].schema())?z.convertObjectToArcadeDictionary(x):null;throw Error("Invalid Parameter");})};w.subtypes=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);if(v[0]instanceof y)return(x=v[0].subtypes())?z.convertObjectToArcadeDictionary(x):null;throw Error("Invalid Parameter");})};w.subtypecode=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);if(v[0]instanceof y){l=v[0].subtypes();if(!l)return null;if(l.subtypeField&&v[0].hasField(l.subtypeField))for(v=v[0].field(l.subtypeField),
x=0,l=l.subtypes;x<l.length;x++){var A=l[x];if(A.code===v)return A.code}return null}throw Error("Invalid Parameter");})};w.subtypename=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);if(v[0]instanceof y){l=v[0].subtypes();if(!l)return"";if(l.subtypeField&&v[0].hasField(l.subtypeField))for(v=v[0].field(l.subtypeField),x=0,l=l.subtypes;x<l.length;x++){var A=l[x];if(A.code===v)return A.name}return""}throw Error("Invalid Parameter");})};w.gdbversion=function(C,u){return t(C,u,function(x,l,
v){r.pcCheck(v,1,1);if(v[0]instanceof y)return v[0].gdbVersion();throw Error("Invalid Parameter");})};w.domain=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,2,3);if(v[0]instanceof y)return(x=v[0].fullDomain(r.toString(v[1]),void 0===v[2]?void 0:r.toNumber(v[2])))&&x.domain?"coded-value"===x.domain.type||"codedValue"===x.domain.type?z.convertObjectToArcadeDictionary({type:"codedValue",name:x.domain.name,dataType:q.layerFieldEsriConstants[x.field.type],codedValues:x.domain.codedValues.map(function(A){return{name:A.name,
code:A.code}})}):z.convertObjectToArcadeDictionary({type:"range",name:x.domain.name,dataType:q.layerFieldEsriConstants[x.field.type],min:x.domain.min,max:x.domain.max}):null;throw Error("Invalid Parameter");})};w.domainname=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,2,4);if(v[0]instanceof y)return v[0].domainValueLookup(r.toString(v[1]),v[2],void 0===v[3]?void 0:r.toNumber(v[3]));throw Error("Invalid Parameter");})};w.domaincode=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,2,
4);if(v[0]instanceof y)return v[0].domainCodeLookup(r.toString(v[1]),v[2],void 0===v[3]?void 0:r.toNumber(v[3]));throw Error("Invalid Parameter");})};w.urlencode=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);if(null===v[0])return"";if(v[0]instanceof z){x="";l=0;for(var A=v[0].keys();l<A.length;l++){var B=A[l],E=v[0].field(B);""!==x&&(x+="\x26");x=null===E?x+(encodeURIComponent(B)+"\x3d"):x+(encodeURIComponent(B)+"\x3d"+encodeURIComponent(E))}return x}return encodeURIComponent(r.toString(v[0]))})};
w.hash=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);x=new f.XXH(0);k(v[0],x,{map:new Map,currentLength:0});return x.digest()})};w.convertdirection=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,3,3);return n.convertDirection(v[0],v[1],v[2])})};w.fromjson=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,1);if(!1===r.isString(v[0]))throw Error("Invalid Parameter");return z.convertJsonToArcade(JSON.parse(r.toString(v[0])))})};w.expects=function(C,u){return t(C,u,function(x,
l,v){if(1>v.length)throw Error("Function called with wrong number of Parameters");return r.voidOperation})};w.tocharcode=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,2);x=r.toNumber(r.defaultUndefined(v[1],0));l=r.toString(v[0]);if(0===l.length&&1===v.length)return null;if(l.length<=x||0>x)throw Error("Illegal argument");return l.charCodeAt(x)})};w.tocodepoint=function(C,u){return t(C,u,function(x,l,v){r.pcCheck(v,1,2);x=r.toNumber(r.defaultUndefined(v[1],0));l=r.toString(v[0]);if(0===
l.length&&1===v.length)return null;if(l.length<=x||0>x)throw Error("Illegal argument");return l.codePointAt(x)})};w.fromcharcode=function(C,u){return t(C,u,function(x,l,v){if(1>v.length)throw Error("Function called with wrong number of Parameters");x=v.map(function(A){return Math.trunc(r.toNumber(A))}).filter(function(A){return 0<=A&&65535>=A});return 0===x.length?null:String.fromCharCode.apply(null,x)})};w.fromcodepoint=function(C,u){return t(C,u,function(x,l,v){if(1>v.length)throw Error("Function called with wrong number of Parameters");
try{var A=v.map(function(B){return Math.trunc(r.toNumber(B))}).filter(function(B){return 1114111>=B&&B>>>0===B})}catch(B){return null}return 0===A.length?null:String.fromCodePoint.apply(null,A)})}}})},"esri/arcade/functions/convertdirection":function(){define(["require","exports","../Dictionary","../languageUtils"],function(F,m,a,D){function z(V){if(!1===D.isString(V))throw Error("Invalid Parameter");return V}function y(V,na){var ya=Math.pow(10,na);return Math.round(V*ya)/ya}function r(V){V=+V;return isFinite(V)?
V-V%1||(0>V?-0:0===V?V:0):V}function q(V){var na=parseFloat(V.toString().replace(r(V).toString(),"0"))*((0<V)-(0>V)||+V);return 0>V?{fraction:na,integer:Math.ceil(V)}:{fraction:na,integer:Math.floor(V)}}function n(V,na){switch(V){case 0:return"SHORT"===na?"N":"North";case 1:return"SHORT"===na?"E":"East";case 2:return"SHORT"===na?"S":"South";case 3:return"SHORT"===na?"W":"West"}}function f(V,na,ya){for(;V.length<ya;)V=na+V;return V}function d(V,na){return V-Math.floor(V/na)*na}function e(V){switch(V){case 6:case 1:return 360;
case 4:return G;case 5:return 400;case 2:return 1296E3;case 7:return 60;case 8:return 60;default:throw Error("Unnexpected evaluations");}}function b(V){switch(V.toUpperCase().trim()){case "NORTH":case "NORTHAZIMUTH":case "NORTH AZIMUTH":return 1;case "POLAR":return 2;case "QUADRANT":return 3;case "SOUTH":case "SOUTHAZIMUTH":case "SOUTH AZIMUTH":return 4}throw Error("Unsupported direction type");}function c(V){switch(V.toUpperCase().trim()){case "D":case "DD":case "DECIMALDEGREE":case "DECIMAL DEGREE":case "DEGREE":case "DECIMALDEGREES":case "DECIMAL DEGREES":case "DEGREES":return 1;
case "DMS":case "DEGREESMINUTESSECONDS":case "DEGREES MINUTES SECONDS":return 3;case "R":case "RAD":case "RADS":case "RADIAN":case "RADIANS":return 4;case "G":case "GON":case "GONS":case "GRAD":case "GRADS":case "GRADIAN":case "GRADIANS":return 5}throw Error("Unsupported units");}function h(V,na,ya){var S=null;switch(na){case 1:S=m.preciseMultiply(V,3600);break;case 2:S=V;break;case 5:S=m.preciseMultiply(V,3240);break;case 4:S=m.preciseMultiply(V,I);break;default:throw Error("Unnexpected evaluation");
}switch(ya){case 1:return m.preciseDivide(S,3600);case 2:return S;case 5:return m.preciseDivide(S,3240);case 4:return S/I;default:throw Error("Unnexpected evaluation");}}function g(V){switch(V){case 1:case 6:case 3:return 1;case 5:return 5;case 7:return 7;case 4:return 4;case 2:case 8:return 2}}function k(V){switch(D.toNumber(V)){case 1:return{first:0,second:1};case 2:return{first:2,second:1};case 3:return{first:2,second:3};case 4:return{first:0,second:3}}return null}function w(V){switch(V.toUpperCase().trim()){case "N":case "NORTH":return 0;
case "E":case "EAST":return 1;case "S":case "SOUTH":return 2;case "W":case "WEST":return 3}return null}function t(V){V=parseFloat(V);if(D.isNumber(V)){if(isNaN(V))throw Error("Invalid conversion");return V}throw Error("Invalid conversion");}function C(V,na,ya){var S=3===ya,ma=null,ja=null,X=0,oa=0;oa=0;if(S){if(2>V.length)throw Error("Conversion Error");oa=1;(ja=k(D.toString(V[V.length-1])))?(ma=ja.first,ja=ja.second):(X=1,ma=w(D.toString(V[0])),ja=w(D.toString(V[V.length-1])));if(null===ma||null===
ja)throw Error("Invalid Conversion");}switch(na){case 1:case 4:case 5:if(0===V.length)throw Error("Invalid Conversion");return S?Z.createFromAngleMeridianAndDirection(Y.createFromAngleAndUnits(t(V[X]),g(na)),ma,ja):Z.createFromAngleAndDirection(Y.createFromAngleAndUnits(t(V[X]),g(na)),ya);case 3:oa=V.length-oa-X;if(3===oa)return V=Y.createFromDegreesMinutesSeconds(t(V[X]),t(V[X+1]),t(V[X+2])),S?Z.createFromAngleMeridianAndDirection(V,ma,ja):Z.createFromAngleAndDirection(V,ya);if(1===oa)return V=t(V[X]),
V=J.number_to_dms(V),V=Y.createFromDegreesMinutesSeconds(V.m_degrees,V.m_minutes,V.m_seconds),S?Z.createFromAngleMeridianAndDirection(V,ma,ja):Z.createFromAngleAndDirection(V,ya)}throw Error("Conversion Error");}function u(V){for(var na=[" ","-","/","'",'"',"\\","^","\u00b0",L,"\t","\r","\n","*"],ya="",S=0;S<V.length;S++){var ma=V.charAt(S);ya=-1!==na.indexOf(ma)?ya+"RRSPLITRRSPLITRR":ya+ma}return ya.split("RRSPLITRRSPLITRR").filter(function(ja){return""!==ja})}function x(V,na,ya){for(var S={padding:0,
rounding:0,newpos:na},ma=!1;na<V.length;){var ja=V[na];if(ja===ya)ma?S.rounding++:S.padding++,na++;else if("."===ja)ma=!0,na++;else break}S.newpos=na-1;return S}Object.defineProperty(m,"__esModule",{value:!0});m.convertDirection=m.preciseDivide=m.preciseMultiply=m.preciseMinus=m.preciseAdd=void 0;var l=function(V){return function(na,ya,S){S=S||14;return+V(na,ya).toFixed(S)}},v=function(V,na){return V+na},A=function(V,na){return V-na},B=function(V,na){return V*na},E=function(V,na){return V/na};m.preciseAdd=
function(V,na,ya){return l(v)(V,na,ya)};m.preciseMinus=function(V,na,ya){return l(A)(V,na,ya)};m.preciseMultiply=function(V,na,ya){return l(B)(V,na,ya)};m.preciseDivide=function(V,na,ya){return l(E)(V,na,ya)};var G=2*Math.PI,I=648E3/Math.PI,L=String.fromCharCode(7501),K;(function(V){V[V.north=0]="north";V[V.east=1]="east";V[V.south=2]="south";V[V.west=3]="west"})(K||(K={}));var ba;(function(V){V[V.decimal_degrees=1]="decimal_degrees";V[V.seconds=2]="seconds";V[V.degrees_minutes_seconds=3]="degrees_minutes_seconds";
V[V.radians=4]="radians";V[V.gradians=5]="gradians";V[V.truncated_degrees=6]="truncated_degrees";V[V.fractional_degree_minutes=7]="fractional_degree_minutes";V[V.fractional_minute_seconds=8]="fractional_minute_seconds"})(ba||(ba={}));var T;(function(V){V[V.north_azimuth=1]="north_azimuth";V[V.polar=2]="polar";V[V.quadrant=3]="quadrant";V[V.south_azimuth=4]="south_azimuth"})(T||(T={}));var P;(function(V){V[V.meridian=0]="meridian";V[V.direction=1]="direction"})(P||(P={}));var J=function(){function V(na,
ya,S){this.m_degrees=na;this.m_minutes=ya;this.m_seconds=S}V.prototype.get_field=function(na){switch(na){case 1:case 6:return this.m_degrees;case 7:return this.m_minutes;case 2:case 8:return this.m_seconds;default:throw Error("Unnexpected evaluation");}};V.seconds_to_DMS=function(na){var ya=q(na).fraction;na=q(na).integer;var S=Math.floor(na/3600);na-=3600*S;var ma=Math.floor(na/60);return new V(S,ma,na-60*ma+ya)};V.number_to_dms=function(na){var ya=q(na).fraction;na=q(na).integer;var S=m.preciseMultiply(q(100*
ya).fraction,100);ya=q(100*ya).integer;return new V(na,ya,S)};V.prototype.format=function(na,ya){var S=y(this.m_seconds,ya),ma=this.m_minutes,ja=this.m_degrees;if(2===na||8===na)60<=S&&(S-=60,++ma),60<=ma&&(ma=0,++ja),360<=ja&&(ja=0);else if(7===na)S=0,ma=30<=this.m_seconds?this.m_minutes+1:this.m_minutes,ja=this.m_degrees,60<=ma&&(ma=0,++ja),360<=ja&&(ja=0);else if(1===na||6===na)S=m.preciseDivide(this.m_seconds,3600),ma=m.preciseDivide(this.m_minutes,60),ja=Math.round(this.m_degrees+ma+S),S=ma=
0;return new V(ja,ma,S)};V.DMS_to_seconds=function(na,ya,S){return 3600*na+60*ya+S};return V}(),N=function(){function V(na,ya,S){this.meridian=na;this.angle=ya;this.direction=S}V.prototype.fetch_azimuth=function(na){return 0===na?this.meridian:this.direction};return V}(),Z=function(){function V(na){this.m_angle=na}V.createFromAngleAndDirection=function(na,ya){return new V(new Y(V.convertDirectionFormat(na.extract_angular_units(2),ya,1)))};V.prototype.getAngle=function(na){var ya=this.m_angle.extract_angular_units(2);
switch(na){case 1:case 4:case 2:return na=new Y(V.convertDirectionFormat(ya,1,na));case 3:return na=V.seconds_north_azimuth_to_quadrant(ya),na=new Y(na.angle)}};V.prototype.getMeridian=function(na){var ya=this.m_angle.extract_angular_units(2);switch(na){case 1:return 0;case 4:return 2;case 2:return 1;case 3:return V.seconds_north_azimuth_to_quadrant(ya).meridian}};V.prototype.getDirection=function(na){var ya=this.m_angle.extract_angular_units(2);switch(na){case 1:return 1;case 4:return 3;case 2:return 0;
case 3:return V.seconds_north_azimuth_to_quadrant(ya).direction}};V.seconds_north_azimuth_to_quadrant=function(na){var ya=324E3>=na||972E3<=na?0:2;return new N(ya,0===ya?Math.min(1296E3-na,na):Math.abs(na-648E3),648E3<na?3:1)};V.createFromAngleMeridianAndDirection=function(na,ya,S){return new V(new Y(V.secondsQuadrantToNorthAzimuth(na.extract_angular_units(2),ya,S)))};V.secondsQuadrantToNorthAzimuth=function(na,ya,S){return 0===ya?1===S?na:1296E3-na:1===S?648E3-na:648E3+na};V.convertDirectionFormat=
function(na,ya,S){var ma=0;switch(ya){case 1:ma=na;break;case 2:ma=324E3-na;break;case 3:throw Error("Unnexpected evaluation");case 4:ma=na+648E3}na=0;switch(S){case 1:na=ma;break;case 2:na=324E3-ma;break;case 3:throw Error("Unnexpected evaluation");case 4:na=ma-648E3}na%=1296E3;return 0>na?1296E3+na:na};return V}(),Y=function(){function V(na){this.m_seconds=na}V.createFromAngleAndUnits=function(na,ya){return new V(h(na,ya,2))};V.prototype.extract_angular_units=function(na){return h(this.m_seconds,
2,g(na))};V.createFromDegreesMinutesSeconds=function(na,ya,S){return new V(m.preciseAdd(m.preciseAdd(m.preciseMultiply(na,3600),m.preciseMultiply(ya,60)),S))};return V}(),qa=function(){function V(na,ya,S,ma){this.m_view=na;this.m_angle=ya;this.m_merdian=S;this.m_direction=ma;this.m_formatted_dms=this.m_dms=null}V.createFromStringAndBearing=function(na,ya,S){return new V(na,ya.getAngle(S),ya.getMeridian(S),ya.getDirection(S))};V.prototype.fetch_angle=function(){return this.m_angle};V.prototype.fetch_meridian=
function(){return this.m_merdian};V.prototype.fetch_direction=function(){return this.m_direction};V.prototype.fetch_m_view=function(){return this.m_view};V.prototype.fetch_dms=function(){null===this.m_dms&&this.calculate_dms();return this.m_dms};V.prototype.fetch_formatted_dms=function(){null===this.m_formatted_dms&&this.calculate_dms();return this.m_formatted_dms};V.prototype.calculate_dms=function(){var na=null,ya=6,S=0;for(na=0;na<this.m_view.length;na++){var ma=this.m_view[na];switch(ma){case "m":na=
x(this.m_view,na,ma);ya=6===ya?7:ya;na=na.newpos;continue;case "s":na=x(this.m_view,na,ma),ya=8,S=S<na.rounding?na.rounding:S,na=na.newpos}}this.m_dms=J.seconds_to_DMS(this.m_angle.extract_angular_units(2));this.m_formatted_dms=J.seconds_to_DMS(this.m_angle.extract_angular_units(2)).format(ya,S)};return V}();m.convertDirection=function(V,na,ya){if(!(na instanceof a))throw Error("Invalid Parameter");if(!1===na.hasField("directionType"))throw Error("Invalid Parameter - Missing directionType");if(!1===
na.hasField("angleType"))throw Error("Invalid Parameter - Missing directionType");var S=b(z(na.field("directiontype")));na=c(z(na.field("angletype")));if(D.isNumber(V)){V=D.toNumber(V);if(3===S)throw Error("Conversion error");3===na?(V=J.number_to_dms(V),na=Z.createFromAngleAndDirection(Y.createFromDegreesMinutesSeconds(V.m_degrees,V.m_minutes,V.m_seconds),S)):na=Z.createFromAngleAndDirection(Y.createFromAngleAndUnits(V,g(na)),S)}else if(D.isString(V))na=C(u(V),na,S);else if(D.isArray(V))na=C(V,na,
S);else if(D.isImmutableArray(V))na=C(V.toArray(),na,S);else throw Error("Conversion Error");if(!(ya instanceof a))throw Error("Invalid Parameter");if(!1===ya.hasField("directionType"))throw Error("Invalid Parameter - Missing directionType");if(!1===ya.hasField("outputType"))throw Error("Invalid Parameter - Missing directionType");S=b(z(ya.field("directiontype")));V=ya.hasField("angleType")?c(z(ya.field("angletype"))):null;var ma=z(ya.field("outputType")).toUpperCase().trim();if(!S||!ma)throw Error("Conversion error");
if(!(V||"TEXT"===ma&&ya.hasField("format")))throw Error("Invalid unit");switch(ma){case "VALUE":if(3===S||3===V)return ya=na,na=ya.getAngle(S),3===S&&3===V?(V=J.seconds_to_DMS(na.extract_angular_units(2)),S=[n(ya.getMeridian(S),"SHORT"),V.m_degrees,V.m_minutes,V.m_seconds,n(ya.getDirection(S),"SHORT")]):3===V?(V=J.seconds_to_DMS(na.extract_angular_units(2)),S=[V.m_degrees,V.m_minutes,V.m_seconds]):S=3===S?[n(ya.getMeridian(S),"SHORT"),na.extract_angular_units(V),n(ya.getDirection(S),"SHORT")]:[na.extract_angular_units(V)],
S;ya=na;if((na=g(V))&&3!==V)S=ya.getAngle(S).extract_angular_units(na);else throw Error("Conversion Error");return S;case "TEXT":ma="";ya.hasField("format")&&(ma=D.toString(ya.field("format")));if(null===ma||""===ma){ya="";switch(V){case 1:ya=3===S?"DD.DD\u00b0":"DDD.DD\u00b0";break;case 3:ya=3===S?"dd\u00b0 mm' ss\"":"ddd\u00b0 mm' ss.ss\"";break;case 4:ya="R.RR";break;case 5:ya="GGG.GG"+L;break;default:throw Error("Conversion error");}3===S&&(ya="p "+ya+" b");ma=ya}ya=na;V=ma;var ja="",X=null,oa=
null;na=qa.createFromStringAndBearing(V,ya,S);ma={D:1,d:6,m:7,s:8,R:4,G:5};for(oa=0;oa<V.length;oa++){var xa=V[oa];switch(xa){case "[":X=V;xa={escaped:"",newpos:oa};for(oa++;oa<X.length;){var Ha=X[oa];oa++;if("]"===Ha)break;xa.escaped+=Ha}xa.newpos=oa-1;X=xa;ja+=X.escaped;oa=X.newpos;continue;case "D":case "d":case "m":case "s":case "R":case "G":X=x(V,oa,xa);oa=ya.getAngle(S);a:{xa=ma[xa];Ha=X.padding;var Ia=X.rounding,ia=na,ea=null;switch(xa){case 1:case 4:case 5:ea=d(y(oa.extract_angular_units(xa),
Ia),e(xa));oa=f(ea.toFixed(Ia),"0",Ha+Ia+(0<Ia?1:0));break a;case 6:case 7:ea=d(ia.fetch_formatted_dms().get_field(xa),e(xa));oa=f(ea.toFixed(Ia),"0",Ha+Ia+(0<Ia?1:0));break a;case 8:ea=d(y(ia.fetch_dms().get_field(xa),Ia),e(xa));oa=f(ea.toFixed(Ia),"0",Ha+Ia+(0<Ia?1:0));break a;default:throw Error("Unnexepected evaluation");}}ja+=oa;oa=X.newpos;continue;case "P":case "p":ja+=n(na.fetch_meridian(),"p"===xa?"SHORT":"LONG");continue;case "B":case "b":ja+=n(na.fetch_direction(),"b"===xa?"SHORT":"LONG");
continue;default:ja+=xa}}return ja;default:throw Error("Invalid Parameter");}}})},"esri/arcade/functions/hash":function(){define(["require","exports"],function(F,m){function a(z){for(var y=[],r=0,q=z.length;r<q;r++){var n=z.charCodeAt(r);128>n?y.push(n):2048>n?y.push(192|n>>6,128|n&63):55296>n||57344<=n?y.push(224|n>>12,128|n>>6&63,128|n&63):(r++,n=65536+((n&1023)<<10|z.charCodeAt(r)&1023),y.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return new Uint8Array(y)}Object.defineProperty(m,"__esModule",
{value:!0});m.XXH=void 0;var D=function(){function z(y){this.seed=y;this.totallen=0;this.bufs=[];this.init()}z.prototype.init=function(){this.bufs=[];this.totallen=0;return this};z.prototype.updateFloatArray=function(y){for(var r=[],q=0;q<y.length;q++){var n=y[q];isNaN(n)?r.push("NaN"):Infinity===n?r.push("Infinity"):-Infinity===n?r.push("-Infinity"):0===n?r.push("0"):r.push(n.toString(16))}this.update(a(r.join("")))};z.prototype.updateIntArray=function(y){y=Int32Array.from(y);this.update(new Uint8Array(y.buffer))};
z.prototype.updateUint8Array=function(y){this.update(Uint8Array.from(y))};z.prototype.updateWithString=function(y){return this.update(a(y))};z.prototype.update=function(y){this.bufs.push(y);this.totallen+=y.length;return this};z.prototype.digest=function(){for(var y=new Uint8Array(this.totallen),r=0,q=0,n=this.bufs;q<n.length;q++){var f=n[q];y.set(f,r);r+=f.length}this.init();return this.xxHash32(y,this.seed)};z.prototype.xxHash32=function(y,r){void 0===r&&(r=0);var q=r+374761393&4294967295,n=0;if(16<=
y.length){q=[r+2654435761+2246822519&4294967295,r+2246822519&4294967295,r+0&4294967295,r-2654435761&4294967295];var f=y.length-16,d=0;for(n=0;(n&4294967280)<=f;n+=4){var e=n,b=y[e+0]+(y[e+1]<<8);e=y[e+2]+(y[e+3]<<8);b=q[d]+(2246822519*b+(2246822519*e<<16))&4294967295;b=b<<13|b>>>19;q[d]=2654435761*(b&65535)+(2654435761*(b>>>16)<<16)&4294967295;d=d+1&3}q=(q[0]<<1|q[0]>>>31)+(q[1]<<7|q[1]>>>25)+(q[2]<<12|q[2]>>>20)+(q[3]<<18|q[3]>>>14)&4294967295}q=q+y.length&4294967295;for(d=y.length-4;n<=d;n+=4)e=
n,b=y[e+0]+(y[e+1]<<8),e=y[e+2]+(y[e+3]<<8),q=q+(3266489917*b+(3266489917*e<<16))&4294967295,q=q<<17|q>>>15,q=668265263*(q&65535)+(668265263*(q>>>16)<<16)&4294967295;for(;n<y.length;++n)d=y[n],q+=374761393*d,q=q<<11|q>>>21,q=2654435761*(q&65535)+(2654435761*(q>>>16)<<16)&4294967295;q^=q>>>15;q=(2246822519*(q&65535)&4294967295)+(2246822519*(q>>>16)<<16);q^=q>>>13;q=(3266489917*(q&65535)&4294967295)+(3266489917*(q>>>16)<<16);q^=q>>>16;return 0>q?q+4294967296:q};return z}();m.XXH=D})},"esri/arcade/arcadeRuntime":function(){define("require exports ./ArcadePortal ./Attachment ./Dictionary ./Feature ./FunctionWrapper ./ImmutablePathArray ./ImmutablePointArray ./languageUtils ./treeAnalysis ./functions/array ./functions/date ./functions/geometry ./functions/geomsync ./functions/maths ./functions/stats ./functions/string ../geometry/Extent ../geometry/Geometry ../geometry/Multipoint ../geometry/Point ../geometry/Polygon ../geometry/Polyline ../SpatialReference".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A){function B(ia,ea){for(var za=[],Ca=0;Ca<ea.arguments.length;Ca++)za.push(G(ia,ea.arguments[Ca]));return za}function E(ia,ea,za){try{return!0===ea.preparsed?za(ia,null,ea.arguments):za(ia,ea,B(ia,ea))}catch(Ca){throw Ca;}}function G(ia,ea){try{switch(ea.type){case "EmptyStatement":return f.voidOperation;case "VariableDeclarator":var za=null===ea.init?null:G(ia,ea.init);za===f.voidOperation&&(za=null);if("Identifier"!==ea.id.type)throw Error("Can only assign a regular variable");
var Ca=ea.id.name.toLowerCase();null!==ia.localScope?ia.localScope[Ca]={value:za,valueset:!0,node:ea.init}:ia.globalScope[Ca]={value:za,valueset:!0,node:ea.init};return f.voidOperation;case "VariableDeclaration":for(var Da=0;Da<ea.declarations.length;Da++)G(ia,ea.declarations[Da]);return f.voidOperation;case "BlockStatement":a:{var ka=f.voidOperation;for(Da=0;Da<ea.body.length;Da++)if(ka=G(ia,ea.body[Da]),ka instanceof f.ReturnResult||ka===f.breakResult||ka===f.continueResult){var ta=ka;break a}ta=
ka}return ta;case "FunctionDeclaration":var M=ea.id.name.toLowerCase();ia.globalScope[M]={valueset:!0,node:null,value:new r(ea,ia)};return f.voidOperation;case "ReturnStatement":if(null===ea.argument)var Ga=new f.ReturnResult(f.voidOperation);else{var La=G(ia,ea.argument);Ga=new f.ReturnResult(La)}return Ga;case "IfStatement":if("AssignmentExpression"===ea.test.type||"UpdateExpression"===ea.test.type)throw Error(d.nodeErrorMessage(ea.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var aa=G(ia,
ea.test);if(!0===aa)var Ya=G(ia,ea.consequent);else if(!1===aa)Ya=null!==ea.alternate?G(ia,ea.alternate):f.voidOperation;else throw Error(d.nodeErrorMessage(ea,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));return Ya;case "ExpressionStatement":if("AssignmentExpression"===ea.expression.type||"UpdateExpression"===ea.expression.type)var Wa=G(ia,ea.expression);else{var Ea=G(ia,ea.expression);Wa=Ea===f.voidOperation?f.voidOperation:new f.ImplicitResult(Ea)}return Wa;case "AssignmentExpression":var U=
G(ia,ea.right);Da=null;var fa="";if("MemberExpression"===ea.left.type){Da=G(ia,ea.left.object);!0===ea.left.computed?fa=G(ia,ea.left.property):"Identifier"===ea.left.property.type&&(fa=ea.left.property.name);if(f.isArray(Da))if(f.isNumber(fa)){0>fa&&(fa=Da.length+fa);if(0>fa||fa>Da.length)throw Error("Assignment outside of array bounds");if(fa===Da.length&&"\x3d"!==ea.operator)throw Error("Invalid Parameter");Da[fa]=L(U,ea.operator,Da[fa],ea)}else throw Error("Invalid Parameter");else if(Da instanceof
z){if(!1===f.isString(fa))throw Error("Dictionary accessor must be a string");if(!0===Da.hasField(fa))Da.setField(fa,L(U,ea.operator,Da.field(fa),ea));else{if("\x3d"!==ea.operator)throw Error("Invalid Parameter");Da.setField(fa,L(U,ea.operator,null,ea))}}else if(Da instanceof y){if(!1===f.isString(fa))throw Error("Feature accessor must be a string");if(!0===Da.hasField(fa))Da.setField(fa,L(U,ea.operator,Da.field(fa),ea));else{if("\x3d"!==ea.operator)throw Error("Invalid Parameter");Da.setField(fa,
L(U,ea.operator,null,ea))}}else{if(f.isImmutableArray(Da))throw Error("Array is Immutable");throw Error("Invalid Parameter");}var sa=f.voidOperation}else if(Da=ea.left.name.toLowerCase(),null!==ia.localScope&&void 0!==ia.localScope[Da])ia.localScope[Da]={value:L(U,ea.operator,ia.localScope[Da].value,ea),valueset:!0,node:ea.right},sa=f.voidOperation;else if(void 0!==ia.globalScope[Da])ia.globalScope[Da]={value:L(U,ea.operator,ia.globalScope[Da].value,ea),valueset:!0,node:ea.right},sa=f.voidOperation;
else throw Error("Variable not recognised");return sa;case "UpdateExpression":Da=null;fa="";if("MemberExpression"===ea.argument.type){Da=G(ia,ea.argument.object);!0===ea.argument.computed?fa=G(ia,ea.argument.property):"Identifier"===ea.argument.property.type&&(fa=ea.argument.property.name);if(f.isArray(Da))if(f.isNumber(fa)){0>fa&&(fa=Da.length+fa);if(0>fa||fa>=Da.length)throw Error("Assignment outside of array bounds");var O=f.toNumber(Da[fa]);Da[fa]="++"===ea.operator?O+1:O-1}else throw Error("Invalid Parameter");
else if(Da instanceof z){if(!1===f.isString(fa))throw Error("Dictionary accessor must be a string");if(!0===Da.hasField(fa))O=f.toNumber(Da.field(fa)),Da.setField(fa,"++"===ea.operator?O+1:O-1);else throw Error("Invalid Parameter");}else if(Da instanceof y){if(!1===f.isString(fa))throw Error("Feature accessor must be a string");if(!0===Da.hasField(fa))O=f.toNumber(Da.field(fa)),Da.setField(fa,"++"===ea.operator?O+1:O-1);else throw Error("Invalid Parameter");}else{if(f.isImmutableArray(Da))throw Error("Array is Immutable");
throw Error("Invalid Parameter");}var ca=!1===ea.prefix?O:"++"===ea.operator?O+1:O-1}else{Da="Identifier"===ea.argument.type?ea.argument.name.toLowerCase():"";if(!Da)throw Error("Invalid identifier");if(null!==ia.localScope&&void 0!==ia.localScope[Da])O=f.toNumber(ia.localScope[Da].value),ia.localScope[Da]={value:"++"===ea.operator?O+1:O-1,valueset:!0,node:ea},ca=!1===ea.prefix?O:"++"===ea.operator?O+1:O-1;else if(void 0!==ia.globalScope[Da])O=f.toNumber(ia.globalScope[Da].value),ia.globalScope[Da]=
{value:"++"===ea.operator?O+1:O-1,valueset:!0,node:ea},ca=!1===ea.prefix?O:"++"===ea.operator?O+1:O-1;else throw Error("Variable not recognised");}return ca;case "BreakStatement":return f.breakResult;case "ContinueStatement":return f.continueResult;case "TemplateElement":return ea.value?ea.value.cooked:"";case "TemplateLiteral":var va="",H=0;sa=0;for(Da=ea.quasis;sa<Da.length;sa++)if(fa=Da[sa],va+=fa.value?fa.value.cooked:"",!1===fa.tail){var R=ea.expressions[H]?f.toString(G(ia,ea.expressions[H])):
"";va+=R;H++}return va;case "ForStatement":null!==ea.init&&G(ia,ea.init);H={testResult:!0,lastAction:f.voidOperation};do b:{Da=ia;fa=ea;R=H;if(null!==fa.test){R.testResult=G(Da,fa.test);if(!1===R.testResult)break b;if(!0!==R.testResult)throw Error(d.nodeErrorMessage(fa,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}R.lastAction=G(Da,fa.body);R.lastAction===f.breakResult?R.testResult=!1:R.lastAction instanceof f.ReturnResult?R.testResult=!1:null!==fa.update&&G(Da,fa.update)}while(!0===H.testResult);
va=H.lastAction instanceof f.ReturnResult?H.lastAction:f.voidOperation;return va;case "ForInStatement":return I(ia,ea);case "Identifier":return N(ia,ea);case "MemberExpression":return ba(ia,ea);case "Literal":return ea.value;case "CallExpression":return Z(ia,ea);case "UnaryExpression":return T(ia,ea);case "BinaryExpression":return P(ia,ea);case "LogicalExpression":return J(ia,ea);case "ArrayExpression":try{for(Da=[],fa=0;fa<ea.elements.length;fa++){var W=G(ia,ea.elements[fa]);if(f.isFunctionParameter(W))throw Error(d.nodeErrorMessage(ea,
"RUNTIME","FUNCTIONCONTEXTILLEGAL"));W===f.voidOperation?Da.push(null):Da.push(W)}}catch(Aa){throw Aa;}return Da;case "ObjectExpression":Da={};for(fa=0;fa<ea.properties.length;fa++){var pa=G(ia,ea.properties[fa]);if(f.isFunctionParameter(pa.value))throw Error("Illegal Argument");if(!1===f.isString(pa.key))throw Error("Illegal Argument");Da[pa.key.toString()]=pa.value===f.voidOperation?null:pa.value}var ra=new z(Da);ra.immutable=!1;return ra;case "Property":return{key:"Identifier"===ea.key.type?ea.key.name:
G(ia,ea.key),value:G(ia,ea.value)};default:throw Error(d.nodeErrorMessage(ea,"RUNTIME","UNREOGNISED"));}}catch(Aa){throw Aa;}}function I(ia,ea){var za=G(ia,ea.right);"VariableDeclaration"===ea.left.type&&G(ia,ea.left);var Ca=null,Da="";if("VariableDeclaration"===ea.left.type){var ka=ea.left.declarations[0].id;"Identifier"===ka.type&&(Da=ka.name)}else"Identifier"===ea.left.type&&(Da=ea.left.name);if(!Da)throw Error(d.nodeErrorMessage(ea,"RUNTIME","INVALIDVARIABLE"));Da=Da.toLowerCase();null!==ia.localScope&&
void 0!==ia.localScope[Da]&&(Ca=ia.localScope[Da]);null===Ca&&void 0!==ia.globalScope[Da]&&(Ca=ia.globalScope[Da]);if(null===Ca)throw Error(d.nodeErrorMessage(ea,"RUNTIME","VARIABLENOTDECLARED"));if(f.isArray(za)||f.isString(za)){za=za.length;for(ka=0;ka<za;ka++){Ca.value=ka;Da=G(ia,ea.body);if(Da===f.breakResult)break;if(Da instanceof f.ReturnResult)return Da}return f.voidOperation}if(f.isImmutableArray(za)){for(ka=0;ka<za.length();ka++){Ca.value=ka;Da=G(ia,ea.body);if(Da===f.breakResult)break;if(Da instanceof
f.ReturnResult)return Da}return f.voidOperation}if(za instanceof z||za instanceof y)for(za=za.keys(),ka=0;ka<za.length;ka++){Ca.value=za[ka];Da=G(ia,ea.body);if(Da===f.breakResult)break;if(Da instanceof f.ReturnResult)return Da}else return f.voidOperation}function L(ia,ea,za,Ca){switch(ea){case "\x3d":return ia===f.voidOperation?null:ia;case "/\x3d":return f.toNumber(za)/f.toNumber(ia);case "*\x3d":return f.toNumber(za)*f.toNumber(ia);case "-\x3d":return f.toNumber(za)-f.toNumber(ia);case "+\x3d":return f.isString(za)||
f.isString(ia)?f.toString(za)+f.toString(ia):f.toNumber(za)+f.toNumber(ia);case "%\x3d":return f.toNumber(za)%f.toNumber(ia);default:throw Error(d.nodeErrorMessage(Ca,"RUNTIME","OPERATORNOTRECOGNISED"));}}function K(ia,ea,za){ea=ea.toLowerCase();switch(ea){case "hasz":return ia=ia.hasZ,void 0===ia?!1:ia;case "hasm":return ia=ia.hasM,void 0===ia?!1:ia;case "spatialreference":return ea=ia.spatialReference._arcadeCacheId,void 0===ea&&(za=!0,Object.freeze&&Object.isFrozen(ia.spatialReference)&&(za=!1),
za&&(oa++,ea=ia.spatialReference._arcadeCacheId=oa)),ia=new z({wkt:ia.spatialReference.wkt,wkid:ia.spatialReference.wkid}),void 0!==ea&&(ia._arcadeCacheId="SPREF"+ea.toString()),ia}switch(ia.type){case "extent":switch(ea){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return ia=ia[ea],void 0!==ia?ia:null;case "type":return"Extent"}break;case "polygon":switch(ea){case "rings":return ea=ia.getCacheValue("_arcadeCacheId"),void 0===ea&&(oa++,ea=oa,ia.setCacheValue("_arcadeCacheId",
ea)),ia=new q(ia.rings,ia.spatialReference,!0===ia.hasZ,!0===ia.hasM,ea);case "type":return"Polygon"}break;case "point":switch(ea){case "x":case "y":case "z":case "m":return void 0!==ia[ea]?ia[ea]:null;case "type":return"Point"}break;case "polyline":switch(ea){case "paths":return ea=ia.getCacheValue("_arcadeCacheId"),void 0===ea&&(oa++,ea=oa,ia.setCacheValue("_arcadeCacheId",ea)),ia=new q(ia.paths,ia.spatialReference,!0===ia.hasZ,!0===ia.hasM,ea);case "type":return"Polyline"}break;case "multipoint":switch(ea){case "points":return ea=
ia.getCacheValue("_arcadeCacheId"),void 0===ea&&(oa++,ea=oa,ia.setCacheValue("_arcadeCacheId",ea)),ia=new n(ia.points,ia.spatialReference,!0===ia.hasZ,!0===ia.hasM,ea,1);case "type":return"Multipoint"}}throw Error(d.nodeErrorMessage(za,"RUNTIME","PROPERTYNOTFOUND"));}function ba(ia,ea){try{var za=G(ia,ea.object);if(null===za)throw Error(d.nodeErrorMessage(ea,"RUNTIME","NOTFOUND"));if(!1===ea.computed){if("Identifier"===ea.property.type){if(za instanceof z||za instanceof y)return za.field(ea.property.name);
if(za instanceof C)return K(za,ea.property.name,ea)}throw Error(d.nodeErrorMessage(ea,"RUNTIME","INVALIDTYPE"));}var Ca=G(ia,ea.property);if(za instanceof z||za instanceof y){if(f.isString(Ca))return za.field(Ca);throw Error(d.nodeErrorMessage(ea,"RUNTIME","INVALIDTYPE"));}if(za instanceof C){if(f.isString(Ca))return K(za,Ca,ea);throw Error(d.nodeErrorMessage(ea,"RUNTIME","INVALIDTYPE"));}if(f.isArray(za)){if(f.isNumber(Ca)&&isFinite(Ca)&&Math.floor(Ca)===Ca){0>Ca&&(Ca=za.length+Ca);if(Ca>=za.length||
0>Ca)throw Error(d.nodeErrorMessage(ea,"RUNTIME","OUTOFBOUNDS"));return za[Ca]}throw Error(d.nodeErrorMessage(ea,"RUNTIME","INVALIDTYPE"));}if(f.isString(za)){if(f.isNumber(Ca)&&isFinite(Ca)&&Math.floor(Ca)===Ca){0>Ca&&(Ca=za.length+Ca);if(Ca>=za.length||0>Ca)throw Error(d.nodeErrorMessage(ea,"RUNTIME","OUTOFBOUNDS"));return za[Ca]}throw Error(d.nodeErrorMessage(ea,"RUNTIME","INVALIDTYPE"));}if(f.isImmutableArray(za)&&f.isNumber(Ca)&&isFinite(Ca)&&Math.floor(Ca)===Ca){0>Ca&&(Ca=za.length()+Ca);if(Ca>=
za.length()||0>Ca)throw Error(d.nodeErrorMessage(ea,"RUNTIME","OUTOFBOUNDS"));return za.get(Ca)}throw Error(d.nodeErrorMessage(ea,"RUNTIME","INVALIDTYPE"));}catch(Da){throw Da;}}function T(ia,ea){try{var za=G(ia,ea.argument);if(f.isBoolean(za)){if("!"===ea.operator)return!za;if("-"===ea.operator)return-1*f.toNumber(za);if("+"===ea.operator)return 1*f.toNumber(za);if("~"===ea.operator)return~f.toNumber(za);throw Error(d.nodeErrorMessage(ea,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("~"===ea.operator)return~f.toNumber(za);
if("-"===ea.operator)return-1*f.toNumber(za);if("+"===ea.operator)return 1*f.toNumber(za);throw Error(d.nodeErrorMessage(ea,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(Ca){throw Ca;}}function P(ia,ea){try{var za=[G(ia,ea.left),G(ia,ea.right)],Ca=za[0],Da=za[1];switch(ea.operator){case "|":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":case "^":case "\x26":return f.binaryOperator(f.toNumber(Ca),f.toNumber(Da),ea.operator);case "\x3d\x3d":return f.equalityTest(Ca,Da);case "!\x3d":return!f.equalityTest(Ca,
Da);case "\x3c":return f.greaterThanLessThan(Ca,Da,ea.operator);case "\x3e":return f.greaterThanLessThan(Ca,Da,ea.operator);case "\x3c\x3d":return f.greaterThanLessThan(Ca,Da,ea.operator);case "\x3e\x3d":return f.greaterThanLessThan(Ca,Da,ea.operator);case "+":return f.isString(Ca)||f.isString(Da)?f.toString(Ca)+f.toString(Da):f.toNumber(Ca)+f.toNumber(Da);case "-":return f.toNumber(Ca)-f.toNumber(Da);case "*":return f.toNumber(Ca)*f.toNumber(Da);case "/":return f.toNumber(Ca)/f.toNumber(Da);case "%":return f.toNumber(Ca)%
f.toNumber(Da);default:throw Error(d.nodeErrorMessage(ea,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(ka){throw ka;}}function J(ia,ea){try{if("AssignmentExpression"===ea.left.type||"UpdateExpression"===ea.left.type)throw Error(d.nodeErrorMessage(ea.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===ea.right.type||"UpdateExpression"===ea.right.type)throw Error(d.nodeErrorMessage(ea.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var za=G(ia,ea.left);if(f.isBoolean(za))switch(ea.operator){case "||":if(!0===
za)return za;var Ca=G(ia,ea.right);if(f.isBoolean(Ca))return Ca;throw Error(d.nodeErrorMessage(ea,"RUNTIME","ONLYORORAND"));case "\x26\x26":if(!1===za)return za;Ca=G(ia,ea.right);if(f.isBoolean(Ca))return Ca;throw Error(d.nodeErrorMessage(ea,"RUNTIME","ONLYORORAND"));default:throw Error(d.nodeErrorMessage(ea,"RUNTIME","ONLYORORAND"));}throw Error(d.nodeErrorMessage(ea,"RUNTIME","ONLYBOOLEAN"));}catch(Da){throw Da;}}function N(ia,ea){try{var za=ea.name.toLowerCase();if(null!==ia.localScope&&void 0!==
ia.localScope[za]){var Ca=ia.localScope[za];if(!0===Ca.valueset)return Ca.value;Ca.value=G(ia,Ca.node);Ca.valueset=!0;return Ca.value}if(void 0!==ia.globalScope[za]){Ca=ia.globalScope[za];if(!0===Ca.valueset)return Ca.value;Ca.value=G(ia,Ca.node);Ca.valueset=!0;return Ca.value}throw Error(d.nodeErrorMessage(ea,"RUNTIME","VARIABLENOTFOUND"));}catch(Da){throw Da;}}function Z(ia,ea){try{if("Identifier"!==ea.callee.type)throw Error(d.nodeErrorMessage(ea,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==ia.localScope&&
void 0!==ia.localScope[ea.callee.name.toLowerCase()]){var za=ia.localScope[ea.callee.name.toLowerCase()];if(za.value instanceof f.NativeFunction)return za.value.fn(ia,ea);if(za.value instanceof r)return S(ia,ea,za.value.definition);throw Error(d.nodeErrorMessage(ea,"RUNTIME","NOTAFUNCTION"));}if(void 0!==ia.globalScope[ea.callee.name.toLowerCase()]){za=ia.globalScope[ea.callee.name.toLowerCase()];if(za.value instanceof f.NativeFunction)return za.value.fn(ia,ea);if(za.value instanceof r)return S(ia,
ea,za.value.definition);throw Error(d.nodeErrorMessage(ea,"RUNTIME","NOTAFUNCTION"));}throw Error(d.nodeErrorMessage(ea,"RUNTIME","NOTFOUND"));}catch(Ca){throw Ca;}}function Y(ia){return null==ia?"":f.isArray(ia)||f.isImmutableArray(ia)?"Array":f.isDate(ia)?"Date":f.isString(ia)?"String":f.isBoolean(ia)?"Boolean":f.isNumber(ia)?"Number":ia instanceof D?"Attachment":ia instanceof a?"Portal":ia instanceof z?"Dictionary":ia instanceof y?"Feature":ia instanceof x?"Point":ia instanceof l?"Polygon":ia instanceof
v?"Polyline":ia instanceof u?"Multipoint":ia instanceof t?"Extent":f.isFunctionParameter(ia)?"Function":f.isFeatureSet(ia)?"FeatureSet":f.isFeatureSetCollection(ia)?"FeatureSetCollection":ia===f.voidOperation?"":"number"===typeof ia&&isNaN(ia)?"Number":"Unrecognised Type"}function qa(ia,ea,za,Ca){try{var Da=G(ia,ea.arguments[za]);if(f.equalityTest(Da,Ca))return G(ia,ea.arguments[za+1]);var ka=ea.arguments.length-za;return 1===ka?G(ia,ea.arguments[za]):2===ka?null:3===ka?G(ia,ea.arguments[za+2]):qa(ia,
ea,za+2,Ca)}catch(ta){throw ta;}}function V(ia,ea,za,Ca){try{if(!0===Ca)return G(ia,ea.arguments[za+1]);if(3===ea.arguments.length-za)return G(ia,ea.arguments[za+2]);var Da=G(ia,ea.arguments[za+2]);if(!1===f.isBoolean(Da))throw Error("WHEN needs boolean test conditions");return V(ia,ea,za+2,Da)}catch(ka){throw ka;}}function na(ia,ea){var za=ia.length,Ca=Math.floor(za/2);if(0===za)return[];if(1===za)return[ia[0]];var Da=na(ia.slice(0,Ca),ea);za=na(ia.slice(Ca,za),ea);for(Ca=[];0<Da.length||0<za.length;)if(0<
Da.length&&0<za.length){var ka=ea(Da[0],za[0]);isNaN(ka)&&(ka=0);0>=ka?(Ca.push(Da[0]),Da=Da.slice(1)):(Ca.push(za[0]),za=za.slice(1))}else 0<Da.length?(Ca.push(Da[0]),Da=Da.slice(1)):0<za.length&&(Ca.push(za[0]),za=za.slice(1));return Ca}function ya(ia,ea,za){try{var Ca=ia.body;if(za.length!==ia.params.length)throw Error("Invalid Parameter calls to function.");for(var Da=0;Da<za.length;Da++)ea.localScope[ia.params[Da].name.toLowerCase()]={value:za[Da],valueset:!0,node:null};var ka=G(ea,Ca);if(ka instanceof
f.ReturnResult)return ka.value;if(ka===f.breakResult)throw Error("Cannot Break from a Function");if(ka===f.continueResult)throw Error("Cannot Continue from a Function");return ka instanceof f.ImplicitResult?ka.value:ka}catch(ta){throw ta;}}function S(ia,ea,za){return E(ia,ea,function(Ca,Da,ka){Ca={spatialReference:ia.spatialReference,globalScope:ia.globalScope,depthCounter:ia.depthCounter+1,console:ia.console,lrucache:ia.lrucache,interceptor:ia.interceptor,localScope:{}};if(64<Ca.depthCounter)throw Error("Exceeded maximum function depth");
return ya(za,Ca,ka)})}function ma(ia){return function(){var ea={spatialReference:ia.context.spatialReference,console:ia.context.console,lrucache:ia.context.lrucache,interceptor:ia.context.interceptor,localScope:{},depthCounter:ia.context.depthCounter+1,globalScope:ia.context.globalScope};if(64<ea.depthCounter)throw Error("Exceeded maximum function depth");return ya(ia.definition,ea,arguments)}}function ja(ia){}function X(ia){for(var ea={mode:"sync",compiled:!1,functions:{},signatures:[],standardFunction:E,
evaluateIdentifier:N,arcadeCustomFunctionHandler:ma},za=0;za<ia.length;za++)ia[za].registerFunctions(ea);for(var Ca in ea.functions)xa[Ca]={value:new f.NativeFunction(ea.functions[Ca]),valueset:!0,node:null},Ia.prototype[Ca]=xa[Ca];for(za=0;za<ea.signatures.length;za++)d.addFunctionDeclaration(ea.signatures[za],"async")}Object.defineProperty(m,"__esModule",{value:!0});m.findFunctionCalls=m.referencesFunction=m.referencesMember=m.validateScript=m.extractExpectedFieldLiterals=m.extractFieldLiterals=
m.executeScript=m.extend=m.functionHelper=void 0;var oa=0,xa={};b.registerFunctions(xa,E);w.registerFunctions(xa,E);g.registerFunctions(xa,E);c.registerFunctions(xa,E);k.registerFunctions(xa,E);h.registerFunctions(xa,E);xa["typeof"]=function(ia,ea){return E(ia,ea,function(za,Ca,Da){f.pcCheck(Da,1,1);za=Y(Da[0]);if("Unrecognised Type"===za)throw Error("Unrecognised Type");return za})};xa.iif=function(ia,ea){try{f.pcCheck(null===ea.arguments?[]:ea.arguments,3,3);var za=G(ia,ea.arguments[0]);if(!1===
f.isBoolean(za))throw Error("IF Function must have a boolean test condition");var Ca=G(ia,ea.arguments[1]),Da=G(ia,ea.arguments[2]);return!0===za?Ca:Da}catch(ka){throw ka;}};xa.decode=function(ia,ea){try{if(2>ea.arguments.length)throw Error("Missing Parameters");if(2===ea.arguments.length)return G(ia,ea.arguments[1]);if(0===(ea.arguments.length-1)%2)throw Error("Must have a default value result.");var za=G(ia,ea.arguments[0]);return qa(ia,ea,1,za)}catch(Ca){throw Ca;}};xa.when=function(ia,ea){try{if(3>
ea.arguments.length)throw Error("Missing Parameters");if(0===ea.arguments.length%2)throw Error("Must have a default value result.");var za=G(ia,ea.arguments[0]);if(!1===f.isBoolean(za))throw Error("WHEN needs boolean test conditions");return V(ia,ea,0,za)}catch(Ca){throw Ca;}};xa.top=function(ia,ea){return E(ia,ea,function(za,Ca,Da){f.pcCheck(Da,2,2);if(f.isArray(Da[0]))return f.toNumber(Da[1])>=Da[0].length?Da[0].slice(0):Da[0].slice(0,f.toNumber(Da[1]));if(f.isImmutableArray(Da[0]))return f.toNumber(Da[1])>=
Da[0].length()?Da[0].slice(0):Da[0].slice(0,f.toNumber(Da[1]));throw Error("Top cannot accept this parameter type");})};xa.first=function(ia,ea){return E(ia,ea,function(za,Ca,Da){f.pcCheck(Da,1,1);return f.isArray(Da[0])?0===Da[0].length?null:Da[0][0]:f.isImmutableArray(Da[0])?0===Da[0].length()?null:Da[0].get(0):null})};xa.sort=function(ia,ea){return E(ia,ea,function(za,Ca,Da){f.pcCheck(Da,1,2);za=Da[0];f.isImmutableArray(za)&&(za=za.toArray());if(!1===f.isArray(za))throw Error("Illegal Argument");
if(1<Da.length){if(!1===f.isFunctionParameter(Da[1]))throw Error("Illegal Argument");var ka=ma(Da[1]);return za=na(za,function(Ga,La){return ka(Ga,La)})}if(0===za.length)return[];Da={};for(Ca=0;Ca<za.length;Ca++){var ta=Y(za[Ca]);""!==ta&&(Da[ta]=!0)}if(!0===Da.Array||!0===Da.Dictionary||!0===Da.Feature||!0===Da.Point||!0===Da.Polygon||!0===Da.Polyline||!0===Da.Multipoint||!0===Da.Extent||!0===Da.Function)return za.slice(0);Ca=0;ta="";for(var M in Da)Ca++,ta=M;return za=1<Ca||"String"===ta?na(za,
function(Ga,La){if(null===Ga||void 0===Ga||Ga===f.voidOperation)return null===La||void 0===La||La===f.voidOperation?0:1;if(null===La||void 0===La||La===f.voidOperation)return-1;var aa=f.toString(Ga),Ya=f.toString(La);return aa<Ya?-1:aa===Ya?0:1}):"Number"===ta?na(za,function(Ga,La){return Ga-La}):"Boolean"===ta?na(za,function(Ga,La){return Ga===La?0:La?-1:1}):"Date"===ta?na(za,function(Ga,La){return La-Ga}):za.slice(0)})};for(var Ha in xa)xa[Ha]={value:new f.NativeFunction(xa[Ha]),valueset:!0,node:null};
var Ia=function(){};Ia.prototype=xa;Ia.prototype.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};Ia.prototype.pi={value:Math.PI,valueset:!0,node:null};m.functionHelper={fixSpatialReference:f.fixSpatialReference,parseArguments:B,standardFunction:E};m.extend=X;X([e]);m.executeScript=function(ia,ea){var za=ea.spatialReference;if(null===za||void 0===za)za=new A({wkid:102100});var Ca=ea.vars,Da=ea.customfunctions,ka=new Ia;Ca||(Ca={});Da||(Da={});var ta=new z({newline:"\n",tab:"\t",singlequote:"'",
doublequote:'"',forwardslash:"/",backwardslash:"\\"});ta.immutable=!1;ka.textformatting={value:ta,valueset:!0,node:null};for(var M in Da)ka[M]={value:new f.NativeFunction(Da[M]),"native":!0,valueset:!0,node:null};for(M in Ca)ka[M]=Ca[M]&&"esri.Graphic"===Ca[M].declaredClass?{value:y.createFromGraphic(Ca[M]),valueset:!0,node:null}:{value:Ca[M],valueset:!0,node:null};za=G({spatialReference:za,globalScope:ka,localScope:null,console:ea.console?ea.console:ja,lrucache:ea.lrucache,interceptor:ea.interceptor,
depthCounter:1},ia.body[0].body);za instanceof f.ReturnResult&&(za=za.value);za instanceof f.ImplicitResult&&(za=za.value);za===f.voidOperation&&(za=null);if(za===f.breakResult)throw Error("Cannot return BREAK");if(za===f.continueResult)throw Error("Cannot return CONTINUE");if(za instanceof r)throw Error("Cannot return FUNCTION");if(za instanceof f.NativeFunction)throw Error("Cannot return FUNCTION");return za};m.extractFieldLiterals=function(ia,ea){void 0===ea&&(ea=!1);return d.findFieldLiterals(ia)};
m.extractExpectedFieldLiterals=function(ia){return d.findExpectedFieldLiterals(ia)};m.validateScript=function(ia,ea){return d.validateScript(ia,ea,"simple")};m.referencesMember=function(ia,ea){return d.referencesMember(ia,ea)};m.referencesFunction=function(ia,ea){return d.referencesFunction(ia,ea)};m.findFunctionCalls=function(ia){return d.findFunctionCalls(ia)}})},"esri/arcade/parser":function(){define(["require","exports","./treeAnalysis","./lib/arcade-parser"],function(F,m,a,D){Object.defineProperty(m,
"__esModule",{value:!0});m.referencesFunction=m.referencesMember=m.extractExpectedFieldLiterals=m.validateScript=m.extractFieldLiterals=m.scriptCheck=m.parseScript=void 0;m.parseScript=function(z,y){void 0===y&&(y=[]);var r=D.parse("function _() { "+z+"\n}");if(null===r.body||void 0===r.body)throw Error("No formula provided.");if(0===r.body.length)throw Error("No formula provided.");if(0===r.body.length)throw Error("No formula provided.");if("BlockStatement"!==r.body[0].body.type)throw Error("Invalid formula content.");
var q=a.validateLanguage(r);if(""!==q)throw Error(q);a.findScriptDependencies(r,y);return r};m.scriptCheck=function(z,y,r,q,n){var f=[];z="function _() { \n"+z+"\n}";try{var d=D.parse(z,{tolerant:!0,loc:!0,range:!0}),e=d.errors;if(0<e.length)for(var b=0;b<e.length;b++)f.push({line:e[b].lineNumber-2,character:e[b].column,reason:e[b].description});var c=a.checkScript(d,y,r,q,n);for(y=0;y<c.length;y++)c[y].line-=2,c[y].range&&(c[y].range=[c[y][0]-15,c[y][1]-15]),c[y].loc&&(c[y].loc.start.line-=2,c[y].loc.end.line-=
2),f.push(c[y])}catch(g){try{if("Unexpected token }"===g.description){var h=z.split("\n").length;g.lineNumber===h?(g.index=z.length-1,f.push({line:g.lineNumber-4,character:g.column,reason:"Unexpected end of script"})):(g.index=z.length-1,f.push({line:g.lineNumber-2,character:g.column,reason:"Unexpected end of script"}))}else f.push({line:g.lineNumber-2,character:g.column,reason:g.description})}catch(k){}}return f};m.extractFieldLiterals=function(z,y){void 0===y&&(y=!1);return a.findFieldLiterals(z)};
m.validateScript=function(z,y,r){return a.validateScript(z,y,r)};m.extractExpectedFieldLiterals=function(z){return a.findExpectedFieldLiterals(z)};m.referencesMember=function(z,y){return a.referencesMember(z,y)};m.referencesFunction=function(z,y){return a.referencesFunction(z,y)}})},"esri/arcade/lib/arcade-parser":function(){var F=this&&this.__createBinding||(Object.create?function(a,D,z,y){void 0===y&&(y=z);Object.defineProperty(a,y,{enumerable:!0,get:function(){return D[z]}})}:function(a,D,z,y){void 0===
y&&(y=z);a[y]=D[z]}),m=this&&this.__exportStar||function(a,D){for(var z in a)"default"===z||Object.prototype.hasOwnProperty.call(D,z)||F(D,a,z)};define("require exports ./comment-handler ./parser ./tokenizer ./syntax ./token ./nodes".split(" "),function(a,D,z,y,r,q,n,f){Object.defineProperty(D,"__esModule",{value:!0});D.version=D.Syntax=D.tokenize=D.parse=void 0;D.parse=function(d,e,b){var c=null,h=function(t,C){b&&b(t,C);c&&c.visit(t,C)},g="function"===typeof b?h:void 0,k=!1;if(e){k="boolean"===
typeof e.comment&&e.comment;var w="boolean"===typeof e.attachComment&&e.attachComment;if(k||w)c=new z.CommentHandler,c.attach=w,e.comment=!0,g=h}d=new y.Parser(d,e,g);e=d.parseScript();k&&c&&(e.comments=c.comments);d.config.tokens&&(e.tokens=d.tokens);d.config.tolerant&&(e.errors=d.errorHandler.errors);return e};D.tokenize=function(d,e,b){d=new r.Tokenizer(d,e);e=[];var c=void 0;try{for(;;){var h=d.getNextToken();if(!h)break;b&&(h=b(h));e.push(h)}}catch(g){d.errorHandler.tolerate(g)}d.errorHandler.tolerant&&
(c=d.errors());return{tokens:e,errors:c}};Object.defineProperty(D,"Syntax",{enumerable:!0,get:function(){return q.Syntax}});m(n,D);m(f,D);D.version="4.0.0-dev"})},"esri/arcade/lib/comment-handler":function(){define(["require","exports","./syntax"],function(F,m,a){Object.defineProperty(m,"__esModule",{value:!0});m.CommentHandler=void 0;F=function(){function D(){this.attach=!1;this.comments=[];this.stack=[];this.leading=[];this.trailing=[]}D.prototype.insertInnerComments=function(z,y){if(z.type===a.Syntax.BlockStatement&&
0===z.body.length){for(var r=[],q=this.leading.length-1;0<=q;--q){var n=this.leading[q];y.end.offset>=n.start&&(r.unshift(n.comment),this.leading.splice(q,1),this.trailing.splice(q,1))}r.length&&(z.innerComments=r)}};D.prototype.findTrailingComments=function(z){var y=[];if(0<this.trailing.length){for(var r=this.trailing.length-1;0<=r;--r){var q=this.trailing[r];q.start>=z.end.offset&&y.unshift(q.comment)}this.trailing.length=0;return y}(r=this.stack[this.stack.length-1])&&r.node.trailingComments&&
(q=r.node.trailingComments[0])&&q.range[0]>=z.end.offset&&(y=r.node.trailingComments,delete r.node.trailingComments);return y};D.prototype.findLeadingComments=function(z){for(var y=[],r;0<this.stack.length;){var q=this.stack[this.stack.length-1];if(q&&q.start>=z.start.offset)r=q.node,this.stack.pop();else break}if(r){for(var n=(r.leadingComments?r.leadingComments.length:0)-1;0<=n;--n)q=r.leadingComments[n],q.range[1]<=z.start.offset&&(y.unshift(q),r.leadingComments.splice(n,1));r.leadingComments&&
0===r.leadingComments.length&&delete r.leadingComments;return y}for(n=this.leading.length-1;0<=n;--n)q=this.leading[n],q.start<=z.start.offset&&(y.unshift(q.comment),this.leading.splice(n,1));return y};D.prototype.visitNode=function(z,y){if(!(z.type===a.Syntax.Program&&0<z.body.length)){this.insertInnerComments(z,y);var r=this.findTrailingComments(y),q=this.findLeadingComments(y);0<q.length&&(z.leadingComments=q);0<r.length&&(z.trailingComments=r);this.stack.push({node:z,start:y.start.offset})}};
D.prototype.visitComment=function(z,y){this.comments.push(z);if(this.attach){var r={comment:{type:z.type,value:z.value,range:[y.start.offset,y.end.offset]},start:y.start.offset};z.loc&&(r.comment.loc=z.loc);this.leading.push(r);this.trailing.push(r)}};D.prototype.visit=function(z,y){"Line"===z.type||"Block"===z.type?this.visitComment(z,y):this.attach&&this.visitNode(z,y)};return D}();m.CommentHandler=F})},"esri/arcade/lib/syntax":function(){define(["require","exports"],function(F,m){Object.defineProperty(m,
"__esModule",{value:!0});m.Syntax=void 0;m.Syntax={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ContinueStatement:"ContinueStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",
Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"}})},"esri/arcade/lib/parser":function(){define("require exports ./assert ./error-handler ./messages ./nodes ./scanner ./syntax ./token".split(" "),
function(F,m,a,D,z,y,r,q,n){Object.defineProperty(m,"__esModule",{value:!0});m.Parser=void 0;F=function(){function f(d,e,b){void 0===e&&(e={});this.config={range:"boolean"===typeof e.range&&e.range,loc:"boolean"===typeof e.loc&&e.loc,source:null,tokens:"boolean"===typeof e.tokens&&e.tokens,comment:"boolean"===typeof e.comment&&e.comment,tolerant:"boolean"===typeof e.tolerant&&e.tolerant,globalReturn:!!e.globalReturn};this.config.loc&&e.source&&null!==e.source&&(this.config.source=String(e.source));
this.delegate=b;this.errorHandler=new D.ErrorHandler;this.errorHandler.tolerant=this.config.tolerant;this.scanner=new r.Scanner(d,this.errorHandler);this.scanner.trackComment=this.config.comment;this.operatorPrecedence={")":0,";":0,",":0,"\x3d":0,"]":0,"||":1,"\x26\x26":2,"|":3,"^":4,"\x26":5,"\x3d\x3d":6,"!\x3d":6,"\x3d\x3d\x3d":6,"!\x3d\x3d":6,"\x3c":7,"\x3e":7,"\x3c\x3d":7,"\x3e\x3d":7,"\x3c\x3c":8,"\x3e\x3e":8,"\x3e\x3e\x3e":8,"+":9,"-":9,"*":11,"/":11,"%":11};this.lookahead={type:2,value:"",
lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0};this.hasLineTerminator=!1;this.context={allowIn:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inFunctionBody:!1,inIteration:!1,curlyParsing:"asObject"};this.tokens=[];this.startMarker={index:0,line:this.scanner.lineNumber,column:0};this.lastMarker={index:0,line:this.scanner.lineNumber,column:0};this.nextToken();this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-
this.scanner.lineStart}}f.prototype.tolerateError=function(d){for(var e=[],b=1;b<arguments.length;b++)e[b-1]=arguments[b];var c=e.slice();e=d.replace(/%(\d)/g,function(h,g){a.assert(g<c.length,"Message reference must be in range");return c[g]});this.errorHandler.tolerateError(this.lastMarker.index,this.scanner.lineNumber,this.lastMarker.column+1,e)};f.prototype.unexpectedTokenError=function(d,e){var b=e||z.Messages.UnexpectedToken;if(d){e||(b=2===d.type?z.Messages.UnexpectedEOS:3===d.type?z.Messages.UnexpectedIdentifier:
6===d.type?z.Messages.UnexpectedNumber:8===d.type?z.Messages.UnexpectedString:10===d.type?z.Messages.UnexpectedTemplate:z.Messages.UnexpectedToken);var c=d.value.toString()}else c="ILLEGAL";b=b.replace("%0",c);return d&&"number"===typeof d.lineNumber?this.errorHandler.createError(d.start,d.lineNumber,d.start-(this.lastMarker.index-this.lastMarker.column)+1,b):this.errorHandler.createError(this.lastMarker.index,this.lastMarker.line,this.lastMarker.column+1,b)};f.prototype.throwUnexpectedToken=function(d,
e){throw this.unexpectedTokenError(d,e);};f.prototype.tolerateUnexpectedToken=function(d,e){this.errorHandler.tolerate(this.unexpectedTokenError(d,e))};f.prototype.collectComments=function(){if(this.config.comment){var d=this.scanner.scanComments();if(d&&0<d.length&&this.delegate)for(var e=0;e<d.length;++e){var b=d[e],c=new y.Comment(b.multiLine?"Block":"Line",this.scanner.source.slice(b.slice[0],b.slice[1]));this.config.range&&(c.range=b.range);this.config.loc&&(c.loc=b.loc);this.delegate(c,{start:{line:b.loc.start.line,
column:b.loc.start.column,offset:b.range[0]},end:{line:b.loc.end.line,column:b.loc.end.column,offset:b.range[1]}})}}else this.scanner.scanComments()};f.prototype.peekAhead=function(d){var e=this,b=this.scanner.saveState();d.call(this,function(){e.scanner.scanComments();return e.scanner.lex()});this.scanner.restoreState(b)};f.prototype.getTokenRaw=function(d){return this.scanner.source.slice(d.start,d.end)};f.prototype.convertToken=function(d){var e={type:n.TokenName[d.type],value:this.getTokenRaw(d)};
this.config.range&&(e.range=[d.start,d.end]);this.config.loc&&(e.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}});9===d.type&&(e.regex={pattern:d.pattern,flags:d.flags});return e};f.prototype.nextToken=function(){var d=this.lookahead;this.lastMarker.index=this.scanner.index;this.lastMarker.line=this.scanner.lineNumber;this.lastMarker.column=this.scanner.index-this.scanner.lineStart;this.collectComments();
this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);var e=this.scanner.lex();this.hasLineTerminator=d.lineNumber!==e.lineNumber;this.lookahead=e;this.config.tokens&&2!==e.type&&this.tokens.push(this.convertToken(e));return d};f.prototype.createNode=function(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}};
f.prototype.startNode=function(d,e){void 0===e&&(e=0);var b=d.start-d.lineStart,c=d.lineNumber;0>b&&(b+=e,c--);return{index:d.start,line:c,column:b}};f.prototype.finalize=function(d,e){this.config.range&&(e.range=[d.index,this.lastMarker.index]);this.config.loc&&(e.loc={start:{line:d.line,column:d.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(e.loc.source=this.config.source));this.delegate&&this.delegate(e,{start:{line:d.line,column:d.column,offset:d.index},
end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}});return e};f.prototype.expect=function(d){var e=this.nextToken();7===e.type&&e.value===d||this.throwUnexpectedToken(e)};f.prototype.expectCommaSeparator=function(){if(this.config.tolerant){var d=this.lookahead;7===d.type&&","===d.value?this.nextToken():7===d.type&&";"===d.value?(this.nextToken(),this.tolerateUnexpectedToken(d)):this.tolerateUnexpectedToken(d,z.Messages.UnexpectedToken)}else this.expect(",")};
f.prototype.expectKeyword=function(d){var e=this.nextToken();4===e.type&&e.value.toString().toLowerCase()===d.toLowerCase()||this.throwUnexpectedToken(e)};f.prototype.match=function(d){return 7===this.lookahead.type&&this.lookahead.value===d};f.prototype.matchKeyword=function(d){return 4===this.lookahead.type&&this.lookahead.value.toLowerCase()===d.toLowerCase()};f.prototype.matchContextualKeyword=function(d){return 3===this.lookahead.type&&this.lookahead.value===d};f.prototype.matchAssign=function(){return 7!==
this.lookahead.type?!1:y.AssignmentOperators.includes(this.lookahead.value)};f.prototype.isolateCoverGrammar=function(d){var e=this.context.isBindingElement,b=this.context.isAssignmentTarget,c=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0;this.context.isAssignmentTarget=!0;this.context.firstCoverInitializedNameError=null;d=d.call(this);null!==this.context.firstCoverInitializedNameError&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError);this.context.isBindingElement=
e;this.context.isAssignmentTarget=b;this.context.firstCoverInitializedNameError=c;return d};f.prototype.inheritCoverGrammar=function(d){var e=this.context.isBindingElement,b=this.context.isAssignmentTarget,c=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0;this.context.isAssignmentTarget=!0;this.context.firstCoverInitializedNameError=null;d=d.call(this);this.context.isBindingElement=this.context.isBindingElement&&e;this.context.isAssignmentTarget=this.context.isAssignmentTarget&&
b;this.context.firstCoverInitializedNameError=c||this.context.firstCoverInitializedNameError;return d};f.prototype.consumeSemicolon=function(){this.match(";")?this.nextToken():this.hasLineTerminator||(2===this.lookahead.type||this.match("}")||this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)};f.prototype.parsePrimaryExpression=function(){var d=this.createNode();switch(this.lookahead.type){case 3:d=
this.finalize(d,new y.Identifier(this.nextToken().value));break;case 6:case 8:this.context.isAssignmentTarget=!1;this.context.isBindingElement=!1;var e=this.nextToken();var b=this.getTokenRaw(e);d=this.finalize(d,new y.Literal(e.value,b));break;case 1:this.context.isAssignmentTarget=!1;this.context.isBindingElement=!1;e=this.nextToken();b=this.getTokenRaw(e);d=this.finalize(d,new y.Literal("true"===e.value.toString().toLowerCase(),b));break;case 5:this.context.isAssignmentTarget=!1;this.context.isBindingElement=
!1;e=this.nextToken();b=this.getTokenRaw(e);d=this.finalize(d,new y.Literal(null,b));break;case 10:d=this.parseTemplateLiteral();break;case 7:switch(this.lookahead.value){case "(":this.context.isBindingElement=!1;d=this.inheritCoverGrammar(this.parseGroupExpression);break;case "[":d=this.inheritCoverGrammar(this.parseArrayInitializer);break;case "{":d=this.inheritCoverGrammar(this.parseObjectInitializer);break;default:d=this.throwUnexpectedToken(this.nextToken())}break;case 4:this.context.isAssignmentTarget=
!1;this.context.isBindingElement=!1;d=this.throwUnexpectedToken(this.nextToken());break;default:d=this.throwUnexpectedToken(this.nextToken())}return d};f.prototype.parseArrayInitializer=function(){var d=this.createNode(),e=[];for(this.expect("[");!this.match("]");)this.match(",")?(this.nextToken(),e.push(null)):(e.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(","));this.expect("]");return this.finalize(d,new y.ArrayExpression(e))};f.prototype.parseObjectPropertyKey=
function(){var d=this.createNode(),e=this.nextToken();switch(e.type){case 8:case 6:d=this.finalize(d,new y.Literal(e.value,this.getTokenRaw(e)));break;case 3:case 1:case 5:case 4:d=this.finalize(d,new y.Identifier(e.value));break;default:d=this.throwUnexpectedToken(e)}return d};f.prototype.parseObjectProperty=function(){var d=this.createNode(),e=this.lookahead,b=!1,c=!1,h=null;if(3===e.type){var g=e.value;this.nextToken();b=this.match("[");h=this.finalize(d,new y.Identifier(g))}else this.match("*")?
this.nextToken():(b=this.match("["),h=this.parseObjectPropertyKey());h||this.throwUnexpectedToken(this.lookahead);g=null;this.match(":")?(this.nextToken(),g=this.inheritCoverGrammar(this.parseAssignmentExpression)):3===e.type?(g=this.finalize(d,new y.Identifier(e.value)),c=!0):this.throwUnexpectedToken(this.nextToken());return this.finalize(d,new y.Property("init",h,b,g,!1,c))};f.prototype.parseObjectInitializer=function(){var d=this.createNode();this.expect("{");for(var e=[];!this.match("}");)e.push(this.parseObjectProperty()),
this.match("}")||this.expectCommaSeparator();this.expect("}");return this.finalize(d,new y.ObjectExpression(e))};f.prototype.parseTemplateHead=function(){a.assert(this.lookahead.head,"Template literal must start with a template head");var d=this.createNode(),e=this.nextToken();return this.finalize(d,new y.TemplateElement({raw:e.value,cooked:e.cooked},e.tail))};f.prototype.parseTemplateElement=function(){10!==this.lookahead.type&&this.throwUnexpectedToken();var d=this.createNode(),e=this.nextToken();
return this.finalize(d,new y.TemplateElement({raw:e.value,cooked:e.cooked},e.tail))};f.prototype.parseTemplateLiteral=function(){var d=this.createNode(),e=[],b=[],c=this.parseTemplateHead();for(b.push(c);!c.tail;)e.push(this.parseExpression()),c=this.parseTemplateElement(),b.push(c);return this.finalize(d,new y.TemplateLiteral(b,e))};f.prototype.parseGroupExpression=function(){this.expect("(");this.context.isBindingElement=!0;var d=this.inheritCoverGrammar(this.parseAssignmentExpression);this.expect(")");
this.context.isBindingElement=!1;return d};f.prototype.parseArguments=function(){this.expect("(");var d=[];if(!this.match(")"))for(;;){var e=this.isolateCoverGrammar(this.parseAssignmentExpression);d.push(e);if(this.match(")"))break;this.expectCommaSeparator();if(this.match(")"))break}this.expect(")");return d};f.prototype.isIdentifierName=function(d){return 3===d.type||4===d.type||1===d.type||5===d.type};f.prototype.parseIdentifierName=function(){var d=this.createNode(),e=this.nextToken();this.isIdentifierName(e)||
this.throwUnexpectedToken(e);return this.finalize(d,new y.Identifier(e.value))};f.prototype.parseLeftHandSideExpressionAllowCall=function(){var d=this.lookahead,e=this.context.allowIn;this.context.allowIn=!0;for(var b=this.inheritCoverGrammar(this.parsePrimaryExpression);;)if(this.match("(")){this.context.isBindingElement=!1;this.context.isAssignmentTarget=!1;var c=this.parseArguments();b=this.finalize(this.startNode(d),new y.CallExpression(b,c))}else if(this.match("["))this.context.isBindingElement=
!1,this.context.isAssignmentTarget=!0,this.expect("["),c=this.isolateCoverGrammar(this.parseExpression),this.expect("]"),b=this.finalize(this.startNode(d),new y.ComputedMemberExpression(b,c));else if(this.match("."))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("."),c=this.parseIdentifierName(),b=this.finalize(this.startNode(d),new y.StaticMemberExpression(b,c));else break;this.context.allowIn=e;return b};f.prototype.parseLeftHandSideExpression=function(){a.assert(this.context.allowIn,
"callee of new expression always allow in keyword.");for(var d=this.startNode(this.lookahead),e=this.inheritCoverGrammar(this.parsePrimaryExpression);;)if(this.match("[")){this.context.isBindingElement=!1;this.context.isAssignmentTarget=!0;this.expect("[");var b=this.isolateCoverGrammar(this.parseExpression);this.expect("]");e=this.finalize(d,new y.ComputedMemberExpression(e,b))}else if(this.match("."))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("."),b=this.parseIdentifierName(),
e=this.finalize(d,new y.StaticMemberExpression(e,b));else break;return e};f.prototype.parseUpdateExpression=function(){var d=this.lookahead;if(this.match("++")||this.match("--")){d=this.startNode(d);var e=this.nextToken();var b=this.inheritCoverGrammar(this.parseUnaryExpression);this.context.isAssignmentTarget||this.tolerateError(z.Messages.InvalidLHSInAssignment);b=this.finalize(d,new y.UpdateExpression(e.value,b,!0));this.context.isAssignmentTarget=!1;this.context.isBindingElement=!1}else b=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),
this.hasLineTerminator||7!==this.lookahead.type||!this.match("++")&&!this.match("--")||(this.context.isAssignmentTarget||this.tolerateError(z.Messages.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,e=this.nextToken().value,b=this.finalize(this.startNode(d),new y.UpdateExpression(e,b,!1)));return b};f.prototype.parseUnaryExpression=function(){if(this.match("+")||this.match("-")||this.match("~")||this.match("!")){var d=this.startNode(this.lookahead),e=this.nextToken();
var b=this.inheritCoverGrammar(this.parseUnaryExpression);b=this.finalize(d,new y.UnaryExpression(e.value,b));this.context.isAssignmentTarget=!1;this.context.isBindingElement=!1}else b=this.parseUpdateExpression();return b};f.prototype.binaryPrecedence=function(d){var e=d.value;return 7===d.type?this.operatorPrecedence[e]||0:4===d.type?this.context.allowIn&&"in"===e?12:0:0};f.prototype.parseBinaryExpression=function(){var d=this.lookahead,e=this.inheritCoverGrammar(this.parseUnaryExpression),b=this.lookahead,
c=this.binaryPrecedence(b);if(0<c){this.nextToken();this.context.isAssignmentTarget=!1;this.context.isBindingElement=!1;d=[d,this.lookahead];var h=this.inheritCoverGrammar(this.parseUnaryExpression);b=[e,b.value,h];for(var g=[c];;){c=this.binaryPrecedence(this.lookahead);if(0>=c)break;for(;2<b.length&&c<=g[g.length-1];){h=b.pop();var k=b.pop();g.pop();e=b.pop();d.pop();var w=d[d.length-1],t=this.startNode(w,w.lineStart);b.push(this.finalize(t,new y.BinaryExpression(k,e,h)))}b.push(this.nextToken().value);
g.push(c);d.push(this.lookahead);b.push(this.inheritCoverGrammar(this.parseUnaryExpression))}c=b.length-1;e=b[c];for(k=d.pop();1<c;){w=d.pop();if(!w)break;t=this.startNode(w,k&&k.lineStart);k=b[c-1];e=this.finalize(t,new y.BinaryExpression(k,b[c-2],e));c-=2;k=w}}return e};f.prototype.parseAssignmentExpression=function(){var d=this.lookahead,e=d,b=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.matchAssign()){this.context.isAssignmentTarget||this.tolerateError(z.Messages.InvalidLHSInAssignment);
this.match("\x3d")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1);e=this.nextToken();e=e.value;var c=this.isolateCoverGrammar(this.parseAssignmentExpression);b=this.finalize(this.startNode(d),new y.AssignmentExpression(e,b,c));this.context.firstCoverInitializedNameError=null}return b};f.prototype.parseExpression=function(){return this.isolateCoverGrammar(this.parseAssignmentExpression)};f.prototype.parseStatementListItem=function(){this.context.isAssignmentTarget=!0;this.context.isBindingElement=
!0;if(4===this.lookahead.type)switch(this.lookahead.value){case "function":var d=this.parseFunctionDeclaration();break;default:d=this.parseStatement()}else d=this.parseStatement();return d};f.prototype.parseBlock=function(){var d=this.createNode();this.expect("{");for(var e=[];!this.match("}");)e.push(this.parseStatementListItem());this.expect("}");return this.finalize(d,new y.BlockStatement(e))};f.prototype.parseObjectStatement=function(){var d=this.createNode(),e=this.parseObjectInitializer();return this.finalize(d,
new y.ExpressionStatement(e))};f.prototype.parseBlockOrObjectStatement=function(){var d="asObject"===this.context.curlyParsing;"asObjectOrBlock"===this.context.curlyParsing&&this.peekAhead(function(e){var b=e();if(3===b.type||8===b.type)b=e(),7===b.type&&":"===b.value&&(d=!0)});return d?this.parseObjectStatement():this.parseBlock()};f.prototype.parseVariableIdentifier=function(){var d=this.createNode(),e=this.nextToken();3!==e.type&&this.throwUnexpectedToken(e,z.Messages.IdentiferExpected);return this.finalize(d,
new y.Identifier(e.value))};f.prototype.parseVariableDeclaration=function(d){var e=this.createNode(),b=this.parseVariableIdentifier(),c=null;this.match("\x3d")?(this.nextToken(),c=this.isolateCoverGrammar(this.parseAssignmentExpression)):b.type===q.Syntax.Identifier||d.inFor||this.expect("\x3d");return this.finalize(e,new y.VariableDeclarator(b,c))};f.prototype.parseVariableDeclarationList=function(d){for(var e=[this.parseVariableDeclaration(d)];this.match(",");)this.nextToken(),e.push(this.parseVariableDeclaration(d));
return e};f.prototype.parseVariableStatement=function(){var d=this.createNode();this.expectKeyword("var");var e=this.parseVariableDeclarationList({inFor:!1});this.consumeSemicolon();return this.finalize(d,new y.VariableDeclaration(e,"var"))};f.prototype.parseEmptyStatement=function(){var d=this.createNode();this.expect(";");return this.finalize(d,new y.EmptyStatement)};f.prototype.parseExpressionStatement=function(){var d=this.createNode(),e=this.parseExpression();this.consumeSemicolon();return this.finalize(d,
new y.ExpressionStatement(e))};f.prototype.parseIfClause=function(){var d=this.context.curlyParsing;this.context.curlyParsing="asObjectOrBlock";var e=this.parseStatement();this.context.curlyParsing=d;return e};f.prototype.parseIfStatement=function(){var d=this.createNode(),e=null;this.expectKeyword("if");this.expect("(");var b=this.parseExpression();if(!this.match(")")&&this.config.tolerant){this.tolerateUnexpectedToken(this.nextToken());var c=this.finalize(this.createNode(),new y.EmptyStatement)}else this.expect(")"),
c=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),e=this.parseIfClause());return this.finalize(d,new y.IfStatement(b,c,e))};f.prototype.parseForStatement=function(){var d=null,e=null,b=null,c=null,h=null,g=this.createNode();this.expectKeyword("for");this.expect("(");if(this.match(";"))this.nextToken();else if(this.matchKeyword("var")){var k=this.createNode();this.nextToken();var w=this.context.allowIn;this.context.allowIn=!1;var t=this.parseVariableDeclarationList({inFor:!0});this.context.allowIn=
w;1===t.length&&this.matchKeyword("in")?(t[0].init&&this.tolerateError(z.Messages.ForInOfLoopInitializer,"for-in"),c=this.finalize(k,new y.VariableDeclaration(t,"var")),this.nextToken(),h=this.parseExpression()):(d=this.finalize(k,new y.VariableDeclaration(t,"var")),this.expect(";"))}else{k=this.context.isBindingElement;t=this.context.isAssignmentTarget;var C=this.context.firstCoverInitializedNameError;w=this.context.allowIn;this.context.allowIn=!1;d=this.inheritCoverGrammar(this.parseAssignmentExpression);
this.context.allowIn=w;this.matchKeyword("in")?(this.context.isAssignmentTarget&&d.type!==q.Syntax.AssignmentExpression||this.tolerateError(z.Messages.InvalidLHSInForIn),this.nextToken(),c=d,h=this.parseExpression(),d=null):(this.context.isBindingElement=k,this.context.isAssignmentTarget=t,this.context.firstCoverInitializedNameError=C,this.expect(";"))}c||(this.match(";")||(e=this.isolateCoverGrammar(this.parseExpression)),this.expect(";"),this.match(")")||(b=this.isolateCoverGrammar(this.parseExpression)));
!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),w=this.finalize(this.createNode(),new y.EmptyStatement)):(this.expect(")"),k=this.context.inIteration,t=this.context.curlyParsing,this.context.inIteration=!0,this.context.curlyParsing="asObjectOrBlock",w=this.isolateCoverGrammar(this.parseStatement),this.context.curlyParsing=t,this.context.inIteration=k);return c&&h?this.finalize(g,new y.ForInStatement(c,h,w)):this.finalize(g,new y.ForStatement(d,e,b,w))};f.prototype.parseContinueStatement=
function(){var d=this.createNode();this.expectKeyword("continue");this.consumeSemicolon();return this.finalize(d,new y.ContinueStatement)};f.prototype.parseBreakStatement=function(){var d=this.createNode();this.expectKeyword("break");this.consumeSemicolon();return this.finalize(d,new y.BreakStatement)};f.prototype.parseReturnStatement=function(){this.config.globalReturn||this.context.inFunctionBody||this.tolerateError(z.Messages.IllegalReturn);var d=this.createNode();this.expectKeyword("return");
var e=(this.match(";")||this.match("}")||this.hasLineTerminator||2===this.lookahead.type)&&8!==this.lookahead.type&&10!==this.lookahead.type?null:this.parseExpression();this.consumeSemicolon();return this.finalize(d,new y.ReturnStatement(e))};f.prototype.parseStatement=function(){switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 3:var d=this.parseExpressionStatement();break;case 7:d=this.lookahead.value;d="{"===d?this.parseBlockOrObjectStatement():"("===d?this.parseExpressionStatement():
";"===d?this.parseEmptyStatement():this.parseExpressionStatement();break;case 4:switch(this.lookahead.value.toLowerCase()){case "break":d=this.parseBreakStatement();break;case "continue":d=this.parseContinueStatement();break;case "for":d=this.parseForStatement();break;case "function":d=this.parseFunctionDeclaration();break;case "if":d=this.parseIfStatement();break;case "return":d=this.parseReturnStatement();break;case "var":d=this.parseVariableStatement();break;default:d=this.parseExpressionStatement()}break;
default:d=this.throwUnexpectedToken(this.lookahead)}return d};f.prototype.parseFunctionSourceElements=function(){var d=this.createNode();this.expect("{");var e=this.context.inIteration,b=this.context.inFunctionBody;this.context.inIteration=!1;this.context.inFunctionBody=!0;for(var c=[];2!==this.lookahead.type&&!this.match("}");)c.push(this.parseStatementListItem());this.expect("}");this.context.inIteration=e;this.context.inFunctionBody=b;return this.finalize(d,new y.BlockStatement(c))};f.prototype.parseFormalParameters=
function(){var d=[];this.expect("(");if(!this.match(")"))for(;2!==this.lookahead.type;){d.push(this.parseVariableIdentifier());if(this.match(")"))break;this.expect(",");if(this.match(")"))break}this.expect(")");return d};f.prototype.parseFunctionDeclaration=function(){var d=this.createNode();this.expectKeyword("function");var e=this.parseVariableIdentifier(),b=this.parseFormalParameters(),c=this.parseFunctionSourceElements();return this.finalize(d,new y.FunctionDeclaration(e,b,c))};f.prototype.parseScript=
function(){for(var d=this.createNode(),e=[];2!==this.lookahead.type;)e.push(this.parseStatementListItem());return this.finalize(d,new y.Program(e))};return f}();m.Parser=F})},"esri/arcade/lib/assert":function(){define(["require","exports"],function(F,m){Object.defineProperty(m,"__esModule",{value:!0});m.assert=void 0;m.assert=function(a,D){if(!a)throw Error("ASSERT: "+D);}})},"esri/arcade/lib/error-handler":function(){define(["require","exports"],function(F,m){Object.defineProperty(m,"__esModule",
{value:!0});m.ErrorHandler=void 0;var a=function(){function D(){this.errors=[];this.tolerant=!1}D.prototype.recordError=function(z){this.errors.push(z)};D.prototype.tolerate=function(z){if(this.tolerant)this.recordError(z);else throw z;};D.prototype.constructError=function(z,y){var r=Error(z);try{throw r;}catch(q){Object.create&&Object.defineProperty&&(r=Object.create(q),Object.defineProperty(r,"column",{value:y}))}return r};D.prototype.createError=function(z,y,r,q){r=this.constructError("Line "+
y+": "+q,r);r.index=z;r.lineNumber=y;r.description=q;return r};D.prototype.throwError=function(z,y,r,q){throw this.createError(z,y,r,q);};D.prototype.tolerateError=function(z,y,r,q){z=this.createError(z,y,r,q);if(this.tolerant)this.recordError(z);else throw z;};return D}();m.ErrorHandler=a})},"esri/arcade/lib/messages":function(){define(["require","exports"],function(F,m){Object.defineProperty(m,"__esModule",{value:!0});m.Messages=void 0;m.Messages={ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",
GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",
InvalidRegExp:"Invalid regular expression",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictParamDupe:"Strict mode function may not have duplicate parameter names",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",
UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnterminatedRegExp:"Invalid regular expression: missing /",IdentiferExpected:"Identifier expected"}})},"esri/arcade/lib/nodes":function(){var F=this&&this.__extends||function(){var m=function(a,D){m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,y){z.__proto__=y}||function(z,y){for(var r in y)Object.prototype.hasOwnProperty.call(y,r)&&(z[r]=y[r])};return m(a,D)};return function(a,D){function z(){this.constructor=
a}if("function"!==typeof D&&null!==D)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");m(a,D);a.prototype=null===D?Object.create(D):(z.prototype=D.prototype,new z)}}();define(["require","exports","./syntax"],function(m,a,D){Object.defineProperty(a,"__esModule",{value:!0});a.VariableDeclarator=a.VariableDeclaration=a.UpdateExpression=a.UpdateOperators=a.UnaryExpression=a.UnaryOperators=a.TemplateLiteral=a.TemplateElement=a.Program=a.ReturnStatement=a.Property=a.ObjectExpression=
a.Literal=a.IfStatement=a.Identifier=a.FunctionDeclaration=a.ForStatement=a.ForInStatement=a.ExpressionStatement=a.EmptyStatement=a.ContinueStatement=a.StaticMemberExpression=a.ComputedMemberExpression=a.CallExpression=a.BreakStatement=a.BlockStatement=a.BinaryExpression=a.BinaryOperators=a.LogicalOperators=a.AssignmentExpression=a.AssignmentOperators=a.ArrayExpression=a.Comment=void 0;m=function(){return function(){}}();var z=function(y){function r(q,n){var f=y.call(this)||this;f.type=q;f.value=
n;return f}F(r,y);return r}(m);a.Comment=z;z=function(y){function r(q){var n=y.call(this)||this;n.elements=q;n.type=D.Syntax.ArrayExpression;return n}F(r,y);return r}(m);a.ArrayExpression=z;a.AssignmentOperators="\x3d /\x3d *\x3d %\x3d +\x3d -\x3d".split(" ");z=function(y){function r(q,n,f){var d=y.call(this)||this;d.operator=q;d.left=n;d.right=f;d.type=D.Syntax.AssignmentExpression;return d}F(r,y);return r}(m);a.AssignmentExpression=z;a.LogicalOperators=["||","\x26\x26"];a.BinaryOperators="| \x26 \x3e\x3e \x3c\x3c \x3e\x3e \x3e\x3e\x3e ^ \x3d\x3d !\x3d \x3c \x3c\x3d \x3e \x3e\x3d + - * / %".split(" ");
z=function(y){function r(q,n,f){var d=y.call(this)||this;d.operator=q;d.left=n;d.right=f;d.type=a.LogicalOperators.includes(q)?D.Syntax.LogicalExpression:D.Syntax.BinaryExpression;return d}F(r,y);return r}(m);a.BinaryExpression=z;z=function(y){function r(q){var n=y.call(this)||this;n.body=q;n.type=D.Syntax.BlockStatement;return n}F(r,y);return r}(m);a.BlockStatement=z;z=function(y){function r(){var q=null!==y&&y.apply(this,arguments)||this;q.type=D.Syntax.BreakStatement;return q}F(r,y);return r}(m);
a.BreakStatement=z;z=function(y){function r(q,n){var f=y.call(this)||this;f.callee=q;f.args=n;f.type=D.Syntax.CallExpression;f.arguments=n;return f}F(r,y);return r}(m);a.CallExpression=z;z=function(y){function r(q,n){var f=y.call(this)||this;f.object=q;f.property=n;f.type=D.Syntax.MemberExpression;f.computed=!0;return f}F(r,y);return r}(m);a.ComputedMemberExpression=z;z=function(y){function r(q,n){var f=y.call(this)||this;f.object=q;f.property=n;f.type=D.Syntax.MemberExpression;f.computed=!1;return f}
F(r,y);return r}(m);a.StaticMemberExpression=z;z=function(y){function r(){var q=null!==y&&y.apply(this,arguments)||this;q.type=D.Syntax.ContinueStatement;return q}F(r,y);return r}(m);a.ContinueStatement=z;z=function(y){function r(){var q=null!==y&&y.apply(this,arguments)||this;q.type=D.Syntax.EmptyStatement;return q}F(r,y);return r}(m);a.EmptyStatement=z;z=function(y){function r(q){var n=y.call(this)||this;n.expression=q;n.type=D.Syntax.ExpressionStatement;return n}F(r,y);return r}(m);a.ExpressionStatement=
z;z=function(y){function r(q,n,f){var d=y.call(this)||this;d.left=q;d.right=n;d.body=f;d.type=D.Syntax.ForInStatement;d.each=!1;return d}F(r,y);return r}(m);a.ForInStatement=z;z=function(y){function r(q,n,f,d){var e=y.call(this)||this;e.init=q;e.test=n;e.update=f;e.body=d;e.type=D.Syntax.ForStatement;return e}F(r,y);return r}(m);a.ForStatement=z;z=function(y){function r(q,n,f){var d=y.call(this)||this;d.id=q;d.params=n;d.body=f;d.type=D.Syntax.FunctionDeclaration;d.generator=!1;d.expression=!1;d.async=
!1;return d}F(r,y);return r}(m);a.FunctionDeclaration=z;z=function(y){function r(q){var n=y.call(this)||this;n.name=q;n.type=D.Syntax.Identifier;return n}F(r,y);return r}(m);a.Identifier=z;z=function(y){function r(q,n,f){var d=y.call(this)||this;d.test=q;d.consequent=n;d.alternate=f;d.type=D.Syntax.IfStatement;return d}F(r,y);return r}(m);a.IfStatement=z;z=function(y){function r(q,n){var f=y.call(this)||this;f.value=q;f.raw=n;f.type=D.Syntax.Literal;return f}F(r,y);return r}(m);a.Literal=z;z=function(y){function r(q){var n=
y.call(this)||this;n.properties=q;n.type=D.Syntax.ObjectExpression;return n}F(r,y);return r}(m);a.ObjectExpression=z;z=function(y){function r(q,n,f,d,e,b){var c=y.call(this)||this;c.kind=q;c.key=n;c.computed=f;c.value=d;c.method=e;c.shorthand=b;c.type=D.Syntax.Property;return c}F(r,y);return r}(m);a.Property=z;z=function(y){function r(q){var n=y.call(this)||this;n.argument=q;n.type=D.Syntax.ReturnStatement;return n}F(r,y);return r}(m);a.ReturnStatement=z;z=function(y){function r(q){var n=y.call(this)||
this;n.body=q;n.type=D.Syntax.Program;return n}F(r,y);return r}(m);a.Program=z;z=function(y){function r(q,n){var f=y.call(this)||this;f.value=q;f.tail=n;f.type=D.Syntax.TemplateElement;return f}F(r,y);return r}(m);a.TemplateElement=z;z=function(y){function r(q,n){var f=y.call(this)||this;f.quasis=q;f.expressions=n;f.type=D.Syntax.TemplateLiteral;return f}F(r,y);return r}(m);a.TemplateLiteral=z;a.UnaryOperators=["-","+","!","~"];z=function(y){function r(q,n){var f=y.call(this)||this;f.operator=q;f.argument=
n;f.type=D.Syntax.UnaryExpression;f.prefix=!0;return f}F(r,y);return r}(m);a.UnaryExpression=z;a.UpdateOperators=["++","--"];z=function(y){function r(q,n,f){var d=y.call(this)||this;d.operator=q;d.argument=n;d.prefix=f;d.type=D.Syntax.UpdateExpression;return d}F(r,y);return r}(m);a.UpdateExpression=z;z=function(y){function r(q,n){var f=y.call(this)||this;f.declarations=q;f.kind=n;f.type=D.Syntax.VariableDeclaration;return f}F(r,y);return r}(m);a.VariableDeclaration=z;m=function(y){function r(q,n){var f=
y.call(this)||this;f.id=q;f.init=n;f.type=D.Syntax.VariableDeclarator;return f}F(r,y);return r}(m);a.VariableDeclarator=m})},"esri/arcade/lib/scanner":function(){define(["require","exports","./assert","./character","./messages"],function(F,m,a,D,z){Object.defineProperty(m,"__esModule",{value:!0});m.Scanner=void 0;F=function(){function y(r,q){this.source=r;this.errorHandler=q;this.isModule=this.trackComment=!1;this.length=r.length;this.index=0;this.lineNumber=0<r.length?1:0;this.lineStart=0;this.curlyStack=
[]}y.prototype.saveState=function(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart,curlyStack:this.curlyStack.slice()}};y.prototype.restoreState=function(r){this.index=r.index;this.lineNumber=r.lineNumber;this.lineStart=r.lineStart;this.curlyStack=r.curlyStack};y.prototype.eof=function(){return this.index>=this.length};y.prototype.throwUnexpectedToken=function(r){void 0===r&&(r=z.Messages.UnexpectedTokenIllegal);return this.errorHandler.throwError(this.index,this.lineNumber,
this.index-this.lineStart+1,r)};y.prototype.tolerateUnexpectedToken=function(r){void 0===r&&(r=z.Messages.UnexpectedTokenIllegal);this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,r)};y.prototype.skipSingleLineComment=function(r){var q=[],n=0,f=null;this.trackComment&&(q=[],n=this.index-r,f={start:{line:this.lineNumber,column:this.index-this.lineStart-r},end:{line:0,column:0}});for(;!this.eof();){var d=this.source.charCodeAt(this.index);++this.index;if(D.Character.isLineTerminator(d))return f&&
(f.end={line:this.lineNumber,column:this.index-this.lineStart-1},r={multiLine:!1,slice:[n+r,this.index-1],range:[n,this.index-1],loc:f},q.push(r)),13===d&&10===this.source.charCodeAt(this.index)&&++this.index,++this.lineNumber,this.lineStart=this.index,q}f&&(f.end={line:this.lineNumber,column:this.index-this.lineStart},r={multiLine:!1,slice:[n+r,this.index],range:[n,this.index],loc:f},q.push(r));return q};y.prototype.skipMultiLineComment=function(){var r=[],q=0,n=null;this.trackComment&&(q=this.index-
2,n={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{line:0,column:0}});for(;!this.eof();){var f=this.source.charCodeAt(this.index);if(D.Character.isLineTerminator(f))13===f&&10===this.source.charCodeAt(this.index+1)&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else{if(42===f&&47===this.source.charCodeAt(this.index+1))return this.index+=2,n&&(n.end={line:this.lineNumber,column:this.index-this.lineStart},q={multiLine:!0,slice:[q+2,this.index-2],range:[q,
this.index],loc:n},r.push(q)),r;++this.index}}n&&(n.end={line:this.lineNumber,column:this.index-this.lineStart},q={multiLine:!0,slice:[q+2,this.index],range:[q,this.index],loc:n},r.push(q));this.tolerateUnexpectedToken();return r};y.prototype.scanComments=function(){var r=null;this.trackComment&&(r=[]);for(var q=0===this.index;!this.eof();){var n=this.source.charCodeAt(this.index);if(D.Character.isWhiteSpace(n))++this.index;else if(D.Character.isLineTerminator(n))++this.index,13===n&&10===this.source.charCodeAt(this.index)&&
++this.index,++this.lineNumber,this.lineStart=this.index,q=!0;else if(47===n)if(n=this.source.charCodeAt(this.index+1),47===n)this.index+=2,n=this.skipSingleLineComment(2),r&&(r=r.concat(n)),q=!0;else if(42===n)this.index+=2,n=this.skipMultiLineComment(),r&&(r=r.concat(n));else break;else if(q&&45===n)if(45===this.source.charCodeAt(this.index+1)&&62===this.source.charCodeAt(this.index+2))this.index+=3,n=this.skipSingleLineComment(3),r&&(r=r.concat(n));else break;else if(60!==n||this.isModule)break;
else if("!--"===this.source.slice(this.index+1,this.index+4))this.index+=4,n=this.skipSingleLineComment(4),r&&(r=r.concat(n));else break}return r};y.prototype.isKeyword=function(r){r=r.toLowerCase();switch(r.length){case 2:return"if"===r||"in"===r;case 3:return"var"===r||"for"===r;case 4:return"else"===r;case 5:return"break"===r;case 6:return"return"===r;case 8:return"function"===r||"continue"===r;default:return!1}};y.prototype.codePointAt=function(r){var q=this.source.charCodeAt(r);55296<=q&&56319>=
q&&(r=this.source.charCodeAt(r+1),56320<=r&&57343>=r&&(q=1024*(q-55296)+r-56320+65536));return q};y.prototype.scanHexEscape=function(r){r="u"===r?4:2;for(var q=0,n=0;n<r;++n)if(!this.eof()&&D.Character.isHexDigit(this.source.charCodeAt(this.index)))q=16*q+"0123456789abcdef".indexOf(this.source[this.index++].toLowerCase());else return null;return String.fromCharCode(q)};y.prototype.scanUnicodeCodePointEscape=function(){var r=this.source[this.index],q=0;for("}"===r&&this.throwUnexpectedToken();!this.eof();){r=
this.source[this.index++];if(!D.Character.isHexDigit(r.charCodeAt(0)))break;q=16*q+"0123456789abcdef".indexOf(r.toLowerCase())}(1114111<q||"}"!==r)&&this.throwUnexpectedToken();return D.Character.fromCodePoint(q)};y.prototype.getIdentifier=function(){for(var r=this.index++;!this.eof();){var q=this.source.charCodeAt(this.index);if(92===q||55296<=q&&57343>q)return this.index=r,this.getComplexIdentifier();if(D.Character.isIdentifierPart(q))++this.index;else break}return this.source.slice(r,this.index)};
y.prototype.getComplexIdentifier=function(){var r=this.codePointAt(this.index),q=D.Character.fromCodePoint(r);this.index+=q.length;if(92===r){117!==this.source.charCodeAt(this.index)&&this.throwUnexpectedToken();++this.index;if("{"===this.source[this.index]){++this.index;var n=this.scanUnicodeCodePointEscape()}else n=this.scanHexEscape("u"),null!==n&&"\\"!==n&&D.Character.isIdentifierStart(n.charCodeAt(0))||this.throwUnexpectedToken();q=n}for(;!this.eof();){r=this.codePointAt(this.index);if(!D.Character.isIdentifierPart(r))break;
n=D.Character.fromCodePoint(r);q+=n;this.index+=n.length;92===r&&(q=q.substr(0,q.length-1),117!==this.source.charCodeAt(this.index)&&this.throwUnexpectedToken(),++this.index,"{"===this.source[this.index]?(++this.index,n=this.scanUnicodeCodePointEscape()):(n=this.scanHexEscape("u"),null!==n&&"\\"!==n&&D.Character.isIdentifierPart(n.charCodeAt(0))||this.throwUnexpectedToken()),q+=n)}return q};y.prototype.octalToDecimal=function(r){var q="0"!==r,n="01234567".indexOf(r);!this.eof()&&D.Character.isOctalDigit(this.source.charCodeAt(this.index))&&
(q=!0,n=8*n+"01234567".indexOf(this.source[this.index++]),0<="0123".indexOf(r)&&!this.eof()&&D.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(n=8*n+"01234567".indexOf(this.source[this.index++])));return{code:n,octal:q}};y.prototype.scanIdentifier=function(){var r=this.index,q=92===this.source.charCodeAt(r)?this.getComplexIdentifier():this.getIdentifier();var n=1===q.length?3:this.isKeyword(q)?4:"null"===q.toLowerCase()?5:"true"===q.toLowerCase()||"false"===q.toLowerCase()?1:3;if(3!==
n&&r+q.length!==this.index){var f=this.index;this.index=r;this.tolerateUnexpectedToken(z.Messages.InvalidEscapedReservedWord);this.index=f}return{type:n,value:q,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}};y.prototype.scanPunctuator=function(){var r=this.index,q=this.source[this.index];switch(q){case "(":case "{":"{"===q&&this.curlyStack.push("{");++this.index;break;case ".":++this.index;break;case "}":++this.index;this.curlyStack.pop();break;case ")":case ";":case ",":case "[":case "]":case ":":case "?":case "~":++this.index;
break;default:q=this.source.substr(this.index,4),"\x3e\x3e\x3e\x3d"===q?this.index+=4:(q=q.substr(0,3),"\x3d\x3d\x3d"===q||"!\x3d\x3d"===q||"\x3e\x3e\x3e"===q||"\x3c\x3c\x3d"===q||"\x3e\x3e\x3d"===q||"**\x3d"===q?this.index+=3:(q=q.substr(0,2),"\x26\x26"===q||"||"===q||"\x3d\x3d"===q||"!\x3d"===q||"+\x3d"===q||"-\x3d"===q||"*\x3d"===q||"/\x3d"===q||"++"===q||"--"===q||"\x3c\x3c"===q||"\x3e\x3e"===q||"\x26\x3d"===q||"|\x3d"===q||"^\x3d"===q||"%\x3d"===q||"\x3c\x3d"===q||"\x3e\x3d"===q||"\x3d\x3e"===
q||"**"===q?this.index+=2:(q=this.source[this.index],0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(q)&&++this.index)))}this.index===r&&this.throwUnexpectedToken();return{type:7,value:q,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}};y.prototype.scanHexLiteral=function(r){for(var q="";!this.eof()&&D.Character.isHexDigit(this.source.charCodeAt(this.index));)q+=this.source[this.index++];0===q.length&&this.throwUnexpectedToken();D.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&
this.throwUnexpectedToken();return{type:6,value:parseInt("0x"+q,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}};y.prototype.scanBinaryLiteral=function(r){for(var q="";!this.eof();){var n=this.source[this.index];if("0"!==n&&"1"!==n)break;q+=this.source[this.index++]}0===q.length&&this.throwUnexpectedToken();this.eof()||(n=this.source.charCodeAt(this.index),(D.Character.isIdentifierStart(n)||D.Character.isDecimalDigit(n))&&this.throwUnexpectedToken());return{type:6,
value:parseInt(q,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}};y.prototype.scanOctalLiteral=function(r,q){var n="",f=!1;D.Character.isOctalDigit(r.charCodeAt(0))?(f=!0,n="0"+this.source[this.index++]):++this.index;for(;!this.eof()&&D.Character.isOctalDigit(this.source.charCodeAt(this.index));)n+=this.source[this.index++];f||0!==n.length||this.throwUnexpectedToken();(D.Character.isIdentifierStart(this.source.charCodeAt(this.index))||D.Character.isDecimalDigit(this.source.charCodeAt(this.index)))&&
this.throwUnexpectedToken();return{type:6,value:parseInt(n,8),octal:f,lineNumber:this.lineNumber,lineStart:this.lineStart,start:q,end:this.index}};y.prototype.scanNumericLiteral=function(){var r=this.index,q=this.source[r];a.assert(D.Character.isDecimalDigit(q.charCodeAt(0))||"."===q,"Numeric literal must start with a decimal digit or a decimal point");var n="";if("."!==q){n=this.source[this.index++];q=this.source[this.index];if("0"===n){if("x"===q||"X"===q)return++this.index,this.scanHexLiteral(r);
if("b"===q||"B"===q)return++this.index,this.scanBinaryLiteral(r);if("o"===q||"O"===q)return this.scanOctalLiteral(q,r)}for(;D.Character.isDecimalDigit(this.source.charCodeAt(this.index));)n+=this.source[this.index++];q=this.source[this.index]}if("."===q){for(n+=this.source[this.index++];D.Character.isDecimalDigit(this.source.charCodeAt(this.index));)n+=this.source[this.index++];q=this.source[this.index]}if("e"===q||"E"===q){n+=this.source[this.index++];q=this.source[this.index];if("+"===q||"-"===
q)n+=this.source[this.index++];if(D.Character.isDecimalDigit(this.source.charCodeAt(this.index)))for(;D.Character.isDecimalDigit(this.source.charCodeAt(this.index));)n+=this.source[this.index++];else this.throwUnexpectedToken()}D.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken();return{type:6,value:parseFloat(n),lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}};y.prototype.scanStringLiteral=function(){var r=this.index,q=this.source[r];
a.assert("'"===q||'"'===q,"String literal must starts with a quote");++this.index;for(var n=!1,f="";!this.eof();){var d=this.source[this.index++];if(d===q){q="";break}if("\\"===d)if((d=this.source[this.index++])&&D.Character.isLineTerminator(d.charCodeAt(0)))++this.lineNumber,"\r"===d&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index;else switch(d){case "u":"{"===this.source[this.index]?(++this.index,f+=this.scanUnicodeCodePointEscape()):(d=this.scanHexEscape(d),null===d&&this.throwUnexpectedToken(),
f+=d);break;case "x":d=this.scanHexEscape(d);null===d&&this.throwUnexpectedToken(z.Messages.InvalidHexEscapeSequence);f+=d;break;case "n":f+="\n";break;case "r":f+="\r";break;case "t":f+="\t";break;case "b":f+="\b";break;case "f":f+="\f";break;case "v":f+="\x0B";break;case "8":case "9":f+=d;this.tolerateUnexpectedToken();break;default:d&&D.Character.isOctalDigit(d.charCodeAt(0))?(d=this.octalToDecimal(d),n=d.octal||n,f+=String.fromCharCode(d.code)):f+=d}else if(D.Character.isLineTerminator(d.charCodeAt(0)))break;
else f+=d}""!==q&&(this.index=r,this.throwUnexpectedToken());return{type:8,value:f,octal:n,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}};y.prototype.scanTemplate=function(){var r="",q=!1,n=this.index,f="`"===this.source[n],d=!1,e=2;for(++this.index;!this.eof();){var b=this.source[this.index++];if("`"===b){e=1;q=d=!0;break}if("$"===b){if("{"===this.source[this.index]){this.curlyStack.push("${");++this.index;q=!0;break}r+=b}else if("\\"===b)if(b=this.source[this.index++],
D.Character.isLineTerminator(b.charCodeAt(0)))++this.lineNumber,"\r"===b&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index;else switch(b){case "n":r+="\n";break;case "r":r+="\r";break;case "t":r+="\t";break;case "u":if("{"===this.source[this.index])++this.index,r+=this.scanUnicodeCodePointEscape();else{var c=this.index,h=this.scanHexEscape(b);null!==h?r+=h:(this.index=c,r+=b)}break;case "x":b=this.scanHexEscape(b);null===b&&this.throwUnexpectedToken(z.Messages.InvalidHexEscapeSequence);
r+=b;break;case "b":r+="\b";break;case "f":r+="\f";break;case "v":r+="\v";break;default:"0"===b?(D.Character.isDecimalDigit(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(z.Messages.TemplateOctalLiteral),r+="\x00"):D.Character.isOctalDigit(b.charCodeAt(0))?this.throwUnexpectedToken(z.Messages.TemplateOctalLiteral):r+=b}else D.Character.isLineTerminator(b.charCodeAt(0))?(++this.lineNumber,"\r"===b&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index,r+="\n"):r+=b}q||
this.throwUnexpectedToken();f||this.curlyStack.pop();return{type:10,value:this.source.slice(n+1,this.index-e),cooked:r,head:f,tail:d,lineNumber:this.lineNumber,lineStart:this.lineStart,start:n,end:this.index}};y.prototype.testRegExp=function(r,q){var n=this,f=r;0<=q.indexOf("u")&&(f=f.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,function(d,e,b){d=parseInt(e||b,16);1114111<d&&n.throwUnexpectedToken(z.Messages.InvalidRegExp);return 65535>=d?String.fromCharCode(d):"\uffff"}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,
"\uffff"));try{RegExp(f)}catch(d){this.throwUnexpectedToken(z.Messages.InvalidRegExp)}try{return new RegExp(r,q)}catch(d){return null}};y.prototype.scanRegExpBody=function(){var r=this.source[this.index];a.assert("/"===r,"Regular expression literal must start with a slash");for(var q=this.source[this.index++],n=!1,f=!1;!this.eof();)if(r=this.source[this.index++],q+=r,"\\"===r)r=this.source[this.index++],D.Character.isLineTerminator(r.charCodeAt(0))&&this.throwUnexpectedToken(z.Messages.UnterminatedRegExp),
q+=r;else if(D.Character.isLineTerminator(r.charCodeAt(0)))this.throwUnexpectedToken(z.Messages.UnterminatedRegExp);else if(n)"]"===r&&(n=!1);else{if("/"===r){f=!0;break}"["===r&&(n=!0)}f||this.throwUnexpectedToken(z.Messages.UnterminatedRegExp);return q.substr(1,q.length-2)};y.prototype.scanRegExpFlags=function(){for(var r="";!this.eof();){var q=this.source[this.index];if(!D.Character.isIdentifierPart(q.charCodeAt(0)))break;++this.index;if("\\"!==q||this.eof())r+=q;else{q=this.source[this.index];
if("u"===q){++this.index;q=this.index;var n=this.scanHexEscape("u");if(null!==n)for(r+=n;q<this.index;++q);else this.index=q,r+="u"}this.tolerateUnexpectedToken()}}return r};y.prototype.scanRegExp=function(){var r=this.index,q=this.scanRegExpBody(),n=this.scanRegExpFlags(),f=this.testRegExp(q,n);return{type:9,value:"",pattern:q,flags:n,regex:f,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}};y.prototype.lex=function(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,
lineStart:this.lineStart,start:this.index,end:this.index};var r=this.source.charCodeAt(this.index);return D.Character.isIdentifierStart(r)?this.scanIdentifier():40===r||41===r||59===r?this.scanPunctuator():39===r||34===r?this.scanStringLiteral():46===r?D.Character.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():D.Character.isDecimalDigit(r)?this.scanNumericLiteral():96===r||125===r&&"${"===this.curlyStack[this.curlyStack.length-1]?this.scanTemplate():
55296<=r&&57343>r&&D.Character.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()};return y}();m.Scanner=F})},"esri/arcade/lib/character":function(){define(["require","exports"],function(F,m){Object.defineProperty(m,"__esModule",{value:!0});m.Character=void 0;var a=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB67\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDEC0-\uDEEB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,
D=/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D3-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB67\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDF00-\uDF1C\uDF27\uDF30-\uDF50\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD46\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E\uDC5F\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/;
m.Character={fromCodePoint:function(z){return 65536>z?String.fromCharCode(z):String.fromCharCode(55296+(z-65536>>10))+String.fromCharCode(56320+(z-65536&1023))},isWhiteSpace:function(z){return 32===z||9===z||11===z||12===z||160===z||5760<=z&&0<=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(z)},isLineTerminator:function(z){return 10===z||13===z||8232===z||8233===z},isIdentifierStart:function(z){return 36===z||95===z||65<=z&&90>=z||97<=z&&122>=z||92===z||
128<=z&&a.test(m.Character.fromCodePoint(z))},isIdentifierPart:function(z){return 36===z||95===z||65<=z&&90>=z||97<=z&&122>=z||48<=z&&57>=z||92===z||128<=z&&D.test(m.Character.fromCodePoint(z))},isDecimalDigit:function(z){return 48<=z&&57>=z},isHexDigit:function(z){return 48<=z&&57>=z||65<=z&&70>=z||97<=z&&102>=z},isOctalDigit:function(z){return 48<=z&&55>=z}}})},"esri/arcade/lib/token":function(){define(["require","exports"],function(F,m){Object.defineProperty(m,"__esModule",{value:!0});m.TokenName=
m.TokenType=void 0;var a=m.TokenType||(m.TokenType={});a[a.BooleanLiteral=1]="BooleanLiteral";a[a.EOF=2]="EOF";a[a.Identifier=3]="Identifier";a[a.Keyword=4]="Keyword";a[a.NullLiteral=5]="NullLiteral";a[a.NumericLiteral=6]="NumericLiteral";a[a.Punctuator=7]="Punctuator";a[a.StringLiteral=8]="StringLiteral";a[a.RegularExpression=9]="RegularExpression";a[a.Template=10]="Template";m.TokenName={};m.TokenName[1]="Boolean";m.TokenName[2]="\x3cend\x3e";m.TokenName[3]="Identifier";m.TokenName[4]="Keyword";
m.TokenName[5]="Null";m.TokenName[6]="Numeric";m.TokenName[7]="Punctuator";m.TokenName[8]="String";m.TokenName[9]="RegularExpression";m.TokenName[10]="Template"})},"esri/arcade/lib/tokenizer":function(){var F=this&&this.__spreadArray||function(m,a){for(var D=0,z=a.length,y=m.length;D<z;D++,y++)m[y]=a[D];return m};define("require exports ./error-handler ./nodes ./scanner ./token".split(" "),function(m,a,D,z,y,r){Object.defineProperty(a,"__esModule",{value:!0});a.Tokenizer=void 0;var q=function(){function n(){this.values=
[];this.curly=this.paren=-1}n.prototype.beforeFunctionExpression=function(f){return 0<=F(F(F(F(["(","{","[","return",","],z.AssignmentOperators),z.BinaryOperators),z.LogicalOperators),z.UnaryOperators).indexOf(f)};n.prototype.isRegexStart=function(){var f=this.values[this.values.length-1],d=null!==f;switch(f){case "this":case "]":d=!1;break;case ")":f=this.values[this.paren-1];d="if"===f||"while"===f||"for"===f||"with"===f;break;case "}":d=!0,"function"===this.values[this.curly-3]?d=(f=this.values[this.curly-
4])?!this.beforeFunctionExpression(f):!1:"function"===this.values[this.curly-4]&&(d=(f=this.values[this.curly-5])?!this.beforeFunctionExpression(f):!0)}return d};n.prototype.push=function(f){7===f.type||4===f.type?("{"===f.value?this.curly=this.values.length:"("===f.value&&(this.paren=this.values.length),this.values.push(f.value)):this.values.push(null)};return n}();m=function(){function n(f,d){this.errorHandler=new D.ErrorHandler;this.errorHandler.tolerant=d?"boolean"===typeof d.tolerant&&d.tolerant:
!1;this.scanner=new y.Scanner(f,this.errorHandler);this.scanner.trackComment=d?"boolean"===typeof d.comment&&d.comment:!1;this.trackRange=d?"boolean"===typeof d.range&&d.range:!1;this.trackLoc=d?"boolean"===typeof d.loc&&d.loc:!1;this.buffer=[];this.reader=new q}n.prototype.errors=function(){return this.errorHandler.errors};n.prototype.getNextToken=function(){if(0===this.buffer.length){var f=this.scanner.scanComments();if(f)for(var d=0;d<f.length;++d){var e=f[d],b=this.scanner.source.slice(e.slice[0],
e.slice[1]);b={type:e.multiLine?"BlockComment":"LineComment",value:b};this.trackRange&&(b.range=e.range);this.trackLoc&&(b.loc=e.loc);this.buffer.push(b)}if(!this.scanner.eof()){f=null;this.trackLoc&&(f={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{line:0,column:0}});d=void 0;if("/"===this.scanner.source[this.scanner.index]&&this.reader.isRegexStart()){e=this.scanner.saveState();try{d=this.scanner.scanRegExp()}catch(c){this.scanner.restoreState(e),d=this.scanner.lex()}}else d=
this.scanner.lex();this.reader.push(d);e={type:r.TokenName[d.type],value:this.scanner.source.slice(d.start,d.end)};this.trackRange&&(e.range=[d.start,d.end]);this.trackLoc&&f&&(f.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},e.loc=f);9===d.type&&(e.regex={pattern:d.pattern,flags:d.flags});this.buffer.push(e)}}return this.buffer.shift()};return n}();a.Tokenizer=m})},"esri/arcadeProfiles/popupProfile":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../promiseList ../arcade/Feature ../support/expressionUtils ./utils".split(" "),
function(F,m,a,D,z,y,r,q){F=new (F(null,{declaredClass:"esri.arcadeProfiles.PopupProfile",defaults:{globals:{featureSet:["$layer","$datastore","$map","$aggregatedfeatures"],async:["$layer","$datastore","$map","$aggregatedfeatures"]},context:{vars:{$feature:"any",$layer:"any",$datastore:"any",$map:"any",$aggregatedfeatures:"any"}}},initialize:function(n){var f=[];q.hasGeometryOperations(n)&&f.push(r.enableGeometryOperations());(q.hasFeatureSetOperations(n)||q.hasVariables(n,this.defaults.globals.featureSet))&&
f.push(r.enableFeatureSetOperations());q.isAsync(n)&&f.push(r.enableAsyncOperations());return z(f)},isAsync:function(n){n=[n];return q.hasFeatureSetOperations(n)||q.hasVariables(n,this.defaults.globals.async)},parse:function(n){return r.createSyntaxTree(n.expression)},compile:function(n){var f=m.clone(this.defaults.context);f.useAsync=n.async;return n.syntaxTree?r.createFunction(n.syntaxTree,f):null},getEvalOptions:function(n){var f=n.expression,d=n.feature,e=n.layer,b=n.aggregatedFeaturesLayer,c=
n.map;n=n.spatialReference;d=d&&f.hasVariable("$feature")?y.createFromGraphicLikeObject(d.geometry,d.attributes,e):null;var h,g;if(e){var k={spatialReference:n};f.hasVariable("$layer")&&(h=e.getMap()?r.createFeatureSetFromLayer(e,k):r.createFeatureSetFromLayerUrl(e.url,k));if(f.hasVariable("$datastore"))var w=(w=q.getServiceUrl(e.url))?r.createFeatureSetCollectionFromServiceUrl(w,k):null;f.hasVariable("$aggregatedfeatures")&&b&&(g=b.getMap()?r.createFeatureSetFromLayer(b,k):null)}f=c&&f.hasVariable("$map")?
r.createFeatureSetCollectionFromMap(c):null;return{context:{vars:{$feature:d,$layer:h,$datastore:w,$map:f,$aggregatedfeatures:g},spatialReference:n}}}}));m.setObject("arcadeProfiles.popupProfile",F,D);return F})},"esri/arcadeProfiles/utils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../kernel","../support/expressionUtils"],function(F,m,a,D,z){var y=/(\/(MapServer|FeatureServer)).*/ig;a={hasGeometryOperations:function(r){return m.some(r,function(q){return q.hasGeometryOperations?
q.hasGeometryOperations():z.hasGeometryOperations(q)})},hasFeatureSetOperations:function(r){return m.some(r,function(q){return q.hasFeatureSetOperations?q.hasFeatureSetOperations():z.hasFeatureSetOperations(q)})},hasVariables:function(r,q){return m.some(r,function(n){return m.some(q,function(f){return n.hasVariable?n.hasVariable(f):z.hasVariable(n,f)})})},isAsync:function(r){return m.some(r,function(q){return q.async})},getServiceUrl:function(r){return y.test(r)?r.replace(y,"$1"):null}};F.setObject("arcadeProfiles.utils",
a,D);return a})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(F,m,a,D,z,y,r,q){F=F([y,r],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(n,f){m.mixin(this,f);this.initialize(n,f)},getTitle:function(n){var f;this.info&&(f=this.titleHasRelatedFields||this.titleHasAsyncExpressions?"":this._getPopupValues(n,
this._fetchAttributes(n,null,this.getExpressionFieldsInTitle()),!0).title);return f||""},getContent:function(n){return this.info?(new q({template:this,graphic:n,chartTheme:this.chartTheme},D.create("div"))).domNode:""}});m.setObject("dijit.PopupTemplate",F,z);return F})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style ../libs/sanitizer/Sanitizer dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x){var l=0,v=x.widgets.popup,A=x.widgets.templatePicker;m=m([u,g,k],{declaredClass:"esri.dijit._PopupRenderer",_sanitizer:new c({whiteList:{span:["class"],dd:[],dl:[],dt:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],sub:[],sup:[],animate:[],animatetransform:[],circle:[],clippath:[],defs:[],ellipse:[],g:[],image:[],line:[],lineargradient:[],marker:[],mask:[],path:[],pattern:[],polygon:[],polyline:[],radialgradient:[],rect:[],stop:[],svg:[],"switch":[],symbol:[],
text:[],textpath:[],tspan:[],use:[]}},!0),constructor:function(){this._nls=D.mixin({},v)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'statusSection hidden' dojoAttachPoint\x3d'_status'\x3e\x3c/div\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this._showStatus(A.loading);this._contentDfd=this.template.getComponents(this.graphic).then(D.hitch(this,this._handleComponentsSuccess)).otherwise(D.hitch(this,this._handleComponentsError))},destroy:function(){this._contentDfd&&this._contentDfd.cancel();this._attachmentsDfd&&this._attachmentsDfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._contentDfd=this._attachmentsDfd=null;this.inherited(arguments)},
_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var B=this._mediaInfos,E=B.length,G=this.domNode,I=this._prevMedia,L=this._nextMedia;if(1<E){var K=0,ba=0;z.forEach(B,function(T){"image"===T.type?K++:-1!==T.type.indexOf("chart")&&ba++});K&&(f.set(this._imageCount,"innerHTML",K),y.query(".summary .image",
G).removeClass("hidden"));ba&&(f.set(this._chartCount,"innerHTML",ba),y.query(".summary .chart",G).removeClass("hidden"))}else y.query(".summary",G).addClass("hidden"),d.add(I,"hidden"),d.add(L,"hidden");B=this._mediaPtr;0===B?d.add(I,"hidden"):d.remove(I,"hidden");B===E-1?d.add(L,"hidden"):d.remove(L,"hidden");this._destroyFrame()},_displayMedia:function(){var B=this._mediaInfos[this._mediaPtr],E=B.title,G=B.caption,I=y.query(".mediaSection .hzLine",this.domNode)[0];f.set(this._mediaTitle,"innerHTML",
this._sanitizer.sanitize(E));d[E?"remove":"add"](this._mediaTitle,"hidden");f.set(this._mediaCaption,"innerHTML",this._sanitizer.sanitize(G));d[G?"remove":"add"](this._mediaCaption,"hidden");d[E&&G?"remove":"add"](I,"hidden");this._rid=null;if("image"===B.type)this._showImage(B);else{var L=this;E=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"];G=B.value.theme||this.chartTheme;D.isString(G)&&(G=G.replace(/\./gi,"/"),-1===G.indexOf("/")&&(G="dojox/charting/themes/"+G));G||(G="./Rainbow");
E.push(G);try{var K=this._rid=l++;F(E,function(ba,T,P){K===L._rid&&(L._rid=null,L._showChart(B.type,B.value,ba,T,P))})}catch(ba){}}},_preventNewTab:function(B){return(B=B&&D.trim(B).toLowerCase())&&(0===B.indexOf("mailto:")||0===B.indexOf("tel:"))},_showImage:function(B){d.add(this._mediaFrame,"image");var E=b.get(this._gallery,"height"),G=B.value,I=h.decode(G.linkURL);G=h.decode(G.sourceURL);var L;I&&(L=e.create("a",{href:I,target:this._preventNewTab(I)?"":"_blank"},this._mediaFrame));I=B.refreshInterval?
this._addURLParameter(G,"timestamp",Date.now()):G;e.create("img",{className:"esriPopupMediaImage",src:I},L||this._mediaFrame);var K=y.query(".esriPopupMediaImage",this._mediaFrame)[0];this._imageLoadHandle=a.connect(K,"onload",this,function(){this._clearImageHandles();this._imageLoaded(K,E);this._initImageRefresh(B)})},_addURLParameter:function(B,E,G){var I=-1===B.indexOf("?")?"?":"\x26";return B+I+E+"\x3d"+G},_initImageRefresh:function(B){if(B.refreshInterval){var E=6E4*B.refreshInterval;this._imageRefreshHandle=
setTimeout(D.hitch(this,function(){this._destroyFrame();this._showImage(B)}),E)}},_clearImageHandles:function(){a.disconnect(this._imageLoadHandle);this._imageLoadHandle=null;clearTimeout(this._imageRefreshHandle);this._imageRefreshHandle=null},_showChart:function(B,E,G,I,L){d.remove(this._mediaFrame,"image");G=this._chart=new G(e.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});L&&G.setTheme(L);switch(B){case "piechart":G.addPlot("default",{type:"Pie",labels:!1});G.addSeries("Series A",
E.fields);break;case "linechart":G.addPlot("default",{type:"Markers"});G.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});G.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});z.forEach(E.fields,function(K,ba){K.x=ba+1});G.addSeries("Series A",E.fields);break;case "columnchart":G.addPlot("default",{type:"Columns",gap:3});G.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});G.addSeries("Series A",E.fields);break;case "barchart":G.addPlot("default",{type:"Bars",
gap:3}),G.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),G.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),G.addSeries("Series A",E.fields)}this._action=new I(G);G.render()},_destroyFrame:function(){this._rid=null;this._clearImageHandles();this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);f.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(B,E){var G=B.height;G<E&&b.set(B,"marginTop",
Math.round((E-G)/2)+"px")},_attListHandler:function(B,E){if(B===this._attachmentsDfd){this._attachmentsDfd=null;var G="";E instanceof Error||!E||!E.length||z.forEach(E,function(I){G+="\x3cli\x3e";G+="\x3ca href\x3d'"+C.addProxy(I.url)+"' target\x3d'_blank'\x3e"+(I.name||"[No name]")+"\x3c/a\x3e";G+="\x3c/li\x3e"});f.set(this._attachmentsList,"innerHTML",G||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_createLinkIfURI:function(B,E){var G=C.getURIInfo(B);if(G){var I=B.match(G.pattern),L=I&&
I[2];I=h.decode(I[1]);e.create("a",{target:"_blank",href:I,title:I,innerHTML:this._sanitizer.sanitize(t.substitute({appName:G.appName,hierPart:L},G.label))},E)}else f.set(E,"innerHTML",this._sanitizer.sanitize(B))},_showStatus:function(B){f.set(this._status,"innerHTML",B);d.remove(this._status,"hidden");y.query(".mainSection",this.domNode).addClass("hidden")},_hideStatus:function(){f.set(this._status,"innerHTML","");d.add(this._status,"hidden");y.query(".mainSection",this.domNode).removeClass("hidden")},
_handleComponentsSuccess:function(B){if(B){this._hideStatus();var E=this.showTitle?B.title:"",G=B.description,I=B.fields,L=B.mediaInfos,K=this.domNode,ba=this._nls,T=this,P=this.template,J=this.graphic;this._prevMedia.title=ba.NLS_prevMedia;this._nextMedia.title=ba.NLS_nextMedia;f.set(this._title,"innerHTML",this._sanitizer.sanitize(E));E||d.add(this._title,"hidden");if(!B.hasDescription&&I&&(G="",I=z.map(I,function(Z){var Y=e.create("tr",{vAlign:"top"});e.create("td",{className:"attrName",innerHTML:this._sanitizer.sanitize(Z[0])},
Y);var qa=e.create("td",{className:"attrValue"},Y);this._createLinkIfURI(Z[1],qa);return Y},this),I.length)){var N=e.create("table",{className:"attrTable",cellPadding:"0px",cellSpacing:"0px"});z.forEach(I,function(Z){N.appendChild(Z)})}N?(this._description.appendChild(N),G=!0):f.set(this._description,"innerHTML",this._sanitizer.sanitize(G));G||d.add(this._description,"hidden");y.query("a",this._description).forEach(function(Z){T._preventNewTab(Z.href)?"_blank"===Z.target&&f.remove(Z,"target"):f.set(Z,
"target","_blank")});E&&G?y.query(".mainSection .hzLine",K).removeClass("hidden"):E||G?y.query(".mainSection .hzLine",K).addClass("hidden"):y.query(".mainSection",K).addClass("hidden");if(E=this._attachmentsDfd=P.getAttachments(J))E.addBoth(D.hitch(this,this._attListHandler,E)),f.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+ba.NLS_searching+"...\x3c/li\x3e"),y.query(".attachmentsSection",K).removeClass("hidden");L&&L.length&&(y.query(".mediaSection",K).removeClass("hidden"),n.setSelectable(this._mediaFrame,
!1),this._mediaInfos=L,this._mediaPtr=0,this._updateUI(),this._displayMedia());B.editSummary&&(f.set(this._editSummary,"innerHTML",this._sanitizer.sanitize(B.editSummary)),L&&L.length&&d.remove(this._mediaBreak,"hidden"),d.remove(this._editSummarySection,"hidden"));this.emit("content-update")}else this._showStatus(v.NLS_noInfo)},_handleComponentsError:function(B){B&&"cancel"===B.dojoType||this._showStatus(v.NLS_noInfo)}});D.setObject("dijit._PopupRenderer",m,w);return m})},"esri/libs/sanitizer/Sanitizer":function(){!function(F,
m){"object"==typeof exports&&"undefined"!=typeof module?module.exports=m():"function"==typeof define&&define.amd?define(m):(F="undefined"!=typeof globalThis?globalThis:F||self).Sanitizer=m()}(this,function(){function F(){return{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,
"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,
"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,
"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,
"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,"float":!1,"float-offset":!1,"flood-color":!1,
"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,
"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,
"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,
"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,
"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,
"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,
"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,
"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1}}function m(ia){var ea=ia||{},za={},Ca;for(Ca in ea)za[Ca]=ea[Ca];(ia=za).whiteList=ia.whiteList||I.whiteList;ia.onAttr=ia.onAttr||I.onAttr;ia.onIgnoreAttr=ia.onIgnoreAttr||I.onIgnoreAttr;ia.safeAttrValue=ia.safeAttrValue||I.safeAttrValue;this.options=ia}function a(ia){return ia.replace(J,
"\x26lt;").replace(N,"\x26gt;")}function D(ia){return ia.replace(Z,"\x26quot;")}function z(ia){return ia.replace(Y,'"')}function y(ia){return ia.replace(qa,function(ea,za){return"x"===za[0]||"X"===za[0]?String.fromCharCode(parseInt(za.substr(1),16)):String.fromCharCode(parseInt(za,10))})}function r(ia){return ia.replace(V,":").replace(na," ")}function q(ia){for(var ea="",za=0,Ca=ia.length;za<Ca;za++)ea+=32>ia.charCodeAt(za)?" ":ia.charAt(za);return T.trim(ea)}function n(ia){return ia=q(ia=r(ia=y(ia=
z(ia))))}function f(ia){return ia=a(ia=D(ia))}function d(ia,ea){for(;ea<ia.length;ea++){var za=ia[ea];if(" "!==za)return"\x3d"===za?ea:-1}}function e(ia,ea){for(;0<ea;ea--){var za=ia[ea];if(" "!==za)return"\x3d"===za?ea:-1}}function b(ia){return'"'===ia[0]&&'"'===ia[ia.length-1]||"'"===ia[0]&&"'"===ia[ia.length-1]?ia.substr(1,ia.length-2):ia}function c(ia){var ea=ia||{},za={},Ca;for(Ca in ea)za[Ca]=ea[Ca];(ia=za).stripIgnoreTag&&(ia.onIgnoreTag=xa.onIgnoreTagStripAll);ia.whiteList=ia.whiteList||xa.whiteList;
ia.onTag=ia.onTag||xa.onTag;ia.onTagAttr=ia.onTagAttr||xa.onTagAttr;ia.onIgnoreTag=ia.onIgnoreTag||xa.onIgnoreTag;ia.onIgnoreTagAttr=ia.onIgnoreTagAttr||xa.onIgnoreTagAttr;ia.safeAttrValue=ia.safeAttrValue||xa.safeAttrValue;ia.escapeHtml=ia.escapeHtml||xa.escapeHtml;this.options=ia;!1===ia.css?this.cssFilter=!1:(ia.css=ia.css||{},this.cssFilter=new oa(ia.css))}var h,g,k=Object.prototype,w=Function.prototype.toString,t=k.hasOwnProperty,C=w.call(Object),u=k.toString,x=(h=Object.getPrototypeOf,g=Object,
function(ia){return h(g(ia))}),l=function(ia){var ea;if(!(ea=!ia||"object"!=typeof ia||"[object Object]"!=u.call(ia))&&(ea=!1,null!=ia&&"function"!=typeof ia.toString))try{ea=!!(ia+"")}catch(za){}if(ea)return!1;ia=x(ia);if(null===ia)return!0;ia=t.call(ia,"constructor")&&ia.constructor;return"function"==typeof ia&&ia instanceof ia&&w.call(ia)==C},v={exports:{}},A={};k={exports:{}};var B={},E=/javascript\s*:/gim;B.whiteList=F();B.getDefaultWhiteList=F;B.onAttr=function(ia,ea,za){};B.onIgnoreAttr=function(ia,
ea,za){};B.safeAttrValue=function(ia,ea){return E.test(ea)?"":ea};var G={indexOf:function(ia,ea){var za;if(Array.prototype.indexOf)return ia.indexOf(ea);var Ca=0;for(za=ia.length;Ca<za;Ca++)if(ia[Ca]===ea)return Ca;return-1},forEach:function(ia,ea,za){var Ca;if(Array.prototype.forEach)return ia.forEach(ea,za);var Da=0;for(Ca=ia.length;Da<Ca;Da++)ea.call(za,ia[Da],Da,ia)},trim:function(ia){return String.prototype.trim?ia.trim():ia.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(ia){return String.prototype.trimRight?
ia.trimRight():ia.replace(/(\s*$)/g,"")}},I=B,L=function(ia,ea){function za(){if(!Da){var La=G.trim(ia.slice(ka,ta)),aa=La.indexOf(":");if(-1!==aa){var Ya=G.trim(La.slice(0,aa));aa=G.trim(La.slice(aa+1));Ya&&(La=ea(ka,M.length,Ya,aa,La))&&(M+=La+"; ")}}ka=ta+1}";"!==(ia=G.trimRight(ia))[ia.length-1]&&(ia+=";");for(var Ca=ia.length,Da=!1,ka=0,ta=0,M="";ta<Ca;ta++){var Ga=ia[ta];if("/"===Ga&&"*"===ia[ta+1]){Ga=ia.indexOf("*/",ta+2);if(-1===Ga)break;ka=(ta=Ga+1)+1;Da=!1}else"("===Ga?Da=!0:")"===Ga?Da=
!1:";"===Ga?Da||za():"\n"===Ga&&za()}return G.trim(M)};m.prototype.process=function(ia){if(!(ia=(ia=ia||"").toString()))return"";var ea=this.options,za=ea.whiteList,Ca=ea.onAttr,Da=ea.onIgnoreAttr,ka=ea.safeAttrValue;return L(ia,function(ta,M,Ga,La,aa){var Ya=za[Ga],Wa=!1;if(!0===Ya?Wa=Ya:"function"==typeof Ya?Wa=Ya(La):Ya instanceof RegExp&&(Wa=Ya.test(La)),!0!==Wa&&(Wa=!1),La=ka(Ga,La)){var Ea;ta={position:M,sourcePosition:ta,source:aa,isWhite:Wa};return Wa?null==(Ea=Ca(Ga,La,ta))?Ga+":"+La:Ea:
null==(Ea=Da(Ga,La,ta))?void 0:Ea}})};!function(ia,ea){for(var za in(ea=ia.exports=function(Ca,Da){return(new m(Da)).process(Ca)}).FilterCSS=m,B)ea[za]=B[za]}(k,k.exports);var K={indexOf:function(ia,ea){var za;if(Array.prototype.indexOf)return ia.indexOf(ea);var Ca=0;for(za=ia.length;Ca<za;Ca++)if(ia[Ca]===ea)return Ca;return-1},forEach:function(ia,ea,za){var Ca;if(Array.prototype.forEach)return ia.forEach(ea,za);var Da=0;for(Ca=ia.length;Da<Ca;Da++)ea.call(za,ia[Da],Da,ia)},trim:function(ia){return String.prototype.trim?
ia.trim():ia.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(ia){return(ia=/\s|\n|\t/.exec(ia))?ia.index:-1}},ba=k.exports.getDefaultWhiteList,T=K,P=new k.exports.FilterCSS,J=/</g,N=/>/g,Z=/"/g,Y=/&quot;/g,qa=/&#([a-zA-Z0-9]*);?/gim,V=/&colon;?/gim,na=/&newline;?/gim,ya=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,S=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,ma=/u\s*r\s*l\s*\(.*/gi;A.whiteList={a:["target","href","title"],abbr:["title"],address:[],
area:["shape","coords","href","alt"],article:[],aside:[],audio:"autoplay controls crossorigin loop muted preload src".split(" "),b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src",
"alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:"autoplay controls crossorigin loop muted playsinline poster preload src height width".split(" ")};
A.getDefaultWhiteList=function(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:"autoplay controls crossorigin loop muted preload src".split(" "),b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color",
"size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],
tt:[],u:[],ul:[],video:"autoplay controls crossorigin loop muted playsinline poster preload src height width".split(" ")}};A.onTag=function(ia,ea,za){};A.onIgnoreTag=function(ia,ea,za){};A.onTagAttr=function(ia,ea,za){};A.onIgnoreTagAttr=function(ia,ea,za){};A.safeAttrValue=function(ia,ea,za,Ca){if(za=n(za),"href"===ea||"src"===ea){if("#"===(za=T.trim(za)))return"#";if("http://"!==za.substr(0,7)&&"https://"!==za.substr(0,8)&&"mailto:"!==za.substr(0,7)&&"tel:"!==za.substr(0,4)&&"data:image/"!==za.substr(0,
11)&&"ftp://"!==za.substr(0,6)&&"./"!==za.substr(0,2)&&"../"!==za.substr(0,3)&&"#"!==za[0]&&"/"!==za[0])return""}else if("background"===ea){if(ya.lastIndex=0,ya.test(za))return""}else if("style"===ea){if((S.lastIndex=0,S.test(za))||(ma.lastIndex=0,ma.test(za)&&(ya.lastIndex=0,ya.test(za))))return"";!1!==Ca&&(za=(Ca=Ca||P).process(za))}return za=f(za)};A.escapeHtml=a;A.escapeQuote=D;A.unescapeQuote=z;A.escapeHtmlEntities=y;A.escapeDangerHtml5Entities=r;A.clearNonPrintableCharacter=q;A.friendlyAttrValue=
n;A.escapeAttrValue=f;A.onIgnoreTagStripAll=function(){return""};A.StripTagBody=function(ia,ea){"function"!=typeof ea&&(ea=function(){});var za=!Array.isArray(ia),Ca=[],Da=!1;return{onIgnoreTag:function(ka,ta,M){return za||-1!==T.indexOf(ia,ka)?M.isClosing?(Ca.push([!1!==Da?Da:M.position,M.position+10]),Da=!1,"[/removed]"):(Da||(Da=M.position),"[removed]"):ea(ka,ta,M)},remove:function(ka){var ta="",M=0;return T.forEach(Ca,function(Ga){ta+=ka.slice(M,Ga[0]);M=Ga[1]}),ta+=ka.slice(M)}}};A.stripCommentTag=
function(ia){for(var ea="",za=0;za<ia.length;){var Ca=ia.indexOf("\x3c!--",za);if(-1===Ca){ea+=ia.slice(za);break}ea+=ia.slice(za,Ca);za=ia.indexOf("--\x3e",Ca);if(-1===za)break;za+=3}return ea};A.stripBlankChar=function(ia){ia=ia.split("");return(ia=ia.filter(function(ea){ea=ea.charCodeAt(0);return 127!==ea&&(!(31>=ea)||10===ea||13===ea)})).join("")};A.cssFilter=P;A.getDefaultCSSWhiteList=ba;var ja={},X=/[^a-zA-Z0-9_:\.\-]/gim;ja.parseTag=function(ia,ea,za){var Ca="",Da=0,ka=!1,ta=!1,M=0,Ga=ia.length,
La="",aa="";M=0;a:for(;M<Ga;M++)if(aa=ia.charAt(M),!1===ka)"\x3c"===aa&&(ka=M);else if(!1===ta)if("\x3c"===aa)Ca+=za(ia.slice(Da,M)),Da=ka=M;else if("\x3e"===aa)Ca+=za(ia.slice(Da,ka)),Da=aa=ia.slice(ka,M+1),La=K.spaceIndex(Da),Da=-1===La?Da.slice(1,-1):Da.slice(1,La+1),La=("/"===(Da=K.trim(Da).toLowerCase()).slice(0,1)&&(Da=Da.slice(1)),"/"===Da.slice(-1)&&(Da=Da.slice(0,-1)),Da),Ca+=ea(ka,Ca.length,La,aa,"\x3c/"===aa.slice(0,2)),Da=M+1,ka=!1;else{if('"'===aa||"'"===aa){La=1;for(var Ya=ia.charAt(M-
La);""===Ya.trim()||"\x3d"===Ya;){if("\x3d"===Ya){ta=aa;continue a}Ya=ia.charAt(M-++La)}}}else aa===ta&&(ta=!1);return Da<ia.length&&(Ca+=za(ia.substr(Da))),Ca};ja.parseAttr=function(ia,ea){function za(La,aa){if(!(1>(La=(La=K.trim(La)).replace(X,"").toLowerCase()).length)){var Ya=ea(La,aa||"");Ya&&Da.push(Ya)}}for(var Ca=0,Da=[],ka=!1,ta=ia.length,M=0;M<ta;M++){var Ga=ia.charAt(M);if(!1!==ka||"\x3d"!==Ga)if(!1===ka||M!==Ca||'"'!==Ga&&"'"!==Ga||"\x3d"!==ia.charAt(M-1))/\s|\n|\t/.test(Ga)&&((ia=ia.replace(/\s|\n|\t/g,
" "),!1===ka)?-1===(Ga=d(ia,M))?(za(K.trim(ia.slice(Ca,M))),ka=!1,Ca=M+1):M=Ga-1:-1===(Ga=e(ia,M-1))&&(za(ka,b(K.trim(ia.slice(Ca,M)))),ka=!1,Ca=M+1));else{if(-1===(Ga=ia.indexOf(Ga,M+1)))break;za(ka,K.trim(ia.slice(Ca+1,Ga)));ka=!1;Ca=(M=Ga)+1}else ka=ia.slice(Ca,M),Ca=M+1}return Ca<ia.length&&(!1===ka?za(ia.slice(Ca)):za(ka,b(K.trim(ia.slice(Ca))))),K.trim(Da.join(" "))};var oa=k.exports.FilterCSS,xa=A,Ha=ja.parseTag,Ia=ja.parseAttr;c.prototype.process=function(ia){if(!(ia=(ia=ia||"").toString()))return"";
var ea=this.options,za=ea.whiteList,Ca=ea.onTag,Da=ea.onIgnoreTag,ka=ea.onTagAttr,ta=ea.onIgnoreTagAttr,M=ea.safeAttrValue,Ga=ea.escapeHtml,La=this.cssFilter;ea.stripBlankChar&&(ia=xa.stripBlankChar(ia));ea.allowCommentTag||(ia=xa.stripCommentTag(ia));var aa=!1;ea.stripIgnoreTagBody&&(aa=xa.StripTagBody(ea.stripIgnoreTagBody,Da),Da=aa.onIgnoreTag);ia=Ha(ia,function(Ya,Wa,Ea,U,fa){Wa={sourcePosition:Ya,position:Wa,isClosing:fa,isWhite:za.hasOwnProperty(Ea)};if(null!=(Ya=Ca(Ea,U,Wa)))return Ya;if(Wa.isWhite){if(Wa.isClosing)return"\x3c/"+
Ea+"\x3e";Ya=function(O){var ca=K.spaceIndex(O);if(-1===ca)return{html:"",closing:"/"===O[O.length-2]};ca="/"===(O=K.trim(O.slice(ca+1,-1)))[O.length-1];return ca&&(O=K.trim(O.slice(0,-1))),{html:O,closing:ca}}(U);var sa=za[Ea];Wa=Ia(Ya.html,function(O,ca){var va,H=-1!==K.indexOf(sa,O);return null==(va=ka(Ea,O,ca,H))?H?(ca=M(Ea,O,ca,La))?O+'\x3d"'+ca+'"':O:null==(va=ta(Ea,O,ca,H))?void 0:va:va});U="\x3c"+Ea;return Wa&&(U+=" "+Wa),Ya.closing&&(U+=" /"),U+="\x3e"}return null==(Ya=Da(Ea,U,Wa))?Ga(U):
Ya},Ga);return aa&&(ia=aa.remove(ia)),ia};return function(ia,ea){function za(ka,ta){return(new Ca(ta)).process(ka)}var Ca=c,Da;for(Da in(ea=ia.exports=za).filterXSS=za,ea.FilterXSS=Ca,A)ea[Da]=A[Da];for(Da in ja)ea[Da]=ja[Da];"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=ia.exports)}(v,v.exports),function(){function ia(ea,za){var Ca,Da=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay",
"controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:"alt border height src style width".split(" "),li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:"border cellpadding cellspacing height style width".split(" "),
tbody:[],tr:["align","height","style","valign"],td:"align colspan height nowrap rowspan style valign width".split(" "),th:"align colspan height nowrap rowspan style valign width".split(" "),u:[],ul:[],video:"autoplay controls height loop muted poster preload width".split(" ")};this.allowedProtocols="http https mailto iform tel flow lfmobile arcgis-navigator arcgis-appstudio-player arcgis-survey123 arcgis-collector arcgis-workforce arcgis-explorer arcgis-trek2there arcgis-quickcapture mspbi comgooglemaps pdfefile pdfehttp pdfehttps boxapp boxemm awb awbs gropen radarscope".split(" ");
this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(ka,ta,M,Ga){return"a"===ka&&"href"===ta||("img"===ka||"source"===ka)&&"src"===ta?Da.sanitizeUrl(M):v.exports.safeAttrValue(ka,ta,M,Ga)}};ea&&!za?Ca=ea:ea&&za?(Ca=Object.create(this.arcgisFilterOptions),Object.keys(ea).forEach(function(ka){"whiteList"===ka?Ca.whiteList=Da._extendObjectOfArrays([Da.arcgisWhiteList,ea.whiteList||{}]):Ca[ka]=ea[ka]})):(Ca=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList;this.xssFilterOptions=
Ca;this._xssFilter=new v.exports.FilterXSS(Ca)}return ia.prototype.sanitize=function(ea,za){switch(void 0===za&&(za={}),typeof ea){case "number":return isNaN(ea)||!isFinite(ea)?null:ea;case "boolean":return ea;case "string":return this._xssFilter.process(ea);case "object":return this._iterateOverObject(ea,za);default:if(!za.allowUndefined||void 0!==ea)return null}},ia.prototype.sanitizeUrl=function(ea){var za=this._trim(ea.substring(0,ea.indexOf(":")));return"/"===ea||"#"===ea||"#"===ea[0]||-1<this.allowedProtocols.indexOf(za.toLowerCase())?
v.exports.escapeAttrValue(ea):""},ia.prototype.sanitizeHTMLAttribute=function(ea,za,Ca,Da){return"function"==typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(ea,za,Ca,Da):v.exports.safeAttrValue(ea,za,Ca,Da)},ia.prototype.validate=function(ea,za){void 0===za&&(za={});var Ca=this.sanitize(ea,za);return{isValid:ea===Ca,sanitized:Ca}},ia.prototype._extendObjectOfArrays=function(ea){var za={};return ea.forEach(function(Ca){Object.keys(Ca).forEach(function(Da){Array.isArray(Ca[Da])&&
Array.isArray(za[Da])?za[Da]=za[Da].concat(Ca[Da]):za[Da]=Ca[Da]})}),za},ia.prototype._iterateOverObject=function(ea,za){var Ca=this;void 0===za&&(za={});try{var Da=!1,ka=void 0;if(Array.isArray(ea))ka=ea.reduce(function(ta,M){var Ga=Ca.validate(M,za);return Ga.isValid?ta.concat([M]):(Da=!0,ta.concat([Ga.sanitized]))},[]);else{if(!l(ea))return za.allowUndefined&&void 0===ea?void 0:null;ka=Object.keys(ea).reduce(function(ta,M){var Ga=ea[M],La=Ca.validate(Ga,za);return La.isValid?ta[M]=Ga:(Da=!0,ta[M]=
La.sanitized),ta},{})}return Da?ka:ea}catch(ta){return null}},ia.prototype._trim=function(ea){return String.prototype.trim?ea.trim():ea.replace(/(^\s*)|(\s*$)/g,"")},ia}()})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(F,m,a,D,z,y,r){y.extend(F,{waiRole:"",waiState:""});return z("dijit._Templated",[m,a],{constructor:function(){r.deprecated(this.declaredClass+
": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},_processNode:function(q,n){var f=this.inherited(arguments),d=n(q,"waiRole");d&&q.setAttribute("role",d);(d=n(q,"waiState"))&&D.forEach(d.split(/\s*,\s*/),function(e){-1!=e.indexOf("-")&&(e=e.split("-"),q.setAttribute("aria-"+e[0],e[1]))});return f}})})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],
function(F,m,a,D,z){return a("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var y=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);z.parse(y,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(D.hitch(this,
function(r){this._startupWidgets=r;for(var q=0;q<r.length;q++)this._processTemplateNode(r[q],function(n,f){return n[f]},function(n,f,d){return f in n?n.connect(n,f,d):n.on(f,d,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");
}},_processTemplateNode:function(y,r,q){return r(y,"dojoType")||r(y,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){F.forEach(this._startupWidgets,function(y){y&&!y._started&&y.startup&&y.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(F,
m,a,D,z,y,r,q,n,f,d,e,b,c,h,g){function k(x){return eval("("+x+")")}function w(x){var l=x._nameCaseMap,v=x.prototype;if(!l||l._extendCnt<C){l=x._nameCaseMap={};for(var A in v)"_"!==A.charAt(0)&&(l[A.toLowerCase()]=A);l._extendCnt=C}return l}function t(x,l){l||(l=F);var v=l._dojoParserCtorMap||(l._dojoParserCtorMap={}),A=x.join();if(!v[A]){for(var B=[],E=0,G=x.length;E<G;E++){var I=x[E];B[B.length]=v[I]=v[I]||a.getObject(I)||~I.indexOf("/")&&l(I)}E=B.shift();v[A]=B.length?E.createSubclass?E.createSubclass(B):
E.extend.apply(E,B):E}return v[A]}new Date("X");var C=0;n.after(a,"extend",function(){C++},!0);var u={_clearCache:function(){C++;_ctorMap={}},_functionFromScript:function(x,l){var v="",A="",B=x.getAttribute(l+"args")||x.getAttribute("args"),E=x.getAttribute("with");B=(B||"").split(/\s*,\s*/);E&&E.length&&D.forEach(E.split(/\s*,\s*/),function(G){v+="with("+G+"){";A+="}"});return new Function(B,v+x.innerHTML+A)},instantiate:function(x,l,v){l=l||{};v=v||{};var A=(v.scope||m._scopeName)+"Type",B="data-"+
(v.scope||m._scopeName)+"-",E=B+"type",G=B+"mixins",I=[];D.forEach(x,function(L){var K=A in l?l[A]:L.getAttribute(E)||L.getAttribute(A);if(K){var ba=L.getAttribute(G);K=ba?[K].concat(ba.split(/\s*,\s*/)):[K];I.push({node:L,types:K})}});return this._instantiate(I,l,v)},_instantiate:function(x,l,v,A){function B(E){l._started||v.noStart||D.forEach(E,function(G){"function"!==typeof G.startup||G._started||G.startup()});return E}x=D.map(x,function(E){var G=E.ctor||t(E.types,v.contextRequire);if(!G)throw Error("Unable to resolve constructor for: '"+
E.types.join()+"'");return this.construct(G,E.node,l,v,E.scripts,E.inherited)},this);return A?f(x).then(B):B(x)},construct:function(x,l,v,A,B,E){function G(ma){N&&a.setObject(N,ma);for(P=0;P<V.length;P++)n[V[P].advice||"after"](ma,V[P].method,a.hitch(ma,V[P].func),!0);for(P=0;P<na.length;P++)na[P].call(ma);for(P=0;P<ya.length;P++)ma.watch(ya[P].prop,ya[P].func);for(P=0;P<S.length;P++)h(ma,S[P].event,S[P].func);return ma}var I=x&&x.prototype;A=A||{};var L={};A.defaults&&a.mixin(L,A.defaults);E&&a.mixin(L,
E);if(b("dom-attributes-explicit"))var K=l.attributes;else b("dom-attributes-specified-flag")?K=D.filter(l.attributes,function(ma){return ma.specified}):(E=(/^input$|^img$/i.test(l.nodeName)?l:l.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),K=D.map(E.split(/\s+/),function(ma){var ja=ma.toLowerCase();return{name:ma,value:"LI"==l.nodeName&&"value"==ma||"enctype"==ja?l.getAttribute(ja):l.getAttributeNode(ja).value}}));var ba=
A.scope||m._scopeName;E="data-"+ba+"-";var T={};"dojo"!==ba&&(T[E+"props"]="data-dojo-props",T[E+"type"]="data-dojo-type",T[E+"mixins"]="data-dojo-mixins",T[ba+"type"]="dojotype",T[E+"id"]="data-dojo-id");var P=0,J;ba=[];for(var N,Z;J=K[P++];){var Y=J.name,qa=Y.toLowerCase();J=J.value;switch(T[qa]||qa){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":Z=J;break;case "data-dojo-id":case "jsid":N=J;break;case "data-dojo-attach-point":case "dojoattachpoint":L.dojoAttachPoint=
J;break;case "data-dojo-attach-event":case "dojoattachevent":L.dojoAttachEvent=J;break;case "class":L["class"]=l.className;break;case "style":L.style=l.style&&l.style.cssText;break;default:if(Y in I||(Y=w(x)[qa]||Y),Y in I)switch(typeof I[Y]){case "string":L[Y]=J;break;case "number":L[Y]=J.length?Number(J):NaN;break;case "boolean":L[Y]="false"!=J.toLowerCase();break;case "function":""===J||-1!=J.search(/[^\w\.]+/i)?L[Y]=new Function(J):L[Y]=a.getObject(J,!1)||new Function(J);ba.push(Y);break;default:qa=
I[Y],L[Y]=qa&&"length"in qa?J?J.split(/\s*,\s*/):[]:qa instanceof Date?""==J?new Date(""):"now"==J?new Date:d.fromISOString(J):qa instanceof q?m.baseUrl+J:k(J)}else L[Y]=J}}for(K=0;K<ba.length;K++)T=ba[K].toLowerCase(),l.removeAttribute(T),l[T]=null;if(Z)try{Z=k.call(A.propsThis,"{"+Z+"}"),a.mixin(L,Z)}catch(ma){throw Error(ma.toString()+" in data-dojo-props\x3d'"+Z+"'");}a.mixin(L,v);B||(B=x&&(x._noScript||I._noScript)?[]:c("\x3e script[type^\x3d'dojo/']",l));var V=[],na=[],ya=[],S=[];if(B)for(P=
0;P<B.length;P++)T=B[P],l.removeChild(T),v=T.getAttribute(E+"event")||T.getAttribute("event"),A=T.getAttribute(E+"prop"),Z=T.getAttribute(E+"method"),ba=T.getAttribute(E+"advice"),K=T.getAttribute("type"),T=this._functionFromScript(T,E),v?"dojo/connect"==K?V.push({method:v,func:T}):"dojo/on"==K?S.push({event:v,func:T}):L[v]=T:"dojo/aspect"==K?V.push({method:Z,advice:ba,func:T}):"dojo/watch"==K?ya.push({prop:A,func:T}):na.push(T);x=(B=x.markupFactory||I.markupFactory)?B(L,l,x):new x(L,l);return x.then?
x.then(G):G(x)},scan:function(x,l){function v(V){if(!V.inherited){V.inherited={};var na=V.node,ya=v(V.parent);na={dir:na.getAttribute("dir")||ya.dir,lang:na.getAttribute("lang")||ya.lang,textDir:na.getAttribute(K)||ya.textDir};for(var S in na)na[S]&&(V.inherited[S]=na[S])}return V.inherited}var A=[],B=[],E={},G=(l.scope||m._scopeName)+"Type",I="data-"+(l.scope||m._scopeName)+"-",L=I+"type",K=I+"textdir";I+="mixins";var ba=x.firstChild,T=l.inherited;if(!T){T=function S(na,ya){return na.getAttribute&&
na.getAttribute(ya)||na.parentNode&&S(na.parentNode,ya)};T={dir:T(x,"dir"),lang:T(x,"lang"),textDir:T(x,K)};for(var P in T)T[P]||delete T[P]}T={inherited:T};for(var J,N;;)if(ba)if(1!=ba.nodeType)ba=ba.nextSibling;else if(J&&"script"==ba.nodeName.toLowerCase())(Z=ba.getAttribute("type"))&&/^dojo\/\w/i.test(Z)&&J.push(ba),ba=ba.nextSibling;else if(N)ba=ba.nextSibling;else{var Z=ba.getAttribute(L)||ba.getAttribute(G);P=ba.firstChild;if(Z||P&&(3!=P.nodeType||P.nextSibling)){N=null;if(Z){var Y=ba.getAttribute(I);
J=Y?[Z].concat(Y.split(/\s*,\s*/)):[Z];try{N=t(J,l.contextRequire)}catch(V){}N||D.forEach(J,function(V){~V.indexOf("/")&&!E[V]&&(E[V]=!0,B[B.length]=V)});Y=N&&!N.prototype._noScript?[]:null;T={types:J,ctor:N,parent:T,node:ba,scripts:Y};T.inherited=v(T);A.push(T)}else T={node:ba,scripts:J,parent:T};J=Y;N=ba.stopParser||N&&N.prototype.stopParser&&!l.template;ba=P}else ba=ba.nextSibling}else{if(!T||!T.node)break;ba=T.node.nextSibling;N=!1;T=T.parent;J=T.scripts}var qa=new e;B.length?(l.contextRequire||
F)(B,function(){qa.resolve(D.filter(A,function(V){if(!V.ctor)try{V.ctor=t(V.types,l.contextRequire)}catch(S){}for(var na=V.parent;na&&!na.types;)na=na.parent;var ya=V.ctor&&V.ctor.prototype;V.instantiateChildren=!(ya&&ya.stopParser&&!l.template);V.instantiate=!na||na.instantiate&&na.instantiateChildren;return V.instantiate}))}):qa.resolve(A);return qa.promise},_require:function(x,l){var v=k("{"+x.innerHTML+"}"),A=[],B=[],E=new e,G=l&&l.contextRequire||F,I;for(I in v)A.push(I),B.push(v[I]);G(B,function(){for(var L=
0;L<A.length;L++)a.setObject(A[L],arguments[L]);E.resolve(arguments)});return E.promise},_scanAmd:function(x,l){var v=new e,A=v.promise;v.resolve(!0);var B=this;c("script[type\x3d'dojo/require']",x).forEach(function(E){A=A.then(function(){return B._require(E,l)});E.parentNode.removeChild(E)});return A},parse:function(x,l){!x||"string"==typeof x||"nodeType"in x||(l=x,x=l.rootNode);var v=x?y.byId(x):r.body();l=l||{};var A=l.template?{template:!0}:{},B=[],E=this,G=this._scanAmd(v,l).then(function(){return E.scan(v,
l)}).then(function(I){return E._instantiate(I,A,l,!0)}).then(function(I){return B=B.concat(I)}).otherwise(function(I){throw I;});a.mixin(B,G);return B}};m.parser=u;z.parseOnLoad&&g(100,u,"parse");return u})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(F,m,a,D,z,y){return F([y,z],{_onMap:function(r){var q=this.constructor._onMap;q&&q.FINAL||(delete this.constructor._onMap,q=this.registerConnectEvents(),
q.FINAL=!0);r=r.toLowerCase();if(q[r])var n=this[q[r].method];else r=this._onCamelCase(r),this[r]&&(n=r);return n},on:function(r,q){var n=this._onMap(r),f=r.replace(/\-/g,""),d="on"+f in this.domNode;return n||!d?this.inherited(arguments):this.own(D(this.domNode,f,q))[0]},emit:function(r,q,n){var f,d=r.toLowerCase(),e=this.constructor._onMap||this.registerConnectEvents();var b=this[this._onMap(d)];q=q||{};q.target||(q.target=this);if(b&&e&&e[d]){this._onObj2Arr(function(){f=Array.prototype.slice.call(arguments)},
e[d].argKeys)(q);var c=m.mixin({},arguments);c[2]=f;c[0]=e[d].name.replace(/^on/,"")}return this.inherited(c||arguments)}})})},"esri/plugins/popupManager":function(){define(["../PopupManager"],function(F){return{add:function(m,a){m.popupManager||(m.popupManager=new F(a),m.popupManager.setMap(m))},remove:function(m){var a=m.popupManager;a&&(a.unsetMap(),m.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang esri/sniff dojo/on dojo/promise/all dojo/Stateful require".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h){var g;q=q(c,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},constructor:function(k){this._mapClickHandler=f.hitch(this,this._mapClickHandler)},setMap:function(k){if(this.map)if(k!==this.map)this.unsetMap();else return;this.map=k;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(k){var w;
if(k&&(w=k.getLayer())&&(k=w.id,this._featureLayersCache[k])){var t=k.lastIndexOf("_");-1<t&&(k=k.substring(0,t),w=this.map.getLayer(k))}return w},_enabledSetter:function(k){this.enabled=k;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(k){var w=this.map.infoWindow,t=k.graphic;w&&this.map.loaded&&
(w.clearFeatures&&w.setFeatures?this._showPopup(k):t&&t.getInfoTemplate()&&this._showInfoWindow(t,k.mapPoint))},_showPopup:function(k){var w=this.map,t=w.infoWindow,C=this,u=[],x=[w.graphics].concat(r.map(w.graphicsLayerIds,w.getLayer,w));r.forEach(x,function(A){var B=A.getFeatureReduction&&A.getFeatureReduction();A&&A.loaded&&A.infoTemplate&&!A.suspended&&(!B||!C._isReductionEnabled(A)||B.infoTemplate&&!B.disablePopup)&&u.push(A)});var l=[];r.forEach(w.layerIds,function(A){(A=w.getLayer(A))&&A.loaded&&
!A.suspended&&(C._isImageServiceLayer(A)&&A.infoTemplate?u.push(A):"esri.layers.WMSLayer"===A.declaredClass&&A.getFeatureInfoURL?u.push(A):"esri.layers.ArcGISDynamicMapServiceLayer"!==A.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==A.declaredClass||!A.infoTemplates||l.push(A))});var v=w.getResolutionForPopup();this._getSubLayerFeatureLayers(l,v).then(function(A){u=u.concat(A);A=k.graphic&&k.graphic.getParentGraphic()||k.graphic;var B=null;A&&A.getInfoTemplate()&&!C._isImageServiceLayer(A.getLayer())&&
(B=A);if(u.length||B){var E=C._calculateClickTolerance(u),G=k.screenPoint;A=w.toMap(new m(G.x-E,G.y+E));E=w.toMap(new m(G.x+E,G.y-E));var I=new F(A.x,A.y,E.x,E.y,w.spatialReference);if(I=I.intersects(w.extent)){var L=new z,K=!!B,ba=!0;A=r.map(u,function(T){L.timeExtent=T.useMapTime?w.timeExtent:null;var P=C._isReductionEnabled(T);T=P?T.getFeatureReductionLayer():T;var J=C._featureLayersCache[T.id];if(C._isImageServiceLayer(T)){L.geometry=k.mapPoint;ba=!1;var N={rasterAttributeTableFieldPrefix:"Raster.",
returnDomainValues:!0};C._isTiledImageServiceLayer(T)?N=T.fetchPopupFromTiles(L):(N=T.queryVisibleRasters(L,N),N.addCallback(function(){var Y=T.getVisibleRasters();K=K||0<Y.length;return Y}))}else if("esri.layers.WMSLayer"===T.declaredClass){N=new n;var Z=T._getPopupGraphic(w,k.screenPoint);Z?(N.resolve([Z]),K=!0):N.resolve([])}else J||"function"===typeof T.queryFeatures&&(0===T.currentMode||1===T.currentMode)?(L.geometry=I,N=T.queryFeatures(L),N.addCallback(function(Y){var qa=[];r.forEach(Y.features,
function(V){V.visible&&(qa.push(V),J&&V.setResolution(v))});K=K||0<qa.length;return qa})):(N=new n,Z=r.filter(T.graphics,function(Y){return Y&&Y.visible&&I.intersects(Y.geometry)}),P&&C._isParentLayer(T,B)&&(P=C._findGraphicById(Z,B,"cluster_id"))&&(B=P),K=K||0<Z.length,N.resolve(Z));return N});B&&(E=new n,E.resolve([B]),A.unshift(E));r.some(A,function(T){return!T.isFulfilled()})||K?(t.setFeatures(A),t.show(k.mapPoint,{closestFirst:ba})):(t.hide(),t.clearFeatures())}}})},_getSubLayerFeatureLayers:function(k,
w,t){w=w||null;var C=t||new n,u=[];t=k.length;var x=this.map.getScale(),l=!1,v=this,A=0;a:for(;A<t;A++){var B=k[A],E=B.dynamicLayerInfos||B.layerInfos;if(E){var G=null;B._params&&(B._params.layers||B._params.dynamicLayers)&&(G=B.visibleLayers);G=D._getVisibleLayers(E,G);for(var I=D._getLayersForScale(x,E),L=E.length,K=0;K<L;K++){var ba=E[K],T=ba.id,P=B.infoTemplates[T];if(!ba.subLayerIds&&P&&P.infoTemplate&&-1<r.indexOf(G,T)&&-1<r.indexOf(I,T)){if(!g){l=!0;break a}var J=B.id+"_"+T,N=this._featureLayersCache[J];
N&&N.loadError||(N||((N=P.layerUrl)||(N=ba.source?this._getLayerUrl(B.url,"/dynamicLayer"):this._getLayerUrl(B.url,T)),N=new g(N,{parentLayer:B,id:J,drawMode:!1,mode:g.MODE_SELECTION,outFields:this._getOutFields(P.infoTemplate),resourceInfo:P.resourceInfo,source:ba.source}),this._featureLayersCache[J]=N),N.setDefinitionExpression(B.layerDefinitions&&B.layerDefinitions[T]),N.setGDBVersion(B.gdbVersion),N.setInfoTemplate(P.infoTemplate),N.setMaxAllowableOffset(w),N.setUseMapTime(!!B.useMapTime),B.layerDrawingOptions&&
B.layerDrawingOptions[T]&&B.layerDrawingOptions[T].renderer&&N.setRenderer(B.layerDrawingOptions[T].renderer),u.push(N))}}}}if(l){var Z=new n;h(["./layers/FeatureLayer"],function(qa){g=qa;Z.resolve()});Z.then(function(){v._getSubLayerFeatureLayers(k,w,C)})}else{var Y=[];r.forEach(u,function(qa){if(!qa.loaded){var V=new n;e.once(qa,"load, error",function(){V.resolve()});Y.push(V.promise)}});Y.length?b(Y).then(function(){u=r.filter(u,function(qa){return!qa.loadError&&qa.isVisibleAtScale(x)});C.resolve(u)}):
(u=r.filter(u,function(qa){return qa.isVisibleAtScale(x)}),C.resolve(u))}return C.promise},_getLayerUrl:function(k,w){var t=k.indexOf("?");return-1===t?k+"/"+w:k.substring(0,t)+"/"+w+k.substring(t)},_getOutFields:function(k){var w=k.info&&k.info.fieldInfos;if(w&&w.length&&"esri.dijit.PopupTemplate"===k.declaredClass){var t=[];r.forEach(w,function(C){var u=C.fieldName&&C.fieldName.toLowerCase();u&&"shape"!==u&&0!==u.indexOf("relationships/")&&t.push(C.fieldName)})}else t=["*"];return t},_calculateClickTolerance:function(k){var w=
d("esri-touch")?9:6,t,C;r.forEach(k,function(u){if(t=u.renderer)"esri.renderer.SimpleRenderer"===t.declaredClass?((C=t.symbol)&&C.xoffset&&(w=Math.max(w,Math.abs(C.xoffset))),C&&C.yoffset&&(w=Math.max(w,Math.abs(C.yoffset)))):"esri.renderer.UniqueValueRenderer"!==t.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==t.declaredClass||r.forEach(t.infos,function(x){(C=x.symbol)&&C.xoffset&&(w=Math.max(w,Math.abs(C.xoffset)));C&&C.yoffset&&(w=Math.max(w,Math.abs(C.yoffset)))})});return w},_showInfoWindow:function(k,
w){var t=this.map.infoWindow,C=k.geometry;C=C&&"point"===C.type?C:w;var u=k.getContent();t.setTitle(k.getTitle());if(u&&f.isString(u.id)){var x=y.byId(u.id);x&&x.set&&/_PopupRenderer/.test(x.declaredClass)&&x.set("showTitle",!1)}t.setContent(u);t.show(C)},_findGraphicById:function(k,w,t){var C,u=(w=w.attributes)&&w[t];r.some(k,function(x){var l=x.attributes;l&&l[t]===u&&(C=x);return!!C});return C},_isParentLayer:function(k,w){var t=w&&w.getLayer();return k&&t===k},_isReductionEnabled:function(k){return k&&
k.isFeatureReductionActive&&k.isFeatureReductionActive()},_isImageServiceLayer:function(k){return"esri.layers.ArcGISImageServiceLayer"===k.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===k.declaredClass||"esri.layers.RasterXLayer"===k.declaredClass},_isTiledImageServiceLayer:function(k){return"esri.layers.RasterXLayer"===k.declaredClass}});return a.PopupManager=q})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(F,
m,a,D,z){D={_serializeLayerDefinitions:function(y,r){var q=[],n=/[:;]/;if(y&&(m.forEach(y,function(d,e){d&&(q.push([e,d]),!r&&n.test(d)&&(r=!0))}),0<q.length)){if(r){var f={};m.forEach(q,function(d){f[d[0]]=d[1]});f=a.toJson(f)}else f=[],m.forEach(q,function(d){f.push(d[0]+":"+d[1])}),f=f.join(";");return f}return null},_serializeTimeOptions:function(y,r){if(y){var q=[];m.forEach(y,function(n,f){if(n){var d=n.toJson();r&&-1!==m.indexOf(r,f)&&(d.useTime=!1);q.push('"'+f+'":'+a.toJson(d))}});if(q.length)return"{"+
q.join(",")+"}"}},_getVisibleLayers:function(y,r){var q=[],n;if(!y)return q;if(r)for(q=r.concat(),n=0;n<y.length;n++){var f=y[n];var d=m.indexOf(y,f.id);f.subLayerIds&&-1<d&&(q.splice(d,1),q=q.concat(f.subLayerIds))}else q=this._getDefaultVisibleLayers(y);return q},_getDefaultVisibleLayers:function(y){var r=[],q;if(!y)return r;for(q=0;q<y.length;q++)0<=y[q].parentLayerId&&-1===m.indexOf(r,y[q].parentLayerId)&&m.some(y,function(n){return n.id===y[q].parentLayerId})||y[q].defaultVisibility&&r.push(y[q].id);
return r},_getLayersForScale:function(y,r){var q=[];if(0<y&&r){var n;for(n=0;n<r.length;n++)if(!(0<=r[n].parentLayerId&&-1===m.indexOf(q,r[n].parentLayerId)&&m.some(r,function(b){return b.id===r[n].parentLayerId}))&&0<=r[n].id){var f=!0,d=r[n].maxScale,e=r[n].minScale;if(0<d||0<e)0<d&&0<e?f=d<=y&&y<=e:0<d?f=d<=y:0<e&&(f=y<=e);f&&q.push(r[n].id)}}return q}};F.mixin(z,D);return D})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys dijit/focus ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l){var v=D.connect,A=D.disconnect,B=c("chrome"),E=c("safari"),G=[r.NUMPAD_PLUS,61,187,r.NUMPAD_MINUS,173,189,r.UP_ARROW,r.NUMPAD_8,r.RIGHT_ARROW,r.NUMPAD_6,r.DOWN_ARROW,r.NUMPAD_2,r.LEFT_ARROW,r.NUMPAD_4,r.PAGE_UP,r.NUMPAD_9,r.PAGE_DOWN,r.NUMPAD_3,r.END,r.NUMPAD_1,r.HOME,r.NUMPAD_7];F=F(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(I,L){this.map=I;m.mixin(this,L);var K=I.__container;c("esri-pointer")?(this.pointerEvents=
new e(K,{map:I}),this.eventModel="pointer"):c("esri-touch")?(c("ios")||(this.mouseEvents=new f(K,{map:I})),this.touchEvents=new d(K,{map:I,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new f(K,{map:I}),this.eventModel="mouse");this._zoomRect=new k(null,new l(b.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=m.hitch(this,this._adjustPinch);this._adjustPinchEnd=m.hitch(this,this._adjustPinchEnd)},_panInit:function(I){var L=this.mouseEvents;y.isLeft(I)&&
this.map.isPan&&!I.shiftKey&&(this._dragOrigin=new t(0,0),m.mixin(this._dragOrigin,I.screenPoint),A(this._panStartHandle),A(this._panHandle),A(this._panEndHandle),this._panStartHandle=v(L,"onMouseDragStart",this,this._panStart),this._panHandle=v(L,"onMouseDrag",this,this._pan),this._panEndHandle=v(L,"onMouseUp",this,this._panEnd),B||E)&&(I.preventDefault(),q.curNode&&q.curNode.blur())},_panStart:function(I){this.map.setCursor("move");this.map.__panStart(I.screenPoint.x,I.screenPoint.y)},_pan:function(I){this.map.__pan(I.screenPoint.x-
this._dragOrigin.x,I.screenPoint.y-this._dragOrigin.y)},_panEnd:function(I){A(this._panStartHandle);A(this._panHandle);A(this._panEndHandle);this._panStartHandle=this._panHandle=this._panEndHandle=null;var L=this.map;L.__panning&&(L.__panEnd(I.screenPoint.x-this._dragOrigin.x,I.screenPoint.y-this._dragOrigin.y),L.resetMapCursor())},_zoomInit:function(I){var L=this.map,K=this.pointerEvents||this.mouseEvents;(y.isLeft(I)||I.pointerType)&&L.isRubberBandZoom&&I.shiftKey&&(L.setCursor("crosshair"),this._dragOrigin=
m.mixin({},I.screenPoint),this._zoomDir=I.ctrlKey||I.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=v(K,"onSwipeMove",this,this._zoom),this._zoomEndHandle=v(K,"onSwipeEnd",this,this._zoomEnd)):(this._zoomHandle=v(K,"onMouseDrag",this,this._zoom),this._zoomEndHandle=v(K,"onMouseUp",this,this._zoomEnd)),B&&I.preventDefault())},_zoom:function(I){var L=this.map,K=this._normalizeRect(I).offset(L.__visibleRect.x,L.__visibleRect.y);I=L.graphics;var ba=this._zoomRect;ba.geometry||L.setCursor("crosshair");
ba.geometry&&I.remove(ba,!0);var T=L.toMap(new t(K.x,K.y));K=L.toMap(new t(K.x+K.width,K.y+K.height));K=new u(T.x,T.y,K.x-T.x,T.y-K.y,L.spatialReference);K._originOnly=!0;ba.setGeometry(K);I.add(ba,!0)},_zoomEnd:function(I){var L=this._zoomRect,K=this.map,ba=K.extent,T=K.spatialReference;A(this._zoomHandle);A(this._zoomEndHandle);this._zoomHandle=this._zoomEndHandle=null;if(K._canZoom(this._zoomDir)&&L.getDojoShape()){K.graphics.remove(L);L.geometry=null;I=this._normalizeRect(I);I.x+=K.__visibleRect.x;
I.y+=K.__visibleRect.y;if(-1===this._zoomDir){var P=ba.getWidth();I=(P*K.width/I.width-P)/2;T=new C(ba.xmin-I,ba.ymin-I,ba.xmax+I,ba.ymax+I,T)}else ba=K.toMap({x:I.x,y:I.y+I.height}),I=K.toMap({x:I.x+I.width,y:I.y}),T=new C(ba.x,ba.y,I.x,I.y,T);K._extentUtil(null,null,T)}L.getDojoShape()&&K.graphics.remove(L,!0);this._zoomDir=0;K.resetMapCursor()},_wheelZoom:function(I,L){var K=this.map;if(!L){if(K.smartNavigation&&!I.shiftKey&&!K._isPanningOrZooming()){K.disableScrollWheelZoom();this._setScrollWheelPan(!0);
this._wheelPan(I);return}var ba=I.timeStamp;if(!h.isDefined(ba)||0>=ba)ba=(new Date).getTime();if(100>(this._mwts?ba-this._mwts:ba))return;this._mwts=ba}K._canZoom(I.value)&&K._extentUtil({numLevels:I.value,mapAnchor:I.mapPoint,screenAnchor:I.screenPoint})},_wheelPan:function(I){var L=this.map;if(I.shiftKey&&!L._isPanningOrZooming())this._setScrollWheelPan(!1),L.enableScrollWheelZoom(),this._wheelZoom(I);else{var K=0,ba=0;c("ff")?I.axis===I.HORIZONTAL_AXIS?K=-I.detail:ba=-I.detail:(K=I.wheelDeltaX,
ba=I.wheelDeltaY);L.translate(K,ba)}},_setScrollWheelPan:function(I){this.map.isScrollWheelPan=I;this.mouseEvents&&this.mouseEvents.enableMouseWheel(I);A(this._mwMacHandle);this._mwMacHandle=null;I&&(this._mwMacHandle=v(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelPan))},_recenter:function(I){I.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(I.mapPoint)},_recenterZoom:function(I){I.shiftKey&&!this.map._isPanningOrZooming()&&(I.value=I.ctrlKey||I.metaKey?-1:1,this._wheelZoom(I,
!0))},_dblClickZoom:function(I){this.map._isPanningOrZooming()||(I.value=1,this._wheelZoom(I,!0))},_twoFingerTap:function(I){this.map._isPanningOrZooming()||(I.value=-1,this._wheelZoom(I,!0))},_keyDown:function(I){var L=I.keyCode,K=this.map;if(-1!==a.indexOf(G,L)){if(L===r.NUMPAD_PLUS||61===L||187===L)K._extentUtil({numLevels:1});else if(L===r.NUMPAD_MINUS||173===L||189===L)K._extentUtil({numLevels:-1});else{K.__panning||K.__panStart(0,0);switch(L){case r.UP_ARROW:case r.NUMPAD_8:this._keyDy+=10;
break;case r.RIGHT_ARROW:case r.NUMPAD_6:this._keyDx-=10;break;case r.DOWN_ARROW:case r.NUMPAD_2:this._keyDy-=10;break;case r.LEFT_ARROW:case r.NUMPAD_4:this._keyDx+=10;break;case r.PAGE_UP:case r.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case r.PAGE_DOWN:case r.NUMPAD_3:this._keyDx-=10;this._keyDy-=10;break;case r.END:case r.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case r.HOME:case r.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}K.__pan(this._keyDx,this._keyDy)}z.stop(I)}},
_keyEnd:function(I){var L=this.map;L.__panning&&I.keyCode!==r.SHIFT&&(L.__panEnd(this._keyDx,this._keyDy),this._keyDx=this._keyDy=0)},_swipeInit:function(I){var L=this.map;L=L._zoomAnim||L._panAnim;if(I.shiftKey)return!1;L&&L._active&&(L.stop(),L._fire("onEnd",[L.node]));this._dragOrigin=new t(0,0);m.mixin(this._dragOrigin,I.screenPoint);A(this._swipeHandle);A(this._swipeEndHandle);this._swipeHandle=v(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe);this._swipeEndHandle=v(this.touchEvents||
this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)},_swipe:function(I){var L=this.map;L.__panning?(this._panX=I.screenPoint.x,this._panY=I.screenPoint.y,L.__pan(I.screenPoint.x-this._dragOrigin.x,I.screenPoint.y-this._dragOrigin.y)):(L.setCursor("move"),L.__panStart(I.screenPoint.x,I.screenPoint.y))},_swipeEnd:function(I){A(this._swipeHandle);A(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var L=this.map;L.__panning&&(L.resetMapCursor(),L.__panEnd(I.screenPoint.x-this._dragOrigin.x,
I.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(I){var L=this.map,K=L._zoomAnim||L._panAnim;K&&K._active?(K.stop(),K._fire("onEnd",[K.node])):L.__panning&&(I.screenPoint=new t(this._panX,this._panY),I.mapPoint=L.toMap(I.screenPoint),this._swipeEnd(I));A(this._pinchHandle);A(this._pinchEndHandle);this._pinchHandle=v(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=v(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(I){var L=
this.map;if(I.screenPoints){this.currLength=x.getLength(I.screenPoints[0],I.screenPoints[1]);if(L.__zooming){var K=this.currLength/this._length;this._zoomStartExtent=this.__scaleExtent(L.extent,K,this._dragOrigin);L.__zoom(this._zoomStartExtent,K,this._dragOrigin)}else this._dragOrigin=new t((I.screenPoints[0].x+I.screenPoints[1].x)/2,(I.screenPoints[0].y+I.screenPoints[1].y)/2),this._length=this.currLength,L.__zoomStart(L.extent,this._dragOrigin);this._pinchScale=K;L._fireOnScale(this.currLength/
this._length,this._dragOrigin,!0)}},_pinchEnd:function(I){I=this.map;A(this._pinchHandle);A(this._pinchEndHandle);this._pinchHandle=this._pinchEndHandle=null;this._pinchScale=0;if(I.__zooming&&null===I._zoomAnim){var L=this.currLength/this._length,K=I.extent.getWidth();this._zoomAnimAnchor=I.toMap(this._dragOrigin);this._zoomStartExtent=this.__scaleExtent(I.extent,1/L,this._zoomAnimAnchor);if(I.__tileInfo){var ba=w.getCandidateTileInfo(I,I.__tileInfo,this._zoomStartExtent),T=I.__getExtentForLevel(ba.lod.level,
this._zoomAnimAnchor),P=I.getMinZoom(),J=I.getMaxZoom(),N=T.extent;T=T.lod;var Z=K/N.getWidth(),Y=ba.lod.level;1>L?Z>L&&Y--:Z<L&&Y++;Y<P?Y=P:Y>J&&(Y=J);Y!==ba.lod.level&&(T=I.__getExtentForLevel(Y,this._zoomAnimAnchor),N=T.extent,T=T.lod);this._zoomEndExtent=N;this._zoomEndLod=T;I._zoomAnim=g.animateRange({range:{start:K/this._zoomStartExtent.getWidth(),end:Z},duration:b.defaults.map.zoomDuration,rate:b.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});I._zoomAnim.play();
I._fireOnScale(I.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=this._zoomStartExtent,I._fireOnScale(I.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(I){var L=this.__scaleExtent(this.map.extent,I,this._zoomAnimAnchor);this.map.__zoom(L,I,this._dragOrigin)},_adjustPinchEnd:function(){var I=this.map,L=I.extent.getWidth()/this._zoomEndExtent.getWidth(),K=this.__scaleExtent(I.extent,1/L,this._zoomAnimAnchor),
ba=this._dragOrigin,T=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=this._dragOrigin=I._zoomAnim=this._zoomAnimAnchor=null;I.__zoomEnd(K,L,ba,T,!0)},__scaleExtent:function(I,L,K){K=K||I.getCenter();L=I.expand(L);var ba=I.xmin-(L.getWidth()-I.getWidth())*(K.x-I.xmin)/I.getWidth();K=I.ymax-(L.getHeight()-I.getHeight())*(K.y-I.ymax)/I.getHeight();return new C(ba,K-L.getHeight(),ba+L.getWidth(),K,I.spatialReference)},_normalizeRect:function(I){I=I.screenPoint;var L=this._dragOrigin.x,
K=this._dragOrigin.y;I=new u((I.x<L?I.x:L)-this.map.__visibleRect.x,(I.y<K?I.y:K)-this.map.__visibleRect.y,Math.abs(I.x-L),Math.abs(I.y-K));delete I.spatialReference;0===I.width&&(I.width=1);0===I.height&&(I.height=1);return I},setImmediateClick:function(I){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(I);break;case "touch":this.touchEvents.setImmediateTap(I);this.mouseEvents&&this.mouseEvents.setImmediateClick(I);break;case "pointer":this.pointerEvents.setImmediateTap(I)}},
enablePan:function(){this.disablePan();switch(this.eventModel){case "mouse":this._panInitHandle=v(this.mouseEvents,"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=v(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=v(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=v(this.pointerEvents,"onSwipeStart",this,this._swipeInit)}},disablePan:function(){A(this._panInitHandle);this._panInitHandle=null;A(this._swipeInitHandle);
this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=this.pointerEvents?v(this.pointerEvents,"onSwipeStart",this,this._zoomInit):v(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){A(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();if("touch"===this.eventModel||"pointer"===this.eventModel)this._pinchInitHandle=v(this.touchEvents||this.pointerEvents,"onPinchStart",
this,this._pinchInit)},disablePinchZoom:function(){A(this._pinchInitHandle);this._pinchInitHandle=null},enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=v(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){A(this._wheelHandle);this._wheelHandle=null},enableScrollWheelPan:function(){var I=this.map;I&&I.loaded&&I.smartNavigation&&(this.disableScrollWheelPan(),this._setScrollWheelPan(!0))},disableScrollWheelPan:function(){var I=
this.map;I&&I.loaded&&I.smartNavigation&&this._setScrollWheelPan(!1)},enableDoubleClickZoom:function(){this.disableDoubleClickZoom();switch(this.eventModel){case "mouse":this._dblClickHandle=v(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=v(this.mouseEvents,"onDblClick",this,this._dblClickZoom);this._dblTapHandle=v(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=v(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);
break;case "pointer":this._dblTapHandle=v(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=v(this.pointerEvents,"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){A(this._dblClickHandle);A(this._zoomOutHandle);this._dblTapHandle&&A(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=v(this.pointerEvents||this.mouseEvents,
"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){A(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();this._recenterHandle=v(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){A(this._recenterHandle);this._recenterHandle=null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=v(this.pointerEvents||this.mouseEvents,"onKeyDown",
this,this._keyDown);this._keyEndHandle=v(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){A(this._keyHandle);A(this._keyEndHandle);this._keyHandle=this._keyEndHandle=null},enableScrollWheel:function(){var I=this.map;I&&(I.smartNavigation?this.enableScrollWheelPan():I.enableScrollWheelZoom())},disableScrollWheel:function(){var I=this.map;I&&(I.disableScrollWheelZoom(),I.smartNavigation&&this.disableScrollWheelPan())},enableNavigation:function(){var I=
this.map;I&&I.loaded&&(I._evalNavigationFeature("DoubleClickZoom"),I._evalNavigationFeature("ClickRecenter"),I._evalNavigationFeature("Pan"),I._evalNavigationFeature("RubberBandZoom"),I._evalNavigationFeature("PinchZoom"),I._evalNavigationFeature("KeyboardNavigation"),I._evalNavigationFeature("ScrollWheel"))},disableNavigation:function(){var I=this.map;I&&I.loaded&&(I._evalNavigationFeature("DoubleClickZoom"),I._evalNavigationFeature("ClickRecenter"),I._evalNavigationFeature("Pan"),I._evalNavigationFeature("RubberBandZoom"),
I._evalNavigationFeature("PinchZoom"),I._evalNavigationFeature("KeyboardNavigation"),I._evalNavigationFeature("ScrollWheel"))},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&this.mouseEvents.destroy();this.pointerEvents&&this.pointerEvents.destroy();var I,L=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,
this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];for(I=0;I<L.length;I++)A(L[I]);this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=
this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=this._pinchInitHandle=this._pinchHandle=this._pinchEndHandle=null}});return n.MapNavigationManager=F})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),
function(F,m,a,D,z,y,r,q,n,f){var d=z.connect,e=z.disconnect;F=F([q],{declaredClass:"esri.MouseEvents",doubleClickDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==D("mac")?1:3,wheelDivisor:2>D("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(b,c){this.node=b;a.mixin(this,c);var h=function(g){y.stop(g);return!1};D("mozilla")&&m.style(b,"MozUserSelect","none");this._handles=[d(b,"onselectstart",h),d(b,"ondragstart",h),d(b,"onmouseenter",this,this._onMouseEnterHandler),
d(b,"onmouseleave",this,this._onMouseLeaveHandler),d(b,"onmousedown",this,this._onMouseDownHandler),d(b,"onclick",this,this._onClickHandler),d(b,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=d(b,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=d(b,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=a.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(h=this.map)?h.isScrollWheelZoom||
h.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},_fire:function(b,c){if(!this._preventClick||"onClick"!==b&&"onDblClick"!==b){if(this[b])this[b](c);if(this.map&&this.map[b])this.map[b](c)}},_processEvent:function(b){b=y.fix(b,b.target);var c=this.map,h=c&&c.position;h&&("DOMMouseScroll"===b.type&&3>D("ff")?b.screenPoint=new f(window.scrollX+b.screenX-h.x,window.scrollY+b.screenY-h.y):b.screenPoint=new f(b.pageX-h.x,b.pageY-h.y),b.mapPoint=c.extent?c.toMap(b.screenPoint):new n);
b.numPoints=0;return b},_onMouseEnterHandler:function(b){e(this._onKeyDown_connect);e(this._onKeyUp_connect);this._onKeyDown_connect=d(document,"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=d(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(b))},_onMouseLeaveHandler:function(b){e(this._onKeyDown_connect);e(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(b))},_onMouseMoveHandler:function(b){this._dragEnd?
this._dragEnd=!1:this._fire("onMouseMove",this._processEvent(b))},_onMouseDownHandler:function(b){e(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=null;this.node.setCapture&&this.node.setCapture(!1);e(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=d(document,"onmousemove",this,this._onMouseDragHandler);this._startX=b.pageX;this._startY=b.pageY;this._fire("onMouseDown",this._processEvent(b))},_onMouseUpHandler:function(b){var c=this.node;c.releaseCapture&&c.releaseCapture();
e(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;e(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=d(c,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(b))},_onMouseDragHandler:function(b){e(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=d(document,"onmousemove",this,this._onMouseDraggingHandler);e(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=d(document,"onmouseup",this,this._onDragMouseUpHandler);
this._docLeaveConnect=d(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(b))},_onMouseDraggingHandler:function(b){y.stop(b);this._fire("onMouseDrag",this._processEvent(b))},_onDragMouseUpHandler:function(b){var c=this.node;c.releaseCapture&&c.releaseCapture();this._dragEnd=!0;e(this._docLeaveConnect);e(this._onMouseDragHandler_connect);e(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=
d(c,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=d(c,"onmouseup",this,this._onMouseUpHandler);b=this._processEvent(b);this._fire("onMouseDragEnd",b);this._fire("onMouseUp",b)},_onDocMouseOut:function(b){var c=9>D("ie")?b.toElement:b.relatedTarget,h=c&&c.nodeName.toLowerCase();(!c||(D("chrome")||D("safari"))&&"html"===h)&&this._onDragMouseUpHandler(b)},_onClickHandler:function(b){b=this._processEvent(b);if(b.pageX===this._startX&&b.pageY===this._startY){clearTimeout(this._clickTimer);
var c={},h="movementX"in b,g;for(g in b)"mozInputSource"===g||"mozPressure"===g||h&&("webkitMovementX"===g||"webkitMovementY"===g)||(c[g]=b[g]);this._clickEvent=c;this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration)}},_fireClickEvent:function(){clearTimeout(this._clickTimer);9>D("ie")&&(this._clickEvent.graphic=r._ieGraphic,delete r._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(b){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(b))},
_onMouseWheelHandler:function(b){var c=this.map;(c?c.isScrollWheelZoom||c.isScrollWheelPan:this.preventPageScroll)&&y.stop(b);c=D("ff")||D("mozilla")?-b.detail/this.mozWheelDivisor:b.wheelDelta/this.wheelDivisor;var h=Math.abs(c);h=h<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;b.value=0>c?-h:h;this._fire("onMouseWheel",this._processEvent(b))},_onKeyDownHandler:function(b){this._fire("onKeyDown",b)},_onKeyUpHandler:function(b){this._fire("onKeyUp",b)},enableMouseWheel:function(b){e(this._scrollHandle);
this._scrollHandle=d(this.node,D("ff")||D("mozilla")?b?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},setImmediateClick:function(b){this.doubleClickDuration=b?0:this._initialDuration},preventClickEvents:function(b){this._preventClick=b},destroy:function(){var b=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]),
c;for(c=0;c<b.length;c++)e(b[c]);clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}});return r.MouseEvents=F})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),
function(F,m,a,D,z,y,r,q,n){F=F([r],{declaredClass:"esri.TouchEvents",tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,constructor:function(f,d){this.node=f;a.mixin(this,d);m.setSelectable(f,!1);this._touchStart=a.hitch(this,this._touchStart);this._touchMove=a.hitch(this,this._touchMove);this._touchEnd=a.hitch(this,this._touchEnd);this._touchCancel=a.hitch(this,this._touchCancel);this._fireClickEvent=a.hitch(this,this._fireClickEvent);f.addEventListener("touchstart",
this._touchStart,!1);f.addEventListener("touchmove",this._touchMove,!1);f.addEventListener("touchend",this._touchEnd,!1);f.addEventListener("touchcancel",this._touchCancel,!1);this.map&&D("ios")&&(this._mouseOver=a.hitch(this,this._mouseOver),this._mouseOut=a.hitch(this,this._mouseOut),this._mouseDown=a.hitch(this,this._mouseDown),this._mouseUp=a.hitch(this,this._mouseUp),this._mouseClick=a.hitch(this,this._mouseClick),f.addEventListener("mouseover",this._mouseOver,!1),f.addEventListener("mouseout",
this._mouseOut,!1),f.addEventListener("mousedown",this._mouseDown,!1),f.addEventListener("mouseup",this._mouseUp,!1),f.addEventListener("click",this._mouseClick,!1));this._numTouches=0;this._nodeTouches=[];this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(f){var d=this._touches,e,b=f.changedTouches.length,c,h,g=(new Date).getTime();this._touchStartTS=g;if(!(D("android")&&D("safari")&&1===f.targetTouches.length&&f.touches.length===f.targetTouches.length&&f.targetTouches.length===
f.changedTouches.length&&0===f.changedTouches[0].identifier&&d[f.changedTouches[0].identifier])){this._addTouch(f);for(e=0;e<b;e++){var k=f.changedTouches[e];var w=d[k.identifier]={};w.startX=k.pageX;w.startY=k.pageY;w.startTS=g;-1===this._touchIds.indexOf(k.identifier)&&this._touchIds.push(k.identifier)}this._swipeActive&&(c=this._nodeTouches[0]);this._pinchActive&&(h=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(f,
c))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(f,[c,h]))):2===this._numTouches?this._swipeActive&&(c&&(w=d[this._touchIds[0]],w.startX=c.pageX,w.startY=c.pageY,w.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(f,c))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(f,c))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(f,[c,h])))}},_touchMove:function(f){f.preventDefault();
this._updateTouch(f);var d=this._touches,e,b=f.changedTouches.length,c;if(!(D("android")&&D("safari")&&1===f.targetTouches.length&&f.touches.length===f.targetTouches.length&&f.targetTouches.length===f.changedTouches.length&&0===f.changedTouches[0].identifier&&d[f.changedTouches[0].identifier]&&1<this._touchIds.length)){for(e=0;e<b;e++){var h=f.changedTouches[e];if(c=d[h.identifier]){var g=Math.abs(h.pageX-c.startX);h=Math.abs(h.pageY-c.startY);!c.moved&&(g>=this.tapRadius||h>=this.tapRadius)&&(c.moved=
c.absMoved=!0);var k=k?k:c.moved}}1===this._numTouches?(d=f.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(f,d)):k&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(f,d)))):2===this._numTouches&&(e=this._nodeTouches[0],b=this._nodeTouches[1],this._pinchActive?this._fire("onPinchMove",this._processTouchEvent(f,[e,b])):k&&(k=d[e.identifier],c=d[b.identifier],d=Math.abs(k.startX-c.startX),k=Math.abs(k.startY-c.startY),c=Math.abs(e.pageX-b.pageX),
g=Math.abs(e.pageY-b.pageY),Math.abs(Math.sqrt(c*c+g*g)-Math.sqrt(d*d+k*k))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(f,[e,b])))))}},_touchEnd:function(f){this._removeTouch(f);var d=this._touches,e=f.changedTouches,b,c=e.length,h,g,k=(new Date).getTime(),w=this._touchIds;for(b=0;b<c;b++)if(g=d[e[b].identifier])g.absMoved&&(h=!0),g.pageX=e[b].pageX,g.pageY=e[b].pageY,g.endTS=k;if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=
!1,this._fire("onSwipeEnd",this._processTouchEvent(f,e[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(f,e));else{if(!h){c=Infinity;h=-Infinity;k=Infinity;var t=-Infinity,C=this.tapStartTolerance,u=[],x=!0;for(b=0;b<w.length;b++)g=d[w[b]],u.push(g),g.startTS<c&&(c=g.startTS),g.startTS>h&&(h=g.startTS),g.endTS<k&&(k=g.endTS),g.endTS>t&&(t=g.endTS),delete d[w[b]];1===u.length&&e[0]&&(d=Math.abs(e[0].pageY-u[0].startY),Math.abs(e[0].pageX-u[0].startX)>=
this.tapRadius||d>=this.tapRadius)&&(x=!1);x&&Math.abs(h-c)<=C&&Math.abs(t-k)<=C&&this._basicTap(f,u)}}else 1===this._numTouches&&this._pinchActive&&(b=this._nodeTouches[0],g=d[b.identifier],g.startX=b.pageX,g.startY=b.pageY,this._pinchActive=g.moved=!1,this._fire("onPinchEnd",this._processTouchEvent(f,[e[0],b])))},_touchCancel:function(f){this._numTouches&&this._touchEnd(f)},_basicTap:function(f,d){var e=(new Date).getTime(),b=this;f=this._processTouchEvent(f,d);this._taps.push({touchInfos:d,ts:e,
event:f});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",f);clearTimeout(this._tapTimer);this._immediate?this._analyzeTap(!0):this._tapTimer=setTimeout(function(){var c=b;b=null;clearTimeout(c._tapTimer);c._analyzeTap()},2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration)},_analyzeTap:function(f){var d=this._taps,e=d[0],b=d[1],c=e.touchInfos,h=b&&b.touchInfos;d.length&&(f||(this._taps=[]),e&&b?c.length===h.length?b.ts-e.ts<=this.doubleTapDuration?(1===c.length?
(f=Math.abs(c[0].startX-h[0].startX),c=Math.abs(c[0].startY-h[0].startY),c=f<=this.doubleTapRadius&&c<=this.doubleTapRadius):c=!0,c?this._processedDoubleTap(d):this._processedTap(b)):this._processedTap(b):this._processedTap(b):this._processedTap(e||b))},_processedTap:function(f){var d=f.event;this._fire("onProcessedTap",d);1===f.touchInfos.length?this._fire("onTap",this._fixEvent(d)):2===f.touchInfos.length&&this._fire("onTwoFingerTap",d)},_processedDoubleTap:function(f){var d=1===f[1].touchInfos.length;
if(d){var e=[this._fixEvent(f[0].event),this._fixEvent(f[1].event)];e[1].relatedEvents=e}f=[f[0].event,f[1].event];f[1].relatedEvents=f;this._fire("onProcessedDoubleTap",f[1]);d&&(this._fire("onDoubleTap",e[1]),this._fire("onDblClick",e[1]))},_addTouch:function(f){var d=f.changedTouches,e=this._nodeTouches,b;this._numTouches+=d.length;for(f=0;f<d.length;f++){var c=e.length;var h=!1;for(b=0;b<c&&!(h=e[b].identifier===d[f].identifier);b++);h?this._numTouches--:e.push(d[f])}for(f=e.length-1;0<=f;f--)z.isDescendant(e[f].target,
document.body)||(e.splice(f,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(f){var d=[],e=[],b=f.changedTouches,c=this._nodeTouches;this._numTouches-=b.length;0>this._numTouches&&(this._numTouches=0);for(f=0;f<b.length;f++)d.push(b[f].identifier);for(f=c.length-1;0<=f;f--)-1!==d.indexOf(c[f].identifier)&&e.push(c.splice(f,1)[0]);return e},_updateTouch:function(f){var d=[],e=f.changedTouches,b=this._nodeTouches;for(f=0;f<e.length;f++)d.push(e[f].identifier);for(f=
0;f<b.length;f++){var c=d.indexOf(b[f].identifier);-1!==c&&b.splice(f,1,e[c])}},_mouseOver:function(f){this._fire("onMouseOver",this._processMouseEvent(f))},_mouseOut:function(f){this._fire("onMouseOut",this._processMouseEvent(f))},_mouseDown:function(f){this._fire("onMouseDown",this._processMouseEvent(f))},_mouseUp:function(f){this._fire("onMouseUp",this._processMouseEvent(f))},_mouseClick:function(f){clearTimeout(this._clickTimer);300<(new Date).getTime()-this._touchStartTS?this._fire("onClick",
this._processMouseEvent(f)):(this._clickEvent=f,this._clickTimer=setTimeout(this._fireClickEvent,this.doubleTapDuration))},_fireClickEvent:function(){clearTimeout(this._clickTimer);this._fire("onClick",this._processMouseEvent(this._clickEvent))},_fire:function(f,d){"onDblClick"===f&&clearTimeout(this._clickTimer);if("onDblClick"===f&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);var e=this;setTimeout(function(){e.mouseEvents.preventClickEvents(!1)},350)}if(this[f])this[f](d);if(this.map&&
this.map[f])this.map[f](d)},_fixEvent:function(f){var d={},e;for(e in f)d[e]=f[e];this.map&&(d.screenPoint=d.screenPoints[0],d.mapPoint=d.mapPoints[0]);return d},_processTouchEvent:function(f,d){var e=this.map,b=e&&e.position,c=0;if(b&&d)if(a.isArray(d)){var h;f.screenPoints=[];f.mapPoints=[];for(h=0;h<d.length;h++)if(d[h]){var g=new n(d[h].pageX-b.x,d[h].pageY-b.y);f.screenPoints.push(g);f.mapPoints.push(e.extent?e.toMap(g):new q)}else c++}else f.screenPoint=new n(d.pageX-b.x,d.pageY-b.y),f.mapPoint=
e.extent?e.toMap(f.screenPoint):new q;f.numPoints=d?a.isArray(d)?d.length-c:1:0;return f},_processMouseEvent:function(f){var d=this.map,e=d&&d.position;e&&(f.screenPoint=new n(f.pageX-e.x,f.pageY-e.y),f.mapPoint=d.extent?d.toMap(f.screenPoint):new q);return f},setImmediateTap:function(f){this._immediate=f},destroy:function(){var f=this.node;f.removeEventListener("touchstart",this._touchStart,!1);f.removeEventListener("touchmove",this._touchMove,!1);f.removeEventListener("touchend",this._touchEnd,
!1);f.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&(f.removeEventListener("mouseover",this._mouseOver,!1),f.removeEventListener("mouseout",this._mouseOut,!1),f.removeEventListener("mousedown",this._mouseDown,!1),f.removeEventListener("mouseup",this._mouseUp,!1),f.removeEventListener("click",this._mouseClick,!1));m.setSelectable(f,!0);clearTimeout(this._tapTimer);clearTimeout(this._clickTimer);this.node=this.map=this._numTouches=this._nodeTouches=this._touches=this._touchIds=this._taps=
null}});return y.TouchEvents=F})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(F,m,a,D,z,y,r,q){F=F([y],{declaredClass:"esri.PointerEvents",tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==D("mac")?1:3,wheelDivisor:120,preventPageScroll:!0,_dragging:!1,constructor:function(n,
f){this.node=n;m.mixin(this,f);void 0!==n.style.msTouchAction?n.style.msTouchAction="none":void 0!==n.style.touchAction&&(n.style.touchAction="none");var d=navigator.msPointerEnabled,e=function(b){b.preventDefault()};n.addEventListener("selectstart",e,!1);n.addEventListener("dragstart",e,!1);this._pointerDown=m.hitch(this,this._pointerDown);this._pointerMove=m.hitch(this,this._pointerMove);this._pointerUp=m.hitch(this,this._pointerUp);this._pointerCancel=m.hitch(this,this._pointerCancel);n.addEventListener(d?
"MSPointerDown":"pointerdown",this._pointerDown,!1);n.addEventListener(d?"MSPointerMove":"pointermove",this._pointerMove,!1);n.addEventListener(d?"MSPointerUp":"pointerup",this._pointerUp,!1);n.addEventListener(d?"MSPointerCancel":"pointercancel",this._pointerCancel,!1);this.map&&(this._mouseOver=m.hitch(this,this._mouseOver),this._mouseOut=m.hitch(this,this._mouseOut),this._mouseLeave=m.hitch(this,this._mouseLeave),this._mouseDown=m.hitch(this,this._mouseDown),this._mouseUp=m.hitch(this,this._mouseUp),
this._mouseClick=m.hitch(this,this._mouseClick),this._mouseWheel=m.hitch(this,this._mouseWheel),this._mouseMove=m.hitch(this,this._mouseMove),this._mouseEnter=m.hitch(this,this._mouseEnter),this._onKeyDown=m.hitch(this,this._onKeyDown),this._onKeyUp=m.hitch(this,this._onKeyUp),n.addEventListener("mouseover",this._mouseOver,!1),n.addEventListener("mouseout",this._mouseOut,!1),n.addEventListener("mouseleave",this._mouseLeave,!1),n.addEventListener("mousedown",this._mouseDown,!1),n.addEventListener("mouseup",
this._mouseUp,!1),n.addEventListener("click",this._mouseClick,!1),n.addEventListener("mousewheel",this._mouseWheel,!1),n.addEventListener("mousemove",this._mouseMove,!1),n.addEventListener("mouseenter",this._mouseEnter,!1));this._numTouches=0;this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_pointerDown:function(n){if(-1<a.indexOf(this._touchIds,n.pointerId))this._pointerUp(n);else{var f=this._touches,d=n.target,e=n.pointerId,b=this._touchIds,c=(new Date).getTime();var h=f[e]=
{};h.pointerId=e;h.startX=h.pageX=n.pageX;h.startY=h.pageY=n.pageY;h.startTS=c;b.push(e);this._numTouches++;d.setPointerCapture?d.setPointerCapture(e):d.msSetPointerCapture&&d.msSetPointerCapture(e);d=f[b[0]];f=f[b[1]];1!==this._numTouches&&(2===this._numTouches?this._swipeActive&&(d&&(d.startX=d.pageX,d.startY=d.pageY,d.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(n,d))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(n,d))):
this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(n,[d,f]))))}},_pointerMove:function(n){var f=this._touches,d=this._touchIds,e;if((e=f[n.pointerId])&&(e.pageX!==n.pageX||e.pageY!==n.pageY)){e.pageX=n.pageX;e.pageY=n.pageY;var b=Math.abs(e.pageX-e.startX);var c=Math.abs(e.pageY-e.startY);!e.moved&&(b>=this.tapRadius||c>=this.tapRadius)&&(e.moved=e.absMoved=!0);if(1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(n,n)):e.moved&&
(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(n,n)));else if(2===this._numTouches)if(e=f[d[0]],f=f[d[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(n,[e,f]));else if(e.moved||f.moved){d=Math.abs(e.startX-f.startX);b=Math.abs(e.startY-f.startY);c=Math.abs(e.pageX-f.pageX);var h=Math.abs(e.pageY-f.pageY);Math.abs(Math.sqrt(c*c+h*h)-Math.sqrt(d*d+b*b))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(n,[e,f])))}}},
_pointerUp:function(n){var f=this._touches,d,e=this.node,b=n.target,c=n.pointerId,h=this._touchIds,g=h.slice(0),k=a.map(g,function(u){return f[u]}),w=(new Date).getTime();if(d=f[c])if(d.pageX=n.pageX,d.pageY=n.pageY,d.endTS=w,this._numTouches--,b.releasePointerCapture?b.releasePointerCapture(c):b.msReleasePointerCapture&&b.msReleasePointerCapture(c),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(n,n));
else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(n,n));else{if(!d.absMoved){b=Infinity;c=-Infinity;h=Infinity;w=-Infinity;var t=this.tapStartTolerance,C;for(C=0;C<g.length;C++)d=k[C],d.startTS<b&&(b=d.startTS),d.startTS>c&&(c=d.startTS),d.endTS<h&&(h=d.endTS),d.endTS>w&&(w=d.endTS);Math.abs(c-b)<=t&&Math.abs(w-h)<=t&&this._basicTap(n,k)}}else 1===this._numTouches&&this._pinchActive&&(h.splice(a.indexOf(h,n.pointerId),1),delete f[n.pointerId],d=f[h[0]],
d.startX=d.pageX,d.startY=d.pageY,d.moved=!1,document.msElementsFromPoint&&(g=document.msElementsFromPoint(d.pageX,d.pageY),a.some(g,function(u){return u===e})||(this._touches={},this._touchIds=[],this._numTouches=0)),this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(n,[n,d])))},_pointerCancel:function(n){this._numTouches&&this._pointerUp(n)},_basicTap:function(n,f){var d=(new Date).getTime(),e=this,b=this._immediate;n=this._processTouchEvent(n,f);this._taps.push({touchInfos:f,
ts:d,event:n});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",n);clearTimeout(this._tapTimer);d=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=setTimeout(function(){var c=e;e=null;clearTimeout(c._tapTimer);c._analyzeTap(b)},b?0:d)},_analyzeTap:function(n){var f=this._taps,d=f[0],e=f[1],b=d.touchInfos,c=e&&e.touchInfos;f.length&&(n||(this._taps=[]),d&&e?b.length===c.length?e.ts-d.ts<=this.doubleTapDuration?(1===b.length?(n=Math.abs(b[0].startX-
c[0].startX),b=Math.abs(b[0].startY-c[0].startY),b=n<=this.doubleTapRadius&&b<=this.doubleTapRadius):b=!0,b?this._processedDoubleTap(f):this._processedTap(e)):this._processedTap(e):this._processedTap(e):this._processedTap(d||e))},_processedTap:function(n){var f=n.event;this._fire("onProcessedTap",f);1===n.touchInfos.length?this._fire("onTap",this._fixEvent(f)):2===n.touchInfos.length&&this._fire("onTwoFingerTap",f)},_processedDoubleTap:function(n){var f=1===n[1].touchInfos.length;if(f){var d=[this._fixEvent(n[0].event),
this._fixEvent(n[1].event)];d[1].relatedEvents=d}n=[n[0].event,n[1].event];n[1].relatedEvents=n;this._fire("onProcessedDoubleTap",n[1]);f&&(this._fire("onDoubleTap",d[1]),this._fire("onDblClick",d[1]))},_mouseOver:function(n){this._fire("onMouseOver",this._processMouseEvent(n))},_mouseMove:function(n){this._dragging?this._fire("onMouseDrag",this._processMouseEvent(n)):this._fire("onMouseMove",this._processMouseEvent(n))},_mouseOut:function(n){this._fire("onMouseOut",this._processMouseEvent(n))},_mouseLeave:function(n){document.removeEventListener("keydown",
this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(n))},_mouseDown:function(n){this._downX=n.pageX;this._downY=n.pageY;this._fire("onMouseDown",this._processMouseEvent(n));0===n.button&&(this._dragging=!0,this._fire("onMouseDragStart",this._processMouseEvent(n)))},_mouseUp:function(n){this._dragging&&(this._dragging=!1,this._fire("onMouseDragEnd",this._processMouseEvent(n)));this._fire("onMouseUp",this._processMouseEvent(n))},
_mouseClick:function(n){Math.abs(n.pageX-this._downX)<=this.clickRadius&&Math.abs(n.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(n))},_mouseWheel:function(n){var f=this.map;(f?f.isScrollWheelZoom||f.isScrollWheelPan:this.preventPageScroll)&&n.preventDefault();f=n.wheelDelta?n.wheelDelta/this.wheelDivisor:-n.detail/this.mozWheelDivisor;var d=Math.abs(f);d=d<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;n.value=0>f?-d:d;this._fire("onMouseWheel",this._processMouseEvent(n))},
_mouseEnter:function(n){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",this._onKeyDown,!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",this._processMouseEvent(n))},_onKeyDown:function(n){this._fire("onKeyDown",n)},_onKeyUp:function(n){this._fire("onKeyUp",n)},_fire:function(n,f){if(this[n])this[n](f);if(this.map&&this.map[n])this.map[n](f)},_fixEvent:function(n){var f=
{},d;for(d in n)f[d]=n[d];f.preventDefault=function(){n.preventDefault()};f.stopPropagation=function(){n.stopPropagation()};this.map&&(f.screenPoint=f.screenPoints[0],f.mapPoint=f.mapPoints[0]);return f},_processTouchEvent:function(n,f){var d=this.map,e=d&&d.position,b=0;if(e&&f)if(m.isArray(f)){var c;n.screenPoints=[];n.mapPoints=[];for(c=0;c<f.length;c++)if(f[c]){var h=new q(f[c].pageX-e.x,f[c].pageY-e.y);n.screenPoints.push(h);n.mapPoints.push(d.extent?d.toMap(h):new r)}else b++}else n.screenPoint=
new q(f.pageX-e.x,f.pageY-e.y),n.mapPoint=d.extent?d.toMap(n.screenPoint):new r;n.numPoints=f?m.isArray(f)?f.length-b:1:0;return n},_processMouseEvent:function(n){var f=this.map,d=f&&f.position;d&&(n.screenPoint=new q(n.pageX-d.x,n.pageY-d.y),n.mapPoint=f.extent?f.toMap(n.screenPoint):new r);return n},setImmediateTap:function(n){this._immediate=n},destroy:function(){var n=this.node;n.removeEventListener("MSPointerDown",this._pointerDown,!1);n.removeEventListener("MSPointerMove",this._pointerMove,
!1);n.removeEventListener("MSPointerUp",this._pointerUp,!1);n.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(n.removeEventListener("mouseover",this._mouseOver,!1),n.removeEventListener("mousemove",this._mouseMove,!1),n.removeEventListener("mouseout",this._mouseOut,!1),n.removeEventListener("mouseleave",this._mouseLeave,!1),n.removeEventListener("mousedown",this._mouseDown,!1),n.removeEventListener("mouseup",this._mouseUp,!1),n.removeEventListener("click",this._mouseClick,
!1),n.removeEventListener("mouseenter",this._mouseEnter,!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}});return z.PointerEvents=F})},"esri/dijit/Attribution":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-geometry ../kernel ../lang ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w){F=F(null,{declaredClass:"esri.dijit.Attribution",itemDelimiter:" | ",listClass:"esriAttributionList",itemClass:"esriAttributionItem",lastItemClass:"esriAttributionLastItem",delimiterClass:"esriAttributionDelim",constructor:function(t,C){try{m.mixin(this,t);this._attributions={};this._pendingDfds={};this._activeLayers=[];this._sharedLayers=[];this._layerHandles={};var u=this.domNode=q.byId(C),x=this.map,l="\x3cspan class\x3d'"+this.listClass+"'\x3e\x3c/span\x3e";
u&&(n.set(u,"innerHTML",l),this.listNode=z.query(".esriAttributionList",u)[0],this.itemNodes={});this._eventConnections=[D.connect(x,"onLayerAdd",this,this._onLayerAdd),D.connect(x,"onLayerRemove",this,this._onLayerRemove),D.connect(x,"onLayerSuspend",this,this._onLayerSuspend),D.connect(x,"onLayerResume",this,this._onLayerResume),D.connect(x,"onResize",this,this._adjustFocus),D.connect(x,"onExtentChange",this,this._onExtentChange)];if(x.loaded){var v=x.layerIds.concat(x.graphicsLayerIds),A,B=v.length;
for(A=0;A<B;A++){var E=x.getLayer(v[A]);E.loaded&&this._onLayerAdd(E)}}}catch(G){}},startup:function(){},destroy:function(){a.forEach(this._eventConnections,D.disconnect);f.destroy(this.listNode);var t=this._layerHandles,C;for(C in t)t[C]&&t[C].remove();this.map=this.domNode=this._eventConnections=this.listNode=this._attributions=this._pendingDfds=this.itemNodes=this._activeLayers=this._lastItem=this._sharedLayers=this._layerHandles=null},_onLayerAdd:function(t){try{var C=this._attributions,u=t.id;
if(!h.isDefined(C[u])&&t.showAttribution){if(t.hasAttributionData){var x=t.getAttributionData();this._pendingDfds[u]=1;C[u]=x;x.addBoth(m.partial(this._onAttributionLoad,this,t))}else C[u]=t.copyright||t.copyrightText||"",C[u]?(t.suspended||this._activeLayers.push(u),this._createNode(u)):this._onLayerRemove(t);-1<t.declaredClass.toLowerCase().indexOf("vetiledlayer")&&(this._layerHandles[u]=t.on("map-style-change",m.hitch(this,function(){this._onLayerRemove(t);this._onLayerAdd(t)})))}}catch(l){}},
_onAttributionLoad:function(t,C,u){var x=t._attributions,l=t._pendingDfds,v=C.id;if(l&&l[v]){delete l[v];if(!u||u instanceof Error)u="";x[v]=u?t._createIndexByLevel(u,-1!==C.declaredClass.toLowerCase().indexOf("vetiledlayer")):C.copyright||C.copyrightText||"";x[v]?(C.suspended||t._activeLayers.push(v),t._createNode(v)):t._onLayerRemove(C)}},_onLayerRemove:function(t){try{var C=t.id,u=this.itemNodes,x=-1;this._onLayerSuspend(t);this._layerHandles[C]&&this._layerHandles[C].remove();delete this._attributions[C];
delete this._pendingDfds[C];delete this._layerHandles[C];var l=this._getGroupIndex(C);-1!==l&&(x=a.indexOf(this._sharedLayers[l],C),-1!==x&&(this._sharedLayers[l].splice(x,1),1>=this._sharedLayers[l].length&&this._sharedLayers.splice(l,1)));u[C]&&-1===x&&f.destroy(u[C]);delete u[C];this._updateLastItem()}catch(v){}},_onLayerSuspend:function(t){try{var C=t.id;if(this._attributions[C]){var u=a.indexOf(this._activeLayers,C),x=this.itemNodes[C];-1!==u&&this._activeLayers.splice(u,1);x&&this._toggleItem(x,
!1,this._getGroupIndex(C))}}catch(l){}},_adjustFocus:function(){var t=this.domNode.scrollWidth>this.domNode.clientWidth,C=e.contains(this.domNode,"esriAttributionOpen");n.set(this.domNode,"tabIndex",t||C?"0":"")},_onLayerResume:function(t){try{var C=t.id,u=this._attributions[C],x=this.itemNodes[C];if(u&&(-1===a.indexOf(this._activeLayers,C)&&this._activeLayers.push(C),x)){var l=m.isString(u)?u:this._getContributorsList(u,this.map.extent,this.map.getLevel());m.isString(u)||n.set(x,"innerHTML",l?l+
this._getDelimiter():"");l&&this._toggleItem(x,!0,this._getGroupIndex(C))}}catch(v){}},_onExtentChange:function(t,C,u,x){try{var l=this._activeLayers,v=this._attributions,A=this.itemNodes,B,E,G=l.length||0;for(E=0;E<G;E++){var I=l[E];var L=v[I];if((B=A[I])&&!m.isString(L)){var K=this._getContributorsList(L,t,x?x.level:-1);n.set(B,"innerHTML",K?K+this._getDelimiter():"");this._toggleItem(B,!!K,-1)}}}catch(ba){}this._adjustCursorStyle()},_createNode:function(t){if(this.domNode){var C=this._checkShareInfo(t),
u=C&&C.sharedWith;u=u&&this.itemNodes[u];var x=this.map,l=this._attributions[t];l=m.isString(l)?l:this._getContributorsList(l,x.extent,x.getLevel());x=!!l&&!x.getLayer(t).suspended;u?(this.itemNodes[t]=u,this._toggleItem(u,x,C.index)):(t=this.itemNodes[t]=f.create("span",{"class":this.itemClass,innerHTML:l?l+this._getDelimiter():"",style:{display:x?"inline":"none"}},this.listNode),x&&this._setLastItem(t));this._adjustCursorStyle()}},_checkShareInfo:function(t){var C=this._attributions,u,x=-1,l=C[t];
if(l&&m.isString(l)){for(u in C){var v=C[u];if(u!==t&&v&&m.isString(v)&&v.length===l.length&&v.toLowerCase()===l.toLowerCase()){var A=u;break}}C=this._sharedLayers;v=C.length;if(A){for(u=0;u<v;u++)if(l=C[u],-1!==a.indexOf(l,A)){x=u;l.push(t);break}-1===x&&(x=C.push([A,t])-1)}}return-1<x?{index:x,sharedWith:A}:null},_getGroupIndex:function(t){var C=this._sharedLayers,u,x=C.length,l=-1;for(u=0;u<x;u++)if(-1!==a.indexOf(C[u],t)){l=u;break}return l},_getDelimiter:function(){var t=this.itemDelimiter;return t?
"\x3cspan class\x3d'"+this.delimiterClass+"'\x3e"+t+"\x3c/span\x3e":""},_toggleItem:function(t,C,u){if(-1<u&&!C){u=this._sharedLayers[u];var x,l=u.length,v=this._activeLayers;for(x=0;x<l;x++)if(-1!==a.indexOf(v,u[x]))return}d.set(t,"display",C?"inline":"none");this._updateLastItem()},_updateLastItem:function(){var t=this.listNode.childNodes;var C=t.length;if(C)for(--C;0<=C;C--){var u=t[C];if("none"!==d.get(u,"display")){this._setLastItem(u);break}}this._adjustCursorStyle()},_setLastItem:function(t){var C=
this.itemClass,u=this.lastItemClass;this._lastItem&&e.replace(this._lastItem,C,u);t&&(e.replace(t,u,C),this._lastItem=t)},_createIndexByLevel:function(t,C){var u=t.contributors,x,l,v=u?u.length:0,A,B=new g(4326),E={};for(l=0;l<v;l++){var G=u[l];var I=(x=G.coverageAreas)?x.length:0;for(A=0;A<I;A++){var L=x[A];var K=L.bbox;K={extent:k.geographicToWebMercator(new w(K[1],K[0],K[3],K[2],B)),attribution:G.attribution||"",zoomMin:L.zoomMin-(C&&L.zoomMin?1:0),zoomMax:L.zoomMax-(C&&L.zoomMax?1:0),score:h.isDefined(L.score)?
L.score:100,objectId:l};for(L=K.zoomMin;L<=K.zoomMax;L++)E[L]=E[L]||[],E[L].push(K)}}return E},_getContributorsList:function(t,C,u){var x="";if(C&&h.isDefined(u)&&-1<u){t=t[u];u=C.getCenter().normalize();var l=t?t.length:0,v=[],A={};for(x=0;x<l;x++)C=t[x],!A[C.objectId]&&C.extent.contains(u)&&(A[C.objectId]=1,v.push(C));v.sort(function(B,E){return E.score-B.score||B.objectId-E.objectId});l=v.length;for(x=0;x<l;x++)v[x]=v[x].attribution;x=v.join(", ")}return x},_adjustCursorStyle:function(){var t=
b.position(this.listNode.parentNode,!0).h;e.contains(this.listNode.parentNode,"esriAttributionOpen")?(e.remove(this.listNode.parentNode,"esriAttributionOpen"),t>b.position(this.listNode.parentNode,!0).h?(d.set(this.listNode.parentNode,"cursor","pointer"),e.add(this.listNode.parentNode,"esriAttributionOpen")):d.set(this.listNode.parentNode,"cursor","default")):(e.add(this.listNode.parentNode,"esriAttributionOpen"),t<b.position(this.listNode.parentNode,!0).h?d.set(this.listNode.parentNode,"cursor",
"pointer"):d.set(this.listNode.parentNode,"cursor","default"),e.remove(this.listNode.parentNode,"esriAttributionOpen"));this._adjustFocus()}});m.setObject("dijit.Attribution",F,c);return F})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(F,m,a,D){F=new F;m.id=D.safeMixin(F,a);return m.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g){m=m([h],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(k){z.mixin(this,k);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/label\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/label\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(k,w,t){this._nls||(this._nls=g.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var C=this._loginDialog,u=t&&t.error,x=t&&t.token,l=new D(function(){C.onCancel()});if(C.open)return k=Error("BUSY"),k.name="identity-manager:busy",k.code="IdentityManager.1",k.log=!!a.isDebug,l.errback(k),l;b.hide(C.errMsg_);u&&403==u.code&&x&&(r.set(C.errMsg_,"innerHTML",this._nls.forbidden),
b.show(C.errMsg_));C.dfd_=l;C.serverInfo_=w;C.resUrl_=k;C.admin_=t&&t.isAdmin;r.set(C.resLink_,{title:k,innerHTML:"("+(this.getResourceName(k)||this._nls.lblItem)+")"});r.set(C.serverLink_,{title:w.server,innerHTML:(-1!==w.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":w.server)+" "});C.txtPwd_.set("value","");C.show();return l},_createLoginDialog:function(){var k=this._nls,w=e.substitute(k,this._dialogContent);w=e.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},w);var t=new f({title:k.title,content:w,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(C){C.charOrCode===q.ENTER&&this.execute_()},execute_:function(){var C=this.txtUser_.get("value"),u=this.txtPwd_.get("value"),x=this.dfd_,l=this;if(this.form_.validate()&&C&&u){this.btnSubmit_.set("label",k.lblSigning);var v=d.id.findCredential(l.resUrl_,C),A=function(B){l.btnSubmit_.set("label",
k.lblOk);l.btnSubmit_.set("disabled",!1);b.hide(l.errMsg_);l.hide();f._DialogLevelManager.hide(l);var E=l.serverInfo_;l.dfd_=l.serverInfo_=l.generateDfd_=l.resUrl_=null;var G=v;if(B){var I=B.token;var L=e.isDefined(B.expires)?Number(B.expires):null;var K=!!B.ssl;G?(G.userId=C,G.token=I,G.expires=L,G.validity=B.validity,G.ssl=K,G.creationTime=(new Date).getTime()):G=new c({userId:C,server:E.server,token:I,expires:L,ssl:K,isAdmin:l.admin_,validity:B.validity})}x.callback(G)};v&&!v._enqueued?A():(l.btnSubmit_.set("disabled",
!0),l.generateDfd_=d.id.generateToken(this.serverInfo_,{username:C,password:u},{isAdmin:this.admin_}).addCallback(A).addErrback(function(B){l.btnSubmit_.set("disabled",!1);l.generateDfd_=null;l.btnSubmit_.set("label",k.lblOk);r.set(l.errMsg_,"innerHTML",B&&B.code?k.invalidUser:k.noAuthService);b.show(l.errMsg_)}))}},cancel_:function(){t.generateDfd_&&t.generateDfd_.cancel();var C=t.dfd_,u=t.resUrl_,x=t.serverInfo_;t.btnSubmit_.set("disabled",!1);t.dfd_=t.serverInfo_=t.generateDfd_=t.resUrl_=null;
b.hide(t.errMsg_);f._DialogLevelManager.hide(t);t.esriIdMgr_.onDialogCancel({resourceUrl:u,serverInfo:x});u=Error("ABORTED");u.name="identity-manager:user-aborted";u.code="IdentityManager.2";u.log=!!a.isDebug;C.errback(u)}});w=t.domNode;t.form_=n.byNode(F.query(".esriIdForm",w)[0]);t.txtUser_=n.byNode(F.query(".esriIdUser",w)[0]);t.txtPwd_=n.byNode(F.query(".esriIdPwd",w)[0]);t.btnSubmit_=n.byNode(F.query(".esriIdSubmit",w)[0]);t.btnCancel_=n.byNode(F.query(".esriIdCancel",w)[0]);t.resLink_=F.query(".resLink",
w)[0];t.serverLink_=F.query(".serverLink",w)[0];t.errMsg_=F.query(".esriErrorMsg",w)[0];t.connect(t.txtUser_,"onKeyPress",t.keypressed_);t.connect(t.txtPwd_,"onKeyPress",t.keypressed_);t.connect(t.btnSubmit_,"onClick",t.execute_);t.connect(t.btnCancel_,"onClick",t.onCancel);t.connect(t,"onCancel",t.cancel_);return t}});return d.IdentityManagerDialog=d.IdentityManager=m})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/touch dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K){function ba(){}var T=new z;T.resolve(!0);x=D("dijit._DialogBase"+(g("dojo-bidi")?"_NoBidi":""),[v,B,E,A],{templateString:K,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:x.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(Z){this._set("draggable",Z)},maxRatio:.9,
closable:!0,_setClosableAttr:function(Z){this.closeButtonNode.style.display=Z?"":"none";this._set("closable",Z)},postMixInProperties:function(){var Z=d.getLocalization("dijit","common");b.mixin(this,Z);this.inherited(arguments)},postCreate:function(){n.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);a.after(this,"onExecute",b.hitch(this,"hide"),!0);a.after(this,"onCancel",b.hitch(this,"hide"),!0);c(this.closeButtonNode,
k.press,function(Z){Z.stopPropagation()});this._modalconnects=[]},onLoad:function(){this.resize();this._position();this.autofocus&&J.isTop(this)&&(this._getFocusItems(),u.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();u.focus(this._firstFocusItem)},_endDrag:function(){var Z=q.position(this.domNode),Y=w.getBox(this.ownerDocument);Z.y=Math.min(Math.max(Z.y,0),Y.h-Z.h);Z.x=Math.min(Math.max(Z.x,0),Y.w-Z.w);this._relativePosition=Z;this._position()},_setup:function(){var Z=
this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==g("ie")?C:t)(Z,{handle:this.titleBar}),a.after(this._moveable,"onMoveStop",b.hitch(this,"_endDrag"),!0)):r.add(Z,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":m.map(this["class"].split(/\s/),function(Y){return Y+"_underlay"}).join(" "),_onKeyDown:b.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!r.contains(this.ownerDocumentBody,"dojoMove")){var Z=
this.domNode,Y=w.getBox(this.ownerDocument),qa=this._relativePosition,V=q.position(Z);n.set(Z,{left:Math.floor(Y.l+(qa?Math.min(qa.x,Y.w-V.w):(Y.w-V.w)/2))+"px",top:Math.floor(Y.t+(qa?Math.min(qa.y,Y.h-V.h):(Y.h-V.h)/2))+"px"})}},_onKey:function(Z){if(Z.keyCode==e.TAB){this._getFocusItems();var Y=Z.target;this._firstFocusItem==this._lastFocusItem?(Z.stopPropagation(),Z.preventDefault()):Y==this._firstFocusItem&&Z.shiftKey?(u.focus(this._lastFocusItem),Z.stopPropagation(),Z.preventDefault()):Y!=this._lastFocusItem||
Z.shiftKey||(u.focus(this._firstFocusItem),Z.stopPropagation(),Z.preventDefault())}else this.closable&&Z.keyCode==e.ESCAPE&&(this.onCancel(),Z.stopPropagation(),Z.preventDefault())},show:function(){if(this.open)return T.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),J.hide(this));var Z=w.get(this.ownerDocument);this._modalconnects.push(c(Z,"scroll",b.hitch(this,"resize",null)));this._modalconnects.push(c(this.domNode,
"keydown",b.hitch(this,"_onKey")));n.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();this._fadeInDeferred=new z(b.hitch(this,function(){Y.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,ba);Z=this._fadeInDeferred.promise;var Y=f.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:b.hitch(this,function(){J.show(this,this.underlayAttrs)}),onEnd:b.hitch(this,function(){this.autofocus&&J.isTop(this)&&(this._getFocusItems(),
u.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return Z},hide:function(){if(!this._alreadyInitialized||!this.open)return T.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred=new z(b.hitch(this,function(){Y.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,ba);this._fadeOutDeferred.then(b.hitch(this,"onHide"));var Z=this._fadeOutDeferred.promise;var Y=f.fadeOut({node:this.domNode,duration:this.duration,
onEnd:b.hitch(this,function(){this.domNode.style.display="none";J.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var qa;qa=this._modalconnects.pop();)qa.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return Z},resize:function(Z){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!Z){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),m.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(na){na&&n.set(na,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var Y=w.getBox(this.ownerDocument);Y.w*=this.maxRatio;Y.h*=this.maxRatio;var qa=q.position(this.domNode);this._shrunk=!1;qa.w>=Y.w&&(Z={w:Y.w},q.setMarginBox(this.domNode,Z),qa=q.position(this.domNode),
this._shrunk=!0);qa.h>=Y.h&&(Z||(Z={w:qa.w}),Z.h=Y.h,this._shrunk=!0);Z&&(Z.w||(Z.w=qa.w),Z.h||(Z.h=qa.h))}if(Z){q.setMarginBox(this.domNode,Z);Y=[];this.titleBar&&Y.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&Y.push({domNode:this.actionBarNode,region:"bottom"});qa={domNode:this.containerNode,region:"center"};Y.push(qa);var V=L.marginBox2contentBox(this.domNode,Z);L.layoutChildren(this.domNode,V,Y);this._singleChild?(Y=L.marginBox2contentBox(this.containerNode,qa),this._singleChild.resize({w:Y.w,
h:Y.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();g("touch")||Z||this._position()}},_layoutChildren:function(){m.forEach(this.getChildren(),function(Z){Z.resize&&Z.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var Z;Z=this._modalconnects.pop();)Z.remove();J.hide(this);this.inherited(arguments)}});g("dojo-bidi")&&
(x=D("dijit._DialogBase",x,{_setTitleAttr:function(Z){this._set("title",Z);this.titleNode.innerHTML=Z;this.applyTextDir(this.titleNode)},_setTextDirAttr:function(Z){this._created&&this.textDir!=Z&&(this._set("textDir",Z),this.set("title",this.title))}}));var P=D("dijit.Dialog",[I,x],{});P._DialogBase=x;var J=P._DialogLevelManager={_beginZIndex:950,show:function(Z,Y){N[N.length-1].focus=u.curNode;var qa=N[N.length-1].dialog?N[N.length-1].zIndex+2:P._DialogLevelManager._beginZIndex;n.set(Z.domNode,
"zIndex",qa);G.show(Y,qa-1);N.push({dialog:Z,underlayAttrs:Y,zIndex:qa})},hide:function(Z){if(N[N.length-1].dialog==Z){N.pop();var Y=N[N.length-1];1==N.length?G.hide():G.show(Y.underlayAttrs,Y.zIndex-1);if(Z.refocus&&(Z=Y.focus,!Y.dialog||Z&&y.isDescendant(Z,Y.dialog.domNode)||(Y.dialog._getFocusItems(),Z=Y.dialog._firstFocusItem),Z))try{Z.focus()}catch(qa){}}else Y=m.indexOf(m.map(N,function(qa){return qa.dialog}),Z),-1!=Y&&N.splice(Y,1)},isTop:function(Z){return N[N.length-1].dialog==Z}},N=P._dialogStack=
[{dialog:null,focus:null,underlayAttrs:null}];u.watch("curNode",function(Z,Y,qa){Z=N[N.length-1].dialog;if(qa&&Z&&!Z._fadeOutDeferred&&qa.ownerDocument==Z.ownerDocument){do if(qa==Z.domNode||r.contains(qa,"dijitPopup"))return;while(qa=qa.parentNode);Z.focus()}});g("dijit-legacy-requires")&&h(0,function(){F(["dijit/TooltipDialog"])});return P})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(F,m){var a=m.prototype.onMove;return F("dojo.dnd.TimedMoveable",m,{timeout:40,
constructor:function(D,z){z||(z={});z.timeout&&"number"==typeof z.timeout&&0<=z.timeout&&(this.timeout=z.timeout)},onMoveStop:function(D){D._timer&&(clearTimeout(D._timer),a.call(this,D,D._leftTop));m.prototype.onMoveStop.apply(this,arguments)},onMove:function(D,z){D._leftTop=z;if(!D._timer){var y=this;D._timer=setTimeout(function(){D._timer=null;a.call(y,D,D._leftTop)},this.timeout)}}})})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(F,m,a,D,z,y){return m("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(r){var q=[];F.forEach(r||this.getChildren(),function(n){"value"in n?q.push(n):q=q.concat(this._getDescendantFormWidgets(n.getChildren()))},this);return q},reset:function(){F.forEach(this._getDescendantFormWidgets(),function(r){r.reset&&r.reset()})},validate:function(){var r=!1;return F.every(F.map(this._getDescendantFormWidgets(),function(q){q._hasBeenBlurred=!0;var n=q.disabled||!q.validate||
q.validate();n||r||(y.scrollIntoView(q.containerNode||q.domNode),q.focus(),r=!0);return n}),function(q){return q})},setValues:function(r){a.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",r)},_setValueAttr:function(r){var q={};F.forEach(this._getDescendantFormWidgets(),function(e){e.name&&(q[e.name]||(q[e.name]=[])).push(e)});for(var n in q)if(q.hasOwnProperty(n)){var f=q[n],d=D.getObject(n,!1,r);void 0!==d&&(d=[].concat(d),
"boolean"==typeof f[0].checked?F.forEach(f,function(e){e.set("value",-1!=F.indexOf(d,e._get("value")))}):f[0].multiple?f[0].set("value",d):F.forEach(f,function(e,b){e.set("value",d[b])}))}},getValues:function(){a.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var r={};F.forEach(this._getDescendantFormWidgets(),function(q){var n=q.name;if(n&&!q.disabled){var f=q.get("value");"boolean"==typeof q.checked?
/Radio/.test(q.declaredClass)?!1!==f?D.setObject(n,f,r):(f=D.getObject(n,!1,r),void 0===f&&D.setObject(n,null,r)):(q=D.getObject(n,!1,r),q||(q=[],D.setObject(n,q,r)),!1!==f&&q.push(f)):(q=D.getObject(n,!1,r),"undefined"!=typeof q?D.isArray(q)?q.push(f):D.setObject(n,[q,f],r):D.setObject(n,f,r))}});return r},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var r=F.map(this._descendants,function(q){return q.get("state")||""});return 0<=F.indexOf(r,"Error")?
"Error":0<=F.indexOf(r,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(r){this._descendants=this._getDescendantFormWidgets();F.forEach(this._descendants,function(q){q._started||q.startup()});r||this._onChildChange()},_onChildChange:function(r){r&&"state"!=r&&"disabled"!=r||this._set("state",this._getState());r&&"value"!=r&&"disabled"!=r&&"checked"!=r||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var r=this;this.own(z(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(q){q.target!=r.domNode&&r._onChildChange(q.type.replace("attrmodified-",""))}));this.watch("state",function(q,n,f){this.onValidStateChange(""==f)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(F,m){return F("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var a=m._getTabNavigable(this.domNode);this._firstFocusItem=a.lowest||a.first||this.closeButtonNode||this.domNode;this._lastFocusItem=a.last||a.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e){var b=F("dijit.DialogUnderlay",[q,n],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(c){D.set(this.node,"id",c+"_underlay");this._set("dialogId",c)},_setClassAttr:function(c){this.node.className="dijitDialogUnderlay "+c;this._set("class",c)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(y(this.domNode,"keydown",m.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var c=this.node.style,h=this.domNode.style;h.display="none";var g=r.getBox(this.ownerDocument);h.top=g.t+"px";h.left=g.l+"px";c.width=g.w+"px";c.height=g.h+"px";h.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new f(this.domNode);var c=r.get(this.ownerDocument);this._modalConnects=[d.on("resize",m.hitch(this,"layout")),y(c,"scroll",
m.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});b.show=function(c,h){var g=b._singleton;!g||g._destroyed?g=e._underlay=b._singleton=new b(c):c&&g.set(c);z.set(g.domNode,"zIndex",h);g.open||g.show()};b.hide=function(){var c=
b._singleton;c&&!c._destroyed&&c.hide()};return b})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g){return n("dijit.layout.ContentPane",[a,D,z],{href:"",content:"",extractContent:!1,parseOnLoad:!0,
parserScope:F._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(k,
w,t){var C=new t(k,w);return!C.href&&C._contentSetter&&C._contentSetter.parseDeferred&&!C._contentSetter.parseDeferred.isFulfilled()?C._contentSetter.parseDeferred.then(function(){return C}):C},create:function(k,w){if(!(k&&k.template||!w||"href"in k||"content"in k)){w=d.byId(w);for(var t=w.ownerDocument.createDocumentFragment();w.firstChild;)t.appendChild(w.firstChild);k=m.delegate(k,{content:t})}this.inherited(arguments,[k,w])},postMixInProperties:function(){this.inherited(arguments);var k=h.getLocalization("dijit",
"loading",this.lang);this.loadingMessage=y.substitute(this.loadingMessage,k);this.errorMessage=y.substitute(this.errorMessage,k)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&q.forEach(this._contentSetter.parseResults,function(k){k._started||k._destroyed||!m.isFunction(k.startup)||(k.startup(),k._started=!0)},this)},_startChildren:function(){q.forEach(this.getChildren(),
function(k){k._started||k._destroyed||!m.isFunction(k.startup)||(k.startup(),k._started=!0)});this._contentSetter&&q.forEach(this._contentSetter.parseResults,function(k){k._started||k._destroyed||!m.isFunction(k.startup)||(k.startup(),k._started=!0)},this)},setHref:function(k){F.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0");return this.set("href",k)},_setHrefAttr:function(k){this.cancel();this.onLoadDeferred=new f(m.hitch(this,"cancel"));this.onLoadDeferred.then(m.hitch(this,
"onLoad"));this._set("href",k);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(k){F.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",k)},_setContentAttr:function(k){this._set("href","");this.cancel();this.onLoadDeferred=new f(m.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(m.hitch(this,"onLoad"));this._setContent(k||"");this._isDownloaded=
!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(k){this._beingDestroyed||this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},
refresh:function(){this.cancel();this.onLoadDeferred=new f(m.hitch(this,"cancel"));this.onLoadDeferred.then(m.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var k=this,w={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};m.isObject(this.ioArgs)&&m.mixin(w,this.ioArgs);var t=this._xhrDfd=(this.ioMethod||c.get)(w),C;t.then(function(u){C=u;try{return k._isDownloaded=!0,k._setContent(u,!1)}catch(x){k._onError("Content",
x)}},function(u){t.canceled||k._onError("Download",u);delete k._xhrDfd;return u}).then(function(){k.onDownloadEnd();delete k._xhrDfd;return C});delete this._hrefChanged},_onLoadHandler:function(k){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(k)}catch(w){}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(k){}},destroyDescendants:function(k){this.isLoaded&&this._onUnloadHandler();var w=this._contentSetter;q.forEach(this.getChildren(),function(t){t.destroyRecursive?
t.destroyRecursive(k):t.destroy&&t.destroy(k);t._destroyed=!0});w&&(q.forEach(w.parseResults,function(t){t._destroyed||(t.destroyRecursive?t.destroyRecursive(k):t.destroy&&t.destroy(k),t._destroyed=!0)}),delete w.parseResults);k||b.empty(this.containerNode);delete this._singleChild},_setContent:function(k,w){k=this.preprocessContent(k);this.destroyDescendants();var t=this._contentSetter;t&&t instanceof r._ContentSetter||(t=this._contentSetter=new r._ContentSetter({node:this.containerNode,_onError:m.hitch(this,
this._onError),onContentError:m.hitch(this,function(x){x=this.onContentError(x);try{this.containerNode.innerHTML=x}catch(l){}})}));var C=m.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!k.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{});C=t.set(m.isObject(k)&&k.domNode?k.domNode:k,C);var u=this;return g(C&&C.then?C:t.parseDeferred,function(){delete u._contentSetterParams;
w||(u._started&&(u._startChildren(),u._scheduleLayout()),u._onLoadHandler(k))})},preprocessContent:function(k){return k},_onError:function(k,w,t){this.onLoadDeferred.reject(w);k=this["on"+k+"Error"].call(this,w);t||k&&this._setContent(k,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),
function(F,m,a,D,z,y,r,q,n,f){return m("dijit.layout._ContentPaneResizeMixin",null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var d=this.getParent();this._childOfLayoutWidget=d&&d.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(n.on("resize",y.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var d=[],e=!1;r("\x3e *",this.containerNode).some(function(b){var c=
q.byNode(b);c&&c.resize?d.push(c):!/script|link|style/i.test(b.nodeName)&&b.offsetHeight&&(e=!0)});this._singleChild=1!=d.length||e?null:d[0];a.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(d,e){this._resizeCalled=!0;this._scheduleLayout(d,e)},_scheduleLayout:function(d,e){this._isShown()?this._layout(d,e):(this._needLayout=!0,this._changeSize=d,this._resultSize=e)},_layout:function(d,e){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();
d&&D.setMarginBox(this.domNode,d);var b=this.containerNode;if(b===this.domNode){var c=e||{};y.mixin(c,d||{});"h"in c&&"w"in c||(c=y.mixin(D.getMarginBox(b),c));this._contentBox=f.marginBox2contentBox(b,c)}else this._contentBox=D.getContentBox(b);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var d=this._contentBox||D.getContentBox(this.containerNode);this._singleChild.resize({w:d.w,h:d.h})}else{d=this.getChildren();for(var e,
b=0;e=d[b++];)e.resize&&e.resize()}},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var d=this.domNode,e=this.domNode.parentNode;return"none"!=d.style.display&&"hidden"!=d.style.visibility&&!a.contains(d,"dijitHidden")&&e&&e.style&&"none"!=e.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array",
"dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],function(F,m,a,D,z){function y(n){return n.substring(0,1).toUpperCase()+n.substring(1)}function r(n,f){var d=n.resize?n.resize(f):a.setMarginBox(n.domNode,f);d?z.mixin(n,d):(z.mixin(n,a.getMarginBox(n.domNode)),z.mixin(n,f))}var q={marginBox2contentBox:function(n,f){var d=D.getComputedStyle(n),e=a.getMarginExtents(n,d),b=a.getPadBorderExtents(n,d);return{l:D.toPixelValue(n,d.paddingLeft),t:D.toPixelValue(n,d.paddingTop),w:f.w-
(e.w+b.w),h:f.h-(e.h+b.h)}},layoutChildren:function(n,f,d,e,b){f=z.mixin({},f);m.add(n,"dijitLayoutContainer");d=F.filter(d,function(c){return"center"!=c.region&&"client"!=c.layoutAlign}).concat(F.filter(d,function(c){return"center"==c.region||"client"==c.layoutAlign}));F.forEach(d,function(c){var h=c.domNode,g=c.region||c.layoutAlign;if(!g)throw Error("No region setting for "+c.id);var k=h.style;k.left=f.l+"px";k.top=f.t+"px";k.position="absolute";m.add(h,"dijitAlign"+y(g));h={};e&&e==c.id&&(h["top"==
c.region||"bottom"==c.region?"h":"w"]=b);"leading"==g&&(g=c.isLeftToRight()?"left":"right");"trailing"==g&&(g=c.isLeftToRight()?"right":"left");"top"==g||"bottom"==g?(h.w=f.w,r(c,h),f.h-=c.h,"top"==g?f.t+=c.h:k.top=f.t+f.h+"px"):"left"==g||"right"==g?(h.h=f.h,r(c,h),f.w-=c.w,"left"==g?f.l+=c.w:k.left=f.l+f.w+"px"):"client"!=g&&"center"!=g||r(c,f)})}};z.setObject("dijit.layout.utils",q);return q})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),
function(F,m,a,D,z,y,r){var q=0,n={_secureForInnerHtml:function(f){return f.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"")},_emptyNode:y.empty,_setNodeContent:function(f,d){y.empty(f);if(d)if("number"==typeof d&&(d=d.toString()),"string"==typeof d&&(d=y.toDom(d,f.ownerDocument)),!d.nodeType&&m.isArrayLike(d))for(var e=d.length,b=0;b<d.length;b=e==d.length?b+1:0)y.place(d[b],f,"last");else y.place(d,f,"last");return f},_ContentSetter:D("dojo.html._ContentSetter",null,{node:"",
content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:F._scopeName,startup:!0,constructor:function(f,d){m.mixin(this,f||{});d=this.node=z.byId(this.node||d);this.id||(this.id=["Setter",d?d.id||d.tagName:"",q++].join("_"))},set:function(f,d){void 0!==f&&(this.content=f);"number"==typeof f&&(f=f.toString());d&&this._mixin(d);this.onBegin();this.setContent();var e=this.onEnd();return e&&e.then?e:this.node},setContent:function(){var f=this.node;if(!f)throw Error(this.declaredClass+
": setContent given no node");try{f=n._setNodeContent(f,this.content)}catch(e){var d=this.onContentError(e);try{f.innerHTML=d}catch(b){}}this.node=f},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(a.forEach(this.parseResults,function(f){f.destroy&&f.destroy()}),delete this.parseResults);y.empty(this.node)},onBegin:function(){var f=this.content;if(m.isString(f)&&(this.cleanContent&&
(f=n._secureForInnerHtml(f)),this.extractContent)){var d=f.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);d&&(f=d[1])}this.empty();this.content=f;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(f){return"Error occurred setting content: "+f},onExecError:function(f){return"Error occurred executing scripts: "+f},_mixin:function(f){var d=
{},e;for(e in f)e in d||(this[e]=f[e])},_parse:function(){var f=this.node;try{var d={};a.forEach(["dir","lang","textDir"],function(b){this[b]&&(d[b]=this[b])},this);var e=this;this.parseDeferred=r.parse({rootNode:f,noStart:!this.startup,inherited:d,scope:this.parserScope}).then(function(b){return e.parseResults=b},function(b){e._onError("Content",b,"Error parsing in _ContentSetter#"+e.id)})}catch(b){this._onError("Content",b,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(f,d,e){f=
this["on"+f+"Error"].call(this,d);e||f&&n._setNodeContent(this.node,f,!0)}}),set:function(f,d,e){void 0==d&&(d="");"number"==typeof d&&(d=d.toString());return e?(new n._ContentSetter(m.mixin(e,{content:d,node:f}))).set():n._setNodeContent(f,d,!0)}};m.setObject("dojo.html",n);return n})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(F,m,a,D){F=F(D.Credential,{});return a.Credential=F})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/url dojo/sniff dojo/io-query dojo/on ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t){var C={},u=function(B){var E=(new y(B.owningSystemUrl)).host;B=(new y(B.server)).host;var G=/.+\.arcgis\.com$/i;return G.test(E)&&G.test(B)},x=function(B,E){return!!(u(B)&&E&&D.some(E,function(G){return G.test(B.server)}))},l=null,v=null;try{l=window.localStorage,v=window.sessionStorage}catch(B){}r=F(k,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=a.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=
[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=[];this._getOAuthLocationParams();n(window,"pageshow",a.hitch(this,this._pageShowHandler))},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,normalizeWebTierAuth:!1,_appUrlObj:c.urlToObject(window.location.href),_postMessageAuthHandle:null,_busy:null,_rejectOnPersistedPageShow:!1,_oAuthLocationParams:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i,
_adminSvcs:/\/rest\/admin\/services(\/|$)/i,_gwDomains:[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},
{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(B){var E=this.serverInfos;E?(B=D.filter(B,function(G){return!this.findServerInfo(G.server)},this),this.serverInfos=E.concat(B)):
this.serverInfos=B;D.forEach(B,function(G){G.owningSystemUrl&&this._portals.push(G.owningSystemUrl);if(G.hasPortal){this._portals.push(G.server);var I=d.defaults.io.corsEnabledServers,L=this._getOrigin(G.tokenServiceUrl);c.canUseXhr(G.server)||I.push(G.server.replace(/^https?:\/\//i,""));c.canUseXhr(L)||I.push(L.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(B){var E=this.oAuthInfos;E?(D.forEach(B,function(G){(G=this.findOAuthInfo(G.portalUrl))&&E.splice(E.indexOf(G),1)},this),
this.oAuthInfos=E.concat(B)):this.oAuthInfos=B},registerToken:function(B){B=e.mixin({},B);var E=this._sanitizeUrl(B.server),G=this.findServerInfo(E),I=!0,L;G||(G=new b,G.server=this._getServerInstanceRoot(E),G.tokenServiceUrl=this._getTokenSvcUrl(E),G.hasPortal=!0,this.registerServers([G]));(L=this.findCredential(E,B.userId))?(delete B.server,a.mixin(L,B),I=!1):(L=new A({userId:B.userId,server:G.server,token:B.token,expires:B.expires,ssl:B.ssl,scope:this._isServerRsrc(E)?"server":"portal"}),L.resources=
[E],this.credentials.push(L));L.onTokenChange(!1);I||L.refreshServerTokens()},toJson:function(){return e.fixJson({serverInfos:D.map(this.serverInfos,function(B){return B.toJson()}),oAuthInfos:D.map(this.oAuthInfos,function(B){return B.toJson()}),credentials:D.map(this.credentials,function(B){return B.toJson()})})},initialize:function(B){if(B){a.isString(B)&&(B=JSON.parse(B));var E=B.serverInfos,G=B.oAuthInfos;B=B.credentials;if(E){var I=[];D.forEach(E,function(K){K.server&&K.tokenServiceUrl&&I.push(K.declaredClass?
K:new b(K))});I.length&&this.registerServers(I)}if(G){var L=[];D.forEach(G,function(K){K.appId&&L.push(K.declaredClass?K:new t(K))});L.length&&this.registerOAuthInfos(L)}B&&D.forEach(B,function(K){K.userId&&K.server&&K.token&&K.expires&&K.expires>(new Date).getTime()&&(K=K.declaredClass?K:new A(K),K.onTokenChange(),this.credentials.push(K))},this)}},findServerInfo:function(B){var E;B=this._sanitizeUrl(B);D.some(this.serverInfos,function(G){this._hasSameServerInstance(G.server,B)&&(E=G);return!!E},
this);return E},findOAuthInfo:function(B){var E;B=this._sanitizeUrl(B);D.some(this.oAuthInfos,function(G){this._hasSameServerInstance(G.portalUrl,B)&&(E=G);return!!E},this);return E},findCredential:function(B,E){var G;B=this._sanitizeUrl(B);var I=this._isServerRsrc(B)?"server":"portal";E?D.some(this.credentials,function(L){this._hasSameServerInstance(L.server,B)&&E===L.userId&&L.scope===I&&(G=L);return!!G},this):D.some(this.credentials,function(L){this._hasSameServerInstance(L.server,B)&&-1!==this._getIdenticalSvcIdx(B,
L)&&L.scope===I&&(G=L);return!!G},this);return G},getCredential:function(B,E){var G=!0;if(e.isDefined(E))if(a.isObject(E)){var I=!!E.token;var L=E.error;G=!1!==E.prompt}else I=E;B=this._sanitizeUrl(B);var K=new z(h._dfdCanceller),ba=this._isAdminResource(B);if((I=I?this.findCredential(B):null)&&L&&498===L.code)I.destroy();else if(I)return G=Error("You are currently signed in as: '"+I.userId+"'. You do not have access to this resource: "+B),G.name="identity-manager:not-authorized",G.code="IdentityManagerBase.1",
G.httpCode=L&&L.httpCode,G.messageCode=L?L.messageCode:null,G.subcode=L?L.subcode:null,G.details=L?L.details:null,G.log=!!m.isDebug,K.errback(G),K;if(L=this._findCredential(B,E))return K.callback(L),K;var T=this.findServerInfo(B);if(T)!T.hasServer&&this._isServerRsrc(B)&&(T._restInfoDfd=this._getTokenSvcUrl(B,!0),T.hasServer=!0);else{L=this._getTokenSvcUrl(B);if(!L)return G=Error("Unknown resource - could not find token service endpoint."),G.name="identity-manager:unknown-resource",G.code="IdentityManagerBase.2",
G.log=!!m.isDebug,K.errback(G),K;T=new b;T.server=this._getServerInstanceRoot(B);a.isString(L)?(T.tokenServiceUrl=L,T.hasPortal=!0):(T._restInfoDfd=L,T.hasServer=!0);this.registerServers([T])}T.hasPortal&&void 0===T._selfReq&&(G||c.hasSameOrigin(T.tokenServiceUrl,window.location.origin)||this._gwDomains.some(function(P){return P.tokenServiceUrl===T.tokenServiceUrl}))&&(T._selfReq={owningTenant:E&&E.owningTenant,selfDfd:this._getPortalSelf(T.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),
B)});return this._enqueue(B,T,E,K,ba)},getResourceName:function(B){return this._isRESTService(B)?B.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(B)&&B.replace(this._gwUser,"$1")||this._gwItem.test(B)&&B.replace(this._gwItem,"$1")||this._gwGroup.test(B)&&B.replace(this._gwGroup,"$1")||""},generateToken:function(B,E,G){var I=this._rePortalTokenSvc.test(B.tokenServiceUrl),L=new y(window.location.href.toLowerCase()),K=!E;var ba=B.shortLivedTokenValidity;if(E){var T=
f.id.tokenValidity||ba||f.id.defaultTokenValidity;T>ba&&(T=ba)}if(G){var P=G.isAdmin;var J=G.serverUrl;var N=G.token;var Z=G.ssl;B.customParameters=G.customParameters}if(P)ba=B.adminTokenServiceUrl;else{ba=B.tokenServiceUrl;var Y=new y(ba.toLowerCase());B.webTierAuth&&G&&G.serverUrl&&!Z&&"http"===L.scheme&&(c.hasSameOrigin(L.uri,ba,!0)||"https"===Y.scheme&&L.host===Y.host&&"7080"===L.port&&"7443"===Y.port)&&(ba=ba.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));K&&I&&(ba=ba.replace(/\/rest/i,
""))}P=a.mixin({url:ba,content:a.mixin({request:"getToken",username:E&&E.username,password:E&&E.password,serverUrl:J,token:N,expiration:T,referer:P||I?window.location.host:null,client:P?"referer":null,f:"json"},B.customParameters),handleAs:"json",callbackParamName:K?"callback":void 0},G&&G.ioArgs);G={usePost:!K,disableIdentityLookup:!0,useProxy:this._useProxy(B,G)};I||(P.withCredentials=!1);I=g(P,G);I.addCallback(function(qa){if(!qa||!qa.token)return qa=Error("Unable to generate token"),qa.name="identity-manager:authentication-failed",
qa.code="IdentityManagerBase.3",qa.log=!!m.isDebug,qa;var V=B.server;C[V]||(C[V]={});E&&(C[V][E.username]=E.password);qa.validity=T;return qa});I.addErrback(function(qa){});return I},isBusy:function(){return!!this._busy},checkSignInStatus:function(B){var E=new z;this.checkAppAccess(B,"").then(function(G){E.resolve(G.credential)})["catch"](function(G){E.reject(G)});return E},checkAppAccess:function(B,E,G){var I=this,L=!1;return this.getCredential(B,{prompt:!1}).then(function(K){var ba={f:"json"};if("portal"===
K.scope)if(E&&(I._doPortalSignIn(B)||G&&G.force)){var T=K.server+"/sharing/rest/oauth2/validateAppAccess";ba.client_id=E}else if(K.token)T=K.server+"/sharing/rest";else return{credential:K};else if(K.token)T=K.server+"/rest/services";else return{credential:K};K.token&&(ba.token=K.token);return g({url:T,content:ba,callbackParamName:"callback"},{disableIdentityLookup:!0}).then(function(P){if(!1===P.valid){var J=Error("You are currently signed in as: '"+K.userId+"'.  You do not have access to this app: '"+
E+"'.");J.name="identity-manager:not-authorized";J.code="IdentityManagerBase.1";J.log=!!m.isDebug;J.details=P;throw J;}L=!!P.viewOnlyUserTypeApp;return{credential:K}})["catch"](function(P){if("IdentityManagerBase.1"===P.code||400===P.code)throw 400===P.code&&(P.name="identity-manager:invalid-request"),P;if(498===P.code)throw K.destroy(),P=Error("User is not signed in."),P.name="identity-manager:not-authenticated",P.code="IdentityManagerBase.6",P.log=!!m.isDebug,P;return{credential:K}})}).then(function(K){return{credential:K.credential,
viewOnly:L}})},setProtocolErrorHandler:function(B){this._protocolFunc=B},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var B=this.credentials.slice();D.forEach(B,function(E){E.destroy()})}this.onCredentialsDestroy()},enablePostMessageAuth:function(B){B||(B="https://www.arcgis.com/sharing/rest");this._postMessageAuthHandle&&this._postMessageAuthHandle.remove();this._postMessageAuthHandle=
n(window,"message",function(E){(E.origin===window.location.origin||e.endsWith(E.origin,".arcgis.com"))&&E.data&&"arcgis:auth:requestCredential"===E.data.type&&this.getCredential(B).then(function(G){E.source.postMessage({type:"arcgis:auth:credential",credential:{expires:G.expires,server:G.server,ssl:G.ssl,token:G.token,userId:G.userId}},E.origin)})["catch"](function(G){E.source.postMessage({type:"arcgis:auth:error",error:{name:G.name,message:G.message}},E.origin)})}.bind(this))},disablePostMessageAuth:function(){this._postMessageAuthHandle&&
(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)},_getOAuthLocationParams:function(){var B=window.location.hash;if(B){"#"===B.charAt(0)&&(B=B.substring(1));B=q.queryToObject(B);var E=!1;if(B.access_token&&B.expires_in&&B.state&&B.hasOwnProperty("username"))try{B.state=JSON.parse(B.state),B.state.portalUrl&&(this._oAuthLocationParams=B,E=!0)}catch(I){}else if(B.error&&B.error_description&&"access_denied"===B.error&&(E=!0,B.state))try{B.state=JSON.parse(B.state)}catch(I){}E&&
(window.location.hash=B.state&&B.state.hash||"")}if(B=window.location.search){"?"===B.charAt(0)&&(B=B.substring(1));B=q.queryToObject(B);E=!1;if(B.code&&B.state)try{B.state=JSON.parse(B.state),B.state.portalUrl&&B.state.uid&&(this._oAuthLocationParams=B,E=!0)}catch(I){}else if(B.error&&B.error_description&&"access_denied"===B.error&&(E=!0,B.state))try{B.state=JSON.parse(B.state)}catch(I){}if(E){var G=e.mixin({},B);"code error error_description message_code persist state".split(" ").forEach(function(I){delete G[I]});
E=q.objectToQuery(G);window.history.replaceState(window.history.state,"",window.location.pathname+(E?"?"+E:"")+(B.state&&B.state.hash||""))}}},_getOAuthToken:function(B,E,G,I,L){B=B.replace(/^http:/i,"https:");return g({url:B+"/sharing/rest/oauth2/token",content:I&&L?{grant_type:"authorization_code",code:E,redirect_uri:I,client_id:G,code_verifier:L}:{grant_type:"refresh_token",refresh_token:E,client_id:G}},{disableIdentityLookup:!0,usePost:!0})},_pageShowHandler:function(B){B.persisted&&this.isBusy()&&
this._rejectOnPersistedPageShow&&(B=Error("ABORTED"),B.name="identity-manager:user-aborted",B.code="IdentityManager.2",B.log=!!m.isDebug,this._errbackFunc(B))},_findCredential:function(B,E){var G=-1,I,L,K=E&&E.token;var ba=E&&E.resource;var T=this._isServerRsrc(B)?"server":"portal",P=D.filter(this.credentials,function(Y){return this._hasSameServerInstance(Y.server,B)&&Y.scope===T},this);B=ba||B;if(P.length)if(1===P.length){ba=P[0];var J=(I=(L=this.findServerInfo(ba.server))&&L.owningSystemUrl)&&this.findCredential(I,
ba.userId);G=this._getIdenticalSvcIdx(B,ba);if(K)-1!==G&&(ba.resources.splice(G,1),this._removeResource(B,J));else return-1===G&&ba.resources.push(B),this._addResource(B,J),ba}else{var N,Z;D.some(P,function(Y){Z=this._getIdenticalSvcIdx(B,Y);return-1!==Z?(N=Y,J=(I=(L=this.findServerInfo(N.server))&&L.owningSystemUrl)&&this.findCredential(I,N.userId),G=Z,!0):!1},this);if(K)N&&(N.resources.splice(G,1),this._removeResource(B,J));else if(N)return this._addResource(B,J),N}},_findOAuthInfo:function(B){var E=
this.findOAuthInfo(B);E||D.some(this.oAuthInfos,function(G){this._isIdProvider(G.portalUrl,B)&&(E=G);return!!E},this);return E},_addResource:function(B,E){E&&-1===this._getIdenticalSvcIdx(B,E)&&E.resources.push(B)},_removeResource:function(B,E){var G=-1;E&&(G=this._getIdenticalSvcIdx(B,E),-1<G&&E.resources.splice(G,1))},_useProxy:function(B,E){return E&&E.isAdmin&&!c.hasSameOrigin(B.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(B.tokenServiceUrl)&&10.1==B.currentVersion&&!c.hasSameOrigin(B.tokenServiceUrl,
window.location.href)},_getOrigin:function(B){B=new y(B);return B.scheme+"://"+B.host+(e.isDefined(B.port)?":"+B.port:"")},_getServerInstanceRoot:function(B){var E=B.toLowerCase(),G=E.indexOf(this._agsRest);-1===G&&this._isAdminResource(B)&&(G=this._agsAdmin.test(B)?B.replace(this._agsAdmin,"$1").length:B.search(this._adminSvcs));-1===G&&(G=E.indexOf("/sharing"));-1===G&&"/"===E.substr(-1)&&(G=E.length-1);return-1<G?B.substring(0,G):B},_hasSameServerInstance:function(B,E){"/"===B.substr(-1)&&(B=B.slice(0,
-1));B=B.toLowerCase();E=this._getServerInstanceRoot(E).toLowerCase();B=this._normalizeAGOLorgDomain(B);E=this._normalizeAGOLorgDomain(E);B=B.substr(B.indexOf(":"));E=E.substr(E.indexOf(":"));return B===E},_normalizeAGOLorgDomain:function(B){var E=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,G=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,I=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;E.test(B)?B=B.replace(E,"https://www.arcgis.com"):G.test(B)?B=B.replace(G,"https://devext.arcgis.com"):
I.test(B)&&(B=B.replace(I,"https://qaext.arcgis.com"));return B},_sanitizeUrl:function(B){var E=(d.defaults.io.proxyUrl||"").toLowerCase(),G=E?B.toLowerCase().indexOf(E+"?"):-1;-1!==G&&(B=B.substring(G+E.length+1));B=c.normalize(B);return c.urlToObject(B).path},_isRESTService:function(B){return-1<B.indexOf(this._agsRest)},_isAdminResource:function(B){return this._agsAdmin.test(B)||this._adminSvcs.test(B)},_isServerRsrc:function(B){return this._isRESTService(B)||this._isAdminResource(B)},_isIdenticalService:function(B,
E){if(this._isRESTService(B)&&this._isRESTService(E)){var G=this._getSuffix(B).toLowerCase(),I=this._getSuffix(E).toLowerCase();var L=G===I;L||(L=/(.*)\/(MapServer|FeatureServer).*/ig,L=G.replace(L,"$1")===I.replace(L,"$1"))}else this._isAdminResource(B)&&this._isAdminResource(E)?L=!0:this._isServerRsrc(B)||this._isServerRsrc(E)||!this._isPortalDomain(B)||(L=!0);return L},_isPortalDomain:function(B){var E=new y(B.toLowerCase()),G=this._portalConfig;B=D.some(this._gwDomains,function(I){return I.regex.test(E.uri)});
!B&&G&&(B=this._hasSameServerInstance(this._getServerInstanceRoot(G.restBaseUrl),E.uri));B||(!this._arcgisUrl&&(G=a.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new y(G)).authority),this._arcgisUrl&&(B=this._arcgisUrl.toLowerCase()===E.authority));B||(B=D.some(this._portals,function(I){return this._hasSameServerInstance(I,E.uri)},this));return B=B||this._agsPortal.test(E.path)},_isIdProvider:function(B,E){var G=-1,I=-1;D.forEach(this._gwDomains,function(T,P){-1===G&&T.regex.test(B)&&
(G=P);-1===I&&T.regex.test(E)&&(I=P)});var L=!1;if(-1<G&&-1<I)if(0===G||4===G){if(0===I||4===I)L=!0}else if(1===G){if(1===I||2===I)L=!0}else 2===G?2===I&&(L=!0):3===G&&3===I&&(L=!0);if(!L){var K=this.findServerInfo(E),ba=K&&K.owningSystemUrl;ba&&u(K)&&this._isPortalDomain(ba)&&this._isIdProvider(B,ba)&&(L=!0)}return L},_isPublic:function(B){B=this._sanitizeUrl(B);return D.some(this._publicUrls,function(E){return E.test(B)})},_getIdenticalSvcIdx:function(B,E){var G=-1;D.some(E.resources,function(I,
L){return this._isIdenticalService(B,I)?(G=L,!0):!1},this);return G},_getSuffix:function(B){return B.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(B){if(this._isRESTService(B)||this._isAdminResource(B)){var E=this._getServerInstanceRoot(B);var G=E+"/admin/generateToken";B=E+"/rest/info";E=g({url:B,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});E.adminUrl_=G;return E}if(this._isPortalDomain(B)){var I="";D.some(this._gwDomains,function(L){L.regex.test(B)&&
(I=L.tokenServiceUrl);return!!I});I||D.some(this._portals,function(L){this._hasSameServerInstance(L,B)&&(I=L+this._gwTokenUrl);return!!I},this);I||(G=B.toLowerCase().indexOf("/sharing"),-1!==G&&(I=B.substring(0,G)+this._gwTokenUrl));I||(I=this._getOrigin(B)+this._gwTokenUrl);I&&(G=(new y(B)).port,/^http:\/\//i.test(B)&&"7080"===G&&(I=I.replace(/:7080/i,":7443")),I=I.replace(/http:/i,"https:"));return I}if(-1!==B.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},
_exchangeToken:function(B,E,G){return g({url:B+"/sharing/rest/oauth2/exchangeToken",content:{f:"json",client_id:E,token:G}},{disableIdentityLookup:!0,usePost:!0}).then(function(I){return I.token})},_getPlatformSelf:function(B,E){B=B.replace(/^http:/i,"https:");return g({url:B+"/sharing/rest/oauth2/platformSelf",content:{f:"json",expiration:30},headers:{"X-Esri-Auth-Client-Id":E,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},withCredentials:!0},{disableIdentityLookup:!0,usePost:!0})},
_getPortalSelf:function(B,E){var G="";D.some(this._gwDomains,function(L){L.regex.test(B)&&(G=L.customBaseUrl);return!!G});if(G){var I=new z;I.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:G,portalMode:"multitenant",supportsOAuth:!0});return I}"https:"===window.location.protocol?B=B.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(E)&&(B=B.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return g({url:B,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},
{crossOrigin:!1,disableIdentityLookup:!0})},_doPortalSignIn:function(B){var E=this._portalConfig,G=window.location.href,I=this.findServerInfo(B);return(E||this._isPortalDomain(G))&&(I?I.hasPortal||I.owningSystemUrl&&this._isPortalDomain(I.owningSystemUrl):this._isPortalDomain(B))&&(this._isIdProvider(G,B)||E&&(this._hasSameServerInstance(this._getServerInstanceRoot(E.restBaseUrl),B)||this._isIdProvider(E.restBaseUrl,B))||c.hasSameOrigin(G,B,!0))?!0:!1},_checkProtocol:function(B,E,G,I){var L=!0;I=
I?E.adminTokenServiceUrl:E.tokenServiceUrl;0!==a.trim(I).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||d.defaults.io.useCors&&(c.canUseXhr(I)||c.canUseXhr(c.getProxyUrl(!0).path))||(L=this._protocolFunc?!!this._protocolFunc({resourceUrl:B,serverInfo:E}):!1,L||(B=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),B.name="identity-manager:aborted",B.code="IdentityManagerBase.4",B.log=!!m.isDebug,G(B)));return L},_enqueue:function(B,
E,G,I,L,K){I||(I=new z(h._dfdCanceller));I.resUrl_=B;I.sinfo_=E;I.options_=G;I.admin_=L;I.refresh_=K;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(B),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(I)):this._xoReqs.push(I):this._doSignIn(I);return I},_doSignIn:function(B){this._busy=B;this._rejectOnPersistedPageShow=!1;var E=this,G=function(J){var N=B.options_&&B.options_.resource,Z=B.resUrl_,Y=B.refresh_,qa=!1;
-1===D.indexOf(E.credentials,J)&&(Y&&-1!==D.indexOf(E.credentials,Y)?(Y.userId=J.userId,Y.token=J.token,Y.expires=J.expires,Y.validity=J.validity,Y.ssl=J.ssl,Y.creationTime=J.creationTime,qa=!0,J=Y):E.credentials.push(J));J.resources||(J.resources=[]);-1===J.resources.indexOf(N||Z)&&J.resources.push(N||Z);J.scope=E._isServerRsrc(Z)?"server":"portal";J.onTokenChange();N=E._soReqs;var V={};E._soReqs=[];D.forEach(N,function(na){if(!this._isIdenticalService(Z,na.resUrl_)){var ya=this._getSuffix(na.resUrl_);
V[ya]||(V[ya]=!0,J.resources.push(na.resUrl_))}},E);B.callback(J);D.forEach(N,function(na){this._hasSameServerInstance(this._getServerInstanceRoot(Z),na.resUrl_)?na.callback(J):this._soReqs.push(na)},E);E._busy=B.resUrl_=B.sinfo_=B.refresh_=null;if(!qa)E.onCredentialCreate({credential:J});E._soReqs.length?E._doSignIn(E._soReqs.shift()):E._xoReqs.length&&E._doSignIn(E._xoReqs.shift())},I=function(J){B.errback(J);E._busy=B.resUrl_=B.sinfo_=B.refresh_=null;E._soReqs.length?E._doSignIn(E._soReqs.shift()):
E._xoReqs.length&&E._doSignIn(E._xoReqs.shift())},L=function(J,N,Z,Y){var qa=B.sinfo_,V=!B.options_||!1!==B.options_.prompt,na=qa.hasPortal&&E._findOAuthInfo(B.resUrl_);if(J)G(new A({userId:J,server:qa.server,token:Z||null,expires:e.isDefined(Y)?Number(Y):null,ssl:!!N}));else if(window!==window.parent&&E._appUrlObj.query&&E._appUrlObj.query["arcgis-auth-origin"]&&E._appUrlObj.query["arcgis-auth-portal"]&&E._hasSameServerInstance(E._getServerInstanceRoot(E._appUrlObj.query["arcgis-auth-portal"]),B.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},
E._appUrlObj.query["arcgis-auth-origin"]);var ya=n(window,"message",function(xa){if(xa.source===window.parent&&xa.data)if("arcgis:auth:credential"===xa.data.type&&xa.data.credential.expires<Date.now()&&(xa.data.type="arcgis:auth:error",xa.data.error={name:"tokenExpiredError"}),"arcgis:auth:credential"===xa.data.type)ya.remove(),G(new A(xa.data.credential));else if("arcgis:auth:error"===xa.data.type){ya.remove();xa=xa.data.error;switch(xa.name){case "identity-manager:busy":case "identity-manager:not-authorized":var Ha=
"IdentityManager.1";break;case "identity-manager:server-identification-failed":case "identity-manager:unknown-resource":case "identity-manager:user-aborted":Ha="IdentityManager.2";break;case "identity-manager:authentication-failed":case "identity-manager:credential-request-failed":case "tokenExpiredError":Ha="IdentityManager.3";"tokenExpiredError"===xa.name&&(xa.name="identity-manager:credential-request-failed",xa.message="Parent application's token has expired.");break;case "identity-manager:aborted":Ha=
"IdentityManager.4";break;case "identity-manager:not-authenticated":Ha="IdentityManager.6";break;case "identity-manager:invalid-request":Ha=400}var Ia=Error(xa.message);Ia.name=xa.name;Ia.code=Ha;Ia.log=!!m.isDebug;I(Ia)}})}else if(na){var S=na._oAuthCred;S||(J=new w(na,l),N=new w(na,v),J.isValid()&&N.isValid()?J.expires>N.expires?(S=J,N.destroy()):(S=N,J.destroy()):S=J.isValid()?J:N,na._oAuthCred=S);if(S.isValid()){var ma=new A({userId:S.userId,server:qa.server,token:S.token,expires:S.expires,ssl:S.ssl,
_oAuthCred:S});var ja=na.appId!==S.appId&&E._doPortalSignIn(B.resUrl_);ja||S.refreshToken?(S.refreshToken?B._pendingDfd=E._getOAuthToken(qa.server,S.refreshToken,S.appId).then(function(xa){ma.expires=Date.now()+1E3*xa.expires_in;ma.token=xa.access_token;return ma}):(J=new z,J.resolve(ma),B._pendingDfd=J),B._pendingDfd.then(function(xa){return ja?E._exchangeToken(xa.server,na.appId,xa.token).then(function(Ha){xa.token=Ha;return xa})["catch"](function(){return xa}):xa}).then(function(xa){G(xa)})["catch"](function(){S.destroy();
L()})):G(ma)}else if(E._oAuthLocationParams&&E._hasSameServerInstance(na.portalUrl,E._oAuthLocationParams.state.portalUrl)&&(E._oAuthLocationParams.access_token||E._oAuthLocationParams.code&&E._oAuthLocationParams.state.uid===S.stateUID&&S.codeVerifier))J=E._oAuthLocationParams,E._oAuthLocationParams=null,B._pendingDfd=E._processOAuthResponseParams(J,na,qa).then(function(xa){G(xa)})["catch"](I);else{var X=function(){V?B._pendingDfd=E.oAuthSignIn(B.resUrl_,qa,na,B.options_).addCallbacks(G,I):(oa=Error("User is not signed in."),
oa.name="identity-manager:not-authenticated",oa.code="IdentityManagerBase.6",oa.log=!!m.isDebug,I(oa))};E._doPortalSignIn(B.resUrl_)?B._pendingDfd=E._getPlatformSelf(qa.server,na.appId).then(function(xa){var Ha=xa.portalUrl;!Ha||c.hasSameOrigin(Ha,window.location.origin,!0)?(ma=new A({userId:xa.username,server:qa.server,expires:Date.now()+1E3*xa.expires_in,token:xa.token}),G(ma)):X()})["catch"](X):X()}}else if(V)E._checkProtocol(B.resUrl_,qa,I,B.admin_)&&(J=B.options_,B.admin_&&(J=J||{},J.isAdmin=
!0),B._pendingDfd=E.signIn(B.resUrl_,qa,J).addCallbacks(G,I));else{var oa=Error("User is not signed in.");oa.name="identity-manager:not-authenticated";oa.code="IdentityManagerBase.6";oa.log=!!m.isDebug;I(oa)}},K=function(){var J=B.sinfo_,N=J.owningSystemUrl,Z=B.options_,Y;if(Z){var qa=Z.token;var V=Z.error;var na=Z.prompt}(Y=E._findCredential(N,{token:qa,resource:B.resUrl_}))||D.some(E.credentials,function(ya){this._isIdProvider(N,ya.server)&&(Y=ya);return!!Y},E);Y?(Z=E.findCredential(B.resUrl_,Y.userId))?
G(Z):x(J,E._legacyFed)?(Z=Y.toJson(),Z.server=J.server,Z.resources=null,G(new A(Z))):(B._pendingDfd=E.generateToken(E.findServerInfo(Y.server),null,{serverUrl:B.resUrl_,token:Y.token,ssl:Y.ssl})).addCallbacks(function(ya){G(new A({userId:Y.userId,server:J.server,token:ya.token,expires:e.isDefined(ya.expires)?Number(ya.expires):null,ssl:!!ya.ssl,isAdmin:B.admin_,validity:ya.validity}))},I):(E._busy=null,qa&&(B.options_.token=null),(B._pendingDfd=E.getCredential(N.replace(/\/?$/,"/sharing"),{resource:B.resUrl_,
owningTenant:J.owningTenant,token:qa,error:V,prompt:na})).addCallbacks(function(ya){E._enqueue(B.resUrl_,B.sinfo_,B.options_,B,B.admin_)},function(ya){I(ya)}))};this._errbackFunc=I;var ba=B.sinfo_.owningSystemUrl,T=this._isServerRsrc(B.resUrl_),P=B.sinfo_._restInfoDfd;P?P.addCallbacks(function(J){var N=B.sinfo_;N._restInfoDfd&&(N.adminTokenServiceUrl=N._restInfoDfd.adminUrl_,N._restInfoDfd=null,N.tokenServiceUrl=a.getObject("authInfo.tokenServicesUrl",!1,J)||a.getObject("authInfo.tokenServiceUrl",
!1,J)||a.getObject("tokenServiceUrl",!1,J),N.shortLivedTokenValidity=a.getObject("authInfo.shortLivedTokenValidity",!1,J),N.currentVersion=J.currentVersion,N.owningTenant=J.owningTenant,(J=N.owningSystemUrl=J.owningSystemUrl)&&E._portals.push(J));T&&N.owningSystemUrl?K():L()},function(){B.sinfo_._restInfoDfd=null;var J=Error("Unknown resource - could not find token service endpoint.");J.name="identity-manager:server-identification-failed";J.code="IdentityManagerBase.2";J.log=!!m.isDebug;I(J)}):T&&
ba?K():B.sinfo_._selfReq?B.sinfo_._selfReq.selfDfd.then(function(J){var N={};if(J){var Z=J.user&&J.user.username;N.username=Z;N.allSSL=J.allSSL;var Y=J.supportsOAuth;var qa=parseFloat(J.currentVersion);if("multitenant"===J.portalMode)var V=J.customBaseUrl;B.sinfo_.currentVersion=qa}B.sinfo_.webTierAuth=!!Z;return Z&&E.normalizeWebTierAuth?E.generateToken(B.sinfo_,null,{ssl:N.allSSL}).addBoth(function(na){N.portalToken=na&&na.token;N.tokenExpiration=na&&na.expires;return N}):!Z&&Y&&4.4<=qa&&!E._findOAuthInfo(B.resUrl_)?
E._generateOAuthInfo({portalUrl:B.sinfo_.server,customBaseUrl:V,owningTenant:B.sinfo_._selfReq.owningTenant}).always(function(){return N}):N}).always(function(J){B.sinfo_._selfReq=null;J?L(J.username,J.allSSL,J.portalToken,J.tokenExpiration):L()}):L()},_generateOAuthInfo:function(B){var E=this,G=B.portalUrl,I=B.customBaseUrl,L=B.owningTenant;if(B=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){var K=window.location.href;var ba=K.indexOf("?");-1<ba&&(K=K.slice(0,
ba));ba=K.search(/\/(apps|home)\//);K=-1<ba?K.slice(0,ba):null}B&&K?(this._hasTestedIfAppIsOnPortal=!0,B=g({url:K+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){E.defaultOAuthInfo=new t({appId:"arcgisonline",popupCallbackUrl:K+"/home/oauth-callback.html"})})):(B=new z,B.resolve(),B=B.promise);return B.then(function(){if(E.defaultOAuthInfo)return G=G.replace(/^http:/i,"https:"),g({url:G+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:L,client_id:E.defaultOAuthInfo.appId,
redirect_uri:c.getAbsoluteUrl(E.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(T){if(T.valid){var P=E.defaultOAuthInfo.clone();P.portalUrl=T.urlKey&&I?"https://"+T.urlKey.toLowerCase()+"."+I:G;P.popup=window!==window.top||!(c.hasSameOrigin(G,window.location.origin)||E._gwDomains.some(function(J){return J.regex.test(G)&&J.regex.test(window.location.origin)}));E.oAuthInfos.push(P)}})})}});var A=F(k,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,
constructor:function(B){a.mixin(this,B);this.resources=this.resources||[];e.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var B=this,E=this.resources&&this.resources[0],G=f.id.findServerInfo(this.server),I=G&&G.owningSystemUrl,L=!!I&&"server"===this.scope,K=L&&x(G,f.id._legacyFed),ba=L&&f.id.findServerInfo(I),T,P=(T=G.webTierAuth)&&f.id.normalizeWebTierAuth,J=C[this.server];J=J&&J[this.userId];var N={username:this.userId,password:J};
if(!T||P)if(L&&!ba&&D.some(f.id.serverInfos,function(qa){f.id._isIdProvider(I,qa.server)&&(ba=qa);return!!ba}),T=ba&&f.id.findCredential(ba.server,this.userId),!L||T)if(K)T.refreshToken();else{if(L)var Z={serverUrl:E,token:T&&T.token,ssl:T&&T.ssl};else if(P)N=null,Z={ssl:this.ssl};else if(J)this.isAdmin&&(Z={isAdmin:!0});else{if(E){E=f.id._sanitizeUrl(E);this._enqueued=1;var Y=f.id._enqueue(E,G,null,null,this.isAdmin,this);Y.addCallback(function(){B._enqueued=0;B.refreshServerTokens()}).addErrback(function(){B._enqueued=
0})}return Y}return f.id.generateToken(L?ba:G,L?null:N,Z).addCallback(function(qa){B.token=qa.token;B.expires=e.isDefined(qa.expires)?Number(qa.expires):null;B.creationTime=(new Date).getTime();B.validity=qa.validity;B.onTokenChange();B.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&D.forEach(f.id.credentials,function(B){var E=f.id.findServerInfo(B.server),G=E&&E.owningSystemUrl;B!==this&&B.userId===this.userId&&G&&"server"===B.scope&&(f.id._hasSameServerInstance(this.server,
G)||f.id._isIdProvider(G,this.server))&&(x(E,f.id._legacyFed)?(B.token=this.token,B.expires=this.expires,B.creationTime=this.creationTime,B.validity=this.validity,B.onTokenChange()):B.refreshToken())},this)},onTokenChange:function(B){clearTimeout(this._refreshTimer);var E=this.server&&f.id.findServerInfo(this.server),G=(E=E&&E.owningSystemUrl)&&f.id.findServerInfo(E);!1!==B&&(!E||"portal"===this.scope||G&&G.webTierAuth&&!f.id.normalizeWebTierAuth)&&(e.isDefined(this.expires)||e.isDefined(this.validity))&&
this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var B=D.indexOf(f.id.credentials,this);-1<B&&f.id.credentials.splice(B,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var B=e.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,
validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),E=this.resources;E&&0<E.length&&(B.resources=E.slice());return B},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var B=6E4*this.tokenRefreshBuffer,E=Math.pow(2,31)-1,G=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>G?G=0:G>E&&(G=E);this._refreshTimer=setTimeout(a.hitch(this,this.refreshToken),G>B?G-B:G)}});r.Credential=A;return f.IdentityManagerBase=
r})},"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.ServerInfo",constructor:function(y){m.mixin(this,y)},toJson:function(){return z.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,
hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}});return D.ServerInfo=F})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has"],function(F,m,a){m=m(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,appId:null,codeVerifier:null,expires:null,refreshToken:null,ssl:null,stateUID:null,token:null,userId:null,constructor:function(D,z){this.oAuthInfo=D;this.storage=z;this._init()},isValid:function(){var D=!1;if(this.oAuthInfo&&
this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)D=!0;else{var z=Date.now();this.expires>z&&(this.expires-z)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(D=!0)}return D},save:function(){if(!this.storage)return!1;var D=this._load(),z=this.oAuthInfo;if(z&&z.authNamespace&&z.portalUrl){var y=D[z.authNamespace];y||(y=D[z.authNamespace]={});this.appId||(this.appId=z.appId);y[z.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,
ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(D))}catch(r){return!1}return!0}return!1},destroy:function(){var D=this._load(),z=this.oAuthInfo;if(z&&z.appId&&z.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){var y=z.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",r=new FormData;r.append("f","json");r.append("auth_token",this.refreshToken||this.token);
r.append("client_id",z.appId);r.append("token_type_hint",this.refreshToken?"refresh_token":"access_token");if("function"===typeof navigator.sendBeacon)navigator.sendBeacon(y,r);else{var q=new XMLHttpRequest;q.open("POST",y);q.send(r)}}if(z&&z.authNamespace&&z.portalUrl&&this.storage&&(y=D[z.authNamespace])){delete y[z.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(D))}catch(n){}}z&&(this.oAuthInfo=z._oAuthCred=null)},_init:function(){var D=this._load(),z=this.oAuthInfo;z&&z.authNamespace&&
z.portalUrl&&(D=D[z.authNamespace])&&(D=D[z.portalUrl])&&(this.appId=D.appId,this.codeVerifier=D.codeVerifier,this.expires=D.expires,this.refreshToken=D.refreshToken,this.ssl=D.ssl,this.stateUID=D.stateUID,this.token=D.token,this.userId=D.userId)},_load:function(){var D={};if(this.storage){var z=this.storage.getItem("esriJSAPIOAuth");if(z)try{D=JSON.parse(z)}catch(y){}}return D}});return F.OAuthCredential=m})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang",
"dojo/has"],function(F,m,a,D,z){var y=a(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(r){D.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d490,width\x3d800,resizable,scrollbars,status",preserveUrlHash:!1,flowType:"auto"},r)},_oAuthCred:null,toJson:function(){return m.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,
minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures,preserveUrlHash:this.preserveUrlHash,flowType:this.flowType})},clone:function(){return new y(this.toJson())}});D.setObject("arcgis.OAuthInfo",y,F);return y})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),
function(F,m,a,D,z,y,r,q){return F("dijit.form.Form",[z,y,r,q],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(n){m.set(this.domNode,
"encType",n);D("ie")&&(this.domNode.encoding=n);this._set("encType",n)},reset:function(n){var f={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:n?n.target:this.domNode,target:n?n.target:this.domNode};!1!==this.onReset(f)&&f.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(n){this.reset(n);n.stopPropagation();n.preventDefault();return!1},_onSubmit:function(n){var f=this.constructor.prototype;if(this.execute!=
f.execute||this.onExecute!=f.onExecute)a.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(n)&&(n.stopPropagation(),n.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query ./core/events dijit/form/Button dojo/query".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b){var c=null,h=null;try{c=window.localStorage,h=window.sessionStorage}catch(k){}var g=window.crypto||window.msCrypto;return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(k){this._oAuthRedirectFunc=k},oAuthSignIn:function(k,w,t,C){var u=this._oAuthDfd=new q;u.resUrl_=k;u.sinfo_=w;u.oinfo_=t;var x=t._oAuthCred;if(x.storage&&("authorization-code"===t.flowType||"auto"===t.flowType&&!t.popup&&8.4<=w.currentVersion)){var l=g.getRandomValues(new Uint8Array(32));var v=D.base64UrlEncode(l);x.codeVerifier=v;l=g.getRandomValues(new Uint8Array(32));x.stateUID=D.base64UrlEncode(l);x.save()||(x.codeVerifier=v=null)}else x.codeVerifier=null;var A=
this;this._getCodeChallenge(v).then(function(B){var E=!C||!1!==C.oAuthPopupConfirmation;if(!t.popup||!E)return A._doOAuthSignIn(k,w,t,B),u;u.codeChallenge_=B;A._nls||(A._nls=d.identity);A.oAuthDialog||(A.oAuthDialog=A._createOAuthDialog());B=A.oAuthDialog;E=C&&C.error;var G=C&&C.token;m.hide(B.errMsg_);E&&403==E.code&&G&&(f.set(B.errMsg_,"innerHTML",A._nls.forbidden),m.show(B.errMsg_));f.set(B.serverLink_,{title:w.server,innerHTML:-1!==w.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":
w.server});B.show()});return u},setOAuthResponseHash:function(k){k&&("#"===k.charAt(0)&&(k=k.substring(1)),this._processOAuthPopupParams(e.queryToObject(k)))},_createOAuthDialog:function(){var k=this._nls,w=a.substitute(k,this._oAuthDialogContent);w=a.substitute({server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},w);var t=new z({title:k.title,content:w,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var C=t.esriIdMgr_._oAuthDfd;
t.hide_();t.esriIdMgr_._doOAuthSignIn(C.resUrl_,C.sinfo_,C.oinfo_,C.codeChallenge_)},cancel_:function(){var C=t.esriIdMgr_._oAuthDfd;t.esriIdMgr_._oAuthDfd=null;t.hide_();var u=Error("ABORTED");u.code="IdentityManager.2";u.log=!!r.isDebug;C.errback(u)},hide_:function(){m.hide(t.errMsg_);t.hide();z._DialogLevelManager.hide(t)}});k=t.domNode;t.btnSubmit_=y.byNode(n.query(".esriIdSubmit",k)[0]);t.btnCancel_=y.byNode(n.query(".esriIdCancel",k)[0]);t.serverLink_=n.query(".serverLink",k)[0];t.errMsg_=n.query(".esriErrorMsg",
k)[0];t.connect(t.btnSubmit_,"onClick",t.execute_);t.connect(t.btnCancel_,"onClick",t.onCancel);t.connect(t,"onCancel",t.cancel_);return t},_doOAuthSignIn:function(k,w,t,C){var u=this,x=t._oAuthCred,l={portalUrl:t.portalUrl};!t.popup&&t.preserveUrlHash&&window.location.hash&&(l.hash=window.location.hash);x.stateUID&&(l.uid=x.stateUID);l={client_id:t.appId,response_type:x.codeVerifier?"code":"token",state:JSON.stringify(l),expiration:t.expiration,locale:t.locale,redirect_uri:this._getRedirectURI(t,
!!x.codeVerifier)};t.forceLogin&&(l.force_login=!0);t.forceUserId&&t.userId&&(l.prepopulatedusername=t.userId);!t.popup&&this._doPortalSignIn(k)&&(l.redirectToUserOrgUrl=!0);x.codeVerifier&&(l.code_challenge=C||x.codeVerifier,l.code_challenge_method=C?"S256":"plain");C=t.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize";x=C+"?"+e.objectToQuery(l);if(t.popup){var v=window.open(x,"esriJSAPIOAuth",t.popupWindowFeatures);v?(v.focus(),this._oAuthDfd.oAuthWin_=v,this._oAuthIntervalId=setInterval(function(){if(v.closed){clearInterval(u._oAuthIntervalId);
u._oAuthOnPopupHandle.remove();var A=u._oAuthDfd;if(A){var B=Error("ABORTED");B.code="IdentityManager.2";B.log=!!r.isDebug;A.errback(B)}}},500),u._oAuthOnPopupHandle=b.on(window,["arcgis:auth:hash","arcgis:auth:location:search"],function(A){"arcgis:auth:hash"===A.type?u.setOAuthResponseHash(A.detail):u._setOAuthResponseQueryString(A.detail)})):(k=Error("ABORTED"),k.name="identity-manager:user-aborted",k.code="IdentityManager.2",k.log=!!r.isDebug,this._oAuthDfd.errback(k))}else this._rejectOnPersistedPageShow=
!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:l,authorizeUrl:C,resourceUrl:k,serverInfo:w,oAuthInfo:t}):window.location.href=x},_getCodeChallenge:function(k){if(k&&window.isSecureContext)return k=(new TextEncoder).encode(k),g.subtle.digest("SHA-256",k).then(function(w){return D.base64UrlEncode(new Uint8Array(w))});k=new q;k.resolve(null);return k},_getRedirectURI:function(k,w){var t=window.location.href.replace(/#.*$/,"");if(k.popup)return D.getAbsoluteUrl(k.popupCallbackUrl);
if(w){var C=D.urlToObject(t);if(C.query)return"code error error_description message_code persist state".split(" ").forEach(function(u){delete C.query[u]}),(t=e.objectToQuery(C.query))?C.path+"?"+t:C.path}return t},_processOAuthPopupParams:function(k){var w=this._oAuthDfd;this._oAuthDfd=null;if(w)if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle&&this._oAuthOnPopupHandle.remove(),k.error){var t="access_denied"===k.error;k=Error(t?"ABORTED":"OAuth: "+k.error+" - "+k.error_description);
k.name=t?"identity-manager:user-aborted":"identity-manager:authentication-failed";k.code="IdentityManagerBase."+(t?2:3);k.log=!!r.isDebug;w.errback(k)}else this._processOAuthResponseParams(k,w.oinfo_,w.sinfo_).then(function(C){w.resolve(C)})["catch"](function(C){w.reject(C)})},_processOAuthResponseParams:function(k,w,t){var C=w._oAuthCred;if(k.code){var u=C.codeVerifier;C.codeVerifier=null;C.stateUID=null;C.save();return this._getOAuthToken(t.server,k.code,w.appId,this._getRedirectURI(w,!0),u).then(function(l){var v=
new F({userId:l.username,server:t.server,token:l.access_token,expires:Date.now()+1E3*l.expires_in,ssl:l.ssl,oAuthState:k.state,_oAuthCred:C});w.userId=v.userId;C.storage=l.persist?c:h;C.refreshToken=l.refresh_token;C.token=null;C.expires=l.refresh_token_expires_in?Date.now()+1E3*l.refresh_token_expires_in:null;C.userId=v.userId;C.ssl=v.ssl;C.save();return v})}u=new F({userId:k.username,server:t.server,token:k.access_token,expires:Date.now()+1E3*Number(k.expires_in),ssl:"true"===k.ssl,oAuthState:k.state,
_oAuthCred:C});w.userId=u.userId;C.storage=k.persist?c:h;C.refreshToken=null;C.token=u.token;C.expires=u.expires;C.userId=u.userId;C.ssl=u.ssl;C.save();var x=new q;x.resolve(u);return x},_setOAuthResponseQueryString:function(k){k&&("?"===k.charAt(0)&&(k=k.substring(1)),this._processOAuthPopupParams(e.queryToObject(k)))}}})},"esri/core/events":function(){define([],function(){return{on:function(F,m,a){if(!F||"function"!==typeof F.on&&"function"!==typeof F.addEventListener)throw new TypeError("target is not a Evented or EventTarget object");
if("on"in F)return F.on(m,a);if(Array.isArray(m)){for(var D=m.slice(),z=0;z<D.length;z++)F.addEventListener(D[z],a);return{remove:function(){for(var y=0;y<D.length;y++)F.removeEventListener(D[y],a)}}}F.addEventListener(m,a);return{remove:function(){F.removeEventListener(m,a)}}}}})},"esri/SnappingManager":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has dojo/keys ./kernel ./graphic ./geometry/ScreenPoint ./geometry/Extent ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./tasks/query".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h){F=F(null,{declaredClass:"esri.SnappingManager",constructor:function(g){g=g||{};this.map=g.map;this.tolerance=g.tolerance||15;this.layerInfos=[];if(g.layerInfos)this.layerInfos=g.layerInfos;else{var k;for(k=0;k<this.map.graphicsLayerIds.length;k++){var w=this.map.getLayer(this.map.graphicsLayerIds[k]);this.layerInfos.push({layer:w})}if(this.map.loaded)this.layerInfos.push({layer:this.map.graphics});else var t=m.connect(this.map,"onLoad",this,function(C){m.disconnect(t);
t=null;this.layerInfos.push({layer:this.map.graphics});this.setLayerInfos(this.layerInfos)})}this.snapPointSymbol=g.snapPointSymbol?g.snapPointSymbol:new b(b.STYLE_CROSS,15,new c(c.STYLE_SOLID,new z([0,255,255]),1),new z([0,255,0,0]));this.alwaysSnap=g.alwaysSnap?g.alwaysSnap:!1;this.snapKey=g.snapKey?g.snapKey:r("mac")?q.META:q.CTRL;this._SelectionLyrQuery=new h;this._SelectionLyrQuery.spatialRelationship=h.SPATIAL_REL_INTERSECTS;this._snappingGraphic=new f;this.setLayerInfos(this.layerInfos);this._currentGraphicOption=
{snapToPoint:!0,snapToVertex:!0,snapToLastVertex:!0,snapToEdge:!0};this._snappingCallback=a.hitch(this,this._snappingCallback)},getSnappingPoint:function(g){var k=this.layers,w=this.tolerance,t=this.map,C=this.layerOptions,u=t.toMap(g.offset(-w,w));w=t.toMap(g.offset(w,-w));u=new e(u.x,u.y,w.x,w.y,t.spatialReference);var x=new h;x.geometry=u;x.spatialRelationship=h.SPATIAL_REL_INTERSECTS;var l=[],v=[],A=this._extractPointsAndLines,B=new y,E=0,G;w=u.xmin;var I=u.xmax;D.forEach(k,function(P,J){P.visible&&
P.loaded&&"esri.layers.FeatureLayer"===P.declaredClass&&P.mode!==P.constructor.MODE_SELECTION&&E++});t.spatialReference._isWrappable()&&(w=e.prototype._normalizeX(u.xmin,t.spatialReference._getInfo()).x,I=e.prototype._normalizeX(u.xmax,t.spatialReference._getInfo()).x);var L=new e(w,u.ymin,I,u.ymax,t.spatialReference);D.forEach(k,function(P,J){if("esri.layers.GraphicsLayer"===P.declaredClass&&P.visible){var N=[];D.forEach(P.graphics,function(Y){Y&&Y.visible&&L.intersects(Y.geometry)&&N.push(Y)});
var Z=A(N,C[J]);l=l.concat(Z[0]);v=v.concat(Z[1])}});var K=a.hitch(this,function(P){E--;P instanceof Error||(P=A(P.features,C[G]),l=l.concat(P[0]),v=v.concat(P[1]));E||(T=this._getSnappingPoint(l,v,g),B.callback(T))}),ba=!1;D.forEach(k,function(P,J){P.visible&&P.loaded&&(G=J,"esri.layers.FeatureLayer"===P.declaredClass&&P.mode!==P.constructor.MODE_SELECTION&&(ba=!0,P.queryFeatures(x,K,K)))});if(!ba){var T=this._getSnappingPoint(l,v,g);B.callback(T)}return B},setLayerInfos:function(g){this.layers=
[];this.layerOptions=[];var k;for(k=0;k<g.length;k++)this.layers.push(g[k].layer),this.layerOptions.push({snapToPoint:!0,snapToVertex:!0,snapToEdge:!0}),!1===g[k].snapToPoint&&(this.layerOptions[k].snapToPoint=g[k].snapToPoint),!1===g[k].snapToVertex&&(this.layerOptions[k].snapToVertex=g[k].snapToVertex),!1===g[k].snapToEdge&&(this.layerOptions[k].snapToEdge=g[k].snapToEdge);this._featurePtsFromSelectionLayer=[];this._featureLinesFromSelectionLayer=[];this._selectionLayers=[];this._selectionLayerOptions=
[];D.forEach(this.layers,function(w,t){"esri.layers.FeatureLayer"===w.declaredClass&&w.mode===w.constructor.MODE_SELECTION&&(this._selectionLayers.push(w),this._selectionLayerOptions.push(this.layerOptions[t]))},this);this.layerInfos=g},destroy:function(){m.disconnect(this._onExtentChangeConnect);this._killOffSnapping();this._featurePtsFromSelectionLayer=this._featureLinesFromSelectionLayer=this._currentFeaturePts=this._currentFeatureLines=this.layers=this.map=null},_startSelectionLayerQuery:function(){m.disconnect(this._onExtentChangeConnect);
this._mapExtentChangeHandler(this._selectionLayers,this._selectionLayerOptions,this.map.extent);this._onExtentChangeConnect=m.connect(this.map,"onExtentChange",a.hitch(this,"_mapExtentChangeHandler",this._selectionLayers,this._selectionLayerOptions))},_stopSelectionLayerQuery:function(){m.disconnect(this._onExtentChangeConnect)},_mapExtentChangeHandler:function(g,k,w){this._featurePtsFromSelectionLayer=[];this._featureLinesFromSelectionLayer=[];var t;this._SelectionLyrQuery.geometry=w;var C=a.hitch(this,
function(u){u instanceof Error||(u=this._extractPointsAndLines(u.features,k[t]),this._featurePtsFromSelectionLayer=this._featurePtsFromSelectionLayer.concat(u[0]),this._featureLinesFromSelectionLayer=this._featureLinesFromSelectionLayer.concat(u[1]))});D.forEach(g,function(u,x){u.visible&&u.loaded&&(t=x,u.queryFeatures(this._SelectionLyrQuery,C,C))},this)},_extractPointsAndLines:function(g,k){var w=k&&!1===k.snapToLastVertex?!1:!0,t=[],C=[],u,x;D.forEach(g,function(l,v){if((!l._graphicsLayer||l.visible)&&
l.geometry&&l._isSnapTarget)if("point"===l.geometry.type&&k.snapToPoint)t.push(l.geometry);else if("polyline"===l.geometry.type)for(u=0;u<l.geometry.paths.length;u++){C.push("lineStart");var A=l.geometry.paths[u].length;for(x=0;x<A;x++)if(w||x!==A-1){var B=l.geometry.getPoint(u,x);k.snapToVertex&&t.push(B);k.snapToEdge&&C.push(B)}C.push("lineEnd")}else if("polygon"===l.geometry.type)for(u=0;u<l.geometry.rings.length;u++){C.push("lineStart");A=l.geometry.rings[u].length;for(x=0;x<A;x++)if(w||x!==A-
1)B=l.geometry.getPoint(u,x),k.snapToVertex&&t.push(B),k.snapToEdge&&C.push(B);C.push("lineEnd")}});return[t,C]},_getSnappingPoint:function(g,k,w){var t,C=this.tolerance,u=this.map,x=this.map._getFrameWidth();g=g.concat(this._featurePtsFromSelectionLayer);k=k.concat(this._featureLinesFromSelectionLayer);if(this._currentGraphic){var l=this._extractPointsAndLines([this._currentGraphic],this._currentGraphicOption);g=g.concat(l[0]);k=k.concat(l[1])}var v,A;D.forEach(g,function(qa,V){var na=u.toScreen(qa,
!0);if(-1!==x&&(na.x%=x,0>na.x&&(na.x+=x),u.width>x))for(var ya=(u.width-x)/2;na.x<ya;)na.x+=x;t=Math.sqrt((na.x-w.x)*(na.x-w.x)+(na.y-w.y)*(na.y-w.y));t<=C&&(C=t,v=na.x,A=na.y)});if(v){k=new d(v,A);var B=k=u.toMap(k)}else{C=this.tolerance;for(g=0;g<k.length;g++)if("lineStart"===k[g])for(l=g+1;l<k.length;l++){if("lineEnd"!==k[l+1]&&"lineStart"!==k[l+1]&&"lineEnd"!==k[l]&&"lineStart"!==k[l]){var E=u.toScreen(k[l],!0),G=u.toScreen(k[l+1],!0),I=E.x>=G.x?E:G,L=E.x>=G.x?G:E;-1!==x&&(I.x%=x,0>I.x&&(I.x+=
x),L.x%=x,0>L.x&&(L.x+=x),L.x>I.x&&(L.x-=x));E=I.x;I=I.y;G=L.x;L=L.y;var K;if(E===G){var ba=E;var T=w.y;var P=K=E;var J=I<=L?I:L;var N=I<=L?L:I}else I===L?(ba=w.x,T=I,P=E<=G?E:G,K=E<=G?G:E,J=N=I):(T=(L-I)/(G-E),P=(I*G-E*L)/(G-E),ba=(P-(w.y*L-w.y*I-w.x*E+w.x*G)/(L-I))/((E-G)/(L-I)-T),T=T*ba+P,P=E<=G?E:G,K=E<=G?G:E,J=I<=L?I:L,N=I<=L?L:I);if(ba>=P&&ba<=K&&T>=J&&T<=N){if(E=Math.sqrt((w.x-ba)*(w.x-ba)+(w.y-T)*(w.y-T)),E<=C){C=E;var Z=ba;var Y=T}}else ba=Math.sqrt((E-w.x)*(E-w.x)+(I-w.y)*(I-w.y)),T=Math.sqrt((G-
w.x)*(G-w.x)+(L-w.y)*(L-w.y)),ba<=T?(P=ba,ba=E,T=I):(P=T,ba=G,T=L),P<=C&&(C=P,Z=ba,Y=T)}if("lineEnd"===k[l]){g=l;break}}Z&&(k=new d(Z,Y),B=k=u.toMap(k))}return B},_setGraphic:function(g,k){this._currentGraphic=g;this._currentGraphicOption.snapToLastVertex=k&&!1===k.snapToLastVertex?!1:!0},_addSnappingPointGraphic:function(){var g=this.map;this._snappingGraphic.setSymbol(this.snapPointSymbol);g.graphics.add(this._snappingGraphic)},_setUpSnapping:function(){var g=this.map;this._onSnapKeyDown_connect=
m.connect(g,"onKeyDown",this,"_onSnapKeyDownHandler");this._onSnapKeyUp_connect=m.connect(g,"onKeyUp",this,"_onSnapKeyUpHandler");this._onSnappingMouseMove_connect=m.connect(g,"onMouseMove",this,"_onSnappingMouseMoveHandler");this._onSnappingMouseDrag_connect=m.connect(g,"onMouseDrag",this,"_onSnappingMouseMoveHandler");this.alwaysSnap&&this._activateSnapping()},_killOffSnapping:function(){m.disconnect(this._onSnapKeyDown_connect);m.disconnect(this._onSnapKeyUp_connect);m.disconnect(this._onSnappingMouseMove_connect);
m.disconnect(this._onSnappingMouseDrag_connect);this._deactivateSnapping()},_onSnapKeyDownHandler:function(g){g.keyCode===this.snapKey&&(m.disconnect(this._onSnapKeyDown_connect),this.alwaysSnap?this._deactivateSnapping():this._activateSnapping())},_activateSnapping:function(){this._snappingActive=!0;this._addSnappingPointGraphic();this._currentLocation&&this._onSnappingMouseMoveHandler(this._currentLocation)},_onSnapKeyUpHandler:function(g){g.keyCode===this.snapKey&&(this._onSnapKeyDown_connect=
m.connect(this.map,"onKeyDown",this,"_onSnapKeyDownHandler"),this.alwaysSnap?this._activateSnapping():this._deactivateSnapping())},_deactivateSnapping:function(){this._snappingActive=!1;this._snappingPoint=null;this.map.graphics.remove(this._snappingGraphic);this._snappingGraphic.setGeometry(null)},_onSnappingMouseMoveHandler:function(g){this._currentLocation=g;this._snappingPoint=null;this._snappingActive&&(this._snappingGraphic.hide(),this.getSnappingPoint(g.screenPoint).addCallback(this._snappingCallback))},
_snappingCallback:function(g){if(this._snappingPoint=g)this._snappingGraphic.show(),this._snappingGraphic.setGeometry(g)}});return n.SnappingManager=F})},"esri/tasks/identify":function(){define(["./IdentifyTask","./IdentifyParameters","./IdentifyResult"],function(){return{}})},"esri/tasks/IdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./IdentifyResult".split(" "),function(F,m,a,D,z,y,r,q,n){F=F(q,
{declaredClass:"esri.tasks.IdentifyTask",_eventMap:{complete:["results"]},constructor:function(f,d){this._url.path+="/identify";this._handler=m.hitch(this,this._handler);this.gdbVersion=d&&d.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(f,d,e,b,c){try{var h=[];a.forEach(f.results,function(g,k){h[k]=new n(g)});this._successHandler([h],"onComplete",e,c)}catch(g){this._errorHandler(g,b,c)}},execute:function(f,d,e,b){var c=b.assembly;
f=this._encode(m.mixin({},this._url.query,{f:"json"},f.toJson(c&&c[0])));var h=this._handler,g=this._errorHandler;this.gdbVersion&&(f.gdbVersion=this.gdbVersion);return y({url:this._url.path,content:f,callbackParamName:"callback",load:function(k,w){h(k,w,d,e,b.dfd)},error:function(k){g(k,e,b.dfd)}})},onComplete:function(){}});r._createWrappers(F);m.setObject("tasks.IdentifyTask",F,z);return F})},"esri/tasks/IdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../graphic ../geometry/jsonUtils".split(" "),
function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.tasks.IdentifyResult",constructor:function(r){m.mixin(this,r);this.feature=new z(r.geometry?y.fromJson(r.geometry):null,null,r.attributes);delete this.geometry;delete this.attributes}});m.setObject("tasks.IdentifyResult",F,D);return F})},"esri/tasks/IdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../layerUtils ../geometry/jsonUtils ../geometry/scaleUtils".split(" "),function(F,
m,a,D,z,y,r,q,n){var f=F(null,{declaredClass:"esri.tasks.IdentifyParameters",constructor:function(){this.layerOption=f.LAYER_OPTION_TOP},geometry:null,spatialReference:null,layerIds:null,tolerance:null,returnGeometry:!1,returnFieldName:!1,returnUnformattedValues:!1,mapExtent:null,width:400,height:400,dpi:96,layerDefinitions:null,timeExtent:null,layerTimeOptions:null,dynamicLayerInfos:null,toJson:function(d){var e=d&&d.geometry||this.geometry,b=this.mapExtent,c=this.spatialReference,h=this.layerIds;
d={tolerance:this.tolerance,returnGeometry:this.returnGeometry,returnFieldName:this.returnFieldName,returnUnformattedValues:this.returnUnformattedValues,imageDisplay:this.width+","+this.height+","+this.dpi,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision};if(e){var g=e.toJson();delete g.spatialReference;d.geometry=D.toJson(g);d.geometryType=q.getJsonType(e)}c?d.sr=c.wkid||D.toJson(c.toJson()):e&&e.spatialReference?d.sr=e.spatialReference.wkid||D.toJson(e.spatialReference.toJson()):
b&&b.spatialReference&&(d.sr=b.spatialReference.wkid||D.toJson(b.spatialReference.toJson()));b&&(d.mapExtent=b.xmin+","+b.ymin+","+b.xmax+","+b.ymax);d.layers=this.layerOption;h&&(d.layers+=":"+h.join(","));d.layerDefs=r._serializeLayerDefinitions(this.layerDefinitions,!0);e=this.timeExtent;d.time=e?e.toJson().join(","):null;d.layerTimeOptions=r._serializeTimeOptions(this.layerTimeOptions);if(this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length){b=n.getScale({extent:b,width:this.width,spatialReference:b.spatialReference});
var k=r._getLayersForScale(b,this.dynamicLayerInfos),w=[];a.forEach(this.dynamicLayerInfos,function(t){if(!t.subLayerIds){var C=t.id;if((!this.layerIds||this.layerIds&&-1!==a.indexOf(this.layerIds,C))&&-1!==a.indexOf(k,C)){var u={id:C};u.source=t.source&&t.source.toJson();var x;this.layerDefinitions&&this.layerDefinitions[C]&&(x=this.layerDefinitions[C]);x&&(u.definitionExpression=x);var l;this.layerTimeOptions&&this.layerTimeOptions[C]&&(l=this.layerTimeOptions[C]);l&&(u.layerTimeOptions=l.toJson());
w.push(u)}}},this);b=D.toJson(w);"[]"===b&&(b="[{}]");d.dynamicLayers=b}return d}});m.mixin(f,{LAYER_OPTION_TOP:"top",LAYER_OPTION_VISIBLE:"visible",LAYER_OPTION_ALL:"all"});m.setObject("tasks.IdentifyParameters",f,y);return f})},"esri/tasks/geometry":function(){define("./GeometryService ./TrimExtendParameters ./BufferParameters ./AreasAndLengthsParameters ./LengthsParameters ./RelationParameters ./DensifyParameters ./GeneralizeParameters ./OffsetParameters ./DistanceParameters ./ProjectParameters".split(" "),
function(){return{}})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h){F=F(f,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],
"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],
"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(g){g=m.hitch;this._projectHandler=g(this,this._projectHandler);this._simplifyHandler=g(this,this._simplifyHandler);this._bufferHandler=g(this,this._bufferHandler);this._areasAndLengthsHandler=g(this,this._areasAndLengthsHandler);this._lengthsHandler=g(this,this._lengthsHandler);this._labelPointsHandler=g(this,this._labelPointsHandler);this._relationHandler=g(this,this._relationHandler);this._convexHullHandler=
g(this,this._convexHullHandler);this._unionHandler=g(this,this._unionHandler);this._autoCompleteHandler=g(this,this._autoCompleteHandler);this._reshapeHandler=g(this,this._reshapeHandler);this._cutHandler=g(this,this._cutHandler);this._intersectHandler=g(this,this._intersectHandler);this._differenceHandler=g(this,this._differenceHandler);this._trimExtendHandler=g(this,this._trimExtendHandler);this._densifyHandler=g(this,this._densifyHandler);this._generalizeHandler=g(this,this._densifyHandler);this._offsetHandler=
g(this,this._offsetHandler);this._distanceHandler=g(this,this._distanceHandler);this._toGeoCoordinateHandler=g(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=g(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(g){var k=[],w,t=g.length;for(w=0;w<t;w++)k.push(g[w].toJson());return{geometryType:h.getJsonType(g[0]),geometries:k}},_decodeGeometries:function(g,k,w){var t=h.getGeometryType(k);g=g.geometries;var C=[],u={spatialReference:w.toJson()},
x=m.mixin;a.forEach(g,function(l,v){C[v]=new t(x(l,u))});return C},_toProjectGeometry:function(g){var k=g.spatialReference.toJson();return g instanceof d?new b({rings:[[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]]],spatialReference:k}):new e({paths:[[].concat(g.points)],spatialReference:k})},_fromProjectedGeometry:function(g,k,w){return"esriGeometryEnvelope"===k?(g=g.rings[0],new d(g[0][0],g[0][1],g[2][0],g[2][1],w)):new c({points:g.paths[0],spatialReference:w.toJson()})},
project:function(g,k,w,t){var C=m.mixin({},this._url.query,{f:"json"});if(g.geometries){t=w;w=k;k=g.outSR;var u=g.geometries[0];C=m.mixin(C,g.toJson())}else u=g[0],C=m.mixin(C,{outSR:k.wkid||D.toJson(k.toJson()),inSR:u.spatialReference.wkid||D.toJson(u.spatialReference.toJson()),geometries:D.toJson(this._encodeGeometries(g))});var x=h.getJsonType(u),l=this._projectHandler,v=this._errorHandler,A=new z(n._dfdCanceller);A._pendingDfd=q({url:this._url.path+"/project",content:C,callbackParamName:"callback",
load:function(B,E){l(B,E,x,k,w,t,A)},error:function(B){v(B,t,A)}});return A},_projectHandler:function(g,k,w,t,C,u,x){try{var l=this._decodeGeometries(g,w,t);this._successHandler([l],"onProjectComplete",C,x)}catch(v){this._errorHandler(v,u,x)}},onProjectComplete:function(){},simplify:function(g,k,w){var t=g[0].spatialReference,C=m.mixin({},this._url.query,{f:"json",sr:t.wkid?t.wkid:D.toJson(t.toJson()),geometries:D.toJson(this._encodeGeometries(g))}),u=h.getJsonType(g[0]),x=this._simplifyHandler,l=
this._errorHandler,v=new z(n._dfdCanceller);v._pendingDfd=q({url:this._url.path+"/simplify",content:C,callbackParamName:"callback",load:function(A,B){x(A,B,u,t,k,w,v)},error:function(A){l(A,w,v)}});return v},_simplifyHandler:function(g,k,w,t,C,u,x){try{var l=this._decodeGeometries(g,w,t);this._successHandler([l],"onSimplifyComplete",C,x)}catch(v){this._errorHandler(v,u,x)}},onSimplifyComplete:function(){},convexHull:function(g,k,w){var t=g[0].spatialReference;g=m.mixin({},this._url.query,{f:"json",
sr:D.toJson(t.toJson()),geometries:D.toJson(this._encodeGeometries(g))});var C=this._convexHullHandler,u=this._errorHandler,x=new z(n._dfdCanceller);x._pendingDfd=q({url:this._url.path+"/convexHull",content:g,callbackParamName:"callback",load:function(l,v){C(l,v,t,k,w,x)},error:function(l){u(l,w,x)}});return x},_convexHullHandler:function(g,k,w,t,C,u){try{var x=h.fromJson(g.geometry).setSpatialReference(w);this._successHandler([x],"onConvexHullComplete",t,u)}catch(l){this._errorHandler(l,C,u)}},onConvexHullComplete:function(){},
union:function(g,k,w){var t=g[0].spatialReference;g=m.mixin({},this._url.query,{f:"json",sr:D.toJson(t.toJson()),geometries:D.toJson(this._encodeGeometries(g))});var C=this._unionHandler,u=this._errorHandler,x=new z(n._dfdCanceller);x._pendingDfd=q({url:this._url.path+"/union",content:g,callbackParamName:"callback",load:function(l,v){C(l,v,t,k,w,x)},error:function(l){u(l,w,x)}});return x},_unionHandler:function(g,k,w,t,C,u){try{var x=h.fromJson(g.geometry).setSpatialReference(w);this._successHandler([x],
"onUnionComplete",t,u)}catch(l){this._errorHandler(l,C,u)}},onUnionComplete:function(){},autoComplete:function(g,k,w,t){var C=g[0].spatialReference;g=m.mixin({},this._url.query,{f:"json",sr:D.toJson(C.toJson()),polygons:D.toJson(this._encodeGeometries(g).geometries),polylines:D.toJson(this._encodeGeometries(k).geometries)});var u=this._autoCompleteHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/autoComplete",content:g,callbackParamName:"callback",load:function(v,
A){u(v,A,C,w,t,l)},error:function(v){x(v,t,l)}});return l},_autoCompleteHandler:function(g,k,w,t,C,u){try{var x=g.geometries;g=[];var l,v=x.length;for(l=0;l<v;l++)g[l]=new b({spatialReference:w,rings:x[l].rings});this._successHandler([g],"onAutoCompleteComplete",t,u)}catch(A){this._errorHandler(A,C,u)}},onAutoCompleteComplete:function(){},reshape:function(g,k,w,t){var C=g.spatialReference;g=m.mixin({},this._url.query,{f:"json",sr:D.toJson(C.toJson()),target:D.toJson({geometryType:h.getJsonType(g),
geometry:g.toJson()}),reshaper:D.toJson(k.toJson())});var u=this._reshapeHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/reshape",content:g,callbackParamName:"callback",load:function(v,A){u(v,A,C,w,t,l)},error:function(v){x(v,t,l)}});return l},_reshapeHandler:function(g,k,w,t,C,u){try{var x=h.fromJson(g.geometry).setSpatialReference(w);this._successHandler([x],"onReshapeComplete",t,u)}catch(l){this._errorHandler(l,C,u)}},onReshapeComplete:function(){},cut:function(g,
k,w,t){var C=g[0].spatialReference,u=a.map(g,function(A){return A.toJson()});g=m.mixin({},this._url.query,{f:"json",sr:D.toJson(C.toJson()),target:D.toJson({geometryType:h.getJsonType(g[0]),geometries:u}),cutter:D.toJson(k.toJson())});var x=this._cutHandler,l=this._errorHandler,v=new z(n._dfdCanceller);v._pendingDfd=q({url:this._url.path+"/cut",content:g,callbackParamName:"callback",load:function(A,B){x(A,B,C,w,t,v)},error:function(A){l(A,t,v)}});return v},_cutHandler:function(g,k,w,t,C,u){try{var x=
g.geometries,l={};l.cutIndexes=g.cutIndexes;l.geometries=[];a.forEach(x,function(v){l.geometries.push(h.fromJson(v).setSpatialReference(w))});this._successHandler([l],"onCutComplete",t,u)}catch(v){this._errorHandler(v,C,u)}},onCutComplete:function(){},intersect:function(g,k,w,t){var C=g[0].spatialReference;g=m.mixin({},this._url.query,{f:"json",sr:D.toJson(C.toJson()),geometries:D.toJson(this._encodeGeometries(g)),geometry:D.toJson({geometryType:h.getJsonType(k),geometry:k.toJson()})});var u=this._intersectHandler,
x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/intersect",content:g,callbackParamName:"callback",load:function(v,A){u(v,A,C,w,t,l)},error:function(v){x(v,t,l)}});return l},_intersectHandler:function(g,k,w,t,C,u){try{var x=[];a.forEach(g.geometries,function(l){x.push(h.fromJson(l).setSpatialReference(w))});this._successHandler([x],"onIntersectComplete",t,u)}catch(l){this._errorHandler(l,C,u)}},onIntersectComplete:function(){},difference:function(g,k,w,t){var C=
g[0].spatialReference;g=m.mixin({},this._url.query,{f:"json",sr:D.toJson(C.toJson()),geometries:D.toJson(this._encodeGeometries(g)),geometry:D.toJson({geometryType:h.getJsonType(k),geometry:k.toJson()})});var u=this._differenceHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/difference",content:g,callbackParamName:"callback",load:function(v,A){u(v,A,C,w,t,l)},error:function(v){x(v,t,l)}});return l},_differenceHandler:function(g,k,w,t,C,u){try{var x=[];a.forEach(g.geometries,
function(l){x.push(h.fromJson(l).setSpatialReference(w))});this._successHandler([x],"onDifferenceComplete",t,u)}catch(l){this._errorHandler(l,C,u)}},onDifferenceComplete:function(){},buffer:function(g,k,w){var t=m.mixin({},this._url.query,{f:"json"},g.toJson()),C=g.outSpatialReference||g.geometries[0].spatialReference,u=this._bufferHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/buffer",content:t,callbackParamName:"callback",load:function(v,A){u(v,A,C,k,
w,l)},error:function(v){x(v,w,l)}});return l},_bufferHandler:function(g,k,w,t,C,u){try{var x=g.geometries;g=[];var l,v=x.length;for(l=0;l<v;l++)g[l]=new b({spatialReference:w,rings:x[l].rings});this._successHandler([g],"onBufferComplete",t,u)}catch(A){this._errorHandler(A,C,u)}},onBufferComplete:function(){},areasAndLengths:function(g,k,w){g=m.mixin({},this._url.query,{f:"json"},g.toJson());var t=this._areasAndLengthsHandler,C=this._errorHandler,u=new z(n._dfdCanceller);u._pendingDfd=q({url:this._url.path+
"/areasAndLengths",content:g,callbackParamName:"callback",load:function(x,l){t(x,l,k,w,u)},error:function(x){C(x,w,u)}});return u},_areasAndLengthsHandler:function(g,k,w,t,C){try{this._successHandler([g],"onAreasAndLengthsComplete",w,C)}catch(u){this._errorHandler(u,t,C)}},onAreasAndLengthsComplete:function(){},lengths:function(g,k,w){g=m.mixin({},this._url.query,{f:"json"},g.toJson());var t=this._lengthsHandler,C=this._errorHandler,u=new z(n._dfdCanceller);u._pendingDfd=q({url:this._url.path+"/lengths",
content:g,callbackParamName:"callback",load:function(x,l){t(x,l,k,w,u)},error:function(x){C(x,w,u)}});return u},_lengthsHandler:function(g,k,w,t,C){try{this._successHandler([g],"onLengthsComplete",w,C)}catch(u){this._errorHandler(u,t,C)}},onLengthsComplete:function(){},labelPoints:function(g,k,w){var t=a.map(g,function(v){return v.toJson()}),C=g[0].spatialReference;t=m.mixin({},this._url.query,{f:"json",sr:C.wkid?C.wkid:D.toJson(C.toJson()),polygons:D.toJson(t)});var u=this._labelPointsHandler,x=
this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/labelPoints",content:t,callbackParamName:"callback",load:function(v,A){u(v,A,g,C,k,w,l)},error:function(v){x(v,w,l)}});return l},_labelPointsHandler:function(g,k,w,t,C,u,x){try{var l=[];a.forEach(g.labelPoints,function(v){l.push(h.fromJson(v).setSpatialReference(t))});this._successHandler([l],"onLabelPointsComplete",C,x)}catch(v){this._errorHandler(v,u,x)}},onLabelPointsComplete:function(){},relation:function(g,k,w){g=
m.mixin({},this._url.query,{f:"json"},g.toJson());var t=this._relationHandler,C=this._errorHandler,u=new z(n._dfdCanceller);u._pendingDfd=q({url:this._url.path+"/relation",content:g,callbackParamName:"callback",load:function(x,l){t(x,l,k,w,u)},error:function(x){C(x,w,u)}});return u},_relationHandler:function(g,k,w,t,C){try{this._successHandler([g.relations],"onRelationComplete",w,C)}catch(u){this._errorHandler(u,t,C)}},onRelationComplete:function(){},trimExtend:function(g,k,w){var t=m.mixin({},this._url.query,
{f:"json"},g.toJson()),C=g.sr,u=this._trimExtendHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/trimExtend",content:t,callbackParamName:"callback",load:function(v,A){u(v,A,C,k,w,l)},error:function(v){x(v,w,l)}});return l},_trimExtendHandler:function(g,k,w,t,C,u){try{var x=g.geometries;g=[];var l,v=x.length;for(l=0;l<v;l++)g[l]=new e({spatialReference:w,paths:x[l].paths});this._successHandler([g],"onTrimExtendComplete",t,u)}catch(A){this._errorHandler(A,
C,u)}},onTrimExtendComplete:function(){},densify:function(g,k,w){var t=m.mixin({},this._url.query,{f:"json"},g.toJson()),C=g.geometries[0].spatialReference,u=this._densifyHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/densify",content:t,callbackParamName:"callback",load:function(v,A){u(v,A,C,k,w,l)},error:function(v){x(v,w,l)}});return l},_densifyHandler:function(g,k,w,t,C,u){try{var x=[];a.forEach(g.geometries,function(l){x.push(h.fromJson(l).setSpatialReference(w))});
this._successHandler([x],"onDensifyComplete",t,u)}catch(l){this._errorHandler(l,C,u)}},onDensifyComplete:function(){},generalize:function(g,k,w){var t=m.mixin({},this._url.query,{f:"json"},g.toJson()),C=g.geometries[0].spatialReference,u=this._generalizeHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/generalize",content:t,callbackParamName:"callback",load:function(v,A){u(v,A,C,k,w,l)},error:function(v){x(v,w,l)}});return l},_generalizeHandler:function(g,
k,w,t,C,u){try{var x=[];a.forEach(g.geometries,function(l){x.push(h.fromJson(l).setSpatialReference(w))});this._successHandler([x],"onGeneralizeComplete",t,u)}catch(l){this._errorHandler(l,C,u)}},onGeneralizeComplete:function(){},offset:function(g,k,w){var t=m.mixin({},this._url.query,{f:"json"},g.toJson()),C=g.geometries[0].spatialReference,u=this._offsetHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/offset",content:t,callbackParamName:"callback",load:function(v,
A){u(v,A,C,k,w,l)},error:function(v){x(v,w,l)}});return l},_offsetHandler:function(g,k,w,t,C,u){try{var x=[];a.forEach(g.geometries,function(l){x.push(h.fromJson(l).setSpatialReference(w))});this._successHandler([x],"onOffsetComplete",t,u)}catch(l){this._errorHandler(l,C,u)}},onOffsetComplete:function(){},distance:function(g,k,w){var t=m.mixin({},this._url.query,{f:"json"},g.toJson()),C=g.geometry1.spatialReference,u=this._distanceHandler,x=this._errorHandler,l=new z(n._dfdCanceller);l._pendingDfd=
q({url:this._url.path+"/distance",content:t,callbackParamName:"callback",load:function(v,A){u(v,A,C,k,w,l)},error:function(v){x(v,w,l)}});return l},_distanceHandler:function(g,k,w,t,C,u){try{g=g&&g.distance,this._successHandler([g],"onDistanceComplete",t,u)}catch(x){this._errorHandler(x,C,u)}},onDistanceComplete:function(){},toGeoCoordinateString:function(g,k,w){var t={};m.isObject(g.sr)?t.sr=g.sr.wkid||D.toJson(g.sr.toJson()):t.sr=g.sr;t.coordinates=D.toJson(g.coordinates);t.conversionType=g.conversionType||
"MGRS";t.conversionMode=g.conversionMode;t.numOfDigits=g.numOfDigits;t.rounding=g.rounding;t.addSpaces=g.addSpaces;g=m.mixin({},this._url.query,{f:"json"},t);var C=this._toGeoCoordinateHandler,u=this._errorHandler,x=new z(n._dfdCanceller);x._pendingDfd=q({url:this._url.path+"/toGeoCoordinateString",content:g,callbackParamName:"callback",load:function(l,v){C(l,v,k,w,x)},error:function(l){u(l,w,x)}});return x},_toGeoCoordinateHandler:function(g,k,w,t,C){try{this._successHandler([g.strings],"onToGeoCoordinateStringComplete",
w,C)}catch(u){this._errorHandler(u,t,C)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(g,k,w){var t={};m.isObject(g.sr)?t.sr=g.sr.wkid||D.toJson(g.sr.toJson()):t.sr=g.sr;t.strings=D.toJson(g.strings);t.conversionType=g.conversionType||"MGRS";t.conversionMode=g.conversionMode;g=m.mixin({},this._url.query,{f:"json"},t);var C=this._fromGeoCoordinateHandler,u=this._errorHandler,x=new z(n._dfdCanceller);x._pendingDfd=q({url:this._url.path+"/fromGeoCoordinateString",content:g,
callbackParamName:"callback",load:function(l,v){C(l,v,k,w,x)},error:function(l){u(l,w,x)}});return x},_fromGeoCoordinateHandler:function(g,k,w,t,C){try{this._successHandler([g.coordinates],"onToGeoCoordinateStringComplete",w,C)}catch(u){this._errorHandler(u,t,C)}},onFromGeoCoordinateStringComplete:function(){}});m.mixin(F,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});m.setObject("tasks.GeometryService",F,r);return F})},"esri/tasks/TrimExtendParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.tasks.TrimExtendParameters",
polylines:null,trimExtendTo:null,extendHow:null,toJson:function(){var r=a.map(this.polylines,function(n){return n.toJson()}),q={};q.polylines=D.toJson(r);q.trimExtendTo=D.toJson(this.trimExtendTo.toJson());q.sr=D.toJson(this.polylines[0].spatialReference.toJson());q.extendHow=this.extendHow||0;return q}});m.mixin(F,{DEFAULT_CURVE_EXTENSION:0,RELOCATE_ENDS:1,KEEP_END_ATTRIBUTES:2,NO_END_ATTRIBUTES:4,NO_EXTEND_AT_FROM:8,NO_EXTEND_AT_TO:16});m.setObject("tasks.TrimExtendParameters",F,y);return F})},
"esri/tasks/BufferParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/Polygon ../geometry/jsonUtils".split(" "),function(F,m,a,D,z,y,r,q){F=F(null,{declaredClass:"esri.tasks.BufferParameters",geometries:null,outSpatialReference:null,bufferSpatialReference:null,distances:null,unit:null,unionResults:!1,geodesic:!1,toJson:function(){var n={unit:this.unit,unionResults:this.unionResults,geodesic:this.geodesic},f=this.distances,
d=this.outSpatialReference,e=this.bufferSpatialReference,b=a.map(this.geometries,function(g){g="extent"===g.type?r.fromExtent(g):g;return g.toJson()},this),c=this.geometries;if(c&&0<c.length){var h="extent"===c[0].type?"esriGeometryPolygon":q.getJsonType(c[0]);n.geometries=D.toJson({geometryType:h,geometries:b});n.inSR=c[0].spatialReference.wkid?c[0].spatialReference.wkid:D.toJson(c[0].spatialReference.toJson())}f&&(n.distances=f.join(","));d&&(n.outSR=d.wkid?d.wkid:D.toJson(d.toJson()));e&&(n.bufferSR=
e.wkid?e.wkid:D.toJson(e.toJson()));return n}});m.setObject("tasks.BufferParameters",F,y);return F})},"esri/tasks/RelationParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.tasks.RelationParameters",geometries1:null,geometries2:null,relation:null,relationParam:null,toJson:function(){var q=a.map(this.geometries1,function(e){return e.toJson()}),n=
a.map(this.geometries2,function(e){return e.toJson()}),f={},d=this.geometries1;d&&0<d.length&&(f.geometries1=D.toJson({geometryType:r.getJsonType(d[0]),geometries:q}),q=this.geometries1[0].spatialReference,f.sr=q.wkid?q.wkid:D.toJson(q.toJson()));(q=this.geometries2)&&0<q.length&&(f.geometries2=D.toJson({geometryType:r.getJsonType(q[0]),geometries:n}));this.relation&&(f.relation=this.relation);this.relationParam&&(f.relationParam=this.relationParam);return f}});m.mixin(F,{SPATIAL_REL_CROSS:"esriGeometryRelationCross",
SPATIAL_REL_DISJOINT:"esriGeometryRelationDisjoint",SPATIAL_REL_IN:"esriGeometryRelationIn",SPATIAL_REL_INTERIORINTERSECTION:"esriGeometryRelationInteriorIntersection",SPATIAL_REL_INTERSECTION:"esriGeometryRelationIntersection",SPATIAL_REL_COINCIDENCE:"esriGeometryRelationLineCoincidence",SPATIAL_REL_LINETOUCH:"esriGeometryRelationLineTouch",SPATIAL_REL_OVERLAP:"esriGeometryRelationOverlap",SPATIAL_REL_POINTTOUCH:"esriGeometryRelationPointTouch",SPATIAL_REL_TOUCH:"esriGeometryRelationTouch",SPATIAL_REL_WITHIN:"esriGeometryRelationWithin",
SPATIAL_REL_RELATION:"esriGeometryRelationRelation"});m.setObject("tasks.RelationParameters",F,y);return F})},"esri/tasks/DensifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.tasks.DensifyParameters",geometries:null,geodesic:null,lengthUnit:null,maxSegmentLength:null,toJson:function(){var q=a.map(this.geometries,function(f){return f.toJson()}),
n={};this.geometries&&0<this.geometries.length&&(n.geometries=D.toJson({geometryType:r.getJsonType(this.geometries[0]),geometries:q}),n.sr=D.toJson(this.geometries[0].spatialReference.toJson()));this.geodesic&&(n.geodesic=this.geodesic);this.lengthUnit&&(n.lengthUnit=this.lengthUnit);this.maxSegmentLength&&(n.maxSegmentLength=this.maxSegmentLength);return n}});m.setObject("tasks.DensifyParameters",F,y);return F})},"esri/tasks/GeneralizeParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),
function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.tasks.GeneralizeParameters",geometries:null,deviationUnit:null,maxDeviation:null,toJson:function(){var q=a.map(this.geometries,function(f){return f.toJson()}),n={};this.geometries&&0<this.geometries.length&&(n.geometries=D.toJson({geometryType:r.getJsonType(this.geometries[0]),geometries:q}),n.sr=D.toJson(this.geometries[0].spatialReference.toJson()));this.deviationUnit&&(n.deviationUnit=this.deviationUnit);this.maxDeviation&&(n.maxDeviation=this.maxDeviation);
return n}});m.setObject("tasks.GeneralizeParameters",F,y);return F})},"esri/tasks/OffsetParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.tasks.OffsetParameters",geometries:null,bevelRatio:null,offsetDistance:null,offsetHow:null,offsetUnit:null,toJson:function(){var q=a.map(this.geometries,function(f){return f.toJson()}),n={};this.geometries&&
0<this.geometries.length&&(n.geometries=D.toJson({geometryType:r.getJsonType(this.geometries[0]),geometries:q}),n.sr=D.toJson(this.geometries[0].spatialReference.toJson()));this.bevelRatio&&(n.bevelRatio=this.bevelRatio);this.offsetDistance&&(n.offsetDistance=this.offsetDistance);this.offsetHow&&(n.offsetHow=this.offsetHow);this.offsetUnit&&(n.offsetUnit=this.offsetUnit);return n}});m.mixin(F,{OFFSET_BEVELLED:"esriGeometryOffsetBevelled",OFFSET_MITERED:"esriGeometryOffsetMitered",OFFSET_ROUNDED:"esriGeometryOffsetRounded"});
m.setObject("tasks.OffsetParameters",F,y);return F})},"esri/tasks/DistanceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.tasks.DistanceParameters",geometry1:null,geometry2:null,distanceUnit:null,geodesic:null,toJson:function(){var r={},q=this.geometry1;q&&(r.geometry1=a.toJson({geometryType:y.getJsonType(q),geometry:q}));if(q=this.geometry2)r.geometry2=a.toJson({geometryType:y.getJsonType(q),
geometry:q});r.sr=a.toJson(this.geometry1.spatialReference.toJson());this.distanceUnit&&(r.distanceUnit=this.distanceUnit);this.geodesic&&(r.geodesic=this.geodesic);return r}});m.setObject("tasks.DistanceParameters",F,z);return F})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/global dojo/promise/all ../sniff ../kernel ../lang ../request ../config ../deferredUtils ../promiseList ../SpatialReference ../urlUtils ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../support/expressionUtils ../arcadeProfiles/labelingProfile ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./TimeReference ./FeatureType ./FeatureTemplate ./FeatureSubtype ./FeatureEditResult ./LabelClass ./support/domainUtils ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./GridLayout ./TrackManager ./HeatmapManager ./clustering/ClusterManager dojo/i18n!../nls/jsapi ./agscommon".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K,ba,T,P,J,N,Z,Y,qa,V,na,ya,S,ma,ja,X,oa,xa,Ha,Ia,ia,ea,za,Ca,Da,ka,ta,M,Ga,La){var aa=C.defaults,Ya=!!g("esri-pbf"),Wa=!!g("esri-featurelayer-pbf"),Ea=a(ya,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reSQLCurrentTimestamp:/current_timestamp|current_date|current_time/i,reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,
maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error",
"info"]},constructor:function(U,fa){this._preventInit||this._initFeatureLayer(U,fa)},_initFeatureLayer:function(U,fa){fa=fa||{};this._tileWidth=fa.tileWidth||512;this._tileHeight=fa.tileHeight||512;this.i18n=La;this._featureReduction=this._featureReduction||fa.featureReduction;this._featureReductionEnabled=null!=fa.featureReductionEnabled?fa.featureReductionEnabled:!0;this._featureUpdatesCheckEnabled=null!=fa.featureUpdatesCheckEnabled?fa.featureUpdatesCheckEnabled:!0;this.showLabels=null!=fa.showLabels?
fa.showLabels:!0;this._outFields=fa.outFields;this._defnExpr=fa.definitionExpression;this._loadCallback=fa.loadCallback;this._trackIdField=fa.trackIdField;this.objectIdField=fa.objectIdField;var sa=null!=fa.resolution,O=null!=fa.maxAllowableOffset;this._maxOffset=this._optMaxOffset=sa||O?sa?fa.resolution:fa.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=fa.quantize?fa.quantize:!0;this._optEditable=fa.editable;this._optAutoGen=fa.autoGeneralize;this.editSummaryCallback=fa.editSummaryCallback;
this.userId=fa.userId;this.userIsAdmin=fa.userIsAdmin;this.useMapTime=fa.hasOwnProperty("useMapTime")?!!fa.useMapTime:!0;this.source=fa.source;this.gdbVersion=fa.gdbVersion;this.orderByFields=fa.orderByFields;this.maxPointCountForAuto=null!=fa.maxPointCountForAuto?fa.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=fa.maxRecordCountForAuto?fa.maxRecordCountForAuto:this.maxRecordCountForAuto;this.maxVertexCountForAuto=null!=fa.maxVertexCountForAuto?fa.maxVertexCountForAuto:
this.maxVertexCountForAuto;this.generalizeForScale=null!=fa.generalizeForScale?fa.generalizeForScale:this.generalizeForScale;this.queryPagination=this._optQueryPagination=null!=fa.queryPagination?fa.queryPagination:!0;this.multipatchOption=fa.multipatchOption;this.subtypeSublayerInfo=fa.subtypeSublayerInfo;this._selectedFeatures={};this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();sa=w.isDefined(fa.mode)?fa.mode:Ea.MODE_ONDEMAND;this._isStream&&(sa=Ea.MODE_STREAM);this.mode=
sa;switch(sa){case Ea.MODE_SNAPSHOT:this.currentMode=Ea.MODE_SNAPSHOT;this._mode=new ea(this);break;case Ea.MODE_ONDEMAND:case Ea.MODE_AUTO:this.currentMode=Ea.MODE_ONDEMAND;this._mode=new za(this);this.latticeTiling=fa.latticeTiling;break;case Ea.MODE_SELECTION:this.currentMode=Ea.MODE_SELECTION;this._mode=new Ca(this);this._isSelOnly=!0;break;case Ea.MODE_STREAM:this.currentMode=Ea.MODE_STREAM,this._mode=new Da(this),this._isStream=!0}this._initLayer=z.hitch(this,this._initLayer);this._selectHandler=
z.hitch(this,this._selectHandler);this._editable=!1;if(z.isObject(U)&&U.layerDefinition)return this._collection=!0,this.mode=this._isStream?Ea.MODE_STREAM:Ea.MODE_SNAPSHOT,this._isStream||this._outFields||(this._outFields=["*"]),this._initLayer(U),this;this.source&&(sa={source:this.source.toJson()},this._url.query=z.mixin(this._url.query,{layer:r.toJson(sa)}));this.gdbVersion&&(this._url.query=z.mixin(this._url.query,{gdbVersion:this.gdbVersion}));this._task=new P(this.url,{source:this.source,gdbVersion:this.gdbVersion});
sa=this._url.path;this._fserver=!1;-1!==sa.search(/\/FeatureServer\//i)&&(this._fserver=!0);this._checkFeatureLimit();(O=fa.resourceInfo)?this._initLayer(O):t({url:sa,content:z.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});this.registerConnectEvents()},_initLayer:function(U,fa){if(U||fa){this._json=U;var sa=this.subtypeSublayerInfo;this._findCredential();if(this.credential&&this.credential.ssl||U&&U._ssl)this._useSSL(),this._task._useSSL();
this._collection&&(this._isStream||(this.currentMode=Ea.MODE_SNAPSHOT,this._mode=new ea(this)),this._featureSet=U.featureSet,this._nextId=U.nextObjectId,U=U.layerDefinition);this.version=U.currentVersion;this.version||(this.version="capabilities"in U||"drawingInfo"in U||"hasAttachments"in U||"htmlPopupType"in U||"relationships"in U||"timeInfo"in U||"typeIdField"in U||"types"in U?10:9.3);this.geometryType=U.geometryType;U.bandCount&&U.fields&&1<U.fields.length&&(this.geometryType="esriGeometryPolygon",
this._isImageService=!0);"string"!==typeof this.multipatchOption&&"esriGeometryMultiPatch"===this.geometryType&&(this.multipatchOption="xyFootprint");if(U.hasOwnProperty("capabilities")){var O=this.capabilities=U.capabilities;O&&-1!==O.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=!1}else this._collection||(this._editable=this._fserver);w.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&(this._editable=
!1);this._isImageService&&(this._editable=!1);this._json=r.toJson(this._json);this.isEditable()?this._setMaxOffset(null):this._canAutoGeneralize()&&(this._autoGeneralize=w.isDefined(this._optAutoGen)?this._optAutoGen:this.mode===Ea.MODE_ONDEMAND||this.mode===Ea.MODE_AUTO,delete this._optAutoGen);O=U.effectiveMinScale||U.minScale;var ca=U.effectiveMaxScale||U.maxScale;!this._hasMin&&O&&this.setMinScale(O);!this._hasMax&&ca&&this.setMaxScale(ca);this.layerId=U.id;this.name=sa&&sa.title||U.name;this.description=
U.description;this.copyright=U.copyrightText;this.type=U.type;this.displayField=U.displayField;this.defaultDefinitionExpression=U.definitionExpression||(U.isView?U.viewDefinitionQuery:U.definitionQuery);this.fullExtent=new Y(U.extent);this.initialExtent=new Y(this.fullExtent.toJson());this.fullExtent.spatialReference&&(this.spatialReference=new l(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=U.defaultVisibility;this.editingInfo=U.editingInfo;this.supportsLastEditDate=!(!this.editingInfo||
null==this.editingInfo.lastEditDate);if("esriGeometryPoint"===this.geometryType||"esriGeometryMultipoint"===this.geometryType)this.latticeTiling=!1;this.hasM=U.hasM||!1;this.hasZ=U.hasZ||!1;this.indexedFields=U.indexedFields;this.indexes=U.indexes;this.maxRecordCount=U.maxRecordCount;this.canModifyLayer=U.canModifyLayer;this.supportsStatistics=U.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:U.supportsAdvancedQueries;this.supportsCalculate=U.supportsCalculate;this.supportsASyncCalculate=
U.supportsASyncCalculate;this.supportsAttachmentsByUploadId=U.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=U.supportsCoordinatesQuantization;this.supportsQuantizationEditMode=U.supportsQuantizationEditMode;this.supportsFieldDescription=U.supportsFieldDescriptionProperty;this.supportsFormatPBF=U.supportedQueryFormats?-1!==y.map(U.supportedQueryFormats.toLowerCase().split(","),z.trim).indexOf("pbf"):!1;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;this.hasLabels=
U.hasLabels;this.canScaleSymbols=U.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=U.supportsRollbackOnFailure;this.syncCanReturnChanges=U.syncCanReturnChanges;this.isDataVersioned=U.isDataVersioned;this.editFieldsInfo=U.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=U.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=U.relationships;
this.allowGeometryUpdates=w.isDefined(U.allowGeometryUpdates)?U.allowGeometryUpdates:!0;this.allowUpdateWithoutMValues=!!U.allowUpdateWithoutMValues;this.enableZDefaults=!!U.enableZDefaults;this.zDefault=w.isDefined(U.zDefault)?U.zDefault:null;this.advancedQueryCapabilities=U.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};this.geometryProperties=U.hasGeometryProperties&&U.geometryProperties||
null;this.url&&(this.advancedQueryCapabilities.supportsPagination=this.advancedQueryCapabilities.supportsPagination&&(this.reHostedFS.test(this.url)||10.3<this.version));this.queryPagination=this._optQueryPagination&&this.advancedQueryCapabilities.supportsPagination;this.useStandardizedQueries=U.useStandardizedQueries;this.tileMaxRecordCount=U.tileMaxRecordCount;this.standardMaxRecordCount=U.standardMaxRecordCount;if(O=U.dateFieldsTimeReference)this.dateFieldsTimeReference=new ja(O);this._setMaxOffset(this._maxOffset,
!0);this._isTable="Table"===this.type;ca=U.fields;this._createFields(ca);if(!this.objectIdField&&(this.objectIdField=U.objectIdField,!this.objectIdField))for(ca=U.fields,O=0;O<ca.length;O++){var va=ca[O];if("esriFieldTypeOID"===va.type){this.objectIdField=va.name;break}}if(!w.isDefined(this._nextId)){ca=this.objectIdField;va=-1;if(this._collection&&ca){var H=(O=this._featureSet)&&O.features,R=H?H.length:0;for(O=0;O<R;O++){var W=(W=H[O].attributes)&&W[ca];W>va&&(va=W)}}this._nextId=va+1}this.globalIdField=
U.globalIdField;if(O=this.typeIdField=U.typeIdField)if(O=!this._getField(O)&&this._getField(O,!0))this.typeIdField=O.name;this.visibilityField=U.visibilityField;if(ca=U.defaultSymbol)this.defaultSymbol=G.fromJson(ca);var pa=this.types=[],ra=U.types;va=(O=this.editFieldsInfo)&&O.creatorField;H=O&&O.editorField;W=va||H;R=[];if(ra)for(O=0;O<ra.length;O++){var Aa=new X(ra[O]);var Ba=Aa.templates;W&&Ba&&Ba.length&&(R=R.concat(Ba));pa.push(Aa)}ra=U.templates;Aa=this.templates=[];if(ra)for(O=0;O<ra.length;O++)pa=
new oa(ra[O]),W&&R.push(pa),Aa.push(pa);for(O=0;O<R.length;O++)if(W=z.getObject("prototype.attributes",!1,R[O]))va&&delete W[va],H&&delete W[H];if(O=U.subtypeField)this.subtypeField=(O=this.getField(O))?O.name:null;this.defaultSubtypeCode=U.defaultSubtypeCode;this.subtypes=y.map(U.subtypes,function(db){return new xa(db)});this._applySTSublayerInfo(sa);if(sa=U.timeInfo)this.timeInfo=new ma(sa),this._startTimeField=sa.startTimeField,this._endTimeField=sa.endTimeField,this._startTimeField&&this._endTimeField&&
(this._twoTimeFields=!0),this._trackIdField?sa.trackIdField=this._trackIdField:this._trackIdField=sa.trackIdField;this.hasAttachments=!this._collection&&U.hasAttachments?!0:!1;this.htmlPopupType=U.htmlPopupType;sa=U.drawingInfo;(O=sa&&sa.labelingInfo)&&!this.labelingInfo&&(this.labelingInfo=y.map(O,function(db){return new Ia(db)}),this._fixLabelExpr());if(!this.renderer)if(sa&&sa.renderer){var Ja=sa.renderer;this.setRenderer(K.fromJson(Ja,{geometryType:this.geometryType}));"classBreaks"===Ja.type&&
this.renderer.setMaxInclusive(!0);if(!this._collection){var Ka=Ja.type;O=[];Ja=this.renderer;switch(Ka){case "simple":O.push(Ja.symbol);break;case "uniqueValue":case "classBreaks":O.push(Ja.defaultSymbol),O=O.concat(y.map(Ja.infos,function(db){return db.symbol}))}O=y.filter(O,w.isDefined);var Ra=this._url.path+"/images/",Va=this._getToken();y.forEach(O,function(db){var jb=db.url;jb&&(-1===jb.search(/https?:/)&&-1===jb.indexOf("data:")&&(db.url=Ra+jb),Va&&-1!==db.url.search(/https?:/)&&(db.url+="?token\x3d"+
Va))})}}else if(ca)ra=this.types,0<ra.length?(Ja=new L(this.defaultSymbol,this.typeIdField),y.forEach(ra,function(db){Ja.addValue(db.id,db.symbol)})):Ja=new I(this.defaultSymbol),this.setRenderer(Ja);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":Ka=new A;break;case "esriGeometryPolyline":Ka=new B;break;case "esriGeometryPolygon":Ka=new E;break;default:this.hasXYFootprint()&&(Ka=new E)}this.setRenderer(Ka?new I(Ka):null)}Ka=sa&&sa.transparency||
0;!this.hasOwnProperty("opacity")&&0<Ka&&(this.opacity=1-Ka/100);(g("ie")||7<=g("trident")||g("safari"))&&this.isEditable()&&10.02>this.version&&(this._ts=!0);this.statistics=U.statistics;this._fixRendererFields();this._updateRequiredFieldsFromLabelingInfo();this._checkFields();this._updateCaps();var ab=function(){null==this._maxOffset||this._isFractionalOffsetAllowed()||this._setMaxOffset(this._maxOffset);this.loaded=!0;this.setFeatureReduction(this.getFeatureReduction());this.currentMode!==Ea.MODE_SNAPSHOT&&
(this.queryPagination=!1);this.onLoad(this);var db=this._loadCallback;db&&(delete this._loadCallback,db(this))};Ka=[];this._collection?(sa=this._featureSet,this._featureSet=null,this._mode._drawFeatures(new N(sa)),this._fcAdded=!0):(Ka.push(this._forceIdentity()),this._limitPromise&&Ka.push(this._limitPromise));Ka.push(this._evalArcadeSupport());Ka.length?x(Ka).then(z.hitch(this,function(){ab.call(this)})):ab.call(this)}},_applySTSublayerInfo:function(U){U&&this.subtypeField&&(this.subtypeCode=U.subtypeCode,
this._applySTSublayerDefinitionExpression(U),this._filterSubtypes(U),this._applySTTemplates(U),this._applySTFieldOverrides(U))},_applySTSublayerDefinitionExpression:function(U){var fa=[],sa=this.getDefinitionExpression();sa&&fa.push(sa);(U=U.layerDefinition&&U.layerDefinition.definitionExpression)&&fa.push(U);1<fa.length&&(fa=y.map(fa,function(O){return"("+O+")"}));this.setDefinitionExpression(fa.length?fa.join(" AND "):null)},_applySTTemplates:function(U){if(U=U.layerDefinition&&U.layerDefinition.templates)this.templates=
y.map(U,function(fa){return new oa(fa)})},_filterSubtypes:function(){this.subtypes&&(this.subtypes=y.filter(this.subtypes,function(U){return U.code===this.subtypeCode},this))},_applySTFieldOverrides:function(U){var fa=U.layerDefinition&&U.layerDefinition.fieldOverrides;if(fa){this.fields=y.filter(this.fields,function(O){return y.some(fa,function(ca){return ca.name===O.name})});var sa=this.getSubtypeByCode(this.subtypeCode).domains;this.fields.forEach(function(O){var ca=y.filter(fa,function(va){return va.name===
O.name})[0];ca.alias&&(O.alias=ca.alias);if(!1===ca.editable||O.name===this.subtypeField)O.editable=!1;sa&&(ca=sa[O.name])&&"inherited"!==ca.type&&(O.domain=ia.fromJson(ca.toJson()))},this)}},setShowLabels:function(U){var fa=this.showLabels;this.showLabels=U;fa!==this.showLabels&&(this._evalSurfaceType(),this.onShowLabelsChange())},onShowLabelsChange:function(){},onRendererChange:function(U){this.inherited(arguments);var fa=this._map;this._ager=!!(U&&U.observationAger&&U.observationRenderer);U&&"colors"in
U&&"blurRadius"in U&&"maxPixelIntensity"in U?(this._evalSurfaceType(!0),"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&fa&&(this._heatmapManager=new M(this),this._heatmapManager.initialize(fa))):this.renderer&&this.renderer.getRendererInfo?y.some(this.renderer.rendererInfos,function(ca){return ca.renderer&&"colors"in ca.renderer&&"blurRadius"in ca.renderer})||(this._heatmapManager=null):this._heatmapManager=null;this.timeInfo&&fa&&(U&&(U.latestObservationRenderer||U.trackRenderer)?
this._trackManager||(this._trackManager=new ta(this),this._trackManager.initialize(fa),this._childLayer=this._trackManager.container,this._mode._applyTimeFilter()):this._trackManager&&!this._isStream&&(this._trackManager.destroy(),this._trackManager=null));if(U){var sa=[];fa=y.filter([U,U.observationRenderer,U.latestObservationRenderer,U.trackRenderer],w.isDefined);var O=function(ca){return null!=ca&&"function"!=typeof ca&&ca};y.forEach(fa,function(ca){var va=O(ca.attributeField),H=O(ca.attributeField2);
ca=O(ca.attributeField3);!1!==va&&sa.push(va);!1!==H&&sa.push(H);!1!==ca&&sa.push(ca)});this._requiredFields=sa}else this._requiredFields=[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._requiredFields),this._collection&&(this._typesDirty=!0))},setFeatureReduction:function(U){U&&(U=z.mixin({},U),null!=U.clusterSize&&null==U.clusterRadius&&(U.clusterRadius=U.clusterSize),delete U.clusterSize);this.loaded?this._isFeatureReductionSupported(U)?this._featureReduction=U:this._featureReduction=
null:this._featureReduction=U;this._evalFeatureReduction(this._featureReduction)},hasFeatureReduction:function(){return!!this._featureReduction},getFeatureReduction:function(){var U=this._featureReduction;if(U){U=z.mixin({},U);var fa=this._clusterManager;if(fa=fa&&fa.aggregationInfo)U.clusterRadius=fa.clusterRadius,U.infoTemplate=fa.infoTemplate}return U},isFeatureReductionActive:function(){var U=this._clusterManager;return!!(U&&U.isClusteringEnabled()&&U.isClusteringActive())},isFeatureReductionEnabled:function(){return this._featureReductionEnabled},
enableFeatureReduction:function(){this._featureReductionEnabled||(this._featureReductionEnabled=!0,this._evalFeatureReduction(this._featureReduction))},disableFeatureReduction:function(){this._featureReductionEnabled&&(this._featureReductionEnabled=!1,this._evalFeatureReduction(this._featureReduction))},isFeatureReductionApplied:function(){return this.hasFeatureReduction()&&this.isFeatureReductionEnabled()&&this._canCluster(this.getFeatureReduction())},getAggregateGraphics:function(){return this._clusterManager?
this._clusterManager.getAggregateGraphics():[]},getChildGraphics:function(U){return this._clusterManager?this._clusterManager.getFeaturesInCluster(U):[]},getSingleGraphics:function(){return this._clusterManager?this._clusterManager.getSingleGraphics():[]},getFeatureReductionRenderer:function(){return this.isFeatureReductionActive()?this._clusterManager.getClusterRenderer():null},getFeatureReductionLayer:function(){return this._clusterManager?this._clusterManager.container:null},getFeatureReductionField:function(U){var fa,
sa=this._clusterManager?this._clusterManager.getClusterFields():null;U=U?U.toLowerCase():"";y.some(sa,function(O){U===O.name.toLowerCase()&&(fa=O);return!!fa});return fa},_isFeatureReductionSupported:function(U){return U&&"cluster"===U.type&&"esriGeometryPoint"===this.geometryType&&(this._collection||this._isStream||this._optQueryPagination&&this.advancedQueryCapabilities.supportsPagination)},_isReductionCompatibleRenderer:function(U){U=U&&U.declaredClass||"";U=U.toLowerCase();return-1<U.indexOf("simplerenderer")||
-1<U.indexOf("classbreaksrenderer")||-1<U.indexOf("uniquevaluerenderer")},_evalFeatureReduction:function(U){this.loaded&&this.getMap()&&(U=U||this.getFeatureReduction(),this._evalModeFromFReduction(U),U&&this.isFeatureReductionEnabled()?this._canCluster(U)?this._clusterManager?this._updateClusterManager(U):(this._clusterManager=this._createClusterManager(U),this.onFeatureReductionChange()):this._destroyClusterManager():this._destroyClusterManager())},_canCluster:function(U){var fa=this._map;if(!fa)return!1;
fa=fa.spatialReference;return this._isFeatureReductionSupported(U)&&this._isReductionCompatibleRenderer(this.renderer)&&(fa.isWebMercator()||4326===fa.wkid)},_createClusterManager:function(U){U=new Ga({layer:this,aggregationInfo:U});this._clusterHandles=[U.on("renderer-change",z.hitch(this,function(){this.onFeatureReductionRendererChange()}))];U.initialize(this._map);return U},_updateClusterManager:function(U){var fa=this._clusterManager;fa&&fa.setAggregationInfo(U)},_destroyClusterManager:function(U){y.forEach(this._clusterHandles,
function(fa){fa.remove()});this._clusterHandles=null;this._clusterManager&&(this._clusterManager.destroy(U),this._clusterManager=null,this.onFeatureReductionChange())},redraw:function(){this.inherited(arguments);this._clusterManager&&this._clusterManager.redraw();this._trackManager&&this._trackManager.container&&this._trackManager.container.redraw()},_evalSDRenderer:function(U){this.inherited(arguments);var fa=this._getRenderer();this._ager=!!(fa&&fa.observationAger&&fa.observationRenderer);this._trackManager&&
this._trackManager.container&&this._trackManager.container.setRenderer(fa&&fa.trackRenderer);U&&this._evalFeatureReduction()},_graphicVisibilityChanged:function(U){this._clusterManager?this._clusterManager.toggleFeatureVisibility(U):this._heatmapManager&&this._heatmapManager.redraw()},setWebGLFetchOptions:function(U){this._hasOnDemandDrillMode()&&(U=U||{},null!=U.maxDrillLevel&&(this._mode.maxDrillLevel=U.maxDrillLevel),null!=U.maxRecordCountFactor&&(this._mode.maxRecordCountFactor=U.maxRecordCountFactor),
null!=U.enablePBFQuery&&(this._mode.enablePBFQuery=U.enablePBFQuery))},_isWebGLCompatible:function(){return this.loaded&&!this.isEditable()&&!this.isFeatureReductionApplied()&&(!this.labelingInfo||!1===this.showLabels)&&!this._isGeometryOperationsUsed()&&this._isRendererSupportedInWebGL()&&this.supportsCoordinatesQuantization&&("esriGeometryPolygon"!==this.geometryType||this.advancedQueryCapabilities.supportsReturningGeometryCentroid)&&this.currentMode===Ea.MODE_ONDEMAND&&(!this._preSurfaceChangeState||
this._preSurfaceChangeState.currentMode===Ea.MODE_ONDEMAND)},_isRendererSupportedInWebGL:function(){if(!this.renderer)return!1;var U=this.renderer,fa=U.declaredClass?U.declaredClass.toLowerCase():"";return(-1<fa.indexOf("simplerenderer")||-1<fa.indexOf("classbreaksrenderer")||-1<fa.indexOf("uniquevaluerenderer"))&&this._hasWebGLCompatibleSymbols(U)&&this._hasWebGLCompatibleVVs(U)},_hasWebGLCompatibleSymbols:function(U){U=this._getAllSymbolsInRenderer(U);return!(this._hasSLSWithMarker(U)||this._hasIncompatibleSMSStyles(U)||
this._hasGIFMarker(U))},_hasWebGLCompatibleVVs:function(U){return!y.some(U&&U.visualVariables,function(fa){var sa=fa.type;return("colorInfo"===sa||"opacityInfo"===sa)&&fa.stops&&8<fa.stops.length||"sizeInfo"===sa&&(fa.field||fa.valueExpression&&"$view.scale"!==fa.valueExpression||fa.expression&&"view.scale"!==fa.expression)&&fa.stops&&6<fa.stops.length?!0:!1})},_hasSLSWithMarker:function(U){return y.some(U,function(fa){return fa&&"simplelinesymbol"===fa.type&&!!fa.marker})},_hasIncompatibleSMSStyles:function(U){var fa=
void 0===g("ie")&&7==g("trident");return y.some(U,function(sa){return sa&&"simplemarkersymbol"===sa.type&&("triangle"===sa.style||"path"===sa.style&&fa)})},_hasGIFMarker:function(U){var fa=/\.gif$/,sa=/^image\/gif$/;return y.some(U,function(O){return O&&"picturemarkersymbol"===O.type?fa.test(O.url)||sa.test(O.contentType):!1})},_getAllSymbolsInRenderer:function(U){var fa=[];U&&(fa.push(U.symbol),fa.push(U.defaultSymbol),y.forEach(U.infos,function(sa){fa.push(sa.symbol)}),fa=y.filter(fa,function(sa){return!!sa}));
return fa},_setMap:function(U){var fa=this.inherited(arguments),sa=this._mode,O=this;sa&&U.loaded&&sa.initialize(U);this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,"").toLowerCase());this._addHandle=this.on("graphic-node-add",function(ca){ca=ca.graphic.attributes;(ca=O._selectedFeatures[ca&&ca[O.objectIdField]])&&ca.attr("data-selected","")});return fa},_unsetMap:function(U){this._suspendImpl(!0);this._destroyClusterManager(!1);this._trackManager&&(this._trackManager.destroy(),
this._trackManager=null);D.disconnect(this._zoomConnect);D.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this.inherited("_unsetMap",arguments)},onAttach:function(){this._evalModeFromSurface()},onRefreshTick:function(){this.isFeatureUpdatesCheckActive()&&this._evalFeatureUpdates()},refresh:function(U){!this._needsRefresh&&U&&U.scheduled&&this.isFeatureUpdatesCheckActive()||(this._needsRefresh=!1,(U=this._mode)&&U.refresh())},setFeatureUpdatesCheckEnabled:function(U){this._featureUpdatesCheckEnabled=
U},isFeatureUpdatesCheckEnabled:function(){return!!this._featureUpdatesCheckEnabled},isFeatureUpdatesCheckActive:function(){return this.supportsLastEditDate&&this.isFeatureUpdatesCheckEnabled()&&!!this.refreshInterval&&!!z.getObject("onFeatureUpdatesResult.after",!1,this)},hasFeatureUpdates:function(){var U=new q;if(!this.supportsLastEditDate)return U.reject(Error("FeatureLayer does not support supportsLastEditDate")),U.promise;if(!this._fetchMetadataPromise||this._fetchMetadataPromise.isFulfilled())this._fetchMetadataPromise=
t({url:this._url.path,content:z.mixin({f:"json"},this._url.query),callbackParamName:"callback"}).then(z.hitch(this,function(fa){fa=fa.editingInfo.lastEditDate;var sa=this.editingInfo.lastEditDate!==fa;this.editingInfo.lastEditDate=fa;return sa}));this._fetchMetadataPromise.then(function(fa){U.isFulfilled()||U.resolve(fa)}).otherwise(function(fa){U.isFulfilled()||U.reject(fa)});return U.promise},hasXYFootprint:function(){return"esriGeometryMultiPatch"===this.geometryType&&"xyFootprint"===this.multipatchOption},
getOutFields:function(){return y.filter(this._getOutFields(),function(U){return"*"===U||!!this._getField(U)},this)},getField:function(U){return this._getField(U,!0)},isOutField:function(U){U=this.getField(U);if(!U)return!1;var fa=this.getOutFields();return-1<y.indexOf(fa,"*")||-1<y.indexOf(fa,U.name)},getFieldLabel:function(U){var fa=this.infoTemplate;fa=fa&&fa.getFieldInfo&&fa.getFieldInfo(U);U=z.isFunction(U)?null:this.getField(U);var sa=fa||U,O="";sa&&(O=fa&&fa.label||U&&U.alias||sa.name||sa.fieldName);
return O},getDomain:function(U,fa){var sa,O,ca=fa&&fa.feature,va=ca&&this.typeIdField&&ca.attributes&&ca.attributes[this.typeIdField];null!=va&&y.some(this.types,function(H){return H.id==va?((sa=H.domains&&H.domains[U])&&"inherited"===sa.type&&(sa=this._getLayerDomain(U),O=!0),!0):!1},this);O||sa||(sa=this._getLayerDomain(U));return sa},_getLayerDomain:function(U){this._createFieldsIndex();var fa=this._fieldsIndex;if(fa)return fa=fa.caseSensitive,(fa=fa.get(U))?fa.domain:null;var sa;y.some(this.fields,
function(O){O.name===U&&(sa=O.domain);return!!sa});return sa},getType:function(U){return this.getTypeById(U&&this.typeIdField&&U.attributes&&U.attributes[this.typeIdField])},getTypeById:function(U){var fa;y.some(this.types,function(sa){sa.id==U&&(fa=sa);return!!fa});return fa},getSubtypeByCode:function(U){var fa;y.some(this.subtypes,function(sa){sa.code==U&&(fa=sa);return!!fa});return fa},setEditable:function(U){if(!this._collection||this._isImageService)return this;if(!this.loaded)return this._optEditable=
U,this;var fa=this._editable;this._editable=U;this._updateCaps();if(fa!==U)this.onCapabilitiesChange();return this},getEditCapabilities:function(U){var fa={canCreate:!1,canUpdate:!1,canDelete:!1,canUpdateGeometry:!1};if(!this.loaded||!this.isEditable())return fa;var sa=U&&U.feature;U=U&&U.userId||this.getUserId();var O=y.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],z.trim),ca=(fa=-1<y.indexOf(O,"editing"))&&-1<y.indexOf(O,"create"),va=fa&&-1<y.indexOf(O,"update");O=fa&&-1<y.indexOf(O,
"delete");var H=this.ownershipBasedAccessControlForFeatures,R=this.editFieldsInfo,W=R&&R.creatorField;R=R&&R.realm;sa=(sa=sa&&sa.attributes)&&W?sa[W]:void 0;var pa=!!this.userIsAdmin;W=!H||pa||!(!H.allowOthersToUpdate&&!H.allowUpdateToOthers);var ra=!H||pa||!(!H.allowOthersToDelete&&!H.allowDeleteToOthers),Aa=!H||pa||!H.hasOwnProperty("allowAnonymousToUpdate")||H.allowAnonymousToUpdate;H=!H||pa||!H.hasOwnProperty("allowAnonymousToDelete")||H.allowAnonymousToDelete;U&&R&&(U=U+"@"+R);if(pa||fa&&!(ca||
va||O))ca=va=O=!0;fa={canCreate:ca,canUpdate:va,canDelete:O,canUpdateGeometry:pa||this.allowGeometryUpdates};U||(fa.canUpdate=fa.canUpdate&&Aa,fa.canDelete=fa.canDelete&&H);null===sa?(fa.canUpdate=fa.canUpdate&&W,fa.canDelete=fa.canDelete&&ra):""!==sa&&sa&&U.toLowerCase()!==sa.toLowerCase()&&(fa.canUpdate=fa.canUpdate&&W,fa.canDelete=fa.canDelete&&ra);return fa},getUserId:function(){var U;this.loaded&&(U=this.credential&&this.credential.userId||this.userId||"");return U},setUserIsAdmin:function(U){this.userIsAdmin=
U},setEditSummaryCallback:function(U){this.editSummaryCallback=U},getEditSummary:function(U,fa,sa){sa=w.isDefined(sa)?sa:(new Date).getTime();var O="";sa=this.getEditInfo(U,fa,sa);(fa=fa&&fa.callback||this.editSummaryCallback)&&(sa=fa(U,sa)||"");if(z.isString(sa))O=sa;else{if(sa){U=sa.action;fa=sa.userId;var ca=sa.timeValue,va=0;U&&va++;fa&&va++;w.isDefined(ca)&&va++;1<va&&(O=("edit"===U?"edit":"create")+(fa?"User":"")+(w.isDefined(ca)?sa.displayPattern:""))}O=O&&w.substitute(sa,this.i18n.layers.FeatureLayer[O])}return O},
getEditInfo:function(U,fa,sa){if(this.loaded){sa=w.isDefined(sa)?sa:(new Date).getTime();fa=fa&&fa.action||"last";var O=this.editFieldsInfo,ca=O&&O.creatorField,va=O&&O.creationDateField,H=O&&O.editorField;O=O&&O.editDateField;H=(U=U&&U.attributes)&&H?U[H]:void 0;O=U&&O?U[O]:null;ca=this._getEditData(U&&ca?U[ca]:void 0,U&&va?U[va]:null,sa);sa=this._getEditData(H,O,sa);switch(fa){case "creation":var R=ca;break;case "edit":R=sa;break;case "last":R=sa||ca}R&&(R.action=R===sa?"edit":"creation");return R}},
_getEditData:function(U,fa,sa){if(w.isDefined(fa)){var O=sa-fa;var ca=0>O?"Full":6E4>O?"Seconds":12E4>O?"Minute":36E5>O?"Minutes":72E5>O?"Hour":864E5>O?"Hours":6048E5>O?"WeekDay":"Full"}if(void 0!==U||ca){var va=va||{};va.userId=U;ca&&(U=n.format,sa=new Date(fa),va.minutes=Math.floor(O/6E4),va.hours=Math.floor(O/36E5),va.weekDay=U(sa,{datePattern:"EEEE",selector:"date"}),va.formattedDate=U(sa,{selector:"date"}),va.formattedTime=U(sa,{selector:"time"}),va.displayPattern=ca,va.timeValue=fa)}return va},
isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},isQueryable:function(){var U=y.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],z.trim);return this._isStream||this.userIsAdmin||this._collection||-1!==y.indexOf(U,"query")||-1!==y.indexOf(U,"catalog")},setResolution:function(U){return this.setMaxAllowableOffset(U)},setMaxAllowableOffset:function(U){this.isEditable()||(this._optMaxOffset=U,this._setMaxOffset(U,!0));return this},_resetMaxAllowableOffset:function(){this.setMaxAllowableOffset(this._optMaxOffset);
this._prevScale=null;this._refreshMaxAllowableOffset()},_refreshMaxAllowableOffset:function(){this._calcMaxOffsetForAutoSnapshot();this._updateMaxOffset();this._needsRefresh=!1},getResolution:function(){return this.getMaxAllowableOffset()},getMaxAllowableOffset:function(){var U=this._quantizationParameters?this._quantizationParameters.tolerance:void 0;return null!=this._maxOffset?this._maxOffset:U},_setMaxOffset:function(U,fa){if(null==U)return delete this._maxOffset,delete this._quantizationParameters,
this;this.quantize&&this.supportsCoordinatesQuantization?("esriGeometryPolyline"===this.geometryType?this._maxOffset=U:delete this._maxOffset,this._quantizationParameters=U?{mode:"view",originPosition:"upperLeft",tolerance:U,extent:this.fullExtent}:null):(this._isFractionalOffsetAllowed()&&fa||(U=Math.floor(U)),isNaN(U)||0===U?delete this._maxOffset:this._maxOffset=U,delete this._quantizationParameters);return this},_isFractionalOffsetAllowed:function(){return null==this.version||10.1<=this.version||
navigator.languages&&this._isLangWithDot(navigator.languages[0])},_isLangWithDot:function(U){U=(U=U&&U.split("-"))&&U[0]&&U[0].toLowerCase();return-1!==y.indexOf(this._langsWithDot,U)},_langsWithDot:"ar en et fr he ja ko th vi zh".split(" "),setAutoGeneralize:function(U){this.loaded?this._canAutoGeneralize()&&((this._autoGeneralize=U)?(this._isAutoSnapshotMode()&&(this._prevScale=null),this._updateMaxOffset()):this._setMaxOffset(null)):this._optAutoGen=U;return this},_canAutoGeneralize:function(){return!this.isEditable()&&
this.mode!==Ea.MODE_SNAPSHOT},setGDBVersion:function(U){this._collection||U===this.gdbVersion||!U&&!this.gdbVersion||(this.gdbVersion=U,this._task.gdbVersion=U,this._url.query=z.mixin(this._url.query,{gdbVersion:U}),this.loaded&&(this.clearSelection(),this._map&&this.refresh()),this.onGDBVersionChange());return this},hasAllFeatures:function(){return this._mode?this._mode.hasAllFeatures():!0},hasUpdateError:function(){return this._mode?this._mode.hasUpdateError():!1},setDefinitionExpression:function(U){this._defnExpr=
U;this._hasPendingLimitQuery()||((U=this._checkFeatureLimit())?this._evalModeAndApplyDefnExpr(U):this._applyDefnExpr());return this},_applyDefnExpr:function(){var U=this._mode;U&&U.propertyChangeHandler(1)},_evalModeAndApplyDefnExpr:function(U){U.then(z.hitch(this,function(fa){fa&&(fa instanceof Error||!fa.modeChanged)&&this._applyDefnExpr()}))},getDefinitionExpression:function(){return this._defnExpr},hasDefinitionExpressionWithCurrentTimestamp:function(){return this.reSQLCurrentTimestamp.test(this.getDefinitionExpression())},
setTimeDefinition:function(U){this._isSnapshotMode()&&(this._timeDefn=U,(U=this._mode)&&U.propertyChangeHandler(2));return this},getTimeDefinition:function(){return this._timeDefn},setTimeOffset:function(U,fa){this._timeOffset=U;this._timeOffsetUnits=fa;var sa=this._mode;sa&&sa.propertyChangeHandler(0);return this},setUseMapTime:function(U){this.useMapTime=U;this._toggleTime(!this.suspended);(U=this._mode)&&U.propertyChangeHandler(0)},selectFeatures:function(U,fa,sa,O){fa=fa||Ea.SELECTION_NEW;this._hasSelectionError=
this._hasPartialSelectedFeatures=!1;U=this._getShallowClone(U);var ca=this._map,va=this,H=u._fixDfd(new q(u._dfdCanceller));U.outFields=this.getOutFields();U.returnGeometry=!0;U.multipatchOption=this.multipatchOption;ca&&(U.outSpatialReference=new l(ca.spatialReference.toJson()));if(!this._applyQueryFilters(U,!0)){var R={features:[]};this._selectHandler(R,fa,sa,O,H);return H}if(ca=this._canDoClientSideQuery(U))H._pendingDfd=b(this._doQuery(U,ca)),H._pendingDfd.then(function(pa){R={features:pa};va._selectHandler(R,
fa,sa,O,H)});else{if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,O,H,!0),H;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,O,H,!0),H;var W=this;this._ts&&(U._ts=(new Date).getTime());ca=this._canFetchPBFForQuery(U);this._enableEditModeQuantization(U,ca);(H._pendingDfd=this._task.execute(U,null,null,ca?{format:"pbf"}:null)).addCallbacks(function(pa){W._selectHandler(pa,fa,
sa,O,H)},function(pa){W._hasPartialSelectedFeatures=!0;W._hasSelectionError=!0;W._resolve([pa],null,O,H,!0)})}return H},getSelectedFeatures:function(){var U=this._selectedFeatures,fa=[],sa;for(sa in U)U.hasOwnProperty(sa)&&fa.push(U[sa]);return fa},clearSelection:function(U){var fa=this._selectedFeatures,sa=this._mode,O;for(O in fa)fa.hasOwnProperty(O)&&(this._unSelectFeatureIIf(O,sa),sa._removeFeatureIIf(O));this._selectedFeatures={};this._isSelOnly&&sa._applyTimeFilter(!0);if(!U)this.onSelectionClear();
return this},setSelectionSymbol:function(U){if(this._selectionSymbol=U){var fa=this._selectedFeatures,sa;for(sa in fa)fa.hasOwnProperty(sa)&&fa[sa].setSymbol(U)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(U){U?(this.labelingInfo=U,this._fixLabelExpr()):delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this._evalSurfaceType();this.onLabelingInfoChange()},_fixLabelExpr:function(){var U=/\[([^\[\]]+)\]/ig,fa,sa=this,O=function(ca,va){var H=
sa._getField(va,!0);return"["+(H&&H.name||va)+"]"};y.forEach(this.labelingInfo,function(ca){if(fa=ca.labelExpression)ca.labelExpression=fa.replace(U,O)})},_updateRequiredFieldsFromLabelingInfo:function(){var U=[];y.forEach(this.labelingInfo,function(fa){var sa=fa.labelExpressionInfo;if(fa.labelExpression){var O=/[\[\]]/ig;fa=fa.labelExpression.match(/\[[^\[\]]+\]/ig);(fa=y.map(fa,function(va){return va.replace(O,"")}))&&(U=U.concat(fa))}if(sa){if(sa.value){var ca=/[\{\}]/ig;fa=sa.value.match(/\{[^\{\}]+\}/ig);
(fa=y.map(fa,function(va){return va.replace(ca,"")}))&&(U=U.concat(fa))}sa.expression&&(fa=y.map(this.fields,function(va){return va.name},this),U=U.concat(ba.extractFieldNames(sa.expression,fa)))}},this);U=y.map(U,function(fa){var sa=this.getField(fa);return sa?sa.name:fa},this);this._requiredFields&&(this._requiredFields=this._requiredFields.concat(U))},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(U,fa,sa,O,ca,va){var H=va.assembly,R=va.dfd;this._applyNormalized(U,
H&&H[0]);this._applyNormalized(fa,H&&H[1]);this.onBeforeApplyEdits(U,fa,sa);var W={},pa=this.objectIdField;H={f:"json"};var ra=!1;if(this._collection)va={},va.addResults=U?y.map(U,function(){ra=!0;return{objectId:this._nextId++,success:!0}},this):null,va.updateResults=fa?y.map(fa,function(Ja){ra=!0;var Ka=Ja.attributes[pa];W[Ka]=Ja;return{objectId:Ka,success:!0}},this):null,va.deleteResults=sa?y.map(sa,function(Ja){ra=!0;return{objectId:Ja.attributes[pa],success:!0}},this):null,ra?this._editHandler(va,
U,W,O,ca,R):this._resolve([va.addResults,va.updateResults,va.deleteResults],null,O,R);else{U&&0<U.length&&(H.adds=this._convertFeaturesToJson(U,0,1),ra=!0);if(fa&&0<fa.length){for(va=0;va<fa.length;va++){var Aa=fa[va];W[Aa.attributes[pa]]=Aa}H.updates=this._convertFeaturesToJson(fa,0,0,1);ra=!0}if(sa&&0<sa.length){fa=[];for(va=0;va<sa.length;va++)fa.push(sa[va].attributes[pa]);H.deletes=fa.join(",");ra=!0}if(ra){var Ba=this;return t({url:this._url.path+"/applyEdits",content:z.mixin(H,this._url.query),
callbackParamName:"callback",load:function(Ja){Ba._editHandler(Ja,U,W,O,ca,R)},error:function(Ja){Ba._resolve([Ja],null,ca,R,!0)}},{usePost:!0})}this._resolve([],null,O,R)}},queryFeatures:function(U,fa,sa,O){return this._query("execute","onQueryFeaturesComplete",U,fa,sa,O)},queryRelatedFeatures:function(U,fa,sa){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",U,fa,sa)},queryIds:function(U,fa,sa,O){return this._query("executeForIds","onQueryIdsComplete",U,fa,sa,O)},queryCount:function(U,
fa,sa,O){return this._query("executeForCount","onQueryCountComplete",U,fa,sa,O)},queryExtent:function(U,fa,sa,O){return this._query("executeForExtent","onQueryExtentComplete",U,fa,sa,O)},queryAttachmentInfos:function(U,fa,sa){var O=this._url.path+"/"+U+"/attachments",ca=new q(u._dfdCanceller),va=this;O=v.normalize(O);ca._pendingDfd=t({url:O,content:z.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(H){H=H.attachmentInfos;var R;y.forEach(H,function(W){R=f.objectToQuery({gdbVersion:va._url.query&&
va._url.query.gdbVersion,layer:va._url.query&&va._url.query.layer,token:va._getToken()});W.url=O+"/"+W.id+(R?"?"+R:"");W.objectId=U});va._resolve([H],"onQueryAttachmentInfosComplete",fa,ca)},error:function(H){va._resolve([H],null,sa,ca,!0)}});return ca},addAttachment:function(U,fa,sa,O){return this._sendAttachment("add",U,fa,sa,O)},updateAttachment:function(U,fa,sa,O,ca){sa.appendChild(d.create("input",{type:"hidden",name:"attachmentId",value:fa}));return this._sendAttachment("update",U,sa,O,ca)},
deleteAttachments:function(U,fa,sa,O){var ca=this._url.path+"/"+U+"/deleteAttachments",va=new q(u._dfdCanceller),H=this;fa={f:"json",attachmentIds:fa.join(",")};va._pendingDfd=t({url:ca,content:z.mixin(fa,this._url.query),callbackParamName:"callback",load:z.hitch(this,function(R){R=R.deleteAttachmentResults;R=y.map(R,function(W){W=new Ha(W);W.attachmentId=W.objectId;W.objectId=U;return W});H._resolve([R],"onDeleteAttachmentsComplete",sa,va)}),error:function(R){H._resolve([R],null,O,va,!0)}},{usePost:!0});
return va},addType:function(U){var fa=this.types;if(fa){if(y.some(fa,function(sa){return sa.id==U.id?!0:!1}))return!1;fa.push(U)}else this.types=[U];return this._typesDirty=!0},deleteType:function(U){if(this._collection){var fa=this.types;if(fa){var sa=-1;y.some(fa,function(O,ca){return O.id==U?(sa=ca,!0):!1});if(-1<sa)return this._typesDirty=!0,fa.splice(sa,1)[0]}}},toJson:function(){var U=this._cloneJson();if(U){U=U.layerDefinition?U:{layerDefinition:U};var fa=U.layerDefinition,sa=this._collection;
this._updateLayerDefinition(fa);var O=null;if(!sa||this._fcAdded)O={geometryType:fa.geometryType,features:this._convertFeaturesToJson(this.graphics,!0)};U.featureSet=z.mixin({},U.featureSet||{},O);if(U.featureSet.transform){var ca=U.featureSet.transform;delete U.featureSet.transform;O=new N(U.featureSet);O.quantize(ca);U.featureSet=O.toJson()}sa&&(U.nextObjectId=this._nextId,fa.capabilities=this.capabilities);return U}},getLayerDefinition:function(){var U=this._cloneJson();(U=U?U.layerDefinition||
U:null)&&this._updateLayerDefinition(U);return U},getFeatureCollectionLayer:function(U){var fa=new q,sa=this.getLayerDefinition();if(!sa)return fa.reject(Error("layerDefinition not available")),fa.promise;U=U||[];var O=new Ea({layerDefinition:sa,featureSet:{geometryType:sa.geometryType,features:y.map(U,function(H){return H.toJson()})}}),ca=O.on("load",function(){ca.remove();va.remove();fa.resolve(O)}),va=O.on("error",function(){O.loaded||(ca.remove(),va.remove(),fa.reject(O.loadError))});return fa.promise},
onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryExtentComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},
onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},onLabelingInfoChange:function(){},onFeatureReductionRendererChange:function(){},onFeatureReductionChange:function(){},onFeatureUpdatesResult:function(){},_cloneJson:function(){var U=this._json;return z.isString(U)?r.fromJson(U):z.clone(U)},_updateLayerDefinition:function(U){if(this._collection&&this._typesDirty){U.types=y.map(this.types||[],function(ca){return ca.toJson()});var fa=this.renderer,sa=this.labelingInfo,O=U.drawingInfo;
!fa&&!sa||O||(O=U.drawingInfo={});O&&fa&&-1===fa.declaredClass.indexOf("TemporalRenderer")&&(O.renderer=fa.toJson());sa&&(O.labelingInfo=y.map(sa,function(ca){return ca.toJson()}))}},_evalFeatureUpdates:function(){if(!this._featureUpdatesPromise||this._featureUpdatesPromise.isFulfilled())this._featureUpdatesPromise=this.hasFeatureUpdates().otherwise(function(U){return!(U&&"cancel"===U.dojoType)}).always(z.hitch(this,function(U){this._featureUpdatesPromise=null;this.onFeatureUpdatesResult({hasUpdates:U})}))},
_evalRefresh:function(U){(U.hasUpdates||this.hasDefinitionExpressionWithCurrentTimestamp())&&this.refresh()},_evalArcadeSupport:function(){var U=new q;setTimeout(z.hitch(this,function(){this._initializeArcadeEngine().always(function(){U.resolve()})}),0);return U.promise},_initializeArcadeEngine:function(){var U=[],fa=this.infoTemplate;fa&&fa.initializeArcadeEngine&&U.push(fa.initializeArcadeEngine());(fa=this.renderer)&&fa.initializeArcadeEngine&&U.push(fa.initializeArcadeEngine());var sa=[];y.forEach(this.labelingInfo,
function(O){(O=O.labelExpressionInfo)&&O.expression&&sa.push(O.expression)});U.push(T.initialize(sa));return x(U)},_isGeometryOperationsUsed:function(){var U=this.infoTemplate,fa=this.renderer,sa=this.labelingInfo;return U&&U.hasGeometryOperations&&U.hasGeometryOperations()||fa&&fa.hasGeometryOperations&&fa.hasGeometryOperations()||y.some(sa,function(O){return ba.hasGeometryOperations(O.labelExpressionInfo&&O.labelExpressionInfo.expression)})?!0:!1},_forceIdentity:function(){var U=new q,fa=this,sa=
this._url&&this._url.path;var O=sa&&sa.toLowerCase().indexOf("/rest/services");var ca=this.editFieldsInfo;ca=ca&&(ca.creatorField||ca.editorField);(this.userIsAdmin||ca)&&!this._getToken()&&-1<O&&k.id?(O=sa.substring(0,O)+"/rest/info",t({url:O,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(va){if(va.owningSystemUrl)return k.id.checkSignInStatus(va.owningSystemUrl+"/sharing")}).then(function(va){if(va)return k.id.getCredential(sa)}).then(function(va){va&&fa._findCredential()}).always(function(){U.resolve()})):
U.resolve();return U.promise},_isSnapshotMode:function(){return this._mode?this._mode.isInstanceOf(ea):!1},_isOnDemandMode:function(){return this._mode?this._mode.isInstanceOf(za):!1},_isAutoSnapshotMode:function(){return this._isAutoModeEnabled()&&this.currentMode===Ea.MODE_SNAPSHOT},_getMaxFeaturesForAutoSnapshotMode:function(){var U=this.geometryType;if("esriGeometryPolyline"===U||"esriGeometryPolygon"===U||"esriGeometryMultipoint"===U||this.hasXYFootprint())var fa=this.maxRecordCountForAuto;else"esriGeometryPoint"===
U&&(fa=this.maxPointCountForAuto);return fa},getLastExceedsLimitResult:function(){return this._lastExceedsLimitResult},_canUseSnapshotMode:function(U){this._lastExceedsLimitResult=U=(U=U&&U.features&&U.features[0])&&U.attributes&&U.attributes.exceedslimit;return!(this.mode!==Ea.MODE_AUTO||this.isEditable()||0!==U||!(this._isPaginationAllowed()||this.maxRecordCount>=this._getMaxFeaturesForAutoSnapshotMode()))},_evalModeFromFLimit:function(U){this._canUseSnapshotMode(U)?this._enableAutoSnapshotMode():
this._enableAutoOnDemandMode()},_enableAutoSnapshotMode:function(){var U=Ea.MODE_SNAPSHOT;this.isFeatureReductionApplied()?this._updatePreFReductionState(U):this._preSurfaceChangeState?(this._updatePreSurfaceChangeState(U),this._evalSurfaceType(!0)):this.currentMode!==U&&this._setFetchMode(Ea.MODE_AUTO,U)},_enableAutoOnDemandMode:function(){var U=Ea.MODE_ONDEMAND;this.isFeatureReductionApplied()?this._updatePreFReductionState(U):this._preSurfaceChangeState?this._updatePreSurfaceChangeState(U):this.currentMode!==
U&&(this._setFetchMode(Ea.MODE_AUTO,U),this._evalSurfaceType())},_evalModeFromFReduction:function(U){this.loaded&&(U&&this.isFeatureReductionEnabled()&&this._canCluster(U)?this._enableFReductionMode():this._disableFReductionMode())},_enableFReductionMode:function(){this._evalSurfaceType(!0);if(!this._preFReductionState){var U=this.currentMode;U!==Ea.MODE_SNAPSHOT&&U!==Ea.MODE_STREAM&&U!==Ea.MODE_SELECTION&&(this._preFReductionState={mode:this.mode,currentMode:this.currentMode},this._setFetchMode(this.mode===
Ea.MODE_AUTO?Ea.MODE_AUTO:Ea.MODE_SNAPSHOT,Ea.MODE_SNAPSHOT))}},_disableFReductionMode:function(){var U=this._preFReductionState;this._preFReductionState=null;!U||U.mode===this.mode&&U.currentMode===this.currentMode||(this._setFetchMode(U.mode,U.currentMode),this._evalSurfaceType())},_updatePreFReductionState:function(U){this._preFReductionState=this._preFReductionState||{};this._preFReductionState.mode=Ea.MODE_AUTO;this._preFReductionState.currentMode=U},_evalModeFromSurface:function(){this.hasWebGLSurface()?
this._enableWebGLSurfaceMode():this._disableWebGLSurfaceMode()},_enableWebGLSurfaceMode:function(){this._preSurfaceChangeState||(this._preSurfaceChangeState={mode:this.mode,currentMode:this.currentMode},this._setFetchMode(this.mode===Ea.MODE_AUTO?Ea.MODE_AUTO:Ea.MODE_ONDEMAND,Ea.MODE_ONDEMAND,this.webglDeps.OnDemandDrillMode))},_disableWebGLSurfaceMode:function(){var U=this._preSurfaceChangeState;U&&(this._preSurfaceChangeState=null,this._setFetchMode(U.mode,U.currentMode))},_updatePreSurfaceChangeState:function(U){this._preSurfaceChangeState=
this._preSurfaceChangeState||{};this._preSurfaceChangeState.mode=Ea.MODE_AUTO;this._preSurfaceChangeState.currentMode=U},_setFetchMode:function(U,fa,sa){this.clearSelection();this._mode.suspend();this._mode.destroy();this.mode=U;this.currentMode=fa;sa=sa||this._getModeConstructor(fa);this._mode=new sa(this);this.queryPagination=fa===Ea.MODE_ONDEMAND&&-1===sa.prototype.declaredClass.toLowerCase().indexOf("ondemanddrillmode")?!1:this._isPaginationAllowed();(U=this.getMap())&&U.loaded&&(this._resetMaxAllowableOffset(),
this._mode.initialize(U),this._mode.startup())},_isPaginationAllowed:function(){return!(!this._optQueryPagination||this.loaded&&!this.advancedQueryCapabilities.supportsPagination)},_getModeConstructor:function(U){var fa;U===Ea.MODE_SNAPSHOT?fa=ea:U===Ea.MODE_ONDEMAND&&(fa=za);return fa},_hasOnDemandDrillMode:function(){var U=this._mode;U=U&&U.declaredClass;return!!(U&&-1<U.toLowerCase().indexOf("ondemanddrillmode"))},_checkFeatureLimit:function(){this._limitPromise&&(this._limitPromise.cancel(),this._limitPromise=
null);var U=this._queryLimit();U&&(this._lastExceedsLimitResult=null,this._limitPromise=U.then(z.hitch(this,function(fa){var sa=this.currentMode;this._evalModeFromFLimit(fa);return{modeChanged:this.currentMode!==sa}})).always(z.hitch(this,function(fa){this._limitPromise=null;return fa})));return this._limitPromise},_hasPendingLimitQuery:function(){return!!this._exceedsLimitTimer},_queryLimit:function(){if(this._isAutoModeEnabled()){var U,fa,sa=new q(function(){clearTimeout(U);U=null;fa&&!fa.isFulfilled()&&
fa.cancel();fa=null});this._exceedsLimitTimer=U=setTimeout(z.hitch(this,function(){this._exceedsLimitTimer=null;var O=new J,ca=new Z;ca.statisticType="exceedslimit";ca.maxPointCount=this.maxPointCountForAuto;ca.maxRecordCount=this.maxRecordCountForAuto;ca.maxVertexCount=this.maxVertexCountForAuto;ca.outStatisticFieldName="exceedslimit";O.outStatistics=[ca];fa=this.queryFeatures(O).promise.then(function(va){sa.resolve(va)}).otherwise(function(va){sa.reject(va)})}),0);return sa.promise}},_isAutoModeEnabled:function(){return this.mode===
Ea.MODE_AUTO&&this.reHostedFS.test(this.url)},_updateCaps:function(){var U=this._editable,fa=z.trim(this.capabilities||""),sa=y.map(fa?fa.split(","):[],z.trim),O=y.map(fa?fa.toLowerCase().split(","):[],z.trim);fa=y.indexOf(O,"editing");var ca;O={Create:y.indexOf(O,"create"),Update:y.indexOf(O,"update"),Delete:y.indexOf(O,"delete")};if(U&&-1===fa)sa.push("Editing");else if(!U&&-1<fa){U=[fa];for(ca in O)-1<O[ca]&&U.push(O[ca]);U.sort();for(ca=U.length-1;0<=ca;ca--)sa.splice(U[ca],1)}this.capabilities=
sa.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(U){this._toggleTime(!1);this._refreshHandle&&(this._refreshHandle.remove(),this._refreshHandle=null);var fa=this._mode;fa&&(fa.suspend(),U&&fa.destroy())},onResume:function(U){this.inherited(arguments);this._toggleTime(!0);this._refreshHandle=this.on("feature-updates-result",z.hitch(this,this._evalRefresh));var fa=this._map,
sa=this._getRenderer();if(U.firstOccurrence){if(this._fixRendererFields(),this._updateRequiredFieldsFromLabelingInfo(),this._checkFields(),this.clearSelection(),this._evalFeatureReduction(),this.timeInfo&&!this._trackManager&&(this._trackIdField||sa&&(sa.latestObservationRenderer||sa.trackRenderer))&&(this._trackManager=new ta(this),this._trackManager.initialize(fa),this._childLayer=this._trackManager.container),sa&&"colors"in sa&&"blurRadius"in sa&&"maxPixelIntensity"in sa&&"esriGeometryPoint"==
this.geometryType&&!this._heatmapManager&&(this._heatmapManager=new M(this),this._heatmapManager.initialize(fa)),this._zoomConnect=D.connect(fa,"onZoomEnd",this,this._zoomEndHandler),this._refreshMaxAllowableOffset(),sa=this._mode)sa._init||sa.initialize(fa),sa.startup()}else this._zoomEndHandler(),this._mode&&this._mode.resume()},_zoomEndHandler:function(){var U=this._map;this._updateMaxOffset();this._prevScale=U.getScale();!this.suspended&&this._needsRefresh&&this.refresh()},_updateMaxOffset:function(){var U=
this._map;U&&U.loaded&&this._autoGeneralize&&(this._isAutoSnapshotMode()?(U=this.getMaxAllowableOffset(),this._setMaxOffset(this._getMaxOffsetForScale(),!0),this._needsRefresh||(this._needsRefresh=U!=this.getMaxAllowableOffset())):this._setMaxOffset(U.extent.getWidth()/U.width,!U.extent.spatialReference.isWebMercator()))},_getMaxOffsetForScale:function(){if(this._map){var U=this._map.getScale(),fa=this._calculatedScale,sa=this._calcMaxOffset,O=this._prevScale;return U>=fa&&(null==O||O<fa)?sa:U<fa&&
(null==O||O>=fa)?null:this.getMaxAllowableOffset()}},_calcMaxOffsetForAutoSnapshot:function(){var U=this._map;if(U&&this._canAutoGeneralize()&&this._isAutoSnapshotMode()&&this._autoGeneralize&&null==this.getMaxAllowableOffset()){var fa=this.generalizeForScale;this._calculatedScale=fa=this.maxScale?this.maxScale:this.minScale?Math.min(fa,this.minScale):Math.min(fa,na.getScale(U,this.initialExtent));this._calcMaxOffset=U.extent.getWidth()/U.width/U.getScale()*fa}else this._calculatedScale=this._calcMaxOffset=
void 0},_toggleTime:function(U){var fa=this._map;U&&this.timeInfo&&this.useMapTime&&fa?(this._mapTimeExtent=fa.timeExtent,this._timeConnect||(this._timeConnect=D.connect(fa,"onTimeExtentChange",this,this._timeChangeHandler))):(this._mapTimeExtent=null,D.disconnect(this._timeConnect),this._timeConnect=null)},_timeChangeHandler:function(U){this._mapTimeExtent=U;(U=this._mode)&&U.propertyChangeHandler(0)},_getOffsettedTE:function(U){var fa=this._timeOffset,sa=this._timeOffsetUnits;return U&&fa&&sa?U.offset(-1*
fa,sa):U},_getTimeOverlap:function(U,fa){return U&&fa?U.intersection(fa):U||fa},_getTimeFilter:function(U){var fa=this.getTimeDefinition();if(fa){var sa=this._getTimeOverlap(fa,null);if(!sa)return[!1]}if(U){if(U=sa?this._getTimeOverlap(U,sa):U,!U)return[!1]}else U=sa;return[!0,U]},_getAttributeFilter:function(U){var fa=[],sa=this.getDefinitionExpression();sa&&fa.push(sa);U&&fa.push(U);this.subtypeField&&this.subtypeCode&&fa.push(this.subtypeField+" \x3d "+this.subtypeCode);1<fa.length&&(fa=y.map(fa,
function(O){return"("+O+")"}));return fa.length?fa.join(" AND "):null},_applyQueryFilters:function(U,fa){U.where=this._getAttributeFilter(U.where);U.returnGeometry&&null==U.maxAllowableOffset&&!U.quantizationParameters&&(U.maxAllowableOffset=this._maxOffset,U.quantizationParameters=this._quantizationParameters);fa&&this.supportsAdvancedQueries&&(U.orderByFields=U.orderByFields||this.getOrderByFields());if(this.timeInfo){var sa=this._getTimeFilter(U.timeExtent);if(sa[0])U.timeExtent=sa[1];else return!1}return!0},
_add:function(U){var fa=this._selectionSymbol,sa=U.attributes,O=this.visibilityField;fa&&this._isSelOnly&&U.setSymbol(fa);if(O&&sa&&sa.hasOwnProperty(O))U[sa[O]?"show":"hide"]();return this.add.apply(this,arguments)},_remove:function(){return this.remove.apply(this,arguments)},_canDoClientSideQuery:function(U,fa){var sa=[],O=this._map,ca;if((this._collection||!this._isTable&&O)&&!(U.text||U.where&&U.where!==this.getDefinitionExpression()||U.orderByFields&&U.orderByFields.length&&(ca=this.getOrderByFields()||
[])&&U.orderByFields.join()!==ca.join()||U.outStatistics||U.returnDistinctValues)){ca=this._isSnapshotMode();var va=this._isSelOnly;O=ca?null:fa?this._getExtentOfTiles(O.extent):O.extent;var H=U.geometry;if(H){if(va||U.spatialRelationship!==J.SPATIAL_REL_INTERSECTS||"extent"!==H.type||!ca&&!O.contains(H))return;sa.push(1)}if(O=U.objectIds)if(ca)sa.push(2);else{H=O.length;var R=this._mode,W=0,pa;for(pa=0;pa<H;pa++)R._getFeature(O[pa])&&W++;if(W===H)sa.push(2);else return}if(this.timeInfo)if(O=U.timeExtent,
H=this._mapTimeExtent,ca)O&&sa.push(3);else if(va){if(O)return}else if(H)if(-1!==y.indexOf(sa,2))O&&sa.push(3);else if(-1!==y.indexOf(sa,1))O==H&&sa.push(3);else return;else if(0<sa.length)O&&sa.push(3);else if(O)return;return 0<sa.length?sa:null}},_getAbsMid:function(U){return F.toAbsMid?F.toAbsMid(U):m.id.replace(/\/[^\/]*$/ig,"/")+U},_doQuery:function(U,fa,sa){var O=[],ca=this.objectIdField,va=this,H=new q,R=new q,W=this.graphics;if(-1!==y.indexOf(fa,1)){var pa=this.spatialIndex||this._map&&this._map.spatialIndex,
ra,Aa=U.geometry._normalize(null,!0);null==pa&&aa.autoSpatialIndexing?ra=(this._map||this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(z.hitch(this,z.partial(this._getFromIndex,Aa,pa)),function(Ba){R.resolve(z.hitch(this,z.partial(this._filterByExtent,W,Aa)))}):pa&&(ra=this._getFromIndex(Aa,pa));ra?ra.then(function(Ba){for(var Ja=0;Ja<Ba.length;Ja++)Ba[Ja].results&&(O=O.concat(Ba[Ja].results));R.resolve(O)}).otherwise(function(Ba){R.reject(Ba)}):R.resolve(this._filterByExtent(W,Aa))}else R.resolve(W);
R.then(function(Ba){O=Ba;if(-1!==y.indexOf(fa,2)){var Ja=U.objectIds;O=y.filter(O,function(Ka){return-1<y.indexOf(Ja,Ka.attributes[ca])})}-1!==y.indexOf(fa,3)&&va.timeInfo&&(Ba=U.timeExtent,O=va._filterByTime(O,Ba.startTime,Ba.endTime).match);sa&&(O=y.map(O,function(Ka){return Ka.attributes[ca]},this));H.resolve(O)});return H},_getFromIndex:function(U,fa){fa=fa||this.spatialIndex||this._map.spatialIndex;U instanceof Array||(U=[U]);var sa=this.id;return h(y.map(U,function(O){return fa.intersects(O,
sa)}))},_filterByExtent:function(U,fa){for(var sa=[],O=0,ca=U.length;O<ca;O++){var va=U[O],H=va.geometry;H&&(this.normalization&&fa.length?(fa[0].intersects(H)||fa[1].intersects(H))&&sa.push(va):fa.intersects(H)&&sa.push(va))}return sa},_filterByTime:function(U,fa,sa){var O=this._startTimeField,ca=this._endTimeField,va;this._twoTimeFields||(va=O||ca);var H=w.isDefined,R=[],W=[],pa,ra=U.length;fa=fa?fa.getTime():-Infinity;sa=sa?sa.getTime():Infinity;if(va)for(pa=0;pa<ra;pa++){var Aa=U[pa];var Ba=Aa.attributes;
O=Ba[va];O>=fa&&O<=sa?R.push(Aa):W.push(Aa)}else for(pa=0;pa<ra;pa++)Aa=U[pa],Ba=Aa.attributes,va=Ba[O],Ba=Ba[ca],va=H(va)?va:-Infinity,Ba=H(Ba)?Ba:Infinity,va>=fa&&va<=sa||Ba>=fa&&Ba<=sa||fa>=va&&sa<=Ba?R.push(Aa):W.push(Aa);return{match:R,noMatch:W}},_getSizeVariables:function(U){return U&&y.filter(U.getVisualVariablesForType("sizeInfo",!1),function(fa){return!(!fa.field&&!fa.valueExpression)})},_needClientSideSorting:function(U){return this._collection?!(!U||!U.length):y.some(U,function(fa){return!!fa.valueExpression})},
_sortFeatures:function(U){var fa=this.renderer,sa=this._getSizeVariables(fa);if(U&&1<U.length&&this._needClientSideSorting(sa)){var O=sa[0],ca=this;U.sort(function(va,H){va._layer||(va._layer=ca);H._layer||(H._layer=ca);var R=fa._getDataValue(va,O,"sizeInfo"),W=fa._getDataValue(H,O,"sizeInfo");return null==R?-1:null==W?1:W-R})}return U},_resolve:function(U,fa,sa,O,ca){fa&&this[fa].apply(this,U);sa&&sa.apply(null,U);O&&u._resDfd(O,U,ca)},_getShallowClone:function(U){var fa=new J,sa;for(sa in U)U.hasOwnProperty(sa)&&
(fa[sa]=U[sa]);return fa},_canFetchPBF:function(){return!!(Ya&&Wa&&this.supportsFormatPBF)},_canFetchPBFForQuery:function(U){return!(!this._canFetchPBF()||!this._isCacheHintEnabled(U)&&this._isAutoSnapshotMode()||!(U.quantizationParameters||!this.isEditable()&&this.supportsQuantizationEditMode)||U.outStatistics)},_enableEditModeQuantization:function(U,fa){U&&fa&&!U.quantizationParameters&&(U.quantizationParameters={mode:"edit"})},_enableCacheHint:function(U,fa){var sa=this.advancedQueryCapabilities;
sa&&sa.supportsQueryWithCacheHint?null==U.cacheHint&&(U.cacheHint=!0):sa&&sa.supportsQueryWithResultType&&this.reHostedFS.test(this.url)&&!U.resultType&&(U.resultType=fa||"coherent")},_isCacheHintSupported:function(){var U=this.advancedQueryCapabilities;return U?!!(U.supportsQueryWithCacheHint||U.supportsQueryWithResultType&&this.reHostedFS.test(this.url)):!1},_isCacheHintEnabled:function(U){var fa=this.advancedQueryCapabilities;return U&&fa?!!(fa.supportsQueryWithCacheHint&&U.cacheHint||fa.supportsQueryWithResultType&&
this.reHostedFS.test(this.url)&&("coherent"===U.resultType||"tile"===U.resultType)):!1},_query:function(U,fa,sa,O,ca,va){var H=this,R=this._map;va=va&&va.snapToTiles;var W=new q(u._dfdCanceller),pa=sa,ra,Aa,Ba;if("executeRelationshipQuery"!==U){pa=this._getShallowClone(sa);var Ja=this.getOutFields();pa.outFields||(pa.outFields=Ja);pa.outFields&&pa.outFields.length&&(Aa=-1<y.indexOf(Ja,"*")?!1:!y.every(pa.outFields,function(Ra){return-1<y.indexOf(Ja,Ra)}));pa.returnGeometry=sa.hasOwnProperty("returnGeometry")?
sa.returnGeometry:!sa.outStatistics;pa.returnGeometry&&(pa.multipatchOption=this.multipatchOption,null!=pa.maxAllowableOffset||pa.quantizationParameters)&&(sa=null!=pa.maxAllowableOffset?pa.maxAllowableOffset:pa.quantizationParameters.tolerance,null!=sa&&sa!==this.getMaxAllowableOffset()&&(Ba=!0));R&&(R=R&&R.spatialReference,(sa=pa.outSpatialReference)?ra=!sa.equals(R):pa.outSpatialReference=new l(R.toJson()));va&&(R=pa.geometry)&&"extent"===R.type&&(pa.geometry=this._getExtentOfTiles(R),R!==pa.geometry&&
this._enableCacheHint(pa));if(!this._applyQueryFilters(pa,"execute"===U&&!pa.outStatistics)){switch(U){case "execute":var Ka=new N({features:[]});break;case "executeForIds":Ka=[];break;case "executeForCount":Ka=0;break;case "executeForExtent":Ka={}}this._resolve([Ka],fa,O,W);return W}if(va="executeForExtent"!==U&&!ra&&!Aa&&!Ba&&this._canDoClientSideQuery(pa,va))return W._pendingDfd=b(this._doQuery(pa,va,"executeForIds"===U||"executeForCount"===U)),W._pendingDfd.then(function(Ra){switch(U){case "execute":Ka=
new N;Ka.features=Ra;break;case "executeForIds":Ka=Ra;break;case "executeForCount":Ka=Ra.length}H._resolve([Ka],fa,O,W)}),W}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+this.invalidParams)],null,ca,W,!0),W;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,ca,W,!0),W;this._ts&&(pa._ts=(new Date).getTime());va="execute"===U&&this._canFetchPBFForQuery(pa);this._enableEditModeQuantization(pa,va);(W._pendingDfd=
this._task[U](pa,null,null,va?{format:"pbf"}:null)).addCallbacks(function(Ra){var Va=!!pa.outStatistics||ra||Aa||Ba;if("execute"===U||"executeRelationshipQuery"===U)if("execute"===U){var ab=Ra.features;var db=ab.length;for(--db;0<=db;db--)if(ab[db]._layer=H,!Va&&!H._isTable){var jb=H._mode._getFeature(ab[db].attributes[H.objectIdField]);jb&&ab.splice(db,1,jb)}}else for(jb in Ra)if(Ra.hasOwnProperty(jb))for(ab=Ra[jb].features,db=ab.length,--db;0<=db;db--)ab[db]._layer=H;H._resolve([Ra],fa,O,W)},function(Ra){H._resolve([Ra],
null,ca,W,!0)});return W},_getExtentOfTiles:function(U){var fa=this._isOnDemandMode()&&this._mode._gridLayer||ka.createFromFeatureLayer({layer:this}),sa=this.getMap();sa=sa&&sa.getTargetExtent(U);return fa&&sa&&fa.getExtentOfIntersectingCells(sa)||U},_convertFeaturesToJson:function(U,fa,sa,O){var ca=[],va=this._selectionSymbol,H=this.visibilityField,R,W=this.objectIdField;this.loaded&&(sa||O)&&(R=y.filter(this.fields,function(Ka){return!1===Ka.editable&&(!O||Ka.name!==W)}));for(sa=0;sa<U.length;sa++){var pa=
U[sa],ra={},Aa=pa.geometry,Ba=pa.attributes,Ja=pa.symbol;!Aa||O&&this.loaded&&!this.allowGeometryUpdates||(ra.geometry=Aa.toJson());H?(ra.attributes=Ba=z.mixin({},Ba),Ba[H]=pa.visible?1:0):Ba&&(ra.attributes=z.mixin({},Ba));ra.attributes&&R&&R.length&&y.forEach(R,function(Ka){delete ra.attributes[Ka.name]});Ja&&Ja!==va&&(ra.symbol=Ja.toJson());ca.push(ra)}return fa?ca:r.toJson(ca)},_selectHandler:function(U,fa,sa,O,ca){switch(fa){case Ea.SELECTION_NEW:this.clearSelection(!0);var va=!0;break;case Ea.SELECTION_ADD:va=
!0;break;case Ea.SELECTION_SUBTRACT:va=!1}O=U.features;var H=this._mode,R=[],W=this.objectIdField;if(va)for(va=0;va<O.length;va++){var pa=O[va];var ra=pa.attributes[W];pa=H._addFeatureIIf(ra,pa);R.push(pa);this._selectFeatureIIf(ra,pa,H)}else for(va=0;va<O.length;va++)pa=O[va],ra=pa.attributes[W],this._unSelectFeatureIIf(ra,H),ra=H._removeFeatureIIf(ra),R.push(ra||pa);this._isSelOnly&&H._applyTimeFilter(!0);this._isImageService&&10.7>this.version&&void 0===U.exceededTransferLimit&&(U.exceededTransferLimit=
O.length===this.maxRecordCount);this._hasPartialSelectedFeatures=!!U.exceededTransferLimit;this._resolve([R,fa,U.exceededTransferLimit?{queryLimitExceeded:!0}:null],"onSelectionComplete",sa,ca);if(U.exceededTransferLimit)this.onQueryLimitExceeded()},_selectFeatureIIf:function(U,fa,sa){var O=this._selectedFeatures,ca=O[U];ca||(sa._incRefCount(U),O[U]=fa,this._isTable||(this._setSelectSymbol(fa),fa.attr("data-selected","")));return ca||fa},_unSelectFeatureIIf:function(U,fa){var sa=this._selectedFeatures[U];
sa&&(fa._decRefCount(U),delete this._selectedFeatures[U],this._isTable||(this._setUnSelectSymbol(sa),sa.attr("data-selected")));return sa},_setSelectSymbol:function(U){var fa=this._selectionSymbol;fa&&!this._isSelOnly&&U.setSymbol(fa)},_setUnSelectSymbol:function(U){var fa=this._selectionSymbol;fa&&!this._isSelOnly&&fa===U.symbol&&U.setSymbol(null,!0)},_getOutFields:function(){var U=[this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._requiredFields).concat(this.dataAttributes);
U=y.filter(U,function(sa,O,ca){return!!sa&&y.indexOf(ca,sa)===O});var fa=z.clone(this._outFields);if(fa){if(-1!==y.indexOf(fa,"*"))return fa;y.forEach(U,function(sa){-1===y.indexOf(fa,sa)&&fa.push(sa)});return fa}return U},_checkFields:function(U){var fa=U||this._getOutFields();y.forEach(fa,function(sa){"*"!==sa&&this._getField(sa)},this);U||this._isTable||this._fserver||this._collection||this._isStream||y.some(this.fields,function(sa){return sa&&"esriFieldTypeGeometry"===sa.type?!0:!1})},_fixFieldCase:function(U,
fa,sa){var O=U&&U[fa],ca;if(O&&!z.isFunction(O)){if(ca=!this._getField(O)&&this._getField(O,!0))O=U[fa]=ca.name;sa&&sa.push(O)}return O},_fixRendererFields:function(){var U=this.renderer;this._orderBy=null;this._requiredFields=[];if(U&&0<this.fields.length){var fa=[],sa;U=y.filter([U,U.observationRenderer,U.latestObservationRenderer,U.trackRenderer],w.isDefined);var O=[].concat(U);y.forEach(U,function(ca){y.forEach(ca.rendererInfos,function(va){va.renderer&&O.push(va.renderer)})});y.forEach(O,function(ca){this._fixFieldCase(ca,
"attributeField",fa);this._fixFieldCase(ca,"attributeField2",fa);this._fixFieldCase(ca,"attributeField3",fa);this._fixFieldCase(ca.rotationInfo,"field",fa);(sa=this._fixFieldCase(ca.sizeInfo,"field",fa))&&!this._orderBy&&(this._orderBy=[sa+" DESC"]);this._fixFieldCase(ca.sizeInfo,"normalizationField",fa);this._fixFieldCase(ca.colorInfo,"field",fa);this._fixFieldCase(ca.colorInfo,"normalizationField",fa);this._fixFieldCase(ca.field,"field",fa);this._fixFieldCase(ca.opacityInfo,"field",fa);this._fixFieldCase(ca.opacityInfo,
"normalizationField",fa);y.forEach(ca.visualVariables,function(H){sa=this._fixFieldCase(H,"field",fa);"sizeInfo"===H.type&&sa&&!this._orderBy&&(this._orderBy=[sa+" DESC"]);this._fixFieldCase(H,"normalizationField",fa)},this);var va=y.map(this.fields,function(H){return H.name},this);va=y.map(ca.getFieldsUsedInExpressions(va),function(H){var R=this.getField(H);return R?R.name:H},this);fa=fa.concat(va);this._orderBy||!ca.addBreak||z.isFunction(ca.attributeField)||!ca.backgroundFillSymbol&&!this._hasSizeDiff(ca)||
(this._orderBy=[ca.attributeField+" DESC"])},this);this._requiredFields=y.filter(fa,w.isDefined)}},_hasSizeDiff:function(U){var fa=Number.MAX_VALUE,sa=-Number.MAX_VALUE,O,ca;y.forEach(U.infos,function(va){if(ca=va.symbol){O=0;switch(ca.type){case "simplemarkersymbol":O=ca.size;break;case "picturemarkersymbol":O=(ca.width+ca.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":O=ca.width;break;case "simplefillsymbol":case "picturefillsymbol":O=ca.outline&&ca.outline.width}O&&(fa=Math.min(fa,
O),sa=Math.max(sa,O))}});return fa!==Number.MAX_VALUE&&sa!==-Number.MAX_VALUE&&1<Math.abs(sa-fa)},getOrderByFields:function(){var U=this.orderByFields||this._orderBy;return this.supportsAdvancedQueries&&U?y.filter(U,function(fa){fa=fa.split(" ")[0];return!!this._getField(fa,!0)},this):null},_createFields:function(U){var fa=U?U.length:0,sa,O=[];for(sa=0;sa<fa;sa++)O.push(new S(U[sa]));this.fields=O},_createFieldsIndex:function(){if(this._fieldsIndexDirty){var U=this.fields,fa=U?U.length:0;if(50<fa&&
this._canUseFieldsIndex()){var sa=new Map;for(var O=new Map,ca=0;ca<fa;ca++){var va=U[ca];sa.set(va.name,va);O.set(va.name.toLowerCase(),va)}sa={caseSensitive:sa,caseInsensitive:O}}this._fieldsIndex=sa;this._fieldsIndexDirty=!1}},_canUseFieldsIndex:function(){var U=c.Map;return!("function"!==typeof c.Proxy||"function"!==typeof c.Proxy.revocable||"function"!==typeof U||!U.prototype||"function"!==typeof U.prototype.set)},_getField:function(U,fa){var sa=this.fields;if(!sa||0===sa.length)return null;
fa&&(U=U.toLowerCase());this._createFieldsIndex();var O=this._fieldsIndex;if(O)return O=fa?O.caseInsensitive:O.caseSensitive,O.get(U);var ca;y.some(sa,function(va){var H=!1;(H=fa?va&&va.name.toLowerCase()===U?!0:!1:va&&va.name===U?!0:!1)&&(ca=va);return H});return ca},_getDateOpts:function(){this._dtOpts||(this._dtOpts={properties:y.map(y.filter(this.fields,function(U){return!(!U||"esriFieldTypeDate"!==U.type)}),function(U){return U.name})});return this._dtOpts},_applyNormalized:function(U,fa){U&&
fa&&y.forEach(U,function(sa,O){sa&&fa[O]&&sa.setGeometry(fa[O])})},_editHandler:function(U,fa,sa,O,ca,va){ca=U.addResults;var H=U.updateResults;U=U.deleteResults;var R,W=this.objectIdField,pa=this._mode,ra=this._isTable;var Aa=this.editFieldsInfo;var Ba=this.getOutFields()||[];var Ja=Aa&&Aa.creatorField,Ka=Aa&&Aa.creationDateField,Ra=Aa&&Aa.editorField,Va=Aa&&Aa.editDateField;Aa=Aa&&Aa.realm;-1===y.indexOf(Ba,"*")&&(Ja&&-1===y.indexOf(Ba,Ja)&&(Ja=null),Ka&&-1===y.indexOf(Ba,Ka)&&(Ka=null),Ra&&-1===
y.indexOf(Ba,Ra)&&(Ra=null),Va&&-1===y.indexOf(Ba,Va)&&(Va=null));var ab=Ka||Va?(new Date).getTime():null,db=Ja||Ra?this.getUserId():void 0;db&&Aa&&(db=db+"@"+Aa);if(ca){var jb=this.globalIdField;for(Aa=0;Aa<ca.length;Aa++)if(ca[Aa]=new Ha(ca[Aa]),!ra){var hb=ca[Aa];if(hb.success){var fb=hb.objectId;Ba=fa[Aa];(R=Ba._graphicsLayer)&&R!==this&&R.remove(Ba);R=Ba.attributes||{};R[W]=fb;fb=hb.globalId;jb&&fb&&(R[jb]=fb);Ja&&(R[Ja]=db);Ra&&(R[Ra]=db);Ka&&(R[Ka]=ab);Va&&(R[Va]=ab);Ba.setAttributes(R);pa._init&&
pa.drawFeature(Ba)}}}if(H)for(Aa=0;Aa<H.length;Aa++)if(H[Aa]=new Ha(H[Aa]),!ra&&(hb=H[Aa],hb.success)){fb=hb.objectId;Ba=sa[fb];if(fa=pa._getFeature(fb))fa.geometry!==Ba.geometry&&Ba.geometry&&fa.setGeometry(qa.fromJson(Ba.geometry.toJson())),fa.attributes!==Ba.attributes&&Ba.attributes&&fa.setAttributes(z.mixin(fa.attributes,Ba.attributes)),this._repaint(fa,fb);Ba=fa||Ba;R=Ba.attributes||{};Ra&&(R[Ra]=db);Va&&(R[Va]=ab);Ba.setAttributes(R)}if(U){sa=[];for(Aa=0;Aa<U.length;Aa++)if(U[Aa]=new Ha(U[Aa]),
!ra&&(hb=U[Aa],hb.success&&(fb=hb.objectId,Ba=pa._getFeature(fb))))this._unSelectFeatureIIf(fb,pa)&&sa.push(Ba),Ba._count=0,pa._removeFeatureIIf(fb);if(0<sa.length)this.onSelectionComplete(sa,Ea.SELECTION_SUBTRACT)}this._resolve([ca,H,U],"onEditsComplete",O,va)},_sendAttachment:function(U,fa,sa,O,ca){var va=this;return t({url:this._url.path+"/"+fa+"/"+("add"===U?"addAttachment":"updateAttachment"),form:sa,content:z.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",
handleAs:"json"}).addCallback(function(H){var R="add"===U?"onAddAttachmentComplete":"onUpdateAttachmentComplete";H=new Ha(H["add"===U?"addAttachmentResult":"updateAttachmentResult"]);H.attachmentId=H.objectId;H.objectId=fa;va._resolve([H],R,O);return H}).addErrback(function(H){va._resolve([H],null,ca,null,!0)})},_repaint:function(U,fa,sa){fa=w.isDefined(fa)?fa:U.attributes[this.objectIdField];fa in this._selectedFeatures&&this._selectionSymbol||U.setSymbol(U.symbol,sa)},_getKind:function(U){var fa=
this._trackManager;return fa?fa.isLatestObservation(U)?1:0:0}});z.mixin(Ea,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});V._createWrappers(Ea);Object.defineProperty(Ea.prototype,"graphics",{get:function(){return this._hasOnDemandDrillMode()?this._mode.graphics:this._graphicsVal},set:function(U){this._graphicsVal=
U}});Object.defineProperty(Ea.prototype,"name",{get:function(){return this.arcgisProps&&this.arcgisProps.title?this.arcgisProps.title:this._name},set:function(U){this._name=U;this.loaded&&this.arcgisProps&&(this.arcgisProps.title=null)}});Object.defineProperty(Ea.prototype,"fields",{get:function(){return this._fields},set:function(U){U&&this._canUseFieldsIndex()&&(U=new Proxy(U,{set:z.hitch(this,function(fa,sa,O){if(sa)if("length"===sa)this._fieldsIndexDirty=!0;else{var ca=Number(sa);"number"!==typeof ca||
isNaN(ca)||(this._fieldsIndexDirty=!0)}fa[sa]=O;return!0})}));this._fields=U;this._fieldsIndexDirty=!0}});z.setObject("layers.FeatureLayer",Ea,k);return Ea})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(F,m,a,D,z,y,r){F=F(r,{declaredClass:"esri.renderer.SimpleRenderer",constructor:function(q,n){if(q&&!q.declaredClass){var f=q;this.symbol=(q=f.symbol)&&(q.declaredClass?q:y.fromJson(q,
n));this.label=f.label;this.description=f.description}else this.symbol=q},getSymbol:function(q){return this.symbol},toJson:function(){var q=m.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return z.fixJson(q)}});m.setObject("renderer.SimpleRenderer",F,D);return F})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color ../layers/support/attributeUtils ../support/expressionUtils ../arcadeProfiles/visualizationProfile".split(" "),
function(F,m,a,D,z,y,r,q,n,f){var d=Math.PI;F=F(null,{declaredClass:"esri.renderer.Renderer",constructor:function(e){this._cache={};if(e&&!e.declaredClass){this.rotationInfo=e.rotationInfo;if(!this.rotationInfo){var b=e.rotationType,c=e.rotationExpression;if(b||c)this.rotationInfo={type:b,expression:c}}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(e.sizeInfo));this.setColorInfo(this._readColorInfo(e.colorInfo));this.setOpacityInfo(this._readOpacityInfo(e.transparencyInfo));
this.setVisualVariables(this._readVariables(e.visualVariables));this.setAuthoringInfo(e.authoringInfo)}this.getSymbol=m.hitch(this,this.getSymbol)},getSymbol:function(e){},_readSizeInfo:function(e){if(e){var b=e.minSize,c=e.maxSize;b&&(e.minSize="number"===typeof b?z.pt2px(b):this._readSizeInfo(b));c&&(e.maxSize="number"===typeof c?z.pt2px(c):this._readSizeInfo(c));e.stops&&a.forEach(e.stops,function(h){h.size&&"number"===typeof h.size&&(h.size=z.pt2px(h.size))})}return e},_readColorInfo:function(e){e&&
(a.forEach(e.colors,function(b,c){m.isArray(b)&&(e.colors[c]=r.toDojoColor(b))}),a.forEach(e.stops,function(b,c){b.color&&m.isArray(b.color)&&(e.stops[c].color=r.toDojoColor(b.color))}));return e},_readOpacityInfo:function(e){if(e){var b=m.mixin({},e);b.transparencyValues&&(b.opacityValues=a.map(b.transparencyValues,function(c){return 1-c/100}),delete b.transparencyValues);b.stops&&(b.stops=a.map(b.stops,function(c){c=m.mixin({},c);c.opacity=1-c.transparency/100;delete c.transparency;return c}))}return b},
_readVariables:function(e){e&&(e=a.map(e,function(b){"sizeInfo"===b.type?b=this._readSizeInfo(b):"colorInfo"===b.type?b=this._readColorInfo(b):"transparencyInfo"===b.type&&(b=this._readOpacityInfo(b),b.type="opacityInfo");return b},this));return e},setAuthoringInfo:function(e){this.authoringInfo=e},setRotationInfo:function(e){if(e=this.rotationInfo="string"===typeof e?{field:e}:e){if(e.expression&&!m.isFunction(e.expression)&&!e.field){var b=e.expression.match(this.rotationRE);b&&b[1]&&(e.field=b[1])}e.rotationType=
e.type}this._cache.rotationInfo=this._processRotationInfo(e);return this},rotationRE:/^\[([^\]]+)\]$/i,_processRotationInfo:function(e){e&&!e.rotationType&&(e.rotationType="geographic");return this._createCache(e)},getRotationAngle:function(e,b){var c=this._getVarInfo(b&&b.rotationInfo,"rotationInfo"),h=c.variable;c=this._cache[c.cacheKey];var g="arithmetic"===this._getRotationType(h),k=c&&c.hasExpr,w=null;if(h.field||k)w=this._getDataValue(e,h,null,c),null!=w&&(w=(w+(g?-90:0))*(g?-1:1));return w},
_getRotationType:function(e){return e&&("rotationInfo"===e.type?e.rotationType:e.type)},_getDataValue:function(e,b,c,h,g){h||(h=this._getVarInfo(b,c),b=h.variable,h=this._cache[h.cacheKey],"sizeInfo"===c&&(h=h.root));return e._getDataValue(b,h,n,g)},setVisualVariables:function(e){var b=this._cache;a.forEach(this.visualVariables,function(c,h){b.hasOwnProperty(h)&&(b[h]=null)},this);this.visualVariables=e;a.some(e,function(c){return!!c.target})&&e.sort(function(c,h){return c.target===h.target?0:c.target?
1:-1});a.forEach(e,function(c,h){"colorInfo"===c.type?b[h]=this._processColorInfo(c):"opacityInfo"===c.type?b[h]=this._processOpacityInfo(c):"sizeInfo"===c.type?b[h]=this._processSizeInfo(c):"rotationInfo"===c.type&&(b[h]=this._processRotationInfo(c))},this);return this},getVisualVariableValues:function(e){var b=this.visualVariables,c;b&&(c=a.map(b,function(h){switch(h.type){case "sizeInfo":var g=this.getSize(e,{sizeInfo:h});break;case "colorInfo":g=this.getColor(e,{colorInfo:h});break;case "opacityInfo":g=
this.getOpacity(e,{opacityInfo:h});break;case "rotationInfo":g=this.getRotationAngle(e,{rotationInfo:h})}return{variable:h,value:g}},this));return c},getFieldsUsedInExpressions:function(e){var b=[];a.forEach(this._getCacheObjects(),function(c){c.syntaxTree&&(b=b.concat(n.extractFieldNames(c.syntaxTree,e)))});b.sort();return a.filter(b,function(c,h){return 0===h||b[h-1]!==c})},hasGeometryOperations:function(){return a.some(this._getCacheObjects(),function(e){return e.syntaxTree?n.hasGeometryOperations(e.syntaxTree):
!1})},initializeArcadeEngine:function(){var e=[];a.forEach(this._getCacheObjects(),function(b){b.syntaxTree&&e.push(b.syntaxTree)});return f.initialize(e)},hasVisualVariables:function(e,b){return e?!!this.getVisualVariablesForType(e,b):!!(this.getVisualVariablesForType("sizeInfo",b)||this.getVisualVariablesForType("colorInfo",b)||this.getVisualVariablesForType("opacityInfo",b)||this.getVisualVariablesForType("rotationInfo",b))},getVisualVariablesForType:function(e,b){var c=this.visualVariables;if(!b&&
this[e]){"rotationInfo"===e&&(this[e].rotationType=this[e].type);var h=[this[e]]}else c&&(h=a.filter(c,function(g){return g.type===e&&("string"===typeof b?g.target===b:!1===b?!g.target:!0)}))&&0===h.length&&(h=void 0);return h},setSizeInfo:function(e){this.sizeInfo=this.proportionalSymbolInfo=e;this._cache.sizeInfo=this._processSizeInfo(e);return this},_processSizeInfo:function(e){return e&&{root:this._createCache(e),minSize:this._createCache(e.minSize),maxSize:this._createCache(e.maxSize)}},_convertExpressionToArcade:function(e){e&&
e.expression&&(e.valueExpression="$view.scale")},_getVarInfo:function(e,b){if(e&&e.type===b){var c=a.indexOf(this.visualVariables,e);e=this.visualVariables[c]}else c=b,e=this[b];return{variable:e,cacheKey:c}},setProportionalSymbolInfo:function(e){this.setSizeInfo(e);return this},getSize:function(e,b){var c=this._getVarInfo(b&&b.sizeInfo,"sizeInfo"),h=c.variable;c=this._cache[c.cacheKey];var g=null;if(h){var k=h.minSize;g=h.maxSize;k="object"===typeof k&&k?this._getSize(e,k,c&&c.minSize,b):k;g="object"===
typeof g&&g?this._getSize(e,g,c&&c.maxSize,b):g;g=this._getSize(e,h,c&&c.root,b,[k,g])}return g},_getSize:function(e,b,c,h,g){var k=b.stops,w=0,t=c&&c.hasExpr,C=c&&c.ipData,u=c&&c.isScaleDriven,x="object"===typeof e&&!!e,l="number"===typeof e?e:null;if(b.field||u||t){var v=h&&h.scale;t=g?g[0]:b.minSize;g=g?g[1]:b.maxSize;var A=b.minDataValue,B=b.maxDataValue,E=b.valueUnit||"unknown",G=b.valueRepresentation,I=b.scaleBy,L=h&&h.shape;u?l=v:"number"!==typeof l&&x&&(l=this._getDataValue(e,b,null,c));if(!this._isValidNumber(l))return null;
if(k)t=this._lookupData(l,C),l=t[0],g=t[1],l===g?w=k[l].size:(l=k[l].size,k=k[g].size,w=l+(k-l)*t[2]);else if(null!=t&&null!=g&&null!=A&&null!=B)l<=A?w=t:l>=B?w=g:(k=(l-A)/(B-A),"area"===I&&L?(t=(l="circle"===L)?d*Math.pow(t/2,2):t*t,k=t+k*((l?d*Math.pow(g/2,2):g*g)-t),w=l?2*Math.sqrt(k/d):Math.sqrt(k)):w=t+k*(g-t));else if("unknown"===E)null!=t&&null!=A&&(t&&A?(k=l/A,w="circle"===L?2*Math.sqrt(k*Math.pow(t/2,2)):"square"===L||"diamond"===L||"image"===L?Math.sqrt(k*Math.pow(t,2)):k*t):w=l+(t||A),
w=w<t?t:w,null!=g&&w>g&&(w=g));else{k=(h&&h.resolution?h.resolution:1)*this._meterIn[E];if("area"===G)w=Math.sqrt(l/d)/k,w*=2;else if(w=l/k,"radius"===G||"distance"===G)w*=2;null!=t&&w<t&&(w=t);null!=g&&w>g&&(w=g)}}else w=k&&k[0]&&k[0].size,null==w&&(w=b.minSize);return w=isNaN(w)?0:w},getSizeRangeAtScale:function(e,b){var c=this._getVarInfo(e,"sizeInfo"),h=this._cache[c.cacheKey],g={scale:b};if((e=c.variable)&&b){c=e.minSize;var k=e.maxSize,w=e.stops;w&&w.length?(c=w[0].size,h=w[w.length-1].size):
(c="object"===typeof c&&c?this._getSize({},c,h&&h.minSize,g):c,h="object"===typeof k&&k?this._getSize({},k,h&&h.maxSize,g):k);if(null!=c||null!=h){if(c>h){var t=h;h=c;c=t}t={minSize:c,maxSize:h}}}return t},setColorInfo:function(e){this.colorInfo=e;this._cache.colorInfo=this._processColorInfo(e);return this},_createCache:function(e,b){var c=q.createAttributeCache(e,b);c&&(c.ipData=this._interpolateData(e));return c},_getCacheObjects:function(e){var b;e=e||this._cache;var c=[];for(b in e){var h=e[b];
e.hasOwnProperty(b)&&h&&"object"===typeof h&&(h.hasOwnProperty("idSource")?c.push(h):c=c.concat(this._getCacheObjects(h)))}return c},_processColorInfo:function(e){e&&(a.forEach(e.colors,function(b,c){m.isArray(b)&&(e.colors[c]=new r(b))}),a.forEach(e.stops,function(b,c){b.color&&m.isArray(b.color)&&(e.stops[c].color=new r(b.color))}));return this._createCache(e)},getColor:function(e,b){var c=this._getVarInfo(b&&b.colorInfo,"colorInfo");return this._getColorComponent(e,c.variable,this._cache[c.cacheKey])},
setOpacityInfo:function(e){this.opacityInfo=e;this._cache.opacityInfo=this._processOpacityInfo(e);return this},_processOpacityInfo:function(e){return this._createCache(e)},getOpacity:function(e,b){var c=this._getVarInfo(b&&b.opacityInfo,"opacityInfo");return this._getColorComponent(e,c.variable,this._cache[c.cacheKey],!0)},_getColorComponent:function(e,b,c,h,g){var k="number"===typeof e?e:null,w=c&&c.hasExpr,t=c&&c.ipData,C;b&&b.field||w?("number"!==typeof k&&"object"===typeof e&&e&&(k=this._getDataValue(e,
b,null,c)),this._isValidNumber(k)||(k=null),null!=k&&(C=h?this._getOpacity(k,b,t):this._getColor(k,b,t))):b&&(e=b.stops,h?(C=e&&e[0]&&e[0].opacity,null==C&&(C=b.opacityValues&&b.opacityValues[0])):C=e&&e[0]&&e[0].color||b.colors&&b.colors[0]);g&&(g.data=k,g.value=C);return g||C},_isValidNumber:function(e){return"number"===typeof e&&!isNaN(e)&&Infinity!==e&&-Infinity!==e},_interpolateData:function(e){if(e)if(e.colors||e.opacityValues){var b=(e.colors||e.opacityValues).length,c=e.minDataValue,h=(e.maxDataValue-
c)/(b-1);var g=[];for(e=0;e<b;e++)g[e]=c+e*h}else e.stops&&(g=a.map(e.stops,function(k){return k.value}));return g},_getOpacity:function(e,b,c){e=this._lookupData(e,c);b=b||this.opacityInfo;if(e){c=e[0];var h=e[1];c===h?h=this._getOpacValue(b,c):(c=this._getOpacValue(b,c),b=this._getOpacValue(b,h),h=c+(b-c)*e[2])}return h},_getOpacValue:function(e,b){return e.opacityValues?e.opacityValues[b]:e.stops[b].opacity},_getColor:function(e,b,c){e=this._lookupData(e,c);b=b||this.colorInfo;if(e){var h=e[0];
c=e[1];h=h===c?this._getColorObj(b,h):r.blendColors(this._getColorObj(b,h),this._getColorObj(b,c),e[2])}return h},_getColorObj:function(e,b){return e.colors?e.colors[b]:e.stops[b].color},_lookupData:function(e,b){if(b){var c=0,h=b.length-1;a.some(b,function(k,w){if(e<k)return h=w,!0;c=w;return!1});var g=[c,h,(e-b[c])/(b[h]-b[c])]}return g},_meterIn:{inches:1/.0254,feet:1/.3048,yards:1/.9144,miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,
"decimal-degrees":180/20015077},_writeSizeInfo:function(e){if(e){e=m.mixin({},e);this._convertExpressionToArcade(e);var b=e.minSize,c=e.maxSize;b&&(e.minSize="number"===typeof b?z.px2pt(b):this._writeSizeInfo(b));c&&(e.maxSize="number"===typeof c?z.px2pt(c):this._writeSizeInfo(c));if(b=e.legendOptions)if(e.legendOptions=m.mixin({},b),b=b.customValues)e.legendOptions.customValues=b.slice(0);e.stops&&(e.stops=a.map(e.stops,function(h){h=m.mixin({},h);h.size&&"number"===typeof h.size&&(h.size=z.px2pt(h.size));
return h}))}return e},_writeColorInfo:function(e){e&&(e=m.mixin({},e),e.colors&&(e.colors=a.map(e.colors,function(b){return r.toJsonColor(b)})),e.stops&&(e.stops=a.map(e.stops,function(b){b=m.mixin({},b);b.color&&(b.color=r.toJsonColor(b.color));return b})),e.legendOptions&&(e.legendOptions=m.mixin({},e.legendOptions)));return e},_writeOpacityInfo:function(e){if(e){var b=m.mixin({},e);b.opacityValues&&(b.transparencyValues=a.map(b.opacityValues,function(c){return 100*(1-c)}),delete b.opacityValues);
b.stops&&(b.stops=a.map(b.stops,function(c){c=m.mixin({},c);c.transparency=100*(1-c.opacity);delete c.opacity;return c}));b.legendOptions&&(b.legendOptions=m.mixin({},b.legendOptions))}return b},toJson:function(e){var b=this.visualVariables,c=m.clone(this.authoringInfo),h=e&&e.useLegacyRotationProperties,g=(e=(e=this.getVisualVariablesForType("rotationInfo",!1))&&e[0])&&e.field,k;e&&(e===this.rotationInfo||h)&&(k=e.expression||g&&(m.isFunction(g)?g:"["+g+"]"));b&&(b=a.map(b,function(w){"sizeInfo"===
w.type?w=this._writeSizeInfo(w):"colorInfo"===w.type?w=this._writeColorInfo(w):"opacityInfo"===w.type?(w=this._writeOpacityInfo(w),w.type="transparencyInfo"):"rotationInfo"===w.type&&(w=h?null:m.mixin({},w));return w},this),b=a.filter(b,function(w){return null!=w}));c&&a.forEach(c.visualVariables,function(w){"opacityInfo"===w.type&&(w.type="transparencyInfo")});return{rotationType:k&&(this._getRotationType(e)||"geographic"),rotationExpression:k,colorInfo:this._writeColorInfo(this.colorInfo),transparencyInfo:this._writeOpacityInfo(this.opacityInfo),
sizeInfo:this._writeSizeInfo(this.sizeInfo),visualVariables:b,authoringInfo:c}}});m.setObject("renderer.Renderer",F,y);return F})},"esri/arcadeProfiles/visualizationProfile":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../promiseList ../support/expressionUtils ./utils".split(" "),function(F,m,a,D,z,y,r){F=new (F(null,{declaredClass:"esri.arcadeProfiles.VisualizationProfile",initialize:function(q){var n=[];r.hasGeometryOperations(q)&&n.push(y.enableGeometryOperations());
return z(n)}}));m.setObject("arcadeProfiles.visualizationProfile",F,D);return F})},"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ../support/expressionUtils".split(" "),function(F,m,a,D,z,y,r,q,n){F=F(q,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(f,d,e,b,c,h){this.values=[];this._symbols={};this.infos=[];f&&!f.declaredClass?(d=f,e=h&&h.geometryType,this.defaultSymbol=
(f=d.defaultSymbol)&&(f.declaredClass?f:r.fromJson(f,h)),this.attributeField=d.field1,this.attributeField2=d.field2,this.attributeField3=d.field3,this.fieldDelimiter=d.fieldDelimiter,this.defaultLabel=d.defaultLabel,this.setValueExpression(d.valueExpression),this.valueExpressionTitle=d.valueExpressionTitle,this.legendOptions=d.legendOptions,d.backgroundFillSymbol&&(this.backgroundFillSymbol=r.fromJson(d.backgroundFillSymbol,e?{geometryType:"esriGeometryPolygon"}:null)),"esriGeometryPolygon"===e&&
this.hasVisualVariables("sizeInfo",!1)&&(h={geometryType:"esriGeometryPoint"}),m.forEach(d.uniqueValueInfos,function(g){this._addValueInfo(g,h)},this)):(this.defaultSymbol=f,this.attributeField=d,this.attributeField2=e,this.attributeField3=b,this.fieldDelimiter=c);this._multiple=!!this.attributeField2},addValue:function(f,d){var e=a.isObject(f)?f:{value:f,symbol:d};this._addValueInfo(e)},removeValue:function(f){var d=m.indexOf(this.values,f);-1!==d&&(this.values.splice(d,1),this._hasNullKeyword=this._evalNullKeyword(this.values),
delete this._symbols[f],this.infos.splice(d,1))},getUniqueValueInfo:function(f){var d=this.attributeField,e=f.attributes;if(this.valueExpression)d=this._getDataValue(f,this._uvInfo,null,this._cache.uvInfo),d=this._normalizeNullValue(d);else if(this._multiple){f=this.attributeField2;var b=this.attributeField3,c=[];d&&c.push(this._normalizeNullValue(e[d]));f&&c.push(this._normalizeNullValue(e[f]));b&&c.push(this._normalizeNullValue(e[b]));d=c.join(this.fieldDelimiter||"")}else d=a.isFunction(d)?d(f):
e[d],d=this._normalizeNullValue(d);return this._symbols[d]},setValueExpression:function(f){this.valueExpression=f;this._uvInfo={valueExpression:f};this._cache.uvInfo=this._createCache(this._uvInfo,!0)},getFieldsUsedInExpressions:function(f){var d=this.inherited(arguments);this.valueExpression&&(d=d.concat(n.extractFieldNames(this.valueExpression,f)));d.sort();return m.filter(d,function(e,b){return 0===b||d[b-1]!==e})},getSymbol:function(f){return(f=this.getUniqueValueInfo(f))&&f.symbol||this.defaultSymbol},
_addValueInfo:function(f,d){var e=f.value;this.values.push(e);this._hasNullKeyword=this._evalNullKeyword(this.values);this.infos.push(f);var b=f.symbol;b&&!b.declaredClass&&(f.symbol=r.fromJson(b,d));this._symbols[e]=f},_nullCode:"\x3cNull\x3e",_normalizeNullValue:function(f){return this._hasNullKeyword&&null==f?this._nullCode:f},_evalNullKeyword:function(f){var d=this.fieldDelimiter||"",e=new RegExp("(^|"+d+")("+this._nullCode+")("+d+"|$)");return m.some(f,function(b){return e.test(b)})},toJson:function(){var f=
y.fixJson;var d={type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:a.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:m.map(this.infos||[],function(e){e=a.mixin({},e);e.symbol=e.symbol&&e.symbol.toJson();e.value+="";return f(e)})};
this.backgroundFillSymbol&&(d.backgroundFillSymbol=this.backgroundFillSymbol.toJson());d=a.mixin(this.inherited(arguments),d);return f(d)}});a.setObject("renderer.UniqueValueRenderer",F,z);return F})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer ./StretchRenderer ./ShadedReliefRenderer ./ColormapRenderer".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C){var u={createDefaultRenderer:function(x){x=r.createDefaultSymbol(x);return new q(x)},fromJson:function(x,l){switch(x.type||""){case "simple":var v=new q(x,l);break;case "uniqueValue":v=new n(x,null,null,null,null,l);break;case "classBreaks":v=new f(x,null,l);break;case "vectorField":v=new d(x);break;case "scaleDependent":v=this._scaleDependentFromJson(x);break;case "dotDensity":v=x.attributes?u.createDefaultRenderer("esriGeometryPolygon"):this._dotDensityFromJson(x);
break;case "temporal":v=this._temporalFromJson(x,l);break;case "heatmap":v=this._heatmapFromJson(x);break;case "rasterStretch":v=new w(x);break;case "rasterShadedRelief":v=new t(x);break;case "rasterColormap":v=new C(x);break;default:v=(v=l&&l.geometryType)?u.createDefaultRenderer(v):null}return v},_scaleDependentFromJson:function(x){var l={},v=x.minScale;l.rendererInfos=F.map(x.rendererInfos,function(A){var B=A.maxScale;A={minScale:v,maxScale:B,renderer:A.renderer&&this.fromJson(A.renderer)};v=B;
return A},this);return new b(l)},_dotDensityFromJson:function(x){x.backgroundColor&&m.isArray(x.backgroundColor)&&(x.backgroundColor=y.toDojoColor(x.backgroundColor));0<x.dotSize&&(x.dotSize=D.pt2px(x.dotSize));x.fields&&F.forEach(x.fields,function(l){l&&m.isArray(l.color)&&(l.color=y.toDojoColor(l.color))});x.legendOptions&&(x.legendOptions.backgroundColor&&m.isArray(x.legendOptions.backgroundColor)&&(x.legendOptions.backgroundColor=y.toDojoColor(x.legendOptions.backgroundColor)),x.legendOptions.outline&&
(x.legendOptions.outline=r.fromJson(x.legendOptions.outline)));x.outline&&(x.outline=r.fromJson(x.outline));return new e(x)},_temporalFromJson:function(x,l){var v=l&&l.geometryType;x=x||{};var A=this.fromJson(x.observationRenderer,l);var B=x.latestObservationRenderer?this.fromJson(x.latestObservationRenderer,l):null;v=x.trackRenderer?this.fromJson(x.trackRenderer,v?{geometryType:"esriGeometryPolyline"}:null):null;var E=this._agerFromJson(x.observationAger);return new g(A,B,v,E)},_agerFromJson:function(x){var l;
x=x||{};x.colorRange||x.sizeRange||x.alphaRange?l=this._timeRampFromJson(x):x.agerClassBreakInfos&&(l=this._timeClassBreaksFromJson(x));return l},_timeRampFromJson:function(x){var l,v,A;x.colorRange&&1<x.colorRange.length&&(l=[y.toDojoColor(x.colorRange[0]),y.toDojoColor(x.colorRange[1])]);x.sizeRange&&1<x.sizeRange.length&&(v=[x.sizeRange[0],x.sizeRange[1]]);x.alphaRange&&1<x.alphaRange.length&&(A=[x.alphaRange[0]/255,x.alphaRange[1]/255]);return new h(l,v,A)},_timeClassBreaksFromJson:function(x){var l=
x.agerClassBreakInfos,v=[],A;var B=c.UNIT_DAYS;switch(x.timeUnits){case "esriTimeUnitsSeconds":B=c.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":B=c.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":B=c.UNIT_HOURS;break;case "esriTimeUnitsMinutes":B=c.UNIT_MINUTES;break;case "esriTimeUnitsMonths":B=c.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":B=c.UNIT_WEEKS;break;case "esriTimeUnitsYears":B=c.UNIT_YEARS}for(A=0;A<l.length;A+=1){x=l[A];var E={minAge:0,maxAge:x.oldestAge||Infinity};x.color&&
(E.color=y.toDojoColor(x.color));x.alpha&&(E.alpha=x.alpha/255);E.size=x.size;v[A]=E}return new c(v,B)},_heatmapFromJson:function(x){var l=x.colorStops;l&&l instanceof Array&&F.forEach(l,function(v){v.color=y.toDojoColor(v.color)});return new k(x)}};m.mixin(m.getObject("renderer",!0,z),u);return u})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ../support/expressionUtils".split(" "),
function(F,m,a,D,z,y,r,q,n){F=F(q,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(f,d,e){this.breaks=[];this._symbols={};this.infos=[];this.isMaxInclusive=!0;if(f&&!f.declaredClass){var b=f;d=e&&e.geometryType;this.attributeField=b.field;this.setValueExpression(b.valueExpression);this.valueExpressionTitle=b.valueExpressionTitle;this.legendOptions=b.legendOptions;this.defaultSymbol=(f=b.defaultSymbol)&&(f.declaredClass?f:r.fromJson(f,e));this.backgroundFillSymbol=(f=b.backgroundFillSymbol)&&
(f.declaredClass?f:r.fromJson(f,d?{geometryType:"esriGeometryPolygon"}:null));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],b,this);var c=b.minValue;(f=b.classBreakInfos)&&f[0]&&y.isDefined(f[0].classMaxValue)&&m.forEach(f,function(h){var g=h.classMaxValue;h.minValue=c;c=h.maxValue=g},this);"esriGeometryPolygon"===d&&(this.hasVisualVariables("sizeInfo",!1)||r.isPointSymbol(r.getFirstSupportedSymbol(m.map(f,function(h){return h.symbol}))))&&
(e={geometryType:"esriGeometryPoint"});m.forEach(f,function(h){this._addBreakInfo(h,e)},this)}else this.defaultSymbol=f,this.attributeField=d},addBreak:function(f,d,e){f=a.isObject(f)?f:{minValue:f,maxValue:d,symbol:e};this._addBreakInfo(f)},removeBreak:function(f,d){var e=this.breaks,b,c=e.length,h=this._symbols;for(b=0;b<c;b++){var g=e[b];if(g[0]==f&&g[1]==d){e.splice(b,1);delete h[f+"-"+d];this.infos.splice(b,1);break}}},clearBreaks:function(){this.breaks=[];this._symbols={};this.infos=[]},getBreakIndex:function(f){var d=
this.attributeField,e=f.attributes,b=this.breaks,c=b.length,h=this.isMaxInclusive;if(this.valueExpression)f=this._getDataValue(f,this._cbInfo,null,this._cache.cbInfo);else if(a.isFunction(d))f=d(f);else if(f=parseFloat(e[d]),d=this.normalizationType,d){var g=parseFloat(this.normalizationTotal);e=parseFloat(e[this.normalizationField]);if("log"===d)f=Math.log(f)*Math.LOG10E;else if("percent-of-total"===d&&!isNaN(g))f=f/g*100;else if("field"===d){if(isNaN(f)||isNaN(e))return-1;f/=e}}if(null!=f&&!isNaN(f)&&
"number"===typeof f)for(e=0;e<c;e++)if(d=b[e],d[0]<=f&&(h?f<=d[1]:f<d[1]))return e;return-1},getBreakInfo:function(f){f=this.getBreakIndex(f);return-1!==f?this.infos[f]:null},getSymbol:function(f){return(f=this.breaks[this.getBreakIndex(f)])?this._symbols[f[0]+"-"+f[1]]:this.defaultSymbol},setMaxInclusive:function(f){this.isMaxInclusive=f},setValueExpression:function(f){this.valueExpression=f;this._cbInfo={valueExpression:f};this._cache.cbInfo=this._createCache(this._cbInfo)},getFieldsUsedInExpressions:function(f){var d=
this.inherited(arguments);this.valueExpression&&(d=d.concat(n.extractFieldNames(this.valueExpression,f)));d.sort();return m.filter(d,function(e,b){return 0===b||d[b-1]!==e})},isContinuousRenderer:function(){var f=!1;if(this.infos&&1===this.infos.length){var d=this.attributeField,e=this.normalizationField,b=this.valueExpression;f=this.getVisualVariablesForType("colorInfo",!1)||[];var c=this.getVisualVariablesForType("sizeInfo",!1)||[],h=this.getVisualVariablesForType("opacityInfo",!1)||[];f=f.concat(c).concat(h);
f=m.some(f,function(g){return(g.field===d||g.valueExpression===b)&&g.normalizationField==e})}return f},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total","esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks","esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation","esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"],
["defined-interval","esriClassifyDefinedInterval"],["manual-interval","esriClassifyManual"]],_copy:function(f,d,e){m.forEach(f,function(b){var c=b.split(":");if(1<c.length){b=c[0];var h=this["_"+b+"Enums"];if("rest"===c[1]){var g="1";var k="0"}else"sdk"===c[1]&&(g="0",k="1")}c=d[b];if(void 0!==c&&(e[b]=c,h&&g)){var w,t=h.length;for(w=0;w<t;w++)if(h[w][g]===c){e[b]=h[w][k];break}}},this)},_addBreakInfo:function(f,d){var e=f.minValue,b=f.maxValue;this.breaks.push([e,b]);this.infos.push(f);var c=f.symbol;
c&&!c.declaredClass&&(f.symbol=r.fromJson(c,d));this._symbols[e+"-"+b]=f.symbol},toJson:function(){var f=this.infos||[],d=y.fixJson,e=f[0]&&f[0].minValue,b=this.backgroundFillSymbol;f=a.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:a.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:b&&b.toJson(),minValue:-Infinity===
e?-Number.MAX_VALUE:e,classBreakInfos:m.map(f,function(c){c=a.mixin({},c);c.symbol=c.symbol&&c.symbol.toJson();c.classMaxValue=Infinity===c.maxValue?Number.MAX_VALUE:c.maxValue;delete c.minValue;delete c.maxValue;return d(c)})});this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField","normalizationTotal"],this,f);f.hasOwnProperty("normalizationType")&&!f.normalizationType&&delete f.normalizationType;f.hasOwnProperty("classificationMethod")&&!f.classificationMethod&&
delete f.classificationMethod;return d(f)}});a.setObject("renderer.ClassBreaksRenderer",F,z);return F})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c){var h={STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",
STYLE_CLASSIFIED_ARROW:"classified_arrow",STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},g=F(q,{declaredClass:"esri.renderer.VectorFieldRenderer",iconFolderPath:"../images/symbol/sfs/",constructor:function(k){y.isDefined(k)||(k={});k.attributeField=k.attributeField||"Magnitude";
k.rotationInfo=k.rotationInfo||this._getRotationInfo(k);F.safeMixin(this,k);this.setRotationInfo(this.rotationInfo);this.style=this.style||g.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:b.fromJson(this.singleArrowSymbol));this.renderer=new n(this._getDefaultSymbol(),k.attributeField);this._updateRenderer(this.style);this.flowRepresentation=this.flowRepresentation||this.FLOW_FROM},getSymbol:function(k){return this.renderer&&
this.renderer.getSymbol(k)},setVisualVariables:function(k){k=D.filter(k,function(w){if("sizeInfo"===w.type)return y.isDefined(this._updateSizeInfo(w))},this);this.inherited(arguments);return this},setSizeInfo:function(k){this._updateSizeInfo(k);this.inherited(arguments);return this},setProportionalSymbolInfo:function(k){this.setSizeInfo(k);return this},setColorInfo:function(k){return this},_updateRenderer:function(k){return y.isDefined(this.renderer)?k===g.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():
k===g.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():k===g.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():k===g.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():k===g.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():k===g.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():k===g.STYLE_OCEAN_CURRENT_M?this._createCurrentMeterRenderer():k===g.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():k===g.STYLE_SCALAR?this._createSimpleScalarRenderer():k===g.STYLE_WIND_BARBS?
this._createWindBarbsRenderer():this._createClassifiedArrowRenderer():Error("Invalid Renderer!")},_updateSizeInfo:function(k){return k&&y.isDefined(k.minSize)&&y.isDefined(k.maxSize)&&y.isDefined(k.minDataValue)&&y.isDefined(k.maxDataValue)?(this.style===g.STYLE_WIND_BARBS&&(k.minSize=k.maxSize),k.field=k.field||"Magnitude",k.type="sizeInfo",this.minDataValue=k.minDataValue,this.maxDataValue=k.maxDataValue,k):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([56,
168,0]));var k=[0,1E-6,3.5,7,10.5,14];if(y.isDefined(this.minDataValue)&&y.isDefined(this.maxDataValue)){var w=(this.maxDataValue-this.minDataValue)/5;k=[];var t;var C=this.minDataValue;for(t=0;6>t;t++)k[t]=C,C+=w}this._addBreaks(k,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,
47,39]));this._addBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,
250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var k=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];D.forEach(k,function(w,t){k[t]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(k,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var k=
[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];D.forEach(k,function(w,t){k[t]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(k,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var k=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];D.forEach(k,function(w,t){k[t]*=3.6});this.renderer.defaultSymbol=
this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(k,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([177,177,177]));this._addBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([177,
177,177]));this._addBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new d({url:c.toUrl(this.iconFolderPath+"scalar.png"),height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var k=[],w;for(w=0;150>=w;w+=5)k.push(w);var t="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var C=new d({url:c.toUrl(this.iconFolderPath+"windbarb.png"),height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=C;for(w=0;w<k.length-1;w++)0===w?this.renderer.addBreak({minValue:k[w],maxValue:k[w+1],symbol:C}):this.renderer.addBreak({minValue:k[w],maxValue:k[w+1],symbol:(new f).setPath(t[w]).setOutline((new e).setWidth(1.5)).setSize(20).setColor(new r([0,0,0,255]))})},_getDefaultSymbol:function(k){return(new f).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new e).setWidth(0)).setSize(20).setColor(k||
new r([0,92,230]))},_getRotationInfo:function(k){var w=k&&k.rotationField||"Direction",t=(k&&k.flowRepresentation||g.FLOW_FROM)===g.FLOW_FROM;!k.style||k.style!==h.STYLE_OCEAN_CURRENT_KN&&k.style!==h.STYLE_OCEAN_CURRENT_M||(t=!t);return{field:function(C){C=C.attributes[w];return t?C:C+180},type:"geographic"}},_addBreaks:function(k,w){if(!y.isDefined(this.renderer))return Error("Invalid Renderer!");if(!(k&&w&&k.length&&w.length&&k.length>=w.length))return Error("AddBreaks: Input arguments break values and colors not valid");
var t;for(t=0;t<w.length;t++)this.renderer.addBreak({minValue:k[t],maxValue:k[t+1],symbol:this._getDefaultSymbol(new r(w[t]))})},toJson:function(){var k=m.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,symbolTileSize:this.symbolTileSize,inputUnit:this.inputUnit,outputUnit:this.outputUnit});this.renderer&&this.renderer.defaultSymbol&&this.style===g.STYLE_SINGLE_ARROW&&(k.singleArrowSymbol=this.renderer.defaultSymbol.toJson());
return y.fixJson(k)}});m.mixin(g,h,{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"});m.setObject("renderer.VectorFieldRenderer",g,z);return g})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b){F=F(f,{declaredClass:"esri.renderer.DotDensityRenderer",
constructor:function(c){this.dotSize=c.dotSize||3;this.dotValue=c.dotValue;this.fields=c.fields;this.outline=c.outline;this.backgroundColor=c.backgroundColor;this.exactCount=c.exactCount||!0;this.dotShape=c.dotShape||"square";this.legendOptions=c.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1},getSymbol:function(c){this._currentGraphic=
c;if(!this._supportsCanvas)return null;this._map||(this._map=c.getLayer()._map,this._objectIdField=c.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",m.hitch(this,function(k){this._currentMapScale=this._map.getScale();this._currentResolution=k.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][c.attributes[this._objectIdField]]){var h=
this._symbolMap[this._currentMapScale][c.attributes[this._objectIdField]];var g=this._getShapeProperties(c);h.setOffset(g.dx,g.dy);return h}h=this._generateFieldsCount(this.fields,c.attributes,this.dotValue);g=this._getShapeProperties(c);if(!g.width||!g.height)return null;h=new d(this._generateImageSrc(g.width,g.height,h,g.minXY,g.maxXY),this.outline,g.width,g.height);h.setOffset(g.dx,g.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][c.attributes[this._objectIdField]]=
h},_generateFieldsCount:function(c,h,g){var k;for(k=c.length-1;0<=k;k--){var w=h[c[k].name]/g;c[k].numPoints=Math.round(w)}return c},_getShapeProperties:function(c){var h=c.geometry.getExtent();h.contains(this._map.extent)&&(h=this._map.extent);var g=Math.ceil(h.getWidth()/this._currentResolution);var k=Math.ceil(h.getHeight()/this._currentResolution);var w=this._map.toScreen(new b(h.xmin,h.ymin,h.spatialReference));h=this._map.toScreen(new b(h.xmax,h.ymax,h.spatialReference));c=c.getLayer().getNavigationTransform();
return{minXY:w,maxXY:h,dx:(w.x-c.dx)%g,dy:(h.y-c.dy)%k,width:g,height:k}},_generateImageSrc:function(c,h,g,k,w,t){var C=this.dotSize,u;this._canvas?(this._canvas.width=c,this._canvas.height=h):this._canvas=this._initCanvas(c,h);var x=this._canvas.getContext("2d");if(t=t||this.backgroundColor)x.fillStyle=t.toCss(!0),x.fillRect(0,0,c,h),x.fill();for(t=g.length-1;0<=t;t--)for(x.fillStyle=g[t].color.toCss(!0),u=g[t].numPoints-1;0<=u;u--){var l=this._getRandomPoint(c,h,k,w);"square"===this.dotShape?x.fillRect(l.x,
l.y,C,C):"circle"===this.dotShape&&(x.beginPath(),x.arc(l.x,l.y,C/2,0,2*Math.PI,!0));x.fill()}return this._canvas.toDataURL()},_initCanvas:function(c,h){var g=D.create("canvas",{id:"canvas",width:c+"px",height:h+"px",style:"position: absolute; left: -10000px; top: 0px;"},null);document.body.appendChild(g);return g},_getRandomInt:function(c,h){return Math.floor(Math.random()*(h-c+1)+c)},_getRandomPoint:function(c,h,g,k){var w={},t=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&
c*h>this._exactCountMinArea){c=!1;do w.x=this._getRandomInt(g.x,k.x),w.y=this._getRandomInt(k.y,g.y),c=new e(w.x,w.y),c=this._checkPointShapeBounds(c,this.dotSize+t,this._currentGraphic.geometry),!0===c&&(w.x-=g.x,w.y-=k.y);while(!1===c)}else w.x=this._getRandomInt(0,c),w.y=this._getRandomInt(0,h);return w},_checkPointShapeBounds:function(c,h,g){var k=null;k=!1;var w=!0,t=0;do{switch(t){case 1:c.x+=h;break;case 2:c.y+=h;break;case 3:c.x-=h}k=this._map.toMap(c);k=g.contains(k);!1===k&&(w=!1);t+=1}while(3>=
t&&!0===w);return k},setDotSize:function(c){0<c&&(this.dotSize=c)},setDotValue:function(c){0<c&&(this.dotValue=c)},setOutline:function(c){this.outline=c},setBackgroundColor:function(c){this.backgroundColor=c},toJson:function(){var c=m.mixin(this.inherited(arguments),{type:"dotDensity",backgroundColor:n.toJsonColor(this.backgroundColor),dotShape:this.dotShape,dotSize:0<this.dotSize?y.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:a.map(this.fields,function(h){return q.fixJson({color:n.toJsonColor(h.color),
name:h.name})}),legendOptions:this.legendOptions&&q.fixJson({backgroundColor:n.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),outline:this.outline&&this.outline.toJson()});return q.fixJson(c)}});m.setObject("renderer.DotDensityRenderer",F,r);return F})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),
function(F,m,a,D,z,y,r){F=F(r,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(q){this.setRendererInfos(q&&q.rendererInfos||[])},setRendererInfos:function(q){this.rendererInfos=q;this._setRangeType();return this},getSymbol:function(q){var n=this.getRendererInfo(q);return n&&n.renderer&&n.renderer.getSymbol(q)},getRendererInfo:function(q){q=q.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(q.getZoom()):this.getRendererInfoByScale(q.getScale())},
getRendererInfoByZoom:function(q){var n=this.rendererInfos,f,d=0;do{var e=n[d];q>=e.minZoom&&q<=e.maxZoom&&(f=e);d++}while(!f&&d<n.length);return f},getRendererInfoByScale:function(q){var n=this.rendererInfos,f,d=0;do{var e=n[d];var b=e.minScale;var c=e.maxScale;var h=!b;var g=!c;!h&&q<=b&&(h=!0);!g&&q>=c&&(g=!0);h&&g&&(f=e);d++}while(!f&&d<n.length);return f},addRendererInfo:function(q){var n=0,f=this.rendererInfos,d=q.hasOwnProperty("minZoom")?"minZoom":"minScale",e=f.length;do{var b=f[n];if(e===
n||q[d]<b[d]){f.splice(n,0,q);this._setRangeType();var c=!0}n++}while(!c&&n<e);return this},_setRangeType:function(){var q=this.rendererInfos;if(q=q&&q[0])this.rangeType=q.hasOwnProperty("minZoom")?"zoom":q.hasOwnProperty("minScale")?"scale":""},toJson:function(){if("zoom"===this.rangeType)return null;var q=this.rendererInfos||[],n=q[0]&&q[0].minScale;q=a.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<n?n:0,rendererInfos:m.map(q,function(f){return y.fixJson({maxScale:0<f.maxScale?
f.maxScale:0,renderer:f.renderer&&f.renderer.toJson()})})});return y.fixJson(q)}});a.setObject("renderer.ScaleDependentRenderer",F,z);return F})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(F,m,a,D,z,y,r,q,n,f){var d=F(f,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(e,b){this.infos=e;this.timeUnits=b||"day";e.sort(function(c,
h){return c.minAge<h.minAge?-1:c.minAge>h.minAge?1:0})},getAgedSymbol:function(e,b){var c=b.getLayer(),h=b.attributes,g=r.isDefined;e=q.fromJson(e.toJson());var k=c._map.timeExtent.endTime;if(!k)return e;var w=z.difference(new Date(h[c._startTimeField]),k,this.timeUnits);m.some(this.infos,function(t){if(w>=t.minAge&&w<=t.maxAge){var C=t.color,u=t.size;t=t.alpha;C&&e.setColor(C);g(u)&&this._setSymbolSize(e,u);g(t)&&e.color&&(e.color.a=t);return!0}},this);return e},toJson:function(){var e={agerClassBreakInfos:[]},
b;e.timeUnits=this._getRestUnits(this.timeUnits);for(b=0;b<this.infos.length;b+=1){var c=this.infos[b];var h={};h.oldestAge=Infinity===c.maxAge?null:c.maxAge;h.size=c.size;c.color&&(h.color=n.toJsonColor(c.color));c.alpha&&(h.alpha=Math.round(255*c.alpha));e.agerClassBreakInfos[b]=h}return e},_getRestUnits:function(e){var b="esriTimeUnitsDays";switch(e){case d.UNIT_SECONDS:b="esriTimeUnitsSeconds";break;case d.UNIT_MILLISECONDS:b="esriTimeUnitsMilliseconds";break;case d.UNIT_HOURS:b="esriTimeUnitsHours";
break;case d.UNIT_MINUTES:b="esriTimeUnitsMinutes";break;case d.UNIT_MONTHS:b="esriTimeUnitsMonths";break;case d.UNIT_WEEKS:b="esriTimeUnitsWeeks";break;case d.UNIT_YEARS:b="esriTimeUnitsYears"}return b}});a.mixin(d,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",UNIT_SECONDS:"second",UNIT_WEEKS:"week",UNIT_YEARS:"year"});a.setObject("renderer.TimeClassBreaksAger",d,y);return d})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(z,y){},_setSymbolSize:function(z,y){switch(z.type){case "simplemarkersymbol":z.setSize(y);break;case "picturemarkersymbol":z.setWidth(y);z.setHeight(y);break;case "simplelinesymbol":case "cartographiclinesymbol":z.setWidth(y);break;case "simplefillsymbol":case "picturefillsymbol":z.outline&&z.outline.setWidth(y)}}});m.setObject("renderer.SymbolAger",F,D);return F})},
"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(F,m,a,D,z,y,r,q){F=F(q,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(n,f,d){this.colorRange=n;this.sizeRange=f;this.alphaRange=d},getAgedSymbol:function(n,f){var d=f.getLayer(),e=f.attributes;n=y.fromJson(n.toJson());var b=d._map.timeExtent,c=b.startTime;b=b.endTime;if(!c||!b)return n;c=c.getTime();
b=b.getTime();d=new Date(e[d._startTimeField]);d=d.getTime();d<c&&(d=c);c=b===c?1:(d-c)/(b-c);if(d=this.sizeRange)e=d[0],b=d[1],d=Math.abs(b-e)*c,this._setSymbolSize(n,e<b?e+d:e-d);if(d=this.colorRange){b=d[0];var h=d[1],g=Math.round;e=new a;var k=b.r,w=h.r;d=Math.abs(w-k)*c;e.r=g(k<w?k+d:k-d);k=b.g;w=h.g;d=Math.abs(w-k)*c;e.g=g(k<w?k+d:k-d);k=b.b;w=h.b;d=Math.abs(w-k)*c;e.b=g(k<w?k+d:k-d);b=b.a;h=h.a;d=Math.abs(h-b)*c;e.a=b<h?b+d:b-d;n.setColor(e)}e=n.color;(d=this.alphaRange)&&e&&(b=d[0],h=d[1],
d=Math.abs(h-b)*c,e.a=b<h?b+d:b-d);return n},toJson:function(){var n={};this.sizeRange&&(n.sizeRange=this.sizeRange);this.colorRange&&(n.colorRange=[r.toJsonColor(this.colorRange[0]),r.toJsonColor(this.colorRange[1])]);this.alphaRange&&(n.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]);return n}});m.setObject("renderer.TimeRampAger",F,z);return F})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel",
"./Renderer"],function(F,m,a,D,z){F=F(z,{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(y,r,q,n){this.observationRenderer=y;this.latestObservationRenderer=r;this.trackRenderer=q;this.observationAger=n},getSymbol:function(y){var r=y.getLayer(),q=this.getObservationRenderer(y),n=q&&q.getSymbol(y),f=this.observationAger;r.timeInfo&&r._map.timeExtent&&q===this.observationRenderer&&f&&n&&(n=f.getAgedSymbol(n,y));return n},getObservationRenderer:function(y){return 0===y.getLayer()._getKind(y)?
this.observationRenderer:this.latestObservationRenderer||this.observationRenderer},toJson:function(){var y={type:"temporal"};y.observationRenderer=this.observationRenderer.toJson();this.latestObservationRenderer&&(y.latestObservationRenderer=this.latestObservationRenderer.toJson());this.trackRenderer&&(y.trackRenderer=this.trackRenderer.toJson());this.observationAger&&(y.observationAger=this.observationAger.toJson());return y}});m.setObject("renderer.TemporalRenderer",F,D);return F})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),
function(F,m,a,D,z,y,r,q,n,f){F=F([f],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,field:null,fieldOffset:null,colorStops:null,constructor:function(d){if(this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1)"string"==typeof d&&(d=JSON.parse(d)),m.mixin(this,d),this._canvas=null,this.colors||this.colorStops||(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:.75,color:"rgba(255, 140, 0, 1)"},{ratio:.9,color:"rgba(255, 0,   0, 1)"}]),
this.gradient=this._generateGradient(this.colorStops||this.colors)},getSymbol:function(d){if(!this._supportsCanvas)return!1;var e=d.attributes.imageData;d=d.attributes.size;if(!d)return null;var b=this._getContext(d[0],d[1]),c=b.getImageData(0,0,d[0],d[1]);window.ArrayBuffer&&e instanceof ArrayBuffer?e=window.Uint8ClampedArray?new Uint8ClampedArray(e):new Uint8Array(e):e.BYTES_PER_ELEMENT&&1!==e.BYTES_PER_ELEMENT&&(e=window.Uint8ClampedArray?new Uint8ClampedArray(e.buffer):new Uint8Array(e.buffer));
if(window.CanvasPixelArray&&c.data instanceof window.CanvasPixelArray)for(var h=c.data,g=h.length;g--;)h[g]=e[g];else c.data.set(e);b.putImageData(c,0,0);return new q(b.canvas.toDataURL(),d[0],d[1])},setColors:function(d){d&&(d instanceof Array||d.colors)&&(this.gradient=this._generateGradient(d.colors||d),this.colors=d);return this},setColorStops:function(d){d&&(d instanceof Array||d.colorStops)&&(this.gradient=this._generateGradient(d.colorStops||d),this.colorStops=d);return this},setMaxPixelIntensity:function(d){this.maxPixelIntensity=
d;return this},setMinPixelIntensity:function(d){this.minPixelIntensity=d;return this},setField:function(d){this.field=d;return this},setFieldOffset:function(d){this.fieldOffset=d;return this},setBlurRadius:function(d){this.blurRadius=d;return this},getStats:function(){},getHistogramData:function(){},toJson:function(){var d=m.mixin(this.inherited(arguments),{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,
minPixelIntensity:this.minPixelIntensity,field:this.field});null!=this.fieldOffset&&(d.fieldOffset=this.fieldOffset);a.forEach(d.colorStops,function(e){e.color=n.toJsonColor(e.color)});return r.fixJson(d)},_getContext:function(d,e){this._canvas?(this._canvas.width=d,this._canvas.height=e):this._canvas=this._initCanvas(d,e);return this._canvas.getContext("2d")},_initCanvas:function(d,e){var b=D.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: 0px; top: -10000px;"},
null);b.width=d;b.height=e;document.body.appendChild(b);return b},_generateGradient:function(d,e){e||(e=512);for(var b=this._colorsToStops(d),c=this._getContext(1,e||512),h=c.createLinearGradient(0,0,0,e),g=0,k;g<b.length;g++)k=b[g],h.addColorStop(k.ratio,k.color.toCss(!0));c.fillStyle=h;c.fillRect(0,0,1,e);return c.getImageData(0,0,1,e).data},_colorsToStops:function(d){var e=[];if(!d[0])return e;if(null!=d[0].ratio)e=a.map(d,function(w){return{ratio:w.ratio,color:this._toColor(w.color)}},this);else if(null!=
d[0].value){var b=Infinity;e=-Infinity;var c=0,h;for(h=0;h<d.length;h++){var g=d[h].value;g<b&&(b=g);g>e&&(e=g)}c=e-b;this.maxPixelIntensity=e;this.minPixelIntensity=b;e=a.map(d,function(w){var t=w.value;w=this._toColor(w.color);return{value:t,ratio:(t-b)/c,color:w}},this)}else{var k=d.length-1;e=a.map(d,function(w,t){return{color:this._toColor(w),ratio:t/k}},this)}return e},_toColor:function(d){d.toRgba||d.declaredClass||(d=new n(d));return d}});m.setObject("renderer.HeatmapRenderer",F,y);return F})},
"esri/renderers/StretchRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../layers/RasterFunction ./colorRampUtils".split(" "),function(F,m,a,D,z,y,r,q){var n={TYPE_NONE:"none",TYPE_STANDARDDEVIATION:"standardDeviation",TYPE_HISTOGRAMEQUALIZATION:"histogramEqualization",TYPE_MINMAX:"minMax",TYPE_PERCENTCLIP:"percentClip",TYPE_SIGMOID:"sigmoid"};F=F(null,{declaredClass:"esri.renderer.StretchRenderer",constructor:function(f){f=f||{};this.stretchType=
n.TYPE_NONE;this.dra=!0;this.statistics=[];this.gamma=[];this.computeGamma=this.useGamma=!1;this.sigmoidStrengthLevel=this.numberOfStandardDeviations=this.minPercent=this.maxPercent=this.min=this.max=null;a.mixin(this,f);this.colorRamp=q.fromJson(f.colorRamp)},toJson:function(){var f={type:"rasterStretch",stretchType:this.stretchType,colorRamp:this.colorRamp&&this.colorRamp.toJson(),min:this.min,max:this.max,numberOfStandardDeviations:this.numberOfStandardDeviations,statistics:a.clone(this.statistics),
dra:this.dra,minPercent:this.minPercent,maxPercent:this.maxPercent,useGamma:this.useGamma,gamma:a.clone(this.gamma),computeGamma:this.computeGamma,sigmoidStrengthLevel:this.sigmoidStrengthLevel};return y.fixJson(f)},toRenderingRule:function(f){f=f||{};var d=new r;d.functionName="Stretch";var e=this._convertStretchTypeEnumToIndex(this.stretchType),b={StretchType:e,Statistics:this.statistics,DRA:this.dra,UseGamma:this.useGamma,Gamma:this.gamma,ComputeGamma:this.computeGamma};y.isDefined(this.min)&&
(b.Min=this.min);y.isDefined(this.min)&&(b.Max=this.max);3===e?(b.NumberOfStandardDeviations=this.numberOfStandardDeviations,d.outputPixelType="U8"):6===e?(b.MinPercent=parseFloat(this.minPercent),b.MaxPercent=parseFloat(this.maxPercent),d.outputPixelType="U8"):5===e?d.outputPixelType="U8":9===e&&(b.SigmoidStrengthLevel=this.sigmoidStrengthLevel);d.functionArguments=b;d.variableName="Raster";return this.colorRamp?(e=new r,e.functionArguments=f.convertToColormap?{Colormap:q.convertColorRampToColormap(this.colorRamp,
256)}:{colorRamp:this.colorRamp.toJson()},e.variableName="Raster",e.functionName="Colormap",e.functionArguments.Raster=d,e):d},_convertStretchTypeEnumToIndex:function(f){var d=0;f===n.TYPE_STANDARDDEVIATION?d=3:f===n.TYPE_HISTOGRAMEQUALIZATION?d=4:f===n.TYPE_MINMAX?d=5:f===n.TYPE_PERCENTCLIP?d=6:f===n.TYPE_SIGMOID&&(d=9);return d},_convertStretchTypeIndexToEnum:function(f){var d=n.TYPE_NONE;3===f?d=n.TYPE_STANDARDDEVIATION:4===f?d=n.TYPE_HISTOGRAMEQUALIZATION:5===f?d=n.TYPE_MINMAX:6===f?d=n.TYPE_PERCENTCLIP:
9===f&&(d=n.TYPE_SIGMOID);return d}});a.mixin(F,n);a.setObject("renderer.StretchRenderer",F,z);return F})},"esri/layers/RasterFunction":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(F,m,a,D,z){var y=F(null,{declaredClass:"esri.layers.RasterFunction",functionName:null,arguments:null,functionArguments:null,variableName:null,outputPixelType:null,_isTemplate:null,_templateJson:null,constructor:function(r){if(m.isObject(r)){this._isRFTJson(r)&&(this._isTemplate=
!0,this._templateJson=r);var q=0;this.functionName=r.rasterFunction||r.name;this.functionArguments=m.clone(r.rasterFunctionArguments||r.arguments);m.mixin(this,r);if(r=this.functionArguments)if(r.Raster=this._toRasterFunction(r.Raster),r.Raster2=this._toRasterFunction(r.Raster2),r.DEM=this._toRasterFunction(r.DEM),r.FillRaster=this._toRasterFunction(r.FillRaster),r.Rasters&&r.Rasters.length)for(q=0;q<r.Rasters.length;q++)r.Rasters[q]=this._toRasterFunction(r.Rasters[q])}},_isRFTJson:function(r){return r.name&&
r.arguments&&r["function"]&&r.hasOwnProperty("functionType")},_toRasterFunction:function(r){return r&&(r.rasterFunction||r.functionName)?new y(r):r},_rfToJson:function(r){r&&"esri.layers.RasterFunction"===r.declaredClass&&(r=r.toJson());return r},toJson:function(){if(this._isTemplate)return this._templateJson;var r=m.clone(this.functionArguments||this.arguments);if(r&&(r.Raster=this._rfToJson(r.Raster),r.Raster2=this._rfToJson(r.Raster2),r.DEM=this._rfToJson(r.DEM),r.FillRaster=this._rfToJson(r.FillRaster),
r.Rasters&&r.Rasters.length)){var q,n=[];for(q=0;q<r.Rasters.length;q++)n.push(this._rfToJson(r.Rasters[q]));r.Rasters=n}return z.filter({rasterFunction:this.functionName,rasterFunctionArguments:r,variableName:this.variableName,outputPixelType:this.outputPixelType?this.outputPixelType:null},function(f){if(null!==f&&void 0!==f)return!0})}});m.setObject("layers.RasterFunction",y,D);return y})},"esri/renderers/colorRampUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/store/Memory ../tasks/AlgorithmicColorRamp ../tasks/MultipartColorRamp ../Color ./colorUtils".split(" "),
function(F,m,a,D,z,y,r){function q(t){if(null==t||"algorithmic"!==t.type&&!t.fromColor)return t;var C=t.declaredClass?new D:F.clone(t);C.fromColor=t.toColor;C.toColor=t.fromColor;C.algorithm=t.algorithm;return C}function n(t){if(null==t)return null;if("multipart"===t.type||t.colorRamps&&0<t.colorRamps.length){var C=t.declaredClass?new z:F.clone(t);C.colorRamps=m.map(t.colorRamps.slice().reverse(),function(u){return q(u)});return C}return q(t)}function f(t,C,u){if(!t)return{id:null,isInverted:!1};
var x=t.name;x&&(t.fromColor||t.colorRamps)&&(t.name=void 0);var l=d(t,C,u);if(l)return x&&(t.name=x),{id:l,isInverted:!1};l=d(t,C,u,!0);x&&(t.name=x);return l?{id:l,isInverted:!0}:x&&(l=d(t,C,u))?{id:l,isInverted:!1}:{id:null,isInverted:!1}}function d(t,C,u,x){if(t){x&&(t=n(t));C=C||g;u=u||k;var l=null;x=t.declaredClass;var v,A;if((v="string"===typeof t?t:t.name)&&m.some(u,function(B){if(B.name===v)return l=B.id,!0})&&l)return l;"esri.tasks.AlgorithmicColorRamp"===x?m.some(C,function(B){if(b(t.fromColor.toRgb(),
B.fromColor)&&b(t.toColor.toRgb(),B.toColor))return l=B.id,!0},this):"esri.tasks.MultipartColorRamp"===x&&m.some(C,function(B){if(t.colorRamps&&B.colorRamps&&t.colorRamps.length===B.colorRamps.length&&(A=t.colorRamps,!m.some(B.colorRamps,function(E,G){if(!b(A[G].fromColor.toRgb(),E.fromColor)||!b(A[G].toColor.toRgb(),E.toColor))return!0},this))){if(l)return!0;l=B.id}},this);return l}}function e(t){var C=new D,u=t.algorithm;C.fromColor=y.toDojoColor(t.fromColor);C.toColor=y.toDojoColor(t.toColor);
u?"esriCIELabAlgorithm"===u?C.algorithm="cie-lab":"esriHSVAlgorithm"===u?C.algorithm="hsv":"esriLabLChAlgorithm"===u&&(C.algorithm="lab-lch"):C.algorithm="hsv";return C}function b(t,C){if(!t||!C)return!1;t=t.slice(0,3);C=C.slice(0,3);return!m.some(t,function(u,x){if(u>C[x]+2||u<C[x]-2)return!0})}function c(t,C,u){t=r.toLAB(t);C=r.toLAB(C);return r.toRGB({l:t.l*(1-u)+u*C.l,a:t.a*(1-u)+u*C.a,b:t.b*(1-u)+u*C.b})}var h={},g=[{id:"none",selected:!0},{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,
190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,
255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,
130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"cividis_predefined",type:"multipart",colorRamps:[{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,32,77,255],toColor:[0,33,79,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,33,79,255],toColor:[0,34,80,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,34,
80,255],toColor:[0,35,82,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,35,82,255],toColor:[0,35,84,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,35,84,255],toColor:[0,36,85,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,36,85,255],toColor:[0,37,87,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,37,87,255],toColor:[0,38,89,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,38,89,255],
toColor:[0,38,91,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,38,91,255],toColor:[0,39,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,39,92,255],toColor:[0,40,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,40,94,255],toColor:[0,40,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,40,96,255],toColor:[0,41,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,41,98,255],toColor:[0,
42,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,42,100,255],toColor:[0,42,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,42,101,255],toColor:[0,43,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,43,103,255],toColor:[0,44,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,44,105,255],toColor:[0,45,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,45,107,255],toColor:[0,
45,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,45,109,255],toColor:[0,46,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,46,110,255],toColor:[0,47,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,47,111,255],toColor:[0,47,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,47,112,255],toColor:[0,47,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,47,112,255],toColor:[0,
48,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,48,112,255],toColor:[0,49,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,49,112,255],toColor:[0,49,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,49,112,255],toColor:[0,50,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,50,112,255],toColor:[0,51,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,51,111,255],toColor:[0,
52,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,52,111,255],toColor:[0,52,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,52,111,255],toColor:[0,53,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,53,111,255],toColor:[1,54,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[1,54,111,255],toColor:[6,55,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[6,55,110,255],toColor:[11,
55,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[11,55,110,255],toColor:[15,56,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[15,56,110,255],toColor:[18,57,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[18,57,110,255],toColor:[21,57,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[21,57,110,255],toColor:[24,58,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[24,58,110,255],
toColor:[26,59,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[26,59,109,255],toColor:[29,60,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[29,60,109,255],toColor:[31,60,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,60,109,255],toColor:[33,61,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[33,61,109,255],toColor:[35,62,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[35,
62,109,255],toColor:[37,63,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[37,63,109,255],toColor:[38,63,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[38,63,109,255],toColor:[40,64,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[40,64,108,255],toColor:[42,65,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[42,65,108,255],toColor:[43,65,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[43,65,108,255],toColor:[45,66,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[45,66,108,255],toColor:[46,67,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[46,67,108,255],toColor:[48,68,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[48,68,108,255],toColor:[49,68,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[49,68,108,255],toColor:[51,69,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[51,69,108,255],toColor:[52,70,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[52,70,108,255],toColor:[53,70,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[53,70,108,255],toColor:[55,71,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[55,71,108,255],toColor:[56,72,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[56,72,108,255],toColor:[57,73,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[57,73,108,255],toColor:[58,73,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[58,73,108,255],toColor:[60,74,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[60,74,108,255],toColor:[61,75,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[61,75,108,255],toColor:[62,75,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[62,75,108,255],toColor:[63,76,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[63,76,108,255],toColor:[64,77,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[64,77,108,255],toColor:[65,78,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[65,78,108,255],toColor:[67,78,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[67,78,108,255],toColor:[68,79,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[68,79,108,255],toColor:[69,80,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[69,80,108,255],toColor:[70,80,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,80,108,255],toColor:[71,81,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,81,108,255],toColor:[72,82,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,82,108,255],toColor:[73,83,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[73,83,108,255],toColor:[74,83,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[74,83,108,255],toColor:[75,84,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[75,84,108,255],toColor:[76,85,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[76,85,108,255],toColor:[77,86,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[77,86,108,255],toColor:[78,86,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[78,86,108,255],toColor:[79,87,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[79,87,108,255],toColor:[80,88,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[80,88,108,255],toColor:[81,88,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[81,88,109,255],toColor:[82,89,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[82,89,109,255],toColor:[83,90,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[83,90,109,255],toColor:[84,91,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[84,91,109,255],toColor:[85,91,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[85,91,109,255],toColor:[86,92,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[86,92,109,255],toColor:[87,93,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[87,93,109,255],toColor:[88,93,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[88,93,109,255],toColor:[89,94,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[89,94,110,255],toColor:[90,95,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[90,95,110,255],toColor:[91,96,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[91,96,110,255],toColor:[92,96,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[92,96,110,255],toColor:[93,97,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[93,97,110,255],toColor:[94,98,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[94,98,110,255],toColor:[94,99,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[94,99,111,255],toColor:[95,99,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[95,99,111,255],toColor:[96,100,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[96,100,111,255],toColor:[97,101,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[97,101,111,255],toColor:[98,101,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[98,101,111,255],toColor:[99,102,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[99,102,112,255],toColor:[100,103,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[100,103,112,255],toColor:[101,104,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[101,104,112,255],toColor:[102,104,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[102,104,112,255],toColor:[103,105,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[103,105,113,255],toColor:[104,106,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[104,106,113,255],toColor:[104,107,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[104,107,113,255],toColor:[105,107,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[105,107,113,255],toColor:[106,108,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[106,108,114,255],toColor:[107,109,114,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[107,109,114,255],toColor:[108,109,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[108,109,114,255],toColor:[109,110,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[109,110,115,255],toColor:[110,111,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[110,111,115,255],toColor:[111,112,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[111,112,115,255],toColor:[111,
112,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[111,112,115,255],toColor:[112,113,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[112,113,116,255],toColor:[113,114,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[113,114,116,255],toColor:[114,115,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[114,115,116,255],toColor:[115,115,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[115,
115,117,255],toColor:[116,116,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[116,116,117,255],toColor:[117,117,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[117,117,117,255],toColor:[117,118,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[117,118,118,255],toColor:[118,118,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[118,118,118,255],toColor:[119,119,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[119,119,119,255],toColor:[120,120,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[120,120,119,255],toColor:[121,121,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[121,121,119,255],toColor:[122,121,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[122,121,120,255],toColor:[123,122,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[123,122,120,255],toColor:[124,123,120,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[124,123,120,255],toColor:[124,124,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[124,124,121,255],toColor:[125,124,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[125,124,121,255],toColor:[126,125,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[126,125,121,255],toColor:[127,126,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[127,126,121,255],toColor:[128,
127,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[128,127,121,255],toColor:[129,127,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[129,127,121,255],toColor:[130,128,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[130,128,121,255],toColor:[131,129,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[131,129,121,255],toColor:[132,130,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[132,
130,121,255],toColor:[133,130,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[133,130,121,255],toColor:[134,131,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[134,131,121,255],toColor:[135,132,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[135,132,121,255],toColor:[136,133,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[136,133,121,255],toColor:[137,134,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[137,134,121,255],toColor:[138,134,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[138,134,121,255],toColor:[139,135,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[139,135,121,255],toColor:[140,136,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[140,136,121,255],toColor:[141,137,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[141,137,121,255],toColor:[142,137,121,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[142,137,121,255],toColor:[143,138,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[143,138,121,255],toColor:[144,139,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[144,139,121,255],toColor:[145,140,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[145,140,121,255],toColor:[146,141,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[146,141,121,255],toColor:[147,
141,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[147,141,121,255],toColor:[148,142,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[148,142,121,255],toColor:[149,143,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[149,143,121,255],toColor:[150,144,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[150,144,121,255],toColor:[151,145,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[151,
145,120,255],toColor:[152,145,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[152,145,120,255],toColor:[153,146,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[153,146,120,255],toColor:[154,147,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[154,147,120,255],toColor:[155,148,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[155,148,120,255],toColor:[156,149,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[156,149,120,255],toColor:[157,149,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[157,149,120,255],toColor:[158,150,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[158,150,120,255],toColor:[159,151,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[159,151,119,255],toColor:[160,152,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[160,152,119,255],toColor:[161,153,119,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[161,153,119,255],toColor:[162,153,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[162,153,119,255],toColor:[163,154,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[163,154,119,255],toColor:[164,155,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[164,155,118,255],toColor:[165,156,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[165,156,118,255],toColor:[166,
157,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[166,157,118,255],toColor:[167,158,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[167,158,118,255],toColor:[168,158,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[168,158,118,255],toColor:[169,159,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[169,159,117,255],toColor:[170,160,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[170,
160,117,255],toColor:[171,161,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[171,161,117,255],toColor:[172,162,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[172,162,117,255],toColor:[173,162,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[173,162,116,255],toColor:[174,163,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[174,163,116,255],toColor:[175,164,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[175,164,116,255],toColor:[177,165,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[177,165,115,255],toColor:[178,166,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[178,166,115,255],toColor:[179,167,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[179,167,115,255],toColor:[180,168,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[180,168,115,255],toColor:[181,168,114,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[181,168,114,255],toColor:[182,169,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[182,169,114,255],toColor:[183,170,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[183,170,114,255],toColor:[184,171,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[184,171,113,255],toColor:[185,172,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[185,172,113,255],toColor:[186,
173,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[186,173,113,255],toColor:[187,173,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[187,173,112,255],toColor:[188,174,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[188,174,112,255],toColor:[189,175,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[189,175,111,255],toColor:[190,176,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[190,
176,111,255],toColor:[191,177,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[191,177,111,255],toColor:[192,178,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[192,178,110,255],toColor:[194,179,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[194,179,110,255],toColor:[195,180,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[195,180,109,255],toColor:[196,180,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[196,180,109,255],toColor:[197,181,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[197,181,109,255],toColor:[198,182,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[198,182,108,255],toColor:[199,183,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[199,183,108,255],toColor:[200,184,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[200,184,107,255],toColor:[201,185,107,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[201,185,107,255],toColor:[202,186,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[202,186,106,255],toColor:[203,187,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[203,187,106,255],toColor:[204,187,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[204,187,105,255],toColor:[205,188,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[205,188,105,255],toColor:[207,
189,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[207,189,104,255],toColor:[208,190,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[208,190,104,255],toColor:[209,191,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[209,191,103,255],toColor:[210,192,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[210,192,103,255],toColor:[211,193,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[211,
193,102,255],toColor:[212,194,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[212,194,101,255],toColor:[213,195,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[213,195,101,255],toColor:[214,196,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[214,196,100,255],toColor:[215,196,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[215,196,100,255],toColor:[217,197,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[217,197,99,255],toColor:[218,198,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[218,198,98,255],toColor:[219,199,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[219,199,98,255],toColor:[220,200,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[220,200,97,255],toColor:[221,201,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[221,201,96,255],toColor:[222,202,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[222,202,96,255],toColor:[223,203,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[223,203,95,255],toColor:[224,204,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[224,204,94,255],toColor:[226,205,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[226,205,94,255],toColor:[227,206,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[227,206,93,255],toColor:[228,207,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[228,207,92,255],toColor:[229,208,91,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[229,208,91,255],toColor:[230,209,91,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[230,209,91,255],toColor:[231,209,90,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[231,209,90,255],toColor:[233,210,89,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[233,210,89,255],toColor:[234,211,88,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[234,211,88,255],toColor:[235,212,87,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[235,212,87,255],toColor:[236,213,86,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[236,213,86,255],toColor:[237,214,86,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[237,214,86,255],toColor:[238,215,85,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[238,215,85,255],toColor:[239,216,84,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[239,216,84,255],toColor:[241,217,83,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[241,217,83,255],toColor:[242,218,82,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,218,82,255],toColor:[243,219,81,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,219,81,255],toColor:[244,220,80,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,220,80,255],toColor:[245,221,79,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[245,221,79,255],toColor:[246,222,78,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[246,222,78,255],toColor:[248,223,77,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,223,77,255],toColor:[249,224,75,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,224,75,255],toColor:[250,225,74,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,225,74,255],toColor:[251,226,73,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[251,226,73,255],toColor:[252,227,72,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,227,72,255],toColor:[254,228,71,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,228,71,255],toColor:[255,229,69,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,229,69,255],toColor:[255,230,68,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,230,68,255],toColor:[255,231,67,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[255,231,67,255],toColor:[255,232,66,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,232,66,255],toColor:[255,233,67,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,233,67,255],toColor:[255,234,69,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,234,69,255],toColor:[255,235,70,255]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,
117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,
131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",
colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",
fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"inferno_predefined",type:"multipart",colorRamps:[{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,0,4,255],toColor:[1,0,5,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[1,0,5,255],toColor:[1,
1,6,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[1,1,6,255],toColor:[1,1,8,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[1,1,8,255],toColor:[2,1,10,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[2,1,10,255],toColor:[2,2,12,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[2,2,12,255],toColor:[2,2,14,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[2,2,14,255],toColor:[3,2,16,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[3,2,16,255],toColor:[4,3,18,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[4,3,18,255],toColor:[4,3,21,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[4,3,21,255],toColor:[5,4,23,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[5,4,23,255],toColor:[6,4,25,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[6,4,25,255],toColor:[7,5,27,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[7,5,27,255],toColor:[8,6,29,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[8,6,29,255],toColor:[9,6,32,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[9,6,32,255],toColor:[10,7,34,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[10,7,34,255],toColor:[11,7,36,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[11,7,36,255],toColor:[12,8,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[12,
8,38,255],toColor:[13,8,41,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[13,8,41,255],toColor:[14,9,43,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[14,9,43,255],toColor:[16,9,45,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[16,9,45,255],toColor:[17,10,48,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[17,10,48,255],toColor:[18,10,50,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[18,10,
50,255],toColor:[20,11,53,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[20,11,53,255],toColor:[21,11,55,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[21,11,55,255],toColor:[22,11,58,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[22,11,58,255],toColor:[24,12,60,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[24,12,60,255],toColor:[25,12,62,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[25,
12,62,255],toColor:[27,12,65,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[27,12,65,255],toColor:[28,12,67,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[28,12,67,255],toColor:[30,12,70,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[30,12,70,255],toColor:[31,12,72,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,12,72,255],toColor:[33,12,74,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[33,
12,74,255],toColor:[35,12,77,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[35,12,77,255],toColor:[36,12,79,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[36,12,79,255],toColor:[38,12,81,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[38,12,81,255],toColor:[40,11,83,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[40,11,83,255],toColor:[42,11,85,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[42,
11,85,255],toColor:[43,11,87,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[43,11,87,255],toColor:[45,11,89,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[45,11,89,255],toColor:[47,10,91,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[47,10,91,255],toColor:[49,10,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[49,10,93,255],toColor:[51,10,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[51,
10,94,255],toColor:[52,10,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[52,10,96,255],toColor:[54,9,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[54,9,97,255],toColor:[56,9,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[56,9,98,255],toColor:[58,9,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[58,9,99,255],toColor:[59,9,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[59,9,
100,255],toColor:[61,9,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[61,9,101,255],toColor:[63,9,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[63,9,102,255],toColor:[64,10,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[64,10,103,255],toColor:[66,10,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[66,10,104,255],toColor:[68,10,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[68,
10,105,255],toColor:[69,10,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[69,10,105,255],toColor:[71,11,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,11,106,255],toColor:[73,11,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[73,11,107,255],toColor:[74,12,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[74,12,107,255],toColor:[76,12,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[76,12,108,255],toColor:[78,13,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[78,13,108,255],toColor:[79,13,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[79,13,108,255],toColor:[81,14,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[81,14,109,255],toColor:[83,14,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[83,14,109,255],toColor:[84,15,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[84,15,109,255],toColor:[86,15,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[86,15,110,255],toColor:[87,16,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[87,16,110,255],toColor:[89,17,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[89,17,110,255],toColor:[91,17,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[91,17,110,255],toColor:[92,18,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[92,18,110,255],toColor:[94,18,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[94,18,111,255],toColor:[95,19,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[95,19,111,255],toColor:[97,20,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[97,20,111,255],toColor:[99,20,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[99,20,111,255],toColor:[100,21,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[100,21,111,255],toColor:[102,21,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[102,21,111,255],toColor:[103,22,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[103,22,111,255],toColor:[105,23,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[105,23,111,255],toColor:[107,23,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[107,23,111,255],toColor:[108,24,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[108,24,111,255],toColor:[110,24,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[110,24,111,255],toColor:[111,25,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[111,25,111,255],toColor:[113,25,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[113,25,110,255],toColor:[115,26,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[115,26,110,255],toColor:[116,27,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[116,27,110,255],toColor:[118,27,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[118,27,110,255],toColor:[119,28,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[119,28,110,255],toColor:[121,28,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[121,28,110,255],toColor:[123,29,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[123,29,109,255],toColor:[124,29,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[124,29,109,255],toColor:[126,30,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[126,30,109,255],toColor:[127,31,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[127,31,109,255],toColor:[129,31,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[129,31,108,255],toColor:[130,32,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[130,32,108,255],toColor:[132,32,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[132,32,108,255],toColor:[134,33,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[134,33,107,255],toColor:[135,33,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[135,33,107,255],toColor:[137,34,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[137,34,107,255],toColor:[138,34,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[138,34,106,255],toColor:[140,35,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[140,35,106,255],toColor:[142,36,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[142,36,105,255],toColor:[143,36,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[143,36,105,255],toColor:[145,37,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[145,37,105,255],toColor:[146,37,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[146,37,104,255],toColor:[148,38,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[148,38,104,255],toColor:[150,38,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[150,38,103,255],toColor:[151,39,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[151,39,102,255],toColor:[153,40,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[153,40,102,255],toColor:[154,40,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[154,40,101,255],toColor:[156,41,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[156,41,101,255],toColor:[158,41,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[158,41,100,255],toColor:[159,42,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[159,42,100,255],toColor:[161,43,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[161,43,99,255],toColor:[162,43,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[162,43,98,255],toColor:[164,44,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[164,44,98,255],toColor:[165,45,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[165,45,97,255],toColor:[167,45,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[167,45,96,255],toColor:[169,46,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[169,46,95,255],toColor:[170,46,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[170,46,95,255],toColor:[172,47,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[172,47,94,255],toColor:[173,48,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[173,48,93,255],toColor:[175,49,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[175,49,92,255],toColor:[176,49,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[176,49,92,255],toColor:[178,50,91,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[178,50,91,255],toColor:[179,51,90,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[179,51,90,255],toColor:[181,51,89,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[181,51,89,255],toColor:[182,52,88,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[182,52,88,255],toColor:[184,53,87,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[184,53,87,255],toColor:[185,54,86,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[185,54,86,255],toColor:[187,54,85,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[187,54,85,255],toColor:[188,55,85,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[188,55,85,255],toColor:[190,56,84,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[190,56,84,255],toColor:[191,57,83,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[191,57,83,255],toColor:[193,58,82,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[193,58,82,255],toColor:[194,59,81,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[194,59,81,255],toColor:[196,60,80,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[196,60,80,255],toColor:[197,60,79,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[197,60,79,255],toColor:[198,61,78,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[198,61,78,255],toColor:[200,62,77,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[200,62,77,255],toColor:[201,63,76,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[201,63,76,255],toColor:[203,64,75,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[203,64,75,255],toColor:[204,65,74,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[204,65,74,255],toColor:[205,66,72,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[205,66,72,255],toColor:[207,67,71,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[207,67,71,255],toColor:[208,68,70,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[208,68,70,255],toColor:[209,69,69,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[209,69,69,255],toColor:[211,70,68,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[211,70,68,255],toColor:[212,72,67,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[212,72,67,255],toColor:[213,73,66,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[213,73,66,255],toColor:[214,74,65,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[214,74,65,255],toColor:[216,75,64,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[216,75,64,255],toColor:[217,76,62,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[217,76,62,255],toColor:[218,77,61,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[218,77,61,255],toColor:[219,79,60,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[219,79,60,255],toColor:[220,80,59,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[220,80,59,255],toColor:[221,81,58,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[221,81,58,255],toColor:[223,82,57,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[223,82,57,255],toColor:[224,84,56,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[224,84,56,255],toColor:[225,85,54,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[225,85,54,255],toColor:[226,86,53,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[226,86,53,255],toColor:[227,88,52,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[227,88,52,255],toColor:[228,89,51,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[228,89,51,255],toColor:[229,90,50,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[229,90,50,255],toColor:[230,92,48,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[230,92,48,255],toColor:[231,93,47,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[231,93,47,255],toColor:[232,95,46,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[232,95,46,255],toColor:[233,96,45,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[233,96,45,255],toColor:[234,98,43,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[234,98,43,255],toColor:[235,99,42,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[235,99,42,255],toColor:[235,101,41,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[235,101,41,255],toColor:[236,102,40,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[236,102,40,255],toColor:[237,104,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[237,104,38,255],toColor:[238,105,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[238,105,37,255],toColor:[239,107,36,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[239,107,36,255],toColor:[240,109,35,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[240,109,35,255],toColor:[240,110,33,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[240,110,33,255],toColor:[241,112,32,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[241,112,32,255],toColor:[242,113,31,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,113,31,255],toColor:[242,115,30,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,115,30,255],toColor:[243,117,28,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[243,117,28,255],toColor:[244,118,27,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,118,27,255],toColor:[244,120,26,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,120,26,255],toColor:[245,122,24,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,122,24,255],toColor:[246,123,23,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[246,123,23,255],toColor:[246,125,22,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[246,125,22,255],toColor:[247,127,20,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,127,20,255],toColor:[247,129,19,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,129,19,255],toColor:[248,130,18,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,130,18,255],toColor:[248,132,16,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,132,16,255],toColor:[249,134,15,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[249,134,15,255],toColor:[249,136,14,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,136,14,255],toColor:[249,137,12,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,137,12,255],toColor:[250,139,11,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,139,11,255],toColor:[250,141,10,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,141,10,255],toColor:[250,143,9,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[250,143,9,255],toColor:[251,145,8,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,145,8,255],toColor:[251,146,7,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,146,7,255],toColor:[251,148,7,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,148,7,255],toColor:[252,150,6,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,150,6,255],toColor:[252,152,6,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[252,152,6,255],toColor:[252,154,6,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,154,6,255],toColor:[252,156,6,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,156,6,255],toColor:[252,158,7,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,158,7,255],toColor:[253,160,7,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,160,7,255],toColor:[253,161,8,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[253,161,8,255],toColor:[253,163,9,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,163,9,255],toColor:[253,165,10,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,165,10,255],toColor:[253,167,12,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,167,12,255],toColor:[253,169,13,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,169,13,255],toColor:[253,171,15,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[253,171,15,255],toColor:[253,173,17,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,173,17,255],toColor:[253,175,19,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,175,19,255],toColor:[253,177,20,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,177,20,255],toColor:[253,179,22,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,179,22,255],toColor:[253,181,25,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[253,181,25,255],toColor:[252,183,27,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,183,27,255],toColor:[252,185,29,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,185,29,255],toColor:[252,186,31,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,186,31,255],toColor:[252,188,33,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,188,33,255],toColor:[252,190,35,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[252,190,35,255],toColor:[251,192,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,192,38,255],toColor:[251,194,40,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,194,40,255],toColor:[251,196,43,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,196,43,255],toColor:[251,198,45,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,198,45,255],toColor:[250,200,48,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[250,200,48,255],toColor:[250,202,50,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,202,50,255],toColor:[250,204,53,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,204,53,255],toColor:[249,206,56,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,206,56,255],toColor:[249,208,58,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,208,58,255],toColor:[248,210,61,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[248,210,61,255],toColor:[248,212,64,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,212,64,255],toColor:[247,214,67,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,214,67,255],toColor:[247,216,70,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,216,70,255],toColor:[246,218,73,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[246,218,73,255],toColor:[246,220,76,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[246,220,76,255],toColor:[245,222,80,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,222,80,255],toColor:[245,224,83,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,224,83,255],toColor:[244,226,86,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,226,86,255],toColor:[244,228,90,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,228,90,255],toColor:[244,229,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[244,229,94,255],toColor:[243,231,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,231,97,255],toColor:[243,233,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,233,101,255],toColor:[243,235,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,235,105,255],toColor:[242,237,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,237,109,255],toColor:[242,238,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[242,238,113,255],toColor:[242,240,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,240,117,255],toColor:[242,242,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,242,122,255],toColor:[243,243,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,243,126,255],toColor:[243,245,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,245,130,255],toColor:[244,246,134,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[244,246,134,255],toColor:[244,247,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,247,138,255],toColor:[245,249,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,249,142,255],toColor:[246,250,146,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[246,250,146,255],toColor:[247,251,150,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,251,150,255],toColor:[249,
252,154,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,252,154,255],toColor:[250,253,158,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,253,158,255],toColor:[251,254,162,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,254,162,255],toColor:[253,255,165,255]}]},{id:"magma_predefined",type:"multipart",colorRamps:[{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[0,0,4,255],toColor:[1,0,5,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[1,0,5,255],toColor:[1,1,6,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[1,1,6,255],toColor:[1,1,8,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[1,1,8,255],toColor:[2,1,10,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[2,1,10,255],toColor:[2,2,12,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[2,2,12,255],toColor:[2,2,14,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[2,2,14,255],toColor:[3,3,16,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[3,3,16,255],toColor:[4,3,18,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[4,3,18,255],toColor:[4,4,20,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[4,4,20,255],toColor:[5,4,22,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[5,4,22,255],toColor:[6,5,24,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[6,5,24,
255],toColor:[6,5,26,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[6,5,26,255],toColor:[7,6,28,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[7,6,28,255],toColor:[8,7,30,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[8,7,30,255],toColor:[9,7,32,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[9,7,32,255],toColor:[10,8,34,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[10,8,34,255],toColor:[11,
9,36,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[11,9,36,255],toColor:[12,9,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[12,9,38,255],toColor:[13,10,41,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[13,10,41,255],toColor:[14,11,43,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[14,11,43,255],toColor:[16,11,45,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[16,11,45,255],toColor:[17,
12,47,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[17,12,47,255],toColor:[18,13,50,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[18,13,50,255],toColor:[19,13,52,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[19,13,52,255],toColor:[20,14,54,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[20,14,54,255],toColor:[21,14,57,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[21,14,57,255],toColor:[23,
15,59,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[23,15,59,255],toColor:[24,15,61,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[24,15,61,255],toColor:[25,16,64,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[25,16,64,255],toColor:[26,16,66,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[26,16,66,255],toColor:[28,16,68,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[28,16,68,255],toColor:[29,
17,71,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[29,17,71,255],toColor:[30,17,73,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[30,17,73,255],toColor:[32,17,76,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[32,17,76,255],toColor:[33,17,78,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[33,17,78,255],toColor:[35,18,81,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[35,18,81,255],toColor:[36,
18,83,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[36,18,83,255],toColor:[38,18,86,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[38,18,86,255],toColor:[39,18,88,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[39,18,88,255],toColor:[41,18,90,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[41,18,90,255],toColor:[42,17,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[42,17,93,255],toColor:[44,
17,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[44,17,95,255],toColor:[46,17,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[46,17,97,255],toColor:[47,17,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[47,17,99,255],toColor:[49,17,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[49,17,101,255],toColor:[51,16,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[51,16,103,255],toColor:[52,
16,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[52,16,105,255],toColor:[54,16,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[54,16,107,255],toColor:[56,16,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[56,16,109,255],toColor:[58,15,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[58,15,111,255],toColor:[59,15,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[59,15,112,255],
toColor:[61,15,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[61,15,113,255],toColor:[63,15,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[63,15,115,255],toColor:[65,15,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[65,15,116,255],toColor:[66,15,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[66,15,117,255],toColor:[68,15,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[68,
15,118,255],toColor:[70,16,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,16,119,255],toColor:[71,16,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,16,120,255],toColor:[73,16,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[73,16,121,255],toColor:[75,17,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[75,17,122,255],toColor:[76,17,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[76,17,122,255],toColor:[78,17,123,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[78,17,123,255],toColor:[79,18,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[79,18,124,255],toColor:[81,18,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[81,18,124,255],toColor:[83,19,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[83,19,125,255],toColor:[84,19,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[84,19,125,255],toColor:[86,20,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[86,20,126,255],toColor:[87,21,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[87,21,126,255],toColor:[89,21,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[89,21,126,255],toColor:[91,22,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[91,22,127,255],toColor:[92,22,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[92,22,127,255],toColor:[94,23,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[94,23,127,255],toColor:[95,24,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[95,24,128,255],toColor:[97,24,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[97,24,128,255],toColor:[98,25,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[98,25,128,255],toColor:[100,26,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[100,26,128,255],toColor:[101,26,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[101,26,129,255],toColor:[103,27,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[103,27,129,255],toColor:[105,28,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[105,28,129,255],toColor:[106,28,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[106,28,129,255],toColor:[108,29,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[108,29,129,255],toColor:[109,30,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[109,30,129,255],toColor:[111,30,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[111,30,130,255],toColor:[112,31,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[112,31,130,255],toColor:[114,31,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[114,31,130,255],toColor:[116,32,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[116,32,130,255],toColor:[117,33,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[117,33,130,255],toColor:[119,33,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[119,33,130,255],toColor:[120,34,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[120,34,130,255],toColor:[122,34,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[122,34,130,255],toColor:[123,35,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[123,35,130,255],toColor:[125,36,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[125,36,130,255],toColor:[127,36,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[127,36,130,255],toColor:[128,37,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[128,37,130,255],toColor:[130,37,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[130,37,130,255],toColor:[131,38,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[131,38,130,255],toColor:[133,39,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[133,39,130,255],toColor:[134,39,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[134,39,130,255],toColor:[136,40,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[136,40,130,255],toColor:[138,40,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[138,40,130,255],toColor:[139,41,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[139,41,130,255],toColor:[141,41,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[141,41,129,255],toColor:[142,42,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[142,42,129,255],toColor:[144,42,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[144,42,129,255],toColor:[146,43,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[146,43,129,255],toColor:[147,43,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[147,43,129,255],toColor:[149,44,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[149,44,129,255],toColor:[151,44,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[151,44,129,255],toColor:[152,45,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[152,45,128,255],toColor:[154,46,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[154,46,128,255],toColor:[155,46,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[155,46,128,255],toColor:[157,47,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[157,47,128,255],toColor:[159,47,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[159,47,127,255],toColor:[160,48,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[160,48,127,255],toColor:[162,48,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[162,48,127,255],toColor:[164,49,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[164,49,127,255],toColor:[165,49,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[165,49,126,255],toColor:[167,50,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[167,50,126,255],toColor:[169,50,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[169,50,126,255],toColor:[170,51,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[170,51,125,255],toColor:[172,51,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[172,51,125,255],toColor:[174,52,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[174,52,124,255],toColor:[175,52,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[175,52,124,255],toColor:[177,53,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[177,53,124,255],toColor:[178,53,123,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[178,53,123,255],toColor:[180,54,123,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[180,54,123,255],toColor:[182,54,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[182,54,122,255],toColor:[183,55,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[183,55,122,255],toColor:[185,56,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[185,56,121,255],toColor:[187,56,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[187,56,121,255],toColor:[188,57,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[188,57,120,255],toColor:[190,57,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[190,57,120,255],toColor:[192,58,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[192,58,119,255],toColor:[193,59,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[193,59,118,255],toColor:[195,59,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[195,59,118,255],toColor:[196,60,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[196,60,117,255],toColor:[198,60,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[198,60,117,255],toColor:[200,61,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[200,61,116,255],toColor:[201,62,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[201,62,115,255],toColor:[203,63,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[203,63,115,255],toColor:[204,63,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[204,63,114,255],toColor:[206,64,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[206,64,113,255],toColor:[208,65,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[208,65,112,255],toColor:[209,66,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[209,66,112,255],toColor:[211,66,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[211,66,111,255],toColor:[212,67,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[212,67,110,255],toColor:[214,68,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[214,68,109,255],toColor:[215,69,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[215,69,109,255],toColor:[217,70,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[217,70,108,255],toColor:[218,71,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[218,71,107,255],toColor:[220,72,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[220,72,106,255],toColor:[221,73,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[221,73,106,255],toColor:[222,74,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[222,74,105,255],toColor:[224,75,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[224,75,104,255],toColor:[225,76,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[225,76,103,255],toColor:[226,77,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[226,77,102,255],toColor:[228,78,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[228,78,102,255],toColor:[229,79,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[229,79,101,255],toColor:[230,81,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[230,81,100,255],toColor:[231,82,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[231,82,99,255],toColor:[233,83,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[233,83,99,255],toColor:[234,84,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[234,84,98,255],toColor:[235,86,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[235,86,97,255],toColor:[236,87,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[236,87,97,255],toColor:[237,89,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[237,89,96,255],toColor:[238,90,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[238,90,95,255],toColor:[239,92,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[239,92,95,255],toColor:[240,93,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[240,93,94,255],toColor:[241,95,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[241,95,94,255],toColor:[242,97,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,97,93,255],toColor:[242,98,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[242,98,93,255],toColor:[243,100,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,100,93,255],toColor:[244,102,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,102,93,255],toColor:[245,104,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,104,92,255],toColor:[245,105,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,105,92,255],toColor:[246,107,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[246,107,92,255],toColor:[247,109,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,109,92,255],toColor:[247,111,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,111,92,255],toColor:[248,113,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,113,92,255],toColor:[248,114,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,114,92,255],toColor:[249,116,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[249,116,92,255],toColor:[249,118,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,118,93,255],toColor:[250,120,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,120,93,255],toColor:[250,122,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,122,93,255],toColor:[250,124,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,124,94,255],toColor:[251,126,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[251,126,94,255],toColor:[251,128,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,128,95,255],toColor:[251,130,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,130,95,255],toColor:[252,131,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,131,96,255],toColor:[252,133,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,133,96,255],toColor:[252,135,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[252,135,97,255],toColor:[253,137,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,137,98,255],toColor:[253,139,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,139,99,255],toColor:[253,141,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,141,99,255],toColor:[253,143,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,143,100,255],toColor:[253,145,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[253,145,101,255],toColor:[254,147,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,147,102,255],toColor:[254,149,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,149,103,255],toColor:[254,150,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,150,104,255],toColor:[254,152,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,152,105,255],toColor:[254,154,106,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[254,154,106,255],toColor:[254,156,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,156,107,255],toColor:[255,158,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,158,108,255],toColor:[255,160,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,160,109,255],toColor:[255,162,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,162,111,255],toColor:[255,
164,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,164,112,255],toColor:[255,165,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,165,113,255],toColor:[255,167,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,167,114,255],toColor:[255,169,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,169,116,255],toColor:[255,171,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,
171,117,255],toColor:[255,173,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,173,118,255],toColor:[255,175,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,175,119,255],toColor:[255,177,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,177,121,255],toColor:[255,179,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,179,122,255],toColor:[255,180,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[255,180,124,255],toColor:[255,182,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,182,125,255],toColor:[255,184,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,184,126,255],toColor:[255,186,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,186,128,255],toColor:[255,188,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,188,129,255],toColor:[255,190,131,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[255,190,131,255],toColor:[255,191,132,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,191,132,255],toColor:[255,193,134,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,193,134,255],toColor:[255,195,135,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,195,135,255],toColor:[255,197,137,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,197,137,255],toColor:[255,
199,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,199,139,255],toColor:[255,201,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,201,140,255],toColor:[255,203,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,203,142,255],toColor:[255,204,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,204,143,255],toColor:[255,206,145,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,
206,145,255],toColor:[255,208,147,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,208,147,255],toColor:[255,210,148,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,210,148,255],toColor:[255,212,150,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,212,150,255],toColor:[255,214,152,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,214,152,255],toColor:[255,215,153,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[255,215,153,255],toColor:[255,217,155,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,217,155,255],toColor:[254,219,157,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,219,157,255],toColor:[254,221,159,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,221,159,255],toColor:[254,223,160,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,223,160,255],toColor:[254,225,162,255]},{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:[254,225,162,255],toColor:[254,226,164,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,226,164,255],toColor:[254,228,166,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,228,166,255],toColor:[254,230,167,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,230,167,255],toColor:[254,232,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,232,169,255],toColor:[254,
234,171,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,234,171,255],toColor:[254,236,173,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,236,173,255],toColor:[253,237,175,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,237,175,255],toColor:[253,239,177,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,239,177,255],toColor:[253,241,179,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,
241,179,255],toColor:[253,243,180,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,243,180,255],toColor:[253,245,182,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,245,182,255],toColor:[253,247,184,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,247,184,255],toColor:[253,248,186,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,248,186,255],toColor:[253,250,188,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[253,250,188,255],toColor:[253,252,190,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,252,190,255],toColor:[253,254,192,255]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,
7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,
63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"plasma_predefined",type:"multipart",colorRamps:[{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[13,8,135,255],toColor:[16,7,136,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[16,7,136,255],toColor:[19,7,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[19,7,138,255],toColor:[22,7,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[22,7,139,255],toColor:[25,6,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[25,6,140,255],toColor:[27,6,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[27,6,141,255],toColor:[29,6,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[29,6,142,255],toColor:[32,6,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[32,6,143,255],toColor:[34,6,144,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[34,6,144,255],toColor:[36,6,145,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[36,6,145,255],toColor:[38,5,146,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[38,5,146,255],toColor:[40,5,147,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[40,5,147,255],toColor:[42,5,148,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[42,5,148,255],toColor:[44,5,149,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[44,5,149,255],toColor:[46,5,150,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[46,5,150,255],toColor:[48,5,150,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[48,5,150,255],toColor:[50,5,151,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[50,5,151,255],toColor:[51,5,152,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[51,5,152,255],toColor:[53,4,153,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[53,4,153,255],toColor:[55,4,153,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[55,4,153,255],toColor:[57,4,154,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[57,4,154,255],toColor:[58,4,155,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[58,4,155,255],toColor:[60,4,156,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[60,4,156,255],toColor:[62,4,156,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[62,4,156,255],toColor:[64,4,157,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[64,4,157,255],toColor:[65,4,158,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[65,4,158,255],toColor:[67,3,158,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[67,3,158,255],toColor:[69,3,159,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[69,3,159,255],toColor:[70,3,159,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,3,159,255],toColor:[72,3,160,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,3,160,255],toColor:[73,3,161,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[73,3,161,255],toColor:[75,3,161,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[75,3,161,255],toColor:[77,2,162,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[77,2,162,255],toColor:[78,2,162,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[78,2,162,255],toColor:[80,2,163,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[80,2,163,255],toColor:[82,2,163,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[82,2,163,255],toColor:[83,2,164,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[83,2,164,255],toColor:[85,2,164,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[85,2,164,255],toColor:[86,1,165,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[86,1,165,255],toColor:[88,1,165,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[88,1,165,255],toColor:[90,1,165,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[90,1,165,255],toColor:[91,1,166,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[91,1,166,255],toColor:[93,1,166,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[93,1,166,255],toColor:[94,1,167,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[94,1,167,255],toColor:[96,1,167,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[96,1,167,255],toColor:[98,0,167,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[98,0,167,255],toColor:[99,0,167,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[99,0,167,255],toColor:[101,0,168,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[101,0,168,255],toColor:[102,0,168,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[102,0,168,255],toColor:[104,0,168,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[104,0,168,255],toColor:[105,0,168,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[105,0,168,255],toColor:[107,0,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[107,0,169,255],toColor:[108,0,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[108,0,169,255],toColor:[110,0,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[110,0,169,255],toColor:[112,0,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[112,0,169,255],toColor:[113,0,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[113,0,169,255],toColor:[115,1,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[115,1,169,255],toColor:[116,1,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[116,1,169,255],toColor:[118,1,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[118,1,169,255],toColor:[119,1,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[119,1,169,255],toColor:[121,1,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[121,1,169,255],toColor:[122,2,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[122,2,169,255],toColor:[124,2,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[124,2,169,255],toColor:[125,3,169,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[125,3,169,255],toColor:[127,3,168,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[127,3,168,255],toColor:[128,4,168,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[128,4,168,255],toColor:[130,4,168,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[130,4,168,255],toColor:[131,5,168,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[131,5,168,255],toColor:[133,6,167,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[133,6,167,255],toColor:[134,6,167,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[134,6,167,255],toColor:[136,7,167,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[136,7,167,255],toColor:[137,8,166,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[137,8,166,255],toColor:[138,9,166,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[138,9,166,255],toColor:[140,10,166,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[140,10,166,255],toColor:[141,11,165,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[141,11,165,255],toColor:[143,12,165,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[143,12,165,255],toColor:[144,13,164,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[144,13,164,255],toColor:[145,14,164,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[145,14,164,255],toColor:[147,15,163,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[147,15,163,255],toColor:[148,16,163,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[148,16,163,255],toColor:[150,18,162,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[150,18,162,255],toColor:[151,19,161,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[151,19,161,255],toColor:[152,20,161,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[152,20,161,255],toColor:[154,21,160,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[154,21,160,255],toColor:[155,22,159,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[155,22,159,255],toColor:[156,23,159,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[156,23,159,255],toColor:[158,24,158,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[158,24,158,255],toColor:[159,25,157,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[159,25,157,255],toColor:[160,26,156,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[160,26,156,255],toColor:[162,28,156,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[162,28,156,255],toColor:[163,29,155,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[163,29,155,255],toColor:[164,30,154,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[164,30,154,255],toColor:[165,31,153,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[165,31,153,255],toColor:[167,32,152,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[167,32,152,255],toColor:[168,33,152,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[168,33,152,255],toColor:[169,34,151,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[169,34,151,255],toColor:[170,35,150,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[170,35,150,255],toColor:[171,37,149,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[171,37,149,255],toColor:[173,38,148,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[173,38,148,255],toColor:[174,39,147,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[174,39,147,255],toColor:[175,40,146,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[175,40,146,255],toColor:[176,41,145,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[176,41,145,255],toColor:[177,42,145,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[177,42,145,255],toColor:[179,43,144,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[179,43,144,255],toColor:[180,45,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[180,45,143,255],toColor:[181,46,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[181,46,142,255],toColor:[182,47,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[182,47,141,255],toColor:[183,48,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[183,48,140,255],toColor:[184,49,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[184,49,139,255],toColor:[185,50,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[185,50,138,255],toColor:[186,51,137,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[186,51,137,255],toColor:[187,52,136,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[187,52,136,255],toColor:[188,54,135,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[188,54,135,255],toColor:[189,55,134,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[189,55,134,255],toColor:[191,56,133,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[191,56,133,255],toColor:[192,57,132,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[192,57,132,255],toColor:[193,58,131,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[193,58,131,255],toColor:[194,59,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[194,59,130,255],toColor:[195,60,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[195,60,129,255],toColor:[196,62,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[196,62,129,255],toColor:[197,63,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[197,63,128,255],toColor:[198,64,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[198,64,127,255],toColor:[199,65,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[199,65,126,255],toColor:[200,66,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[200,66,125,255],toColor:[201,67,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[201,67,124,255],toColor:[202,68,123,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[202,68,123,255],toColor:[202,69,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[202,69,122,255],toColor:[203,71,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[203,71,121,255],toColor:[204,72,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[204,72,120,255],toColor:[205,73,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[205,73,119,255],toColor:[206,74,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[206,74,118,255],toColor:[207,75,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[207,75,117,255],toColor:[208,76,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[208,76,117,255],toColor:[209,77,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[209,77,116,255],toColor:[210,79,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[210,79,115,255],toColor:[211,80,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[211,80,114,255],toColor:[212,81,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[212,81,113,255],toColor:[212,82,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[212,82,112,255],toColor:[213,83,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[213,83,111,255],toColor:[214,84,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[214,84,110,255],toColor:[215,85,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[215,85,109,255],toColor:[216,87,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[216,87,109,255],toColor:[217,88,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[217,88,108,255],toColor:[218,89,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[218,89,107,255],toColor:[218,90,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[218,90,106,255],toColor:[219,91,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[219,91,105,255],toColor:[220,92,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[220,92,104,255],toColor:[221,93,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[221,93,103,255],toColor:[222,95,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[222,95,102,255],toColor:[223,96,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[223,96,102,255],toColor:[223,97,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[223,97,101,255],toColor:[224,98,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[224,98,100,255],toColor:[225,99,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[225,99,99,255],toColor:[226,100,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[226,100,98,255],toColor:[226,102,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[226,102,97,255],toColor:[227,103,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[227,103,96,255],toColor:[228,104,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[228,104,96,255],toColor:[229,105,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[229,105,95,255],toColor:[229,106,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[229,106,94,255],toColor:[230,108,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[230,108,93,255],toColor:[231,109,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[231,109,92,255],toColor:[232,110,91,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[232,110,91,255],toColor:[232,111,90,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[232,111,90,255],toColor:[233,112,90,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[233,112,90,255],toColor:[234,114,89,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[234,114,89,255],toColor:[234,115,88,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[234,115,88,255],toColor:[235,116,87,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[235,116,87,255],toColor:[236,117,86,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[236,117,86,255],toColor:[236,119,85,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[236,119,85,255],toColor:[237,120,84,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[237,120,84,255],toColor:[238,121,83,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[238,121,83,255],toColor:[238,122,83,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[238,122,83,255],toColor:[239,124,82,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[239,124,82,255],toColor:[240,125,81,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[240,125,81,255],toColor:[240,126,80,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[240,126,80,255],toColor:[241,127,79,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[241,127,79,255],toColor:[241,129,78,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[241,129,78,255],toColor:[242,130,77,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,130,77,255],toColor:[242,131,77,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,131,77,255],toColor:[243,133,76,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,133,76,255],toColor:[244,134,75,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[244,134,75,255],toColor:[244,135,74,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,135,74,255],toColor:[245,136,73,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,136,73,255],toColor:[245,138,72,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,138,72,255],toColor:[246,139,71,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[246,139,71,255],toColor:[246,140,70,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[246,140,70,255],toColor:[247,142,70,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,142,70,255],toColor:[247,143,69,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,143,69,255],toColor:[248,144,68,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,144,68,255],toColor:[248,146,67,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,146,67,255],toColor:[248,147,66,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[248,147,66,255],toColor:[249,149,65,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,149,65,255],toColor:[249,150,64,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,150,64,255],toColor:[250,151,64,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,151,64,255],toColor:[250,153,63,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,153,63,255],toColor:[250,154,62,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[250,154,62,255],toColor:[251,156,61,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,156,61,255],toColor:[251,157,60,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,157,60,255],toColor:[251,158,59,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,158,59,255],toColor:[252,160,58,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,160,58,255],toColor:[252,161,58,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[252,161,58,255],toColor:[252,163,57,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,163,57,255],toColor:[253,164,56,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,164,56,255],toColor:[253,166,55,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,166,55,255],toColor:[253,167,54,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,167,54,255],toColor:[253,168,53,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[253,168,53,255],toColor:[253,170,52,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,170,52,255],toColor:[254,171,52,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,171,52,255],toColor:[254,173,51,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,173,51,255],toColor:[254,174,50,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,174,50,255],toColor:[254,176,49,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[254,176,49,255],toColor:[254,177,48,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,177,48,255],toColor:[254,179,48,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,179,48,255],toColor:[254,180,47,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,180,47,255],toColor:[254,182,46,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,182,46,255],toColor:[255,183,45,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[255,183,45,255],toColor:[255,185,45,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,185,45,255],toColor:[255,187,44,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,187,44,255],toColor:[255,188,43,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,188,43,255],toColor:[255,190,43,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,190,43,255],toColor:[255,191,42,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[255,191,42,255],toColor:[255,193,41,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[255,193,41,255],toColor:[254,194,41,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,194,41,255],toColor:[254,196,40,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,196,40,255],toColor:[254,198,40,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,198,40,255],toColor:[254,199,39,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[254,199,39,255],toColor:[254,201,39,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,201,39,255],toColor:[254,202,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,202,38,255],toColor:[254,204,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[254,204,38,255],toColor:[253,206,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,206,38,255],toColor:[253,207,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[253,207,37,255],toColor:[253,209,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,209,37,255],toColor:[253,211,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[253,211,37,255],toColor:[252,212,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,212,37,255],toColor:[252,214,36,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,214,36,255],toColor:[252,216,36,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[252,216,36,255],toColor:[251,217,36,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,217,36,255],toColor:[251,219,36,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[251,219,36,255],toColor:[250,221,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,221,37,255],toColor:[250,222,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[250,222,37,255],toColor:[249,224,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[249,224,37,255],toColor:[249,226,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,226,37,255],toColor:[248,227,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,227,37,255],toColor:[248,229,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[248,229,38,255],toColor:[247,231,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,231,38,255],toColor:[247,232,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[247,232,38,255],toColor:[246,234,39,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[246,234,39,255],toColor:[246,236,39,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[246,236,39,255],toColor:[245,238,39,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,238,39,255],toColor:[244,239,39,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[244,239,39,255],toColor:[244,241,39,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[244,241,39,255],toColor:[243,243,39,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[243,243,39,255],toColor:[242,245,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,245,38,255],toColor:[242,246,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[242,246,38,255],toColor:[241,248,36,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[241,248,36,255],toColor:[241,250,34,255]}]},{id:"precipitation_predefined",
type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",
type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,
225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,
13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},
{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,
153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],
toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"viridis_predefined",type:"multipart",colorRamps:[{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[68,
1,84,255],toColor:[69,2,86,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[69,2,86,255],toColor:[69,4,87,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[69,4,87,255],toColor:[69,5,89,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[69,5,89,255],toColor:[70,7,90,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,7,90,255],toColor:[70,8,92,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,8,92,255],
toColor:[70,10,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,10,93,255],toColor:[71,11,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,11,95,255],toColor:[71,13,96,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,13,96,255],toColor:[71,14,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,14,98,255],toColor:[71,16,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,16,99,255],
toColor:[72,17,100,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,17,100,255],toColor:[72,19,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,19,102,255],toColor:[72,20,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,20,103,255],toColor:[72,22,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,22,104,255],toColor:[72,23,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,
23,106,255],toColor:[72,24,107,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,24,107,255],toColor:[72,26,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,26,108,255],toColor:[72,27,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,27,109,255],toColor:[72,28,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,28,110,255],toColor:[73,30,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[73,30,112,255],toColor:[73,31,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[73,31,113,255],toColor:[72,32,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,32,114,255],toColor:[72,34,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,34,115,255],toColor:[72,35,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,35,116,255],toColor:[72,36,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[72,36,117,255],toColor:[72,37,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,37,118,255],toColor:[72,39,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,39,119,255],toColor:[72,40,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,40,120,255],toColor:[72,41,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,41,121,255],toColor:[72,42,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[72,42,122,255],toColor:[72,44,123,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,44,123,255],toColor:[71,45,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,45,124,255],toColor:[71,46,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,46,125,255],toColor:[71,47,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[71,47,125,255],toColor:[71,49,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[71,49,126,255],toColor:[70,50,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,50,127,255],toColor:[70,51,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,51,128,255],toColor:[70,52,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,52,128,255],toColor:[70,54,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[70,54,129,255],toColor:[69,55,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[69,55,130,255],toColor:[69,56,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[69,56,130,255],toColor:[69,57,131,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[69,57,131,255],toColor:[68,58,132,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[68,58,132,255],toColor:[68,60,132,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[68,60,132,255],toColor:[68,61,133,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[68,61,133,255],toColor:[67,62,133,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[67,62,133,255],toColor:[67,63,134,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[67,63,134,255],toColor:[66,64,134,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[66,64,134,255],toColor:[66,66,135,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[66,66,135,255],toColor:[65,67,135,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[65,67,135,255],toColor:[65,68,136,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[65,68,136,255],toColor:[65,69,136,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[65,69,136,255],toColor:[64,70,136,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[64,70,136,255],toColor:[64,71,137,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[64,71,137,255],toColor:[63,73,137,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[63,73,137,255],toColor:[63,74,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[63,74,138,255],toColor:[62,75,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[62,75,138,255],toColor:[62,76,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[62,76,138,255],toColor:[61,77,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[61,77,138,255],toColor:[61,78,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[61,78,139,255],toColor:[60,79,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[60,79,139,255],toColor:[60,80,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[60,80,139,255],toColor:[59,81,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[59,81,139,255],toColor:[59,83,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[59,83,140,255],toColor:[58,84,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[58,84,140,255],toColor:[58,85,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[58,85,140,255],toColor:[57,86,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[57,86,140,255],toColor:[57,87,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[57,87,140,255],toColor:[56,88,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[56,88,141,255],toColor:[56,89,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[56,89,141,255],toColor:[55,90,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[55,90,141,255],toColor:[55,91,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[55,91,141,255],toColor:[54,92,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[54,92,141,255],toColor:[54,93,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[54,93,141,255],toColor:[53,94,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[53,94,141,255],toColor:[53,95,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[53,95,142,255],toColor:[52,96,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[52,96,142,255],toColor:[52,97,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[52,97,142,255],toColor:[52,98,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[52,98,142,255],toColor:[51,99,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[51,99,142,255],toColor:[51,100,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[51,100,142,255],toColor:[50,101,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[50,101,142,255],toColor:[50,102,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[50,102,142,255],toColor:[49,103,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[49,103,142,255],toColor:[49,104,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[49,104,142,255],toColor:[48,105,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[48,105,142,255],toColor:[48,106,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[48,106,142,255],toColor:[48,107,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[48,107,143,255],toColor:[47,108,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[47,108,143,255],toColor:[47,109,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[47,109,143,255],toColor:[46,110,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[46,110,143,255],toColor:[46,111,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[46,111,143,255],toColor:[45,112,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[45,112,143,255],toColor:[45,113,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[45,113,143,255],toColor:[45,114,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[45,114,143,255],toColor:[44,115,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[44,115,143,255],toColor:[44,116,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[44,116,143,255],toColor:[43,117,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[43,117,143,255],toColor:[43,118,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[43,118,143,255],toColor:[43,119,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[43,119,143,255],toColor:[42,120,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[42,120,143,255],toColor:[42,121,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[42,121,143,255],toColor:[42,122,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[42,122,143,255],toColor:[41,123,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[41,123,143,255],toColor:[41,123,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[41,123,143,255],toColor:[40,124,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[40,124,143,255],toColor:[40,125,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[40,125,143,255],toColor:[40,126,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[40,126,143,255],toColor:[39,127,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[39,127,143,255],toColor:[39,128,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[39,128,143,255],toColor:[39,129,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[39,129,143,255],toColor:[38,130,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[38,130,143,255],toColor:[38,131,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[38,131,143,255],toColor:[37,132,143,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[37,132,143,255],toColor:[37,133,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[37,133,142,255],toColor:[37,134,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[37,134,142,255],toColor:[36,135,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[36,135,142,255],toColor:[36,136,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[36,136,142,255],toColor:[36,137,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[36,137,142,255],toColor:[35,138,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[35,138,142,255],toColor:[35,139,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[35,139,142,255],toColor:[35,139,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[35,139,142,255],toColor:[34,140,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[34,140,142,255],toColor:[34,141,142,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[34,141,142,255],toColor:[34,142,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[34,142,141,255],toColor:[33,143,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[33,143,141,255],toColor:[33,144,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[33,144,141,255],toColor:[33,145,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[33,145,141,255],toColor:[32,146,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[32,146,141,255],toColor:[32,147,141,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[32,147,141,255],toColor:[32,148,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[32,148,140,255],toColor:[32,149,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[32,149,140,255],toColor:[31,150,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,150,140,255],toColor:[31,151,140,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,151,140,255],toColor:[31,152,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[31,152,139,255],toColor:[31,153,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,153,139,255],toColor:[31,154,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,154,139,255],toColor:[31,155,139,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,155,139,255],toColor:[31,156,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,156,138,255],toColor:[31,156,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[31,156,138,255],toColor:[31,157,138,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,157,138,255],toColor:[31,158,137,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,158,137,255],toColor:[31,159,137,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,159,137,255],toColor:[31,160,137,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,160,137,255],toColor:[31,161,136,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[31,161,136,255],toColor:[31,162,136,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[31,162,136,255],toColor:[32,163,135,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[32,163,135,255],toColor:[32,164,135,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[32,164,135,255],toColor:[32,165,134,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[32,165,134,255],toColor:[33,166,134,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[33,166,134,255],toColor:[33,167,134,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[33,167,134,255],toColor:[34,168,133,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[34,168,133,255],toColor:[34,169,133,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[34,169,133,255],toColor:[35,170,132,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[35,170,132,255],toColor:[36,170,131,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[36,170,131,255],toColor:[37,171,131,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[37,171,131,255],toColor:[38,172,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[38,172,130,255],toColor:[38,173,130,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[38,173,130,255],toColor:[39,174,129,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[39,174,129,255],toColor:[40,175,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[40,175,128,255],toColor:[41,176,128,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[41,176,128,255],toColor:[43,177,127,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[43,177,127,255],toColor:[44,178,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[44,178,126,255],toColor:[45,179,126,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[45,179,126,255],toColor:[46,180,125,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[46,180,125,255],toColor:[48,180,124,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[48,180,124,255],toColor:[49,181,123,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[49,181,123,255],toColor:[50,182,123,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[50,182,123,255],toColor:[52,183,122,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[52,183,122,255],toColor:[53,184,121,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[53,184,121,255],toColor:[55,185,120,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[55,185,120,255],toColor:[56,186,119,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[56,186,119,255],toColor:[58,187,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[58,187,118,255],toColor:[60,187,118,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[60,187,118,255],toColor:[61,188,117,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[61,188,117,255],toColor:[63,189,116,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[63,189,116,255],toColor:[65,190,115,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[65,190,115,255],toColor:[67,191,114,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[67,191,114,255],toColor:[68,192,113,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[68,192,113,255],toColor:[70,193,112,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[70,193,112,255],toColor:[72,193,111,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[72,193,111,255],toColor:[74,194,110,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[74,194,110,255],toColor:[76,195,109,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[76,195,109,255],toColor:[78,196,108,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[78,196,108,255],toColor:[80,197,106,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[80,197,106,255],toColor:[82,197,105,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[82,197,105,255],toColor:[84,198,104,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[84,198,104,255],toColor:[86,199,103,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[86,199,103,255],toColor:[88,200,102,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[88,200,102,255],toColor:[90,200,101,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[90,200,101,255],toColor:[92,201,99,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[92,201,99,255],toColor:[95,202,98,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[95,202,98,255],toColor:[97,203,97,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[97,203,97,255],toColor:[99,203,95,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[99,203,95,255],toColor:[101,204,94,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[101,204,94,255],toColor:[103,205,93,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[103,205,93,255],toColor:[106,206,91,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[106,206,91,255],toColor:[108,206,90,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[108,206,90,255],toColor:[110,207,89,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[110,207,89,255],toColor:[113,208,87,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[113,208,87,255],toColor:[115,208,86,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[115,208,86,255],toColor:[117,209,84,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[117,209,84,255],toColor:[120,210,83,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[120,210,83,255],toColor:[122,210,81,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[122,210,81,255],toColor:[125,211,80,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[125,211,80,255],toColor:[127,212,78,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[127,212,78,255],toColor:[130,212,77,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[130,212,77,255],toColor:[132,213,75,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[132,213,75,255],toColor:[135,213,74,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[135,213,74,255],toColor:[137,214,72,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[137,214,72,255],toColor:[140,215,71,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[140,215,71,255],toColor:[142,215,69,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[142,215,69,255],toColor:[145,216,67,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[145,216,67,255],toColor:[147,216,66,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[147,216,66,255],toColor:[150,217,64,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[150,217,64,255],toColor:[153,217,62,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[153,217,62,255],toColor:[155,218,61,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[155,218,61,255],toColor:[158,218,59,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[158,218,59,255],toColor:[160,219,57,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[160,219,57,255],toColor:[163,219,55,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[163,219,55,255],toColor:[166,220,54,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[166,220,54,255],toColor:[168,220,52,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[168,220,52,255],toColor:[171,221,50,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[171,221,50,255],toColor:[174,221,49,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[174,221,49,255],toColor:[176,222,47,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[176,222,47,255],toColor:[179,222,45,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[179,222,45,255],toColor:[182,222,43,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[182,222,43,255],toColor:[184,223,42,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[184,223,42,255],toColor:[187,223,40,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[187,223,40,255],toColor:[190,224,38,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[190,224,38,255],toColor:[192,224,37,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[192,224,37,255],toColor:[195,224,35,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[195,224,35,255],toColor:[198,225,34,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[198,225,34,255],toColor:[201,225,32,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[201,225,32,255],toColor:[203,225,31,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[203,225,31,255],toColor:[206,226,29,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[206,226,29,255],toColor:[209,226,28,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[209,226,28,255],toColor:[211,226,27,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[211,226,27,255],toColor:[214,227,26,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[214,227,26,255],toColor:[216,227,26,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[216,227,26,255],toColor:[219,227,25,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[219,227,25,255],toColor:[222,228,25,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[222,228,25,255],toColor:[224,228,24,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[224,228,24,255],toColor:[227,228,24,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[227,228,24,255],toColor:[229,229,25,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[229,229,25,255],toColor:[232,229,25,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[232,229,25,255],toColor:[235,229,26,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[235,229,26,255],toColor:[237,230,27,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[237,230,27,255],toColor:[240,230,28,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[240,230,28,255],toColor:[242,230,29,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:[242,230,29,255],toColor:[245,231,30,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[245,231,30,255],toColor:[247,231,32,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[247,231,32,255],toColor:[249,231,33,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[249,231,33,255],toColor:[252,232,35,255]},{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:[252,232,35,255],toColor:[254,232,37,255]}]},{id:"whiteToBlack_predefined",
fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",
fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],k=[{name:"Aspect",id:"aspect_predefined"},{name:"Black to White",id:"blackToWhite_predefined"},{name:"Blue Bright",id:"blueBright_predefined"},{name:"Blue Light to Dark",id:"blueLightToDark_predefined"},{name:"Blue-Green Bright",id:"blueGreenBright_predefined"},{name:"Blue-Green Light to Dark",id:"blueGreenLightToDark_predefined"},{name:"Brown Light to Dark",id:"brownLightToDark_predefined"},
{name:"Brown to Blue Green Diverging, Bright",id:"brownToBlueGreenDivergingBright_predefined"},{name:"Brown to Blue Green Diverging, Dark",id:"brownToBlueGreenDivergingDark_predefined"},{name:"Cividis",id:"cividis_predefined"},{name:"Coefficient Bias",id:"coefficientBias_predefined"},{name:"Cold to Hot Diverging",id:"coldToHotDiverging_predefined"},{name:"Condition Number",id:"conditionNumber_predefined"},{name:"Cyan to Purple",id:"cyanToPurple_predefined"},{name:"Cyan-Light to Blue-Dark",id:"cyanLightToBlueDark_predefined"},
{name:"Distance",id:"distance_predefined"},{id:"elevation1_predefined",name:"Elevation #1"},{id:"elevation2_predefined",name:"Elevation #2"},{id:"errors_predefined",name:"Errors"},{id:"grayLightToDark_predefined",name:"Gray Light to Dark"},{id:"greenBright_predefined",name:"Green Bright"},{id:"greenLightToDark_predefined",name:"Green Light to Dark"},{name:"Green to Blue",id:"greenToBlue_predefined"},{name:"Inferno",id:"inferno_predefined"},{name:"Magma",id:"magma_predefined"},{name:"Orange Bright",
id:"orangeBright_predefined"},{name:"Orange Light to Dark",id:"orangeLightToDark_predefined"},{id:"partialSpectrum_predefined",name:"Partial Spectrum"},{id:"partialSpectrum1Diverging_predefined",name:"Partial Spectrum 1 Diverging",type:"multipart"},{id:"partialSpectrum2Diverging_predefined",name:"Partial Spectrum 2 Diverging"},{name:"Plasma",id:"plasma_predefined"},{name:"Pink to YellowGreen Diverging, Bright",id:"pinkToYellowGreenDivergingBright_predefined"},{name:"Pink to YellowGreen Diverging, Dark",
id:"pinkToYellowGreenDivergingDark_predefined"},{id:"precipitation_predefined",name:"Precipitation"},{id:"prediction_predefined",name:"Prediction"},{name:"Purple Bright",id:"purpleBright_predefined"},{id:"purpleToGreenDivergingBright_predefined",name:"Purple to Green Diverging, Bright"},{id:"purpleToGreenDivergingDark_predefined",name:"Purple to Green Diverging, Dark"},{name:"Purple-Blue Bright",id:"purpleBlueBright_predefined"},{name:"Purple-Blue Light to Dark",id:"purpleBlueLightToDark_predefined"},
{name:"Purple-Red Bright",id:"purpleRedBright_predefined"},{name:"Purple-Red Light to Dark",id:"purpleRedLightToDark_predefined"},{name:"Red Bright",id:"redBright_predefined"},{name:"Red Light to Dark",id:"redLightToDark_predefined"},{id:"redToBlueDivergingBright_predefined",name:"Red to Blue Diverging, Bright"},{id:"redToBlueDivergingDark_predefined",name:"Red to Blue Diverging, Dark"},{id:"redToGreen_predefined",name:"Red to Green"},{id:"redToGreenDivergingBright_predefined",name:"Red to Green Diverging, Bright"},
{id:"redToGreenDivergingDark_predefined",name:"Red to Green Diverging, Dark"},{name:"Slope",id:"slope_predefined"},{id:"spectrumFullBright_predefined",name:"Spectrum-Full Bright"},{id:"spectrumFullDark_predefined",name:"Spectrum-Full Dark"},{id:"spectrumFullLight_predefined",name:"Spectrum-Full Light"},{id:"surface_predefined",name:"Surface"},{id:"temperature_predefined",name:"Temperature"},{name:"Viridis",id:"viridis_predefined"},{name:"White to Black",id:"whiteToBlack_predefined"},{id:"yellowToDarkRed_predefined",
name:"Yellow to Dark Red"},{id:"yellowToGreenToDarkBlue_predefined",name:"Yellow to Green to Dark Blue"},{name:"Yellow to Red",id:"yellowToRed_predefined"},{name:"Yellow-Green Bright",id:"yellowGreenBright_predefined"},{name:"Yellow-Green Light to Dark",id:"yellowGreenLightToDark_predefined"}],w=new a({data:k});F.mixin(h,{predefinedColorRamps:g,predefinedColorRampNameMap:k,getColorRampName:function(t){t=f(t);return t.id?(t=w.query({id:t.id}),t[0]?t[0].name:null):null},fromJson:function(t){var C=null;
if(!t)return C;"multipart"===t.type?(C=new z,C.colorRamps=m.map(t.colorRamps,function(u){return e(u)},this)):"algorithmic"===t.type&&(C=e(t));return C},colorsEqual:b,getColorRampId:f,invertColorRamp:n,convertColorRampToColormap:function(t,C){if(t&&C){var u=t.colorRamps?t.colorRamps.length:1,x=[],l=[],v,A,B,E,G=0,I=0;for(G=0;G<u;G++)x[G]={},x[G].start=I,x[G].end=I+1/u,I=x[G].end;for(G=0;G<C;G++){var L=(G+.5)/C;m.forEach(x,function(K,ba){L>=K.start&&L<K.end&&(E=(L-K.start)/(K.end-K.start),1<x.length?
(v=r.getDojoColor(t.colorRamps[ba].fromColor),A=r.getDojoColor(t.colorRamps[ba].toColor)):(v=r.getDojoColor(t.fromColor),A=r.getDojoColor(t.toColor)),B=c(v,A,E),l.push([G,B.r,B.g,B.b]))},this)}return l}},interpolateLabColor:c});return h})},"esri/tasks/AlgorithmicColorRamp":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../Color ./ColorRamp".split(" "),function(F,m,a,D,z,y){F=F(y,{declaredClass:"esri.tasks.AlgorithmicColorRamp",type:"algorithmic",fromColor:null,toColor:null,
algorithm:null,toJson:function(){switch(this.algorithm&&this.algorithm.toLowerCase()){case "cie-lab":var r="esriCIELabAlgorithm";break;case "hsv":r="esriHSVAlgorithm";break;case "lab-lch":r="esriLabLChAlgorithm"}r={type:"algorithmic",algorithm:r};r.fromColor=z.toJsonColor(this.fromColor);r.toColor=z.toJsonColor(this.toColor);return r}});m.setObject("tasks.AlgorithmicColorRamp",F,D);return F})},"esri/tasks/ColorRamp":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],
function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.ColorRamp",type:null});m.setObject("tasks.ColorRamp",F,D);return F})},"esri/tasks/MultipartColorRamp":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../symbols/Symbol ./ColorRamp".split(" "),function(F,m,a,D,z,y){F=F(y,{declaredClass:"esri.tasks.MultipartColorRamp",type:"multipart",constructor:function(){this.colorRamps=[]},addColorRamp:function(r){this.colorRamps.push(r)},toJson:function(){return{type:"multipart",
colorRamps:a.map(this.colorRamps,function(r){return r.toJson()})}}});m.setObject("tasks.MultipartColorRamp",F,z);return F})},"esri/renderers/colorUtils":function(){define(["dojo/_base/Color","dojo/_base/array"],function(F,m){var a={COEF_RGB2XYZ:[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],COEF_XYZ2RGB:[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],matrixProduct:function(z,y){var r=[],q,n;if(z[0].length!==y.length)throw"dimensions do not match";var f=z.length,
d=z[0].length,e=0;for(q=0;q<f;q++){for(n=e=0;n<d;n++)e+=z[q][n]*y[n];r.push(e)}return r},rgb2xyz:function(z){z=[z.r/255,z.g/255,z.b/255].map(function(y){return.04045>=y?y/12.92:Math.pow((y+.055)/1.055,2.4)});z=this.matrixProduct(this.COEF_RGB2XYZ,z);return{x:100*z[0],y:100*z[1],z:100*z[2]}},xyz2rgb:function(z){z=this.matrixProduct(this.COEF_XYZ2RGB,[z.x/100,z.y/100,z.z/100]).map(function(y){return Math.min(1,Math.max(.0031308>=y?12.92*y:1.055*Math.pow(y,1/2.4)-.055,0))});return{r:Math.round(255*z[0]),
g:Math.round(255*z[1]),b:Math.round(255*z[2])}},xyz2lab:function(z){z=[z.x/95.047,z.y/100,z.z/108.883].map(function(y){return y>Math.pow(6/29,3)?Math.pow(y,1/3):1/3*Math.pow(29/6,2)*y+4/29});return{l:116*z[1]-16,a:500*(z[0]-z[1]),b:200*(z[1]-z[2])}},lab2xyz:function(z){var y=z.l;z=[(y+16)/116+z.a/500,(y+16)/116,(y+16)/116-z.b/200].map(function(r){return r>6/29?Math.pow(r,3):3*Math.pow(6/29,2)*(r-4/29)});return{x:95.047*z[0],y:100*z[1],z:108.883*z[2]}},lab2lch:function(z){var y=z.l,r=z.a,q=z.b;z=Math.sqrt(r*
r+q*q);r=Math.atan2(q,r);r=0<r?r:r+2*Math.PI;return{l:y,c:z,h:r}},lch2lab:function(z){var y=z.c,r=z.h;return{l:z.l,a:y*Math.cos(r),b:y*Math.sin(r)}},rgb2lab:function(z){return this.xyz2lab(this.rgb2xyz(z))},lab2rgb:function(z){return this.xyz2rgb(this.lab2xyz(z))},rgb2lch:function(z){return this.lab2lch(this.xyz2lab(this.rgb2xyz(z)))},lch2rgb:function(z){return this.xyz2rgb(this.lab2xyz(this.lch2lab(z)))}},D={rgb2hsv:function(z){var y=z.r,r=z.g;z=z.b;var q=Math.max(y,r,z),n=q-Math.min(y,r,z),f;0===
n?f=0:q===y?f=(r-z)/n%6:q===r?f=(z-y)/n+2:q===z&&(f=(y-r)/n+4);0>f&&(f+=6);return{h:60*f,s:100*(0===n?0:n/q),v:100/255*q}},hsv2rgb:function(z){var y=(z.h+360)%360/60,r=z.v/100*255;z=z.s/100*r;var q=z*(1-Math.abs(y%2-1));switch(Math.floor(y)){case 0:y={r:z,g:q,b:0};break;case 1:y={r:q,g:z,b:0};break;case 2:y={r:0,g:z,b:q};break;case 3:y={r:0,g:q,b:z};break;case 4:y={r:q,g:0,b:z};break;case 5:case 6:y={r:z,g:0,b:q};break;default:y={r:0,g:0,b:0}}y.r=Math.round(y.r+r-z);y.g=Math.round(y.g+r-z);y.b=Math.round(y.b+
r-z);return y}};return{toRGB:function(z){var y;void 0!==z.r&&void 0!==z.g&&void 0!==z.b?y=z:void 0!==z.l&&void 0!==z.c&&void 0!==z.h?y=a.lch2rgb(z):void 0!==z.l&&void 0!==z.a&&void 0!==z.b?y=a.lab2rgb(z):void 0!==z.x&&void 0!==z.y&&void 0!==z.z?y=a.xyz2rgb(z):void 0!==z.h&&void 0!==z.s&&void 0!==z.v&&(y=D.hsv2rgb(z));return y},toHSV:function(z){if(void 0!==z.h&&void 0!==z.s&&void 0!==z.v)return z;z=this.toRGB(z);return D.rgb2hsv(z)},toLAB:function(z){return void 0!==z.l&&void 0!==z.a&&void 0!==z.b?
z:a.rgb2lab(this.toRGB(z))},toLCH:function(z){return void 0!==z.l&&void 0!==z.c&&void 0!==z.h?z:a.rgb2lch(this.toRGB(z))},toXYZ:function(z){return void 0!==z.x&&void 0!==z.y&&void 0!==z.z?z:a.rgb2xyz(this.toRGB(z))},getDojoColor:function(z){if(z){if(Array.isArray(z))return F.fromArray(z);if(void 0!==z.r&&void 0!==z.g&&void 0!==z.b)return z}},correctRGBLimits:function(z){var y=[z.r,z.g,z.b];m.forEach(y,function(r,q){0>y[q]?y[q]=0:255<y[q]&&(y[q]=255);y[q]=Math.floor(y[q])});return{r:y[0],g:y[1],b:y[2],
a:1}}}})},"esri/renderers/ShadedReliefRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../layers/RasterFunction ./colorRampUtils".split(" "),function(F,m,a,D,z,y,r,q){F=F(null,{declaredClass:"esri.renderer.ShadedReliefRenderer",constructor:function(n){n=n||{};this.hillshadeType=n.hillshadeType||"traditional";this.azimuth=null!=n.azimuth?n.azimuth:315;this.altitude=null!=n.altitude?n.altitude:45;this.zFactor=n.zFactor||1;this.scalingType=n.scalingType||
"none";this.pixelSizePower=null!=n.pixelSizePower?n.pixelSizePower:.664;this.pixelSizeFactor=null!=n.pixelSizeFactor?n.pixelSizeFactor:.024;this.removeEdgeEffect=n.removeEdgeEffect||!1;this.colorRamp=q.fromJson(n.colorRamp)},toJson:function(){var n={type:"rasterShadedRelief",hillshadeType:this.hillshadeType,azimuth:this.azimuth,altitude:this.altitude,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,colorRamp:this.colorRamp&&
this.colorRamp.toJson()};return y.fixJson(n)},toRenderingRule:function(n){}});a.setObject("renderer.ShadedReliefRenderer",F,z);return F})},"esri/renderers/ColormapRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),function(F,m,a,D,z,y,r,q,n){F=F(q,{declaredClass:"esri.renderer.ColormapRenderer",constructor:function(f){this.colormapInfos=f&&f.colormapInfos},toJson:function(){var f=y.fixJson;
var d={type:"rasterColormap",colormapInfos:m.map(this.colormapInfos||[],function(e,b){var c={};e.color&&null!==e.color&&3<=e.color.length&&(c.color=e.color,c.value=e.value||b,c.label=(e.label||b)+"");return f(c)})};d=a.mixin(this.inherited(arguments),d);return f(d)}});a.setObject("renderer.ColormapRenderer",F,z);return F})},"esri/renderers/arcadeUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","../support/expressionUtils"],function(F,m,a,D){F.setObject("renderer.arcadeUtils",D,a);
return D})},"esri/arcadeProfiles/labelingProfile":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../promiseList ../arcade/Feature ../support/expressionUtils ./utils".split(" "),function(F,m,a,D,z,y,r,q){F=new (F(null,{declaredClass:"esri.arcadeProfiles.LabelingProfile",defaults:{context:{vars:{$feature:"any"}}},initialize:function(n){var f=[];q.hasGeometryOperations(n)&&f.push(r.enableGeometryOperations());return z(f)},isAsync:function(n){return!1},parse:function(n){return r.createSyntaxTree(n.expression)},
compile:function(n){var f=m.clone(this.defaults.context);return n.syntaxTree?r.createFunction(n.syntaxTree,f):null},getEvalOptions:function(n){var f=n.feature;return{context:{vars:{$feature:f&&n.expression.hasVariable("$feature")?y.createFromGraphicLikeObject(f.geometry,f.attributes,n.layer):null},spatialReference:n.spatialReference}}}}));m.setObject("arcadeProfiles.labelingProfile",F,D);return F})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./FeatureTemplate ./support/domainUtils".split(" "),
function(F,m,a,D,z,y,r,q,n){F=F(null,{declaredClass:"esri.layers.FeatureType",constructor:function(f){if(f&&m.isObject(f)){this.id=f.id;this.name=f.name;var d=f.symbol;d&&(this.symbol=r.fromJson(d));d=f.domains;var e=this.domains={};for(b in d)d.hasOwnProperty(b)&&(e[b]=n.fromJson(d[b]));if(f=f.templates){var b=this.templates=[];for(d=0;d<f.length;d++)b.push(new q(f[d]))}}},toJson:function(){var f={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},d,e=this.domains,b=this.templates,
c=y.fixJson;if(e){var h=f.domains={};for(d in e)e.hasOwnProperty(d)&&(h[d]=e[d]&&e[d].toJson());c(h)}b&&(f.templates=a.map(b,function(g){return g.toJson()}));return c(f)}});m.setObject("layers.FeatureType",F,z);return F})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(r){r&&m.isObject(r)&&(this.name=r.name,this.description=
r.description,this.drawingTool=r.drawingTool,this.thumbnail=r.thumbnail,r=r.prototype,this.prototype=new y(r.geometry,null,r.attributes))},toJson:function(){return z.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,thumbnail:z.fixJson(m.clone(this.thumbnail)),prototype:this.prototype&&this.prototype.toJson()})}});m.mixin(F,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",
TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});
m.setObject("layers.FeatureTemplate",F,D);return F})},"esri/layers/support/domainUtils":function(){define("dojo/_base/lang dojo/has ../../kernel ../RangeDomain ../CodedValueDomain ../InheritedDomain".split(" "),function(F,m,a,D,z,y){m={fromJson:function(r){if(r)switch(r.type){case "range":var q=new D(r);break;case "codedValue":q=new z(r);break;case "inherited":q=new y(r)}return q}};F.setObject("layers.support.domainUtils",m,a);return m})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","./Domain"],function(F,m,a,D,z){F=F([z],{declaredClass:"esri.layers.InheritedDomain"});m.setObject("layers.InheritedDomain",F,D);return F})},"esri/layers/FeatureSubtype":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./support/domainUtils".split(" "),function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.layers.FeatureSubtype",constructor:function(r){if(r&&m.isObject(r)){this.code=r.code;this.name=r.name;this.defaultValues=r.defaultValues;
r=r.domains;var q=this.domains={},n;for(n in r)r.hasOwnProperty(n)&&(q[n]=y.fromJson(r[n]))}},toJson:function(){var r=z.fixJson,q={code:this.code,name:this.name,defaultValues:r(m.clone(this.defaultValues))},n=this.domains;if(n){var f=q.domains={},d;for(d in n)n.hasOwnProperty(d)&&(f[d]=n[d]&&n[d].toJson());r(f)}return r(q)}});m.setObject("layers.FeatureSubtype",F,D);return F})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,
m,a,D){F=F(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(z){z&&m.isObject(z)&&(this.objectId=z.objectId,this.globalId=z.globalId,this.success=z.success,z.success||(z=z.error,this.error=Error(),this.error.code=z.code,this.error.message=z.description))}});m.setObject("layers.FeatureEditResult",F,D);return F})},"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),
function(F,m,a,D,z,y,r,q){var n=RegExp("__begin__","ig"),f=RegExp("__end__","ig"),d=/^__begin__/i,e=/__end__$/i;F=F(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter","above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter",
"below-left":"esriServerPointLabelPlacementBelowLeft","below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft","center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter","above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd",
"below-after":"esriServerLinePlacementBelowAfter","below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart","below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong","center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd",
"always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},constructor:function(b){b&&(m.mixin(this,b),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=y.valueOf(this._labelPlacementLookup,b.labelPlacement)),b.format&&(this.format=b.format),b.fieldInfos&&(this.fieldInfos=b.fieldInfos),b.symbol&&(this.symbol="esriSHD"===b.symbol.type?new q(b.symbol):new r(b.symbol)),b=this.sizeInfo)&&(b.minSize&&(b.minSize=D.pt2px(b.minSize)),b.maxSize&&(b.maxSize=D.pt2px(b.maxSize)))},
getSymbol:function(){return this.symbol},toJson:function(){var b=this.sizeInfo;b&&(b=m.mixin({},b),b.minSize&&(b.minSize=D.px2pt(b.minSize)),b.maxSize&&(b.maxSize=D.px2pt(b.maxSize)));var c=y.fixJson(this.labelExpressionInfo&&m.clone(this.labelExpressionInfo));this._processLabelExpressionInfo(c);b={name:this.name,labelExpression:this.labelExpression,labelExpressionInfo:c,format:this.format||void 0,fieldInfos:this.fieldInfos||void 0,useCodedValues:this.useCodedValues,maxScale:this.maxScale,minScale:this.minScale,
where:this.where,sizeInfo:b||void 0,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};return y.fixJson(b)},_processLabelExpressionInfo:function(b){b&&b.value&&(b.expression=this._convertTemplatedStringToArcade(b.value))},_convertTemplatedStringToArcade:function(b){if(b){var c=m.replace(b,function(h,g){return'__begin__$feature["'+g+'"]__end__'});c=d.test(c)?c.replace(d,
""):'"'+c;c=e.test(c)?c.replace(e,""):c+'"';c=c.replace(n,'" + ').replace(f,' + "')}return c}});m.setObject("layers.LabelClass",F,z);return F})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),function(F,m,a,D,z,y,r,q,n){var f={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};F=F(q,{declaredClass:"esri.symbol.ShieldLabelSymbol",type:"shieldlabelsymbol",color:[255,
255,255,1],width:32,height:32,font:D.defaultFont,constructor:function(d,e,b,c,h){d?m.isString(d)?(this.url=d,e&&(this.color=e),b&&(this.width=b),c&&(this.height=c),void 0!==h&&(this.font=h)):(this.width=D.pt2px(d.width),this.height=D.pt2px(d.height),e=d.imageData,9>a("ie")||!e||(b=this.url,this.url="data:"+(d.contentType||"image")+";base64,"+e,this.imageData=b)):m.mixin(this,f)},getStroke:function(){return null},getFill:function(){return this.color},setWidth:function(d){this.width=d;return this},
setHeight:function(d){this.height=d;return this},setUrl:function(d){d!==this.url&&(delete this.imageData,delete this.contentType);this.url=d;return this},setFont:function(d){this.font=d;return this},setText:function(d){this.text=d;return this},getWidth:function(){return this.width},getHeight:function(){return this.height},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,
stroke:null}},toJson:function(){var d=this.url,e=this.imageData;if(0===d.indexOf("data:")){var b=d;d=e;e=b.indexOf(";base64,")+8;e=b.substr(e)}d=r.getAbsoluteUrl(d);b=D.px2pt(this.width);b=isNaN(b)?void 0:b;var c=D.px2pt(this.height);c=isNaN(c)?void 0:c;d=y.fixJson(m.mixin(this.inherited("toJson",arguments),{type:"esriSHD",url:d,imageData:e,contentType:this.contentType,width:b,height:c}));this.font?(e=new n(this.font),d.font=e.toJson()):d.font=null;delete d.size;d.imageData||delete d.imageData;return d}});
F.defaultProps=f;m.setObject("symbol.ShieldLabelSymbol",F,z);z.symbol.defaultShieldLabelSymbol=f;return F})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../srUtils ../tasks/query ./RenderMode ./support/ParallelSnapshot".split(" "),function(F,m,a,D,z,y,r,q,n){F=F([q],{declaredClass:"esri.layers._SnapshotMode",maxFeatures:5E4,maxRecordCountFactor:1,scaleToTileFactor:1,_isSuspendedAtStartup:!1,_pendingRefresh:!1,constructor:function(f){this.featureLayer=
f;this._featureMap={};this._hasUpdateError=this._hasPartialFeatures=!1;this._drawFeatures=m.hitch(this,this._drawFeatures);this._queryErrorHandler=m.hitch(this,this._queryErrorHandler);this._handleSuccess=m.hitch(this,this._handleSuccess);this._handleError=m.hitch(this,this._handleError);this._handleProgress=m.hitch(this,this._handleProgress)},startup:function(){if(!this._started||this._isSuspendedAtStartup){this.inherited(arguments);var f=this.featureLayer,d=f.reHostedFS.test(f.url);this.pagination=
f.queryPagination&&null!=f.maxRecordCount;this._cacheHintSupported=f._isCacheHintSupported();this.scaleToTileFactor=this._getScaleToTileFactor();d&&this.pagination&&(this._parallelSnapshot=new n({layer:f,mode:this,queryTask:f._task}));this._isSuspendedAtStartup=f.suspended;this._startup()}},propertyChangeHandler:function(f){this._init&&(f?this.featureLayer._collection||this._fetchAll():this._applyTimeFilter())},destroy:function(){this._isSuspendedAtStartup=this._pendingRefresh=!1;this._cancelPendingRequest(this._pendingRequest);
this._parallelSnapshot&&this._parallelSnapshot.destroy();this.inherited(arguments)},drawFeature:function(f){var d=f.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(d,f);this._incRefCount(d)},resume:function(){this._isSuspendedAtStartup||this._pendingRefresh?(this._isSuspendedAtStartup=!1,this._startup()):this.propertyChangeHandler(0)},refresh:function(){var f=this.featureLayer;f._collection?(f._fireUpdateStart(),f._refresh(!0),f._fireUpdateEnd()):this._fetchAll()},hasAllFeatures:function(){return!this._hasPartialFeatures},
hasUpdateError:function(){return this._hasUpdateError},canFetchPBF:function(f){return this.inherited(arguments)&&this.featureLayer._canFetchPBFForQuery(f)},_startup:function(){this.featureLayer._collection?this._applyTimeFilter():this._fetchAll()},_fetchAll:function(){var f=this.featureLayer;f._collection||f.suspended||!f.isQueryable()?this._pendingRefresh=f.suspended:(this._pendingRefresh=!1,f._fireUpdateStart(),this._clearIIf(),this._hasUpdateError=this._hasPartialFeatures=!1,this._parallelSnapshot?
this._parallelSnapshot.fetch().then(this._handleSuccess,this._handleError,this._handleProgress):this._sendRequest())},_handleSuccess:function(f){this._hasPartialFeatures=f.hasPartialFeatures;this._hasUpdateError=f.hasUpdateError;this.featureLayer._fireUpdateEnd(null)},_handleError:function(f){this._queryErrorHandler(f)},_handleProgress:function(f){f.isError?this.featureLayer._errorHandler(f.error):this._addFeatures(f.features)},_getScaleToTileFactor:function(){var f=this.featureLayer.tileMaxRecordCount,
d=this.featureLayer.maxRecordCount,e=1;null!=f&&null!=d&&(e=Number((f/d).toFixed(2)));return e},_getPageSize:function(f){var d=this.featureLayer.tileMaxRecordCount;d="tile"===f.resultType&&d?d:this.featureLayer.maxRecordCount;f.maxRecordCountFactor&&(d=Math.floor(d*f.maxRecordCountFactor));return d},_sendRequest:function(f){var d=this.featureLayer,e=this._createQueryInfo(),b=e.query;this.pagination&&(this._pageSize=this._getPageSize(b),this._start=b.start=null==f?0:f,b.num=this._pageSize);this._pendingRequest&&
this._cancelPendingRequest(this._pendingRequest);this._pendingRequest=d._task.execute(b,this._drawFeatures,this._queryErrorHandler,e.pbf?{format:"pbf"}:null)},_drawFeatures:function(f){this._pendingRequest=null;this.featureLayer._isImageService&&10.7>this.featureLayer.version&&void 0===f.exceededTransferLimit&&(f.exceededTransferLimit=f.features.length===this.featureLayer.maxRecordCount);var d=this.featureLayer,e=f.exceededTransferLimit,b=e&&!d._collection;f=this._checkMaxLimit(f.features);var c=
f.maxLimitReached;this._addFeatures(f.features);this.pagination&&b&&!c||(this._hasPartialFeatures=!!e,d._fireUpdateEnd(null,e?{queryLimitExceeded:!0}:null));b&&(this.pagination&&!c&&this._sendRequest(this._start+this._pageSize),d.onQueryLimitExceeded())},_queryErrorHandler:function(f){this._pendingRequest=null;this._hasUpdateError=this._hasPartialFeatures=!0;var d=this.featureLayer;d._errorHandler(f);d._fireUpdateEnd(f)},_checkMaxLimit:function(f){var d=f?f.length:0,e=this.featureLayer.graphics.length+
d,b=e>=this.maxFeatures;if(b){var c=e-this.maxFeatures;c&&f.splice(d-c,c)}return{maxLimitReached:b,featuresDiscarded:e>this.maxFeatures,features:f}},_createQueryInfo:function(){var f=this.featureLayer,d=new r;d.outFields=f.getOutFields();d.where=f._getAttributeFilter()||"1\x3d1";d.returnGeometry=!0;d.outSpatialReference=y.createSpatialReference(this.map.spatialReference.toJson());d.timeExtent=f.getTimeDefinition();d.maxAllowableOffset=f._maxOffset;d.quantizationParameters=f._quantizationParameters;
d.orderByFields=f.supportsAdvancedQueries?f.getOrderByFields():null;d.multipatchOption=f.multipatchOption;f._ts&&(d._ts=(new Date).getTime());this._cacheHintSupported&&f._enableCacheHint(d);var e=this.canFetchPBF(d);f._enableEditModeQuantization(d,e);this._applyMaxRecordCountFactor(d,e);return{query:d,pbf:e}},_applyMaxRecordCountFactor:function(f,d){var e=this.featureLayer.advancedQueryCapabilities;this.featureLayer._isCacheHintEnabled(f)&&e&&e.supportsMaxRecordCountFactor&&("tile"!==f.resultType&&
1<this.scaleToTileFactor&&(f.maxRecordCountFactor=this.scaleToTileFactor),d&&1<this.maxRecordCountFactor&&(f.maxRecordCountFactor=this.maxRecordCountFactor),5<f.maxRecordCountFactor&&(f.maxRecordCountFactor=5))},_addFeatures:function(f){var d=this.featureLayer,e=d.objectIdField,b=f.length,c=d._selectedFeatures,h=d.mode===d.constructor.MODE_AUTO;d._fireUpdateStart();d._sortFeatures(f);for(d=0;d<b;d++){var g=f[d];var k=g.attributes[e];var w=this._addFeatureIIf(k,g);this._incRefCount(k);h&&w!==g&&c[k]&&
(w.setGeometry(g.geometry),w.setAttributes(g.attributes))}this._applyTimeFilter(!0)}});m.setObject("layers._SnapshotMode",F,D);return F})},"esri/layers/RenderMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","../sniff","../kernel"],function(F,m,a,D,z){var y=!!D("esri-pbf");D=!!D("esri-featurelayer-pbf");F=F(null,{declaredClass:"esri.layers._RenderMode",enablePBFQuery:y&&D,initialize:function(r){this.map=r;this._init=!0},startup:function(){this._started=!0},propertyChangeHandler:function(r){},
destroy:function(){this._init=this._started=!1},drawFeature:function(r){},suspend:function(){},resume:function(){},refresh:function(){},hasAllFeatures:function(){return!0},hasUpdateError:function(){return!1},canFetchPBF:function(r){return!(!this.featureLayer._canFetchPBF()||!this.enablePBFQuery)},_incRefCount:function(r){(r=this._featureMap[r])&&r._count++},_decRefCount:function(r){(r=this._featureMap[r])&&r._count--},_getFeature:function(r){return this._featureMap[r]},_addFeatureIIf:function(r,q){var n=
this._featureMap,f=n[r],d=this.featureLayer;f||(n[r]=q,d._add(q),q._count=0);return f||q},_removeFeatureIIf:function(r){var q=this._featureMap[r],n=this.featureLayer;if(q){if(q._count)return;delete this._featureMap[r];n._remove(q)}return q},_registerFeature:function(r,q){var n=this._featureMap,f=n[r];f?(f.attributes=q.attributes,f.geometry=q.geometry):(n[r]=q,q._count=0,q._layer=q._graphicsLayer=q._sourceLayer=this.featureLayer);return f||q},_unregisterFeature:function(r){var q=this._featureMap,n=
q[r];n&&!n._count&&(delete q[r],n._graphicsLayer=null)},_clearIIf:function(){var r=this.featureLayer;var q=r.graphics,n=r._selectedFeatures,f=r.getSelectedFeatures().length,d=r.objectIdField;if(f)for(r=q.length-1;0<=r;r--){f=q[r];var e=f.attributes[d];e in n?f._count=1:(f._count=0,this._removeFeatureIIf(e))}else r.clear(),this._featureMap={}},_cancelPendingRequest:function(r){if(r)try{r.cancel()}catch(q){}},_toggleVisibility:function(r){var q=this.featureLayer,n=q.graphics,f=r?"show":"hide",d,e=n.length;
r=r&&q._ager;for(d=0;d<e;d++){var b=n[d];b[f]();r&&q._repaint(b)}},_applyTimeFilter:function(r){var q=this.featureLayer;if(q.timeInfo&&!q.suspended){r||q._fireUpdateStart();var n=q._trackManager;n&&n.clearTracks();var f=q.getTimeDefinition(),d=q._getOffsettedTE(q._mapTimeExtent);d?(d=q._getTimeOverlap(f,d))?(f=q._filterByTime(q.graphics,d.startTime,d.endTime),n&&n.addFeatures(f.match),a.forEach(f.match,function(e){var b=e._shape;e.visible||(e.show(),(b=e._shape)&&b._moveToFront());q._ager&&b&&q._repaint(e)}),
a.forEach(f.noMatch,function(e){e.visible&&e.hide()})):this._toggleVisibility(!1):(n&&n.addFeatures(q.graphics),this._toggleVisibility(!0));n&&(n.moveLatestToFront(),n.drawTracks());r||q._fireUpdateEnd()}}});m.setObject("layers._RenderMode",F,z);return F})},"esri/layers/support/ParallelSnapshot":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/Deferred ../../kernel".split(" "),function(F,m,a,D,z,y){F=F(null,{declaredClass:"esri.layers.support.ParallelSnapshot",
layer:null,mode:null,queryTask:null,batchSize:5,_queryInfo:null,_fetchDfd:null,_startPage:null,_lastPage:null,_pageSize:null,_maxPages:null,_requests:null,constructor:function(r){m.mixin(this,r);this._requests={}},destroy:function(){this.cancel()},fetch:function(){var r=new z;this.cancel(!0);this._queryInfo=this.mode._createQueryInfo();this._pageSize=this.mode._getPageSize(this._queryInfo.query);this._maxPages=Math.ceil(this._getFeatureCount()/this._pageSize);this._fetchDfd=r;this._sendRequests();
return r.promise},cancel:function(r){this._cancelPendingRequests(r);this._reset()},_reset:function(){this._startPage=this._lastPage=null;this._requests={}},_getFeatureCount:function(){return this.layer.mode===this.layer.constructor.MODE_AUTO&&0===this.layer.getLastExceedsLimitResult()?this.layer._getMaxFeaturesForAutoSnapshotMode():this.mode.maxFeatures},_sendRequests:function(r){var q=this._queryInfo.query,n=this.queryTask,f=this._requests;r=null==r?1:r;var d=r+this.batchSize-1;d>this._maxPages&&
(d=this._maxPages);if(!(r>d))for(this._startPage=r,this._lastPage=d;r<=d;r++)q.start=(r-1)*this._pageSize,q.num=this._pageSize,f[r]=n.execute(q,null,null,this._queryInfo.pbf?{format:"pbf"}:null),f[r].then(m.hitch(this,this._handleSuccess,r)).otherwise(m.hitch(this,this._handleError,r))},_evalNextBatch:function(r){r===this._lastPage&&this._sendRequests(this._lastPage+1)},_handleSuccess:function(r,q){q.exceededTransferLimit||this._cancelLaterRequests(r,!0);var n=this.mode._checkMaxLimit(q.features);
this._fetchDfd.progress({features:n.features,isError:!1});n.maxLimitReached?((n=n.featuresDiscarded||this._hasRejectedRequests())||(n=!!this._getResult(this._getLastSuccessfulRequest()).exceededTransferLimit),this._resolveFetch(n)):(q.exceededTransferLimit&&this._evalNextBatch(r),this._evalResolution())},_handleError:function(r,q){var n=this._requests;n&&n[r]&&(1===r?this._rejectFetch(q):(this._evalNextBatch(r),this._fetchDfd.progress({error:q,isError:!0}),this._evalResolution()))},_evalResolution:function(){this._hasPendingRequests()||
this._resolveFetch(this._hasRejectedRequests())},_resolveFetch:function(r){var q=this._hasRejectedRequests();this.cancel(!0);this._fetchDfd.resolve({hasPartialFeatures:r,hasUpdateError:q})},_rejectFetch:function(r){this.cancel(!0);this._fetchDfd.reject(r)},_getResult:function(r){return r&&r.dfd.results[0]},_hasPendingRequests:function(){return!!this._getPendingRequests().length},_getPendingRequests:function(){var r=this._requests,q,n=[];for(q in r){var f=r[q];f.isFulfilled()||n.push({pageId:Number(q),
dfd:f})}return n},_getLastSuccessfulRequest:function(){var r=this._getResolvedRequests(),q=-Infinity,n;r=a.filter(r,function(f){return!!this._getResult(f).features.length||1===f.pageId},this);a.forEach(r,function(f){f.pageId>q&&(q=f.pageId,n=f)});return n},_getResolvedRequests:function(){var r=this._requests,q,n=[];for(q in r){var f=r[q];f.isResolved()&&n.push({pageId:Number(q),dfd:f})}return n},_hasRejectedRequests:function(){var r=this._getRejectedRequests(),q=this._getLastSuccessfulRequest(),n=
this._getResult(q);n&&!n.exceededTransferLimit&&(r=a.filter(r,function(f){return f.pageId<=q.pageId}));return!!r.length},_getRejectedRequests:function(){var r=this._requests,q,n=[];for(q in r){var f=r[q];f.isRejected()&&n.push({pageId:Number(q),dfd:f})}return n},_cancelPendingRequests:function(r){this._cancelRequests(this._getPendingRequests(),r)},_cancelLaterRequests:function(r,q){var n=a.filter(this._getPendingRequests(),function(f){return f.pageId>r});this._cancelRequests(n,q)},_cancelRequests:function(r,
q){var n=this.mode,f=this._requests;a.forEach(r,function(d){q&&delete f[d.pageId];n._cancelPendingRequest(d.dfd)})}});m.setObject("layers.support.ParallelSnapshot",F,y);return F})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),function(F,m,a,D,z,y,r,q,n,f){F=F([n],{declaredClass:"esri.layers._OnDemandMode",constructor:function(d){this.featureLayer=
d;this._featureMap={}},initialize:function(d){this.inherited(arguments);this._cellMap={};this._gridLayer=f.createFromFeatureLayer({layer:this.featureLayer,map:d})},startup:function(){if(!this._started||this._isSuspendedAtStartup)this.inherited(arguments),this._ioQueue=[],this._isSuspendedAtStartup=this.featureLayer.suspended,this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors())},propertyChangeHandler:function(d){this._init&&2>d&&this._zoomHandler()},destroy:function(){this._disableConnectors();
this._processIOQueue(!0);this.inherited(arguments)},drawFeature:function(d){var e=d.geometry,b=[];if(e){b=this._gridLayer.getCellsInExtent("point"===e.type?{xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y}:e.getExtent(),!1).cells;e=this._cellMap;var c,h=d.attributes[this.featureLayer.objectIdField];for(c=0;c<b.length;c++){var g=b[c];var k=g.latticeID;var w=g.row;var t=g.col;k?g=e[k]=e[k]||g:(e[w]=e[w]||{},g=e[w][t]=e[w][t]||g);g.features=g.features||[];g.features.push(d);this._addFeatureIIf(h,d);this._incRefCount(h)}}},
suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},hasAllFeatures:function(){var d=!1,e=this._getCurrentCells(),b;for(b=0;b<e.length;b++)if(e[b].hasPartialFeatures){d=!0;break}return!d},hasUpdateError:function(){var d=!1,e=this._getCurrentCells(),b;for(b=0;b<e.length;b++)if(e[b].hasUpdateError){d=!0;break}return d},canFetchPBF:function(d){return this.inherited(arguments)&&this.featureLayer._canFetchPBFForQuery(d)},
_enableConnectors:function(){var d=this.map;this._zoomConnect=m.connect(d,"onZoomEnd",this,this._zoomHandler);this._panConnect=m.connect(d,"onPanEnd",this,this._panHandler);this._resizeConnect=m.connect(d,"onResize",this,this._panHandler)},_disableConnectors:function(){m.disconnect(this._zoomConnect);m.disconnect(this._panConnect);m.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var d=this.featureLayer,e=this.map;!d.suspended&&d.isQueryable()&&(d._fireUpdateStart(),
this._clearIIf(),(d=d._trackManager)&&d.clearTracks(),this._cellMap={},this._gridLayer.setResolution(e.extent),this._sendRequest())},_panHandler:function(d){if(this.featureLayer.isQueryable()){this.featureLayer._fireUpdateStart();var e=this.featureLayer._resized;d=e?d:null;e&&this._gridLayer.setMapState(d,this.map.width,this.map.height);this._sendRequest(d)}},_sendRequest:function(d){this._exceeds=!1;var e=this.featureLayer,b=this.map;d=d||b.extent;b=this._gridLayer.getCellsInExtent(d,e.latticeTiling).cells;
if(!e.isEditable()){var c=this._cellMap;b=D.filter(b,function(w){if(w.lattice){if(c[w.latticeID])return!1}else if(c[w.row]&&c[w.row][w.col])return!1;return!0})}this._pending=this._pending||0;var h;for(h=0;h<b.length;h++){var g=b[h],k=this._createQueryInfo(g);this._pending++;this._ioQueue.push(e._task.execute(k.query,a.hitch(this,this._drawFeatures,g),a.hitch(this,this._queryErrorHandler,g),k.pbf?{format:"pbf"}:null))}this._removeOldCells(d);this._endCheck()},_drawFeatures:function(d,e){this.featureLayer._isImageService&&
10.7>this.featureLayer.version&&void 0===e.exceededTransferLimit&&(e.exceededTransferLimit=e.features.length===this.featureLayer.maxRecordCount);d.hasPartialFeatures=!!e.exceededTransferLimit;d.hasUpdateError=!1;this._exceeds=this._exceeds||e.exceededTransferLimit;this._finalizeIO();var b=this.featureLayer,c=this.map.extent,h=d.extent,g=d.row,k=d.col,w=b.objectIdField,t=e.features,C=this._gridLayer,u=this._cellMap,x=d.latticeID;u=x?u[x]:u[g]&&u[g][k];if(d.resolution==C.resolution&&(x?x===C.getLatticeID(c):
C.intersects(h,c)))if(u)b._sortFeatures(t),this._updateCell(u,t);else for(b._sortFeatures(t),d.features=t,this._addCellToCellMap(d),c=t.length,b=0;b<c;b++)h=t[b],g=h.attributes[w],this._addFeatureIIf(g,h),this._incRefCount(g);else u&&this._removeCell(g,k,x);this._endCheck()},_queryErrorHandler:function(d,e){this._finalizeIO();d.hasPartialFeatures=!0;d.hasUpdateError=!0;this._addCellToCellMap(d);this.featureLayer._errorHandler(e);this._endCheck(e)},_finalizeIO:function(){this._pending--},_endCheck:function(d){if(0===
this._pending){this._processIOQueue();var e=this.featureLayer,b=e._trackManager;b&&(b.clearTracks(),b.addFeatures(e.graphics),e._ager&&D.forEach(e.graphics,function(c){c._shape&&e._repaint(c)}),b.moveLatestToFront(),b.drawTracks());this.featureLayer._fireUpdateEnd(!!d&&Error("FeatureLayer: "+(d.message||"an error occurred while updating the layer.")),this._exceeds?{queryLimitExceeded:!0}:null);if(this._exceeds)e.onQueryLimitExceeded()}},_processIOQueue:function(d){this._ioQueue=D.filter(this._ioQueue,
function(e){return-1<e.fired?!1:!0});d&&D.forEach(this._ioQueue,this._cancelPendingRequest)},_createQueryInfo:function(d){var e=this.featureLayer,b=new q;b.outFields=e.getOutFields();b.where=e._getAttributeFilter();b.returnGeometry=!0;b.geometry=d.extent||d.lattice;e.latticeTiling&&d.extent&&(b.spatialRelationship=q.SPATIAL_REL_CONTAINS);b.timeExtent=e._getOffsettedTE(e._mapTimeExtent);b.maxAllowableOffset=e._maxOffset;b.quantizationParameters=e._quantizationParameters;b.orderByFields=e.supportsAdvancedQueries?
e.getOrderByFields():null;b.multipatchOption=e.multipatchOption;e._ts&&(b._ts=(new Date).getTime());(d=e.advancedQueryCapabilities)&&d.supportsQueryWithResultType&&(b.resultType="tile");d=this.canFetchPBF(b);e._enableEditModeQuantization(b,d);return{query:b,pbf:d}},_getCurrentCells:function(d){var e=[];d=d||this._cellMap;for(var b in d)if(d.hasOwnProperty(b)){var c=d[b];c&&(c.hasOwnProperty("row")||c.hasOwnProperty("latticeID")?e.push(c):"object"===typeof c&&e.push.apply(e,this._getCurrentCells(c)))}return e},
_addCellToCellMap:function(d){var e=this._cellMap;if(d.latticeID)e[d.latticeID]=d;else{var b=d.row,c=d.col;e[b]=e[b]||{};e[b][c]=d}},_removeOldCells:function(d){var e=this._cellMap,b=this._gridLayer,c,h;for(c in e)if(e[c]){var g=e[c],k=g.latticeID,w=0,t=0;if(k)w++,k!==b.getLatticeID(d)&&(this._removeCell(null,null,k),t++);else for(h in g)g[h]&&(w++,b.intersects(g[h].extent,d)||(this._removeCell(c,h),t++));t===w&&delete e[c]}},_updateCell:function(d,e){var b=this.featureLayer,c=b.objectIdField;b=b._selectedFeatures;
var h,g=e.length;d.features=d.features||[];for(h=0;h<g;h++){var k=e[h],w=k.attributes[c],t=this._addFeatureIIf(w,k);t===k?(this._incRefCount(w),d.features.push(t)):w in b||(t.setGeometry(k.geometry),t.setAttributes(k.attributes))}},_removeCell:function(d,e,b){var c=this._cellMap,h=this.featureLayer,g=h.objectIdField,k=b?c[b]:c[d]&&c[d][e];if(k&&(b?delete c[b]:delete c[d][e],d=k.features))for(e=0;e<d.length;e++)b=d[e].attributes[g],this._decRefCount(b),b in h._selectedFeatures||this._removeFeatureIIf(b)}});
a.setObject("layers._OnDemandMode",F,y);return F})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/normalizeUtils ../srUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d){var e=F(null,{declaredClass:"esri.layers._GridLayout",constructor:function(b,c,h,g){this.origin=b;this.cellWidth=c.width;this.cellHeight=c.height;this.mapWidth=h.width;this.mapHeight=
h.height;this.srInfo=g},setResolution:function(b){this.resolution=(b.xmax-b.xmin)/this.mapWidth;this.srInfo&&(b=Math.round(Math.round(2*this.srInfo.valid[1]/this.resolution)/this.cellWidth),this._frameStats=[b,0,b-1])},setMapState:function(b,c,h){this.mapWidth=c;this.mapHeight=h;this.setResolution(b)},getCellCoordinates:function(b){var c=this.resolution,h=this.origin;return{row:Math.floor((h.y-b.y)/(this.cellHeight*c)),col:Math.floor((b.x-h.x)/(this.cellWidth*c))}},normalize:function(b){var c=this._frameStats;
if(c){var h=c[0],g=c[1];c=c[2];b<g?(b%=h,b=b<g?b+h:b):b>c&&(b%=h)}return b},intersects:function(b,c){var h=this.srInfo;return h?a.some(c._getParts(h),function(g){return b.intersects(g.extent)}):b.intersects(c)},getCellExtent:function(b,c){var h=this.resolution,g=this.origin,k=this.cellWidth,w=this.cellHeight;return new r(c*k*h+g.x,g.y-(b+1)*w*h,(c+1)*k*h+g.x,g.y-b*w*h,d.createSpatialReference(g.spatialReference.toJson()))},getLatticeID:function(b){var c=this.getCellCoordinates({x:b.xmin,y:b.ymax}),
h=this.getCellCoordinates({x:b.xmax,y:b.ymin});b=c.row;var g=h.row;c=this.normalize(c.col);h=this.normalize(h.col);return b+"_"+g+"_"+c+"_"+h},sorter:function(b,c){return b<c?-1:1},getCellsInExtent:function(b,c){var h=this.getCellCoordinates({x:b.xmin,y:b.ymax}),g=this.getCellCoordinates({x:b.xmax,y:b.ymin}),k=h.row,w=g.row;h=h.col;g=g.col;var t=[],C,u,x=[],l=[],v=[];for(C=k;C<=w;C++)for(u=h;u<=g;u++){var A=this.normalize(u);b=this.getCellExtent(C,A);a.some(t,function(L){return L.row===C&&L.col===
A})||t.push({row:C,col:A,extent:b,resolution:this.resolution});c&&(x.push(b.xmin,b.xmax),l.push(b.ymin,b.ymax))}h=this.normalize(h);g=this.normalize(g);x.sort(this.sorter);l.sort(this.sorter);u=x.length;for(C=u-1;0<=C;C--)C<u-1&&x[C]===x[C+1]&&x.splice(C,1);u=l.length;for(C=u-1;0<=C;C--)C<u-1&&l[C]===l[C+1]&&l.splice(C,1);if(x.length&&l.length){var B=x[0];var E=x[x.length-1];var G=l[0];var I=l[l.length-1];u=x.length;for(C=0;C<u;C++)v.push([[x[C],I],[x[C],G]]);u=l.length;for(C=0;C<u;C++)v.push([[B,
l[C]],[E,l[C]]]);x=new q({paths:v,spatialReference:this.origin.spatialReference.toJson()});t.push({latticeID:k+"_"+w+"_"+h+"_"+g,lattice:x,resolution:this.resolution})}return{minRow:k,maxRow:w,minCol:h,maxCol:g,topRow:k,bottomRow:w,leftCol:h,rightCol:g,cells:t}},_findCell:function(b,c,h){var g;a.some(b,function(k){k.row===c&&k.col===h&&(g=k);return!!g});return g},getExtentOfIntersectingCells:function(b){var c=this.getCellsInExtent(b),h=c&&c.cells;if(h&&h.length){var g=c.topRow,k=c.leftCol,w=0;a.forEach(h,
function(x){x.row===g&&w++});var t=this._findCell(h,g,k).extent,C=this.srInfo;if(!C||w!==this._frameStats[0]&&k!==c.rightCol){var u=t.xmin;C=u+w*t.getWidth()}else u=C.valid[0],C=C.valid[1];c=this._findCell(h,c.bottomRow,k).extent.ymin;(b=(new r(u,c,C,t.ymax,b.spatialReference))._normalize(!1,!1))&&b.rings&&(b=new n(b),b=f.getDenormalizedExtent(b));return b}}});e.createFromFeatureLayer=function(b){var c=b.layer;b=c.getMap()||b.map;var h=c._srInfo;(c=b&&b.loaded?new e(new y(h?h.valid[0]:b.extent.xmin,
h?h.valid[1]:b.extent.ymax,b.spatialReference),{width:c._tileWidth,height:c._tileHeight},{width:b.width,height:b.height},h):null)&&c.setResolution(b.extent);return c};m.setObject("layers._GridLayout",e,z);return e})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(F,m,a,D,z){F=F([z],{declaredClass:"esri.layers._SelectionMode",constructor:function(y){this.featureLayer=y;this._featureMap={}},propertyChangeHandler:function(y){this._init&&
0===y&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)},hasAllFeatures:function(){return!this.featureLayer._hasPartialSelectedFeatures},hasUpdateError:function(){return this.featureLayer._hasSelectionError}});m.setObject("layers._SelectionMode",F,D);return F})},"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d){F=F([d],{declaredClass:"esri.layers._StreamMode",constructor:function(e,b){this.featureLayer=e;this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=m.hitch(this,this._flushDrawBuffer);this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;e.purgeOptions&&e.purgeOptions.age&&"number"===typeof e.purgeOptions.age&&(this._maxFeatureAge=1E3*Math.ceil(60*e.purgeOptions.age));this._drawFeatures=
m.hitch(this,this._drawFeatures);this._queryErrorHandler=m.hitch(this,this._queryErrorHandler)},startup:function(){this._started||this.inherited(arguments)},propertyChangeHandler:function(e){this._init&&(0===e?this._applyTimeFilter():3===e&&this._redrawAllTracks())},destroy:function(){this.inherited(arguments);clearTimeout(this._timeoutId);this._featuresByTime=this._drawBuffer=this._featureMap=null},drawFeature:function(e){var b=this.featureLayer,c=b.objectIdField;this._timeoutId||(this._timeoutId=
setTimeout(this._flushDrawBuffer,this._refreshRate));b._joinField&&this._getFeature(e.attributes[c])?this._drawBuffer.updates.push({oid:e.attributes[c],updates:e}):this._drawBuffer.adds.push(e)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){this._pendingRequest&&this._cancelPendingRequest(this._pendingRequest);var e=this.featureLayer;e&&(e._relatedUrl||e._keepLatestUrl?(e._fireUpdateStart(),e._refreshing=!0,e.disconnect(),e.clear(),e._relatedQueried=!1,e._keepLatestQueried=!1,
e.connect()):(e._fireUpdateStart(),e.clear(),e._fireUpdateEnd()))},_drawFeatures:function(e,b){var c=this.featureLayer;c._create(e.features||[]);c._fireUpdateEnd(null,b)},_applyTimeFilter:function(e){this.inherited(arguments);this._redrawAllTracks()},_removeFeatures:function(e){var b=this.featureLayer,c=b.objectIdField;e&&a.forEach(e,function(h){h=h.attributes[c];b._unSelectFeatureIIf(h,this);this._decRefCount(h);this._removeFeatureIIf(h)},this)},_addFeatures:function(e){var b=this.featureLayer,c=
b._endTimeField,h=b._startTimeField,g,k=[],w=[],t=[];var C=b._trackManager;var u=b.objectIdField;if(C)for(g in e=C.addFeatures(e),e)e.hasOwnProperty(g)&&(k.push(g),e[g].adds&&(w=w.concat(e[g].adds)),e[g].deletes&&(t=t.concat(e[g].deletes)));else w=e;a.forEach(w,function(x){var l=x.attributes[u];var v=c&&x.attributes[c];!v&&this._maxFeatureAge&&(v=h&&x.attributes[h]?x.attributes[h]+this._maxFeatureAge:Date.now()+this._maxFeatureAge);v&&(v=1E3*Math.ceil(v/1E3),this._featuresByTime[v]?this._featuresByTime[v].push(l):
this._featuresByTime[v]=[l]);this._addFeatureIIf(l,x);this._incRefCount(l)},this);t.length&&this._removeFeatures(t);C&&C.refreshTracks(k)},_updateFeatures:function(e){var b=this.featureLayer,c=[];var h=b._trackManager;var g=b._trackIdField;a.forEach(e,function(k){var w=k.updates;k=this._getFeature(k.oid);var t;if(k){w.geometry&&k.setGeometry(w.geometry);w=w.attributes||{};for(t in w)w.hasOwnProperty(t)&&(k.attributes[t]=w[t]);k.setAttributes(k.attributes);k.visible=this._checkFeatureTimeIntersects(k);
h&&k.attributes[g]?c.push(k.attributes[g]):b._repaint(k,null,!0)}},this);c.length&&h.refreshTracks(c)},_redrawAllTracks:function(){var e=this.featureLayer._trackManager,b;e&&(b=e.trimTracks())&&0<b.length&&(this._removeFeatures(b),e.refreshTracks())},_flushDrawBuffer:function(){clearTimeout(this._timeoutId);var e=this._drawBuffer,b=e.adds.splice(0,e.adds.length),c=e.updates.splice(0,e.updates.length);e=this.featureLayer;if(!e)return!1;e.updating||e._fireUpdateStart();this._addFeatures(b);this._updateFeatures(c);
(b=this._getExpiredFeatures())&&b.length&&(this._removeFeatures(b),e._trackManager&&e._trackManager.removeFeatures(b));e._purge();e._fireUpdateEnd();this._timeoutId=null},_clearDrawBuffer:function(){var e=this._timeoutId,b=this._drawBuffer,c=b.adds;b=b.updates;e&&clearTimeout(e);c.splice(0,c.length);b.splice(0,b.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime={};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(e){e=
e||0===e?e:200;0>e&&(e=200);this._refreshRate=e},_checkFeatureTimeIntersects:function(e){var b=this.featureLayer,c=b.getMap();return(c=c?c.timeExtent:null)&&b.timeInfo&&(b.timeInfo.startTimeField||b.timeInfo.endTimeField)?0<b._filterByTime([e],c.startTime,c.endTime).match.length:!0},_fetchArchive:function(e){var b=new D,c=this.featureLayer;this._pendingRequest&&this._cancelPendingRequest(this._pendingRequest);c._fireUpdateStart();if(e&&this.map){e=new n(e);var h=new q;var g=this.map;var k=c.getFilter()||
{};var w=k.where||"1\x3d1";var t=k.geometry?f.fromJson(k.geometry):null;k=k.outFields?k.outFields.split(","):["*"];h.geometry=t;h.where=w;h.outFields=k;h.returnGeometry=!0;h.outSpatialReference=new r(g.spatialReference.toJson());this._pendingRequest=e.execute(h).then(function(C){this._pendingRequest=null;var u=this._fixFieldNameCasing(c,C);C.features=u;this._drawFeatures(C);c._fireUpdateEnd();b.resolve()}.bind(this)).otherwise(function(C){this._pendingRequest=null;c._errorHandler(C);c._fireUpdateEnd(C);
b.reject(C)}.bind(this))}else b.resolve();return b.promise},_queryErrorHandler:function(e){var b=this.featureLayer;b._errorHandler(e);b._fireUpdateEnd(e)},_fixFieldNameCasing:function(e,b){var c=b.features||[],h=b.fields;if(!h||!c.length)return c;h=this._mapFieldNameDifferences(e.fields,h);for(var g=[],k,w,t=0,C=b.features.length;t<C;t++)k=c[t],w=this._swizzleResponseAttributes(k.attributes,h),g.push({geometry:k.geometry,attributes:w});return g},_mapFieldNameDifferences:function(e,b){var c=[],h={},
g;var k=0;for(g=b.length;k<g;k++)c.push(b[k].name);k=0;for(g=e.length;k<g;k++){var w=e[k].name,t=this._checkForStreamFieldName(w,c);t&&(h[t]=w)}return h},_checkForStreamFieldName:function(e,b){for(var c=e.toLowerCase(),h,g=0,k=b.length;g<k;g++)if(b[g].toLowerCase()===c){h=b[g];break}return h},_swizzleResponseAttributes:function(e,b){var c={},h;for(h in e)if(e.hasOwnProperty(h)){var g=e[h];b.hasOwnProperty(h)?c[b[h]]=g:c[h]=g}return c},_getExpiredFeatures:function(){var e,b,c=[],h=[];if(!this.featureLayer._endTimeField&&
!this._maxFeatureAge)return h;var g=1E3*Math.floor(this._lastEndTimeCheck/1E3);this._lastEndTimeCheck=e=1E3*Math.ceil(Date.now()/1E3);if(g&&g!==e)for(b=this._featuresByTime;g<=e;g+=1E3)b[g]&&(c=c.concat(b[g]),delete b[g]);a.forEach(c,function(k){(k=this._getFeature(k))&&h.push(k)},this);return h}});m.setObject("layers._StreamMode",F,y);return F})},"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/dom-construct dojox/gfx ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),
function(F,m,a,D,z,y,r,q,n,f){var d=-1!==y.renderer.toLowerCase().indexOf("canvas");F=F(null,{declaredClass:"esri.layers._TrackManager",constructor:function(e){this.layer=e;this.trackMap={};this.trackLineMap={}},initialize:function(e){this.map=e;e=this.layer;this.createTracklineContainer()&&(this._handles=[e.on("visibility-change",m.hitch(this,function(b){this.container.setVisibility(b.visible);this.container.evaluateSuspension()})),e.on("scale-range-change",m.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,
this.layer.maxScale)}))])},createTracklineContainer:function(){var e=this.layer;if("esriGeometryPoint"!==e.geometryType)return null;var b=this.map,c=e._getRenderer();c=c&&c.trackRenderer;var h=this.container=new f._GraphicsLayer({id:e.id+"_tracks",_child:!0,visible:e.visible,minScale:e.minScale,maxScale:e.maxScale});h.loaded=!0;h.onLoad(h);h._setMap(b,e._div);d||(b=h._div.getNode(),e=e._div.getNode(),b&&e&&z.place(b,e,"first"));h.setRenderer(c);return h},addFeatures:function(e){var b=this.trackMap,
c=this.layer,h=c._trackIdField,g=[];a.forEach(e,function(C){var u=C.attributes[h];(b[u]=b[u]||[]).push(C);-1===a.indexOf(g,u)&&g.push(u)});var k=c._startTimeField,w=c.objectIdField,t=function(C,u){var x=C.attributes[k],l=u.attributes[k];return x===l?C.attributes[w]<u.attributes[w]?-1:1:x<l?-1:1};a.forEach(g,function(C){b[C].sort(t)})},trimTracks:function(e){function b(w){for(w=c[w]||[];w.length>h;)g.push(w.shift())}var c=this.trackMap,h=this.layer.maximumTrackPoints||0,g=[],k;if(!h)return g;if(e)a.forEach(e,
function(w){b(w)});else for(k in c)c.hasOwnProperty(k)&&b(k);return g},drawTracks:function(e){function b(C){var u=k[C],x,l;var v=c.trackLineMap[C];h.remove(v);delete c.trackLineMap[C];v=null;if(!u||2>u.length)return!1;v=[];for(x=u.length-1;0<=x;x--)(l=u[x].geometry)&&v.push([l.x,l.y]);u={};u[t]=C;1<v.length&&(v=new q(new n({paths:[v],spatialReference:w}),null,u),h.add(v),c.trackLineMap[C]=v)}var c=this,h=this.container,g;if(h){var k=this.trackMap;var w=this.map.spatialReference;var t=this.layer._trackIdField;
if(e)a.forEach(e,function(C){b(C)});else for(g in k)k.hasOwnProperty(g)&&b(g)}},refreshTracks:function(e){function b(t){var C;c.drawTracks([t]);if(k&&k.latestObservationRenderer){t=h[t]||[];var u=t.length;for(C=0;C<u;C++)g._repaint(t[C],null,!0)}}var c=this,h=this.trackMap,g=this.layer,k=g._getRenderer(),w;if(e)a.forEach(e,function(t){b(t)});else for(w in h)h.hasOwnProperty(w)&&b(w);this.moveLatestToFront()},moveLatestToFront:function(e){a.forEach(this.getLatestObservations(e),function(b){var c=b._shape;
c&&c._moveToFront();this._repaint(b,null,!0)},this.layer)},getLatestObservations:function(e){function b(w){w=g[w];return w[w.length-1]}var c=[],h=this.layer._getRenderer(),g=this.trackMap,k;if(!h.latestObservationRenderer)return c;if(e)a.forEach(e,function(w){c.push(b(w))});else for(k in g)g.hasOwnProperty(k)&&c.push(b(k));return c},clearTracks:function(e){var b=this.getLatestObservations(e),c=this.container,h=this.trackMap,g;if(e)a.forEach(e,function(w){delete this.trackMap[w];c&&(k=this.trackLineMap[w],
c.remove(k),delete this.trackLineMap[w])},this);else{if(c)for(g in h){var k=this.trackLineMap[g];c.remove(k)}this.trackMap={};this.trackLineMap={}}a.forEach(b,function(w){this._repaint(w,null,!0)},this.layer)},isLatestObservation:function(e){var b=this.trackMap[e.attributes[this.layer._trackIdField]];return b?b[b.length-1]===e:!1},destroy:function(){a.forEach(this._handles,function(b){b.remove()});var e=this.container;e&&(e.clear(),e._unsetMap(this.map,this.layer._div));this.map=this.layer=this.trackMap=
this.container=null}});m.setObject("layers._TrackManager",F,r);return F})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b){function c(){}function h(g){var k=g.layer;return{geometry:g.geometry,attributes:g.attributes,getLayer:function(){return k}}}
F=F(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(g){this.sourceLayer=g;this._hndls=[]},initialize:function(g){this.map=g;var k=this.sourceLayer,w=k.renderer;k.setDrawMode(!1);this.imageLayer=g._getMapImageLyr();var t=this;this.heatmapRenderer=w instanceof d?w:(w.getRendererInfoByZoom(g.getZoom())||w.getRendererInfoByScale(g.getScale())).renderer;this.redraw=this.redraw.bind(this);this.recalculateHeatmap=
this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=this._reprojectFeature.bind(this);z(["../workers/heatmapCalculator"],function(C){t._calculator=new C(m.mixin({width:t.map.width,height:t.map.height},t._getOptions()));t._setupRenderer();
t.heatmapRenderer.getStats=C.calculateStats;t.heatmapRenderer.getHistogramData=C.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},_handleRendererChange:function(g){var k=g.renderer,w=k instanceof d;this.heatmapRenderer?w?this.heatmapRenderer=k:this._removeRenderer(g):w&&(this.heatmapRenderer=k,this.sourceLayer&&this.map&&
this._setupRenderer())},_handleOpacityChange:function(g){g=g.opacity;var k=this._getImageBySourceId(this.sourceLayer.id);k&&k.setOpacity(g)},_setupRenderer:function(){var g=this._hndls,k=this.sourceLayer,w=this.map,t=this;k._originalDraw=k._draw;k._draw=c;k._div.clear();clearTimeout(this._resetTimer);this._resetTimer=setTimeout(this._resetGraphics.bind(this),250);g.push(k.on("update-end",this.redraw));g.push(k.on("suspend",function(C){(C=t._getImageBySourceId(t.sourceLayer.id))&&C.hide()}));g.push(k.on("resume",
function(C){(C=t._getImageBySourceId(t.sourceLayer.id))&&C.show()}));g.push(a.after(k,"redraw",this.redraw));g.push(w.on("layer-remove",function(C){C.layer==k&&((C=t._getImageBySourceId(t.sourceLayer.id))&&t.imageLayer.removeImage(C),t._removeRenderer({target:k}))}));k._collection&&g.push(k.on("graphic-add",function(C){t._reprojectFeature(C.graphic);t.redraw()}));1!==k.mode&&(g.push(w.on("resize, pan-end",this.redraw)),g.push(w.on("zoom-end",this.redraw)));g.push(k.on("opacity-change",this._handleOpacityChange));
this.imageLayer.suspended&&this.imageLayer.resume();k.graphics&&k.graphics.length&&(k.graphics[0].geometry&&!w.spatialReference.equals(k.graphics[0].geometry.spatialReference)&&D.forEach(k.graphics,function(C){this._reprojectFeature(C)}.bind(this)),this.redraw())},redraw:function(){if(!this._drawTimer){var g=this;this._drawTimer=setTimeout(function(){clearTimeout(g._drawTimer);g._drawTimer=null;g.sourceLayer._getRenderer().isInstanceOf(d)&&g.recalculateHeatmap()},16)}},_removeRenderer:function(g){var k=
g.target;k._draw=k._originalDraw;delete k._originalDraw;k.setDrawMode(!0);this._removeHandlers();this._hndls=[];var w=this._getImageBySourceId(this.sourceLayer.id);w&&this.imageLayer.removeImage(w);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);this._drawTimer=this._resetTimer=null;k.renderer!=g.renderer&&k.renderer.getRendererInfo?this.heatmapRenderer=null:(this.destroy(),k.renderer&&k.renderer.getRendererInfo&&k.redraw())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():
this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(g){if(g&&g.geometry){var k=g.geometry,w=this.map.spatialReference;w.equals(k.spatialReference)||(k=n.project(k,w),null!=k&&(g.geometry=k))}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var g=this.sourceLayer,k=this.map,w=this.heatmapRenderer,t=this.map.extent,C=this.map.width,u=this.map.height,x=this._calculator,l=this,v=function(B){B=l._getScreenPoints(B.features,k,g);B=x.calculateImageData(m.mixin({screenPoints:B,
mapinfo:{extent:[t.xmin,t.ymin,t.xmax,t.ymax],resolution:k.getResolution()},width:C,height:u},l._getOptions()));B=w.getSymbol(h({geometry:k.extent,attributes:{size:[C,u],imageData:B},layer:g}));B=new f({extent:k.extent,href:B.url,opacity:0,sourceId:g.id});l._swapMapImages(B,l._getImageBySourceId(g.id));g.suspended&&B.hide()},A={geometry:k.extent,timeExtent:g.useMapTime?k.timeExtent:void 0,spatialRelationship:e.SPATIAL_REL_INTERSECTS};null!=g._canDoClientSideQuery(A)?g.queryFeatures(A,v):v({features:g.graphics})},
_getScreenPoints:function(g,k,w){var t=[],C=g.length,u=0,x=0,l=new q(k.extent.xmin,k.extent.ymax,k.spatialReference),v=k.toScreen(l),A=v.x;v=v.y;var B=k.getResolution(),E;for((x=k.extent.getCacheValue("_parts"))&&(E=D.map(x,function(I){return w._intersects(k,I.extent)[0]}));C--;)if(x=g[C],x.geometry&&x.visible){var G={x:Math.ceil((x.geometry.x-l.x)/B+A),y:Math.floor((l.y-x.geometry.y)/B-v),attributes:x.attributes};E&&(x=1<E.length&&G.x<-E[0]?E[1]:E[0],G.x+=x);t[u++]=G}return t},_getImageBySourceId:function(g){var k=
this.imageLayer.getImages();k=D.filter(k,function(w){return w.sourceId==g});if(k.length)return k[k.length-1]},_swapMapImages:function(g,k){function w(){t.removeImage(k)}var t=this.imageLayer,C=this.sourceLayer.opacity;t.addImage(g);b.anim(g._node,{opacity:C},null,null,function(){g.opacity=C});null!=k&&b.anim(k._node,{opacity:0},null,null,w)},_removeHandlers:function(){if(null!=this._hndls)for(var g=this._hndls.length;g--;)this._hndls[g].remove()},_getOptions:function(){var g=this.heatmapRenderer;
return{blurRadius:g.blurRadius,gradient:g.gradient,maxPixelIntensity:g.maxPixelIntensity,minPixelIntensity:g.minPixelIntensity,field:g.field,fieldOffset:g.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);this._resetTimer=null;for(var g=this.sourceLayer.graphics,k=g.length,w;k--;)w=g[k],w._shape=w._offsets=void 0}});m.setObject("layers.HeatmapManager",F,y);return F})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),
function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.layers.MapImage",constructor:function(q){m.mixin(this,q);this.extent=new r(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},show:function(){if(!this.visible){this.visible=!0;var q=this._node,n=this._layer,f;if(q){if(f=n&&n._div)n.suspended||n._setPos(q,f._left,f._top),(n._active||f).appendChild(q);y.show(q)}}},hide:function(){if(this.visible){this.visible=!1;var q=this._node;q&&(y.hide(q),
q.parentNode&&q.parentNode.removeChild(q))}},setOpacity:function(q){var n=this._node;this.opacity=q;n&&a.set(n,"opacity",q)}});m.setObject("layers.MapImage",F,z);return F})},"esri/layers/clustering/ClusterManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../kernel ../../Evented ../../graphic ../../lang ../../Color ../../graphicsUtils ../../dijit/PopupTemplate ../../dijit/Legend/utils ../../renderers/ClassBreaksRenderer ../../symbols/SimpleMarkerSymbol ../support/attributeUtils ../GraphicsLayer ../Field ./GeohashAggregation ./statUtils dojo/i18n!../../nls/jsapi".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C){var u=C.layers.clusters,x=C.widgets.popup,l=u.numFeatures,v=Math.pow(2,53)-1;F=F(y,{declaredClass:"esri.layers.clustering.ClusterManager",layer:null,aggregationInfo:null,container:null,defaults:{clusterRadius:80,markerSymbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}},_initialized:!1,_map:null,_eventHandles:null,_clusterRadius:null,
_renderer:null,_statisticInfos:null,_fields:null,_infoTemplate:null,_clusterGenerator:null,_singleGraphics:null,constructor:function(A){this._eventHandles=[];this.layer=A.layer;this.setAggregationInfo(A.aggregationInfo)},initialize:function(A){this._initialized=!0;this._map=A;this._removeFromPopup(this.layer);this.container=this._createContainer();this._clusterGenerator=this._createClusterGenerator();this._initClusterGenerator();this._createLayerEventListeners();this._createMapEventListeners();this._createPopupEventListeners()},
destroy:function(A){this._clearSingleGraphics();this._removeClusterBoundary();this._destroyEventListeners();this._removeFromPopup(this.container);this._removeFromPopup(this.layer);this._resetClusterNav();this._destroyClusterGenerator(A);this._destroyContainer();this.layer=this.aggregationInfo=this._map=null},setAggregationInfo:function(A){this.aggregationInfo=A?m.mixin({},A):null;this._applyAggregationInfo()},getClusterRenderer:function(){return this._renderer},getClusterFields:function(){return this._fields||
[]},getFeaturesInCluster:function(A){A=A&&A.getAggregationInfo();return this._clusterGenerator?this._clusterGenerator.getFeaturesInCluster(A):[]},getAggregateGraphics:function(){return this.container?this.container.graphics.slice(0):[]},getSingleGraphics:function(){return this._singleGraphics?this._singleGraphics.slice(0):[]},redraw:function(){this.container&&this.container.redraw()},isClusteringEnabled:function(){return!(!this._clusterGenerator||!this._clusterGenerator.clustersEnabled)},isClusteringActive:function(){return!!(this._clusterGenerator&&
0<this._clusterGenerator.getNumFeatures())},toggleFeatureVisibility:function(A){this._clusterGenerator&&this._clusterGenerator.toggleFeatureVisibility(A)},_createContainer:function(){var A=this.layer,B=new g._GraphicsLayer({_child:!0,id:A.id+"_clusters",visible:A.visible,minScale:A.minScale,maxScale:A.maxScale,infoTemplate:this._infoTemplate});B.fields=this._fields;B.setRenderer(this._renderer);B.loaded=!0;B.onLoad(B);B._setMap(this._map,A._div);return A._childLayer=B},_destroyContainer:function(){var A=
this.container;A&&(A.clear(),A._unsetMap(this._map,this.layer._div),this.layer._childLayer=null);this.container=null},_createClusterGenerator:function(){return new w({map:this._map,layer:this.layer,clusterRadius:this._clusterRadius,statisticInfos:this._statisticInfos})},_initClusterGenerator:function(){var A=this._clusterGenerator;A.loaded?this._awaitClusterGenerator():this._eventHandles.push(A.on("load",m.hitch(this,function(){this._awaitClusterGenerator()})),A.on("load-error",m.hitch(this,function(B){})))},
_destroyClusterGenerator:function(A){this._clusterGenerator&&this._clusterGenerator.destroy(A);this._clusterGenerator=null},_awaitClusterGenerator:function(){var A=this._clusterGenerator;A.started?(this._applyRenderer(),this._initClusterUpdates()):this._eventHandles.push(A.on("start",m.hitch(this,function(){this._applyRenderer();this._initClusterUpdates()})))},_applyAggregationInfo:function(){this._applyClusterRadius();this._applyRenderer();this._clusterGenerator&&!this._clusterGenerator.isUpdateScheduled()&&
this.redraw()},_applyClusterRadius:function(){var A=this.aggregationInfo;this._clusterRadius=A&&A.clusterRadius||this.defaults.clusterRadius;this._clusterGenerator&&this._clusterGenerator.setClusterRadius(this._clusterRadius);this._computeClusterRadius()},_computeClusterRadius:function(){var A=this.aggregationInfo||{};A.clusterRadius=this._clusterRadius;this.aggregationInfo=A},_applyRenderer:function(){var A=this.container,B=this._getClusterRendererInfo(),E=this._compareStatInfos(this._statisticInfos,
B.statisticInfos);E&&(this._statisticInfos=B.statisticInfos,this._clusterGenerator&&(this._clusterGenerator.setStatisticInfos(a.map(this._statisticInfos,function(G){return{attributeInfo:G.attributeInfo,statisticType:G.statisticType}})),A&&a.forEach(A.graphics,function(G){this._applyClusterAttributes(G,G.getAggregationInfo())},this)));this._renderer=B.renderer;this._applyFields();this._applyInfoTemplate(!!E&&this._initialized);A&&(A.setRenderer(this._renderer),this.emit("renderer-change"))},_applyFields:function(){this._fields=
this._getFields(this._statisticInfos);this.container&&(this.container.fields=this._fields)},_applyInfoTemplate:function(A){var B=this.aggregationInfo,E=B&&B.disablePopup;this.layer.infoTemplate&&!E?(B=B&&B.infoTemplate||this._infoTemplate,A=A||!B?this._createInfoTemplate():this._updateInfoTemplate(B)):A=null;this._infoTemplate=A;this.container&&this.container.setInfoTemplate(this._infoTemplate);this._computeInfoTemplate()},_computeInfoTemplate:function(){var A=this.aggregationInfo||{};A.infoTemplate=
this._infoTemplate;this.aggregationInfo=A},_getClusterRendererInfo:function(){var A=this.layer&&this.layer.renderer;return A?this._createClusterRenderer(A):this._getDefaultClusterRenderer()},_getDefaultClusterRenderer:function(){var A=this._createContinuousCountRenderer();this._addSizeByCountVariable(A);return{renderer:A,statisticInfos:[]}},_createContinuousCountRenderer:function(A){var B=new b(null,"cluster_count");B.addBreak({minValue:-v,maxValue:v,symbol:A?new A.constructor(A.toJson()):new c(m.clone(this.defaults.markerSymbol))});
return B},_createClusterRenderer:function(A){if(!this._isSupportedRenderer(A))return this._getDefaultClusterRenderer();var B=[];if(this._isSimpleRenderer(A))var E=this._createContinuousCountRenderer(A.symbol);else{E=new A.constructor(A.toJson());var G=this._getRendererAttributeInfo(A);if(this._isCBRenderer(E)){var I=t.getClusterField(G,"avg");B.push(this._getStatInfo(G,"avg"));E.normalizationType=null;E.normalizationField=null;E.normalizationTotal=null}else this._isUVRenderer(E)&&(I=t.getClusterField(G,
"type"),B.push(this._getStatInfo(G,"type")));E.attributeField=I;E.setValueExpression(null);E.valueExpressionTitle=null;E.setVisualVariables(null);this._setRendererTitle(E,A)}A=this._getSupportedVariables(A);G=this._createClusterVariables(A.allVars,B);E.setVisualVariables(G);A.sizeVars.length||this._isCBSizeRenderer(E)||this._addSizeByCountVariable(E);return{renderer:E,statisticInfos:B}},_isSupportedRenderer:function(A){if(this._isSimpleRenderer(A))return!0;if(this._isCBRenderer(A)){var B=A.normalizationType;
return"function"===typeof A.attributeField||B&&"field"!==B?!1:!0}return this._isUVRenderer(A)?"function"===typeof A.attributeField||A.attributeField2?!1:!0:!1},_isSimpleRenderer:function(A){return-1<A.declaredClass.toLowerCase().indexOf("simplerenderer")},_isCBRenderer:function(A){return-1<A.declaredClass.toLowerCase().indexOf("classbreaksrenderer")},_isUVRenderer:function(A){return-1<A.declaredClass.toLowerCase().indexOf("uniquevaluerenderer")},_isCBSizeRenderer:function(A){var B=A.infos;if(!this._isCBRenderer(A)||
!B||2>B.length)return!1;var E=Infinity,G=-Infinity;a.forEach(B,function(I){if(I=I.symbol){var L=0;switch(I.type){case "simplemarkersymbol":L=I.size;break;case "picturemarkersymbol":L=(I.width+I.height)/2}E=Math.min(E,L);G=Math.max(G,L)}});return Infinity!==E&&-Infinity!==G&&E!==G},_getRendererAttributeInfo:function(A){var B=A.attributeField,E=B?this.layer.getField(B):null;return{field:B,attributeType:E&&"esriFieldTypeDate"===E.type?"date":null,rotationType:null,valueExpression:A.valueExpression,valueExpressionTitle:A.valueExpressionTitle,
normalizationField:A.normalizationField}},_setRendererTitle:function(A,B){A.legendOptions=m.clone(B.legendOptions);A.legendOptions&&A.legendOptions.title||(A.legendOptions=A.legendOptions||{},A.legendOptions.title=e.getRendererTitle(B,this.layer))},_getSupportedVariables:function(A){var B=A.getVisualVariablesForType("colorInfo",!1)||[],E=A.getVisualVariablesForType("sizeInfo",!1)||[],G=A.getVisualVariablesForType("opacityInfo",!1)||[];A=A.getVisualVariablesForType("rotationInfo",!1)||[];B=a.filter(B,
this._variableFilter);E=a.filter(E,this._variableFilter);G=a.filter(G,this._variableFilter);A=a.filter(A,this._variableFilter);return{sizeVars:E,allVars:B.concat(E).concat(G).concat(A)}},_variableFilter:function(A){return"function"!==typeof A.field&&!h.viewScaleRE.test(A.valueExpression)},_createClusterVariables:function(A,B){return a.map(A,function(E){return this._createVarForAvg(E,B)},this)},_createVarForAvg:function(A,B){var E=m.clone(A),G=this._getVariableAttributeInfo(A);E.field=t.getClusterField(G,
"avg");E.normalizationField=null;E.valueExpression=null;E.valueExpressionTitle=null;G=this._getStatInfo(G,"avg");this._addStatInfo(B,G);this._setVariableTitle(E,A);return E},_getVariableAttributeInfo:function(A){var B="rotationInfo"===A.type,E=B?"angle":null;B=B?A.rotationType:null;var G=A.legendOptions&&A.legendOptions.title,I=A.field,L=I?this.layer.getField(I):null;L&&"esriFieldTypeDate"===L.type&&(E="date");return{field:I,attributeType:E,rotationType:B,valueExpression:A.valueExpression,valueExpressionTitle:A.valueExpressionTitle||
A.valueExpression&&G,normalizationField:A.normalizationField}},_setVariableTitle:function(A,B){A.legendOptions&&A.legendOptions.title||(A.legendOptions=A.legendOptions||{},A.legendOptions.title=e.getVisualVariableTitle(B,this.layer))},_getStatInfo:function(A,B){return{statisticHash:t.getStatisticHash(A,B),attributeInfo:A,statisticType:B}},_addStatInfo:function(A,B){var E=this._findStatInfo(A,B);E?E.attributeInfo.valueExpressionTitle||(E.attributeInfo.valueExpressionTitle=B.attributeInfo.valueExpressionTitle):
A.push(B)},_findStatInfo:function(A,B){var E;a.some(A,function(G){G.statisticHash===B.statisticHash&&(E=G);return!!E});return E},_compareStatInfos:function(A,B){var E=a.filter(A,function(I){return!this._findStatInfo(B,I)},this),G=a.filter(B,function(I){return!this._findStatInfo(A,I)},this);return G.length||E.length?{added:G,removed:E}:null},_addSizeByCountVariable:function(A){var B=this._createSizeByCountVariable();B&&this._addVariable(A,B)},_getSizeByCountVariable:function(A){A=A.getVisualVariablesForType("sizeInfo",
!1)||[];return a.filter(A,function(B){return"cluster_count"===B.field})[0]},_updateSizeByCountVariable:function(){var A=this._renderer,B=this._getSizeByCountVariable(A);if(B){var E=this._createSizeByCountVariable();E&&this._replaceVariable(A,B,E)}},_createSizeByCountVariable:function(){var A=this._clusterGenerator;if(A){var B=A.getCurrentLodStats();if(B){var E=A.getNumFeatures();A=A.clusters;var G=B.min,I=B.max;1===B.count&&G===E||1===A.length&&A[0].count===E?(G=1,I=E):G&&G===I&&(I=2*G);E={type:"sizeInfo",
field:"cluster_count",valueUnit:"unknown",minSize:12,maxSize:50,minDataValue:G,maxDataValue:I,legendOptions:{title:l}}}}return E},_addVariable:function(A,B){var E=A.visualVariables||[];E.push(B);A.setVisualVariables(E)},_replaceVariable:function(A,B,E){var G=A.visualVariables;B=a.indexOf(G,B);-1<B&&G.splice(B,1);G.push(E);A.setVisualVariables(G)},_getFields:function(A){var B=[new k({name:"cluster_count",type:"esriFieldTypeInteger"})];a.forEach(A,function(E){var G=E.statisticType;E=E.attributeInfo;
var I;"avg"===G?I="date"===E.attributeType?"esriFieldTypeDate":"esriFieldTypeDouble":"type"===G&&(I=E.field?this.layer.getField(E.field).type:"esriFieldTypeString");B.push(new k({name:t.getClusterField(E,G),type:I}))},this);return B},_createInfoTemplate:function(){var A=this._statisticInfos,B=this._renderer,E=[{fieldName:"cluster_count",label:l,visible:!0,format:{digitSeparator:!0,places:0}}],G=[],I=[q.substitute({count:"{cluster_count}"},u.countSummary)],L=this._isUVRenderer(B)?B.infos:[];a.forEach(A,
function(K){var ba=K.statisticType,T=K.attributeInfo,P=t.getClusterField(T,ba),J=this._getFieldLabel(K);if("avg"===ba){var N={fieldName:P,label:J,visible:!0,format:"date"===T.attributeType?{dateFormat:"shortDateShortTime"}:{digitSeparator:!0,places:1}};var Z=this._getFieldSummary(K,P)}else"type"===ba&&(Z="expression/"+P,N={fieldName:Z,visible:!0},G.push({name:P,title:J,returnType:"string",expression:this._getExpression(L,P)}),Z=this._getFieldSummary(K,Z));N&&E.push(N);Z&&I.push(Z)},this);return this._createPopupTemplate({fieldInfos:E,
expressionInfos:G,description:I.join("\x3cbr/\x3e\x3cbr/\x3e")})},_updateInfoTemplate:function(A){var B=A.toJson(),E=this._isUVRenderer(this._renderer)?this._renderer.infos:[];a.forEach(this._statisticInfos,function(G){var I=G.statisticType;G=t.getClusterField(G.attributeInfo,I);"type"===I&&(I=this._findExpressionInfo(G,B))&&(I.expression=this._getExpression(E,G))},this);return this._createPopupTemplate(B)},_createPopupTemplate:function(A){var B=new d(A),E=B.title;B.setTitle(m.hitch(this,function(G){var I=
this._map&&this._map.infoWindow;if("esri.dijit.PopupMobile"!==(I&&I.declaredClass)||B.info.title)return E.call(B,G);G=(G=G.attributes)&&G.cluster_count;return null==G?"":q.substitute({count:G},u.countTitle)}));return B},_findExpressionInfo:function(A,B){var E;a.some(B.expressionInfos,function(G){G.name===A&&(E=G);return!!E});return E},_escapeDoubleQuotes:function(A){return A?A.replace(/"/g,'\\"'):""},_getExpression:function(A,B){return["var uvInfos \x3d ["+this._getObjects(A).join(", ")+"];",'var predominantType \x3d Text($feature["'+
B+'"]);','var label \x3d "'+this._escapeDoubleQuotes(u.predominantNoneValue)+'";',"for (var i \x3d 0; i \x3c Count(uvInfos); i++) {\nif (uvInfos[i].value \x3d\x3d predominantType) {\nlabel \x3d uvInfos[i].label;\nbreak;\n}\n}\nreturn label;"].join("\n")},_getObjects:function(A){return a.map(A,function(B){return'{"value": "'+String(B.value)+'","label": "'+this._escapeDoubleQuotes(String(B.label))+'"}'},this)},_getFieldLabel:function(A){var B=A.statisticType,E=A.attributeInfo,G=E.field;A=E.normalizationField;
var I="";if("avg"===B)var L=A?u.avgNormFieldLabel:u.avgFieldLabel;else"type"===B&&(L=u.predominantFieldLabel);L&&(B=E.valueExpression?E.valueExpressionTitle:this.layer.getFieldLabel(G),A=A&&this.layer.getFieldLabel(A),I=q.substitute({fieldLabel:B||"",normFieldLabel:A||""},L));return I},_getFieldSummary:function(A,B){var E=A.statisticType,G=A.attributeInfo,I=G.field,L=G.normalizationField,K="";if("avg"===E)var ba=L?u.avgNormFieldSummary:u.avgFieldSummary;else"type"===E&&(ba=u.predominantFieldSummary);
ba&&(E=G.valueExpression?G.valueExpressionTitle:this.layer.getFieldLabel(I),L=L&&this.layer.getFieldLabel(L),K=q.substitute({fieldLabel:E||"",normFieldLabel:L||"",fieldValue:"{"+B+"}"},ba));return K},_removeFromPopup:function(A){var B=this._map.infoWindow,E=B.features;if(E&&E.length){var G=a.filter(E,function(I){return I.getLayer()!==A});G.length<E.length&&(G.length?B.setFeatures(G):(B.clearFeatures(),B.hide()))}},_resetClusterNav:function(){this._resetClusterNavPartial();this._popupClusterGraphic=
null},_resetClusterNavPartial:function(){this._map.infoWindow.removeActions&&this._map.infoWindow.removeActions(this._popupActions);this._hideSingleGraphic(this._popupSingleGraphic);this._popupSingleGraphic=null},_addClusterBoundary:function(A,B){var E=B.clusterFillSymbol;E&&(E=new E.constructor(E.toJson()));E=new r(A,E);this._map.graphics.add(E);this._clusterBoundary=E},_removeClusterBoundary:function(){this._map.graphics.remove(this._clusterBoundary);this._clusterBoundary=null},_createBrowseFeaturesAction:function(){return this._map.infoWindow.addActions([{title:x.NLS_browseFeatures,
className:"browseFeatures",callback:m.hitch(this,function(A){A.preventDefault();A=this._map.infoWindow;var B=A.getSelectedFeature(),E=B.getChildGraphics(),G=A.getCurrentAnchor();A.setFeatures(E,{anchor:G});if(E=f.graphicsExtent(E))this._addClusterBoundary(E,A),A.show(this._getPopupLocation(E,G));this._popupClusterGraphic=B})}])[0]},_getPopupLocation:function(A,B){var E=A.getCenter();B=B.toLowerCase();-1<B.indexOf("top")?E.update(E.x,A.ymax):-1<B.indexOf("bottom")?E.update(E.x,A.ymin):-1<B.indexOf("left")?
E.update(A.xmin,E.y):E.update(A.xmax,E.y);return E},_createViewSummaryAction:function(){return this._map.infoWindow.addActions([{title:x.NLS_viewSummary,className:"viewSummary",callback:m.hitch(this,function(A){A.preventDefault();A=this._popupClusterGraphic;var B=this._map.infoWindow;B.setFeatures([A]);B.show(A.geometry);this._popupClusterGraphic=null})}])[0]},_initClusterUpdates:function(){this._updateSizeVariable();this._updateClusterGraphics();this._eventHandles.push(this._clusterGenerator.on("update-end",
m.hitch(this,function(A){(A.mapLevelChange||A.indexChange)&&this._updateSizeVariable();this._updateClusterGraphics()})),this._clusterGenerator.on("index-complete",m.hitch(this,function(){this._updateSizeVariable()})))},_updateClusterGraphics:function(){this._hideSingleGraphics();var A=[],B=[];a.forEach(this._clusterGenerator.clusters,function(E){var G=new r(E.centroid);G.setAggregationSourceLayer(this.layer);G.setAggregationInfo(E);this._applyClusterAttributes(G,E);1===E.count?(E=this._getSingleGraphic(G),
B.push(E)):A.push(G)},this);this._showSingleGraphics(B);this._addGraphics(A)},_addGraphics:function(A){var B=this.container;B.clear();a.forEach(A,function(E){B.add(E)})},_getSingleGraphic:function(A){var B=this._clusterGenerator.getCell(A.getAggregationInfo().primary).features[0],E=this.layer.renderer;E=E&&E.getSymbol(B);var G=this._getSizeByCountVariable(this._renderer);E&&G&&(A=G?this._renderer.getSize(A,{sizeInfo:G,shape:E.style,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):
null,B.setSize(A));return B},_showSingleGraphics:function(A){a.forEach(A,this._showSingleGraphic);this._singleGraphics=A},_hideSingleGraphics:function(){a.forEach(this._singleGraphics,function(A){A.setSize(null);this._hideSingleGraphic(A)},this);this._singleGraphics=null},_clearSingleGraphics:function(){a.forEach(this._singleGraphics,function(A){A.setSize(null)});this._singleGraphics=null},_showSingleGraphic:function(A){A&&A._resume()},_hideSingleGraphic:function(A){A&&A._suspend()},_updateSizeVariable:function(){this.isClusteringEnabled()&&
(this._updateSizeByCountVariable(),this.emit("renderer-change"))},_applyClusterAttributes:function(A,B){A.setAttributes(B.attributes)},_createLayerEventListeners:function(){var A=this.layer;this._eventHandles.push(A.on("visibility-change",m.hitch(this,function(B){this.container.setVisibility(B.visible)})),A.on("scale-range-change",m.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)})),A.on("renderer-change",m.hitch(this,function(){this._applyRenderer()})),
A.on("info-template-change",m.hitch(this,function(){this._applyInfoTemplate()})))},_createMapEventListeners:function(){this._eventHandles.push(this._map.on("zoom-start",m.hitch(this,function(){this._removeClusterBoundary();this._removeFromPopup(this.container);this._removeFromPopup(this.layer);this._resetClusterNav();this.container.clear();this._hideSingleGraphics()})))},_createPopupEventListeners:function(){var A=this._map.infoWindow;this._eventHandles.push(A.on("selection-change",m.hitch(this,function(){this._resetClusterNavPartial();
var B=this._map.infoWindow.getSelectedFeature(),E=B&&B.getLayer();if(E){var G;E===this.container?(this._removeClusterBoundary(),this._map.infoWindow.addActions&&(G=this._createBrowseFeaturesAction())):E===this.layer&&B._isSuspended()?(this._map.infoWindow.addActions&&(G=this._createViewSummaryAction()),this._popupSingleGraphic=B,this._showSingleGraphic(this._popupSingleGraphic)):this._removeClusterBoundary();this._popupActions=G?[G]:null}})),A.on("clear-features",m.hitch(this,function(B){this._resetClusterNav();
B.isIntermediate||this._removeClusterBoundary()})),A.on("hide",m.hitch(this,function(){this._popupSingleGraphic&&this._popupSingleGraphic._suspend();this._clusterBoundary&&this._clusterBoundary.hide()})),A.on("show",m.hitch(this,function(){this._popupSingleGraphic&&this._popupSingleGraphic._resume();this._clusterBoundary&&this._clusterBoundary.show()})))},_destroyEventListeners:function(){a.forEach(this._eventHandles,function(A){A.remove()})}});m.setObject("layers.clustering.ClusterManager",F,z);
return F})},"esri/dijit/Legend/utils":function(){define(["dojo/_base/lang","../../lang","dojo/i18n!../../nls/jsapi"],function(F,m,a){var D=a.widgets.legend;return{getVisualVariableTitle:function(z,y){var r=z.field,q=z.normalizationField,n=!1,f=!1,d=!1,e;r=F.isFunction(r)?null:r;q=F.isFunction(q)?null:q;if(z.legendOptions&&z.legendOptions.title)var b=z.legendOptions.title;else if(z.valueExpressionTitle)b=z.valueExpressionTitle;else{if(y.renderer&&y.renderer.authoringInfo&&y.renderer.authoringInfo.visualVariables){var c=
y.renderer.authoringInfo.visualVariables;for(e=0;e<c.length;e++){var h=c[e];if("colorInfo"===h.type&&"ratio"===h.style){n=!0;break}else if("colorInfo"===h.type&&"percent"===h.style){f=!0;break}else if("colorInfo"===h.type&&"percentTotal"===h.style){d=!0;break}}}(n=d&&"showRatioPercentTotal"||f&&"showRatioPercent"||n&&"showRatio"||q&&"showNormField"||r&&"showField"||null)&&(b=m.substitute({field:r&&y.getFieldLabel(r),normField:q&&y.getFieldLabel(q)},"showField"===n?"${field}":D[n]))}return b},getRendererTitle:function(z,
y){if(z){if("esri.renderer.ClassBreaksRenderer"===z.declaredClass){var r=z.attributeField;var q=z.normalizationField;var n="percent-of-total"===z.normalizationType}r=F.isFunction(r)?null:r;q=F.isFunction(q)?null:q;if(z.legendOptions&&z.legendOptions.title)var f=z.legendOptions.title;else z.valueExpressionTitle?f=z.valueExpressionTitle:(n=q&&"showNormField"||(n?"showNormPct":null)||r&&"showField"||null)&&(f=m.substitute({field:r&&y.getFieldLabel(r),normField:q&&y.getFieldLabel(q)},"showField"===n?
"${field}":D[n]))}return f}}})},"esri/layers/clustering/GeohashAggregation":function(){define("dojo/has dojo/_base/declare dojo/_base/lang dojo/_base/array ../../kernel ../../Evented ../../geometry/Point ../../geometry/Extent ../../geometry/mathUtils ../../support/expressionUtils ../../core/timerUtils ../support/attributeUtils ./geohashUtils ./statUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c){F=m(y,{loaded:!1,started:!1,map:null,layer:null,lod:null,tolerance:null,clusterMode:null,clusterRadius:null,
sortEnabled:!0,filterEnabled:!0,bufferEnabled:!0,updateEnabled:!0,clusters:null,clustersEnabled:!0,statisticInfos:null,defaults:{lod:1,tolerance:0,clusterMode:"auto",clusterRadius:80,sortEnabled:!0,filterEnabled:!0,bufferEnabled:!0,updateEnabled:!0},_eventHandles:null,_updateHandle:null,_indexHandle:null,_cellIndex:null,_globalIndex:null,_perfProfile:null,_indexUpdated:!1,_cellSizeScaleFactor:1.5,_extentScaleFactor:1.25,_maxGeohashLength:12,_minClusterRadius:15,_levelChange:!0,_clusterFieldPrefix:"cluster_",
_mapLevelChange:!1,constructor:function(h){this._update=a.hitch(this,this._update);this._indexFeatures=a.hitch(this,this._indexFeatures);this._eventHandles=[];this._globalIndex={numFeatures:null,fullExtent:null,lodStats:null};this._perfProfile={lastIndex:{total:null,numFeatures:0},lastUpdate:{cells:null,clusters:null,total:null}};this.clusters=[];this.map=h.map;this.layer=h.layer;this.setLod(h.lod);this.setTolerance(h.tolerance);this.setClusterMode(h.clusterMode);this.setClusterRadius(h.clusterRadius);
this.setSortEnabled(h.sortEnabled);this.setFilterEnabled(h.filterEnabled);this.setBufferEnabled(h.bufferEnabled);this.setUpdateEnabled(h.updateEnabled);this.setStatisticInfos(h.statisticInfos);this._load();this.loaded?this._startup():this._eventHandles.push(this.on("load",a.hitch(this,this._startup)))},destroy:function(h){this._displayFeatures(!0,h);D.forEach(this._eventHandles,function(g){g.remove()});d.clearTimeout(this._updateHandle);d.clearTimeout(this._indexHandle);this._cellIndex=this._globalIndex=
this._eventHandles=this._updateHandle=this._indexHandle=this.map=this.layer=this.clusters=null},setLod:function(h){var g=this.lod;this.lod=h||this.defaults.lod;g!==this.lod&&this.update()},setTolerance:function(h){var g=this.tolerance;this.tolerance=h||this.defaults.tolerance;g!==this.tolerance&&this.update()},setClusterMode:function(h){var g=this.clusterMode;this.clusterMode=h||this.defaults.clusterMode;this._evalClusterParams();g!==this.clusterMode&&this.update()},setClusterRadius:function(h){var g=
this.clusterRadius;this.clusterRadius=null!=h?h:this.defaults.clusterRadius;this._evalClusterParams();g!==this.clusterRadius&&this.update()},setSortEnabled:function(h){var g=this.sortEnabled;this.sortEnabled=null!=h?!!h:this.defaults.sortEnabled;g!==this.sortEnabled&&this.update()},setFilterEnabled:function(h){var g=this.filterEnabled;this.filterEnabled=null!=h?!!h:this.defaults.filterEnabled;g!==this.filterEnabled&&this.update()},setBufferEnabled:function(h){var g=this.bufferEnabled;this.bufferEnabled=
null!=h?!!h:this.defaults.bufferEnabled;g!==this.bufferEnabled&&this.update()},setUpdateEnabled:function(h){var g=this.updateEnabled;(this.updateEnabled=null!=h?!!h:this.defaults.updateEnabled)&&g!==this.updateEnabled&&(this._mapLevelChange=!0,this.update())},setStatisticInfos:function(h){this.statisticInfos=h||[];this.loaded&&this._applyStatInfos(this.statisticInfos)},update:function(){this.loaded&&null==this._updateHandle&&(this._updateHandle=d.setTimeout(this._update,d.priority.HIGH))},isUpdateScheduled:function(){return null!=
this._updateHandle},index:function(){this.loaded&&null==this._indexHandle&&(this._indexHandle=d.setTimeout(this._indexFeatures,d.priority.HIGH))},getCell:function(h){return this._cellIndex[h.length][h]},getCluster:function(h){var g;D.some(this.clusters,function(k){-1<D.indexOf(k.geohashes,h)&&(g=k);return!!g});return g},getCellsInCluster:function(h){var g=[];D.forEach(h&&h.geohashes,function(k){(k=this.getCell(k))&&g.push(k)},this);return g},getFeaturesInCluster:function(h){var g=[];h=this.getCellsInCluster(h);
D.forEach(h,function(k){Array.prototype.push.apply(g,k.features)});return g},toggleFeatureVisibility:function(h){this.index()},getCurrentLodStats:function(){var h=this._globalIndex.lodStats;return h&&h[this.lod]},getNumFeatures:function(){return this._globalIndex.numFeatures},getFullExtent:function(){var h=this._globalIndex.fullExtent;return h&&Infinity!==h.xmin?new q(h):null},_load:function(){this._displayFeatures(!1);this._checkLoadStatus();this.map.loaded||this._eventHandles.push(this.map.on("load",
a.hitch(this,this._checkLoadStatus)));this.layer.loaded||this._eventHandles.push(this.layer.on("load",a.hitch(this,this._checkLoadStatus)))},_checkLoadStatus:function(){if(this.map.loaded&&this.layer.loaded){if("esriGeometryPoint"!==this.layer.geometryType)var h=Error("GeohashAggregation is supported only for points");else{var g=this.map.spatialReference;g.isWebMercator()||4326===g.wkid||(h=Error("GeohashAggregation is supported only when map spatial reference is WGS84 or WebMercator"))}h?(this.loadError=
h,this.emit("load-error",{error:h})):(this.loaded=!0,this.emit("load"))}},_startup:function(){this._evalUpdateStatus();this.index();this._processExtentChange();this._eventHandles.push(this.layer.on("update-end",a.hitch(this,this.index)),this.layer.on("edits-complete",a.hitch(this,this.index)),this.layer.on("graphics-clear",a.hitch(this,this.index)),this.layer.on("suspend",a.hitch(this,this._evalUpdateStatus)),this.layer.on("resume",a.hitch(this,this._evalUpdateStatus)),this.map.on("extent-change",
a.hitch(this,this._processExtentChange)))},_evalUpdateStatus:function(){this.setUpdateEnabled(!this.layer.suspended)},_processExtentChange:function(h){this._mapLevelChange=!(!h||!h.levelChange);this._evalClusterParams();this.update()},_update:function(){this._updateHandle=null;if(this.updateEnabled){this.emit("update-start");if(this.clustersEnabled){var h=this.map.geographicExtent;if(h){var g=this._getIntersectingCells(h);h=this._getClusters(g.cells,h);this.clusters=h.clusters;this._applyStatInfosToClusters();
g=g.profile;h=h.profile;var k=g.total+h.total;g.total=this._getElapsedTime(g.total);h.total=this._getElapsedTime(h.total);var w=this._perfProfile.lastUpdate={};w.cells=g;w.clusters=h;w.total=this._getElapsedTime(k)}}else this.clusters=[],this._perfProfile.lastUpdate=null;g=this._indexUpdated;this._indexUpdated=!1;h=this._mapLevelChange;this._mapLevelChange=!1;this.emit("update-end",{levelChange:this._levelChange,mapLevelChange:h,indexChange:g})}},_displayFeatures:function(h,g){var k=this.layer,w=
!h;k.suspendGraphics(w);!1!==g&&(w?k.clearNodes():k.redraw())},_indexFeatures:function(){this._indexHandle=null;var h=this._getTime();this._initializeIndexing();var g=0,k=this._globalIndex.fullExtent;D.forEach(this.layer.graphics,function(C){if(C.visible){var u=C.geometry,x=this._getLngLat(u);if(x){var l=u.getCacheValue("_geohash");void 0===l&&(l=b.pointToGeohash(x),u.setCacheValue("_geohash",l||null))}l&&(this._addGeohashToIndex(l,C,x),g++,this._updateExtent(k,x))}},this);this._applyStatInfosToIndex();
this._globalIndex.numFeatures=g;for(var w=this._globalIndex.lodStats,t=1;t<=this._maxGeohashLength;t++)w[t]=this._getLODStats(t,g);this._perfProfile.lastIndex.total=this._getElapsedTime(h,this._getTime());this._perfProfile.lastIndex.numFeatures=g;this._indexUpdated=!0;this.emit("index-complete");this.started||(this.started=!0,this.emit("start"));this.update()},_initializeIndexing:function(){this._globalIndex={numFeatures:0,fullExtent:{xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity},lodStats:{}};
for(var h=this._cellIndex=[],g=1;g<=this._maxGeohashLength;g++)h[g]={}},_getLngLat:function(h){if(h){var g=h.getLongitude();h=h.getLatitude();h=null!=g&&null!=h?{x:g,y:h}:null}return h},_addGeohashToIndex:function(h,g,k){for(var w=this._cellIndex,t="",C=0;C<this._maxGeohashLength;C++){t+=h[C];var u=w[t.length],x=u[t];x||(x=u[t]={count:0,centroid:{x:null,y:null},extent:{xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity},features:[],geohash:t,statistics:null});this._updateItem(x,1,k,!0);x.features.push(g)}},
_getLODStats:function(h,g){var k=this._cellIndex[h],w=0,t=Infinity,C=-Infinity,u=null,x;for(x in k){var l=k[x];w++;l.count<t&&(t=l.count);l.count>C&&(C=l.count)}0<w&&(u=Number((g/w).toFixed(2)));return{lod:h,count:w,min:Infinity===t?null:t,max:-Infinity===C?null:C,avg:u}},_evalClusterParams:function(){if(this.loaded&&"auto"===this.clusterMode){var h=this._getClusterParams(this.map.getResolutionInMeters(),this.clusterRadius,this._minClusterRadius);this._levelChange=this.lod!==h.lod;this.lod=h.lod;
this.tolerance=h.tolerance}},_getClusterParams:function(h,g,k){g<k&&(g=k);h=Math.ceil(h*g);g=this._getClosestLODRange(h).max;do k=this._getCellSize(g),(k=h>=this._cellSizeScaleFactor*k||1===k)||(g+=1);while(!k);k=h/this._getCellSize(g);return{lod:g,tolerance:h,multiplier:Number(k.toFixed(2))}},_getClosestLODRange:function(h){for(var g,k=this._maxGeohashLength;1<=k;k--)if(this._getCellSize(k)>=h){g=k;break}null==g&&(g=1);h=g+1;h>this._maxGeohashLength&&(h=this._maxGeohashLength);return{min:g,max:h}},
_getCellSize:function(h){h=b.getCellSizeInMeters(h);return Math.ceil(Math.min(h.width,h.height))},_sorter:function(h,g){var k=h.centroid,w=g.centroid;return h.count>g.count?-1:h.count<g.count?1:k.x>w.x?-1:k.x<w.x?1:0},_getIntersectingCells:function(h){var g=this._getTime();this.bufferEnabled&&(h=h.expand(this._extentScaleFactor));var k=b.getIntersecting(h,this.lod,this.bufferEnabled?this.tolerance:0);h=this._getTime();var w=[],t=this.tolerance,C=this.sortEnabled;D.forEach(k,function(u){(u=this.getCell(u))&&
w.push(u)},this);t&&C&&w.sort(this._sorter);k=this._getTime();return{cells:w,profile:{findCells:this._getElapsedTime(g,h),scanAndSortCells:this._getElapsedTime(h,k),total:k-g}}},_getClusters:function(h,g){var k=this._getTime(),w=[],t={},C={findCells:0};D.forEach(h,function(x,l){var v=this._createCluster(x,t,C);v&&w.push(v)},this);this._markIntersecting(w,g);this.filterEnabled&&(w=this._getIntersectingClusters(w));var u=this._getTime();return{clusters:w,profile:{findCellsInCluster:this._getElapsedTime(C.findCells),
total:u-k}}},_markIntersecting:function(h,g){var k=g.normalize();D.forEach(h,function(w){var t=w.centroid.x,C=w.centroid.y;w.isIntersecting=D.some(k,function(u){return t>=u.xmin&&t<=u.xmax&&C>=u.ymin&&C<=u.ymax})})},_getIntersectingClusters:function(h){return D.filter(h,function(g){return g.isIntersecting})},_createCluster:function(h,g,k){if(!g[h.geohash]){var w=[{cell:h,distance:0}];if(this.tolerance){var t=this._getTime(),C=b.getNeighborsWithinDistance(h.centroid,this.lod,this.tolerance);k.findCells+=
this._getTime()-t;D.forEach(C,function(u){if(u!==h.geohash&&(u=this.getCell(u))){var x=this._calculateDistance(h.centroid,u.centroid);x<=this.tolerance&&w.push({cell:u,distance:x})}},this)}return this._mergeCells(w,g)}},_calculateDistance:function(h,g){return n.getLength(b.geographicToWebMercator(h),b.geographicToWebMercator(g))},_mergeCells:function(h,g){var k=this._initializeCluster({},h[0].cell.geohash);D.forEach(h,function(w){var t=w.cell,C=t.geohash;w=w.distance;var u=g[C];if(u)if(w<u.distance)this._removeCellFromCluster(C,
g);else return;g[C]={cluster:k,distance:w};this._updateItem(k,t.count,t.centroid);k.geohashes.push(C)},this);return k},_removeCellFromCluster:function(h,g){var k=g[h].cluster;delete g[h];var w=D.indexOf(k.geohashes,h);-1<w&&k.geohashes.splice(w,1);this._reevaluateCluster(k)},_reevaluateCluster:function(h){var g=h.geohashes;h=this._initializeCluster(h,h.primary);D.forEach(g,function(k){var w=this.getCell(k);w&&(this._updateItem(h,w.count,w.centroid),h.geohashes.push(k))},this)},_initializeCluster:function(h,
g){h.count=0;h.centroid=new r(null,null);h.geohashes=[];h.primary=g;h.statistics=null;return h},_applyStatInfos:function(h){h=this._getValidStatInfos(h);this._applyStatInfosToIndex(h);this._applyStatInfosToClusters(h)},_getValidStatInfos:function(h){var g=[];D.forEach(h,function(k){var w=k.attributeInfo;k=k.statisticType;var t="angle"===w.attributeType;if(c.isSupportedStatisticType(k)&&(!t||"avg"===k)){var C="arithmetic"===w.rotationType;g.push({attributeCache:e.createAttributeCache(w,"type"===k),
identifier:c.getStatisticId(w,k),statFunctions:c.getStatisticFunctions(k),isAngular:t,isDate:"date"===w.attributeType,isArithmetic:C})}});return g},_applyStatInfosToIndex:function(h){h=h||this._getValidStatInfos(this.statisticInfos);var g=this._cellIndex;if(g)for(var k=1;k<=this._maxGeohashLength;k++){var w=g[k],t;for(t in w)this._applyStatInfosToCell(w[t],h)}},_applyStatInfosToCell:function(h,g){var k=this._initializeStats(h,g);D.forEach(h.features,function(w){this._calcFeatureStats(w,g,k)},this);
this._summarizeStats(h,k,g)},_calcFeatureStats:function(h,g,k){h.attributes&&D.forEach(g,function(w){var t=k[w.identifier],C=w.attributeCache;C=C?h._getDataValue(C.attributeInfo,C,f):null;w.statFunctions.updateCellStat(t,C,w)})},_applyStatInfosToClusters:function(h){h=h||this._getValidStatInfos(this.statisticInfos);var g=this._clusterFieldPrefix;D.forEach(this.clusters,function(k){var w=this._initializeStats(k,h);D.forEach(this.getCellsInCluster(k),function(t){this._calcCellStats(t,h,w)},this);this._summarizeStats(k,
w,h,g);k.attributes[g+"id"]=k.primary},this)},_calcCellStats:function(h,g,k){var w=h.statistics;D.forEach(g,function(t){var C=t.identifier;t.statFunctions.updateClusterStat(k[C],w[C],t)})},_initializeStats:function(h,g){var k=h.statistics={};D.forEach(g,function(w){k[w.identifier]=w.statFunctions.initialize(w)});return k},_summarizeStats:function(h,g,k,w){var t=h.attributes={};w=w||"";t[w+"count"]=h.count;D.forEach(k,function(C){var u=this._getStatFieldName(C,w);t[u]=C.statFunctions.summarize(g[C.identifier],
C)},this)},_getStatFieldName:function(h,g){return(g||"")+h.identifier},_updateItem:function(h,g,k,w){var t=k.y,C=h.centroid,u=h.count;C.x=(u*C.x+g*k.x)/(u+g);C.y=(u*C.y+g*t)/(u+g);h.count+=g;w&&this._updateExtent(h.extent,k)},_updateExtent:function(h,g){var k=g.x,w=g.y;k<h.xmin&&(h.xmin=k);k>h.xmax&&(h.xmax=k);w<h.ymin&&(h.ymin=w);w>h.ymax&&(h.ymax=w)},_getTime:function(){return window.performance?window.performance.now():(new Date).getTime()},_getElapsedTime:function(h,g){var k=null!=h&&null!=g?
g-h:h;if(null!=k){var w="millisecond";1E3<=k&&(k/=1E3,w="second",60<=k&&(k/=60,w="minute"));w={value:Number(k.toFixed(2)),unit:w}}return w}});a.setObject("layers.clustering.GeohashAggregation",F,z);return F})},"esri/core/timerUtils":function(){define([],function(){function F(y){var r,q=y.length;for(r=0;r<q;r++)y[r]()}var m={LOW:1,HIGH:2},a,D={};D[m.LOW]=[];D[m.HIGH]=[];var z=function(){clearTimeout(a);a=null;var y=D[m.HIGH];D[m.HIGH]=[];F(y);y=D[m.LOW];D[m.LOW]=[];F(y)};return{priority:m,callbackQueue:D,
setTimeout:function(y,r){var q=[r,D[r].push(y)-1];a||(a=setTimeout(z,0));return q},clearTimeout:function(y){y&&D[y[0]].splice(y[1],1)}}})},"esri/layers/clustering/geohashUtils":function(){define("dojo/has dojo/string dojo/_base/lang dojo/_base/array ../../kernel ../../geometry/Point ../../geometry/Extent ../../SpatialReference ../../geometry/webMercatorUtils".split(" "),function(F,m,a,D,z,y,r,q,n){function f(L){var K=L.spatialReference;if(!K)return{x:L.x,y:L.y};var ba=K.isWebMercator(),T;4326===K.wkid?
T={x:L.x,y:L.y}:ba&&(T={x:L.getLongitude(),y:L.getLatitude()});return T}function d(L){var K=L.spatialReference,ba=!(!K||!K.isWebMercator()),T;K&&4326===K.wkid?T=new r(L.toJson()):ba&&(T=n.webMercatorToGeographic(L,!0));return T}function e(L,K){K.x=y.prototype._normalizeX(L.x,q.prototype._info[4326]);K.y=L.y;return K}function b(L){L=G.decimals[L].toString(2);return m.pad(L,G.bitsPerBase32Char,"0")}function c(L,K){K=K.slice();K.splice(1,0,0);for(var ba=K[0],T=K[2],P=0;P<L.length;P++){Number(L[P])?K[0]=
K[1]:K[2]=K[1];var J=K[1]=(K[0]+K[2])/2;ba=K[0];T=K[2]}return{value:J,min:ba,max:T}}function h(L,K,ba){var T=[];K=K.slice();K.splice(1,0,0);for(var P=K[0],J=K[2],N=0;N<ba;N++)L>=K[1]?(K[0]=K[1],P=1):(K[2]=K[1],P=0),K[1]=(K[0]+K[2])/2,T.push(P),P=K[0],J=K[2];return{value:T.join(""),min:P,max:J}}function g(L){var K=L*G.bitsPerBase32Char;0===K%2?L=K/=2:(L=(K+1)/2,K-=L);return{lon:L,lat:K}}function k(L){var K=0;L=L.split("").reverse().join("");for(var ba=0;ba<L.length;ba++)K+=Number(L[ba])*Math.pow(2,
ba);return G.base32[K]}function w(L,K){var ba={x:L.xmin,y:L.ymax},T={x:L.xmax,y:L.ymin},P={x:L.xmax,y:L.ymax};return{sw:I.pointToGeohash({x:L.xmin,y:L.ymin},K),nw:I.pointToGeohash(ba,K),se:I.pointToGeohash(T,K),ne:I.pointToGeohash(P,K)}}function t(L,K,ba,T,P){var J=L;do P[J]||(P[J]=!0,T.push(J)),(L=J===K)||(J=E(J,ba));while(!L)}function C(L,K,ba,T){var P=w(L,K);L=[];t(P.sw,P.nw,"n",L,{});K=[];t(P.se,P.ne,"n",K,{});for(P=0;P<L.length;P++)t(L[P],K[P],"e",ba,T)}function u(L){return D.filter(L,function(K){return 180===
K.xmax?!0:!1})[0]}function x(L){return D.filter(L,function(K){return-180===K.xmin?!0:!1})[0]}function l(L,K,ba,T){var P=I.geographicToWebMercator(L);L={x:P.x-K,y:P.y-K};K=I.webMercatorToGeographic({x:P.x+K,y:P.y+K},!0);L=I.webMercatorToGeographic(L,!0);return new r(null!=ba?ba:L.x,L.y,null!=T?T:K.x,K.y)}function v(L,K,ba,T){L=w(L,K);var P,J;"min"===T?J=180:"max"===T&&(P=-180);var N=P;T=J;var Z=I.geohashToCell(L.sw).extent;K=I.geohashToCell(L.ne).extent;L=null!=N?N:Z.xmin;Z=Z.ymin;T=null!=T?T:K.xmax;
K=K.ymax;L=l({x:L,y:Z},ba,P,J);ba=l({x:T,y:K},ba,P,J);return new r(L.xmin,L.ymin,ba.xmax,ba.ymax)}function A(L,K,ba){var T=L,P=0;do P++,(L=T===K)||(T=E(T,ba));while(!L);return P}function B(L,K){var ba=w(L,K),T=A(ba.nw,ba.ne,"e");return{rows:A(ba.nw,ba.sw,"s"),cols:T}}function E(L,K){var ba=L.length%2,T=L.slice(-1),P=G.decimals[T],J=L.slice(0,-1);-1!=G.borders[K][ba].indexOf(T)&&J&&(J=E(J,K));return J+G.neighbors[K][ba][P]}var G={base32:"0123456789bcdefghjkmnpqrstuvwxyz",decimals:function(){for(var L=
{},K=0;32>K;K++)L["0123456789bcdefghjkmnpqrstuvwxyz"[K]]=K;return L}(),neighbors:{n:[null,"238967debc01fg45kmstqrwxuvhjyznp"],s:[null,"bc01fg45238967deuvhjyznpkmstqrwx"],e:[null,"14365h7k9dcfesgujnmqp0r2twvyx8zb"],w:[null,"p0r21436x8zb9dcf5h7kjnmqesgutwvy"]},borders:{n:[null,"bcfguvyz"],s:[null,"0145hjnp"],e:[null,"prxz"],w:[null,"028b"]},bitsPerBase32Char:5,maxGeohashLength:12,longitudeRange:[-180,180],latitudeRange:[-90,90]};G.neighbors.n[0]="14365h7k9dcfesgujnmqp0r2twvyx8zb";G.neighbors.s[0]="p0r21436x8zb9dcf5h7kjnmqesgutwvy";
G.neighbors.e[0]="238967debc01fg45kmstqrwxuvhjyznp";G.neighbors.w[0]="bc01fg45238967deuvhjyznpkmstqrwx";G.borders.n[0]="prxz";G.borders.s[0]="028b";G.borders.e[0]="bcfguvyz";G.borders.w[0]="0145hjnp";var I={geographicToWebMercator:function(L){L=y.lngLatToXY(L.x,L.y);return{x:L[0],y:L[1]}},webMercatorToGeographic:function(L,K){var ba=y.xyToLngLat(L.x,L.y,K);return{x:ba[0],y:ba[1]}},geohashToCell:function(L){var K;var ba=[];for(K=0;K<L.length;K++)ba.push(b(L[K]));ba=ba.join("");K=[];for(var T=[],P=
0;P<ba.length;P++)0===P%2?K.push(ba[P]):T.push(ba[P]);K=K.join("");T=T.join("");K=[K,T];ba=c(K[0],G.longitudeRange);T=c(K[1],G.latitudeRange);K=ba.value;return{point:{x:K,y:T.value},extent:{xmin:ba.min,xmax:ba.max,ymin:T.min,ymax:T.max},geohash:L}},pointToCell:function(L,K){K=K||G.maxGeohashLength;var ba=f(L);if(ba){ba=e(ba,ba);var T=g(K);var P=h(ba.x,G.longitudeRange,T.lon);var J=h(ba.y,G.latitudeRange,T.lat);T=P.value;var N=J.value;P={xmin:P.min,xmax:P.max,ymin:J.min,ymax:J.max};J=[];for(var Z=
Math.ceil((T.length+N.length)/G.bitsPerBase32Char),Y=0,qa=0,V=0;V<Z*G.bitsPerBase32Char;V++){var na=0===V%2?T[Y++]:N[qa++];null==na&&(na=0);J.push(na)}T=J.join("");N=G.bitsPerBase32Char;J=T.length/N;Z=[];for(Y=0;Y<J;Y++)qa=T.substr(Y*N,N),Z.push(k(qa));T=Z.join("");return{point:ba,extent:P,geohash:T}}},geohashToPoint:function(L){return I.geohashToCell(L).point},pointToGeohash:function(L,K){var ba=I.pointToCell(L,K);return ba&&ba.geohash},getCells:function(L){return D.map(L,function(K){return I.geohashToCell(K)})},
getCellSize:function(L){var K=G.longitudeRange,ba=G.latitudeRange;K=Math.abs(K[1]-K[0]);ba=Math.abs(ba[1]-ba[0]);L=g(L||1);return{width:K/Math.pow(2,L.lon),height:ba/Math.pow(2,L.lat)}},getCellSizeInMeters:function(L){L=I.getCellSize(L);var K=n.metersPerDegree;L.width*=K;L.height*=K;return L},getIntersecting:function(L,K,ba){K=K||1;ba=ba||0;var T=[],P=d(L);if(P){ba&&(P=I.expandExtent(L,K,ba));L=P.normalize();var J={};D.forEach(L,function(N){C(N,K,T,J)})}return T},countIntersecting:function(L,K,ba){K=
K||1;ba=ba||0;var T=0,P=d(L);if(P){ba&&(P=I.expandExtent(L,K,ba));L=P.normalize();if(2===L.length){T=u(L);P=x(L);ba=B(T,K);var J=B(P,K);L=ba.rows;ba=ba.cols+J.cols;T={x:T.xmin,y:T.ymax};P={x:P.xmax,y:P.ymax};T=e(T,{});P=e(P,{});T=I.pointToGeohash(T,K);K=I.pointToGeohash(P,K);T===K&&ba--;K={rows:L,cols:ba}}else K=B(L[0],K);T=K.cols*K.rows}return T},getChildren:function(L){L=L||"";var K=[],ba;for(ba in G.decimals)K.push(L+ba);return K},getNeighbors:function(L){var K=E(L,"n"),ba=E(L,"s");return[K,E(K,
"e"),E(K,"w"),ba,E(ba,"e"),E(ba,"w"),E(L,"e"),E(L,"w")]},getExtentFromDistance:function(L,K){K=K||1E3;var ba,T=f(L);T&&(ba=l(T,K));return ba},expandExtent:function(L,K,ba){K=K||1;ba=ba||0;if(L=d(L)){if(ba){L=L.normalize();if(2===L.length){var T=ba;ba=u(L);L=x(L);ba=v(ba,K,T,"min");L=v(L,K,T,"max");360<=ba.getWidth()+L.getWidth()?(K=-180,L=180):(K=ba.xmin,L=L.xmax);return new r(K,ba.ymin,L,ba.ymax)}return v(L[0],K,ba)}return L}},getNeighborsWithinDistance:function(L,K,ba){ba=ba||1E3;K=K||1;var T=[];
if(L=f(L)){ba=l(L,ba).normalize();var P={};D.forEach(ba,function(J){C(J,K,T,P)})}return T}};a.setObject("layers.clustering.geohashUtils",I,z);return I})},"esri/layers/clustering/statUtils":function(){define(["dojo/_base/lang","../support/attributeUtils"],function(F,m){function a(y){return"number"===typeof y&&!isNaN(y)&&Infinity!==y&&-Infinity!==y}var D={sum:{initialize:function(){return{count:0,sum:null}},updateCellStat:function(y,r){a(r)&&(y.count++,y.sum+=r)},updateClusterStat:function(y,r){r.count&&
(y.count+=r.count,y.sum+=r.sum)},summarize:function(y){return y.sum}},avg:{initialize:function(y){return{count:0,sum:null,avg:null,sum_cosine:null,sum_sine:null}},updateCellStat:function(y,r,q){a(r)&&(y.count++,q.isAngular?(q.isArithmetic||(r=-1*r+90),y.sum_cosine+=Math.cos(r*Math.PI/180),y.sum_sine+=Math.sin(r*Math.PI/180)):y.sum+=r)},updateClusterStat:function(y,r,q){r.count&&(y.count+=r.count,q.isAngular?(y.sum_cosine+=r.sum_cosine,y.sum_sine+=r.sum_sine):y.sum+=r.sum)},summarize:function(y,r){if(0<
y.count){var q=y.count;r.isAngular?(q=180*Math.atan2(y.sum_sine/q,y.sum_cosine/q)/Math.PI,r.isArithmetic||(q=-1*(q-90)),y.avg=0>q?q+360:q):(y.avg=y.sum/q,r.isDate&&(y.avg=Math.ceil(y.avg)))}return y.avg}},type:{initialize:function(){return{uvInfos:{}}},updateCellStat:function(y,r){if(null==r||""===r||"string"===typeof r&&""===F.trim(r))r=null;var q=y.uvInfos;null==q[r]?q[r]={count:1,value:r}:q[r].count++},updateClusterStat:function(y,r){var q=y.uvInfos,n=r.uvInfos,f;for(f in n){var d=n[f];null==q[f]?
q[f]={count:d.count,value:d.value}:q[f].count+=d.count}},summarize:function(y){y=y.uvInfos;var r,q=-Infinity;for(r in y){var n=y[r];if(n.count>q){q=n.count;var f=n.value}else n.count===q&&(f=null)}return f}}},z={isSupportedStatisticType:function(y){return D.hasOwnProperty(y)},getStatisticFunctions:function(y){return D[y]},getStatisticId:function(y,r){var q=m.getAttributeIdSource(y);q=q&&m.getAttributeId(q)||y.field;return r+"_"+q},getClusterField:function(y,r){return"cluster_"+z.getStatisticId(y,
r)},getStatisticHash:function(y,r){var q=[z.getStatisticId(y,r)];y.attributeType&&q.push(y.attributeType.toLowerCase());y.rotationType&&q.push(y.rotationType.toLowerCase());return q.join("_")}};return z})},"esri/layers/agscommon":function(){define("./ArcGISMapServiceLayer ./LayerInfo ./TimeInfo ./LayerTimeOptions ./TimeReference ./Field ./Domain ./RangeDomain ./CodedValueDomain ./InheritedDomain ./LayerSource ./LayerMapSource ./LayerDataSource ./DataSource ./TableDataSource ./QueryDataSource ./JoinDataSource ./RasterDataSource ./DynamicLayerInfo ./LayerDrawingOptions ../geometry ../utils".split(" "),
function(){return{}})},"esri/layers/LayerSource":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.layers.LayerSource",type:null,constructor:function(z){z&&m.mixin(this,z)},toJson:function(){}});m.setObject("layers.LayerSource",F,D);return F})},"esri/layers/LayerMapSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerSource".split(" "),function(F,m,a,D,z,y){F=F(y,{declaredClass:"esri.layers.LayerMapSource",
type:"mapLayer",toJson:function(){return z.fixJson({type:"mapLayer",mapLayerId:this.mapLayerId,gdbVersion:this.gdbVersion})}});m.setObject("layers.LayerMapSource",F,D);return F})},"esri/layers/LayerDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerSource ./TableDataSource ./QueryDataSource ./JoinDataSource ./RasterDataSource".split(" "),function(F,m,a,D,z,y,r,q,n,f){F=F(y,{declaredClass:"esri.layers.LayerDataSource",type:"dataLayer",constructor:function(d){if(d&&
d.dataSource){switch(d.dataSource.type){case "table":d=new r(d.dataSource);break;case "queryTable":d=new q(d.dataSource);break;case "joinTable":d=new n(d.dataSource);break;case "raster":d=new f(d.dataSource);break;default:d=d.dataSource}this.dataSource=d}},toJson:function(){var d={type:"dataLayer",dataSource:this.dataSource&&this.dataSource.toJson()};return z.fixJson(d)}});m.setObject("layers.LayerDataSource",F,D);return F})},"esri/layers/TableDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource".split(" "),
function(F,m,a,D,z,y){F=F(y,{declaredClass:"esri.layers.TableDataSource",toJson:function(){return z.fixJson({type:"table",workspaceId:this.workspaceId,dataSourceName:this.dataSourceName,gdbVersion:this.gdbVersion})}});m.setObject("layers.TableDataSource",F,D);return F})},"esri/layers/DataSource":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.layers.DataSource",constructor:function(z){z&&m.mixin(this,z)},toJson:function(){}});
m.setObject("layers.DataSource",F,D);return F})},"esri/layers/QueryDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource ../SpatialReference".split(" "),function(F,m,a,D,z,y,r){F=F(y,{declaredClass:"esri.layers.QueryDataSource",constructor:function(q){q&&(q.oidFields&&m.isString(q.oidFields)&&(this.oidFields=q.oidFields.split(",")),q.spatialReference&&(this.spatialReference=new r(q.spatialReference)))},toJson:function(){var q={type:"queryTable",
workspaceId:this.workspaceId,query:this.query,oidFields:this.oidFields&&this.oidFields.join(),spatialReference:this.spatialReference&&this.spatialReference.toJson()};if(this.geometryType){var n="point"===this.geometryType.toLowerCase()?"esriGeometryPoint":"multipoint"===this.geometryType.toLowerCase()?"esriGeometryMultipoint":"polyline"===this.geometryType.toLowerCase()?"esriGeometryPolyline":"polygon"===this.geometryType.toLowerCase()?"esriGeometryPolygon":this.geometryType;q.geometryType=n}return z.fixJson(q)}});
m.setObject("layers.QueryDataSource",F,D);return F})},"esri/layers/JoinDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource ./LayerMapSource ./TableDataSource ./QueryDataSource ./RasterDataSource".split(" "),function(F,m,a,D,z,y,r,q,n,f){var d=F(y,{declaredClass:"esri.layers.JoinDataSource",constructor:function(e){e&&(e.leftTableSource&&(this.leftTableSource=this._createLayerSource(e.leftTableSource)),e.rightTableSource&&(this.rightTableSource=
this._createLayerSource(e.rightTableSource)))},_createLayerSource:function(e){if("mapLayer"===e.type)var b=new r(e);else{b={type:"dataLayer"};switch(e.dataSource.type){case "table":var c=new q(e.dataSource);break;case "queryTable":c=new n(e.dataSource);break;case "joinTable":c=new d(e.dataSource);break;case "raster":c=new f(e.dataSource);break;default:c=e.dataSource}b.dataSource=c;b.toJson=function(){var h={type:"dataLayer",dataSource:c.toJson()};return z.fixJson(h)}}return b},toJson:function(){var e=
{type:"joinTable",leftTableSource:this.leftTableSource&&this.leftTableSource.toJson(),rightTableSource:this.rightTableSource&&this.rightTableSource.toJson(),leftTableKey:this.leftTableKey,rightTableKey:this.rightTableKey};var b="left-outer-join"===this.joinType.toLowerCase()?"esriLeftOuterJoin":"left-inner-join"===this.joinType.toLowerCase()?"esriLeftInnerJoin":this.joinType;e.joinType=b;return z.fixJson(e)}});m.setObject("layers.JoinDataSource",d,D);return d})},"esri/layers/RasterDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource".split(" "),
function(F,m,a,D,z,y){F=F(y,{declaredClass:"esri.layers.RasterDataSource",toJson:function(){return z.fixJson({type:"raster",workspaceId:this.workspaceId,dataSourceName:this.dataSourceName})}});m.setObject("layers.RasterDataSource",F,D);return F})},"esri/layers/DynamicLayerInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerInfo ./LayerMapSource ./LayerDataSource".split(" "),function(F,m,a,D,z,y,r,q){F=F(y,{declaredClass:"esri.layers.DynamicLayerInfo",defaultVisibility:!0,
parentLayerId:-1,maxScale:0,minScale:0,constructor:function(n){n&&(n.source?n="mapLayer"===n.source.type?new r(n.source):new q(n.source):(n=new r,n.mapLayerId=this.id),this.source=n)},toJson:function(){var n=this.inherited(arguments);n.source=this.source&&this.source.toJson();return z.fixJson(n)}});m.setObject("layers.DynamicLayerInfo",F,D);return F})},"esri/layers/LayerDrawingOptions":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../renderers/jsonUtils ./LabelClass".split(" "),
function(F,m,a,D,z,y,r,q){F=F(null,{declaredClass:"esri.layers.LayerDrawingOptions",constructor:function(n){if(n&&(m.mixin(this,n),n.renderer&&(this.renderer=r.fromJson(n.renderer)),n.labelingInfo&&0<n.labelingInfo.length)){this.labelingInfo=[];var f;a.forEach(n.labelingInfo,function(d){f=new q(d);this.labelingInfo.push(f)},this)}},toJson:function(){var n={renderer:this.renderer&&this.renderer.toJson(),transparency:this.transparency,scaleSymbols:this.scaleSymbols,showLabels:this.showLabels};this.labelingInfo&&
0<this.labelingInfo.length&&(n.labelingInfo=[],a.forEach(this.labelingInfo,function(f){n.labelingInfo.push(f.toJson())}));return y.fixJson(n)}});m.setObject("layers.LayerDrawingOptions",F,z);return F})},"esri/geometry":function(){define("./units ./SpatialReference ./geometry/Geometry ./geometry/Point ./geometry/ScreenPoint ./geometry/Multipoint ./geometry/Polyline ./geometry/Polygon ./geometry/Extent ./geometry/Rect ./geometry/geodesicUtils ./geometry/jsonUtils ./geometry/mathUtils ./geometry/normalizeUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k){return{units:F,SpatialReference:m,Geometry:a,Point:D,ScreenPoint:z,Multipoint:y,Polyline:r,Polygon:q,Extent:n,Rect:f,geodesicUtils:d,jsonUtils:e,mathUtils:b,normalizeUtils:c,scaleUtils:h,screenUtils:g,webMercatorUtils:k}})},"esri/units":function(){define(["dojo/has","./kernel"],function(F,m){var a={CENTIMETERS:"esriCentimeters",DECIMAL_DEGREES:"esriDecimalDegrees",DEGREE_MINUTE_SECONDS:"esriDegreeMinuteSeconds",DECIMETERS:"esriDecimeters",FEET:"esriFeet",
FEET_US:"esriFeetUS",INCHES:"esriInches",KILOMETERS:"esriKilometers",METERS:"esriMeters",MILES:"esriMiles",MILES_US:"esriMilesUS",MILLIMETERS:"esriMillimeters",NAUTICAL_MILES:"esriNauticalMiles",POINTS:"esriPoints",UNKNOWN:"esriUnknownUnits",YARDS:"esriYards",YARDS_US:"esriYardsUS",ACRES:"esriAcres",ACRES_US:"esriAcresUS",ARES:"esriAres",SQUARE_KILOMETERS:"esriSquareKilometers",SQUARE_MILES:"esriSquareMiles",SQUARE_MILES_US:"esriSquareMilesUS",SQUARE_FEET:"esriSquareFeet",SQUARE_FEET_US:"esriSquareFeetUS",
SQUARE_METERS:"esriSquareMeters",HECTARES:"esriHectares",SQUARE_YARDS:"esriSquareYards",SQUARE_YARDS_US:"esriSquareYardsUS",SQUARE_INCHES:"esriSquareInches",SQUARE_MILLIMETERS:"esriSquareMillimeters",SQUARE_CENTIMETERS:"esriSquareCentimeters",SQUARE_DECIMETERS:"esriSquareDecimeters",SQUARE_NAUTICAL_MILES:"esriSquareNauticalMiles",METERS_PER_SECOND:"esriMetersPerSecond",KILOMETERS_PER_HOUR:"esriKilometersPerHour",KNOTS:"esriKnots",FEET_PER_SECOND:"esriFeetPerSecond",MILES_PER_HOUR:"esriMilesPerHour",
RADIANS:"esriDURadians"};return m.Units=a})},"esri/geometry/geodesicUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point ./Polyline ./Polygon".split(" "),function(F,m,a,D,z,y,r,q){function n(w){return!!(w&&w.wkid&&k[w.wkid])}function f(w){return n(w)?k[w.wkid]:k[4326]}function d(w){var t=w.spatialReference,C=f(t),u=C.a;C=C.eSq;var x=Math.sqrt(C),l=Math.sin(w.y*g);return new y(u*w.x*g,0<C?u*(1-C)*(l/(1-C*l*l)-1/(2*x)*Math.log((1-x*l)/(1+x*l)))*.5:
u*l,t)}function e(w,t,C,u,x){var l=f(x),v=l.a,A=l.b;l=l.f;var B=Math.sin(C);C=Math.cos(C);var E=(1-l)*Math.tan(w);w=1/Math.sqrt(1+E*E);var G=E*w,I=Math.atan2(E,C);E=w*B;var L=E*E,K=1-L;v=K*(v*v-A*A)/(A*A);var ba=1+v/16384*(4096+v*(-768+v*(320-175*v))),T=v/1024*(256+v*(-128+v*(74-47*v)));v=u/(A*ba);for(var P=2*Math.PI,J,N,Z,Y;1E-12<Math.abs(v-P);)Z=Math.cos(2*I+v),J=Math.sin(v),N=Math.cos(v),Y=T*J*(Z+T/4*(N*(-1+2*Z*Z)-T/6*Z*(-3+4*J*J)*(-3+4*Z*Z))),P=v,v=u/(A*ba)+Y;u=G*J-w*N*C;A=l/16*K*(4+l*(4-3*K));
return new y((t+(Math.atan2(J*B,w*N-G*J*C)-(1-A)*l*E*(v+A*J*(Z+A*N*(-1+2*Z*Z)))))/g,Math.atan2(G*N+w*J*C,(1-l)*Math.sqrt(L+u*u))/g,x)}function b(w,t,C,u,x){var l=f(x),v=l.a;x=l.b;var A=l.f,B=u-t,E=Math.atan((1-A)*Math.tan(w)),G=Math.atan((1-A)*Math.tan(C)),I=Math.sin(E);E=Math.cos(E);var L=Math.sin(G);G=Math.cos(G);var K=B,ba=1E3;do{var T=Math.sin(K);var P=Math.cos(K);var J=Math.sqrt(G*T*G*T+(E*L-I*G*P)*(E*L-I*G*P));if(0===J)return 0;P=I*L+E*G*P;var N=Math.atan2(J,P);var Z=E*G*T/J;var Y=1-Z*Z;T=P-
2*I*L/Y;isNaN(T)&&(T=0);var qa=A/16*Y*(4+A*(4-3*Y));var V=K;K=B+(1-qa)*A*Z*(N+qa*J*(T+qa*P*(-1+2*T*T)))}while(1E-12<Math.abs(K-V)&&0<--ba);if(0===ba)return x=u-t,{azimuth:Math.atan2(Math.sin(x)*Math.cos(C),Math.cos(w)*Math.sin(C)-Math.sin(w)*Math.cos(C)*Math.cos(x)),geodesicDistance:Math.acos(Math.sin(w)*Math.sin(C)+Math.cos(w)*Math.cos(C)*Math.cos(u-t))*l.radius};w=Y*(v*v-x*x)/(x*x);t=w/1024*(256+w*(-128+w*(74-47*w)));return{azimuth:Math.atan2(G*Math.sin(K),E*L-I*G*Math.cos(K)),geodesicDistance:x*
(1+w/16384*(4096+w*(-768+w*(320-175*w))))*(N-t*J*(T+t/4*(P*(-1+2*T*T)-t/6*T*(-3+4*J*J)*(-3+4*T*T)))),reverseAzimuth:Math.atan2(E*Math.sin(K),E*L*Math.cos(K)-I*G)}}function c(w,t){if(!(w instanceof r||w instanceof q))throw Error("_geodesicDensify: the input geometry is neither polyline nor polygon");var C=w.spatialReference,u=f(C).radius/1E4;t<u&&(t=u);u=w instanceof r;var x=[],l;F.forEach(u?w.paths:w.rings,function(v){x.push(l=[]);l.push([v[0][0],v[0][1]]);var A,B;var E=v[0][0]*g;var G=v[0][1]*g;
for(A=0;A<v.length-1;A++){var I=v[A+1][0]*g;var L=v[A+1][1]*g;if(E!==I||G!==L){L=b(G,E,L,I,C);I=L.azimuth;L=L.geodesicDistance;var K=L/t;if(1<K){for(B=1;B<=K-1;B++){var ba=e(G,E,I,B*t,C);l.push([ba.x,ba.y])}B=e(G,E,I,(L+Math.floor(K-1)*t)/2,C);l.push([B.x,B.y])}G=e(G,E,I,L,C);l.push([G.x,G.y]);E=G.x*g;G=G.y*g}}});return u?new r({paths:x,spatialReference:C}):new q({rings:x,spatialReference:C})}var h={esriMeters:1,esriKilometers:1E3,esriYards:.9144,esriFeet:.3048,esriMiles:1609.344,esriNauticalMiles:1852,
esriInches:.0254,esriDecimeters:.1,esriCentimeters:.01,esriMillimeters:.001,esriSquareMeters:1,esriSquareKilometers:1E6,esriSquareYards:.83612736,esriSquareFeet:.09290304,esriSquareMiles:2589988.110336,esriAcres:4046.8564224,esriHectares:1E4,esriAres:100,esriSquareInches:6.4516E-4,esriSquareMillimeters:1E-6,esriSquareCentimeters:1E-4,esriSquareDecimeters:.01},g=Math.PI/180,k={4326:{a:6378137,b:6356752.31424518,f:1/298.257223563,eSq:.006694379990197414,radius:6371008.771415059},104900:{a:2439700,b:2439700,
f:0,eSq:0,radius:2439700},104901:{a:6051E3,b:6051E3,f:0,eSq:0,radius:6051E3},104902:{a:6051800,b:6051800,f:0,eSq:0,radius:6051800},104903:{a:1737400,b:1737400,f:0,eSq:0,radius:1737400},104904:{a:3393400,b:3375730,f:1/192.04301075,eSq:.01038722,radius:3387510},104905:{a:3396190,b:3376200,f:1/169.89444722,eSq:.01173737,radius:3389526.6666666665},104906:{a:6200,b:6200,f:0,eSq:0,radius:6200},104907:{a:11100,b:11100,f:0,eSq:0,radius:11100},104912:{a:2409300,b:2409300,f:0,eSq:0,radius:2409300},104915:{a:1562090,
b:1562090,f:0,eSq:0,radius:1562090},104916:{a:2632345,b:2632345,f:0,eSq:0,radius:2632345},104918:{a:1821460,b:1821460,f:0,eSq:0,radius:1821460},104929:{a:249400,b:249400,f:0,eSq:0,radius:249400},104943:{a:2575E3,b:2575E3,f:0,eSq:0,radius:2575E3},104971:{a:3396190,b:3396190,f:0,eSq:0,radius:3396190},104972:{a:47E4,b:47E4,f:0,eSq:0,radius:47E4},104973:{a:255E3,b:255E3,f:0,eSq:0,radius:255E3},104974:{a:2439400,b:2439400,f:0,eSq:0,radius:2439400}};a={isSupported:n,getSpheroidInfo:f,geodesicDensify:c,
geodesicLengths:function(w,t){var C=[];F.forEach(w,function(u,x){var l=0,v=u.spatialReference;F.forEach(u.paths,function(A,B){var E=0,G;for(G=1;G<A.length;G++){var I=A[G-1][0]*g;var L=A[G][0]*g;var K=A[G-1][1]*g;var ba=A[G][1]*g;if(K!==ba||I!==L)I=b(K,I,ba,L,v),E+=I.geodesicDistance}l+=E});l/=h[t];C.push(l)});return C},geodesicAreas:function(w,t){var C=[],u=[];F.forEach(w,function(x,l){var v=.0015696101447650193*f(x.spatialReference).radius;C.push(c(x,v))});F.forEach(C,function(x,l){var v=0,A=x.spatialReference;
F.forEach(x.rings,function(B,E){var G=d(new y(B[0][0],B[0][1],A)),I=d(new y(B[B.length-1][0],B[B.length-1][1],A)),L=I.x*G.y-G.x*I.y,K;for(K=0;K<B.length-1;K++)G=d(new y(B[K+1][0],B[K+1][1],A)),I=d(new y(B[K][0],B[K][1],A)),L+=I.x*G.y-G.x*I.y;v+=L});v/=h[t];u.push(v/-2)});return u},_unitsDictionary:h,_toEqualAreaPoint:d,_directGeodeticSolver:e,_inverseGeodeticSolver:b};m.mixin(m.getObject("geometry",!0,D),a);return a})},"esri/utils":function(){define("./domUtils ./lang ./urlUtils ./request ./tileUtils ./graphicsUtils ./deferredUtils ./layerUtils ./geometry/normalizeUtils".split(" "),
function(){return{}})},"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../urlUtils ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l){var v=
m([t],{declaredClass:"esri.layers.KMLLayer",serviceUrl:h.getProtocolForWebResource()+"//utility.arcgis.com/sharing/kml",constructor:function(A,B){this._url=h.urlToObject(this.url=A);this._outSR=B&&B.outSR||new g({wkid:4326});this._options=D.mixin({},B);e.defaults.kmlService&&(this.serviceUrl=e.defaults.kmlService);var E=this.linkInfo=B&&B.linkInfo;E&&(this.visible=!!E.visibility,this._waitingForMap=!!E.viewFormat);(!E||E&&E.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=D.hitch(this,
this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(A){if(A){var B=A.type,E=A.id,G;switch(B){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(A=this["_"+B])&&(G=D.getObject("_mode._featureMap."+E,!1,A));break;case "GroundOverlay":if(A=this._groundLyr){var I=A.getImages();B=I.length;for(A=0;A<B;A++)if(I[A].id===E){G=I[A];break}}break;case "NetworkLink":z.some(this._links,function(L){return L.linkInfo&&L.linkInfo.id===E?(G=L,!0):!1});
break;case "Folder":for(B=(I=this.folders)?I.length:0,A=0;A<B;A++)if(I[A].id===E){G=I[A];break}}return G}},getLayers:function(){var A=[];this._groundLyr&&A.push(this._groundLyr);this._fLayers&&(A=A.concat(this._fLayers));this._links&&z.forEach(this._links,function(B){B.declaredClass&&A.push(B)});return A},setFolderVisibility:function(A,B){A&&(this._fireUpdateStart(),(A.visible=B)&&(B=this._areLocalAncestorsVisible(A)),this._setState(A,B),this._fireUpdateEnd())},_eventMap:{"network-link-error":["error"]},
onRefresh:function(){},onOpacityChange:function(){},onNetworkLinkError:function(){},_parseKml:function(A){var B=this;this._fireUpdateStart();this._io=c({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(A),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:y.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(E){B._io=null;B._initLayer(E)},error:function(E){B._io=null;E=D.mixin(Error(),E);E.message="Unable to load KML: "+(E.message||"");B._fireUpdateEnd(E);
B._errorHandler(E)}})},_initLayer:function(A){if(this.loaded){var B=[];z.forEach(this.folders,function(T){T.visible&&B.push(T.id)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale;this._options.opacity=this.opacity;this._removeInternalLayers()}this.name=A.name;this.description=A.description;this.snippet=A.snippet;this.visibility=A.visibility;this.featureInfos=A.featureInfos;var E,G=this.folders=A.folders,I=[];if(G){var L=G.length;for(E=0;E<L;E++){var K=G[E]=new C(G[E]);-1===
K.parentFolderId&&I.push(K)}}G=this._links=A.networkLinks;L=G?G.length:0;for(E=0;E<L;E++)if(!G[E].viewRefreshMode||-1===G[E].viewRefreshMode.toLowerCase().indexOf("onregion")){var ba=D.mixin({},this._options);ba.linkInfo=G[E];ba.id&&(ba.id=ba.id+"_"+E);K=G[E]=new v(G[E].href,ba);K._parentLayer=this;K._parentFolderId=this._getLinkParentId(K.linkInfo.id);K._linkErrorHandle=K.on("error,network-link-error",D.hitch(K,function(T){this._parentLayer.onNetworkLinkError(T.error)}))}if((G=A.groundOverlays)&&
0<G.length)for(ba=D.mixin({},this._options),ba.id&&(ba.id+="_mapImage"),K=this._groundLyr=new x(ba),L=G.length,E=0;E<L;E++)K.addImage(new u(G[E]));(A=D.getObject("featureCollection.layers",!1,A))&&0<A.length&&(this._fLayers=[],z.forEach(A,function(T,P){var J=D.getObject("featureSet.features",!1,T);J&&0<J.length&&(ba=D.mixin({outFields:["*"],infoTemplate:T.popupInfo?new w(T.popupInfo):null,editable:!1},this._options),ba.id&&(ba.id=ba.id+"_"+P),ba.webgl=!1,T.layerDefinition.capabilities="Query,Data",
J=new l(T,ba),J.geometryType&&(this["_"+J.geometryType]=J),this._fLayers.push(J))},this),0===this._fLayers.length&&delete this._fLayers);if(!this.loaded)for(L=I.length,E=0;E<L;E++)K=I[E],this._setState(K,K.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),z.forEach(this.folders,function(T){-1<z.indexOf(B,T.id)?this.setFolderVisibility(T,!0):this.setFolderVisibility(T,!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var A=this._map;
this._fireUpdateStart();this._links&&z.forEach(this._links,function(I){I.declaredClass&&(A.addLayer(I),I._waitingForMap&&(I._waitingForMap=null,I.visible?I._parseKml(A):I._wMap=A))});var B=A.spatialReference,E=this._outSR;if(!B.equals(E))if(B.isWebMercator()&&4326===E.wkid)var G=k.geographicToWebMercator;else if(E.isWebMercator()&&4326===B.wkid)G=k.webMercatorToGeographic;else return;this._groundLyr&&(G&&z.forEach(this._groundLyr.getImages(),function(I){I.extent=G(I.extent)}),A.addLayer(this._groundLyr));
(B=this._fLayers)&&0<B.length&&z.forEach(B,function(I){if(G){var L=I.graphics,K,ba,T=L?L.length:0;for(K=0;K<T;K++)(ba=L[K].geometry)&&L[K].setGeometry(G(ba))}A.addLayer(I)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var A=this._map;this._links&&z.forEach(this._links,function(B){B.declaredClass&&B._io&&B._io.cancel();B._linkErrorHandle&&(B._linkErrorHandle.remove(),B._linkErrorHandle=null)});A&&z.forEach(this.getLayers(),A.removeLayer,A)},_setState:function(A,B){var E=
A.featureInfos,G,I,L=E?E.length:0,K=B?"show":"hide",ba=B?"_resume":"_suspend";for(I=0;I<L;I++){var T=E[I];if(G=this.getFeature(T))if("Folder"===T.type)this._setState(G,B&&G.visible);else if("NetworkLink"===T.type)this._setInternalVisibility(G,B);else if(G[ba])G[ba]();else G[K]()}},_areLocalAncestorsVisible:function(A){var B=A.parentFolderId;for(A=A.visible;A&&-1!==B;)B=this.getFeature({type:"Folder",id:B}),A=A&&B.visible,B=B.parentFolderId;return A},_setInternalVisibility:function(A,B){var E=A._parentLayer,
G=A._parentFolderId;for(B=B&&A.visible;B&&E;)B=B&&E.visible,-1<G&&(B=B&&E._areLocalAncestorsVisible(E.getFeature({type:"Folder",id:G}))),G=E._parentFolderId,E=E._parentLayer;this._setIntState(A,B)},_setIntState:function(A,B){A&&z.forEach(A.getLayers(),function(E){E.linkInfo?A._setIntState(E,B&&E.visible&&A._areLocalAncestorsVisible(A.getFeature({type:"Folder",id:E._parentFolderId}))):E.setVisibility(B)})},_getLinkParentId:function(A){var B=-1;this.folders&&z.some(this.folders,function(E){return E.networkLinkIds&&
-1!==z.indexOf(E.networkLinkIds,A)?(B=E.id,!0):!1});return B},_checkAutoRefresh:function(){var A=this.linkInfo;if(A)if(this.visible){if(this.loaded&&this._map){var B=A.refreshMode,E=A.refreshInterval,G=A.viewRefreshMode;A=A.viewRefreshTime;B&&-1!==B.toLowerCase().indexOf("oninterval")&&0<E&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*E));G&&-1!==G.toLowerCase().indexOf("onstop")&&0<A&&!this._extChgHandle&&(this._extChgHandle=a.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),
a.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(A){A=A||this._map;var B={},E=this.linkInfo,G=A&&A.extent;if(this._url.query){D.mixin(B,this._url.query);var I=!!this._url.query.token}d.id&&!I&&(I=d.id.findCredential(this._url.path))&&(B.token=I.token);if(E){I=E.viewFormat;var L=E.httpQuery;E=E.viewBoundScale;if(G&&I){var K=G,ba=G,T=G.spatialReference;T&&(T.isWebMercator()?
K=k.webMercatorToGeographic(G):4326===T.wkid&&(ba=k.geographicToWebMercator(G)));G=K.getCenter();ba=Math.max(ba.getWidth(),ba.getHeight());E&&(K=K.expand(E));I=I.replace(/\[bboxWest\]/ig,K.xmin).replace(/\[bboxEast\]/ig,K.xmax).replace(/\[bboxSouth\]/ig,K.ymin).replace(/\[bboxNorth\]/ig,K.ymax).replace(/\[lookatLon\]/ig,G.x).replace(/\[lookatLat\]/ig,G.y).replace(/\[lookatRange\]/ig,ba).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,G.x).replace(/\[lookatTerrainLat\]/ig,
G.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,G.x).replace(/\[cameraLat\]/ig,G.y).replace(/\[cameraAlt\]/ig,ba).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,A.width).replace(/\[vertPixels\]/ig,A.height).replace(/\[terrainEnabled\]/ig,0);D.mixin(B,q.queryToObject(I))}L&&(L=L.replace(/\[clientVersion\]/ig,d.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,F.locale),D.mixin(B,
q.queryToObject(L)))}A=[];for(var P in B)b.isDefined(B[P])&&A.push(P+"\x3d"+B[P]);return(A=A.join("\x26"))?"?"+A:""},setScaleRange:function(A,B){this.inherited(arguments);z.forEach(this.getLayers(),function(E){E.setScaleRange(A,B)})},setOpacity:function(A){this.opacity!=A&&(z.forEach(this.getLayers(),function(B){B.setOpacity(A)}),this.opacity=A,this.onOpacityChange(A))},_setMap:function(A,B){this.inherited(arguments);this._map=A;var E=this._div=n.create("div",null,B);f.set(E,"position","absolute");
this._addInternalLayers();this.evaluateSuspension();return E},_unsetMap:function(A,B){this._io&&this._io.cancel();this._stopAutoRefresh();a.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var E=this._div;E&&(B.removeChild(E),n.destroy(E));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(A){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,A),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&A&&(this._waitingForMap||
this._parseKml(this._wMap))},refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._parseKml()},getFeatureCollection:function(A){var B,E=[];(A=this.getFeature({type:"Folder",id:A}))&&(B=z.map(A.featureInfos,function(G){if("esriGeometryPoint"===G.type||"esriGeometryPolyline"===G.type||"esriGeometryPolygon"===G.type)return G.id},this))&&0<B.length&&z.forEach(this._fLayers,function(G){var I;var L=G.toJson();L.featureSet.features&&0<L.featureSet.features.length&&(I=z.filter(L.featureSet.features,
function(K){if(-1!==z.indexOf(B,K.attributes[G.objectIdField]))return K},this));I&&0<I.length&&(L.featureSet.features=I,E.push(L))},this);return E},getFeatureCount:function(A){A=this.getFeature({type:"Folder",id:A});var B={points:0,polylines:0,polygons:0};A&&z.forEach(A.featureInfos,function(E){"esriGeometryPoint"===E.type&&(B.points+=1);"esriGeometryPolyline"===E.type&&(B.polylines+=1);"esriGeometryPolygon"===E.type&&(B.polygons+=1)});return B},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=
setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});D.setObject("layers.KMLLayer",v,d);return v})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(y){m.mixin(this,y);z.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});m.setObject("layers.KMLFolder",F,D);return F})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),
function(F,m,a,D,z,y){F=F([y],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(r){z.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});m.setObject("layers.KMLGroundOverlay",F,D);return F})},"esri/layers/WebTiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/url dojo/sniff dojo/string ../config ../kernel ../request ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),function(F,m,a,
D,z,y,r,q,n,f,d,e,b,c){function h(g,k){var w=[];if(g&&k&&(k.customLayerParameters||k.customParameters)){var t=m.clone(k.customParameters||{});m.mixin(t,k.customLayerParameters||{});var C=f.urlToObject(g);for(var u in C.query)t.hasOwnProperty(u)||w.push(u+"\x3d"+C.query[u]);g=C.path+(w.length?"?"+w.join("\x26"):"")}return g}F=F(b,{declaredClass:"esri.layers.WebTiledLayer",constructor:function(g,k){k||(k={});this.urlTemplate=g=h(g,k.wmtsInfo);var w=new e(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,
2.0037508342787E7,new d({wkid:102100})),t=new e(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new d({wkid:102100}));this.initialExtent=k.initialExtent||w;this.fullExtent=k.fullExtent||t;this.tileInfo=k.tileInfo?k.tileInfo:new c({dpi:96,rows:256,cols:256,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,resolution:156543.033928,scale:5.91657527591555E8},{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},{level:2,resolution:39135.7584820001,
scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},
{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,
scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147},{level:23,resolution:.01866138385297604,scale:70.5310735}]});this.spatialReference=new d(this.tileInfo.spatialReference.toJson());this.copyright=k.copyright||"";var C=new D(g);w=C.scheme+"://"+C.authority+"/";this.urlPath=g.substring(w.length);this.tileServers=k.tileServers||[];-1===C.authority.indexOf("{subDomain}")&&
this.tileServers.push(w);if(k.subDomains&&0<k.subDomains.length&&1<C.authority.split(".").length){this.subDomains=k.subDomains;var u;a.forEach(k.subDomains,function(A){-1<C.authority.indexOf("${subDomain}")?u=C.scheme+"://"+y.substitute(C.authority,{subDomain:A})+"/":-1<C.authority.indexOf("{subDomain}")&&(u=C.scheme+"://"+C.authority.replace(/\{subDomain\}/gi,A)+"/");this.tileServers.push(u)},this)}this.tileServers=a.map(this.tileServers,function(A){"/"!==A.charAt(A.length-1)&&(A+="/");return A});
this._levelToLevelValue=[];var x=0;a.forEach(this.tileInfo.lods,function(A,B){this._levelToLevelValue[A.level]=A.levelValue||A.level;0===B&&(x=this._levelToLevelValue[A.level])},this);this._wmtsInfo=k.wmtsInfo;var l=m.hitch(this,function(){this.loaded=!0;this.onLoad(this)});if(z("chrome")){w=this.getTileUrl(x,0,0);t=r.defaults.io;var v="with-credentials"===t.useCors?f.canUseXhr(w,!0):-1;(t=-1<v?t.corsEnabledServers[v]:null)&&t.withCredentials?n({url:w,handleAs:"arraybuffer"}).addBoth(function(){l()}):
l()}else l()},getTileUrl:function(g,k,w){g=this._levelToLevelValue[g];var t=this.tileServers[k%this.tileServers.length]+y.substitute(this.urlPath,{level:g,z:g,col:w,x:w,row:k,y:k});t=t.replace(/\{level\}/gi,g).replace(/\{row\}/gi,k).replace(/\{col\}/gi,w).replace(/\{z\}/gi,g).replace(/\{x\}/gi,w).replace(/\{y\}/gi,k);t=this._appendCustomLayerParameters(t);t=this.addTimestampToURL(t);return f.addProxy(t)},_appendCustomLayerParameters:function(g){var k;if(this._wmtsInfo&&(this._wmtsInfo.customLayerParameters||
this._wmtsInfo.customParameters)){var w=m.clone(this._wmtsInfo.customParameters||{});m.mixin(w,this._wmtsInfo.customLayerParameters||{});for(k in w)g+=(-1===g.indexOf("?")?"?":"\x26")+k+"\x3d"+encodeURIComponent(w[k])}return g}});m.setObject("layers.WebTiledLayer",F,q);return F})},"esri/layers/StreamLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/Deferred dojo/has dojo/io-query dojo/on dojo/aspect ../kernel ../request ../graphic ./FeatureLayer ./StreamMode ./StreamTrackManager ../geometry/jsonUtils ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../renderers/SimpleRenderer ./PurgeOptions".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x){F=F([c],{declaredClass:"esri.layers.StreamLayer",_preventInit:!0,constructor:function(l,v){v=v||{};v.mode&&v.mode!==c.MODE_STREAM||(this._isStream=!0,this.currentMode=this.mode=c.MODE_STREAM,this._mode=new h(this));this.purgeOptions=new x(this,v.purgeOptions||{});this.purgeInterval=v.purgeInterval||0;this._reconnectAttempts=0;this.maxReconnectAttempts=10;this.socket=this._reconnectTimeoutId=null;this._keepLatestQueried=!1;this._keepLatestUrl=null;
this._relatedQueried=!1;this._joinField=this._relatedUrl=null;this._refreshing=!1;this._attemptReconnect=z.hitch(this,this._attemptReconnect);this._purge=z.hitch(this,this._purge);this._processServiceJson=z.hitch(this,this._processServiceJson);if(z.isObject(l)&&l.layerDefinition)this._initFeatureLayer(l,v);else{var A=this;e({url:l,content:z.mixin({f:"json"}),callbackParamName:"callback"}).then(function(B){A._processServiceJson(B,v)},function(B){A._errorHandler(B)})}},_processServiceJson:function(l,
v){var A=this;l.relatedFeatures&&l.relatedFeatures.featuresUrl&&l.relatedFeatures.joinField?(this._relatedUrl=l.relatedFeatures.featuresUrl,this.objectIdField=this._joinField=l.relatedFeatures.joinField,e({url:this._relatedUrl,content:{f:"json"},callbackParamName:"callback"}).then(function(B){B=B.fields||[];var E=a.map(l.fields,function(G){return G.name.toLowerCase()});a.forEach(B,function(G){-1===a.indexOf(E,G.name.toLowerCase())&&l.fields.push(G)});v.resourceInfo=l;A._initFeatureLayer(A._url,v)},
function(B){A.onError({error:B})})):(v.resourceInfo=l,this._initFeatureLayer(this._url,v))},_initLayer:function(l,v){this.inherited(arguments);if(l){var A;if(l.layerDefinition)this.purgeOptions=new x(this,this._params.purgeOptions||{}),this.socketUrl=this._params.socketUrl||l.layerDefinition.socketUrl||void 0;else{if(this._params.socketUrl)this.socketUrl=this._params.socketUrl;else{var B=this._getWebsocketConnectionInfo(l),E=B.urls;E&&E.length?(this._socketUrls=E,this.socketUrl=E[0],this.socketDirection=
"broadcast"===this._params.socketDirection?"broadcast":"subscribe",this.socketUrl+="/"+this.socketDirection,this._websocketToken=B.token,E.length>this.maxReconnectAttempts&&(this.maxReconnectAttempts=E.length)):(this.socketUrl=void 0,B="No web socket urls were retrieved from the Stream Service. Layer will not attempt to connect.","https:"===location.protocol&&(B+=" An insecure web socket connection cannot be made from a secure web page."),this.onError(Error(B)))}if(this._params.filter)try{this._filter=
A=this._makeFilter(this._params.filter)}catch(G){this.onError(Error("Error trying to create filter object: "+G+". Layer will not have filter applied")),this._filter=null}if(this._params.geometryDefinition||this._outFields||this._defnExpr){A=A||{};A.geometry=this._params.geometryDefinition;A.outFields=this._outFields;A.where=this._defnExpr;try{this._filter=A=this._makeFilter(A)}catch(G){this.onError(Error("Error trying to create filter object: "+G+". Layer will not have filter applied")),this._filter=
null}}}this.maximumTrackPoints=this._params.maximumTrackPoints||0===this._params.maximumTrackPoints?this._params.maximumTrackPoints:1;(this._params.refreshRate||0===this._params.refreshRate)&&this._mode&&this._mode._setRefreshRate&&this._mode._setRefreshRate(this._params.refreshRate);this._keepLatestUrl=l.keepLatestArchive?l.keepLatestArchive.featuresUrl:null;l.relatedFeatures&&l.relatedFeatures.featuresUrl&&l.relatedFeatures.joinField&&(this._relatedUrl=l.relatedFeatures.featuresUrl,this.objectIdField=
this._joinField=l.relatedFeatures.joinField);this.objectIdField||this._makeObjectIdField();this._map&&this.socketUrl&&!this._connected&&this.connect()}},_isWebGLCompatible:function(){return!1},_setMap:function(l){var v=this.inherited(arguments),A=this._getRenderer();this.timeInfo&&(this._trackIdField||A&&(A.latestObservationRenderer||A.trackRenderer))&&(this._trackManager=new g(this),this._trackManager.initialize(l));this.socketUrl&&!this._connected&&this._map&&this.connect();return v},_unsetMap:function(l,
v){a.forEach(this._connects,m.disconnect);(this._connected||this._reconnecting||this.socket)&&this.disconnect();this._togglePurgeT();this.inherited(arguments);this._map=null},_suspend:function(){this._togglePurgeT();this.inherited(arguments)},_resume:function(){this.inherited(arguments);this._togglePurgeT(!0)},clear:function(){try{this._mode&&this._mode._clearDrawBuffer&&this._mode._clearDrawBuffer(),this._mode&&this._mode._clearTimeBin&&this._mode._clearTimeBin(),this._mode&&this._mode._clearFeatureMap&&
this._mode._clearFeatureMap(),this._trackManager&&this._trackManager.clearTracks()}catch(l){}this.inherited(arguments);this._trackManager&&this._trackManager.createTracklineContainer()},redraw:function(){this._mode&&this._mode._flushDrawBuffer&&this._mode._flushDrawBuffer();this.inherited(arguments)},setDefinitionExpression:function(l){this.setFilter({where:l})},getDefinitionExpression:function(){if(this._filter)var l=this._filter.where;return l},destroy:function(){this.disconnect();this.inherited(arguments)},
onResume:function(l){this.inherited(arguments)},setGeometryDefinition:function(l){this.setFilter({geometry:l})},getGeometryDefinition:function(){if(this._filter)var l=this._filter.geometry;return l},connect:function(l){var v=new y,A={},B=this._filter,E,G,I=this.socketUrl,L;try{this._connected||this._connecting?v.reject(Error("Cannot start new connection process. Layer is connecting.")):(this._connecting=!0,this._getRelatedFeatures().then(function(){return this._getKeepLatestFeatures()}.bind(this)).then(function(){this._websocketToken&&
(A.token=this._websocketToken);this._map&&this._map.spatialReference&&this.spatialReference&&this._map.spatialReference.wkid!==this.spatialReference.wkid&&(A.outSR=this._map.spatialReference.wkid);if(B)for(G in B)null!==B[G]&&(E="geometry"===G?JSON.stringify(B[G]):B[G],A[G]=E);I+="?"+q.objectToQuery(A);L=this._createConnection(I,l);v.resolve(L)}.bind(this)).otherwise(function(K){v.reject(K)}))}catch(K){l&&(l(K,!1),v.reject(K)),this.onConnectionError({error:K})}return v.promise},disconnect:function(l){var v=
this._refreshing?"Disconnecting as part of layer refresh cycle":"Connection closed from client",A=this._refreshing?!0:!1;this._reconnectTimeoutId&&clearTimeout(this._reconnectTimeoutId);this._refreshing=this._reconnecting=this._connecting=this._connected=!1;this.socket&&this.socket.close();this.onDisconnect({willReconnect:A,message:v});l&&l(null,!0)},setFilter:function(l){if(this._collection)return this.onError("Filter can only be set when the source of the layer is a Stream Service"),!1;try{if(void 0!==
l.outFields){var v=Error("Outfields property cannot be changed after layer is created");this.onFilterChange({filter:this.getFilter(),error:v});return!1}var A=this._makeFilter(l)}catch(B){return v=Error(B),this.onFilterChange({filter:this.getFilter(),error:v}),!1}if(this.socket)l={filter:A},this.socket.send(JSON.stringify(l));else n.once(this,"connect",function(B){this.setFilter(A)});return!0},getFilter:function(){var l=this._filter,v={},A=["geometry","outFields","where"];l&&a.forEach(A,function(B){var E=
l[B];E&&("geometry"===B?E=k.fromJson(E):"outFields"===B&&(E=E.split(",")),v[B]=E)});return v},setMaximumTrackPoints:function(l){if(!l&&0!==l)return!1;this.maximumTrackPoints=l;this._mode.propertyChangeHandler(3)},getUniqueValues:function(l){var v={},A=[];var B=this._getField(l,!0);if(!B)return A;l=B.name;a.forEach(this.graphics||[],function(E){E=(E.attributes||{})[l];void 0===E||v[E]||(v[E]=1,A.push(E))});A.sort(function(E,G){return E<G?-1:E>G?1:0});return A},getLatestObservations:function(){var l=
[];return l=this._trackManager?this._trackManager.getLatestObservations():this.graphics},setPurgeInterval:function(l){var v=this.purgeInterval;this.purgeInterval=l;this._togglePurgeT();l&&this._togglePurgeT(!0);if(v!==l)this.onPurgeIntervalChange();return this},_togglePurgeT:function(l){if(l&&this.purgeInterval){var v=this;clearTimeout(this._purgeT);this._mode&&this._mode._flushDrawBuffer&&(this._purgeT=setTimeout(function(){v.updating||v.suspended||(v._mode._flushDrawBuffer(),v._togglePurgeT(!0))},
6E4*this.purgeInterval))}else this._purgeT&&(clearTimeout(this._purgeT),this._purgeT=null)},onMessage:function(){},onConnect:function(){},onDisconnect:function(){},onFilterChange:function(){},onAttemptReconnect:function(){},onConnectionError:function(){},onPurgeIntervalChange:function(){},_createConnection:function(l,v){var A=this,B=new WebSocket(l);B.onopen=function(){A.socket=B;A._connected=!0;A._connecting=!1;A._reconnecting=!1;A._reconnectAttempts=0;A._bind();A.onConnect();v&&v(null,!0)};B.onclose=
function(E){var G=!0,I=A._connected,L=null;if(A._connected||A._reconnecting){if(E.code){var K="Connection failed: ";if(1001===E.code)K+=E.reason||"Service is going away.",G=!1;else if(4400===E.code)K+=E.reason||"Invalid url parameters. Check filter properties.",G=!1;else if(4404===E.code)K+="Service not found",G=!1;else if(4401===E.code||4403===E.code)K+="Not authorized",G=!1}G&&(A._reconnectAttempts+=1,A._reconnectAttempts>A.maxReconnectAttempts&&(K="Maximum reconnect attempts exceeded",G=!1,I=!0));
A._connected=!1;I&&(K&&(L=Error(K)),A.onDisconnect({error:L,willReconnect:G}));G?A._attemptReconnect():A.socket=null}else A.socket||(L=Error("Could not make connection to service"),A.onConnectionError({error:L})),A.socket=null,A._connected=!1};B.onerror=function(E){};return B},_getKeepLatestFeatures:function(){var l=new y;this._map&&this._keepLatestUrl&&!this._keepLatestQueried&&this._mode._fetchArchive?this._mode._fetchArchive(this._keepLatestUrl).then(function(){l.resolve()}.bind(this)).otherwise(function(v){l.reject(v)}).always(function(){this._keepLatestQueried=
!0}.bind(this)):l.resolve();return l.promise},_getRelatedFeatures:function(){var l=new y;this._map&&this._relatedUrl&&!this._relatedQueried&&this._mode._fetchArchive?this._mode._fetchArchive(this._relatedUrl).then(function(){l.resolve()}.bind(this)).otherwise(function(v){l.reject(v)}).always(function(){this._relatedQueried=!0}.bind(this)):l.resolve();return l.promise},_purge:function(){var l,v=[];if(this.purgeOptions.displayCount&&this.graphics.length>this.purgeOptions.displayCount)for(l=0;l<this.graphics.length-
this.purgeOptions.displayCount;l++){var A=this.graphics[l];v.push(A)}0<v.length&&(this._mode._removeFeatures(v),this._trackManager&&this._trackManager.removeFeatures(v))},_bind:function(){var l=this;this.socket.onmessage=function(v){l._onMessage(JSON.parse(v.data))}},_onMessage:function(l){var v=this;this.onMessage(l);var A={create:function(B){v._create(B)},update:function(B){v._update(B)},"delete":function(B){v._delete(B)}};if(l.type)A[l.type](l.feature);else l.hasOwnProperty("filter")?v._handleFilterMessage(l):
this._create(l)},_create:function(l){function v(E){if(!A._featureHasOID(E,B)){if(!E.geometry)return!1;E.attributes=E.attributes||{};E.attributes[B]=A._nextId++}E=E.declaredClass?E:new b(E);A._mode.drawFeature(E)}var A=this,B=A.objectIdField;l.length?l.forEach(function(E){E&&v(E)}):l&&v(l)},_delete:function(l){var v=this,A=l[v.objectIdField]||l.attributes[v.objectIdField],B=!1;this.graphics.forEach(function(E){E.attributes[v.objectIdField]==A&&(B=E)});B&&this.remove(B)},_update:function(l){var v=this,
A=!1;this.graphics.forEach(function(B){B.attributes[v.objectIdField]==l.attributes[v.objectIdField]&&(A=B)});A&&(l.attributes&&A.setAttributes(l.attributes),l.geometry&&A.setGeometry(k.fromJson(l.geometry)))},_makeFilter:function(l){var v=null;l=l||{};if(void 0!==l.geometry)if(v=v||{},null===l.geometry)v.geometry=null;else{var A="string"===typeof l.geometry?k.fromJson(JSON.parse(l.geometry)):l.geometry.declaredClass?l.geometry:k.fromJson(l.geometry);if(!A||"point"===A.type)throw"Query object contains invalid geometry";
"extent"!==A.type&&(A=A.getExtent());if(!A||0===A.getHeight()&&0===A.getWidth())throw"Invalid filter geometry: Extent cannot have a height and width of 0";v.spatialRel="esriSpatialRelIntersects";v.geometryType="esriGeometryEnvelope";v.geometry=A.toJson()}void 0!==l.where&&(v=v||{},v.where=l.where);if(void 0!==l.outFields&&(v=v||{},l="string"===typeof l.outFields?"*"===l.outFields?null:l.outFields.replace(/,\s+/g,",").split(","):null===l.outFields?null:l.outFields,l=this._makeOutFields(l))){if(l.errors&&
0<l.errors.length)throw"Invalid filter outFields. "+l.errors.join(",");v.outFields=l.fields?l.fields.join(","):null}return v},_makeOutFields:function(l){var v=this,A=[],B=[],E={fields:null};if(!l||0===l.length)return E;a.forEach(l,function(G){if("*"===G)return E;var I=v._getField(G,!0);I?A.push(I.name):B.push("Field named "+G+" not found in schema.")});l=v._getOutFields();a.forEach(l,function(G){v._getField(G)&&-1===a.indexOf(A,G)&&A.push(G)});E.fields=A;E.errors=B;return E},_handleFilterMessage:function(l){l.error?
(l=Error(l.error.join(",")),this.onFilterChange({filter:this.getFilter(),error:l})):(l=l.filter,l.geometry&&"string"===typeof l.geometry&&(l.geometry=JSON.parse(l.geometry)),this._filter=l,this.onFilterChange({filter:this.getFilter()}))},_getWebsocketConnectionInfo:function(l){var v={urls:[]},A,B=[],E=[],G;l.streamUrls&&a.forEach(l.streamUrls,function(K){"ws"===K.transport&&(A=K.urls,v.token=K.token)});if(!A)return v;a.forEach(A,function(K){0===K.lastIndexOf("wss",0)?E.push(K):B.push(K)});l="https:"===
location.protocol||0===this.url.lastIndexOf("https:",0)?E:0===B.length?E:B;if(1<l.length)for(G=0;G<l.length-1;G++){var I=G+Math.floor(Math.random()*(l.length-G));var L=l[I];l[I]=l[G];l[G]=L}v.urls=l;return v},_attemptReconnect:function(){var l=this;this._reconnectTimeoutId=null;l._connected=!1;if(!l._socketUrls)return!1;if(!l._collection&&!l._reconnecting&&l.socket&&l.credential)return l._reconnecting=!0,l._getServiceConnectionMetadata(l._attemptReconnect),!1;l._reconnecting=!0;l.socket=null;if(l._reconnectAttempts>
l.maxReconnectAttempts)return l._reconnecting=!1;l.socketUrl=l._socketUrls[l._reconnectAttempts>l._socketUrls.length-1?l._reconnectAttempts%l._socketUrls.length:l._reconnectAttempts];l.socketUrl+="/"+l.socketDirection;var v=l._randomIntFromInterval(0,1E3);this._reconnectTimeoutId=setTimeout(function(){l.onAttemptReconnect({count:l._reconnectAttempts,url:l.socketUrl});l.connect()},1E3*l._reconnectAttempts+v)},_getServiceConnectionMetadata:function(l){var v=this,A=v._url.path;l="function"===typeof l?
l:null;e({url:A,content:z.mixin({f:"json"},this._url.query),callbackParamName:"callback"}).then(function(B){B=v._getWebsocketConnectionInfo(B);v._websocketToken=B.token;l&&l()},function(B){v.onError(Error(B))})},_setDefaultRenderer:function(){var l=this.geometryType,v=new D([5,112,176,.8]),A=new D([255,255,255]);A=new t(t.STYLE_SOLID,A,1);if("esriGeometryPoint"===l||"esriGeometryMultipoint"===l)var B=new C(C.STYLE_CIRCLE,10,A,v);else if("esriGeometryPolyline"===l)B=new t(t.STYLE_SOLID,v,2);else if("esriGeometryPolygon"===
l||"esriGeometryEnvelope"===l)v=new D([5,112,176,.2]),A=new D([5,112,176,.8]),A=new t(t.STYLE_SOLID,A,1),B=new w(w.STYLE_SOLID,A,v);B&&this.setRenderer(new u(B))},_makeObjectIdField:function(){var l=1,v,A=[];if(!this.objectIdField){var B=this.fields.length;for(v=0;v<B;v++)A.push(this.fields[v].name.toLowerCase());for(;-1!==a.indexOf(A,"objectid_"+l);)l+=1;this.objectIdField="objectid_"+l;this.fields.push({name:"objectid_"+l,type:"esriFieldTypeOID",alias:"objectid_"+l,nullable:!1})}},_featureHasOID:function(l,
v){return l.attributes&&(l.attributes[v]||0===l.attributes[v])},_randomIntFromInterval:function(l,v){return Math.floor(Math.random()*(v-l+1)+l)}});z.setObject("layers.StreamLayer",F,d);return F})},"esri/layers/StreamTrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Point ../geometry/Polyline ./TrackManager".split(" "),function(F,m,a,D,z,y,r,q,n){F=F([n],{declaredClass:"esri.layers._StreamTrackManager",constructor:function(f){this.inherited(arguments);
var d=f.getMap().spatialReference;this.isWebMercator=d.isWebMercator();this.canWrap=d._isWrappable();this.wrapThreshold=this.isWebMercator?2.0037508342788905E7:180},initialize:function(f){this.inherited(arguments)},addFeatures:function(f,d){function e(C,u){var x,l;g[C]||(g[C]=[]);var v=g[C];if(0<t){u.length>t&&u.splice(0,u.length-t);var A=u.length+v.length;A>t&&(x=v.splice(0,A-t))}A=u.length;for(l=0;l<A;l+=1)v.push(u[l]);return{deletes:x,adds:u}}var b={},c={},h;if(d)return this.inherited(arguments),
b;var g=this.trackMap;var k=this.layer;var w=k._trackIdField;var t=k.maximumTrackPoints||0;a.forEach(f,function(C){var u=C.attributes[w];C.visible&&(c[u]||(c[u]=[]),c[u].push(C))});for(h in c)c.hasOwnProperty(h)&&(k=e(h,c[h]),b[h]=k);return b},removeFeatures:function(f){var d=[],e=this.layer.objectIdField,b=this.layer._trackIdField;f&&(a.forEach(f,function(c){var h;var g=c.attributes[b];var k=c.attributes[e];if(h=this.trackMap[g])for(c=0;c<h.length;c+=1){var w=h[c];if(w.attributes[e]===k){this.trackMap[g].splice(c,
1);-1===a.indexOf(g)&&d.push(g);break}}},this),0<f.length&&this.refreshTracks(d))},drawTracks:function(f){function d(w){var t=h[w],C=t&&1<t.length,u=e.trackLineMap[w];u&&!C&&(b.remove(u),delete e.trackLineMap[w],u=null);if(!C)return!1;C=[];for(var x=[],l,v=t.length,A=0;A<v;A++)if(l=t[A].geometry){l=l.normalize();var B=l.x,E=0,G=!1;I&&e.canWrap&&(E=B-I.x,Math.abs(E)>e.wrapThreshold&&(G=!0));G?(x.push([e.getWrappedX(B),l.y]),C.push(x.slice(0)),x=[[B,l.y]]):x.push([B,l.y]);var I=new r(B,l.y,g)}1<x.length&&
C.push(x);t={};t[k]=w;if(C.length)if(u){for(var L=u.geometry;L.paths.length;)L.removePath(L.paths.length-1);C.forEach(function(K){L.addPath(K)});u.setGeometry(L)}else u=new y(new q({paths:C,spatialReference:g}),null,t),b.add(u),e.trackLineMap[w]=u}var e=this,b=this.container,c;if(b){var h=this.trackMap;var g=this.map.spatialReference;var k=this.layer._trackIdField;if(f)a.forEach(f,function(w){d(w)});else for(c in h)h.hasOwnProperty(c)&&d(c)}},refreshTracks:function(f){function d(h){var g;h=e[h]||
[];var k=h.length;for(g=0;g<k;g++)b._repaint(h[g],null,!0)}var e=this.trackMap,b=this.layer,c;this.drawTracks(f);if(f)a.forEach(f,function(h){d(h)});else for(c in e)e.hasOwnProperty(c)&&d(c)},getLatestObservations:function(){var f,d=this.trackMap,e=[];for(f in d)if(d.hasOwnProperty(f)){var b=d[f];e.push(b[b.length-1])}return e},destroy:function(){this.inherited(arguments);this.trackLineMap=null},getWrappedX:function(f){var d=this.isWebMercator,e=d?2.0037508342788905E7:180;d=d?-2.0037508342788905E7:
-180;return(0<f?d:e)-((0<f?e:d)-f)}});m.setObject("layers._StreamTrackManager",F,z);return F})},"esri/layers/PurgeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Stateful","dojo/has","../kernel"],function(F,m,a,D,z){F=F([a],{declaredClass:"esri.layers.PurgeOptions",constructor:function(y,r){this.parent=y;for(var q in r)this[q]=r[q]},_displayCountSetter:function(y){this.displayCount=y;this.parent.refresh()}});m.setObject("layers.PurgeOptions",F,z);return F})},"esri/layers/osm":function(){define(["./OpenStreetMapLayer"],
function(){return{}})},"esri/layers/VectorTileLayer":function(){(function(){var F=function(){try{var a=window.WebGLRenderingContext}catch(n){a=!1}try{for(var D=document.createElement("canvas"),z=["webgl","experimental-webgl","webkit-3d","moz-webgl"],y=null,r=0;r<z.length;++r){try{y=D.getContext(z[r])}catch(n){}if(y)break}var q=y}catch(n){q=!1}return a&&q?!0:!1}(),m=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];F&&m.push("./VectorTileLayerImpl");define(m,function(a,D,z,y,r,q){D=
q?q:r.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var n=new z;n.reject(Error("esri.layers.VectorTileLayer is not supported"));n.promise.otherwise(a.hitch(this,function(f){this._errorHandler(f)}))}});D.ACCESS_TOKEN=null;D.supported=function(){return F};a.setObject("layers.VectorTileLayer",D,y);return D})})()},"esri/layers/wms":function(){define(["./agscommon","./dynamic","./WMSLayer"],function(){return{}})},"esri/layers/dynamic":function(){define(["../geometry",
"./DynamicMapServiceLayer"],function(){return{}})},"esri/layers/DynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../sniff ../request ../domUtils ./layer ./MapImage".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b){var c=q.defaults.map.zoomDuration;F=F(e,{declaredClass:"esri.layers.DynamicMapServiceLayer",_eventMap:{"map-image-export":["mapImage"]},constructor:function(h,g){this.useMapTime=
g&&g.hasOwnProperty("useMapTime")?!!g.useMapTime:!0;this.extentProcessor=g&&g.extentProcessor;var k=a.hitch;this._exportMapImageHandler=k(this,this._exportMapImageHandler);this._imgSrcFunc=k(this,this._imgSrcFunc);this._divAlphaImageFunc=k(this,this._divAlphaImageFunc);this._tileLoadHandler=k(this,this._tileLoadHandler);this._tileErrorHandler=k(this,this._tileErrorHandler);this.registerConnectEvents()},opacity:1,isPNG32:!1,_setMap:function(h,g,k){this.inherited(arguments);this._map=h;var w=this._div=
D.create("div",null,g),t=r._css.names,C={position:"absolute",width:h.width+"px",height:h.height+"px",overflow:"visible",opacity:this.opacity},u=n("ie"),x=m.connect,l=h.__visibleDelta;8===u&&delete C.opacity;"css-transforms"===h.navigationMode?(this._isChildLayer||(C[t.transform]=r._css.translate(l.x,l.y),z.set(w,C)),this._left=l.x,this._top=l.y):(C.left="0px",C.top="0px",z.set(w,C),this._left=this._top=0);z.set(w,C);this._onResizeHandler_connect=x(h,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=
x(this,"onOpacityChange",this,"_opacityChangeHandler");this._img_loading=null;this._dragOrigin={x:0,y:0};this.evaluateSuspension();if(this.suspended&&!h.loaded)var v=m.connect(h,"onLoad",this,function(){m.disconnect(v);v=null;this.evaluateSuspension()});this.extentProcessor&&(this._panEndEvalHandle=m.connect(h,"onPanEnd",this,this.evaluateSuspension),this._zoomEndEvalHandle=m.connect(h,"onZoomEnd",this,this.evaluateSuspension));return w},_unsetMap:function(h,g){this._img&&this._clearEventListeners(this._img);
this._img_loading&&this._clearEventListeners(this._img_loading);D.destroy(this._div);this._map=this._div=this._img=this._img_loading=null;var k=m.disconnect;k(this._onResizeHandler_connect);k(this._opacityChangeHandler_connect);k(this._panEndEvalHandle);k(this._zoomEndEvalHandle);this._panEndEvalHandle=this._zoomEndEvalHandle=this._onResizeHandler_connect=this._opacityChangeHandler_connect=null;this._fireUpdateEnd();this._toggleTime();clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();
this.inherited(arguments)},_onResizeHandler:function(h,g,k){z.set(this._div,{width:g+"px",height:k+"px"});this._onExtentChangeHandler(h)},onSuspend:function(){this.inherited(arguments);this._fireUpdateEnd();this._toggleTime();d.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(){this.inherited(arguments);var h=this._map;this._toggleTime();"css-transforms"===h.navigationMode&&(h=h.__visibleDelta,this._left=h.x,this._top=h.y,this._isChildLayer||
z.set(this._div,r._css.names.transform,r._css.translate(this._left,this._top)));this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0)}),0)},canResume:function(){var h=this.inherited(arguments);if(h){var g=this._map.extent;this.extentProcessor&&g&&(h=!!this.extentProcessor({layer:this,extent:g,width:this._map.width}).extent)}return h},_enableDrawConnectors:function(){var h=m.connect,g=this._map;
g&&(this._onPanHandler_connect=h(g,"onPan",this,"_onPanHandler"),this._onExtentChangeHandler_connect=h(g,"onExtentChange",this,"_onExtentChangeHandler"),"css-transforms"===g.navigationMode?this._onScaleHandler_connect=h(g,"onScale",this,this._onScaleHandler):this._onZoomHandler_connect=h(g,"onZoom",this,"_onZoomHandler"))},_disableDrawConnectors:function(){var h=m.disconnect;h(this._onPanHandler_connect);h(this._onExtentChangeHandler_connect);h(this._onZoomHandler_connect);h(this._onScaleHandler_connect);
this._onPanHandler_connect=this._onExtentChangeHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=null},_toggleTime:function(){var h=this._map;this.timeInfo&&this.useMapTime&&h&&!this.suspended?(this._timeConnect||(this._timeConnect=m.connect(h,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(h.timeExtent)):(m.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},_setTime:function(h){this._params&&(this._params.time=h?h.toJson().join(","):
null)},_onPanHandler:function(h,g){this._panDx=g.x;this._panDy=g.y;var k=this._dragOrigin,w=this._map.__visibleDelta,t=this._img;t&&("css-transforms"===this._map.navigationMode?(this._left=w.x+g.x,this._top=w.y+g.y,this._isChildLayer||z.set(this._div,r._css.names.transform,r._css.translate(this._left,this._top))):z.set(t,{left:k.x+g.x+"px",top:k.y+g.y+"px"}))},_onExtentChangeHandler:function(h,g,k){if(!this.suspended){clearTimeout(this._wakeTimer);this._wakeTimer=null;var w=this._map,t=this._img,
C=t&&t.style,u=this._dragOrigin;!g||k||!t||g.x===this._panDx&&g.y===this._panDy||("css-transforms"===w.navigationMode?(g=w.__visibleDelta,this._left=g.x,this._top=g.y,this._isChildLayer||z.set(this._div,r._css.names.transform,r._css.translate(this._left,this._top))):z.set(t,{left:u.x+g.x+"px",top:u.y+g.y+"px"}));t?(u.x=parseInt(C.left,10),u.y=parseInt(C.top,10)):u.x=u.y=0;"css-transforms"===w.navigationMode&&k&&t&&(z.set(t,r._css.names.transition,"none"),t._multiply=t._multiply?y.multiply(t._matrix,
t._multiply):t._matrix);this._fireUpdateStart();if(k=this._img_loading)if(this._clearEventListeners(k),D.destroy(k),this._img_loading=null,k=this._jsonRequest){try{k.cancel()}catch(G){}this._jsonRequest=null}var x=w.width;k=w.height;g=x;var l=0;10<=this.version&&w.wrapAround180&&(h=h._normalize(!0));this.extentProcessor&&(l=this.extentProcessor({layer:this,extent:h,width:g}),h=l.extent,g=l.width,l=l.marginLeft||0);if(this.isPNG32)t=this._img_loading=D.create("div"),t.id=w.id+"_"+this.id+"_"+(new Date).getTime(),
z.set(t,{position:"absolute",left:"0px",top:"0px",width:g+"px",height:k+"px"}),w=t.appendChild(D.create("div")),z.set(w,{opacity:0,width:g+"px",height:k+"px"}),this.getImageUrl(h,g,k,this._divAlphaImageFunc),t=null;else{var v=this._img_loading=D.create("img"),A=r._css.names,B=n("ie"),E={position:"absolute",width:g+"px",height:k+"px"};v.setAttribute("decoding","sync");8===B&&(E.opacity=this.opacity);null!=l&&0!==l&&(E.marginLeft=l+"px");"css-transforms"===w.navigationMode?(E[A.transform]=r._css.translate(-this._left,
-this._top),v._tdx=-this._left,v._tdy=-this._top,E[A.transition]=A.transformName+" "+c+"ms ease",this.extentProcessor&&(E[A.origin]=x/2-l+"px "+k/2+"px")):(E.left="0px",E.top="0px");v.id=w.id+"_"+this.id+"_"+(new Date).getTime();z.set(v,E);v._onload_connect=m.connect(v,"onload",this,"_onLoadHandler");v._onerror_connect=m.connect(v,"onerror",this,"_onErrorHandler");v._onabort_connect=m.connect(v,"onabort",this,"_onErrorHandler");this._startRect={left:u.x,top:u.y,width:t?parseInt(C.width,10):g,height:t?
parseInt(C.height,10):k,marginLeft:t?parseInt(C.marginLeft||"0",10):l,zoom:C&&C.zoom?parseFloat(C.zoom):1};this.getImageUrl(h,g,k,this._imgSrcFunc);v=null}}},_onTimeExtentChangeHandler:function(h){this.suspended||(this._setTime(h),this.refresh(!0))},getImageUrl:function(h,g,k,w){},_imgSrcFunc:function(h){this._img_loading.src=h},_divAlphaImageFunc:function(h){z.set(this._img_loading,"filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+h+"', sizingMethod\x3d'scale')");this._onLoadHandler({currentTarget:this._img_loading})},
_onLoadHandler:function(h){h=h.currentTarget;var g=this._map;this._clearEventListeners(h);!g||g.__panning||g.__zooming?D.destroy(h):(this._img&&this._div.removeChild(this._img),this._img=h,g=h.style,this._startRect={left:0,top:0,width:parseInt(g.width,10),height:parseInt(g.height,10),marginLeft:parseInt(g.marginLeft||"0",10),zoom:1},this._div.appendChild(h),this.suspended||d.show(this._div),this._img_loading=null,h=this._dragOrigin,h.x=h.y=0,this.onUpdate());this._fireUpdateEnd()},_onErrorHandler:function(h){h=
h.currentTarget;z.set(h,"visibility","hidden");this._clearEventListeners(h);h=Error("Unable to load image: "+h.src);this.onError(h);this._fireUpdateEnd(h)},_clearEventListeners:function(h){m.disconnect(h._onload_connect);m.disconnect(h._onerror_connect);m.disconnect(h._onabort_connect);h._onload_connect=h._onerror_connect=h._onabort_connect=null},setUseMapTime:function(h,g){this.useMapTime=h;this._toggleTime();g||this.refresh(!0)},refresh:function(){this._map&&this._onExtentChangeHandler(this._map.extent)},
_onScaleHandler:function(h,g){var k={},w=r._css.names,t=this._img;if(t){z.set(t,w.transition,g?"none":w.transformName+" "+c+"ms ease");t._matrix=h;h=t._multiply?y.multiply(h,t._multiply):h;if(t._tdx||t._tdy)h=y.multiply(h,{xx:1,xy:0,yx:0,yy:1,dx:t._tdx,dy:t._tdy});k[w.transform]=r._css.matrix(h);z.set(t,k)}},_onZoomHandler:function(h,g,k){h=this._startRect;var w=h.width*g,t=h.height*g,C=h.marginLeft*g,u=this._img,x=n("ie");u&&(x&&8>x?z.set(u,{left:h.left-(w-h.width)*(k.x-h.left)/h.width+"px",top:h.top-
(t-h.height)*(k.y-h.top)/h.height+"px",zoom:g*h.zoom}):z.set(u,{left:h.left-(w-h.width)*(k.x-h.left)/h.width+"px",top:h.top-(t-h.height)*(k.y-h.top)/h.height+"px",width:w+"px",height:t+"px"}),null!=C&&0!==C&&z.set(u,{marginLeft:C+"px"}))},_exportMapImage:function(h,g,k){var w=this._exportMapImageHandler;g.token=this._getToken();f({url:h,content:g,callbackParamName:"callback",load:function(t,C){w(t,C,k)},error:q.defaults.io.errorHandler})},_exportMapImageHandler:function(h,g,k){h=new b(h);this.onMapImageExport(h);
k&&k(h)},onMapImageExport:function(){},setOpacity:function(h){if(this.opacity!=h)this.onOpacityChange(this.opacity=h)},onOpacityChange:function(){},_opacityChangeHandler:function(h){var g=8===n("ie")?this._img:this._div;z.set(g,"opacity",h)}});a.setObject("layers.DynamicMapServiceLayer",F,r);return F})},"esri/layers/wmts":function(){define(["./agscommon","./tiled","./WMTSLayer"],function(){return{}})},"esri/layers/tiled":function(){define(["./TiledMapServiceLayer","./TileInfo","./LOD","../geometry",
"../utils"],function(){return{}})},"esri/layers/WMTSLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff dojox/xml/parser ../kernel ../lang ../request ../urlUtils ../WKIDUnitConversion ../SpatialReference ../geometry/Point ../geometry/Extent ../geometry/webMercatorUtils ./TiledMapServiceLayer ./TileInfo ./WMTSLayerInfo dojo/query".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w){m=m([g],{declaredClass:"esri.layers.WMTSLayer",copyright:null,
extent:null,tileUrl:null,spatialReference:null,tileInfo:null,constructor:function(t,C){this.version="1.0.0";this.tileUrl=this._url=t;this.serviceMode="RESTful";this._parseCapabilities=a.hitch(this,this._parseCapabilities);this._getCapabilitiesError=a.hitch(this,this._getCapabilitiesError);this._formatDictionary={"image/png":".png","image/png8":".png","image/png24":".png","image/png32":".png","image/jpg":".jpg","image/jpeg":".jpeg","image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"",
"image/jpegpng":"","image/unknown":""};C||(C={});if(C.serviceMode)if("KVP"===C.serviceMode||"RESTful"===C.serviceMode)this.serviceMode=C.serviceMode;else return;this.customParameters=C.customParameters;this.customLayerParameters=C.customLayerParameters;this.layerInfo=new w;C.layerInfo&&(this.layerInfo=C.layerInfo,this._identifier=C.layerInfo.identifier,this._tileMatrixSetId=C.layerInfo.tileMatrixSet,C.layerInfo.format&&(this.format="image/"+C.layerInfo.format),this._style=C.layerInfo.style,this.title=
C.layerInfo.title,this._dimension=C.layerInfo.dimension,this._dimension2=C.layerInfo.dimension2);C.resourceInfo?(this.version=C.resourceInfo.version,C.resourceInfo.getTileUrl&&(this._url=this.tileUrl=C.resourceInfo.getTileUrl),this.copyright=C.resourceInfo.copyright,this.layerInfos=C.resourceInfo.layerInfos,this.customParameters=C.resourceInfo.customParameters||this.customParameters,this.customLayerParameters=C.resourceInfo.customLayerParameters||this.customLayerParameters,this._parseResourceInfo(),
this.loaded=!0,this.onLoad(this)):this._getCapabilities()},setActiveLayer:function(t){this.setVisibleLayer(t)},setVisibleLayer:function(t){this._setActiveLayer(t);this.refresh(!0)},setCustomParameters:function(t,C){this.customParameters=t;this.customLayerParameters=C;this.refresh(!0)},getTileUrl:function(t,C,u){t=this._levelToLevelValue[t];t=this.resourceUrls&&0<this.resourceUrls.length?this.resourceUrls[C%this.resourceUrls.length].template.replace(/\{Style\}/gi,this._style).replace(/\{TileMatrixSet\}/gi,
this._tileMatrixSetId).replace(/\{TileMatrix\}/gi,t).replace(/\{TileRow\}/gi,C).replace(/\{TileCol\}/gi,u).replace(/\{dimensionValue\}/gi,this._dimension).replace(/\{dimensionValue2\}/gi,this._dimension2):this.UrlTemplate.replace(/\{level\}/gi,t).replace(/\{row\}/gi,C).replace(/\{col\}/gi,u);t=this._appendCustomLayerParameters(t);t=this.addTimestampToURL(t);return f.addProxy(t)},getTileUrlTemplate:function(t){var C=t.identifier,u=t.tileMatrixSet,x=t.format,l=t.style,v=t.dimension,A=t.dimension2;C?
t=D.filter(this.layers,function(E){return E.identifier===C})[0]:(t=this.layers[0],C=this.layers[0].identifier);if(t){if(!x)x=t.formats[0];else if(!(-1===x.indexOf("image/")&&-1<D.indexOf(t.formats,x))&&(-1===x.indexOf("image/")&&(x="image/"+x),-1===D.indexOf(t.formats,x))){this.onError(Error("The layer doesn't support the format of "+x));return}if(!l)l=t.styles[0];else if(-1===D.indexOf(t.styles,l)){this.onError(Error("The layer doesn't support the style of "+l));return}if(!v&&t.dimensions)v=t.dimensions[0];
else if(-1===D.indexOf(t.dimensions,v)){this.onError(Error("The layer doesn't support the dimension of "+v));return}if(!A&&t.dimensions2)A=t.dimensions2[0];else if(-1===D.indexOf(t.dimensions2,A)){this.onError(Error("The layer doesn't support the dimension of "+A));return}if(u){var B=D.filter(t.tileMatrixSetInfos,function(E){return E.tileMatrixSet===u})[0];if(!B){this.onError(Error("The tileMatrixSetId "+u+" is not supported by the layer of "+C));return}}else(B=D.filter(t.tileMatrixSetInfos,function(E){return"GoogleMapsCompatible"===
E.tileMatrixSet})[0])||(B=t.tileMatrixSetInfos[0]),u=B.tileMatrixSet;return this._getTileUrlTemplate(C,u,x,l,v,A)}this.onError(Error("couldn't find the layer "+C))},_getTileUrlTemplate:function(t,C,u,x,l,v){t||(t=this._identifier);C||(C=this._tileMatrixSetId);u||(u=this.format);x||""===x||(x=this._style);if(this.resourceUrls&&0<this.resourceUrls.length){var A=this.resourceUrls[0].template;A.indexOf(".xxx")===A.length-4&&(A=A.slice(0,A.length-4));A=A.replace(/\{Style\}/gi,x);A=A.replace(/\{TileMatrixSet\}/gi,
C);A=A.replace(/\{TileMatrix\}/gi,"{level}");A=A.replace(/\{TileRow\}/gi,"{row}");A=A.replace(/\{TileCol\}/gi,"{col}");A=A.replace(/\{dimensionValue\}/gi,l);return A=A.replace(/\{dimensionValue2\}/gi,v)}"KVP"===this.serviceMode?A=this._url+"SERVICE\x3dWMTS\x26VERSION\x3d"+this.version+"\x26REQUEST\x3dGetTile\x26LAYER\x3d"+t+"\x26STYLE\x3d"+x+"\x26FORMAT\x3d"+u+"\x26TILEMATRIXSET\x3d"+C+"\x26TILEMATRIX\x3d{level}\x26TILEROW\x3d{row}\x26TILECOL\x3d{col}":"RESTful"===this.serviceMode&&(l="",this._formatDictionary[u.toLowerCase()]&&
(l=this._formatDictionary[u.toLowerCase()]),A=this._url+t+"/"+x+"/"+C+"/{level}/{row}/{col}"+l);return A},_parseResourceInfo:function(){var t=this.layerInfos,C;"KVP"===this.serviceMode&&(this._url+=-1<this._url.indexOf("?")?"":"?");for(C=0;C<t.length;C++)if(!(this._identifier&&t[C].identifier!==this._identifier||this.title&&t[C].title!==this.title||this._tileMatrixSetId&&t[C].tileMatrixSet!==this._tileMatrixSetId||this.format&&"image/"+t[C].format!==this.format||this._style&&t[C].style!==this._style)){a.mixin(this,
{description:t[C].description,tileInfo:t[C].tileInfo,spatialReference:t[C].tileInfo.spatialReference,fullExtent:t[C].fullExtent,initialExtent:t[C].initialExtent,_identifier:t[C].identifier,_tileMatrixSetId:t[C].tileMatrixSet,format:"image/"+t[C].format,_style:t[C].style});break}for(C=0;C<t.length;C++){var u=t[C].tileInfo;96!==u.dpi&&(D.forEach(u.lods,function(x){x.scale=96*x.scale/u.dpi}),u.dpi=96);D.forEach(u.lods,function(x){x.resolution=this._getResolution(u.spatialReference.wkid,90.71428571428571*
x.scale/96,t[C].tileMatrixSet)},this)}this._setActiveLayer();this.UrlTemplate=this._getTileUrlTemplate();this._levelToLevelValue=[];D.forEach(this.tileInfo.lods,function(x){this._levelToLevelValue[x.level]=x.levelValue?x.levelValue:x.level},this)},_getCapabilities:function(){var t;"KVP"===this.serviceMode?t=-1<this._url.indexOf("?")?this._url+"\x26request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:this._url+"?request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:
"RESTful"===this.serviceMode&&(t=this._url+"/"+this.version+"/WMTSCapabilities.xml");t=this._appendCustomParameters(t);n({url:t,handleAs:"text",load:this._parseCapabilities,error:this._getCapabilitiesError})},_parseCapabilities:function(t){t=t.replace(/ows:/gi,"");t=y.parse(t);var C=F.query("Contents",t)[0];if(C){var u=F.query("OperationsMetadata",t)[0],x=F.query("[name\x3d'GetTile']",u)[0];u=this._url;x=F.query("Get",x);var l,v=!1;for(l=0;l<x.length;l++){var A=F.query("Constraint",x[l])[0];if(!A||
this._getTagWithChildTagValue("AllowedValues","Value",this.serviceMode,A)){u=x[l].attributes[0].nodeValue;v=!0;break}else if(!A||this._getTagWithChildTagValue("AllowedValues","Value","RESTful",A))var B=x[l].attributes[0].nodeValue;else if(!A||this._getTagWithChildTagValue("AllowedValues","Value","KVP",A))var E=x[l].attributes[0].nodeValue}v||("KVP"===this.serviceMode&&B?(u=B,this.serviceMode="RESTful"):"RESTful"===this.serviceMode&&E&&(u=E,this.serviceMode="KVP"));-1===u.indexOf("/1.0.0/")&&"RESTful"===
this.serviceMode&&(u+="/");"KVP"===this.serviceMode&&(u+=-1<u.indexOf("?")?"":"?");this._url=u;this.copyright=this._getTagValues("Capabilities\x3eServiceIdentification\x3eAccessConstraints",t)[0];B=F.query("Layer",C);var G,I=[];this.layers=[];D.forEach(B,function(L){G=this._getTagValues("Identifier",L)[0];I.push(G);this.layers.push(this._getWMTSLayerInfo(G,L,C))},this);this._setActiveLayer();this.loaded=!0;this.onLoad(this)}else this.onError(Error("The WMTS capabilities XML is not valid"))},_setActiveLayer:function(t){t||
(t={});t.identifier&&(this._identifier=t.identifier);t.tileMatrixSet&&(this._tileMatrixSetId=t.tileMatrixSet);t.format&&(this.format=t.format);t.style&&(this._style=t.style);t.dimension&&(this._dimension=t.dimension);t.dimension2&&(this._dimension2=t.dimension2);if(this.layers)if(this._identifier?t=D.filter(this.layers,function(u){return u.identifier===this._identifier},this)[0]:(t=this.layers[0],this._identifier=this.layers[0].identifier),t){if(this.format){if(-1===this.format.indexOf("image/")&&
(this.format="image/"+this.format),-1===D.indexOf(t.formats,this.format)){this.onError(Error("The layer doesn't support the format of "+this.format));return}}else this.format=t.formats[0],-1===this.format.indexOf("image/")&&(this.format="image/"+this.format);if(!this._style)this._style=t.styles[0];else if(-1===D.indexOf(t.styles,this._style)){this.onError(Error("The layer doesn't support the style of "+this._style));return}if(!this._dimension&&t.dimensions)this._dimension=t.dimensions[0];else if(-1===
D.indexOf(t.dimensions,this._dimension)){this.onError(Error("The layer doesn't support the dimension of "+this._dimension));return}if(!this._dimension2&&t.dimensions2)this._dimension2=t.dimensions2[0];else if(-1===D.indexOf(t.dimensions2,this._dimension2)){this.onError(Error("The layer doesn't support the dimension of "+this._dimension2));return}if(this._tileMatrixSetId){var C=D.filter(t.tileMatrixSetInfos,function(u){return u.tileMatrixSet===this._tileMatrixSetId},this)[0];if(!C){this.onError(Error("The tileMatrixSetId "+
this._tileMatrixSetId+" is not supported by the layer of "+this._identifier));return}}else(C=D.filter(t.tileMatrixSetInfos,function(u){return"GoogleMapsCompatible"===u.tileMatrixSet})[0])||(C=t.tileMatrixSetInfos[0]),this._tileMatrixSetId=C.tileMatrixSet;this.description=t.description;this.title=t.title;this.spatialReference=C.tileInfo.spatialReference;this.tileInfo=C.tileInfo;this._levelToLevelValue=[];D.forEach(this.tileInfo.lods,function(u){this._levelToLevelValue[u.level]=u.levelValue?u.levelValue:
u.level},this);102100===this.spatialReference.wkid||102113===this.spatialReference.wkid?this.fullExtent=this.initialExtent=h.geographicToWebMercator(t.gcsExtent):4326===this.spatialReference.wkid?this.fullExtent=this.initialExtent=t.gcsExtent:(this.fullExtent=C.fullExtent,this.initialExtent=C.initialExtent);this.resourceUrls=t.resourceUrls;this.UrlTemplate=this._getTileUrlTemplate();this.layerInfo={identifier:this._identifier,tileMatrixSet:this._tileMatrixSetId,format:this.format,style:this._style,
fullExtent:this.fullExtent,initialExtent:this.initialExtent,tileInfo:this.tileInfo,title:this.title,description:this.description}}else this.onError(Error("couldn't find the layer "+this._identifier))},_getWMTSLayerInfo:function(t,C,u){var x=this._getTagValues("Abstract",C)[0],l=this._getTagValues("Title",C)[0],v=F.query("WGS84BoundingBox",C)[0],A=v?this._getTagValues("LowerCorner",v)[0].split(" "):["-180","-90"],B=v?this._getTagValues("UpperCorner",v)[0].split(" "):["180","90"];v=parseFloat(A[0]);
A=parseFloat(A[1]);var E=parseFloat(B[0]);B=parseFloat(B[1]);v=new c(v,A,E,B,new e({wkid:4326}));B=this._getTagValues("Identifier",F.query("Style",C)[0]);var G=this._getTagValues("Identifier",F.query("Dimension",C)[0]),I=this._getTagValues("Default",F.query("Dimension",C)[0])||this._getTagValues("Value",F.query("Dimension",C)[0]),L=1<F.query("Dimension",C).length?this._getTagValues("Identifier",F.query("Dimension",C)[1]):[],K=1<F.query("Dimension",C).length?this._getTagValues("Default",F.query("Dimension",
C)[1])||this._getTagValues("Value",F.query("Dimension",C)[1]):[];A=this._getTagValues("Format",C);u=this._getLayerMatrixInfos(C,u);t={identifier:t,tileMatrixSetInfos:u,formats:A,styles:B,title:l,description:x,gcsExtent:v,dimensions:I,dimensions2:K};C=F.query("ResourceURL",C);var ba=[],T;D.forEach(C,function(P){T=P.getAttribute("template");if(G&&I&&G[0]&&I[0])if(-1<T.indexOf("{"+G+"}"))T=T.replace("{"+G+"}","{dimensionValue}");else{var J=T.toLowerCase().indexOf("{"+G[0].toLowerCase()+"}");-1<J&&(T=
T.substring(0,J)+"{dimensionValue}"+T.substring(J+G[0].length+2))}L&&K&&L[0]&&K[0]&&(-1<T.indexOf("{"+L+"}")?T=T.replace("{"+L+"}","{dimensionValue2}"):(J=T.toLowerCase().indexOf("{"+L[0].toLowerCase()+"}"),-1<J&&(T=T.substring(0,J)+"{dimensionValue2}"+T.substring(J+L[0].length+2))));ba.push({template:T,format:P.getAttribute("format"),resourceType:P.getAttribute("resourceType")})});ba&&0<ba.length&&(t.resourceUrls=ba);return t},_getLayerMatrixInfos:function(t,C){var u=[],x=this._getTagValues("TileMatrixSet",
t);if(x&&0!==x.length)return D.forEach(x,function(l){l=this._getLayerMatrixInfo(l,t,C);u.push(l)},this),u},_getLayerMatrixInfo:function(t,C,u){var x=[];C=this._getTagWithChildTagValue("TileMatrixSetLink","TileMatrixSet",t,C);var l=this._getTagValues("TileMatrix",C),v=this._getTagWithChildTagValue("TileMatrixSet","Identifier",t,u),A=this._getTagValues("SupportedCRS",v)[0];var B=parseInt(A.split(":").pop(),10);if(900913==B||3857==B)B=102100;if(-1<A.toLowerCase().indexOf("crs84")||-1<A.toLowerCase().indexOf("crs:84")){B=
4326;var E=!0}else if(-1<A.toLowerCase().indexOf("crs83")||-1<A.toLowerCase().indexOf("crs:83"))B=4269,E=!0;else if(-1<A.toLowerCase().indexOf("crs27")||-1<A.toLowerCase().indexOf("crs:27"))B=4267,E=!0;var G=new e({wkid:B}),I=F.query("TileMatrix",v)[0];u=parseInt(this._getTagValues("TileWidth",I)[0],10);C=parseInt(this._getTagValues("TileHeight",I)[0],10);var L=this._getTagValues("TopLeftCorner",I)[0].split(" ");var K=L[0],ba=L[1];1<K.split("E").length&&(L=K.split("E"),K=L[0]*Math.pow(10,L[1]));1<
ba.split("E").length&&(L=ba.split("E"),ba=L[0]*Math.pow(10,L[1]));K=parseFloat(K);ba=parseFloat(ba);var T=E&&4326===B&&90===K&&-180===ba;for(L=0;L<this._flippingAxisForWkids.length;L++)if(A.split(":").pop()>=this._flippingAxisForWkids[L][0]&&A.split(":").pop()<=this._flippingAxisForWkids[L][1]||4326===B&&(!E||T)){4326===B&&90<K&&(K="90");var P=new b(ba,K,G);break}L===this._flippingAxisForWkids.length&&(P=new b(K,ba,G));if(0===l.length)for(l=F.query("TileMatrix",v),L=0;L<l.length;L++)E=this._getLodFromTileMatrix(l[L],
B,L,t),x.push(E);else for(L=0;L<l.length;L++)E=this._getTagWithChildTagValue("TileMatrix","Identifier",l[L],v),E=this._getLodFromTileMatrix(E,B,L,t),x.push(E);B=F.query("BoundingBox",v)[0];if(B){var J=this._getTagValues("LowerCorner",B)[0].split(" ");var N=this._getTagValues("UpperCorner",B)[0].split(" ")}J&&1<J.length&&N&&1<N.length?(I=parseFloat(J[0]),B=parseFloat(J[1]),J=parseFloat(N[0]),N=parseFloat(N[1])):(J=this._getTagValues("MatrixWidth",I)[0],B=this._getTagValues("MatrixHeight",I)[0],I=P.x,
N=P.y,J=I+J*C*x[0].resolution,B=N-B*u*x[0].resolution);N=J=new c(I,B,J,N,G);P=new k({dpi:96,spatialReference:G,format:this.format,rows:u,cols:C,origin:P,lods:x});return{tileMatrixSet:t,fullExtent:N,initialExtent:J,tileInfo:P}},_getCapabilitiesError:function(t){this.onError(t)},_getLodFromTileMatrix:function(t,C,u,x){var l=this._getTagValues("Identifier",t)[0];t=this._getTagValues("ScaleDenominator",t)[0];1<t.split("E").length?(t=t.split("E"),t=t[0]*Math.pow(10,t[1])):t=parseFloat(t);C=this._getResolution(C,
t,x);return{level:u,levelValue:l,scale:1.058267716535433*t,resolution:C}},_getResolution:function(t,C,u){t=q.isDefined(d[t])?d.values[d[t]]:"default028mm"===u?6370997*Math.PI/180:6378137*Math.PI/180;return 7*C/25E3/t},_getTag:function(t,C){var u=F.query(t,C);return u&&0<u.length?u[0]:null},_getTagValues:function(t,C){var u=[],x=t.split("\x3e"),l;var v=F.query(x[0],C)[0];if(1<x.length){for(l=1;l<x.length-1;l++)v=F.query(x[l],v)[0];x=F.query(x[x.length-1],v)}else x=F.query(x[0],C);x&&0<x.length&&D.forEach(x,
function(A){9>z("ie")?u.push(A.childNodes.length?A.childNodes[0].nodeValue:""):u.push(A.textContent)});return u},_getAttributeValues:function(t,C,u){t=F.query(t,u);var x=[];t&&0<t.length&&D.forEach(t,function(l){x.push(l.getAttribute(C))});return x},_getTagWithChildTagValue:function(t,C,u,x){x=x.childNodes;var l;for(l=0;l<x.length;l++)if(-1<x[l].nodeName.indexOf(t)){if(9>z("ie")){if(q.isDefined(F.query(C,x[l])[0]))var v=F.query(C,x[l])[0].childNodes[0].nodeValue}else q.isDefined(F.query(C,x[l])[0])&&
(v=F.query(C,x[l])[0].textContent);if(v===u||u.split(":")&&v===u.split(":")[1])return x[l]}},_appendCustomParameters:function(t){var C;if(this.customParameters)for(C in this.customParameters)t+=(-1===t.indexOf("?")?"?":"\x26")+C+"\x3d"+encodeURIComponent(this.customParameters[C]);return t},_appendCustomLayerParameters:function(t){var C;if(this.customLayerParameters||this.customParameters){var u=a.clone(this.customParameters||{});a.mixin(u,this.customLayerParameters||{});for(C in u)t+=(-1===t.indexOf("?")?
"?":"\x26")+C+"\x3d"+encodeURIComponent(u[C])}return t},_flippingAxisForWkids:[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,
5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,
3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],
[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]]});a.setObject("layers.WMTSLayer",m,r);return m})},"esri/layers/WMTSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.layers.WMTSLayerInfo",identifier:null,tileMatrixSet:null,format:null,style:null,tileInfo:null,title:null,fullExtent:null,initialExtent:null,description:null,dimension:null,constructor:function(z){z&&(this.title=z.title,this.tileMatrixSet=
z.tileMatrixSet,this.format=z.format,this.style=z.style,this.tileInfo=z.tileInfo,this.fullExtent=z.fullExtent,this.initialExtent=z.initialExtent,this.identifier=z.identifier,this.description=z.description,this.dimension=z.dimension)}});m.setObject("layers.WMTSLayerInfo",F,D);return F})},"dojo/debounce":function(){define([],function(){return function(F,m){var a;return function(){a&&clearTimeout(a);var D=this,z=arguments;a=setTimeout(function(){F.apply(D,z)},m)}}})},"esri/virtualearth/VEGeocoder":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/has ../kernel ../urlUtils ../tasks/Task ./VEGeocodeResult ../deferredUtils ../request".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d){F=F(q,{declaredClass:"esri.virtualearth.VEGeocoder",constructor:function(e){try{if(e=m.mixin({bingMapsKey:null},e||{}),this.url=r.getProtocolForWebResource()+"//serverapi.arcgisonline.com/veadaptor/production/services/geocode/geocode",this._url=r.urlToObject(this.url),this._queue=[],this.bingMapsKey=e.bingMapsKey,this.culture=e.culture||"en-US",this._errorHandler=m.hitch(this,this._errorHandler),this._addressToLocationsHandler=m.hitch(this,this._addressToLocationsHandler),
!this.bingMapsKey)throw Error("BingMapsKey must be provided.");}catch(b){throw this.onError(b),b;}},addressToLocations:function(e,b,c){if(this.bingMapsKey){var h=m.mixin({},this._url.query,{query:e,token:this.bingMapsKey,culture:this.culture}),g=this._addressToLocationsHandler,k=this._errorHandler,w=new D(f._dfdCanceller);w._pendingDfd=d({url:this._url.path,content:h,callbackParamName:"callback",load:function(t,C){g(t,C,b,c,w)},error:function(t){k(t,c,w)}});return w}this._queue.push(arguments)},_addressToLocationsHandler:function(e,
b,c,h,g){try{a.forEach(e,function(k,w){e[w]=new n(k)}),this._successHandler([e],"onAddressToLocationsComplete",c,g)}catch(k){this._errorHandler(k,h,g)}},onAddressToLocationsComplete:function(){},setBingMapsKey:function(e){this.bingMapsKey=e},setCulture:function(e){this.culture=e}});m.setObject("virtualearth.VEGeocoder",F,y);return F})},"esri/virtualearth/VEGeocodeResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/Point ../geometry/Extent ./VEAddress".split(" "),
function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.virtualearth.VEGeocodeResult",constructor:function(q){m.mixin(this,{address:null,bestView:null,calculationMethod:null,confidence:null,displayName:null,entityType:null,location:null,matchCodes:null},q);this.address&&(this.address=new r(this.address));this.bestView&&(this.bestView=new y(this.bestView));this.locationArray&&(this.calculationMethod=this.locationArray[0].calculationMethod,this.location=new z(this.locationArray[0]))}});m.setObject("virtualearth.VEGeocodeResult",
F,D);return F})},"esri/virtualearth/VEAddress":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.virtualearth.VEAddress",constructor:function(z){m.mixin(this,{addressLine:null,adminDistrict:null,countryRegion:null,district:null,formattedAddress:null,locality:null,postalCode:null,postalTown:null},z)}});m.setObject("virtualearth.VEAddress",F,D);return F})},"esri/virtualearth/VETiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/_base/config dojo/has dojo/string dojo/_base/Deferred ../kernel ../urlUtils ../SpatialReference ../layers/TileInfo ../layers/TiledMapServiceLayer ../geometry/Extent ../request".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h){F=F(b,{declaredClass:"esri.virtualearth.VETiledLayer",constructor:function(g){try{if(g=m.mixin({bingMapsKey:null,culture:"en-US"},g||{}),this.url=f.getProtocolForWebResource()+"//dev.virtualearth.net/REST/v1",this._url=f.urlToObject(this.url),this.spatialReference=new d({wkid:102100}),this.tileInfo=new e({rows:256,cols:256,dpi:96,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},
{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,
scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,
scale:1128.497176},{level:20,resolution:.1492910708238085,scale:564.248588}]}),this.initialExtent=this.fullExtent=new c(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new d({wkid:102100})),m.mixin(this,g),this.hasAttributionData=this.showAttribution,this._initLayer=m.hitch(this,this._initLayer),this._errorHandler=m.hitch(this,this._errorHandler),this._getTileInfo=m.hitch(this,this._getTileInfo),this.bingMapsKey)this._getTileInfo();else throw Error("BingMapsKey must be provided.");
}catch(k){throw this.onError(k),k;}},_unsetMap:function(g,k){this.inherited("_unsetMap",arguments)},_getTileInfo:function(){if(this.mapStyle){var g=this._url.path+"/Imagery/Metadata/"+this.mapStyle,k=window.location.protocol;if(this.bingMapsKey){var w=this.resourceInfo;!this.loaded&&w?this._initLayer(w):h({url:g,content:m.mixin({},{uriScheme:"https:"===k?"https":"http",key:this.bingMapsKey,ss:!0,c:this.culture,include:this.hasAttributionData?"imageryProviders":null}),callbackParamName:"jsonp",load:this._initLayer,
error:this._errorHandler})}}},_initLayer:function(g,k){if(200!==g.statusCode){var w=Error();w.code=g.statusCode;w.message=g.statusDescription;w.details=g.errorDetails;w.authenticationResultCode=g.authenticationResultCode;this.onError(w)}else try{this.resourceInfo=a.toJson(g);w=g.resourceSets[0].resources[0];var t=w.imageUrl.replace("{","${");this.tileServers=D.map(w.imageUrlSubdomains,function(u){var x=f.getProtocolForWebResource();return r.substitute(t,{subdomain:u}).replace("http:",x)});this._tsLength=
this.tileServers.length;if(this.loaded)this.refresh(),this.onMapStyleChange();else{this.copyright=this.copyright||"\x26copy; 2017 Microsoft Corporation and its data suppliers";this.loaded=!0;this.onLoad(this);var C=this.loadCallback;C&&(delete this.loadCallback,C(this))}}catch(u){this.onError(u)}},getAttributionData:function(){var g=new q,k=a.fromJson(this.resourceInfo),w;this.hasAttributionData&&k&&(w=m.getObject("resourceSets.0.resources.0.imageryProviders",!1,k));w?g.callback({contributors:w}):
(k=Error("Layer does not have attribution data"),k.log=z.isDebug,g.errback(k));return g},getTileUrl:function(g,k,w){return r.substitute(this.tileServers[k%this._tsLength].replace(/\{/g,"${"),{quadkey:this._getQuadKey(g,k,w),culture:this.culture,token:this.bingMapsKey})},_getQuadKey:function(g,k,w){var t="",C;for(C=g;0<C;C--){g="0";var u=1<<C-1;0!=(w&u)&&g++;0!=(k&u)&&(g++,g++);t+=g}return t},setMapStyle:function(g){this.mapStyle=g;this._getTileInfo()},setCulture:function(g){this.culture=g;this._getTileInfo()},
setBingMapsKey:function(g){this.bingMapsKey=g},onMapStyleChange:function(){}});m.mixin(F,{MAP_STYLE_AERIAL:"aerial",MAP_STYLE_AERIAL_WITH_LABELS:"aerialWithLabelsOnDemand",MAP_STYLE_ROAD:"roadOnDemand"});m.setObject("virtualearth.VETiledLayer",F,n);return F})},"esri/dijit/editing/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/DeferredList dojo/dom-class dojo/dom-construct dojo/string dijit/_Widget dijit/_Templated ../../domUtils ../../graphicsUtils ../../geometry/Polyline ../../geometry/Polygon ../../graphic ../../undoManager ../../tasks/query ../../layers/FeatureLayer ../../layers/FeatureTemplate ../../toolbars/draw ../../toolbars/edit ../AttributeInspector ./Util ./Add ./Update ./Delete ./Cut ./Union ./toolbars/Drawing ./SelectionHelper ./TemplatePicker ../../kernel ../../config dojo/i18n!../../nls/jsapi dojo/text!./templates/Editor.html dijit/ProgressBar dojo/NodeList-dom".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K,ba,T,P,J,N,Z,Y){var qa=F([e,b],{declaredClass:"esri.dijit.editing.Editor",widgetsInTemplate:!0,templateString:Y,onLoad:function(){},constructor:function(V,na){V=V||{};this._settings=V.settings;this._eConnects=[]},startup:function(){this.inherited(arguments);this._setDefaultOptions();this._settings.map.setInfoWindowOnClick(!1);var V=this._settings.layerInfos;this.featureReductionEnabledLayers=[];a.forEach(V,function(ya){ya=ya.featureLayer;
ya.isFeatureReductionEnabled()&&(ya.disableFeatureReduction(),this.featureReductionEnabledLayers.push(ya))},this);if(a.every(V,function(ya){return ya.featureLayer.loaded}))this._initLayers(),this._connectEvents(),this._createWidgets(),this.onLoad(),this.loaded=!0;else{var na=V.length;a.forEach(V,function(ya){ya=ya.featureLayer;if(ya.loaded)na--;else var S=D.connect(ya,"onLoad",this,function(ma){D.disconnect(S);S=null;na--;na||(this._initLayers(),this._connectEvents(),this._createWidgets(),this.onLoad(),
this.loaded=!0)})},this)}this._reset();this._enableMapClickHandler()},stopEditing:function(V){this._updateCurrentFeature(m.hitch(this,function(){this._clearSelection(!1);V&&V()}))},destroy:function(){this._settings.map.setInfoWindowOnClick(!0);this.drawingToolbar&&this.drawingToolbar.destroy();this.attributeInspector&&this.attributeInspector.destroy();this.templatePicker&&this.templatePicker.destroy();this._selectionHelper&&this._selectionHelper.destroy();this._drawToolbar&&this._drawToolbar.deactivate();
this._reset();this._disableMapClickHandler();a.forEach(this._eConnects,D.disconnect);D.disconnect(this._dtConnect);D.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this.editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures&&this._settings.map.infoWindow.clearFeatures();
a.forEach(this.featureReductionEnabledLayers,function(V){V.enableFeatureReduction()});this.inherited(arguments)},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new l(this._settings.map);this._settings.drawToolbar=this._drawToolbar;this.editToolbar=this._settings.editToolbar||new v(this._settings.map,{textSymbolEditorHolder:this.domNode});this._settings.editToolbar=this.editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||!1;this._settings.toolbarOptions=
m.mixin({reshapeVisible:!1,cutVisible:!1,mergeVisible:!1},this._settings.toolbarOptions);this._settings.createOptions=m.mixin({polylineDrawTools:[qa.CREATE_TOOL_POLYLINE],polygonDrawTools:[qa.CREATE_TOOL_POLYGON],editAttributesImmediately:!0},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?
!0:!1;this._datePackage=this._settings.datePackage;var V=N.defaults;this._settings.geometryService=this._settings.geometryService||V.geometryService;V.geometryService=V.geometryService||this._settings.geometryService},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};a.forEach(this._settings.layerInfos,function(V){if(V.featureLayer&&V.featureLayer.loaded){this._settings.layers.push(V.featureLayer);var na=V.featureLayer.id;V.featureLayer.credential&&
(this._settings.userIds[na]=V.featureLayer.credential.userId);V.userId&&(this._settings.userIds[na]=V.userId);var ya=V.featureLayer.getEditCapabilities();this._settings.createOnlyLayer[na]=ya.canCreate&&!ya.canUpdate?!0:!1;this._isTextSymbolPointLayer(V.featureLayer)&&(V.disableAttributeUpdate=!0)}},this)},_reset:function(){this._hideAttributeInspector();this.editToolbar.deactivate();this._editVertices=!0;this._drawingTool=this._activeTemplate=this._activeType=this._currentGraphic=this._layer=null;
this._attributeChanged=!1},_saveFeatureOnClient:function(V){var na=this.templatePicker.getSelected();var ya=na.template?na.featureLayer.renderer.getSymbol(na.template.prototype):na.symbolInfo.symbol;this._tempGraphic=new w(V,ya,null,null);this._tempGraphic.setAttributes(m.mixin({},na.template.prototype.attributes));ya=this._settings.map;ya.graphics.add(this._tempGraphic);V=this._findCenterPoint(V);this._createAttributeInspector();ya.infoWindow.setTitle(na.featureLayer?na.featureLayer.name:Z.widgets.attributeInspector.NLS_title);
this.attributeInspector.showFeature(this._tempGraphic,na.featureLayer);this._showInfoWindow(V,ya.getInfoWindowAnchor(V));if(this._settings.createOnlyLayer[na.featureLayer.id]||this._settings.invalidTemplate)this._infoWindowHideEvent=D.connect(ya.infoWindow,"onHide",this,"_infoWindowHide");D.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();this.drawingToolbar&&this.drawingToolbar.deactivate();this._templatePickerOnSelectionChangeEvent=
D.connect(this.templatePicker,"onSelectionChange",m.hitch(this,"_onCreateFeature"))},_saveAttributesOnClient:function(V,na,ya){this._tempGraphic.attributes[na]="number"===typeof ya&&isNaN(ya)?null:ya},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);D.disconnect(this._infoWindowHideEvent)},_createFeature:function(V,na){this._editClickPoint=this._findCenterPoint(V);V.rings?this._simplify(V,m.hitch(this,function(ya){this._drawingTool!==x.TOOL_AUTO_COMPLETE_POLYGON?
this._applyEdits([{layer:this._layer,adds:[this._createGraphic(ya,na)]}],m.hitch(this,function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],this._oEdits[0].layer)})):this._autoComplete(ya,m.hitch(this,function(S){S&&S.length&&this._applyEdits([{layer:this._layer,adds:a.map(S,m.hitch(this,function(ma){return this._createGraphic(ma,na)}))}],function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],this._oEdits[0].layer)})}))})):
this._applyEdits([{layer:this._layer,adds:[this._createGraphic(V,na)]}],m.hitch(this,function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],this._oEdits[0].layer);this._layer&&this._layer.renderer&&"heatmap"===this._layer.renderer.type&&this._layer.refresh()}))},_chainAttachment:function(V,na){this.attributeInspector&&this.attributeInspector._attachmentEditor&&this.attributeInspector._attachmentEditor._tempUpload&&this.attributeInspector._attachmentEditor._chainAttachment(V,
na)},_updateCurrentFeature:function(V){var na=this._isModified();na?this._updateFeature(na,V):V&&V(!1)},_updateFeature:function(V,na,ya){var S=V.geometry,ma=V.getLayer();ma.hasZ&&!ma.enableZDefaults||ma.hasM&&!ma.allowUpdateWithoutMValues||ya&&!this._isModified()?(ya=new w,ya.setAttributes(V.attributes),this._applyEdits([{layer:V.getLayer(),updates:[ya]}],na)):S.rings?this._simplify(S,m.hitch(this,function(ja){this._applyEdits([{layer:V.getLayer(),updates:[m.mixin(V,{geometry:ja})]}],na)})):this._applyEdits([{layer:V.getLayer(),
updates:[V]}],na)},_deleteFeature:function(V,na){if(this._settings.invalidTemplate&&V===this._tempGraphic)this._settings.map.graphics.remove(this._tempGraphic),this._hideAttributeInspector();else{var ya=[];V?ya.push({layer:V.getLayer(),deletes:[V]}):(ya=a.map(a.filter(this._settings.layers,function(S){return 0<S.getSelectedFeatures().length}),function(S){return{layer:S,deletes:S.getSelectedFeatures()}}))&&ya.length||!this._currentGraphic||ya.push({layer:this._layer,deletes:[this._currentGraphic]});
this._applyEdits(ya,na)}},_stopEditing:function(V,na,ya,S){c.hide(this.progressBar.domNode);this._settings.createOnlyLayer[V.id]||this._undoRedoAdd();if(!0===V._isSelOnly||1===V.mode||6===V.mode){if(na&&na.length){this.templatePicker.clearSelection();var ma=new C;ma.objectIds=[na[0].objectId];this._settings.createOnlyLayer[V.id]||this._settings.invalidTemplate?this._settings.map.graphics.remove(this._tempGraphic):this._selectFeatures([V],ma,m.hitch(this,"_onEditFeature"))}}else(ma=this._selectionHelper.findMapService(this._settings.map,
V))&&ma.refresh(),na&&na.length&&(this.templatePicker.clearSelection(),this._settings.createOnlyLayer[V.id]||this._settings.invalidTemplate?this._settings.map.graphics.remove(this._tempGraphic):B.findFeatures(na,V,m.hitch(this,"_onEditFeature")));S&&S.length&&(this._clearSelection(!0),this._undoRedo&&(ma=this._selectionHelper.findMapService(V,this._settings.map))&&ma.refresh());this._undoRedo&&ya&&ya.length&&((ma=this._selectionHelper.findMapService(V,this._settings.map))&&ma.refresh(),this.attributeInspector.refresh(),
this._undoRedo=!1);this.drawingToolbar&&this.drawingToolbar._updateUI();this._undoRedo=!1;this._settings.invalidTemplate=!1},_undoRedoAdd:function(){this._settings._isApplyEditsCall=!1;if(this._settings.undoManager){var V=this._edits&&this._edits.length?this._edits[0]:null;if(V){var na=V.adds||[],ya=V.updates||[],S=V.deletes||[],ma=V.preUpdates||[];V={featureLayer:V.layer};"CUT"===this._activeTool?na.length&&ya.length&&ma.length&&this.undoManager.add(new L(m.mixin(V,{preUpdatedGraphics:ma,addedGraphics:na,
postUpdatedGraphics:ya}))):"UNION"===this._activeTool?S.length&&ya.length&&ma.length&&this.undoManager.add(new K(m.mixin(V,{preUpdatedGraphics:ma,deletedGraphics:S,postUpdatedGraphics:ya}))):na.length?this.undoManager.add(new E(m.mixin(V,{addedGraphics:na}))):S.length?this.undoManager.add(new I(m.mixin(V,{deletedGraphics:S}))):ya.length&&(this._rollbackGraphic||ma.length)&&this.undoManager.add(new G(m.mixin(V,{preUpdatedGraphics:ma.length?ma:[this._rollbackGraphic],postUpdatedGraphics:ya})));this._rollbackGraphic=
this._edits=null}}},_activateDrawToolbar:function(V){this._layer=V.featureLayer;this._activeType=V.type;this._drawingTool=(this._activeTemplate=V.template)?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,V.featureLayer);D.disconnect(this._dtConnect);var na=this._layer.fields;this._settings.invalidTemplate=!1;if(this._activeTemplate&&this._activeTemplate.prototype){var ya=m.mixin({},this._activeTemplate.prototype.attributes);na=na.filter(function(S){return!1===
S.nullable&&!0===S.editable});this._settings.invalidTemplate=na.some(function(S){S=ya[S.name];return null===S||void 0===S})}this._dtConnect=this._settings.createOnlyLayer[V.featureLayer.id]||this._settings.invalidTemplate?D.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient"):D.connect(this._drawToolbar,"onDrawEnd",this,"_createFeature");this.editToolbar.deactivate();this._disableMapClickHandler();this.drawingToolbar?this.drawingToolbar.activateEditing(this._drawTool,this._layer):this._drawToolbar.activate(this._drawTool)},
_activateEditToolbar:function(V,na){var ya=V.getLayer(),S=ya?ya.geometryType:null,ma=this._isTextSymbolPoint(V),ja=v.MOVE;"esriGeometryPoint"!==S&&!0===this._isNotesFeature(V)?(ja=ja|v.ROTATE|v.SCALE,this._editVertices=!1):"esriGeometryPoint"!==S&&!0===this._editVertices?(ja=ja|v.ROTATE|v.SCALE,this._editVertices=!1):ma?(ja=ja|v.ROTATE|v.SCALE|v.EDIT_TEXT,this._editVertices=!1):(ja|=v.EDIT_VERTICES,this._editVertices=!0);this._attributeChanged=this._isModified();this._rollbackGraphic=new w(V.toJson());
S=ya.getEditCapabilities({feature:V,userId:this._settings.userIds[ya.id]});var X=a.filter(this._settings.layerInfos,function(oa){return oa.featureLayer.layerId===ya.layerId})[0];S.canUpdate&&!X.disableGeometryUpdate&&S.canUpdateGeometry&&(this.editToolbar.activate(ja,V),ma&&(this.editToolbar._textEditor._addTextBox(V),this.editToolbar._textSymbolEditor&&this.editToolbar._textSymbolEditor.hide()));this._settings.map.infoWindow.isShowing||this._updateAttributeDisabled(V)||(ma=na&&na.screenPoint||this._findCenterPoint(V),
this._showInfoWindow(ma,this._settings.map.getInfoWindowAnchor(ma)))},_createGraphic:function(V,na){var ya=new w(V,this._activeType&&this._activeType.symbol||this._layer.defaultSymbol,na);this._activeTemplate||na?ya.attributes=na||m.mixin({},this._activeTemplate.prototype.attributes):(ya.attributes=ya.attributes||[],a.forEach(this._layer.fields,function(S){ya.attributes[S.name]=null},this));return ya},_connectEvents:function(){var V=this._settings.layers;a.forEach(V,function(na){this._connect(na,
"onEditsComplete",m.hitch(this,"_stopEditing",na))},this);a.forEach(V,function(na){this._connect(na,"onBeforeApplyEdits",m.hitch(this,function(){c.show(this.progressBar.domNode);this._settings._isApplyEditsCall=!0}))},this);this._connect(this.editToolbar,"onGraphicClick",m.hitch(this,"_activateEditToolbar"));this._connect(this.editToolbar,"onGraphicFirstMove",m.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onVertexFirstMove",m.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,
"onScaleStart",m.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onRotateStart",m.hitch(this,"_hideAttributeInspector"))},_connect:function(V,na,ya){this._eConnects.push(D.connect(V,na,ya))},_createWidgets:function(){this._selectionHelper=new T(this._settings);this._createTemplatePicker();this._createAttributeInspector();this._createDrawingToolbar();this._createUndoRedoManager()},_createTemplatePicker:function(){if(this._settings.templatePicker)this.templatePicker=this._settings.templatePicker,
c.hide(this.templatePickerDiv);else{var V=a.filter(this._settings.layers,function(na){return na.getEditCapabilities().canCreate});this.templatePicker=new P({"class":"esriTemplatePicker",featureLayers:V,showTooltip:!0,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();this._settings.templatePicker=this.templatePicker}this._templatePickerOnSelectionChangeEvent=D.connect(this.templatePicker,"onSelectionChange",m.hitch(this,
"_onCreateFeature"))},_createAttributeInspector:function(){var V=this._settings.map;this._settings.attributeInspector?(this._customAttributeInspector=!0,this.attributeInspector=this._settings.attributeInspector):(this._customAttributeInspector=!1,this.attributeInspector=new A({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,datePackage:this._datePackage},f.create("div")),this.attributeInspector.startup(),V.infoWindow.setContent(this.attributeInspector.domNode),V.infoWindow.setTitle(Z.widgets.attributeInspector.NLS_title),
V.infoWindow.resize(350,375),z.query(".esriAttributeInspector .atiLayerName").style({display:"none"}));this._connect(this.attributeInspector,"onDelete",m.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",m.hitch(this,function(na){this._updateCurrentFeature(m.hitch(this,function(){this._attributeChanged=!1;this._onEditFeature(na)}))}));this._usePopup&&V.infoWindow._setPagerCallbacks(this.attributeInspector,m.hitch(this.attributeInspector,"previous"),m.hitch(this.attributeInspector,
"next"));this._connect(this.attributeInspector,"onAttributeChange",m.hitch(this,function(na,ya,S){if(this._settings.createOnlyLayer[this._layer.id]||this._settings.invalidTemplate)this._saveAttributesOnClient(na,ya,S);else{var ma=na.getLayer();(ma=a.filter(ma.fields,function(ja){return ja.name===ya})[0])&&""===S&&(S=null);this._rollbackGraphic=new w(m.clone(na.toJson()));this.attributeInspector._rollbackInfo={field:ma,graphic:this._rollbackGraphic};this._currentGraphic.attributes[ya]="number"===typeof S&&
isNaN(S)?null:S;this._currentGraphic.setAttributes(this._currentGraphic.attributes);this._updateFeature(this._currentGraphic,null,!0);this._attributeChanged=!1}}))},_createDrawingToolbar:function(){!0===this._settings.toolbarVisible&&(this.drawingToolbar=new ba({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this.editToolbar,settings:this._settings,onDelete:m.hitch(this,"_deleteFeature"),onApplyEdits:m.hitch(this,"_applyEdits"),onShowAttributeInspector:m.hitch(this,"_onEditFeature")},
this.drawingToolbarDiv))},_createUndoRedoManager:function(){if(this._settings.enableUndoRedo||this._settings.undoManager)this._settings.enableUndoRedo=!0,this.undoManager=this._settings.undoManager,this.undoManager||(this.undoManager=this._settings.undoManager=new t({maxOperations:this._settings.maxUndoRedoOperations})),this._connect(this.undoManager,"onUndoComplete",m.hitch(this,this._updateUndoRedoOperations)),this._connect(this.undoManager,"onRedoComplete",m.hitch(this,this._updateUndoRedoOperations)),
this._connect(document,"onkeypress",m.hitch(this,function(V){if(V.metaKey||V.ctrlKey)"z"===V.charOrCode&&this._undo(),"y"===V.charOrCode&&this._redo()}))},_updateUndoRedoOperations:function(V){if(V&&V.addedIds){var na;for(na=0;na<this.undoManager.length;na++){var ya=this.undoManager.get(na);ya&&V.layer===ya._featureLayer&&ya.updateObjectIds(V.oldIds,V.addedIds)}}V&&"Update Features"===V.operation.label&&this.attributeInspector.refresh()},_enableMapClickHandler:function(){this._mapClickHandler=D.connect(this._settings.map,
"onClick",m.hitch(this,function(V){this._drawToolbar._geometryType||("SELECT"===this._activeTool?this._activeTool="":this._updateCurrentFeature(m.hitch(this,function(){this._reset();this._updateSelection(V)})))}))},_disableMapClickHandler:function(){D.disconnect(this._mapClickHandler)},_onCreateFeature:function(){var V=this.templatePicker.getSelected();V?this._updateCurrentFeature(m.hitch(this,function(){this._currentGraphic&&this._clearSelection(!1);this._reset();this._activateDrawToolbar(V)})):
(this._reset(),D.disconnect(this._dtConnect),this._drawToolbar.deactivate(),this._enableMapClickHandler(),this.drawingToolbar&&this.drawingToolbar.deactivate())},_isTextSymbolPoint:function(V){if("point"===V.geometry.type||"multipoint"===V.geometry.type){var na=V.getLayer(),ya=na.renderer;V=V.symbol||na._getSymbol(V);!V&&(ya.hasVisualVariables("sizeInfo",!1)||ya.hasVisualVariables("colorInfo",!1)||ya.hasVisualVariables("opacityInfo",!1))&&ya.addBreak&&ya.infos&&1===ya.infos.length&&(V=ya.infos[0].symbol||
ya.defaultSymbol);if(V&&"textsymbol"===V.type)return!0}return!1},_isTextSymbolPointLayer:function(V){return"esriGeometryPoint"===V.geometryType&&V.renderer&&V.renderer._symbols&&V.renderer._symbols[0]&&V.renderer._symbols[0].symbol&&"textsymbol"===V.renderer._symbols[0].symbol.type?!0:!1},_updateAttributeDisabled:function(V){V=V.getLayer();if(!V)return!1;var na,ya=!1;for(na=0;na<this._settings.layerInfos.length;na++){var S=this._settings.layerInfos[na];if(S.featureLayer==V){ya=S.disableAttributeUpdate;
break}}return ya},_onEditFeature:function(V,na){if(V=(m.isArray(V)?V[0]:V)||null){this._layer=V.getLayer();if(!this._customAttributeInspector&&!this._updateAttributeDisabled(V)){na=na||this._editClickPoint||this._findCenterPoint(V);if(1<this._currentFeatureCount){var ya=this._popupFeatures.indexOf(V);ya=d.substitute(Z.widgets.popup.NLS_pagingInfo,{index:ya+1,total:this._currentFeatureCount})}else ya=this._layer?this._layer.name:Z.widgets.attributeInspector.NLS_title;this._settings.map.infoWindow.setTitle(ya);
if(this.drawingToolbar||!this._settings.map.infoWindow.isShowing)this.attributeInspector.refresh(),this._showInfoWindow(na,this._settings.map.getInfoWindowAnchor(na));this._editClickPoint=null}V!==this._currentGraphic&&(this._editVertices=!0,this._currentGraphic=V,V.getDojoShape()&&V.getDojoShape().moveToFront(),ya=this._layer.hasM,this._layer.hasZ&&!this._layer.enableZDefaults||ya&&!this._layer.allowUpdateWithoutMValues||this._activateEditToolbar(V))}},_applyEdits:function(V,na){V=V||[];if(!(0>=
V.length)){this._edits=this._oEdits=V;var ya=[];a.forEach(V,function(S){S.layer&&ya.push(S.layer.applyEdits(S.adds,S.updates,S.deletes))});0<ya.length&&(this._deferredsList=(new q(ya)).addCallback(m.hitch(this,function(){c.hide(this.progressBar.domNode);na&&na();var S=this._settings.map;S&&S.infoWindow.reposition&&S.infoWindow.isShowing&&S.infoWindow.reposition()})))}},_undo:function(){this._settings.undoManager&&!this._settings._isApplyEditsCall&&(this.editToolbar.deactivate(),this._undoRedo=!0,
this._settings.undoManager.undo())},_redo:function(){this._settings.undoManager&&!this._settings._isApplyEditsCall&&(this.editToolbar.deactivate(),this._undoRedo=!0,this._settings.undoManager.redo())},_simplify:function(V,na){k.prototype.isSelfIntersecting(V)?this._settings.geometryService.simplify([V],function(ya){var S=ya&&ya.length?ya[0]:S;na&&na(S)}):na&&na(V)},_autoComplete:function(V,na){var ya=this._getLayers("esriGeometryPolygon"),S=new C;S.geometry=V;S.returnGeometry=!0;this._selectFeatures(ya,
S,m.hitch(this,function(ma){!ma||0>=ma.length?na&&na([V]):this._settings.geometryService.autoComplete(h.getGeometries(ma),this._toPolylines([S.geometry]),function(ja){na&&na(ja)})}))},_getLayers:function(V){return a.filter(this._settings.layers,function(na){return na.geometryType===V})},_selectFeatures:function(V,na,ya,S){this._selectionHelper.selectFeatures(V,na,S||u.SELECTION_NEW,ya)},_updateSelection:function(V){var na=V.mapPoint,ya=V.graphic,S=this._settings.layerInfos,ma;this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,
na,u.SELECTION_NEW,m.hitch(this,function(ja){var X=a.some(ja,m.hitch(this,function(xa){return xa==ya}));if(ya&&!X)if(X=ya.getLayer(),this._isValidLayer(X)){var oa=new C;oa.objectIds=[ya.attributes[X.objectIdField]];this._selectionHelper.selectFeatures([X],oa,u.SELECTION_ADD,m.hitch(this,function(xa){xa&&xa.length&&(xa=xa.concat(ja),ma=B.sortFeaturesById(S,xa),this._updatePopupButtons(ma),this._onEditFeature(ma,na))}))}else ja&&ja.length?(ma=B.sortFeaturesById(S,ja),this._updatePopupButtons(ma),this._onEditFeature(ma,
na)):this._clearSelection();else ja&&ja.length?(ma=B.sortFeaturesById(S,ja),this._updatePopupButtons(ma),this._onEditFeature(ma,na)):this._clearSelection()}));ya&&this._isTextSymbolPoint(ya)&&this._isValidLayer(ya.getLayer())&&this.editToolbar.activate(0|v.MOVE|v.ROTATE|v.SCALE|v.EDIT_TEXT,ya)},_updatePopupButtons:function(V){if(this._usePopup&&V){var na=V.length;a.forEach([this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton],m.hitch(this,function(S){1<
na?n.remove(S,"hidden"):n.add(S,"hidden")}));var ya=1<na?"block":"none";z.query(".esriAttributeInspector .atiLayerName").style({display:ya});this._currentFeatureCount=na;this._popupFeatures=V}else this._currentFeatureCount=this._popupFeatures=null},_clearSelection:function(V){this._currentFeatureCount=0;this._popupFeatures=null;this._selectionHelper.clearSelection(V||!1);this._reset()},_findCenterPoint:function(V){V=V.geometry||V;switch(V.type){case "point":var na=V;break;case "polyline":na=V.getPoint(0,
Math.ceil(V.paths[0].length/2));break;case "polygon":na=V.rings.length-1,na=V.getPoint(na,V.rings[na].length-1)}return this._settings.map.toScreen(na)},_hideAttributeInspector:function(){!this._customAttributeInspector&&this._settings.map.infoWindow&&this._settings.map.infoWindow.hide()},_toPolylines:function(V){return a.map(V,function(na){var ya=new g(na.spatialReference);a.forEach(na.rings,function(S){ya.addPath(S)});return ya})},_isNotesFeature:function(V){var na=V.getLayer(),ya=na?na.types||null:
null;if(!ya)return!1;var S=V.attributes[na.typeIdField],ma;a.some(ya,function(ja){return ja.id===S?(ma=ja.templates,!0):!1});return ma?(V=ma[0]||null)?this._isShapeTool(V.drawingTool)?!0:!1:!1:!1},_isValidLayer:function(V){var na,ya=this._settings.layerInfos;for(na=0;na<ya.length;na++){var S=ya[na];if(V.id==(S.featureLayer?S.featureLayer.id:S.layerId))return!0}return!1},_isShapeTool:function(V){switch(V){case x.TOOL_ARROW:return l.ARROW;case x.TOOL_LEFT_ARROW:return l.LEFT_ARROW;case x.TOOL_RIGHT_ARROW:return l.RIGHT_ARROW;
case x.TOOL_UP_ARROW:return l.UP_ARROW;case x.TOOL_DOWN_ARROW:return l.DOWN_ARROW;case x.TOOL_CIRCLE:return l.CIRCLE;case x.TOOL_ELLIPSE:return l.ELLIPSE;case x.TOOL_TRIANGLE:return l.TRIANGLE;case x.TOOL_RECTANGLE:return l.RECTANGLE;default:return null}},_toDrawTool:function(V,na){var ya=na.geometryType;switch(V){case x.TOOL_POINT:return l.POINT;case x.TOOL_ARROW:return l.ARROW;case x.TOOL_LEFT_ARROW:return l.LEFT_ARROW;case x.TOOL_RIGHT_ARROW:return l.RIGHT_ARROW;case x.TOOL_UP_ARROW:return l.UP_ARROW;
case x.TOOL_DOWN_ARROW:return l.DOWN_ARROW;case x.TOOL_CIRCLE:return l.CIRCLE;case x.TOOL_ELLIPSE:return l.ELLIPSE;case x.TOOL_TRIANGLE:return l.TRIANGLE;case x.TOOL_RECTANGLE:return l.RECTANGLE;case x.TOOL_LINE:return l.POLYLINE;case x.TOOL_POLYGON:return l.POLYGON;case x.TOOL_FREEHAND:return"esriGeometryPolyline"===ya?l.FREEHAND_POLYLINE:l.FREEHAND_POLYGON;default:var S=l.POINT;"esriGeometryPolyline"===ya?(S=l.POLYLINE,this._settings.createOptions.polylineDrawTools[0]===qa.CREATE_TOOL_FREEHAND_POLYLINE&&
(S=l.FREEHAND_POLYLINE)):"esriGeometryPolygon"===ya&&(S=l.POLYGON,this._settings.createOptions.polygonDrawTools[0]===qa.CREATE_TOOL_FREEHAND_POLYGON&&(S=l.FREEHAND_POLYGON));return S}},_isModified:function(){var V=this.editToolbar.getCurrentState();return(V.isModified||this._attributeChanged)&&V.graphic?V.graphic:null},_showInfoWindow:function(V,na){this._customAttributeInspector||this._settings.map.infoWindow.show(V,na)}});m.mixin(qa,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",
CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"});m.setObject("dijit.editing.Editor",qa,J);return qa})},"esri/undoManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/when ./kernel ./Evented ./OperationBase".split(" "),
function(F,m,a,D,z,y){F=F([y],{declaredClass:"esri.UndoManager",maxOperations:10,canUndo:!1,canRedo:!1,position:0,length:0,onUndo:function(){},onRedo:function(){},onUndoComplete:function(){},onRedoComplete:function(){},onAdd:function(){},onChange:function(){},constructor:function(r){r=r||{};r.maxOperations&&(this.maxOperations=r.maxOperations);this._historyStack=[]},add:function(r){if(0<this.maxOperations)for(;this._historyStack.length>=this.maxOperations;)this._historyStack.shift();this._historyStack.splice(this.position,
0,r);this.position++;this.clearRedo();this.onAdd();this._checkAvailability()},undo:function(){if(0===this.position)return null;var r=this.peekUndo();this.position--;r?(r=r.performUndo(),this.onUndo(),this._checkAvailability(),D(r).then(m.hitch(this,this.onUndoComplete))):(this.onUndo(),this._checkAvailability())},redo:function(){if(this.position===this._historyStack.length)return null;var r=this.peekRedo();this.position++;r?(r=r.performRedo(),this.onRedo(),this._checkAvailability(),D(r).then(m.hitch(this,
this.onRedoComplete))):(this.onRedo(),this._checkAvailability())},_checkAvailability:function(){this.length=this._historyStack.length;0===this.length?this.canUndo=this.canRedo=!1:0===this.position?(this.canRedo=!0,this.canUndo=!1):this.position===this.length?(this.canUndo=!0,this.canRedo=!1):this.canRedo=this.canUndo=!0;this.onChange()},clearUndo:function(){this._historyStack.splice(0,this.position);this.position=0;this._checkAvailability()},clearRedo:function(){this._historyStack.splice(this.position,
this._historyStack.length-this.position);this.position=this._historyStack.length;this._checkAvailability()},peekUndo:function(){if(0<this._historyStack.length&&0<this.position)return this.get(this.position-1)},peekRedo:function(){if(0<this._historyStack.length&&this.position<this._historyStack.length)return this.get(this.position)},get:function(r){return this._historyStack[r]},remove:function(r){0<this._historyStack.length&&(this._historyStack.splice(r,1),0<this.position&&r<this.position&&this.position--,
this._checkAvailability())},destroy:function(){this._historyStack=null}});return z.UndoManager=F})},"esri/OperationBase":function(){define(["dojo/_base/declare","dojo/has","./kernel"],function(F,m,a){F=F(null,{declaredClass:"esri.OperationBase",type:"not implemented",label:"not implemented",constructor:function(D){D=D||{};D.label&&(this.label=D.label)},performUndo:function(){},performRedo:function(){}});return a.OperationBase=F})},"esri/toolbars/edit":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/has dojo/dom-construct dojo/dom-style ../kernel ../lang ../sniff ./_toolbar ./_Box ./_GraphicMover ./_VertexEditor ./TextEditor ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/TextSymbol ../graphic".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u){var x=m(b,{declaredClass:"esri.toolbars.Edit",constructor:function(l,v){this._map=l;this._tool=0;if(this._map.loaded)this._scratchGL=l.graphics;else var A=D.connect(this._map,"onLoad",this,function(){D.disconnect(A);A=null;this._scratchGL=this._map.graphics});var B=r("esri-mobile");this._defaultOptions=a.mixin({vertexSymbol:new w(w.STYLE_CIRCLE,B?20:12,new t(t.STYLE_SOLID,new y([0,0,0,.5]),1),new y([128,128,128])),ghostVertexSymbol:new w(w.STYLE_CIRCLE,
B?18:10,new t(t.STYLE_SOLID,new y([0,0,0,.5]),1),new y([255,255,255,.75])),ghostLineSymbol:new t(t.STYLE_DOT,new y([128,128,128]),2),allowDeleteVertices:!0,allowAddVertices:!0,rotateHandleOffset:B?24:16,boxLineSymbol:new t(t.STYLE_DASH,new y([64,64,64]),1),boxHandleSymbol:new w(w.STYLE_SQUARE,B?16:9,new t(t.STYLE_SOLID,new y([0,0,0,.5]),1),new y([255,255,255,.75])),textAnchorSymbol:new w(w.STYLE_CIRCLE,10,null,new y([255,0,0]))},v||{})},activate:function(l,v,A){this.deactivate();this._graphic=v;this._options=
a.mixin(a.mixin({},this._defaultOptions),A||{});var B=x.MOVE;A=x.EDIT_VERTICES;var E=x.SCALE,G=x.ROTATE,I=x.EDIT_TEXT,L=!1,K=!1,ba=!1,T=this._map,P=T.spatialReference,J=v.geometry.spatialReference;this._geo=!(!P||!J||P.equals(J)||!P.isWebMercator()||4326!==J.wkid);this._isTextPoint=this._prepareTextSymbolEditing(v,l);(l&B)===B&&(L=this._enableMove(v));B=(l&E)===E;G=(l&G)===G;if(B||G)ba=this._enableBoxEditing(v,B,G);(l&A)===A&&(K=this._enableVertexEditing(v));(l&I)===I&&this._enableTextEditing(v);
if(!(L||K||ba))throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");if(this._tool=l)this._mapPanEndHandle=D.connect(T,"onPanEnd",this,this._mapPanEndHandler),this._mapExtChgHandle=D.connect(T,"onExtentChange",this,this._mapExtentChangeHandler),this.onActivate(this._tool,v);T.snappingManager&&(L||K)&&T.snappingManager._startSelectionLayerQuery()},deactivate:function(){this._isTextPoint=null;var l=this._tool,v=this._graphic;
if(l){var A=!!this._modified;this._clear();D.disconnect(this._mapPanEndHandle);D.disconnect(this._mapExtChgHandle);this._graphic=this._geo=this._mapPanEndHandle=this._mapExtChgHandle=null;this.onDeactivate(l,v,{isModified:A});this._map.snappingManager&&this._map.snappingManager._stopSelectionLayerQuery()}},refresh:function(){this._refreshMoveables(!0)},getCurrentState:function(){return{tool:this._tool,graphic:this._graphic,isModified:!!this._modified}},onActivate:function(l,v){},onDeactivate:function(l,
v,A){},onGraphicMoveStart:function(l){},onGraphicFirstMove:function(l){this._modified=!0},onGraphicMove:function(l,v){},onGraphicMoveStop:function(l,v){},onGraphicClick:function(l,v){},onVertexMoveStart:function(l,v){},onVertexFirstMove:function(l,v){this._modified=!0},onVertexMove:function(l,v,A){},onVertexMoveStop:function(l,v,A){},onVertexAdd:function(l,v){this._modified=!0},onVertexClick:function(l,v){},onVertexMouseOver:function(l,v){},onVertexMouseOut:function(l,v){},onVertexDelete:function(l,
v){this._modified=!0},onTextEditStart:function(l,v){},onTextEditEnd:function(l){},onScaleStart:function(l){},onScaleFirstMove:function(l){this._modified=!0},onScale:function(l,v){},onScaleStop:function(l,v){},onRotateStart:function(l){},onRotateFirstMove:function(l){this._modified=!0},onRotate:function(l,v){},onRotateStop:function(l,v){},_eventMap:{activate:["tool","graphic"],deactivate:["tool","graphic","info"],"graphic-move-start":["graphic"],"graphic-first-move":["graphic"],"graphic-move":["graphic",
"transform"],"graphic-move-stop":["graphic","transform"],"graphic-click":["graphic","info"],"vertex-move-start":["graphic","vertexinfo"],"vertex-first-move":["graphic","vertexinfo"],"vertex-move":["graphic","vertexinfo","transform"],"vertex-move-stop":["graphic","vertexinfo","transform"],"vertex-add":["graphic","vertexinfo"],"vertex-click":["graphic","vertexinfo"],"vertex-mouse-over":["graphic","vertexinfo"],"vertex-mouse-out":["graphic","vertexinfo"],"vertex-delete":["graphic","vertexinfo"],"scale-start":["graphic"],
"scale-first-move":["graphic"],scale:["graphic","info"],"scale-stop":["graphic","info"],"rotate-start":["graphic"],"rotate-first-move":["graphic"],rotate:["graphic","info"],"rotate-stop":["graphic","info"]},_prepareTextSymbolEditing:function(l,v){if("point"===l.geometry.type||"multipoint"===l.geometry.type){var A=l.getLayer(),B=A.renderer;A=l.symbol||A._getSymbol(l);!A&&(B.hasVisualVariables("sizeInfo",!1)||B.hasVisualVariables("colorInfo",!1)||B.hasVisualVariables("opacityInfo",!1))&&B.addBreak&&
B.infos&&1===B.infos.length&&(A=B.infos[0].symbol||B.defaultSymbol);if(A&&"textsymbol"===A.type){if((v&x.SCALE)===x.SCALE||(v&x.ROTATE)===x.ROTATE||(v&x.EDIT_TEXT)===x.EDIT_TEXT){l.setSymbol(new C(A.toJson()));var E=this;this._textSymbolEditor?(this._textSymbolEditor.createForm(l),this._textSymbolEditor.show()):this._options&&this._options.textSymbolEditor?(this._textSymbolEditor=this._options.textSymbolEditor,this._textSymbolEditor.on("symbol-change",function(){E._boxEditor&&E._boxEditor.refresh()})):
F(["../dijit/SymbolEditor"],function(G){if(!E._textSymbolEditor){var I=E._options.textSymbolEditorHolder?q.create("div",null,E._options.textSymbolEditorHolder):q.create("div",null,E._map.root);E._textSymbolEditor=new G({graphic:l},I);G=E._textSymbolEditor.domNode.parentNode.id;n.set(E._textSymbolEditor.domNode,{position:"map_root"===G?"absolute":"relative",left:"map_root"===G?E._map.width/2-100+"px":"5px",top:"20px","z-index":50});E._textSymbolEditor.startup();E._textSymbolEditor.createForm(l);E._textSymbolEditor.show();
E._textSymbolEditor.on("symbol-change",function(){E._boxEditor&&E._boxEditor.refresh()})}})}if((v&x.MOVE)===x.MOVE||(v&x.ROTATE)===x.ROTATE||(v&x.SCALE)===x.SCALE)this._textAnchor=new u(l.geometry,this._options.textAnchorSymbol),this._scratchGL.add(this._textAnchor);return!0}}return!1},_enableMove:function(l){var v=this._map;switch(l.geometry.type){case "point":case "polyline":case "polygon":return this._graphicMover=new h(l,v,this,this._textAnchor),!0}return!1},_enableVertexEditing:function(l){var v=
this._map;switch(l.geometry.type){case "multipoint":case "polyline":case "polygon":return this._vertexEditor=g.create(l,v,this),!0}return!1},_enableBoxEditing:function(l,v,A){var B=this._map,E=l.geometry.type;return"polyline"===E||"polygon"===E||this._isTextPoint?(this._boxEditor=new c(l,B,this,v,A,this._options.uniformScaling,this._isTextPoint),!0):!1},_enableTextEditing:function(l){return this._isTextPoint?(this._textEditor=new k(l,this._map,this),D.connect(this._textEditor,"onEditStart",a.hitch(this,
function(){this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._map.disableKeyboardNavigation();this._disableMove();this._disableBoxEditing()})),!0):!1},_disableMove:function(){var l=this._graphicMover;l&&(l.destroy(),this._graphicMover=null)},_disableVertexEditing:function(){var l=this._vertexEditor;l&&(l.destroy(),this._vertexEditor=null)},_disableBoxEditing:function(){var l=this._boxEditor;l&&(l.destroy(),this._boxEditor=null)},_disableTextEditing:function(){this._textEditor&&
(this._textEditor.destroy(),this._textEditor=null);this._map.enableKeyboardNavigation()},_disableSymbolEditing:function(){this._textSymbolEditor&&this._textSymbolEditor.hide()},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._disableTextEditing();this._disableSymbolEditing();this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._tool=0;this._modified=!1},_mapPanEndHandler:function(){this._refreshMoveables()},
_mapExtentChangeHandler:function(l,v,A){A&&this._refreshMoveables()},_refreshMoveables:function(l){var v=z.filter([this._graphicMover,this._vertexEditor,this._boxEditor],d.isDefined);z.forEach(v,function(A){A.refresh(l)})},_beginOperation:function(l){z.forEach(this._getAffectedTools(l),function(v){v.suspend()})},_endOperation:function(l){z.forEach(this._getAffectedTools(l),function(v){v.resume()})},_getAffectedTools:function(l){var v=[];switch(l){case "MOVE":v=[this._vertexEditor,this._boxEditor];
break;case "VERTICES":v=[this._boxEditor];break;case "BOX":v=[this._vertexEditor]}return v=z.filter(v,d.isDefined)}});a.mixin(x,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8,EDIT_TEXT:16});a.setObject("toolbars.Edit",x,f);return x})},"esri/toolbars/_Box":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has dojo/dom-style dojox/gfx/Moveable dojox/gfx/matrix ../kernel ../lang ../geometry/Point ../geometry/Polyline ../symbols/SimpleMarkerSymbol ../geometry/webMercatorUtils ../geometry/jsonUtils ../graphic".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k){F=F(null,{declaredClass:"esri.toolbars._Box",constructor:function(w,t,C,u,x,l,v){this._graphic=w;this._map=t;this._toolbar=C;this._scale=u;this._rotate=x;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=l;w=C._options;this._markerSymbol=w.boxHandleSymbol;this._lineSymbol=w.boxLineSymbol;this._moveStartHandler=m.hitch(this,this._moveStartHandler);this._firstMoveHandler=m.hitch(this,this._firstMoveHandler);
this._moveStopHandler=m.hitch(this,this._moveStopHandler);this._moveHandler=m.hitch(this,this._moveHandler);this._isTextPoint=v;this._init()},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null},refresh:function(){this._draw()},suspend:function(){a.forEach(this._getAllGraphics(),function(w){w.hide()})},resume:function(){a.forEach(this._getAllGraphics(),function(w){w.show()});this._draw()},_init:function(){this._draw()},_cleanUp:function(){this._connects&&
a.forEach(this._connects,D.disconnect);var w=this._toolbar._scratchGL;this._anchors&&a.forEach(this._anchors,function(t){w.remove(t.graphic);(t=t.moveable)&&t.destroy()});this._box&&w.remove(this._box);this._box=this._anchors=this._connects=null},_draw:function(){if(this._graphic.getDojoShape()){var w=this._map,t=this._toolbar._scratchGL,C=this._getBoxCoords(),u=new b(w.spatialReference),x=m.clone(a.filter(C,function(l,v){return 8!==v&&0===v%2}));x[0]&&x.push([x[0][0],x[0][1]]);u.addPath(x);this._rotate&&
u.addPath([C[1],C[8]]);this._box?this._box.setGeometry(u):(this._box=new k(u,this._lineSymbol),t.add(this._box));this._anchors?a.forEach(this._anchors,function(l,v){this._scale||(v=8);var A=new e(C[v],w.spatialReference);l.graphic.setGeometry(A);A=l.moveable;var B=l.graphic.getDojoShape();B&&(A?B!==A.shape&&(A.destroy(),l.moveable=this._getMoveable(l.graphic,v)):l.moveable=this._getMoveable(l.graphic,v))},this):(this._anchors=[],this._connects=[],a.forEach(C,function(l,v){if(this._scale||!(8>v)){l=
new e(l,w.spatialReference);var A=new k(l,this._markerSymbol);this._isTextPoint&&1===v%2&&A.hide();t.add(A);this._anchors.push({graphic:A,moveable:this._getMoveable(A,v)})}},this))}else this._cleanUp()},_getBoxCoords:function(w){var t=this._map,C=[],u,x,l;if(this._isTextPoint){var v=this._graphic.getNode().getBoundingClientRect();var A=t.__container.getBoundingClientRect();v=[{x:v.left-A.left,y:v.top-A.top},{x:v.right-A.left,y:v.top-A.top},{x:v.right-A.left,y:v.bottom-A.top},{x:v.left-A.left,y:v.bottom-
A.top}]}else v=this._getTransformedBoundingBox(this._graphic);a.forEach(v,function(B,E,G){u=B;(x=G[E+1])||(x=G[0]);l={x:(u.x+x.x)/2,y:(u.y+x.y)/2};w||(u=t.toMap(u),l=t.toMap(l));C.push([u.x,u.y]);C.push([l.x,l.y])});this._rotate&&(v=m.clone(C[1]),v=w?{x:v[0],y:v[1]}:t.toScreen({x:v[0],y:v[1],spatialReference:t.spatialReference}),v.y-=this._toolbar._options.rotateHandleOffset,w||(v=t.toMap(v)),C.push([v.x,v.y]));return C},_getTransformedBoundingBox:function(w){var t=this._map,C=w.geometry.getExtent(),
u=w.geometry.spatialReference;w=new e(C.xmin,C.ymax,u);C=new e(C.xmax,C.ymin,u);w=t.toScreen(w);C=t.toScreen(C);return[{x:w.x,y:w.y},{x:C.x,y:w.y},{x:C.x,y:C.y},{x:w.x,y:C.y}]},_getAllGraphics:function(){var w=[this._box];this._anchors&&a.forEach(this._anchors,function(t){w.push(t.graphic)});return w=a.filter(w,d.isDefined)},_getMoveable:function(w,t){var C=w.getDojoShape();if(C){var u=new q(C);u._index=t;this._connects.push(D.connect(u,"onMoveStart",this._moveStartHandler));this._connects.push(D.connect(u,
"onFirstMove",this._firstMoveHandler));this._connects.push(D.connect(u,"onMoveStop",this._moveStopHandler));u.onMove=this._moveHandler;(C=C.getEventSource())&&r.set(C,"cursor",this._toolbar._cursors["box"+t]);return u}},_moveStartHandler:function(w){this._toolbar["on"+(8===w.host._index?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic)},_firstMoveHandler:function(w){this._toolbar._deactivateScrollWheel();var t=w.host._index,C=this._wrapOffset=w.host.shape._wrapOffsets[0]||0,u=this._graphic.getLayer().getNavigationTransform();
w=a.map(this._getBoxCoords(!0),function(l){return{x:l[0]+C,y:l[1]}});var x=this._isTextPoint?this._map.toScreen(this._graphic.geometry):{x:w[1].x,y:w[3].y};this._centerCoord=n.multiplyPoint(n.invert(u),x);if(8===t)x=n.multiplyPoint(n.invert(u),w[1]),this._isTextPoint&&(this._centerCoord=this._deNormalizePoint(this._centerCoord,x)),this._startLine=[this._centerCoord,x],this._moveLine=m.clone(this._startLine);else if(x=n.multiplyPoint(n.invert(u),w[t]),u=n.multiplyPoint(n.invert(u),w[(t+4)%8]),this._isTextPoint&&
(this._centerCoord=this._deNormalizePoint(this._centerCoord,x)),this._firstMoverToAnchor=Math.sqrt((x.x-this._centerCoord.x)*(x.x-this._centerCoord.x)+(x.y-this._centerCoord.y)*(x.y-this._centerCoord.y)),this._startBox=u,this._startBox.width=w[4].x-w[0].x,this._startBox.height=w[4].y-w[0].y,this._moveBox=m.clone(this._startBox),this._xfactor=x.x>u.x?1:-1,this._yfactor=x.y>u.y?1:-1,1===t||5===t)this._xfactor=0;else if(3===t||7===t)this._yfactor=0;this._toolbar._beginOperation("BOX");this._toolbar["on"+
(8===t?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic)},_moveHandler:function(w,t){var C=w.host._index,u=this._defaultEventArgs,x;u.angle=0;u.scaleX=1;u.scaleY=1;if(8===C){var l=this._startLine;var v=this._moveLine;var A=v[1];A.x+=t.dx;A.y+=t.dy;A=this._getAngle(l,v);this._isTextPoint&&(A+=this._graphic.symbol.angle);v=n.rotategAt(A,l[0]);this._graphic.getDojoShape().setTransform(v);u.transform=v;u.angle=A;u.around=l[0]}else{l=this._startBox;v=this._moveBox;v.width+=t.dx*this._xfactor;
v.height+=t.dy*this._yfactor;this._uniformScaling||this._isTextPoint?(l=v.x+this._xfactor*v.width,v=v.y+this._yfactor*v.height,l=Math.sqrt((l-this._centerCoord.x)*(l-this._centerCoord.x)+(v-this._centerCoord.y)*(v-this._centerCoord.y)),this._scaleRatio=A=x=l/this._firstMoverToAnchor,l=this._centerCoord):(A=v.width/l.width,x=v.height/l.height,l={x:l.x,y:l.y});if(isNaN(A)||Infinity===A||-Infinity===A)A=1;if(isNaN(x)||Infinity===x||-Infinity===x)x=1;v=n.scaleAt(A,x,l);if(this._isTextPoint){var B=n.rotategAt(this._graphic.symbol.angle,
l);this._graphic.getDojoShape().setTransform([B,v])}else this._graphic.getDojoShape().setTransform(v);u.transform=v;u.scaleX=A;u.scaleY=x;u.around=l}this._toolbar["on"+(8===C?this._rotateEvent:this._scaleEvent)](this._graphic,u)},_moveStopHandler:function(w){this._toolbar._activateScrollWheel();var t=this._graphic,C=this._toolbar,u=C._geo?h.geographicToWebMercator(t.geometry):t.geometry,x=u.spatialReference,l=t.getDojoShape(),v=l.getTransform(),A=t.getLayer().getNavigationTransform();this._isTextPoint?
(t=this._graphic.symbol,8===w.host._index?t.angle+=this._getAngle(this._startLine,this._moveLine):t.font.setSize(Math.round(t.font.size*this._scaleRatio*100)/100),this._graphic.setSymbol(t)):(u=u.toJson(),this._updateSegments(u.paths||u.rings,v,A,x),l.setTransform(null),u=g.fromJson(u),t.setGeometry(C._geo?h.webMercatorToGeographic(u,!0):u));this._draw();this._startLine=this._moveLine=this._startBox=this._moveBox=this._xfactor=this._yfactor=null;C._endOperation("BOX");this._defaultEventArgs.transform=
v;C["on"+(8===w.host._index?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs)},_updateSegments:function(w,t,C,u){var x=this._map,l=this._wrapOffset||0;a.forEach(w,function(v){a.forEach(v,function(A){this._updatePoint(A,u,l,n,x,C,t)},this)},this)},_updatePoint:function(w,t,C,u,x,l,v){t=x.toScreen({x:w[0],y:w[1],spatialReference:t},!0);t.x+=C;t=u.multiplyPoint([l,v,u.invert(l)],t);t.x-=C;C=x.toMap(t);w[0]=C.x;w[1]=C.y},_getAngle:function(w,t){return 180*Math.atan2(t[0].y-
t[1].y,t[0].x-t[1].x)/Math.PI-180*Math.atan2(w[0].y-w[1].y,w[0].x-w[1].x)/Math.PI},_deNormalizePoint:function(w,t){var C=this._map._getFrameWidth();if(-1===C)return w;for(var u={x:w.x,y:w.y};Math.abs(u.x-t.x)>=C;)u.x=u.x<t.x?u.x+C:u.x-C;var x=Math.abs(u.x-t.x);Math.abs(u.x-t.x+C)<x?u.x+=C:Math.abs(u.x-t.x-C)<x&&(u.x-=C);return u}});m.setObject("toolbars._Box",F,f);return F})},"dojox/gfx/Moveable":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/_base/event dojo/topic dojo/touch dojo/dom-class dojo/_base/window ./Mover dojo/mouse".split(" "),
function(F,m,a,D,z,y,r,q,n,f){return m("dojox.gfx.Moveable",null,{constructor:function(d,e){this.shape=d;this.delay=e&&0<e.delay?e.delay:0;this.mover=e&&e.mover?e.mover:n;this.leftButtonOnly=e&&e.leftButtonOnly;this.events=[this.shape.on(y.press,F.hitch(this,"onMouseDown"))]},destroy:function(){a.forEach(this.events,function(d){d.remove()});this.events=this.shape=null},onMouseDown:function(d){this.delay?(this.events.push(this.shape.on(y.move,F.hitch(this,"onMouseMove")),this.shape.on(y.release,F.hitch(this,
"onMouseUp"))),this._lastX=d.clientX,this._lastY=d.clientY):this.leftButtonOnly&&!f.isLeft(d)||new this.mover(this.shape,d,this);D.stop(d)},onMouseMove:function(d){var e=d.clientY;if(Math.abs(d.clientX-this._lastX)>this.delay||Math.abs(e-this._lastY)>this.delay)this.onMouseUp(d),new this.mover(this.shape,d,this);D.stop(d)},onMouseUp:function(d){this.events.pop().remove()},onMoveStart:function(d){z.publish("/gfx/move/start",d);r.add(q.body(),"dojoMove")},onMoveStop:function(d){z.publish("/gfx/move/stop",
d);r.remove(q.body(),"dojoMove")},onFirstMove:function(d){},onMove:function(d,e,b){this.onMoving(d,e,b);this.shape.applyLeftTransform(e);this.onMoved(d,e)},onMoving:function(d,e){},onMoved:function(d,e){}})})},"dojox/gfx/Mover":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/on dojo/touch dojo/_base/event".split(" "),function(F,m,a,D,z,y){return a("dojox.gfx.Mover",null,{constructor:function(r,q,n){this.shape=r;this.lastX=q.clientX;this.lastY=q.clientY;r=this.host=n;q=
document;n=D(q,z.move,F.hitch(this,"onFirstMove"));this.events=[D(q,z.move,F.hitch(this,"onMouseMove")),D(q,z.release,F.hitch(this,"destroy")),D(q,"dragstart",F.hitch(y,"stop")),D(q,"selectstart",F.hitch(y,"stop")),n];if(r&&r.onMoveStart)r.onMoveStart(this)},onMouseMove:function(r){var q=r.clientX,n=r.clientY;this.host.onMove(this,{dx:q-this.lastX,dy:n-this.lastY},r);this.lastX=q;this.lastY=n;y.stop(r)},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove()},destroy:function(){m.forEach(this.events,
function(q){q.remove()});var r=this.host;if(r&&r.onMoveStop)r.onMoveStop(this);this.events=this.shape=null}})})},"esri/toolbars/_GraphicMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/dom-style dojox/gfx/Moveable dojox/gfx/Mover dojox/gfx/matrix ../kernel ../PointerEvents ../sniff ../geometry/webMercatorUtils ../geometry/ScreenPoint ../geometry/Point".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c){var h=F(null,{declaredClass:"esri.toolbars._GraphicMover",
constructor:function(g,k,w,t){this.graphic=g;this.map=k;this.toolbar=w;this.tempPt=t;this._enableGraphicMover();this._moved=!1},refresh:function(g){var k=this.graphic.getDojoShape();!k||!g&&k._hostGraphic||(this._disableGraphicMover(),this._enableGraphicMover())},destroy:function(){this._disableGraphicMover()},hasMoved:function(){return this._moved},_enableGraphicMover:function(){var g=this.graphic,k=g.getDojoShape();k&&(k._hostGraphic=g,this._moveable=new y(k,{mover:h.Mover}),this._moveStartHandle=
a.connect(this._moveable,"onMoveStart",this,this._moveStartHandler),this._firstMoveHandle=a.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler),this._movingHandle=a.connect(this._moveable,"onMoving",this,this._movingHandler),this._moveStopHandle=a.connect(this._moveable,"onMoveStop",this,this._moveStopHandler),(g=k.getEventSource())&&z.set(g,"cursor",this.toolbar._cursors.move))},_disableGraphicMover:function(){var g=this._moveable;if(g){a.disconnect(this._moveStartHandle);a.disconnect(this._firstMoveHandle);
a.disconnect(this._movingHandle);a.disconnect(this._moveStopHandle);var k=g.shape;k&&(k._hostGraphic=null,(k=k.getEventSource())&&z.set(k,"cursor","inherit"));g.destroy()}this._moveable=null},_moveStartHandler:function(){var g=this.graphic,k=this.map;this._startTx=g.getDojoShape().getTransform();"point"===this.graphic.geometry.type&&k.snappingManager&&k.snappingManager._setUpSnapping();this.toolbar.onGraphicMoveStart(g)},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic)},
_movingHandler:function(g,k,w){g=g.shape.getTransform();k=this.map;var t;d("esri-pointer")?t=k.navigationManager.pointerEvents._processTouchEvent(w,w):w&&"pointermove"===w.type&&(t=f.prototype._processTouchEvent.call({map:k},w,w));t&&k.snappingManager&&k.snappingManager._onSnappingMouseMoveHandler(t);this.tempPt&&this.tempPt.getDojoShape().setTransform(g);this.toolbar.onGraphicMove(this.graphic,g)},_moveStopHandler:function(g){var k=this.graphic,w=this.toolbar,t=this.map,C=w._geo?e.geographicToWebMercator(k.geometry):
k.geometry,u=C.type,x=k.getDojoShape(),l=x.getTransform();if(D.toJson(l)!==D.toJson(this._startTx)){this._moved=!0;switch(u){case "point":u=[l,q.invert(this._startTx)];if(t.snappingManager)var v=t.snappingManager._snappingPoint;C=v||t.toMap(q.multiplyPoint(u,t.toScreen(C,!0)));t.snappingManager&&t.snappingManager._killOffSnapping();break;case "polyline":C=this._updatePolyGeometry(C,C.paths,l);break;case "polygon":C=this._updatePolyGeometry(C,C.rings,l)}x.setTransform(null);k.setGeometry(w._geo?e.webMercatorToGeographic(C,
!0):C);this.tempPt&&this.tempPt.setGeometry(new c(k.geometry.toJson()))}else this._moved=!1;w._endOperation("MOVE");w.onGraphicMoveStop(k,l);this._moved||(g=g.__e,t=this.map.position,g=new b(g.pageX-t.x,g.pageY-t.y),w.onGraphicClick(k,{screenPoint:g,mapPoint:this.map.toMap(g)}))},_updatePolyGeometry:function(g,k,w){var t=this.map,C=g.getPoint(0,0);t=t.toMap(t.toScreen(C).offset(w.dx,w.dy));w=t.x-C.x;C=t.y-C.y;var u;for(t=0;t<k.length;t++){var x=k[t];for(u=0;u<x.length;u++){var l=g.getPoint(t,u);g.setPoint(t,
u,l.offset(w,C))}}return g}});h.Mover=F(r,{declaredClass:"esri.toolbars._Mover",constructor:function(g,k,w){this.__e=k}});m.setObject("toolbars._GraphicMover",h,n);m.setObject("toolbars._Mover",h.Mover,n);return h})},"esri/toolbars/_VertexEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dijit/Menu dijit/MenuItem ../kernel ./_VertexMover ../geometry/Point ../geometry/jsonUtils dojo/i18n!../nls/jsapi".split(" "),function(F,m,a,D,z,y,r,q,n,f,
d,e){var b=F(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(c,h,g){this.graphic=c;this.map=h;this.toolbar=g;c=g._options;this._symbol1=c.vertexSymbol;this._symbol2=c.ghostVertexSymbol;h=c.ghostLineSymbol;this._lineStroke={style:h.style,width:h.width,color:h.color};this._canDel=c.allowDeleteVertices;this._canAdd=c.allowAddVertices;this._addControllers()},destroy:function(){this._removeControllers()},refresh:function(c){c?(this._removeControllers(),this._addControllers()):
(this._refresh(this._vertexMovers),this._refresh(this._mpVertexMovers))},suspend:function(){this._suspended||this._removeControllers();this._suspended=!0},resume:function(){this._suspended&&this._addControllers();this._suspended=!1},_addControllers:function(){this._firstMoveHandle=a.connect(n,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=a.connect(n,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);this._canAdd&&
(this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,!0));var c=this._getGraphicsLayer();this._mouseOverHandle=a.connect(c,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=a.connect(c,"onMouseOut",this,this._mouseOutHandler);this._canDel&&(this._ctxMenu=new y({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"}),c=this._ctxDelete=new r({label:e.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}),this._deleteHandle=
a.connect(c,"onClick",this,this._deleteHandler),this._ctxMenu.addChild(c),this._ctxMenu.startup())},_removeControllers:function(){a.disconnect(this._firstMoveHandle);a.disconnect(this._moveStopHandle);a.disconnect(this._mouseOverHandle);a.disconnect(this._mouseOutHandle);a.disconnect(this._deleteHandle);this._ctxMenu&&(this._ctxDelete=null,this._unbindCtxNode(),this._ctxMenu.destroyRecursive());this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=
null},_add:function(c,h,g){var k,w,t=this.graphic,C=[];for(k=0;k<c.length;k++){var u=c[k],x=[];for(w=0;w<u.length;w++)x.push(new n(u[w],h,t,k,w,u.length,this,g));C.push(x)}return C},_remove:function(c){c&&D.forEach(c,function(h){D.forEach(h,function(g){g.destroy()})})},_refresh:function(c){c&&D.forEach(c,function(h){D.forEach(h,function(g){g.refresh()})})},_isNew:function(c){return-1===D.indexOf(this._vertexMovers[c.segIndex],c)?!0:!1},_getGraphicsLayer:function(){return this.toolbar._scratchGL},
_deleteHandler:function(c){c=this._selectedMover;this._updateRelatedGraphic(c,c.relatedGraphic,c.graphic.geometry,c.segIndex,c.ptIndex,c.segLength,!1,!0);this._canAdd&&this._deleteMidpoints(c);this._deleteVertex(c);this.toolbar._endOperation("VERTICES")},_mouseOverHandler:function(c){c=c.graphic;var h=this._findMover(c);h&&(this.toolbar.onVertexMouseOver(this.graphic,h._getInfo()),h._placeholder||(this._selectedMover=h,this._canDel&&this._bindCtxNode(c.getDojoShape().getNode())))},_mouseOutHandler:function(c){if(c=
this._findMover(c.graphic))this.toolbar.onVertexMouseOut(this.graphic,c._getInfo())},_bindCtxNode:function(c){this._unbindCtxNode();this._ctxDelete.set("disabled",this._selectedMover.segLength<=this.minLength?!0:!1);this._ctxMenu.bindDomNode(c);this._bindNode=c},_unbindCtxNode:function(){var c=this._bindNode;c&&this._ctxMenu.unBindDomNode(c)},_findMover:function(c){var h=[];var g=this._mpVertexMovers;D.forEach(this._vertexMovers,function(w){h=h.concat(w)});g&&D.forEach(g,function(w){h=h.concat(w)});
for(g=0;g<h.length;g++){var k=h[g];if(k.graphic===c)return k}},_firstMoveHandler:function(c){!this._isNew(c)&&this._canAdd&&this._hideRelatedMidpoints(c);this.toolbar._beginOperation("VERTICES")},_moveStopHandler:function(c,h){var g=this._isNew(c);h&&(h.dx||h.dy)?(this._updateRelatedGraphic(c,c.relatedGraphic,c.graphic.geometry,c.segIndex,c.ptIndex,c.segLength,g),this._canAdd&&(g?this._addMidpoints(c):(this._repositionRelatedMidpoints(c),this._showRelatedMidpoints(c))),this.toolbar._endOperation("VERTICES")):
!g&&this._canAdd&&this._showRelatedMidpoints(c)},_showRelatedMidpoints:function(c){var h=this._getAdjacentMidpoints(c.ptIndex,c.segLength),g=this._mpVertexMovers[c.segIndex];for(c=0;c<h.length;c++){var k=g[h[c]];k.graphic.show();k.refresh()}},_hideRelatedMidpoints:function(c){var h=this._getAdjacentMidpoints(c.ptIndex,c.segLength),g=this._mpVertexMovers[c.segIndex];for(c=0;c<h.length;c++)g[h[c]].graphic.hide()},_repositionRelatedMidpoints:function(c){var h,g=this._getAdjacentMidpoints(c.ptIndex,c.segLength),
k=this._mpVertexMovers[c.segIndex];for(h=0;h<g.length;h++){var w=this._getAdjacentVertices(g[h],c.segLength),t=c.relatedGraphic.geometry.getPoint(c.segIndex,w[0]);w=c.relatedGraphic.geometry.getPoint(c.segIndex,w[1]);t=new f({x:(t.x+w.x)/2,y:(t.y+w.y)/2,spatialReference:t.spatialReference.toJson()});k[g[h]].graphic.setGeometry(t)}},_addMidpoints:function(c){var h=c.segIndex,g=c.ptIndex,k=c.segLength,w=g+1,t,C=k+1;this._mpVertexMovers[h].splice(g,1);var u=this._vertexMovers[h];for(t=0;t<w;t++)u[t].segLength+=
1;for(t=w;t<u.length;t++)u[t].ptIndex+=1,u[t].segLength+=1;c.ptIndex=w;c.segLength=u.length+1;u.splice(w,0,c);c.graphic.setSymbol(this._symbol1);u=this._mpVertexMovers[h];for(t=0;t<g;t++)u[t].segLength+=1;for(t=g;t<k-1;t++)u[t].ptIndex+=1,u[t].segLength+=1;w=this._getAdjacentVertices(g,C);h=this._getAdjacentVertices(g+1,C);k=c.relatedGraphic.geometry.getPoint(c.segIndex,w[0]);t=c.relatedGraphic.geometry.getPoint(c.segIndex,w[1]);w=new f({x:(k.x+t.x)/2,y:(k.y+t.y)/2,spatialReference:k.spatialReference.toJson()});
k=c.relatedGraphic.geometry.getPoint(c.segIndex,h[0]);t=c.relatedGraphic.geometry.getPoint(c.segIndex,h[1]);h=new f({x:(k.x+t.x)/2,y:(k.y+t.y)/2,spatialReference:k.spatialReference.toJson()});k=new n(w,this._symbol2,this.graphic,c.segIndex,g,C,this,!0);c=new n(h,this._symbol2,this.graphic,c.segIndex,g+1,C,this,!0);u.splice(g,0,k,c)},_deleteVertex:function(c){var h,g=c.ptIndex,k=this._vertexMovers[c.segIndex];for(h=0;h<g;h++)--k[h].segLength;for(h=g+1;h<k.length;h++){var w=k[h];--w.ptIndex;--w.segLength}k.splice(g,
1);h=c._getInfo();c.destroy();this.toolbar.onVertexDelete(this.graphic,h)}});m.mixin(b,{create:function(c,h,g){switch(c.geometry.type){case "multipoint":return new b.MultipointVertexEditor(c,h,g);case "polyline":return new b.PolylineVertexEditor(c,h,g);case "polygon":return new b.PolygonVertexEditor(c,h,g)}}});b.MultipointVertexEditor=F(b,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=a.connect(n,"onMoveStart",this,this._moveStartHandler);
a.disconnect(this._firstMoveHandle)},destroy:function(){this.inherited(arguments);a.disconnect(this._moveStartHandle)},_getSegments:function(c){var h=c.points,g=[],k=c.spatialReference;for(c=0;c<h.length;c++){var w=h[c];g.push(new f({x:w[0],y:w[1],spatialReference:k.toJson()}))}return[g]},_getMidpointSegments:function(c){return[]},_getControlPoints:function(c,h,g,k,w){return[]},_getGraphicsLayer:function(){return this.graphic._graphicsLayer},_mouseOverHandler:function(c){var h=c.graphic;if(c=this._findMover(c))this.toolbar.onVertexMouseOver(h,
c._getInfo()),this._selectedMover=c,this._canDel&&this._bindCtxNode(c.graphic.getDojoShape().getNode())},_mouseOutHandler:function(c){var h=c.graphic;if(c=this._findMover(c))this.toolbar.onVertexMouseOut(h,c._getInfo())},_findMover:function(c){var h=[].concat(this._vertexMovers[0]),g=c.target;for(c=0;c<h.length;c++){var k=h[c];if(k.graphic.getDojoShape().getNode()===g)return k}},_moveStartHandler:function(c){var h=c.ptIndex,g=c.segLength-1,k=c.relatedGraphic.geometry.points;c=k.splice(h,1);k.push(c[0]);
k=this._vertexMovers[0];for(c=g;c>h;c--)--k[c].ptIndex;c=k.splice(h,1);k.push(c[0]);c[0].ptIndex=g},_moveStopHandler:function(c){this._updateRelatedGraphic(c,c.relatedGraphic,c.graphic.geometry,c.segIndex,c.ptIndex,c.segLength);this.toolbar._endOperation("VERTICES")},_updateRelatedGraphic:function(c,h,g,k,w,t,C,u){c=h.geometry;u?c.removePoint(w):c.setPoint(w,g);h.setGeometry(c)},_deleteMidpoints:function(c){}});b.PolylineVertexEditor=F(b,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,
_getSegments:function(c){var h,g,k=c.paths,w=[];for(h=0;h<k.length;h++){var t=k[h],C=[];for(g=0;g<t.length;g++)C.push(c.getPoint(h,g));w.push(C)}return w},_getMidpointSegments:function(c){var h,g,k=c.paths,w=[],t=c.spatialReference;for(h=0;h<k.length;h++){var C=k[h],u=[];for(g=0;g<C.length-1;g++){var x=c.getPoint(h,g),l=c.getPoint(h,g+1);x=new f({x:(x.x+l.x)/2,y:(x.y+l.y)/2,spatialReference:t.toJson()});u.push(x)}w.push(u)}return w},_getControlPoints:function(c,h,g,k,w){var t=this.map,C,u;this._isNew(c)?
(c=k,k+=1,0<=c&&(C=t.toScreen(h.getPoint(g,c))),k<=w&&(u=t.toScreen(h.getPoint(g,k)))):(c=k-1,k+=1,0<=c&&(C=t.toScreen(h.getPoint(g,c))),k<w&&(u=t.toScreen(h.getPoint(g,k))));return[C,u]},_getAdjacentMidpoints:function(c,h){var g=[],k=c-1;0<=k&&g.push(k);c<h-1&&g.push(c);return g},_getAdjacentVertices:function(c,h){return[c,c+1]},_deleteMidpoints:function(c){var h=this._mpVertexMovers[c.segIndex],g=h.length-1,k=this._getAdjacentMidpoints(c.ptIndex,c.segLength).sort(),w,t=k[0];for(w=0;w<t;w++)--h[w].segLength;
for(w=t+1;w<h.length;w++){var C=h[w];--C.ptIndex;--C.segLength}if(1===k.length)h.splice(t,1)[0].destroy();else for(C=this._getAdjacentVertices(t,g),w=c.relatedGraphic.geometry.getPoint(c.segIndex,C[0]),C=c.relatedGraphic.geometry.getPoint(c.segIndex,C[1]),w=new f({x:(w.x+C.x)/2,y:(w.y+C.y)/2,spatialReference:w.spatialReference.toJson()}),c=new n(w,this._symbol2,this.graphic,c.segIndex,t,g,this,!0),h=h.splice(t,k.length,c),w=0;w<h.length;w++)h[w].destroy()},_updateRelatedGraphic:function(c,h,g,k,w,
t,C,u){c=h.geometry;C?c.insertPoint(k,w+1,d.fromJson(g.toJson())):u?c.removePoint(k,w):c.setPoint(k,w,d.fromJson(g.toJson()));h.setGeometry(c)}});b.PolygonVertexEditor=F(b,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(c){var h,g,k=c.rings,w=[];for(h=0;h<k.length;h++){var t=k[h],C=[];for(g=0;g<t.length-1;g++)C.push(c.getPoint(h,g));w.push(C)}return w},_getMidpointSegments:function(c){var h,g,k=c.rings,w=[],t=c.spatialReference;for(h=0;h<k.length;h++){var C=k[h],
u=[];for(g=0;g<C.length-1;g++){var x=c.getPoint(h,g),l=c.getPoint(h,g+1);x=new f({x:(x.x+l.x)/2,y:(x.y+l.y)/2,spatialReference:t.toJson()});u.push(x)}w.push(u)}return w},_getControlPoints:function(c,h,g,k,w){var t=this.map;this._isNew(c)?c=k:(c=k-1,c=0>c?(w+c)%w:c);k=(k+1)%w;w=t.toScreen(h.getPoint(g,c));h=t.toScreen(h.getPoint(g,k));return[w,h]},_getAdjacentMidpoints:function(c,h){var g=c-1;return[0>g?(h+g)%h:g,c]},_getAdjacentVertices:function(c,h){return[c,(c+1)%h]},_deleteMidpoints:function(c){var h=
c.ptIndex,g=this._mpVertexMovers[c.segIndex],k=g.length-1,w=this._getAdjacentMidpoints(h,c.segLength).sort();var t=w[0];var C=w[w.length-1];if(0===h){var u=this._getAdjacentVertices(k-1,k);h=c.relatedGraphic.geometry.getPoint(c.segIndex,u[0]);u=c.relatedGraphic.geometry.getPoint(c.segIndex,u[1]);h=new f({x:(h.x+u.x)/2,y:(h.y+u.y)/2,spatialReference:h.spatialReference.toJson()});c=new n(h,this._symbol2,this.graphic,c.segIndex,k-1,k,this,!0);g.splice(C,1,c)[0].destroy();g.splice(t,1)[0].destroy();for(w=
0;w<g.length-1;w++)t=g[w],--t.ptIndex,--t.segLength}else{u=this._getAdjacentVertices(t,k);h=c.relatedGraphic.geometry.getPoint(c.segIndex,u[0]);u=c.relatedGraphic.geometry.getPoint(c.segIndex,u[1]);h=new f({x:(h.x+u.x)/2,y:(h.y+u.y)/2,spatialReference:h.spatialReference.toJson()});c=new n(h,this._symbol2,this.graphic,c.segIndex,t,k,this,!0);C=g.splice(t,w.length,c);for(w=0;w<C.length;w++)C[w].destroy();for(w=0;w<t;w++)--g[w].segLength;for(w=t+1;w<g.length;w++)t=g[w],--t.ptIndex,--t.segLength}},_updateRelatedGraphic:function(c,
h,g,k,w,t,C,u){c=h.geometry;C?c.insertPoint(k,w+1,d.fromJson(g.toJson())):u?(c.removePoint(k,w),0===w&&c.setPoint(k,t-1,d.fromJson(c.getPoint(k,0).toJson()))):(c.setPoint(k,w,d.fromJson(g.toJson())),0===w&&c.setPoint(k,t,d.fromJson(g.toJson())));h.setGeometry(c)}});m.setObject("toolbars._GraphicVertexEditor",b,q);m.setObject("toolbars._MultipointVertexEditor",b.MultipointVertexEditor,q);m.setObject("toolbars._PolylineVertexEditor",b.PolylineVertexEditor,q);m.setObject("toolbars._PolygonVertexEditor",
b.PolygonVertexEditor,q);return b})},"esri/toolbars/_VertexMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/sniff dojo/dom-style dojox/gfx/Moveable dojox/gfx/matrix ../kernel ../PointerEvents ../sniff ../geometry/Point ../graphic ../geometry/webMercatorUtils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b){F=F(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(c,h,g,k,w,t,C,u){this.point=c;this.symbol=h;this.relatedGraphic=g;this.segIndex=k;this.ptIndex=
w;this.segLength=t;this.editor=C;this.map=C.map;this._scratchGL=C.toolbar._scratchGL;this._placeholder=u||!1;this._type=g.geometry.type;this._init();this._enable()},refresh:function(c){if(c||this._needRefresh())this._disable(),this._enable()},destroy:function(){this._disable();this.graphic&&this._scratchGL.remove(this.graphic);this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null},_init:function(){var c=new d(this.point.toJson());
c=new e(c,this.symbol);switch(this._type){case "multipoint":c._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(c)}this.graphic=c},_enable:function(){var c=this.graphic.getDojoShape();c&&(c._hasMover=!0,this._moveable=this._getMoveable(c),(c=c.getEventSource())&&z.set(c,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]))},_disable:function(){var c=this._moveable;if(c){a.disconnect(this._startHandle);
a.disconnect(this._firstHandle);a.disconnect(this._movingHandle);a.disconnect(this._stopHandle);var h=c.shape;h&&(h=h.getEventSource())&&z.set(h,"cursor","inherit");c.destroy();this._moveable=null}},_needRefresh:function(){var c=this.graphic.getDojoShape(),h=!1;if(c)switch(this._type){case "multipoint":var g=this.relatedGraphic.getDojoShape();g&&(g=g.children[this.ptIndex],c!==g&&(this.graphic._shape=g,h=!0));break;case "polyline":case "polygon":h=!c._hasMover}return h},_getMoveable:function(c){c=
new y(c,D("mac")&&D("ff")&&!f("esri-touch")&&{leftButtonOnly:!0});this._startHandle=a.connect(c,"onMoveStart",this,this._moveStartHandler);this._firstHandle=a.connect(c,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=a.connect(c,"onMoving",this,this._movingHandler);this._stopHandle=a.connect(c,"onMoveStop",this,this._moveStopHandler);return c},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0)},_getInfo:function(){return{graphic:this.graphic,isGhost:this._placeholder,
segmentIndex:this.segIndex,pointIndex:this._getPtIndex()}},_moveStartHandler:function(c){var h=this.map;h.snappingManager&&h.snappingManager._setUpSnapping();this.editor.toolbar._deactivateScrollWheel();this._startTx=this.graphic.getDojoShape().getTransform();c.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo())},_firstMoveHandler:function(c){var h=c.shape,g=this._getControlEdges(),k=this._scratchGL._div,w,t=[],C=c.host.shape._wrapOffsets[0]||
0;for(w=0;w<g.length;w++){var u=g[w];u.x1+=C;u.x2+=C;t.push([k.createLine({x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2}).setStroke(this.editor._lineStroke),u.x1,u.y1,u.x2,u.y2])}h._lines=t;c.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo())},_movingHandler:function(c,h,g){h=this.map;var k;f("esri-pointer")?k=h.navigationManager.pointerEvents._processTouchEvent(g,g):g&&"pointermove"===g.type&&(k=n.prototype._processTouchEvent.call({map:h},
g,g));k&&h.snappingManager&&h.snappingManager._onSnappingMouseMoveHandler(k);g=c.shape;c=g.getTransform();g=g._lines;for(k=0;k<g.length;k++)h=g[k],h[0].setShape({x1:h[1]+c.dx,y1:h[2]+c.dy,x2:h[3],y2:h[4]});this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),c)},_moveStopHandler:function(c){c=c.shape;var h=this.editor.toolbar,g=c.getTransform(),k=this.map,w=this.graphic,t=h._geo?b.geographicToWebMercator(w.geometry):w.geometry;h._activateScrollWheel();var C,u=c._lines;if(u){for(C=
0;C<u.length;C++)u[C][0].removeShape();c._lines=null}C=!1;u=!0;var x=this._getInfo();g&&(g.dx||g.dy)?this._placeholder&&(this._placeholder=!1,C=!0):u=!1;if(k.snappingManager)var l=k.snappingManager._snappingPoint;var v=[g,r.invert(this._startTx)];l=l||k.toMap(r.multiplyPoint(v,k.toScreen(t,!0)));k.snappingManager&&k.snappingManager._killOffSnapping();c.setTransform(null);w.setGeometry(h._geo?b.webMercatorToGeographic(l,!0):l);this.constructor.onMoveStop(this,g);h.onVertexMoveStop(this.relatedGraphic,
x,g);if(!u)h.onVertexClick(this.relatedGraphic,x);if(C)h.onVertexAdd(this.relatedGraphic,this._getInfo())},_getControlEdges:function(){var c=this.map,h=this.relatedGraphic.geometry,g=this.segIndex,k=this.ptIndex,w=this.segLength,t=this._scratchGL.getNavigationTransform(),C=t.dx;t=t.dy;var u=c.toScreen(this.graphic.geometry);c=u.x-C;u=u.y-t;var x=[];h=this.editor._getControlPoints(this,h,g,k,w);h[0]&&x.push({x1:c,y1:u,x2:h[0].x-C,y2:h[0].y-t});h[1]&&x.push({x1:c,y1:u,x2:h[1].x-C,y2:h[1].y-t});return x}});
m.setObject("toolbars.VertexMover",F,q);m.mixin(F,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});return F})},"esri/toolbars/TextEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/has dojo/dom-construct dojo/dom-class dojo/dom-style dojo/keys ../kernel".split(" "),function(F,m,a,D,z,y,r,q,n,f){F=F(null,{declaredClass:"esri.toolbars.TextEditor",constructor:function(d,e,b){this._graphic=d;this._map=e;this._toolbar=b;this._enable(this._graphic)},
destroy:function(){this._disable()},onEditStart:function(){},onEditEnd:function(){},_enable:function(d){this._editBox?(a.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null):(this._map.navigationManager.setImmediateClick(!0),this._addEditBoxHandler=a.connect(d.getLayer(),"onDblClick",this,function(e){this._map.navigationManager.setImmediateClick(!1);e.graphic==d&&(D.stop(e),a.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null,this._addTextBox(d))}))},_disable:function(){this._applyEdit();
this._addEditBoxHandler&&(a.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null);this._removeTextBox();this.onEditEnd(this._graphic);this._toolbar.onTextEditEnd(this._graphic)},_addTextBox:function(d,e){if(!this._editBox){if(!d.symbol.text){d.symbol.text="Tempt text";d.setSymbol(d.symbol);var b=""}var c=this._createInputTextStyle(d,this._map);""!==b&&(b=e||d.symbol.text);this._editBox=y.create("input",{type:"text",value:b});q.set(this._editBox,c);r.add(this._editBox,"esriTextEditorInput");
this._map.container.appendChild(this._editBox);this._editBox.focus();this._editBoxKeyHandler=a.connect(this._editBox,"onkeyup",m.hitch(this,function(g){g.keyCode!=n.ENTER&&g.keyCode!==n.TAB||this._disable()}));this._editBoxBlurHandler=a.connect(this._editBox,"onblur",m.hitch(this,function(g){this._disable()}));d.symbol.text="";d.setSymbol(d.symbol);d.hide();var h=this._editBox;this._disableBoxHandler||(this._disableBoxHandler=this._map.on("zoom-start",m.hitch(this,function(){this._disable()})));this._moveBoxHandler=
this._map.on("pan",function(g){q.set(h,{left:this._editBoxLeft+g.delta.x+"px",top:this._editBoxTop+g.delta.y+"px"})});this._moveBoxStartHandler=this._map.on("pan-start",function(){this._editBoxLeft=parseFloat(q.get(h,"left"));this._editBoxTop=parseFloat(q.get(h,"top"))});this.onEditStart(d,this._editBox);this._toolbar.onTextEditStart(d,this._editBox)}},_removeTextBox:function(){this._editBoxBlurHandler&&(a.disconnect(this._editBoxBlurHandler),this._editBoxBlurHandler=null);this._editBox&&(this._editBox.parentNode.removeChild(this._editBox),
this._editBox=null);this._disableBoxHandler&&(this._disableBoxHandler.remove(),this._disableBoxHandler=null);this._moveBoxHandler&&(this._moveBoxHandler.remove(),this._moveBoxHandler=null);this._moveBoxStartHandler&&(this._moveBoxStartHandler.remove(),this._moveBoxStartHandler=null);this._editBoxKeyHandler&&(a.disconnect(this._editBoxKeyHandler),this._editBoxKeyHandler=null)},_createInputTextStyle:function(d,e){var b=d.getDojoShape().getTransformedBoundingBox(),c=d.getLayer();c=c.hasLocalNavigationTransform()?
{dx:0,dy:0}:c.getNavigationTransform();var h=d.symbol.font;return{"font-family":h.family,"font-size":h.size+"px","font-style":h.style,"font-variant":h.variant,"font-weight":h.weight,left:b[0].x+c.dx+"px",top:b[0].y+c.dy+"px",width:Math.abs(b[0].x-b[1].x)/Math.cos(d.symbol.angle/180*Math.PI)+"px"}},_applyEdit:function(){if(this._editBox)if(this._editBox.value){this._graphic.show();var d=this._graphic.symbol;d.text=this._editBox.value;this._graphic.setSymbol(d)}else this._graphic.getLayer().remove(this._graphic)}});
m.setObject("toolbars.TextEditor",F,f);return F})},"esri/dijit/editing/Add":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ./EditOperationBase".split(" "),function(F,m,a,D,z,y){m=m(y,{declaredClass:"esri.dijit.editing.Add",type:"edit",label:"Add Features",constructor:function(r){r=r||{};r.featureLayer&&(this._featureLayer=r.featureLayer,r.addedGraphics&&(this._addedGraphics=r.addedGraphics))},updateObjectIds:function(r,q){this.updateIds(this._featureLayer,
this._addedGraphics,r,q)},performUndo:function(){return this._featureLayer.applyEdits(null,null,this._addedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var r=F.map(this._addedGraphics,function(q){return q.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._addedGraphics,null,null).then(a.hitch(this,function(q,n,f){q=F.map(q,function(d){return d.objectId});return{oldIds:r,addedIds:q,layer:this._featureLayer,
operation:this}}))}});a.setObject("dijit.editing.Add",m,z);return m})},"esri/dijit/editing/EditOperationBase":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/has","../../kernel","../../OperationBase"],function(F,m,a,D,z){m=m(z,{declaredClass:"esri.EditOperationBase",updateIds:function(y,r,q,n){F.forEach(r,function(f,d){var e=f[y.objectIdField];F.forEach(q,function(b,c){e===b&&(f[y.objectIdField]=n[c])})})}});return D.EditOperationBase=m})},"esri/dijit/editing/Update":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),
function(F,m,a,D,z,y,r){F=m(r,{declaredClass:"esri.dijit.editing.Update",type:"edit",label:"Update Features",constructor:function(q){var n;q=q||{};if(q.featureLayer&&(this._featureLayer=q.featureLayer,q.preUpdatedGraphics)){this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(n=0;n<q.preUpdatedGraphics.length;n++)this._preUpdatedGraphicsGeometries.push(q.preUpdatedGraphics[n].geometry.toJson()),this._preUpdatedGraphicsAttributes.push(q.preUpdatedGraphics[n].attributes);
if(q.postUpdatedGraphics)for(this._postUpdatedGraphics=q.postUpdatedGraphics,this._postUpdatedGraphicsGeometries=[],this._postUpdatedGraphicsAttributes=[],n=0;n<q.postUpdatedGraphics.length;n++)q.postUpdatedGraphics[n].geometry?this._postUpdatedGraphicsGeometries.push(q.postUpdatedGraphics[n].geometry.toJson()):this._postUpdatedGraphicsGeometries.push(q.postUpdatedGraphics[n].geometry),this._postUpdatedGraphicsAttributes.push(a.clone(q.postUpdatedGraphics[n].attributes))}},updateObjectIds:function(q,
n){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,q,n);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,q,n)},performUndo:function(){var q;for(q=0;q<this._postUpdatedGraphics.length;q++)this._preUpdatedGraphicsGeometries[q]?this._postUpdatedGraphics[q].setGeometry(y.fromJson(this._preUpdatedGraphicsGeometries[q])):this._postUpdatedGraphics[q].setGeometry(this._preUpdatedGraphicsGeometries[q]),this._postUpdatedGraphics[q].setAttributes(this._preUpdatedGraphicsAttributes[q]);
return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var q;for(q=0;q<this._postUpdatedGraphics.length;q++)this._postUpdatedGraphicsGeometries[q]?this._postUpdatedGraphics[q].setGeometry(y.fromJson(this._postUpdatedGraphicsGeometries[q])):this._postUpdatedGraphics[q].setGeometry(this._postUpdatedGraphicsGeometries[q]),this._postUpdatedGraphics[q].setAttributes(this._postUpdatedGraphicsAttributes[q]);
return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))}});a.setObject("dijit.editing.Update",F,z);return F})},"esri/dijit/editing/Delete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ./EditOperationBase".split(" "),function(F,m,a,D,z,y){m=m(y,{declaredClass:"esri.dijit.editing.Delete",type:"edit",label:"Delete Features",constructor:function(r){r=r||{};
r.featureLayer&&(this._featureLayer=r.featureLayer,r.deletedGraphics&&(this._deletedGraphics=r.deletedGraphics))},updateObjectIds:function(r,q){this.updateIds(this._featureLayer,this._deletedGraphics,r,q)},performUndo:function(){var r=F.map(this._deletedGraphics,function(q){return q.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._deletedGraphics,null,null).then(a.hitch(this,function(q,n,f){q=F.map(q,function(d){return d.objectId});return{oldIds:r,addedIds:q,
layer:this._featureLayer,operation:this}}))},performRedo:function(){return this._featureLayer.applyEdits(null,null,this._deletedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))}});a.setObject("dijit.editing.Delete",m,z);return m})},"esri/dijit/editing/Cut":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),function(F,m,a,D,z,y,r){m=m(r,{declaredClass:"esri.dijit.editing.Cut",
type:"edit",label:"Cut Features",constructor:function(q){var n;q=q||{};if(q.featureLayer&&(this._featureLayer=q.featureLayer,q.addedGraphics&&(this._addedGraphics=q.addedGraphics,q.preUpdatedGraphics))){this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(n=0;n<q.preUpdatedGraphics.length;n++)this._preUpdatedGraphicsGeometries.push(q.preUpdatedGraphics[n].geometry.toJson()),this._preUpdatedGraphicsAttributes.push(q.preUpdatedGraphics[n].attributes);if(q.postUpdatedGraphics)for(this._postUpdatedGraphics=
q.postUpdatedGraphics,this._postUpdatedGraphicsGeometries=[],this._postUpdatedGraphicsAttributes=[],n=0;n<q.postUpdatedGraphics.length;n++)this._postUpdatedGraphicsGeometries.push(q.postUpdatedGraphics[n].geometry.toJson()),this._postUpdatedGraphicsAttributes.push(a.clone(q.postUpdatedGraphics[n].attributes))}},updateObjectIds:function(q,n){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,q,n);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,q,n);this.updateIds(this._featureLayer,
this._addedGraphics,q,n)},performUndo:function(){var q;for(q=0;q<this._postUpdatedGraphics.length;q++)this._postUpdatedGraphics[q].setGeometry(y.fromJson(this._preUpdatedGraphicsGeometries[q])),this._postUpdatedGraphics[q].setAttributes(this._preUpdatedGraphicsAttributes[q]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._addedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var q;for(q=0;q<this._postUpdatedGraphics.length;q++)this._postUpdatedGraphics[q].setGeometry(y.fromJson(this._postUpdatedGraphicsGeometries[q])),
this._postUpdatedGraphics[q].setAttributes(this._postUpdatedGraphicsAttributes[q]);var n=F.map(this._addedGraphics,function(f){return f.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._addedGraphics,this._postUpdatedGraphics,null).then(a.hitch(this,function(f,d,e){f=F.map(f,function(b){return b.objectId});return{oldIds:n,addedIds:f,layer:this._featureLayer,operation:this}}))}});a.setObject("dijit.editing.Cut",m,z);return m})},"esri/dijit/editing/Union":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),
function(F,m,a,D,z,y,r){m=m(r,{declaredClass:"esri.dijit.editing.Union",type:"edit",label:"Union Features",constructor:function(q){q=q||{};this._featureLayer=q.featureLayer;this._deletedGraphics=q.deletedGraphics;this._preUpdatedGraphics=q.preUpdatedGraphics;this._postUpdatedGraphics=q.postUpdatedGraphics;this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];var n;for(n=0;n<q.preUpdatedGraphics.length;n++)this._preUpdatedGraphicsGeometries.push(q.preUpdatedGraphics[n].geometry.toJson()),
this._preUpdatedGraphicsAttributes.push(q.preUpdatedGraphics[n].attributes);for(n=0;n<q.postUpdatedGraphics.length;n++)this._postUpdatedGraphicsGeometries.push(q.postUpdatedGraphics[n].geometry.toJson()),this._postUpdatedGraphicsAttributes.push(a.clone(q.postUpdatedGraphics[n].attributes))},updateObjectIds:function(q,n){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,q,n);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,q,n);this.updateIds(this._featureLayer,
this._deletedGraphics,q,n)},performUndo:function(){var q;for(q=0;q<this._postUpdatedGraphics.length;q++)this._postUpdatedGraphics[q].setGeometry(y.fromJson(this._preUpdatedGraphicsGeometries[q])),this._postUpdatedGraphics[q].setAttributes(this._preUpdatedGraphicsAttributes[q]);var n=F.map(this._deletedGraphics,function(f){return f.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._deletedGraphics,this._postUpdatedGraphics,null).then(a.hitch(this,function(f,
d,e){f=F.map(f,function(b){return b.objectId});return{oldIds:n,addedIds:f,layer:this._featureLayer,operation:this}}))},performRedo:function(){var q;for(q=0;q<this._postUpdatedGraphics.length;q++)this._postUpdatedGraphics[q].setGeometry(y.fromJson(this._postUpdatedGraphicsGeometries[q])),this._postUpdatedGraphics[q].setAttributes(this._postUpdatedGraphicsAttributes[q]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._deletedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,
operation:this}}))}});a.setObject("dijit.editing.Union",m,z);return m})},"esri/dijit/editing/toolbars/Drawing":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dijit/_CssStateMixin ../Util ./ToolbarBase ../tools/ButtonToolBase ../tools/Cut ../tools/Union ../tools/Reshape ../tools/Editing ../tools/EditingTools ../tools/Selection ../tools/SelectionTools ../../../kernel".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k){F=F([q,y],{declaredClass:"esri.dijit.editing.toolbars.Drawing",
onShowAttributeInspector:function(){},_activateTool:function(w,t){this._settings.editor._activeTool=w;"EDITING"!==w&&this._settings.templatePicker.clearSelection();"ATTRIBUTES"!==w&&this._settings.editor._hideAttributeInspector();"CLEAR"!==w&&this.inherited(arguments)},_initializeToolbar:function(){a.forEach(this._settings.layers,function(w){this._tbConnects.push(D.connect(w,"onSelectionComplete",this,"_updateUI"))},this)},activateEditing:function(w,t){this._tools.EDITING._activateTool(w,t.geometryType);
this._activeTool=this._tools.EDITING;this._activeTool.setChecked(!0)},_updateUI:function(){this._settings.undoManager&&(this._tools.UNDO.set("disabled",!1===this._settings.undoManager.canUndo),this._tools.REDO.set("disabled",!1===this._settings.undoManager.canRedo));this._selectedFeatures=r.getSelection(this._settings.layers);var w=this._selectedFeatures.length;this._tools.DELETE&&this._tools.DELETE.set("disabled",0>=w);this._tools.CLEAR&&this._tools.CLEAR.set("disabled",0>=w);this._tools.ATTRIBUTES&&
this._tools.ATTRIBUTES.set("disabled",0>=w);this._tools.UNION&&this._tools.UNION.set("disabled",2>w)},_toolFinished:function(w){if("ATTRIBUTES"===w&&this._selectedFeatures&&this._selectedFeatures.length)this.onShowAttributeInspector(this._selectedFeatures[0]);if("SELECT"===w||"CUT"===w||"RESHAPING"===w||"EDITING"===w)this._activeTool.deactivate(),this._activeTool.setChecked(!1),this._activeTool=null;if("DELETE"===w)this.onDelete();this._settings.editor._activeTool=null;this._updateUI()},_createTools:function(){this._tools.SELECT=
new h({settings:this._settings,onClick:m.hitch(this,"_activateTool","SELECT",!0),onFinished:m.hitch(this,"_toolFinished","SELECT")});this.addChild(this._tools.SELECT);this._tools.CLEAR=new n(m.mixin(g.selectClear,{settings:this._settings,onClick:m.hitch(this._settings.editor,"_clearSelection",!1)}));this.addChild(this._tools.CLEAR);this._createSeparator();this._tools.ATTRIBUTES=new n(m.mixin(c.attributes,{settings:this._settings,onClick:m.hitch(this,"_toolFinished","ATTRIBUTES")}));this.addChild(this._tools.ATTRIBUTES);
this._createSeparator();this._tools.EDITING=new b({settings:this._settings,onClick:m.hitch(this,"_activateTool","EDITING",!0),onApplyEdits:m.hitch(this,"onApplyEdits"),onFinished:m.hitch(this,"_toolFinished","EDITING")});this.addChild(this._tools.EDITING);this._tools.DELETE=new n(m.mixin(c.del,{settings:this._settings,onClick:m.hitch(this,"_toolFinished","DELETE")}));this.addChild(this._tools.DELETE);this._settings.toolbarOptions&&((this._settings.toolbarOptions.cutVisible||this._settings.toolbarOptions.mergeVisible||
this._settings.toolbarOptions.reshapeVisible)&&this._createSeparator(),this._settings.toolbarOptions.cutVisible&&(this._tools.CUT=new f({settings:this._settings,onFinished:m.hitch(this,"_toolFinished","CUT"),onClick:m.hitch(this,"_activateTool","CUT",!0),onApplyEdits:m.hitch(this,"onApplyEdits")}),this.addChild(this._tools.CUT)),this._settings.toolbarOptions.mergeVisible&&(this._tools.UNION=new d({settings:this._settings,onFinished:m.hitch(this,"_toolFinished","UNION"),onApplyEdits:m.hitch(this,"onApplyEdits")}),
this.addChild(this._tools.UNION)),this._settings.toolbarOptions.reshapeVisible&&(this._tools.RESHAPING=new e({settings:this._settings,onClick:m.hitch(this,"_activateTool","RESHAPING",!0),onFinished:m.hitch(this,"_toolFinished","RESHAPING"),onApplyEdits:m.hitch(this,"onApplyEdits")}),this.addChild(this._tools.RESHAPING)));this._settings.enableUndoRedo&&(this._createSeparator(),this._tools.UNDO=new n(m.mixin(c.undo,{settings:this._settings,disabled:!0,onClick:m.hitch(this,function(){this._tools.UNDO.set("disabled",
!0);this._tools.REDO.set("disabled",!0);this._settings.editor._undo()})})),this.addChild(this._tools.UNDO),this._tools.REDO=new n(m.mixin(c.redo,{settings:this._settings,disabled:!0,onClick:m.hitch(this,function(){this._tools.UNDO.set("disabled",!0);this._tools.REDO.set("disabled",!0);this._settings.editor._redo()})})),this.addChild(this._tools.REDO))}});m.setObject("dijit.editing.toolbars.Drawing",F,k);return F})},"esri/dijit/editing/toolbars/ToolbarBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dijit/Toolbar dijit/ToolbarSeparator ../../../kernel ../../../lang".split(" "),
function(F,m,a,D,z,y,r,q,n){F=F([y],{declaredClass:"esri.dijit.editing.toolbars.ToolbarBase",_enabled:!0,graphicsAdded:function(){},drawEnd:function(){},onApplyEdits:function(){},onDelete:function(){},constructor:function(f,d){f&&f.settings&&(this._tools=[],this._tbConnects=[],this._initialize(f.settings))},postCreate:function(){this._createTools();this.deactivate()},destroy:function(){var f,d=this._tools;for(f in d)d.hasOwnProperty(f)&&n.isDefined(this._tools[f])&&this._tools[f].destroy();a.forEach(this._tbConnects,
D.disconnect);this.inherited(arguments)},activate:function(f){this._enabled=!0},deactivate:function(){var f;this._enabled=!1;this._geometryType=this._layer=null;var d=this._tools;for(f in d)d.hasOwnProperty(f)&&(this._tools[f].deactivate(),this._tools[f].setChecked(!1))},isEnabled:function(){return this._enabled},setActiveSymbol:function(f){this._activeSymbol=f},_getSymbol:function(){},_createTools:function(){},_initialize:function(f){this._settings=f;this._toolbar=f.drawToolbar;this._editToolbar=
f.editToolbar;this._initializeToolbar()},_activateTool:function(f,d){this._activeTool&&this._activeTool.deactivate();!0===d&&this._activeTool==this._tools[f]?(this._activeTool.setChecked(!1),this._activeTool=null):(this._activeTool=this._tools[f],this._activeTool.setChecked(!0),this._activeTool.activate(null))},_createSeparator:function(){this.addChild(new r)}});m.setObject("dijit.editing.toolbars.ToolbarBase",F,q);return F})},"esri/dijit/editing/tools/ButtonToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/form/Button ./ToolBase ../../../kernel".split(" "),
function(F,m,a,D,z,y){F=F([D,z],{declaredClass:"esri.dijit.editing.tools.ButtonToolBase",postCreate:function(){this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){D.prototype.destroy.apply(this,arguments);z.prototype.destroy.apply(this,arguments)}});m.setObject("dijit.editing.tools.ButtonToolBase",F,y);return F})},"esri/dijit/editing/tools/ToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../../../kernel","dojo/i18n!../../../nls/jsapi"],
function(F,m,a,D,z){F=F(null,{declaredClass:"esri.dijit.editing.tools.ToolBase",_enabled:!0,showLabel:!1,constructor:function(y,r){y=y||{};m.mixin(this,y);this.label=this._label?z.widgets.editor.tools[this._label]:"";this._settings=y.settings;this._toolbar=y.settings.drawToolbar;this._editToolbar=y.settings.editToolbar;this._initializeTool()},onFinished:function(){},onDrawEnd:function(){},onApplyEdits:function(){},postCreate:function(){this.deactivate();this.inherited(arguments)},destroy:function(){},
activate:function(y){this._toolbar&&this._toolbar.deactivate();this._editToolbar&&this._editToolbar.deactivate();this._enabled&&(this._checked=!0,this._layer=y,this._toolbar&&this._drawType&&this._toolbar.activate(this._drawType))},deactivate:function(){this._toolbar&&this._toolbar.deactivate();this._editToolbar&&this._editToolbar.deactivate();this.setChecked(!1);this._updateUI()},setEnabled:function(y){this._enabled=y;this._updateUI()},setChecked:function(y){this._checked=y},enable:function(y){this._updateUI()},
isEnabled:function(){return this._enabled},getToolName:function(){return this._toolName},_initializeTool:function(){},_updateUI:function(){this.disabled=!this._enabled;this.attr("iconClass",this._enabled?this._enabledIcon:this._disabledIcon)}});m.setObject("dijit.editing.tools.ToolBase",F,D);return F})},"esri/dijit/editing/tools/Cut":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/DeferredList ../../../graphicsUtils ../../../graphic ../../../tasks/query ../../../layers/FeatureLayer ../../../toolbars/draw ../Cut ./ToggleToolBase ../../../kernel".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c){F=F([b],{declaredClass:"esri.dijit.editing.tools.Cut",id:"btnFeatureCut",_enabledIcon:"toolbarIcon cutIcon",_disabledIcon:"toolbarIcon cutIcon",_drawType:d.POLYLINE,_enabled:!0,_label:"NLS_cutLbl",_cutConnects:[],activate:function(){this._cutConnects.push(D.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd"));this.inherited(arguments)},deactivate:function(){this.inherited(arguments);a.forEach(this._cutConnects,D.disconnect);this._cutConnects=[];this._edits=[]},
_onDrawEnd:function(h){var g=this._cutLayers=a.filter(this._settings.layers,function(w){return"esriGeometryPolygon"===w.geometryType||"esriGeometryPolyline"===w.geometryType&&w.visible&&w._isMapAtVisibleScale()});this._cutConnects=this._cutConnects.concat(a.map(g,m.hitch(this,function(w){return D.connect(w,"onEditsComplete",m.hitch(this,function(t,C,u){if(this._settings.undoRedoManager){var x=this._settings.undoRedoManager;a.forEach(this._edits,m.hitch(this,function(l){x.add(new e({featureLayer:l.layer,
addedGraphics:l.adds,preUpdatedGraphics:l.preUpdates,postUpdatedGraphics:l.updates}))}),this)}this.onFinished()}))})));var k=new n;k.geometry=h;a.forEach(g,function(w,t){this._settings.editor._selectionHelper.selectFeatures([w],k,f.SELECTION_NEW,m.hitch(this,"_cutFeatures",w,k))},this)},_cutFeatures:function(h,g,k){if(k&&k.length){this._edits=[];var w=[];w.push(this._settings.geometryService.cut(r.getGeometries(k),g.geometry,m.hitch(this,"_cutHandler",h,k)));(new y(w)).addCallback(m.hitch(this,function(){this.onApplyEdits(this._edits)}))}},
_cutHandler:function(h,g,k){var w=[],t=[],C=a.map(g,function(l){return new q(m.clone(l.toJson()))}),u,x;a.forEach(k.cutIndexes,function(l,v){u!=l?(u=l,1<a.filter(k.cutIndexes,function(A){return A===l}).length&&t.push(g[l].setGeometry(k.geometries[v]))):(x=new q(k.geometries[v],null,m.mixin({},g[l].attributes),null),x.attributes[g[0].getLayer().objectIdField]=null,w.push(x))},this);this._edits.push({layer:h,adds:w,updates:t,preUpdates:C})}});m.setObject("dijit.editing.tools.Cut",F,c);return F})},"esri/dijit/editing/tools/ToggleToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/form/ToggleButton ./ToolBase ../../../kernel".split(" "),
function(F,m,a,D,z,y){F=F([D,z],{declaredClass:"esri.dijit.editing.tools.ToggleToolBase",postCreate:function(){this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){D.prototype.destroy.apply(this,arguments);z.prototype.destroy.apply(this,arguments)},setChecked:function(r){D.prototype.setChecked.apply(this,arguments)}});m.setObject("dijit.editing.tools.ToggleToolBase",F,y);return F})},"esri/dijit/editing/tools/Union":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../../graphicsUtils ../../../graphic ../../../toolbars/draw ../Union ./ButtonToolBase ../../../kernel".split(" "),
function(F,m,a,D,z,y,r,q,n,f){F=F([n],{declaredClass:"esri.dijit.editing.tools.Union",id:"btnFeatureUnion",_enabledIcon:"toolbarIcon unionIcon",_disabledIcon:"toolbarIcon unionIcon",_drawType:r.POLYLINE,_enabled:!0,_label:"NLS_unionLbl",_onClick:function(d){this._settings.editor._activeTool="UNION";d=a.filter(this._settings.layers,function(c){return"esriGeometryPolygon"===c.geometryType&&c.visible&&c._isMapAtVisibleScale()});var e=[],b=0;a.forEach(d,function(c,h){var g=c.getSelectedFeatures();2<=
g.length&&(b++,this._settings.geometryService.union(z.getGeometries(g),m.hitch(this,function(k){var w=g.shift(),t=[],C=[];t.push(new y(w.toJson()));C.push(w.setGeometry(k));e.push({layer:c,updates:C,deletes:g,preUpdates:t});b--;if(0>=b)this.onApplyEdits(e,m.hitch(this,function(){if(this._settings.undoRedoManager){var u=this._settings.undoRedoManager;a.forEach(this._edits,m.hitch(this,function(x){u.add(new q({featureLayer:x.layer,deletedGraphics:x.deletes,preUpdatedGraphics:x.preUpdates,postUpdatedGraphics:x.updates}))}),
this)}this._settings.editor._selectionHelper.clearSelection(!1);this.onFinished()}))})))},this)}});m.setObject("dijit.editing.tools.Union",F,f);return F})},"esri/dijit/editing/tools/Reshape":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has ../../../graphic ../../../layers/FeatureLayer ../../../tasks/query ../../../toolbars/draw ./ToggleToolBase ../../../kernel".split(" "),function(F,m,a,D,z,y,r,q,n,f,d){F=F([f],{declaredClass:"esri.dijit.editing.tools.Reshape",
id:"btnFeatureReshape",_enabledIcon:"toolbarIcon reshapeIcon",_disabledIcon:"toolbarIcon reshapeIcon",_drawType:n.POLYLINE,_enabled:!0,_label:"NLS_reshapeLbl",activate:function(){D.disconnect(this._rConnect);this._rConnect=D.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");this.inherited(arguments)},deactivate:function(){this.inherited(arguments);D.disconnect(this._rConnect);delete this._rConnect},_onDrawEnd:function(e){var b=this._settings.layers,c=new q;c.geometry=e;e=this._reshapeLayers=a.filter(b,
function(h){return"esriGeometryPolygon"===h.geometryType||"esriGeometryPolyline"});this._settings.editor._selectionHelper.selectFeatures(e,c,r.SELECTION_NEW,m.hitch(this,"_reshape",c))},_reshape:function(e,b){if(1===b.length){var c=[],h=[],g=[],k=b[0],w=k.getLayer();this._settings.geometryService.reshape(k.geometry,e.geometry,m.hitch(this,function(t){"polyline"===t.type&&t.paths&&0===t.paths.length?(this._settings.editor._selectionHelper.clearSelection(!1),this.onFinished()):"polygon"===t.type&&t.rings&&
0===t.rings.length?(this._settings.editor._selectionHelper.clearSelection(!1),this.onFinished()):(g.push(new y(k.toJson())),h.push(k.setGeometry(t)),c.push({layer:w,updates:h,preUpdates:g}),this.onApplyEdits(c,m.hitch(this,function(){this._settings.editor._selectionHelper.clearSelection(!1);this.onFinished()})))}))}}});m.setObject("dijit.editing.tools.Reshape",F,d);return F})},"esri/dijit/editing/tools/Editing":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../../layers/FeatureTemplate ./Edit ./EditingTools ./DropDownToolBase ../../../kernel ../../../lang".split(" "),
function(F,m,a,D,z,y,r,q,n,f){F=F([q],{declaredClass:"esri.dijit.editing.tools.Editing",_enabled:!1,deactivate:function(){this._enabled&&(this._enabled=!1,this.inherited(arguments),this._settings.templatePicker.clearSelection())},onItemClicked:function(d,e){this.inherited(arguments);this._activeTool===this._tools.AUTOCOMPLETE&&(this._settings.editor._drawingTool=z.TOOL_AUTO_COMPLETE_POLYGON)},_activateTool:function(d,e){var b;this.enable(e);for(b in this._tools)this._tools.hasOwnProperty(b)&&(this.dropDown.removeChild(this._tools[b]),
!0===this._tools[b]._enabled&&this.dropDown.addChild(this._tools[b]));if(this._geometryType!==e||!1===this._activeTool._enabled)this._activeTool=this._tools[d.toUpperCase()];this._geometryType=e;this._activeTool.activate();this._activeTool.setChecked(!0);this._updateUI()},_initializeTool:function(d){this.inherited(arguments);this._initializeTools()},_initializeTools:function(){var d=this._settings.layers,e=this._settings.editor,b=!1,c=!1,h=!1,g=this._toolTypes=[],k;a.forEach(d,function(w){k=w.geometryType;
b=b||"esriGeometryPoint"===k;c=c||"esriGeometryPolyline"===k;h=h||"esriGeometryPolygon"===k;g=g.concat(a.map(this._getTemplatesFromLayer(w),m.hitch(this,function(t){return e._toDrawTool(t.drawingTool,w)})))},this);d=this._settings.createOptions;b&&this._toolTypes.push("point");c&&(this._toolTypes=this._toolTypes.concat(d.polylineDrawTools));h&&(this._toolTypes=this._toolTypes.concat(d.polygonDrawTools));this._toolTypes=this._toUnique(this._toolTypes.concat(g))},_toUnique:function(d){var e={};return a.filter(d,
function(b){return e[b]?!1:e[b]=!0})},_getTemplatesFromLayer:function(d){var e=d.templates||[];a.forEach(d.types,function(b){e=e.concat(b.templates)});return a.filter(e,f.isDefined)},_createTools:function(){a.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments)},_createTool:function(d){var e=m.mixin(r[d],{settings:this._settings,onClick:m.hitch(this,"onItemClicked",r[d].id)});this._tools[d.toUpperCase()]=new y(e)}});m.setObject("dijit.editing.tools.Editing",F,n);return F})},"esri/dijit/editing/tools/Edit":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","./MenuItemBase","../../../kernel"],function(F,m,a,D,z){F=F([D],{declaredClass:"esri.dijit.editing.tools.Edit",enable:function(y){this._enabled=y===this._geomType;this.inherited(arguments)}});m.setObject("dijit.editing.tools.Edit",F,z);return F})},"esri/dijit/editing/tools/MenuItemBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/MenuItem ./ToolBase ../../../kernel".split(" "),function(F,m,a,D,z,y){F=F([D,z],{declaredClass:"esri.dijit.editing.tools.MenuItemBase",
destroy:function(){D.prototype.destroy.apply(this,arguments);z.prototype.destroy.apply(this,arguments)}});m.setObject("dijit.editing.tools.MenuItemBase",F,y);return F})},"esri/dijit/editing/tools/EditingTools":function(){define(["dojo/_base/lang","dojo/has","../../../toolbars/draw","../../../kernel"],function(F,m,a,D){m={point:{id:"esriPointTool",_enabledIcon:"toolbarIcon pointIcon",_disabledIcon:"toolbarIcon pointIconDisabled",_drawType:a.POINT,_geomType:"esriGeometryPoint",_label:"NLS_pointLbl"},
polyline:{id:"toolDrawFreehandPolyline",_enabledIcon:"toolbarIcon polylineIcon",_disabledIcon:"toolbarIcon polylineIconDisabled",_drawType:a.POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_polylineLbl"},freehandpolyline:{id:"toolDrawPolyline",_enabledIcon:"toolbarIcon freehandPolylineIcon",_disabledIcon:"toolbarIcon freehandPolylineIcon",_drawType:a.FREEHAND_POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_freehandPolylineLbl"},polygon:{id:"toolDrawPolygon",_enabledIcon:"toolbarIcon polygonIcon",
_disabledIcon:"toolbarIcon polygonIconDisabled",_drawType:a.POLYGON,_geomType:"esriGeometryPolygon",_label:"NLS_polygonLbl"},freehandpolygon:{id:"toolDrawFreehandPolygon",_enabledIcon:"toolbarIcon freehandPolygonIcon",_disabledIcon:"toolbarIcon freehandPolygonIconDisabled",_drawType:a.FREEHAND_POLYGON,_label:"NLS_freehandPolygonLbl",_geomType:"esriGeometryPolygon"},autocomplete:{id:"btnFeatureAutoComplete",_enabledIcon:"toolbarIcon autoCompleteIcon",_disabledIcon:"toolbarIcon autoCompleteIcon",_drawType:a.POLYGON,
_label:"NLS_autoCompleteLbl",_geomType:"esriGeometryPolygon"},rectangle:{id:"toolDrawRect",_enabledIcon:"toolbarIcon rectangleIcon",_disabledIcon:"toolbarIcon rectangleIcon",_drawType:a.RECTANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_rectangleLbl"},arrow:{id:"toolDrawArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:a.ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLbl"},uparrow:{id:"toolDrawArrowUp",_enabledIcon:"toolbarIcon arrowUpIcon",_disabledIcon:"toolbarIcon arrowUpIcon",
_drawType:a.UP_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowUpLbl"},downarrow:{id:"toolDrawDownArrow",_enabledIcon:"toolbarIcon arrowDownIcon",_disabledIcon:"toolbarIcon arrowDownIcon",_drawType:a.DOWN_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowDownLbl"},leftarrow:{id:"toolDrawLeftArrow",_enabledIcon:"toolbarIcon arrowLeftIcon",_disabledIcon:"toolbarIcon arrowLeftIcon",_drawType:a.LEFT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLeftLbl"},rightarrow:{id:"toolDrawRightArrow",
_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:a.RIGHT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowRightLbl"},circle:{id:"toolDrawCircle",_enabledIcon:"toolbarIcon circleIcon",_disabledIcon:"toolbarIcon circleIcon",_drawType:a.CIRCLE,_geomType:"esriGeometryPolygon",_label:"NLS_circleLbl"},ellipse:{id:"toolDrawEllipse",_enabledIcon:"toolbarIcon ellipseIcon",_disabledIcon:"toolbarIcon ellipseIcon",_drawType:a.ELLIPSE,_geomType:"esriGeometryPolygon",_label:"NLS_ellipseLbl"},
triangle:{id:"toolDrawTriangle",_enabledIcon:"toolbarIcon triangleIcon",_disabledIcon:"toolbarIcon triangleIcon",_drawType:a.TRIANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_triangleLbl"},attributes:{id:"btnAttributes",_enabledIcon:"toolbarIcon attributesIcon",_disabledIcon:"toolbarIcon attributesIcon",_enabled:!1,_label:"NLS_attributesLbl"},del:{id:"btnDelete2",_enabledIcon:"toolbarIcon deleteFeatureIcon",_disabledIcon:"toolbarIcon deleteFeatureIcon",_enabled:!1,_label:"NLS_deleteLbl"},undo:{id:"btnUndo",
_enabledIcon:"dijitEditorIcon dijitEditorIconUndo",_disabledIcon:"dijitEditorIcon dijitEditorIconUndo",_enabled:!1,_label:"NLS_undoLbl"},redo:{id:"btnRedo",_enabledIcon:"dijitEditorIcon dijitEditorIconRedo",_disabledIcon:"dijitEditorIcon dijitEditorIconRedo",_enabled:!1,_label:"NLS_redoLbl"}};F.setObject("dijit.editing.tools.EditingTools",m,D);return m})},"esri/dijit/editing/tools/DropDownToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-style dijit/registry dijit/Menu dijit/form/ComboButton ./ToolBase ../../../kernel ../../../lang".split(" "),
function(F,m,a,D,z,y,r,q,n,f){F=F([r,q],{declaredClass:"esri.dijit.editing.tools.DropDownToolBase",_enabled:!1,_checked:!1,postCreate:function(){this._tools=[];this._createTools();this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){var d,e=this._tools;for(d in e)e.hasOwnProperty(d)&&f.isDefined(e[d])&&e[d].destroy();this.inherited(arguments)},_createTools:function(){var d,e=new y;this.dropDown=e;for(d in this._tools)this._tools.hasOwnProperty(d)&&e.addChild(this._tools[d]);
this._activeTool=e.getChildren()[0];this._updateUI()},activate:function(d){this.inherited(arguments);this._activeTool?this._activeTool.activate():this._activateDefaultTool()},deactivate:function(){this.inherited(arguments);this._activeTool&&this._activeTool.deactivate()},enable:function(d){for(var e in this._tools)this._tools.hasOwnProperty(e)&&this._tools[e].enable(d);this.setEnabled(!0);this.inherited(arguments)},setChecked:function(d){this._checked=d;this._updateUI()},_onDrawEnd:function(d){},
onLayerChange:function(d,e,b){this._activeTool=null;this._activeType=e;this._activeTemplate=b;this._activeLayer=d},onItemClicked:function(d,e){this._activeTool&&this._activeTool.deactivate();this._activeTool=z.byId(d);!1===this._checked?this._onClick():(this._updateUI(),this._activeTool&&(this._activeTool.activate(),this._activeTool.setChecked(!0)))},_onClick:function(d){!1!==this._enabled&&(this._checked=!this._checked,this.inherited(arguments))},_updateUI:function(){this.attr("disabled",!this._enabled);
D.set(this.focusNode,{outline:"none"});D.set(this.titleNode,{padding:"0px",border:"none"});this._checked?D.set(this.titleNode,{backgroundColor:"#D4DFF2",border:"1px solid #316AC5"}):D.set(this.titleNode,{backgroundColor:"",border:""});this._activeTool&&(this.attr("iconClass",this._checked?this._activeTool._enabledIcon:this._activeTool._disabledIcon),this.attr("label",this._activeTool.label))}});m.setObject("dijit.editing.tools.DropDownToolBase",F,n);return F})},"dijit/form/ComboButton":function(){define("dojo/_base/declare dojo/keys ../focus ./DropDownButton dojo/text!./templates/ComboButton.html ../a11yclick".split(" "),
function(F,m,a,D,z){return F("dijit.form.ComboButton",D,{templateString:z,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{buttonNode:"dijitButtonNode",titleNode:"dijitButtonContents",_popupStateNode:"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyDown:function(y){y.keyCode==m[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]&&(a.focus(this._popupStateNode),y.stopPropagation(),y.preventDefault())},_onArrowKeyDown:function(y){y.keyCode==
m[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]&&(a.focus(this.titleNode),y.stopPropagation(),y.preventDefault())},focus:function(y){this.disabled||a.focus("start"==y?this.titleNode:this._popupStateNode)}})})},"esri/dijit/editing/tools/Selection":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleFillSymbol ./Edit ./SelectionTools ./DropDownToolBase ../../../kernel".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b){F=F([e],{declaredClass:"esri.dijit.editing.tools.Selection",_enabled:!0,activate:function(){this.inherited(arguments);this._sConnect=D.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd")},deactivate:function(){this.inherited(arguments);D.disconnect(this._sConnect);delete this._sConnect},_initializeTool:function(){this._createSymbols();this._initializeLayers();this._toolTypes=["select","selectadd","selectremove"]},_onDrawEnd:function(c){this.inherited(arguments);
this._settings.editor._hideAttributeInspector();var h=this._settings.layers;this._selectMethod=this._activeTool._selectMethod;this._settings.editor._selectionHelper.selectFeaturesByGeometry(h,c,this._selectMethod,m.hitch(this,"onFinished"))},_createSymbols:function(){this._pointSelectionSymbol=new r(r.STYLE_CIRCLE,10,new q(q.STYLE_SOLID,new z([0,0,0]),1),new z([255,0,0,.5]));this._polylineSelectionSymbol=new q(q.STYLE_SOLID,new z([0,200,255]),2);this._polygonSelectionSymbol=new n(n.STYLE_SOLID,new q(q.STYLE_SOLID,
new z([0,0,0]),1),new z([0,200,255,.5]))},_initializeLayers:function(){a.forEach(this._settings.layers,this._setSelectionSymbol,this)},_setSelectionSymbol:function(c){var h=null;switch(c.geometryType){case "esriGeometryPoint":h=this._pointSelectionSymbol;break;case "esriGeometryPolyline":h=this._polylineSelectionSymbol;break;case "esriGeometryPolygon":h=this._polygonSelectionSymbol}c.setSelectionSymbol(c._selectionSymbol||h)},_createTools:function(){a.forEach(this._toolTypes,this._createTool,this);
this.inherited(arguments)},_createTool:function(c){var h=m.mixin(d[c],{settings:this._settings,onClick:m.hitch(this,"onItemClicked",d[c].id)});this._tools[c.toUpperCase()]=new f(h)}});m.setObject("dijit.editing.tools.Selection",F,b);return F})},"esri/dijit/editing/tools/SelectionTools":function(){define(["dojo/_base/lang","dojo/has","../../../layers/FeatureLayer","../../../toolbars/draw","../../../kernel"],function(F,m,a,D,z){m={select:{id:"btnNewSelection",_enabledIcon:"toolbarIcon newSelectionIcon",
_disabledIcon:"toolbarIcon newSelectionIcon",_drawType:D.EXTENT,_selectMethod:a.SELECTION_NEW,_label:"NLS_selectionNewLbl"},selectadd:{id:"btnAddToSelection",_enabledIcon:"toolbarIcon addToSelectionIcon",_disabledIcon:"toolbarIcon addToSelectionIcon",_drawType:D.EXTENT,_selectMethod:a.SELECTION_ADD,_label:"NLS_selectionAddLbl"},selectremove:{id:"btnSubtractFromSelection",_enabledIcon:"toolbarIcon removeFromSelectionIcon",_disabledIcon:"toolbarIcon removeFromSelectionIcon",_drawType:D.EXTENT,_selectMethod:a.SELECTION_SUBTRACT,
_label:"NLS_selectionRemoveLbl"},selectClear:{id:"btnClearSelection",_enabledIcon:"toolbarIcon clearSelectionIcon",_disabledIcon:"toolbarIcon clearSelectionIcon",_enabled:!1,_label:"NLS_selectionClearLbl"}};F.setObject("dijit.editing.tools.SelectionTools",m,z);return m})},"esri/dijit/editing/SelectionHelper":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dojo/DeferredList ../../geometry/Extent ../../geometry/Point ../../geometry/ScreenPoint ../../layers/FeatureLayer ../../tasks/query ../../kernel".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e){F=F(null,{declaredClass:"esri.dijit.editing.SelectionHelper",constructor:function(b){this._settings=b||{};this._sConnects=[];this._mapServiceCount=0;this._map=this._settings.map;this._tolerance=this._settings.singleSelectionTolerance;this._initMapServiceInfos(this._settings.layers)},destroy:function(){for(var b in this._sConnects)this._sConnects.hasOwnProperty(b)&&a.disconnect(this._sConnects[b])},selectFeatures:function(b,c,h,g){h===f.SELECTION_NEW&&(this._resetMapServiceInfos(),
this.getSelection(b));var k=[];D.forEach(b,function(w){if(!0===w.visible&&!0===w._isMapAtVisibleScale()){var t=h;w._isSelOnly&&t===f.SELECTION_NEW&&(t=f.SELECTION_ADD);k.push(w.selectFeatures(c,t))}});(new y(k)).addCallback(m.hitch(this,function(w){var t=[];D.forEach(w,function(C,u){D.forEach(C[1],function(x){(x=b[u]._mode._getFeature(x.attributes[b[u].objectIdField])||null)&&t.push(x)},this)},this);this._mapServiceCount?((w=h===f.SELECTION_SUBTRACT)?(this._resetMapServiceInfos(),this._createLayerDefs(this._getLayerInfosFromSelection(b))):
this._createLayerDefs(this._getLayerInfosFromFeatures(t)),this._updateLayerDefs(this._mapServiceInfos,!1,!(t&&t.length||w),m.hitch(this,g,t))):g(t)}))},selectFeaturesByGeometry:function(b,c,h,g){var k=c;-1!==c.declaredClass.indexOf("Extent")&&c.xmax===c.xmin&&c.ymax===c.ymin&&(k=new q(c.xmax,c.ymax,c.spatialReference));k=-1!==k.declaredClass.indexOf("Point")?this._extentFromPoint(k):k;c=new d;c.geometry=k;this.selectFeatures(b,c,h,g)},clearSelection:function(b){D.forEach(this._nonSelOnlyLayers,function(h){h.clearSelection&&
h.clearSelection()});if(this._mapServiceCount){this._resetMapServiceInfos();var c=this._getLayerInfosFromSelection(this._settings.layers);D.some(c,function(h){return h.oids&&h.oids.length})&&(this._createLayerDefs(c),this._updateLayerDefs(this._mapServiceInfos,!0,b||!1))}},findMapService:function(b){var c=this._map,h=c.layerIds;b=b&&b._url&&b._url.path?b._url.path.toLowerCase():"";var g;for(g in h)if(h.hasOwnProperty(g)){var k=c.getLayer(h[g]);var w=k._url?k._url.path?k._url.path.toLowerCase().replace("mapserver",
"featureserver"):k._url.toLowerCase().replace("mapserver","featureserver"):"";if(b.substr(0,w.length)===w&&"esri.layers.ArcGISDynamicMapServiceLayer"===k.declaredClass)return k}},getSelection:function(b){var c=[];D.forEach(b,function(h){h._isSelOnly&&c.push(this._createLayerInfo(h))},this);D.forEach(c,function(h){var g=this._createMapServiceInfo(this.findMapService(h.layer));g&&(g.layerInfos[h.layer.layerId]=h)},this)},_initMapServiceInfos:function(b){this._nonSelOnlyLayers=[];this._mapServiceInfos=
[];D.forEach(b,function(c){var h=this.findMapService(c);h?(this._mapServiceCount++,this._createMapServiceInfo(h),h&&h.setDisableClientCaching(!0)):this._nonSelOnlyLayers.push(c)},this)},_createMapServiceInfo:function(b){if(!b)return null;var c=this._mapServiceInfos,h=c[b.id];h||(h=c[b.id]={mapService:b,layerInfos:[],layerDefs:m.mixin([],b.layerDefinitions||[]),origLayerDefs:m.mixin([],b.layerDefinitions||[])});return h},_resetMapServiceInfo:function(b){D.forEach(b.layerInfos,this._resetLayerInfo);
b.layerDefs=m.mixin([],b.origLayerDefs||[])},_resetMapServiceInfos:function(){var b=this._mapServiceInfos,c;for(c in b)b.hasOwnProperty(c)&&this._resetMapServiceInfo(b[c])},_createLayerInfo:function(b,c){var h=b.objectIdField,g=c?[]:b.getSelectedFeatures();return{layer:b,selectedFeatures:g||[],oids:D.map(g,function(k){return k.attributes[h]})}},_resetLayerInfo:function(b){b&&(b.selectedFeatures=[],b.oids=[])},_updateLayerDefs:function(b,c,h,g){for(var k in b)if(b.hasOwnProperty(k)){var w=b[k],t=w.mapService,
C=w.layerDefs=c?m.mixin([],w.origLayerDefs||[]):w.layerDefs;C?(h?g&&g():this._sConnects[t.id]=a.connect(t,"onUpdateEnd",m.hitch(this,"_onMapServiceUpdate",w,c,g)),t.setLayerDefinitions(C,h||!1)):g&&g()}},_onMapServiceUpdate:function(b,c,h){a.disconnect(this._sConnects[b.mapService.id]);D.forEach(b.layerInfos,function(g){if(c)g&&g.layer.clearSelection();else{var k=new d;k.objectIds=g?g.oids:[];k.objectIds.length&&g.layer.selectFeatures(k,f.SELECTION_SUBTRACT)}},this);c&&this._resetMapServiceInfo(b);
h&&h()},_createLayerDefs:function(b){D.forEach(b,function(c){var h=c.layer,g=this._createMapServiceInfo(this.findMapService(c.layer));if(g){g=g.layerDefs;var k=h.layerId,w='("'+h.objectIdField+'" NOT IN (',t=c.oids;t&&t.length&&(D.forEach(c.oids,function(C,u){t=!0;u&&(w+=",");w+="'"+C+"'"}),w+="))",g[k]=g.length&&g[k]&&g[k].length?g[k]+(" AND"+w):w)}},this)},_getLayerInfosFromFeatures:function(b){var c=[];D.forEach(b,function(g){var k=g.getLayer();k&&k._isSelOnly&&(c[k.id]||(c[k.id]=this._createLayerInfo(k,
!0)),c[k.id].selectedFeatures.push(g),c[k.id].oids.push(g.attributes[k.objectIdField]))},this);b=[];for(var h in c)c.hasOwnProperty(h)&&b.push(c[h]);return b},_getLayerInfosFromSelection:function(b){var c=[];D.forEach(b,function(h){h._isSelOnly&&c.push(this._createLayerInfo(h,!1))},this);return c},_extentFromPoint:function(b){var c=this._tolerance,h=this._map,g=h.toScreen(b);b=new n(g.x-c,g.y+c);c=new n(g.x+c,g.y-c);b=h.toMap(b);c=h.toMap(c);return new r(b.x,b.y,c.x,c.y,h.spatialReference)}});m.setObject("dijit.editing.SelectionHelper",
F,e);return F})},"esri/dijit/Directions":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/array dojo/_base/Color dijit/a11yclick dijit/_TemplatedMixin dijit/form/Select dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/TimeTextBox dojo/store/Memory dojo/data/ObjectStore dojo/keys dojo/has dojo/on dojo/mouse dojo/dom dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/dom-attr dojo/query dojo/number dojo/i18n!../nls/jsapi dojo/text!./templates/Directions.html ./Search dojo/dom-construct dojo/promise/all dojo/Deferred dojo/dnd/Source dojo/json ../kernel ../urlUtils ../graphic ../units ../TimeExtent ../InfoTemplate ../SpatialReference ../layers/ArcGISDynamicMapServiceLayer ../layers/GraphicsLayer ../geometry/webMercatorUtils ../geometry/geodesicUtils ../arcgis/utils ../geometry/Point ../geometry/Extent ../geometry/Polyline ../geometry/mathUtils ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/CartographicLineSymbol ../symbols/TextSymbol ../renderers/UniqueValueRenderer ../symbols/Font ./_EventedWidget ../tasks/FeatureSet ../tasks/RouteTask ../tasks/RouteParameters ../tasks/GeometryService ../tasks/DistanceParameters ../tasks/PrintTask ../tasks/PrintParameters ../tasks/PrintTemplate ../toolbars/edit ../toolbars/draw ../config ../tasks/ProjectParameters dojo/uacss".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K,ba,T,P,J,N,Z,Y,qa,V,na,ya,S,ma,ja,X,oa,xa,Ha,Ia,ia,ea,za,Ca,Da,ka,ta,M,Ga,La,aa,Ya,Wa,Ea,U,fa,sa,O){var ca=J.getProtocolForWebResource(),va=G.createSubclass({_setSourcesAttr:function(H){H&&(H=H.map(function(R){R.locator&&null==R.locationType&&(R=a.mixin({locationType:"street"},R));return R}));this.inherited(arguments,[H])}});m=m("esri.dijit.Directions",[ka,q],{templateString:E,mapClickActive:!1,barrierToolActive:!1,_eventMap:{activate:!0,
deactivate:!1,load:!0,"directions-start":!0,"directions-finish":["result"],"directions-clear":!0,"segment-select":["graphic"],"segment-highlight":["graphic"],error:["error"],"stops-update":["stops"],"route-item-created":!0,"route-item-updated":!0,"feature-collection-created":!0},_emptyStop:{name:""},constructor:function(H,R){if(!H.map)throw Error('Required "map" parameter is missing. Cannot instantiate Directions Widget.');if(!R)throw Error('Required "srcNodeRef" parameter is missing. Cannot instantiate Directions Widget.');
this._i18n=B;this._css={widgetContainerClass:"esriDirectionsContainer",searchSourceContainerClass:"esriSearchSourceContainer",stopsContainerClass:"esriStopsContainer",stopsTableContainerClass:"esriStopsTableContainer",stopsTableCoverClass:"esriStopsTableCover",reverseStopsClass:"esriStopsReverse",addStopsClass:"esriStopsAdd",stopsClass:"esriStops",stopsRemovableClass:"esriStopsRemovable",stopsButtonContainerClass:"esriStopsButtons",stopsOptionsButtonClass:"esriStopsOptionsButton",stopsAddDestinationClass:"esriStopsAddDestination",
stopsAddDestinationBtnClass:"esriStopsAddDestinationBtn",stopsGetDirectionsContainerClass:"esriStopsGetDirectionsContainer",stopsGetDirectionsClass:"esriStopsGetDirections",stopsClearDirectionsClass:"esriStopsClearDirections",stopsInnerGeocoderClass:"esriInnerGeocoder",stopsOptionsOptionsEnabledClass:"esriStopsOptionsEnabled",stopsOptionsMenuClass:"esriStopsOptionsMenu",stopsFindOptimalOrderClass:"esriFindOptimalOrderOption",stopsUseTrafficClass:"esriUseTrafficOption",stopsReturnToStartClass:"esriReturnToStartOption",
stopsOptionsCheckboxesClass:"esriOptionsCheckboxes",stopsOptionsToggleContainerClass:"esriOptionsToggleContainer",stopsOptionsUnitsContainerClass:"esriOptionsUnitsContainer",stopsOptionsUnitsMiClass:"esriOptionsUnitsMi",stopsOptionsUnitsKmClass:"esriOptionsUnitsKm",stopsOptionsImpedanceContainerClass:"esriOptionsImpedanceContainer",stopsOptionsImpedanceTimeClass:"esriOptionsImpedanceTime",stopsOptionsImpedanceDistanceClass:"esriOptionsImpedanceDistance",stopClass:"esriStop",stopOriginClass:"esriStopOrigin",
stopDestinationClass:"esriStopDestination",stopUnreachedFirstOrLastClass:"esriStopUnreachedFirstOrLast",stopUnreachedClass:"esriStopUnreached",esriStopGeocoderColumnClass:"esriStopGeocoderColumn",esriStopReverseColumnClass:"esriStopReverseColumn",stopDnDHandleClass:"esriStopDnDHandle",stopDnDHandleClassHidden:"esriStopDnDHandleHidden",stopIconColumnClass:"esriStopIconColumn",stopIconClass:"esriStopIcon",stopIconRemoveColumnClass:"esriStopIconRemoveColumn",stopIconRemoveClass:"esriStopIconRemove",
stopIconRemoveClassHidden:"esriStopIconRemoveHidden",resultsContainerClass:"esriResultsContainer",resultsLoadingClass:"esriResultsLoading",resultsPrintClass:"esriResultsPrint",resultsSaveClass:"esriResultsSave",resultsSummaryClass:"esriResultsSummary",routesContainerClass:"esriRoutesContainer",routesClass:"esriRoutes",routesErrorClass:"esriRoutesError",routesInfoClass:"esriRoutesInfo",routeClass:"esriRoute",routeTextColumnClass:"esriRouteTextColumn",routeTextClass:"esriRouteText",routeLengthClass:"esriRouteLength",
routeOriginClass:"esriDMTStopOrigin",routeDestinationClass:"esriDMTStopDestination",routeInfoClass:"esriRouteInfo",routeIconColumnClass:"esriRouteIconColumn",routeIconClass:"esriRouteIcon",infoWindowRouteClass:"esriInfoWindowRoute",routeZoomClass:"esriRouteZoom",esriPrintPageClass:"esriPrintPage",esriPrintBarClass:"esriPrintBar",esriPrintButtonClass:"esriPrintButton",esriCloseButtonClass:"esriCloseButton",esriPrintMainClass:"esriPrintMain",esriPrintHeaderClass:"esriPrintHeader",esriPrintLogoClass:"esriPrintLogo",
esriPrintMapClass:"esriPrintMap",esriPrintNameClass:"esriPrintName",esriPrintNotesClass:"esriPrintNotes",esriPrintLengthClass:"esriPrintLength",esriPrintDirectionsClass:"esriPrintDirections",esriPrintStopLabelClass:"esriPrintStopLabel",clearClass:"esriClear",dndDragBodyClass:"esriDndDragDirection",stopsButtonClass:"esriDirectionsButton",stopsButtonTabClass:"esriDirectionsTabButton",stopsButtonTabLastClass:"esriDirectionsTabLastButton",stopsPressedButtonClass:"esriDirectionsPressedButton",linkButtonClass:"esriLinkButton",
activateButtonClass:"esriActivateButton",lineBarrierButtonClass:"esriLineBarrierButton",travelModesContainerClass:"esriTravelModesContainer"};this.options={map:null,autoSolve:!0,minStops:2,maxStops:20,theme:"simpleDirections",alphabet:"1234567890",directions:null,returnToStart:!1,optimalRoute:!1,routeTaskUrl:ca+"//route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",printTaskUrl:ca+"//utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task",
geometryTaskUrl:ca+"//utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",routeParams:{},stops:["",""],searchOptions:{},stopsInfoTemplate:new qa(B.widgets.directions.stop,"${address}${error}"),waypointInfoTemplate:new qa(B.widgets.directions.maneuver,B.widgets.directions.waypoint),segmentInfoTemplate:new qa(B.widgets.directions.maneuver,'\x3cdiv class\x3d"${maneuverType}"\x3e\x3cdiv class\x3d"'+this._css.routeIconClass+" "+this._css.infoWindowRouteClass+'"\x3e\x3cstrong\x3e${step}.\x3c/strong\x3e ${formattedText}\x3c/div\x3e\x3c/div\x3e'),
textSymbolFont:new Da("11px",Da.STYLE_NORMAL,Da.VARIANT_NORMAL,Da.WEIGHT_NORMAL,"Arial, Helvetica, sans-serif"),textSymbolColor:new y([255,255,255]),textSymbolOffset:{x:0,y:10.875},fromSymbol:(new ia({url:F.toUrl("./images/Directions/greenPoint.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),fromSymbolDrag:(new ia({url:F.toUrl("./images/Directions/greenPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),stopSymbol:(new ia({url:F.toUrl("./images/Directions/bluePoint.png"),
height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),stopSymbolDrag:(new ia({url:F.toUrl("./images/Directions/bluePointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),toSymbol:(new ia({url:F.toUrl("./images/Directions/redPoint.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),toSymbolDrag:(new ia({url:F.toUrl("./images/Directions/redPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),unreachedSymbol:(new ia({url:F.toUrl("./images/Directions/grayPoint.png"),
height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),unreachedSymbolDrag:(new ia({url:F.toUrl("./images/Directions/grayPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),waypointSymbol:new Ia({color:[255,255,255,255],size:10,type:"esriSMS",style:"esriSMSCircle",outline:{color:[20,89,127,255],width:2.5,type:"esriSLS",style:"esriSLSSolid"}}),maneuverSymbol:new Ia({color:[255,255,255,255],size:4,type:"esriSMS",style:"esriSMSCircle",outline:{color:[30,99,137,255],
width:1,type:"esriSLS",style:"esriSLSSolid"}}),routeSymbol:(new ea).setColor(new y([20,89,127,.75])).setWidth(10).setCap(ea.CAP_ROUND).setJoin(ea.JOIN_ROUND),segmentSymbol:(new ea).setColor(new y([255,255,255,1])).setWidth(6).setCap(ea.CAP_ROUND).setJoin(ea.JOIN_ROUND),barrierRenderer:new Ca({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjIyIiBoZWlnaHQ9IjIyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z181IiByeD0iMTAwIiByeT0iMTAwIi8+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z182IiByeD0iOTUiIHJ5PSI5NSIvPgo8cmVjdCBmaWxsPSIjZmYwMDAwIiBzdHJva2Utd2lkdGg9IjIwIiB4PSI2NC41IiB5PSIxMDIiIHdpZHRoPSI5NSIgaGVpZ2h0PSIxOCIgaWQ9InN2Z183IiBzdHJva2U9IiNmZmZmZmYiLz4KPC9nPgo8L3N2Zz4\x3d",
contentType:"image/svg+xml",width:18,height:18},uniqueValueInfos:[{value:"2",symbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjg2IiBoZWlnaHQ9IjI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxwYXRoIGZpbGw9IiNmZmYiIHN0cm9rZS13aWR0aD0iMTAiIGQ9Im04Ljc0OTk5MiwyNTEuNzQ5OTk3bDEzNC45OTk5OTgsLTI0MS45OTk5OThsMTM0Ljk5OTk5OCwyNDEuOTk5OTk4bC0yNjkuOTk5OTk1LDBsLTAuMDAwMDAxLDB6IiBpZD0ic3ZnXzEiIHN0cm9rZT0iIzAwMCIvPgo8cGF0aCBzdHJva2U9IiNmZmYiIGZpbGw9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMTUiIGQ9Im0yMy41MDAwMDQsMjQyLjUwMDAwNWwxMTkuOTk5OTkyLC0yMTUuOTk5OTk5bDExOS45OTk5OTIsMjE1Ljk5OTk5OWwtMjM5Ljk5OTk4MywwbC0wLjAwMDAwMSwweiIgaWQ9InN2Z18yIi8+Cjx0ZXh0IGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMCIgeD0iMTA5IiB5PSIyMjIuNzUiIGlkPSJzdmdfNSIgZm9udC1zaXplPSIxODAiIGZvbnQtZmFtaWx5PSJHZW9yZ2lhLCBUaW1lcywgJ1RpbWVzIE5ldyBSb21hbicsIHNlcmlmIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIHhtbDpzcGFjZT0icHJlc2VydmUiPiE8L3RleHQ+CjwvZz4KPC9zdmc+",
contentType:"image/svg+xml",width:19,height:18}}]}),polylineBarrierRenderer:new Ca({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,85,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"}}]}),polygonBarrierRenderer:new Ca({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,156],outline:{color:[255,0,0,153],width:2.4,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",
style:"esriSFSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,170,0,156],outline:{color:[255,0,0,153],width:7.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}]}),printPage:"",printTemplate:"",focusOnNewStop:!0,dragging:!0,canModifyStops:!0,canModifyWaypoints:!0,directionsLengthUnits:null,directionsLanguage:null,traffic:!1,trafficLayer:null,showPrintPage:!0,showSaveButton:!1,showSegmentPopup:!1,showSegmentHighlight:!0,showReverseStopsButton:!0,showReturnToStartOption:!0,
showOptimalRouteOption:!0,showTravelModesOption:!0,showMilesKilometersOption:!0,showClearButton:!1,showActivateButton:!0,showBarriersButton:!0,loaded:!1,routeLayer:{itemId:null,title:null,isItemOwner:!0,ownerFolder:null},startTime:"now"};this.userOptions=H;this.defaults=a.mixin({},this.options,H,{_waypointName:"DWWP",_userDefinedStopName:"UserDefinedStopName",_solveInProgress:!1,_moveInProgress:!1,_stopSequence:1E3});if(!this.defaults.minStops||2>this.defaults.minStops)this.defaults.minStops=2;if(2<
this.defaults.minStops&&this.defaults.stops&&","===this.defaults.stops.toString())for(var W=2;W<this.defaults.minStops;W++)this.defaults.stops.splice(0,0,"");this.domNode=R},postCreate:function(){this.inherited(arguments);this.own(k(this._activateButtonNode,r,a.hitch(this,function(){this.mapClickActive?this.deactivate():this.activate()})));this.own(k(this._lineBarrierButtonNode,r,a.hitch(this,function(){this.barrierToolActive?this.deactivateBarrierTool():this.activateBarrierTool()})));this.own(k(this._addDestinationNode,
r,a.hitch(this,this._addStopButton)));this.own(k(this._optionsButtonNode,r,a.hitch(this,this._toggleOptionsMenu)));this.own(k(this._saveMenuButton,r,a.hitch(this,this._toggleSaveMenu)));this.own(k(this._saveButton,r,a.hitch(this,function(){this._saveButton._enabled&&this._storeRouteUI()})));this.own(k(this._saveAsButton,r,a.hitch(this,function(){a.mixin(this.routeLayer,{itemId:null,title:null,ownerFolder:null});this._storeRouteUI()})));this.own(k(this._findOptimalOrderNode,r,a.hitch(this,this._toggleCheckbox)));
this.own(k(this._returnToStartNode,r,a.hitch(this,this._toggleCheckbox)));this.own(k(this._useTrafficNode,r,a.hitch(this,this._toggleCheckbox)));this.own(k(this._useMilesNode,r,a.hitch(this,this._toggleUnits)));this.own(k(this._useKilometersNode,r,a.hitch(this,this._toggleUnits)));this.own(k(this._getDirectionsButtonNode,r,a.hitch(this,this.getDirections)));this.own(k(this._clearDirectionsButtonNode,r,a.hitch(this,function(){this.clearDirections()})));var H=a.hitch(this,function(){clearTimeout(this._startTimeMenu._hideTimer);
this._startTimeMenu._hideTimer=setTimeout(a.hitch(this,function(){u.set(this._startTimeMenu,"display","none")}),100)});this.own(k(this._startTimeButtonNode,r,a.hitch(this,function(){this._startTimeButtonNode.disabled||"block"===u.get(this._startTimeMenu,"display")?u.set(this._startTimeMenu,"display","none"):(u.set(this._startTimeMenu,"display","block"),this["now"===this.startTime?"_startTimeMenuLeaveNow":"none"===this.startTime?"_startTimeMenuNone":"_startTimeMenuDepartAt"].focus())})));this.own(k(this._startTimeMenuLeaveNow,
"blur",H));this.own(k(this._startTimeMenuDepartAt,"blur",H));this.own(k(this._startTimeMenuNone,"blur",H));this.own(k(this._startTimeMenuLeaveNow,"mousedown",a.hitch(this,function(){this.startTime="now";this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this.own(k(this._startTimeMenuDepartAt,"mousedown",a.hitch(this,function(){this.startTime=(new Date).getTime();this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this.own(k(this._startTimeMenuNone,"mousedown",a.hitch(this,function(){this.startTime=
"none";this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this._symbolEventPaddingDirections=(new ea).setColor(new y([0,255,0,0])).setWidth(20).setCap(ea.CAP_ROUND);this._stopLayer=new ya({id:"directions_stopLayer_"+this.id,displayOnPan:!0});this._routeLayer=new ya({id:"directions_routeLayer_"+this.id,displayOnPan:!0});this._waypointsEventLayer=new ya({id:"directions_waypointsEventLayer_"+this.id,displayOnPan:!0});this._barriersLayer=new ya({id:"directions_barriersLayer_"+this.id,displayOnPan:!0});
this._polylineBarriersLayer=new ya({id:"directions_polylineBarriersLayer_"+this.id,displayOnPan:!0});this._polygonBarriersLayer=new ya({id:"directions_polygonBarriersLayer_"+this.id,displayOnPan:!0});this._barriersLayer.setRenderer(this.defaults.barrierRenderer);this._polylineBarriersLayer.setRenderer(this.defaults.polylineBarrierRenderer);this._polygonBarriersLayer.setRenderer(this.defaults.polygonBarrierRenderer);this.map&&(this.map.addLayer(this._routeLayer),this.map.addLayer(this._polygonBarriersLayer),
this.map.addLayer(this._polylineBarriersLayer),this.map.addLayer(this._barriersLayer),this.map.addLayer(this._stopLayer),this._externalTimeExtent=this.map.timeExtent);this._snappingManager=this.map.enableSnapping({layerInfos:[{layer:this._waypointsEventLayer,snapToVertex:!1,snapToPoint:!0,snapToEdge:!0}],tolerance:15});this._setWidgetProperties();var R=new N(null,this.waypointSymbol,{});H=a.hitch(this,function(){this._moveInProgress||this._solveInProgress||!R._isShown()||(this.editToolbar.deactivate(),
this._stopLayer.remove(R),clearTimeout(R._solveTimeout),R._solveTimeout=null,R.attributes.isWaypoint=!0,R._isStopIcon&&this.stopGraphics[R._index]&&(this._stopLayer.add(this.stopGraphics[R._index]),this._stopLayer.add(this.textGraphics[R._index])));R._showTooltip()});this._handle=a.mixin(R,{_isHandle:!0,_tooltip:I.create("div",{className:this.theme+" esriDirectionsRouteTooltip",onmouseover:H},this.map.container),_showTooltip:a.hitch(this,function(W){R._tooltip.style.display=!W||W instanceof MouseEvent?
"none":"inline";W&&(W="string"===typeof W?W:"\x3ctable class\x3d'esriRoutesTooltip'\x3e"+this._renderDirectionsItemTR(W)+"\x3c/table\x3e",R._tooltip.innerHTML!==W&&(R._tooltip.innerHTML=W))}),_isShown:a.hitch(this,function(){return-1<z.indexOf(this._stopLayer.graphics,R)}),_remove:H});this._activate(this.mapClickActive)},startup:function(){this.inherited(arguments);return this._enqueue(this._init)},destroy:function(){this.deactivate();this.map.removeLayer(this._barriersLayer);this.map.removeLayer(this._polylineBarriersLayer);
this.map.removeLayer(this._polygonBarriersLayer);this.map.removeLayer(this._routeLayer);this.map.removeLayer(this._stopLayer);this.map.removeLayer(this._waypointsEventLayer);this._disconnectEvents();I.empty(this.domNode);this.inherited(arguments)},activate:function(){return this._enqueue(function(){this.deactivateBarrierTool().then(a.hitch(this,function(){this.set("mapClickActive",!0)}))})},deactivate:function(){return this._enqueue(function(){this.deactivateBarrierTool().then(a.hitch(this,function(){this.set("mapClickActive",
!1)}))})},activateBarrierTool:function(){return this._enqueue(function(){this.set("mapClickActive",!1);this.set("barrierToolActive",!0)})},deactivateBarrierTool:function(){return this._enqueue(function(){this.set("mapClickActive",!1);this.set("barrierToolActive",!1)})},clearDirections:function(){return this._enqueue(function(){this.clearMessages();return this._clearDirections()})},reset:function(){return this._enqueue(this._reset)},modifyStopSequence:function(H,R){return this._enqueue(function(){return this._modifyStopSequence(H,
R)})},onActivate:function(){},onDeactivate:function(){},onActivateBarrierTool:function(){},onDeactivateBarrierTool:function(){},onLoad:function(){this._enableButton(this._getDirectionsButtonNode)},onDirectionsStart:function(){this._clearDisplayBeforeSolve();this.set("solving",!0);this._showLoadingSpinner(!0)},onDirectionsFinish:function(){this._showLoadingSpinner(!1);this.set("solving",!1)},onDirectionsClear:function(){},onSegmentSelect:function(){},onSegmentHighlight:function(){},onStopsUpdate:function(){},
onRouteItemCreated:function(){},onRouteItemUpdated:function(){},onFeatureCollectionCreated:function(){},onError:function(){},removeStops:function(){return this.reset()},removeStop:function(H,R,W){return this._enqueue(function(){this.clearMessages();return this._removeStop(H,R,W)})},updateStops:function(H){return this._enqueue(function(){return this._updateStops(H)})},addStops:function(H,R){return this._enqueue(function(){return this._addStops(H,R)}).then(a.hitch(this,this.zoomToFullRoute))},addStop:function(H,
R){return this._enqueue(function(){return this._addStop(H,R)},{_incrementalSolveStopRange:this._incrementalSolveStopRange})},updateStop:function(H,R,W){return this._enqueue(function(){return this._updateStop(H,R,W)},{_incrementalSolveStopRange:this._incrementalSolveStopRange})},setBarriers:function(H){this.routeParams.barriers=H;return this._getDirections().then(a.hitch(this,function(){this.zoomToFullRoute()}))},setPolylineBarriers:function(H){this.routeParams.polylineBarriers=H;return this._getDirections().then(a.hitch(this,
function(){this.zoomToFullRoute()}))},setPolygonBarriers:function(H){this.routeParams.polygonBarriers=H;return this._getDirections().then(a.hitch(this,function(){this.zoomToFullRoute()}))},clearMessages:function(){this.messages=[];this._msgNode&&(this._msgNode.innerHTML="")},getDirections:function(H){return this._enqueue(function(){return this._getDirections().then(a.hitch(this,function(){!0!==H&&this.zoomToFullRoute()}))})},selectSegment:function(H){if(!(!this.directions||!this.directions.features||
0>H||H>=this.directions.features.length))for(var R=v("[data-segment]",this._resultsNode),W=0;W<R.length;W++){var pa=parseInt(l.get(R[W],"data-segment"),10);if(H===pa&&R[W]!==this._focusedDirectionsItem){this._focusedDirectionsItem=R[W];this.centerAtSegmentStart(H);this.onSegmentSelect(this.directions.features[H]);R[W].focus();break}}},unhighlightSegment:function(H){var R=this._segmentGraphics;if(R&&(!this._focusedDirectionsItem||H)){for(H=0;H<R.length;H++)this._routeLayer.remove(R[H]);this._segmentGraphics=
[]}},highlightSegment:function(H,R){if(!(this._focusedDirectionsItem&&!R||H>=this.directions.features.length)){H=H||0;var W=a.hitch(this,function(hb){var fb=this.map.toMap({x:0,y:0});return this.map.toScreen(fb.offset(hb,0)).x}),pa=a.hitch(this,function(hb){for(var fb=0,nb=0;nb<hb.length;nb++)for(var qb=1;qb<hb[nb].length;qb++){var xb=hb[nb][qb-1],ub=hb[nb][qb];fb+=W(Math.sqrt((xb[0]-ub[0])*(xb[0]-ub[0])+(xb[1]-ub[1])*(xb[1]-ub[1])))}return fb}),ra=a.hitch(this,function(hb){var fb=this.map.toMap({x:0,
y:0});return this.map.toMap({x:hb,y:0}).x-fb.x}),Aa=function(hb,fb,nb){fb=Math.max(1,fb);for(var qb=nb?hb[0].length-1:0,xb=0,ub,pb,ob,mb=[[hb[0][nb?qb:0]]];nb&&0<qb||!nb&&qb<hb[0].length-1;){pb=hb[0][nb?qb-1:qb];ob=hb[0][nb?qb:qb+1];if(ub=W(Math.sqrt((pb[0]-ob[0])*(pb[0]-ob[0])+(pb[1]-ob[1])*(pb[1]-ob[1]))))if(xb+ub<fb)nb?mb[0].splice(0,0,pb):mb[0].push(ob),xb+=ub;else{fb=(fb-xb)/ub;nb?mb[0].splice(0,0,[ob[0]-(ob[0]-pb[0])*fb,ob[1]-(ob[1]-pb[1])*fb]):mb[0].push([pb[0]+(ob[0]-pb[0])*fb,pb[1]+(ob[1]-
pb[1])*fb]);break}qb+=nb?-1:1}return 0<xb+ub?mb:hb},Ba=this.get("directions").features[H],Ja=new xa(Ba.geometry),Ka=40*Math.PI/180;a.mixin(Ba.attributes,{_index:H});if(H){var Ra=Aa(this.get("directions").features[H-1].geometry.paths,25,!0),Va="esriDMTStop"!==Ba.attributes.maneuverType?Aa(Ja.paths,25,!1):Ra;Ra=Va!==Ra?[Ra[0].concat(Va[0])]:Va;var ab=(new xa(Va)).getExtent();if(1<Va[0].length&&15<=W(Math.max(ab.getWidth(),ab.getHeight()))){Aa=15*Math.cos(Ka/2);pa=15*Math.sin(Ka/2);var db=Va[0].length-
2;Ka=Va[0][db+1];for(ab=0;0<=db&&!ab;){var jb=Va[0][db];ab=W(Math.sqrt((jb[0]-Ka[0])*(jb[0]-Ka[0])+(jb[1]-Ka[1])*(jb[1]-Ka[1])));db--}22>ab&&(Va=ab+(22-ab)/3,db=ab+2*(22-ab)/3,db=[jb[0]+db/ab*(Ka[0]-jb[0]),jb[1]+db/ab*(Ka[1]-jb[1])],jb=[Ka[0]-Va/ab*(Ka[0]-jb[0]),Ka[1]-Va/ab*(Ka[1]-jb[1])],Ka=db,ab=22);Aa/=ab;Va=[Ka[0]-(Ka[0]-jb[0])*Aa,Ka[1]-(Ka[1]-jb[1])*Aa];jb[1]!==Ka[1]?(Aa=(Ka[0]-jb[0])/(Ka[1]-jb[1]),jb=ra(pa/Math.sqrt(1+Aa*Aa)),ra=Aa*jb):(jb=0,ra=ra(pa));Infinity===Math.abs(jb)||Infinity===Math.abs(ra)||
isNaN(jb)||isNaN(ra)||(Ra[0].push(Ka),Ra[0].push([Va[0]-jb,Va[1]+ra]),Ra[0].push([Va[0]+jb,Va[1]-ra]),Ra[0].push(Ka))}else Ra=Aa(Ra,2*pa(Va),!0);Ja.paths=Ra}this.unhighlightSegment(this._segmentGraphics&&this._segmentGraphics.length);ra=a.clone(this.routeSymbol).setWidth(this.segmentSymbol.width).setColor(new y([parseInt(.9*this.segmentSymbol.color.r),parseInt(.9*this.segmentSymbol.color.g),parseInt(.9*this.segmentSymbol.color.b)]));this._segmentGraphics=[new N(Ba.geometry,ra,Ba.attributes,this.get("segmentInfoTemplate")),
new N(Ja,this.routeSymbol,Ba.attributes,this.get("segmentInfoTemplate")),new N(Ja,this.segmentSymbol,Ba.attributes,this.get("segmentInfoTemplate"))];this.get("showSegmentHighlight")&&(this._routeLayer.add(this._segmentGraphics[0]),this._routeLayer.add(this._segmentGraphics[1]),this._routeLayer.add(this._segmentGraphics[2]));Ba=a.hitch(this,function(hb){if(0<hb&&hb<this.directions.features.length){hb=this.directions.features[hb]._associatedFeaturesWithWaypoints;for(var fb=0;fb<hb.length;fb++)hb[fb]._associatedSnapFeature&&
hb[fb]._associatedSnapFeature.getDojoShape()&&hb[fb]._associatedSnapFeature.getDojoShape().moveToFront()}});Ba(H-1);Ba(H);this.onSegmentHighlight(this.directions.features[H])}},zoomToSegment:function(H){var R=new K;if(this.directions&&this.directions.features){var W=Math.max(0,Math.min(this.directions.features.length-1,H||0));this.map.setExtent(this.get("directions").features[W].geometry.getExtent(),!0).promise.always(a.hitch(this,function(){this.highlightSegment(W);R.resolve()}))}else R.reject(Error("No directions."));
return R.promise},centerAtSegmentStart:function(H){var R=new K;if(this.directions&&this.directions.features){var W=Math.max(0,Math.min(this.directions.features.length-1,H||0));var pa=this.directions.features[W];this.map.centerAt(pa.geometry.getPoint(0,0)).promise.always(a.hitch(this,function(){this.highlightSegment(W,!0);this._showSegmentPopup(pa,W);R.resolve()}))}else R.reject(Error("No directions."));return R.promise},zoomToFullRoute:function(){var H=new K;this.directions&&this.directions.features?
(this._clearInfoWindow(),this.unhighlightSegment(),this.get("map").setExtent(this.get("directions").extent,!0).promise.always(H.resolve)):H.resolve();return H.promise},setListIcons:function(){var H,R=this._dnd.getAllNodes();for(H=0;H<R.length;H++){var W=v("."+this._css.stopIconClass,R[H])[0];W&&(W.innerHTML=this._getLetter(H));x.remove(R[H],this._css.stopOriginClass+" "+this._css.stopDestinationClass+" "+this._css.stopUnreachedClass+" "+this._css.stopUnreachedFirstOrLastClass);W=this._getStopSymbol(this.stops[H]);
W===this.fromSymbol?x.add(R[H],this._css.stopOriginClass):W===this.toSymbol?x.add(R[H],this._css.stopDestinationClass):W===this.unreachedSymbol&&x.add(R[H],this._css.stopUnreachedClass)}H=v("[data-reverse-td]",this._dndNode)[0];I.destroy(H);this.get("showReverseStopsButton")&&I.create("td",{"data-reverse-td":"true",rowspan:R.length,className:this._css.esriStopReverseColumnClass,innerHTML:'\x3cdiv role\x3d"button" class\x3d"'+this._css.reverseStopsClass+'" data-reverse-stops\x3d"true" title\x3d"'+
B.widgets.directions.reverseDirections+'"\x3e\x3c/div\x3e',onmouseover:function(pa){pa.stopPropagation()},onmouseout:function(pa){pa.stopPropagation()}},R[0])},addRouteSymbols:function(){if(this.stopGraphics.length){this._moveLayersToFront();for(var H=0;H<this.stopGraphics.length;H++)if(this.stopGraphics[H]&&(!this._handle._isShown()||this._handle._isShown()&&this._handle._index!==H)){this._stopLayer.add(this.stopGraphics[H]);var R=this.stopGraphics[H].getDojoShape();R&&R.moveToFront();this._stopLayer.add(this.textGraphics[H]);
(R=this.textGraphics[H].getDojoShape())&&R.moveToFront()}this._moveInProgress&&!this._handle.attributes.isWaypoint&&this._handle.getDojoShape()&&this._handle.getDojoShape().moveToFront()}},createRouteSymbols:function(){this._clearStopGraphics();for(var H=this.stops,R=function(Ja){var Ka={},Ra;for(Ra in Ja)Ja.hasOwnProperty(Ra)&&0===Ra.indexOf("Attr_")&&(Ka[Ra]=Ja[Ra]);return Ka},W=0;W<H.length;W++){var pa=H[W];if(pa&&pa.feature){var ra=pa.feature.attributes,Aa=ra?ra.Status:void 0,Ba=null;this._isStopAWaypoint(pa)||
(Ba=new za(this._getLetter(W),this.get("textSymbolFont"),this.get("textSymbolColor")),this.get("textSymbolOffset")&&Ba.setOffset(this.get("textSymbolOffset").x,this.get("textSymbolOffset").y));Ba=new N(pa.feature.geometry,Ba,{address:pa.name},this.get("stopsInfoTemplate"));Ba._isStopLabel=!0;Ba._index=W;pa=new N(pa.feature.geometry,this._getStopSymbol(pa),a.mixin({address:pa.name,Status:void 0===Aa?0:Aa,CurbApproach:ra&&ra.CurbApproach?ra.CurbApproach:null,TimeWindowStart:ra&&ra.TimeWindowStart?ra.TimeWindowStart:
null,TimeWindowEnd:ra&&ra.TimeWindowEnd?ra.TimeWindowEnd:null,isWaypoint:this._isStopAWaypoint(pa)},R(ra)),this.get(this._isStopAWaypoint(pa)?"waypointInfoTemplate":"stopsInfoTemplate"));pa._isStopIcon=!0;pa._index=W;this.stopGraphics[W]=pa;this.textGraphics[W]=Ba}}this.set("stopGraphics",this.stopGraphics);this.set("textGraphics",this.textGraphics);this._showBarriers();this.addRouteSymbols();this.setListIcons()},setTravelMode:function(H){return this._enqueue(function(){this.clearMessages();this._travelModeSelector.setValue(H);
return this._setTravelMode(H)})},getSupportedTravelModeNames:function(){var H=[],R=this.serviceDescription;if(R&&R.supportedTravelModes&&R.supportedTravelModes.length){R=R.supportedTravelModes;for(var W=0;W<R.length;W++)H.push(R[W].name)}return H},setDirectionsLengthUnits:function(){var H=1===arguments.length?arguments[0]:this.get("directionsLengthUnits");return this._enqueue(function(){this.clearMessages();return this._setDirectionsLengthUnits(H)})},setDirectionsLanguage:function(){var H=1===arguments.length?
arguments[0]:this.get("directionsLanguage");return this._enqueue(function(){this.clearMessages();return this._setDirectionsLanguage(H)})},useMyCurrentLocation:function(H){this.clearMessages();return this._createLocateButton(this.geocoders[H],!0,!0)},loadRoute:function(H){return this._enqueue(a.hitch(this,function(){return this._loadRoute(H)}))},_getStopsAttr:function(){return this.returnToStart&&this._returnToStartStop?this.stops.concat(this._returnToStartStop):this.stops},_getTravelModeNameAttr:function(){return this.routeParams&&
this.routeParams.travelMode&&this.routeParams.travelMode.name},_reset:function(){var H=this.mapClickActive||this.barrierToolActive;this._clearBarriersGraphics();this._setWidgetProperties();return this._init().then(a.hitch(this,function(){this.mapClickActive=!H;this.set("mapClickActive",H);this._searchSourceSelector&&this._searchSourceSelector.setValue("all")}))},_activate:function(){var H=this.get("mapClickActive"),R=a.hitch(this,function(W){for(var pa=W?[this.textGraphics,this.stopGraphics,this.displayedManeuverPointGraphics,
this.displayedRouteGraphics]:[this.displayedRouteGraphics,this.displayedManeuverPointGraphics,this.stopGraphics,this.textGraphics],ra=0;ra<pa.length;ra++)for(var Aa=pa[ra],Ba=0;Ba<Aa.length;Ba++){var Ja=Aa[Ba].getDojoShape();Ja&&Ja[W?"moveToBack":"moveToFront"].call(Ja)}});this.drawToolbar&&(this.barrierToolActive=!1,this.drawToolbar.deactivate(),x.remove(this._lineBarrierButtonNode,this._css.stopsPressedButtonClass));this._addStopOnMapClickListener&&this._addStopOnMapClickListener.remove();H?(this.map.activeDirectionsWidget&&
this.map.activeDirectionsWidget!==this&&this.map.activeDirectionsWidget.deactivate(),this.map.activeDirectionsWidget=this,this._addStopOnMapClickListener=k(this.map,"click",a.hitch(this,function(W){this.canModifyStops&&!this._solveInProgress&&(this.map.infoWindow.hide(),this.addStop(new N(W.mapPoint)))})),this.map.addLayer(this._waypointsEventLayer),this._moveLayersToFront(),x.add(this._activateButtonNode,this._css.stopsPressedButtonClass),this.onActivate()):(this.map.removeLayer(this._waypointsEventLayer),
x.remove(this._activateButtonNode,this._css.stopsPressedButtonClass),this.onDeactivate());R(!H);this.emit("map-click-active",{mapClickActive:this.mapClickActive})},_activateBarrierTool:function(){this.get("barrierToolActive")?(this.map.activeDirectionsWidget&&this.map.activeDirectionsWidget!==this&&this.map.activeDirectionsWidget.deactivate(),this.map.activeDirectionsWidget=this,this.drawToolbar.activate(fa.FREEHAND_POLYLINE),x.add(this._lineBarrierButtonNode,this._css.stopsPressedButtonClass),this.onActivateBarrierTool()):
(this.drawToolbar.deactivate(),x.remove(this._lineBarrierButtonNode,this._css.stopsPressedButtonClass),this.onDeactivateBarrierTool());this.emit("barrier-tool-active",{barrierToolActive:this.barrierToolActive})},_moveLayersToFront:function(){var H=this.get("map"),R=H.graphicsLayerIds.length-1;H.reorderLayer(this._routeLayer,R);H.reorderLayer(this._polygonBarriersLayer,R);H.reorderLayer(this._polylineBarriersLayer,R);H.reorderLayer(this._barriersLayer,R);H.reorderLayer(this._waypointsEventLayer,R);
H.reorderLayer(this._stopLayer,R)},_destroyGeocoders:function(){for(;this.geocoders&&this.geocoders.length;){if(this.geocoders[0])try{this.geocoders[0].destroy()}catch(H){}this.geocoders.splice(0,1)}this.geocoders=[]},_disconnectEvents:function(){var H=this._clearDirections(!0),R;if(this._watchEvents&&this._watchEvents.length)for(R=0;R<this._watchEvents.length;R++)this._watchEvents[R].unwatch();if(this._onEvents&&this._onEvents.length)for(R=0;R<this._onEvents.length;R++)this._onEvents[R].remove();
if(this._geocoderEvents)for(R=0;R<this._geocoderEvents.length;R++)this._geocoderEvents[R].value.unwatch(),this._geocoderEvents[R].blur.remove(),this._geocoderEvents[R].select.remove(),this._geocoderEvents[R].suggest.remove();this._onEvents=[];this._watchEvents=[];this._geocoderEvents=[];this._disconnectResults();this._destroyGeocoders();this._destroyGlobalGeocoder();this._destroyDnD();return H},_getDirections:function(){var H=new K;this._removeEmptyStops();1<this._getStopCount()+this._getWaypointCount()&&
this.loaded?(this.onDirectionsStart(),this.clearMessages(),this._dnd.sync(),this._sortGeocoders(),this._getCandidates(this.stops).then(a.hitch(this,function(R){this.stops=R;this._setStops();this._configureRoute().always(a.hitch(this,function(W){H.resolve(W)}))}),a.hitch(this,function(R){this.set("directions",null);this._clearRouteGraphics();H.reject(R);this.onDirectionsFinish(R)}))):this._clearDirections(!0).always(a.hitch(this,function(){this.createRouteSymbols();H.resolve()}));return H.promise},
_clearDirections:function(){var H=new K;this._handle&&this._handle._remove();this.get("routeParams")&&this.get("routeParams").stops?this.get("routeParams").stops.features.length?(this.get("routeParams").stops.features=[],this.onDirectionsClear(),H.resolve()):arguments.length?H.resolve():this._reset().then(H.resolve,H.reject):H.resolve();this.set("directions",null);this._clearDisplayBeforeSolve();this._clearDisplayAfterSolve();this._routeLayer.clear();this._waypointsEventLayer.clear();this._stopLayer.clear();
return H.promise},_setTravelMode:function(H){var R=new K,W=this.serviceDescription,pa=function(){R.resolve(H)};if(W&&W.supportedTravelModes&&W.supportedTravelModes.length){var ra=W.supportedTravelModes,Aa=!1;for(W=0;W<ra.length;W++)if(ra[W].name===H){Aa=!0;!this.routeParams.travelMode||this.routeParams.travelMode&&this.routeParams.travelMode.name!==H?(this.routeParams.travelMode=ra[W].impedanceAttributeName?ra[W]:ra[W].itemId,this._checkStartTimeUIAvailability(),this._solveAndZoom().always(pa)):pa();
this._travelModeSelector&&this._travelModeSelector.domNode&&(this._travelModeSelector.domNode.title=ra[W].description);break}Aa||R.reject(H)}else R.reject(H);return R.promise},_setDirectionsLengthUnits:function(H){this._clearDisplayBeforeSolve();var R=new K;x.remove(this._useMilesNode,this._css.stopsPressedButtonClass);x.remove(this._useKilometersNode,this._css.stopsPressedButtonClass);H===Z.KILOMETERS?x.add(this._useKilometersNode,this._css.stopsPressedButtonClass):H===Z.MILES&&x.add(this._useMilesNode,
this._css.stopsPressedButtonClass);H===Z.KILOMETERS||H===Z.METERS||H===Z.MILES||H===Z.FEET||H===Z.YARDS||H===Z.NAUTICAL_MILES?(this.directionsLengthUnits=H,R.resolve(H)):R.reject(H);return R.promise},_setDirectionsLanguage:function(H){this._clearDisplayBeforeSolve();var R=new K;H=this._setDirectionsLanguageByLocale(H);this._solveAndZoom().always(function(){R.resolve(H)},R.reject);return R.promise},_showLoadingSpinner:function(H){void 0===H&&(H=this._requestQueueTail&&!this._requestQueueTail.isFulfilled()||
this._moveInProgress);H?(x.add(this._widgetContainer,this._css.resultsLoadingClass),x.add(this._resultsNode,"esriRoutesContainerBusy")):(x.remove(this._widgetContainer,this._css.resultsLoadingClass),x.remove(this._resultsNode,"esriRoutesContainerBusy"))},_enqueue:function(H,R){var W=new K;this._requestQueueTail||(this._requestQueueTail=new K,this._requestQueueTail.resolve());this._requestQueueTail.promise.always(a.hitch(this,function(){try{a.mixin(this,{_incrementalSolveStopRange:null},R);var pa=
H.call(this);pa&&"object"===typeof pa&&pa.hasOwnProperty("isFulfilled")?pa.then(a.hitch(this,function(ra){W.resolve(ra);this._showLoadingSpinner()}),a.hitch(this,function(ra){W.reject(ra);this._showLoadingSpinner()})):(W.resolve(pa),this._showLoadingSpinner())}catch(ra){W.reject(ra),this._showLoadingSpinner()}}));this._requestQueueTail=W;this._showLoadingSpinner();return W.promise},_createDnD:function(){this._dnd=new ba(this._dndNode,{skipForm:!0,withHandles:!0})},_destroyDnD:function(){I.empty(this._dndNode);
this._dnd&&(this._dnd.destroy(),this._dnd=null)},_createDepartAtControls:function(){if(this._departAtTime)this.map&&this._restoreMapTimeExtent(),this._useTrafficItemNode.title=B.widgets.directions.trafficLabelLive,x.remove(this._departAtContainer,"departAtContainerVisible"),this.startTime="now",this._updateStartTimeUI();else{var H=this,R=function(){this._keepDirections||H._clearDisplayBeforeSolve();this._keepDirections=!1},W=a.hitch(this,function(){this.map&&this.map.disableKeyboardNavigation()}),
pa=a.hitch(this,function(){this.map&&this.map.enableKeyboardNavigation()});this._departAtTime=new e({required:!0,value:new Date,onChange:R,onFocus:W,onBlur:pa},this._departAtTimeContainer);this._departAtDate=new d({required:!0,value:new Date,onChange:R,onFocus:W,onBlur:pa,constraints:{min:new Date(864E5)}},this._departAtDateContainer)}},_setStartTime:function(H,R,W){if(isNaN(W))this.startTime="now"===W?W:"none";else{R=W instanceof Date?W:new Date(W);W=this.directions&&this.directions.features&&this.directions.features[0]&&
this.directions.features[0].attributes;var pa=6E4*-R.getTimezoneOffset();R=new Date(R-pa+(W&&W.arriveTimeUTC?W.ETA-W.arriveTimeUTC:pa));this._departAtTime._keepDirections=!H;this._departAtDate._keepDirections=!H;this._departAtTime.setValue(R);this._departAtDate.setValue(R)}this._updateStartTimeUI()},_checkStartTimeUIAvailability:function(){var H=this._getImpedanceAttribute();H=this._isTimeUnits(H?H.units:"")||this.serviceDescription&&10.6<=this.serviceDescription.currentVersion;this._startTimeButtonNode.disabled=
!H;x[H?"remove":"add"].apply(this,[this._startTimeButtonNodeContainer,"esriLinkButtonDisabled"]);x[H?"remove":"add"].apply(this,[this._startTimeDDLArrow,"esriDirectionsDDLArrowDisabled"]);H||this.set("startTime","now")},_usingAGOL:function(H){H||(H=this.routeTaskUrl);return-1<H.search(/^(https?:)*\/\/*[^.]*\.arcgis\.com.*$/i)},_usingRouteAGOL:function(){return-1<this.get("routeTaskUrl").search(/^(https?:)*\/\/route*[^.]*\.arcgis\.com.*$/i)},_setSearchOptions:function(){var H={map:this.get("map"),
autoNavigate:!1,enableInfoWindow:!1,enableHighlight:!1,enableSourcesMenu:!1};this.searchOptions=a.mixin({maxResults:1,locationToAddressDistance:100},this.defaults.searchOptions,H)},_setDefaultUnits:function(){if(!this.get("directionsLengthUnits")){var H="EN-US"===D.locale.toUpperCase()?Z.MILES:Z.KILOMETERS;this.defaults.directionsLengthUnits?H=this.defaults.directionsLengthUnits:this.userOptions.routeParams&&this.userOptions.routeParams.directionsLengthUnits&&(H=this.userOptions.routeParams.directionsLengthUnits);
this.set("directionsLengthUnits",H)}this._setDirectionsLengthUnits(this.directionsLengthUnits)},_setTrafficOptions:function(){this._usingRouteAGOL()&&!this.trafficLayer&&(this.trafficLayer=new na(ca+"//traffic.arcgis.com/arcgis/rest/services/World/Traffic/MapServer",{opacity:.4}));this.trafficLayer&&this.trafficLayer.url&&this._usingAGOL(this.trafficLayer.url)&&(this._trafficAvailabilityButton.style.display="inline-block");this.set("showTrafficOption",(this.defaults.showTrafficOption||!this.defaults.hasOwnProperty("showTrafficOption"))&&
!!this.trafficLayer);this._optionsMenu()},_updateCanModifyStops:function(H,R){this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!1);R||!this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!0);this._showAddDestination();this._showMapClickActiveButton();this._stopsTableCover.style.display=this.canModifyStops?"none":"inline"},_updateCanAddWaypoints:function(H,R){this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!1);R||this.canModifyStops||
!this.canModifyWaypoints||this.set("mapClickActive",!0);this._showMapClickActiveButton();this._handle._remove()},_updateStartTimeUI:function(){isNaN(this.startTime)?(this._startTimeButtonLabel.innerHTML="now"==this.startTime?this._i18n.widgets.directions.leaveNow:this._i18n.widgets.directions.noStartTime,x.remove(this._startTimeButtonNodeContainer,"departAtButton"),x.remove(this._departAtContainer,"departAtContainerVisible")):(x.add(this._startTimeButtonNodeContainer,"departAtButton"),x.add(this._departAtContainer,
"departAtContainerVisible"),this._startTimeButtonLabel.innerHTML=this._i18n.widgets.directions.departAt)},_setWidgetProperties:function(){this._disconnectEvents();this.set(this.defaults);this.routeLayer=a.clone(this.defaults.routeLayer);this._folderSelector&&(this._outputLayer.setValue(""),this._outputLayer.set("disabled",!0),this._folderSelector.set("disabled",!0));this.set("stops",[]);this._updateCanModifyStops()},_updateStops:function(H){var R=new K;H?this.get("loaded")?this._reset().then(a.hitch(this,
function(){this._addStops(H).then(R.resolve,R.reject)}),R.reject):this._addStops(H).then(R.resolve,R.reject):R.reject();return R.promise},_removeStop:function(H,R,W,pa){var ra=new K,Aa=a.hitch(this,function(Ja){this.stops.splice(Ja,1);var Ka=this._dnd.getAllNodes()[Ja],Ra=this.get("geocoders");this._geocoderEvents[Ka.id]&&(this._geocoderEvents[Ka.id].blur.remove(),this._geocoderEvents[Ka.id].select.remove(),this._geocoderEvents[Ka.id].suggest.remove(),this._geocoderEvents[Ka.id].value.unwatch());
Ra[Ja].destroy();Ra.splice(Ja,1);this.set("geocoders",Ra);I.destroy(Ka);this._dnd.sync();this._stopsRemovable();this._optionsMenu();this._checkMaxStops();this.setListIcons();this._sortGeocoders()});if(0>H||H>=this.stops.length||void 0===H)H=this.stops.length-1;var Ba=!1;for(pa=this.stopGraphics[H]&&this._isStopAWaypoint(this.stops[H])||pa;!Ba;)Aa(H),pa?Ba=!0:(H-=0>=H||H<this.stops.length&&this._isStopAWaypoint(this.stops[H])?0:1,Ba=!this._isStopAWaypoint(this.stops[H]));for(;this.stops.length-this._getWaypointCount()<
this.minStops;)this._addStop();this._clearStopsStatusAttr();this._setStops();this.createRouteSymbols();W?(this._clearDisplayBeforeSolve(),this._clearDisplayAfterSolve(),this.createRouteSymbols(),ra.resolve()):this._solveAndZoom(R).then(ra.resolve,ra.reject);return ra.promise},_removeTrafficLayer:function(){this.trafficLayer&&this.map&&this.map.removeLayer(this.trafficLayer);this._trafficLayerAdded=!1},_addStops:function(H,R){var W=new K,pa=[],ra=this.autoSolve;this.autoSolve=!1;void 0===R&&(R=this._getStopCount());
for(var Aa=0;Aa<Math.min(H.length,this.maxStops-this._getStopCount());Aa++){var Ba=new K;this._addStop(H[Aa],R+Aa,!0).always(Ba.resolve);pa.push(Ba)}L(pa).always(a.hitch(this,function(){this.autoSolve=ra;this._getDirections().always(function(){W.resolve(H)})}));return W.promise},_addStop:function(H,R,W){var pa=new K;this._checkMaxStops();this.maxStopsReached?(this._showMessage(B.widgets.directions.error.maximumStops),pa.reject(Error(B.widgets.directions.error.maximumStops))):(void 0===H&&void 0===
R&&(R=this.stops.length),H instanceof N&&H.attributes&&H.attributes.isWaypoint&&(!R||R===this.stops.length||2>this._getStopCount())&&!W?(this._showMessage(B.widgets.directions.error.waypointShouldBeInBetweenStops),pa.reject(Error(B.widgets.directions.error.waypointShouldBeInBetweenStops))):this._getCandidate(H).then(a.hitch(this,function(ra){this._isStopAWaypoint(ra)&&ra&&ra.feature&&(ra.feature.attributes=a.mixin({},ra.feature.attributes,{isWaypoint:!0,CurbApproach:3}));this._insertStop(ra,R);this.autoSolve&&
""!==ra.name?this._getDirections().always(function(){pa.resolve(ra,R)}):pa.resolve(ra,R)}),a.hitch(this,function(ra){pa.reject(ra)})));return pa.promise},_removeEmptyStops:function(){for(var H=0,R=this.stops.length-this._getWaypointCount()-this.minStops;H<this.stops.length&&0<R;)this.stops[H]&&this.stops[H].name?H++:(this._removeStop(H,!0,!0,!0),R--,this._moveInProgress&&this._handle._index>=H&&this._handle._isStopIcon&&this._handle._index--)},_setReverseGeocode:function(H,R,W){if(H.feature.geometry&&
-1<W){var pa={address:H.name};this.stopGraphics[W]&&(a.mixin(this.stopGraphics[W].attributes,pa),this.stopGraphics[W].setGeometry(R));this.textGraphics[W]&&(a.mixin(this.textGraphics[W].attributes,pa),this.textGraphics[W].setGeometry(R));this.set("stopGraphics",this.stopGraphics);this.set("textGraphics",this.textGraphics);(pa=this.geocoders[W])&&pa.inputNode&&(pa.value=H.name,pa.inputNode.value=H.name);a.mixin(H.feature.attributes,this.stops[W].feature.attributes);this.stops[W]=H;this.stops[W].feature.setGeometry(R);
this._setStops();return this._enqueue(function(){return this._getDirections()})}},_insertStop:function(H,R){var W;if(void 0===R)for(W=0;W<this.geocoders.length;W++){if(!this.geocoders[W].get("value")){var pa=this.geocoders[W];break}}else W=R,this.geocoders[W]&&!this.geocoders[W].get("value")&&(pa=this.geocoders[W]);!pa||void 0!==R&&R!==W||this._isStopAWaypoint(H)?(void 0===R&&(R=this.geocoders.length),this.stops.splice(R,0,H),this._createGeocoder(H,R)):(this.stops[W]=H,pa.set("value",H.name),pa._stopReference=
H);this._optionsMenu()},_createGeocoder:function(H,R){var W=this._dnd.getAllNodes(),pa=!1,ra=!1,Aa=W.length;W[R]?(ra=W[R],pa=!0):pa=ra=!1;var Ba=a.hitch(this,function(Va,ab){var db=ab?this._css.stopDnDHandleClass:this._css.stopDnDHandleClassHidden,jb=ab?this._css.stopDnDHandleClassHidden:this._css.stopDnDHandleClass;x.replace(Va.children[0],db,jb);2<this.geocoders.length&&(db=ab?this._css.stopIconRemoveClass:this._css.stopIconRemoveClassHidden,jb=ab?this._css.stopIconRemoveClassHidden:this._css.stopIconRemoveClass,
x.replace(Va.children[3].children[0],db,jb))}),Ja=I.create("tr",{className:this._css.stopClass,style:this._isStopAWaypoint(H)?"display:none;":"",onmouseover:function(){Ba(this,!0)},onmouseout:function(){Ba(this,!1)}});I.create("td",{className:this._css.stopDnDHandleClassHidden+" dojoDndHandle"},Ja);W=I.create("td",{className:this._css.stopIconColumnClass},Ja);I.create("div",{className:this._css.stopIconClass+" dojoDndHandle",innerHTML:this._getLetter(Aa),"data-center-at":"true"},W);Aa=I.create("td",
{className:this._css.esriStopGeocoderColumnClass},Ja);Aa=I.create("div",{},Aa);W=I.create("td",{className:this._css.stopIconRemoveColumnClass},Ja);I.create("div",{className:this._css.stopIconRemoveClassHidden,role:"button","data-remove":"true"},W);this._dnd.insertNodes(!1,[Ja],pa,ra);pa=a.mixin({},this.get("searchOptions"),{value:H.name,activeSourceIndex:this._globalGeocoder.activeSourceIndex});var Ka=new va(pa,Aa),Ra=a.hitch(this,function(Va,ab){this._enqueue(function(){if(ab!==Va&&Ka._stopReference&&
Ka._stopReference.name!==ab){var db=z.indexOf(this.stops,Ka._stopReference);this.stops[db]={name:ab};this._handle._remove();this._removeSomeWaypoints(this._markWPsForRemovalAfterUserChangedStopSequence(db));this._setStops();this._clearDisplayBeforeSolve();this._clearDisplayAfterSolve();this.createRouteSymbols()}})});Ka._tr=Ja;Ka._stopReference=H;Ka.startup();this.geocoders.splice(R,0,Ka);this._geocoderEvents[Ja.id]={blur:Ka.on("blur",function(){""!==this.value&&this._stopReference&&!this._stopReference.feature&&
this.search()}),select:Ka.on("select-result",a.hitch(this,function(Va){var ab=!0;if(Va&&(Va.results||Va.result)){var db=this._dnd.getAllNodes();db=z.indexOf(db,Ja);var jb=Ka.value,hb=Va.results&&Va.results.results&&Va.results.results.length?Va.results.results[0]:Va.result;hb?(hb.name=jb,this.stops[db]=this._toPointGeometry(hb),this.geocoders[db]._stopReference=this.stops[db],Ra("",jb)):(this.removeStop(db),this.set("directions",null),this._showMessage(B.widgets.directions.error.unknownStop.replace("\x3cname\x3e",
Va.target.get("value"))),this._clearRouteGraphics(),ab=!1);ab&&this.getDirections()}})),suggest:Ka.on("suggest-results",function(){if(document.activeElement===this.inputNode)for(var Va=v("LI[role\x3d'menuitem']",this.suggestionsNode),ab=0;ab<Va.length;ab++)l.set(Va[ab],"tabindex",-1);else this._hideSuggestionsMenu()}),value:Ka.watch("value",function(Va,ab,db){Ra(ab,db)})};this._checkMaxStops();this.setListIcons();this._stopsRemovable();this._optionsMenu();this._sortGeocoders()},_blurGeocoders:function(){if(document.activeElement)for(var H=
0;H<this.geocoders.length;H++)if(this.geocoders[H].inputNode===document.activeElement){this.geocoders[H]._hideSuggestionsMenu();this.geocoders[H].inputNode.blur();1<this._getStopCount()+this._getWaypointCount()&&this.getDirections(!0);break}},_decorateEmptyAGOLGeocoderResponse:function(H){H&&", , "===H.name&&(H.name=H.feature&&H.feature.attributes&&H.feature.attributes.Match_addr?H.feature.attributes.Match_addr+("POI"===H.feature.attributes.Addr_type&&H.feature.attributes.City&&-1===H.feature.attributes.Match_addr.indexOf(H.feature.attributes.City)?
", "+H.feature.attributes.City:""):"");return H},_toPointGeometry:function(H){var R=H.feature.geometry;R&&(R.getCentroid?H.feature.geometry=R.getCentroid():R.getExtent&&(R=R.getExtent())&&(H.feature.geometry=R.getCenter()));return H},_removeLocateButtonVisibilityEvents:function(){for(var H=0;H<this.geocoders.length;H++){var R=this.geocoders[H];R._onMouseEnter&&R._onMouseEnter.remove();R._onMouseOut&&R._onMouseOut.remove();R._onKeyPress&&R._onKeyPress.remove();R._locateButton&&(R._locateButton._onMouseEnter&&
R._locateButton._onMouseEnter.remove(),R._locateButton._onMouseOut&&R._locateButton._onMouseOut.remove())}},_setLocateButtonVisibilityEvents:function(){this._removeLocateButtonVisibilityEvents();for(var H=this,R=function(Ka){Ka instanceof FocusEvent?this._geocoder._lbShown_f=!0:this._geocoder._lbShown_g=!0;H._createLocateButton(this._geocoder,!0)},W=function(Ka){Ka instanceof FocusEvent?this._geocoder._lbShown_f=!1:this._geocoder._lbShown_g=!1;clearTimeout(this._destroyTimeout);this._destroyTimeout=
setTimeout(a.hitch(this,function(){this._geocoder._lbShown_lb||this._geocoder._lbShown_f||H._destroyLocateButton(this._locateButton)}),400)},pa=function(){this._geocoder._lbShown_g=!0;clearTimeout(this._destroyTimeout);this._destroyTimeout=setTimeout(a.hitch(this,function(){""===this.value?H._createLocateButton(this._geocoder,!0):H._destroyLocateButton(this._locateButton)}),400)},ra=function(){this._geocoder._lbShown_lb=!0;clearTimeout(this._geocoder._destroyTimeout)},Aa=function(){this._geocoder._lbShown_lb=
!1;clearTimeout(this._geocoder._destroyTimeout);this._geocoder._destroyTimeout=setTimeout(a.hitch(this,function(){this._geocoder._lbShown_g||this._geocoder._lbShown_f||H._destroyLocateButton(this._geocoder.inputNode._locateButton)}),400)},Ba=0;Ba<this.geocoders.length;Ba++){var Ja=this.geocoders[Ba];Ja&&Ja.inputNode&&(Ja.inputNode._geocoder=Ja,Ja._onMouseEnter=k(Ja.inputNode,w.enter,R),Ja._onMouseOut=k(Ja.inputNode,[w.leave,"blur"],W),Ja._onKeyPress=k(Ja.inputNode,"keydown",pa),Ja.inputNode._locateButton&&
(Ja=Ja.inputNode._locateButton,Ja._onMouseEnter=k(Ja.domNode,w.enter,ra),Ja._onMouseOut=k(Ja.domNode,w.leave,Aa)))}},_createLocateButton:function(H,R,W){var pa=new K;H.inputNode._locateButton&&H.inputNode._locateButton._locating?pa.resolve():F(["./LocateButton"],a.hitch(this,function(ra){this._destroyLocateButton(H.inputNode._locateButton);if(H&&!this._solveInProgress){var Aa=I.create("div",{},H.domNode);x.add(H.domNode,this._css.stopsInnerGeocoderClass);var Ba=new ra({map:this.map,highlightLocation:!1,
centerAt:!1,setScale:!1,useTracking:!1},Aa);Ba.startup();H.inputNode._locateButton=Ba;Ba.domNode._geocoder=H;this._setLocateButtonVisibilityEvents();ra=a.hitch(this,function(){Ba._locating=!0;H.set("value","");H.inputNode.placeholder=B.widgets.directions.retrievingMyLocation.toUpperCase()});Ba._onBeforeLocate=k(Ba._locateNode,r,ra);Ba._onLocate=k(Ba,"locate",a.hitch(this,function(Ja){Ba._locating=!1;Ja.graphic?(R&&this._destroyLocateButton(H.inputNode._locateButton),this.updateStop(new N(Ja.graphic.geometry),
z.indexOf(this.geocoders,H)).then(a.hitch(this,function(){1<this.stopGraphics.length?this.getDirections().always(function(){pa.resolve(Ja)}):pa.resolve(Ja)}))):(H.set("value",""),H.inputNode.placeholder=B.widgets.directions.myLocationError.toUpperCase(),pa.reject(Ja.error))}));W?(ra(),Ba.locate().then(null,pa.reject)):pa.resolve()}else pa.resolve()}));return pa.promise},_destroyLocateButton:function(H){if(H){var R=H.domNode._geocoder;clearTimeout(R._destroyTimeout);H._locating?R._destroyTimeout=setTimeout(a.hitch(this,
function(){R._lbShown_lb||R._lbShown_f||this._destroyLocateButton(H)}),100):(H.clear(),H._onBeforeLocate.remove(),H._onLocate.remove(),H._onMouseEnter&&H._onMouseEnter.remove(),H._onMouseOut&&H._onMouseOut.remove(),H.destroy(),R.inputNode&&(R.inputNode._locateButton=null,R._setPlaceholder(R.activeSourceIndex)))}},_sortStops:function(){this.stops.length&&(this.stops.sort(a.hitch(this,function(H,R){for(var W,pa,ra=0;ra<this.get("geocoders").length;ra++)this.geocoders[ra]._stopReference===H?W=ra:this.geocoders[ra]._stopReference===
R&&(pa=ra);return W>pa?1:pa>W?-1:0})),this._setStops())},_getCandidate:function(H){var R=new K,W=typeof H;H?"object"===W&&H.hasOwnProperty("feature")&&H.hasOwnProperty("name")?(H.feature.attributes&&void 0!==H.feature.attributes.displayName&&!this._isStopAWaypoint(H)&&(H.name=H.feature.attributes.displayName,H.feature.attributes.Name=this._userDefinedStopName),H.name=this._isStopAWaypoint(H)?this._waypointName:String(H.name),"point"!==H.feature.geometry.type&&(H.feature.geometry=new X([H.feature.geometry.x,
H.feature.geometry.y],this.map.spatialReference)),R.resolve(H)):"object"===W&&H.hasOwnProperty("address")&&H.hasOwnProperty("location")?(H=this._globalGeocoder._hydrateResult(H),R.resolve(H)):"object"!==W||!H.hasOwnProperty("name")||null!==H.name&&""!==H.name?H instanceof N&&H.attributes&&(void 0!==H.attributes.Name||H.attributes.isWaypoint)?(W=this._addStopWrapperToGraphic(H,H.attributes.isWaypoint?this._waypointName:String(H.attributes.Name)),String(H.attributes.Name)&&(W.feature.attributes.Name=
this._userDefinedStopName),R.resolve(W)):("object"===W&&H.hasOwnProperty("name")&&(H=String(H.name)),this._reverseGeocode(H).then(R.resolve,R.reject)):R.resolve(a.clone(this._emptyStop)):R.resolve(a.clone(this._emptyStop));return R.promise},_reverseGeocode:function(H){var R=new K,W,pa=H.geometry?H.geometry:H;if(this._globalGeocoder){var ra=a.hitch(this,function(Ka){var Ra=new K,Va=500;if(this.map){var ab=this.map.toScreen(pa);ab.x+=ja._calculateClickTolerance([Ka]);this.map.spatialReference.isWebMercator()?
(Va=Math.abs(this.map.toMap(ab).x-pa.x),Ra.resolve(Va)):4326===this.map.spatialReference.wkid?(Va=Math.abs(S.geographicToWebMercator(this.map.toMap(ab)).x-S.geographicToWebMercator(pa).x),Ra.resolve(Va)):this._geometryService&&(Ka=new aa,Ka.distanceUnit=La.UNIT_METER,Ka.geometry1=pa,Ka.geometry2=this.map.toMap(ab),this._geometryService.distance(Ka,function(db){Va=db;Ra.resolve(Va)},function(){Ra.resolve(Va)}))}return Ra.promise}),Aa=[],Ba=this._globalGeocoder.sources,Ja=function(){Ba[W].featureLayer&&
Aa.push(ra(Ba[W].featureLayer).then(a.hitch(Ba[W],function(Ka){this.searchQueryParams=a.mixin(this.searchQueryParams,{distance:Ka})})))};if("all"===this._globalGeocoder.activeSourceIndex)for(W=0;W<Ba.length;W++)Ja();else W=this._globalGeocoder.activeSourceIndex,Ja();L(Aa).always(a.hitch(this,function(){this._globalGeocoder.search(pa).then(a.hitch(this,function(Ka){var Ra=!1;if(Ka){var Va=null;for(W=0;W<this._globalGeocoder.sources.length;W++)if(Ka[W]&&Ka[W].length){var ab=Ka[W];break}if(ab.length&&
(Ra=!0,Va=ab[0],this._globalGeocoder.sources[W].featureLayer))for(Ka=Number.POSITIVE_INFINITY,W=0;W<ab.length;W++){ab[W]=this._toPointGeometry(ab[W]);var db=ma.geodesicLengths([new xa({paths:[[S.xyToLngLat(pa.x,pa.y),S.xyToLngLat(ab[W].feature.geometry.x,ab[W].feature.geometry.y)]],spatialReference:{wkid:this.map.spatialReference.wkid}})],"esriMeters")[0];Ka>db&&(Ka=db,Va=ab[W])}(Va=this._decorateEmptyAGOLGeocoderResponse(Va))&&""!==Va.name&&null!==Va.name&&void 0!==Va.name?(Va.name=String(Va.name),
isNaN(pa.x)||isNaN(pa.y)||this.map.spatialReference.wkid!==pa.spatialReference.wkid?!Va.feature.geometry||isNaN(Va.feature.geometry.x)||isNaN(Va.feature.geometry.y)?(this._showMessage(B.widgets.directions.error.locator),R.reject(Error(B.widgets.directions.error.locator))):R.resolve(Va):(Va.feature.geometry=pa,R.resolve(Va))):Ra=!1}Ra||(H instanceof X?H=new N(H):H instanceof Array&&(H=new N(new X(H[0],H[1]))),H instanceof N?this._decorateUngeocodedStop(H).then(R.resolve,R.reject):(this._showMessage(B.widgets.directions.error.unknownStop.replace("\x3cname\x3e",
H.toString())),R.reject(Error(B.widgets.directions.error.unknownStop.replace("\x3cname\x3e",H.toString())))))}))}))}else this._showMessage(B.widgets.directions.error.locatorUndefined),R.reject(Error(B.widgets.directions.error.locatorUndefined));return R.promise},_updateStop:function(H,R,W){var pa=new K;this.stops&&this.stops[R]?H instanceof N&&H.attributes&&H.attributes.isWaypoint&&(!R||R===this.stops.length-1||2>this._getStopCount())?(this._showMessage(B.widgets.directions.error.waypointShouldBeInBetweenStops),
pa.reject(Error(B.widgets.directions.error.waypointShouldBeInBetweenStops))):this._getCandidate(H).then(a.hitch(this,function(ra){var Aa=ra.feature;Aa=Aa?Aa.geometry:null;var Ba=this.stops[R].feature;Ba=Ba?Ba.geometry:null;Aa=Aa&&Ba&&(Aa.x!==Ba.x||Aa.y!==Ba.y)||!Aa&&Ba;this.stops[R]=ra;this.geocoders[R]||this._createGeocoder(ra,R);Ba=this.geocoders[R];Ba._stopReference=ra;Ba._tr.style.display=this._isStopAWaypoint(ra)?"none":"";Ba.value=ra.name;Ba.inputNode&&(Ba.inputNode.value=ra.name);Aa&&this.autoSolve&&
1<this._getStopCount()+this._getWaypointCount()||W?this._getDirections().then(pa.resolve,pa.reject):(this._setStops(),pa.resolve(ra))}),a.hitch(this,function(ra){pa.reject(ra)})):(this._showMessage(B.widgets.directions.error.couldNotUpdateStop),pa.reject(Error(B.widgets.directions.error.couldNotUpdateStop)));this._optionsMenu();return pa.promise},_renderDirections:function(){var H=this.get("directions");if(this._resultsNode){var R='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e';R+=this._renderDirectionsSummary(H);
R+='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e';R+='\x3cdiv class\x3d"'+this._css.routesClass+'"\x3e';R+=this._renderDirectionsTable(H);R+="\x3c/div\x3e";this._resultsNode&&(this._resultsNode.innerHTML=R);this._disconnectResults();(H=v("[data-segment]",this._resultsNode))&&H.length&&z.forEach(H,a.hitch(this,function(W){this._resultEvents.push(k(W,w.enter,a.hitch(this,function(){if(!this._focusedDirectionsItem){var pa=parseInt(l.get(W,"data-segment"),10);this.highlightSegment(pa)}})));
this._resultEvents.push(k(W,"focusout",a.hitch(this,function(){this._focusedDirectionsItem=null;this.unhighlightSegment(!0)})));this._resultEvents.push(k(W,w.leave,this.unhighlightSegment));this._resultEvents.push(k(W,"click, keydown",a.hitch(this,function(pa){pa&&("click"===pa.type||"keydown"===pa.type&&pa.keyCode===h.ENTER)&&(this._focusedDirectionsItem!==W?this.selectSegment(parseInt(l.get(W,"data-segment"),10)):(W.blur(),this.map.infoWindow.hide(),this._focusedDirectionsItem=null,this.unhighlightSegment(!0)))})))}))}},
_renderDirectionsSummary:function(H){var R="",W=a.hitch(this,function(){for(var Ba={},Ja=this._getDirectionsTimeAttribute()||{},Ka=this._getTimeNeutralAttribute()||{},Ra=0,Va=0,ab=this.get("stops"),db=ab.length-1;0<=db;db--)if(null!==ab[db].feature.attributes.ArriveCurbApproach){Ba=ab[db].feature.attributes;break}for(var jb in Ba)Ba.hasOwnProperty(jb)&&(jb==="Cumul_"+Ja.name&&(Ra=Ba[jb]),jb==="Cumul_"+Ka.name&&(Va=Ba[jb]));Ba="esriTrafficLabelHidden";ab=B.widgets.directions.noTraffic;db=H.totalTime-
H.totalDriveTime;db=(Va-this._convertCostValue(db,Ja.units,Ka.units))/(Ra-db||1);0<db&&.8>db?(Ba="esriTrafficLabelHeavy",ab=B.widgets.directions.heavyTraffic):1===db?(Ba="esriTrafficLabelNone",ab=B.widgets.directions.noTraffic):1.25<db&&(Ba="esriTrafficLabelLight",ab=B.widgets.directions.ligthTraffic);Ka=this._formatTime(Va,!1,Ka.units);return{label:ab,labelClass:Ba,ratio:db,noTrafficCostStr:1!==db&&Ka?Ka+" "+B.widgets.directions.onAverage+"\x3cbr\x3e":"",trafficCost:Ra,noTrafficCost:Va,timeAtt:Ja}});
if(H.totalLength||H.totalTime){W=W();var pa=this._getImpedanceAttribute();R+="\x3cdiv class\x3d'"+this._css.resultsSummaryClass+"' data-full-route\x3d'true'\x3e\x3cdiv class\x3d'esriImpedanceCost'\x3e";if(this._isTimeUnits(pa.units))R+=this._formatTime(W.trafficCost,!0,W.timeAtt.units)+"\x3cdiv class\x3d'esriImpedanceCostHrMin'\x3e\x3cdiv class\x3d'esriImpedanceCostHr'\x3e"+B.widgets.directions.time.hr+"\x3c/div\x3e\x3cdiv class\x3d'esriImpedanceCostMin'\x3e"+B.widgets.directions.time.min+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriOtherCosts'\x3e"+
(W.noTrafficCost?"\x3cdiv class\x3d'esriTrafficLabel "+W.labelClass+"'\x3e"+W.label+"\x3c/div\x3e"+W.noTrafficCostStr:"")+this._formatDistance(H.totalLength);else{pa=(pa=B.widgets.directions.units[this.directionsLengthUnits])?pa.name:"";var ra=this.serviceDescription&&10.6<=this.serviceDescription.currentVersion,Aa=this.directions.features[0].attributes;R+=A.format(H.totalLength,{places:1})+"\x3cdiv class\x3d'esriImpedanceCostDist'\x3e"+pa+"\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriOtherCosts'\x3e"+
(W.noTrafficCost&&ra?"\x3cdiv class\x3d'esriTrafficLabel "+W.labelClass+"'\x3e"+W.label+"\x3c/div\x3e"+W.noTrafficCostStr:"")+this._formatTime(H.totalTime)+" "+("none"!==this.startTime&&W.noTrafficCost&&ra?B.widgets.directions.atTheMoment+" "+this._toSpatiallyLocalTimeString(Aa.arriveTimeUTC,Aa.ETA):"")}R+="\x3c/div\x3e\x3c/div\x3e"}return R},_renderDirectionsTable:function(H){for(var R=0,W=0,pa=0,ra='\x3ctable summary\x3d"'+H.routeName+'"\x3e\x3ctbody role\x3d"menu"\x3e',Aa=0;Aa<H.features.length;Aa++){var Ba=
H.features[Aa].attributes;"esriDMTDepart"===Ba.maneuverType&&(W=pa=0);pa+=Ba.length;W+=Ba.time;R+=Ba.time;ra+=this._renderDirectionsItemTR(H.features[Aa],pa,W,R)}return ra+"\x3c/tbody\x3e\x3c/table\x3e"},_renderDirectionsItemTR:function(H,R,W,pa){var ra=this.directions,Aa=ra?z.indexOf(ra.features,H):-1;pa="";var Ba=this._css.routeClass,Ja=H._associatedStopWithReturnToStart&&H._associatedStopWithReturnToStart.attributes,Ka=H.attributes;if(-1<Aa){Ka&&(Ka.step=Aa+1);Ka.maneuverType&&(Ba+=" "+Ka.maneuverType);
Ja&&null===Ja.ArriveCurbApproach&&null!==Ja.DepartCurbApproach?Ba+=" "+this._css.routeOriginClass:Ja&&null!==Ja.ArriveCurbApproach&&null===Ja.DepartCurbApproach&&(Ba+=" "+this._css.routeDestinationClass+" "+this._css.routeLastClass);pa+='\x3ctr tabindex\x3d"0" role\x3d"menuitem" class\x3d"'+Ba+" "+this._css.routeZoomClass+'" data-segment\x3d"'+Aa+'"\x3e';pa+='\x3ctd class\x3d"'+this._css.routeIconColumnClass+'"\x3e';pa+='\x3cdiv class\x3d"'+this._css.routeIconClass+'"\x3e';pa+=this._getLetter(H._associatedStop);
pa=pa+'\x3c/div\x3e\x3c/td\x3e\x3ctd class\x3d"'+(this._css.routeTextColumnClass+'"\x3e');pa+='\x3cdiv class\x3d"'+this._css.routeInfoClass+'"\x3e';pa+='\x3cdiv class\x3d"'+this._css.routeTextClass+'"\x3e';H=(ra.strings[Aa]||[]).slice();if("esriDMTDepart"===Ka.maneuverType||"esriDMTStop"===Ka.maneuverType)for(ra=0;ra<this.stops.length;ra++)this.stops[ra]&&this.stops[ra].name&&H.push({string:this.stops[ra].name});if(H){Ba=Ka.text;for(ra=0;ra<H.length;ra++)Ba=this._boldText(Ba,H[ra].string);Ka.formattedText=
Ba}else Ka.formattedText=Ka.text;if("esriDMTStop"===Ka.maneuverType&&(R||W)||"esriDMTDepart"===Ka.maneuverType&&0===Aa)R=this._formatDistance(R-Ka.length,!0),W=this._formatTime(W-Ka.time),Aa=this._formatTime(Ka.time),H=this._formatDistance(Ka.length,!0),Ka.formattedText+="\x3cdiv class\x3d'esriRouteTextColumnCumulative'\x3e"+R+(R&&W?" \x26middot; ":"")+W+(R||W?"\x3cbr\x3e":"")+(Aa?B.widgets.directions.serviceTime+":\x26nbsp;"+Aa:"")+(Aa&&H?"\x3cbr\x3e":"")+(H?B.widgets.directions.serviceDistance+
":\x26nbsp;"+H:"")+"\x3c/div\x3e";pa+="\x3cstrong\x3e"+A.format(Ka.step)+".\x3c/strong\x3e "+Ka.formattedText;pa+="\x3c/div\x3e";R=this._formatDistance(Ka.length,!0);W=this._formatTime(Ka.time);"esriDMTStop"!==Ka.maneuverType&&"esriDMTDepart"!==Ka.maneuverType||!this.routeParams.startTime||-22091616E5===Ka.ETA?R&&(pa+='\x3cdiv class\x3d"'+this._css.routeLengthClass+'"\x3e',pa+=R,W&&(pa+="\x26nbsp;\x26middot;\x3cwbr\x3e\x26nbsp;"+W),pa+="\x3c/div\x3e"):pa+='\x3cdiv class\x3d"'+this._css.routeLengthClass+
'"\x3e'+this._toSpatiallyLocalTimeString(Ka.arriveTimeUTC,Ka.ETA)+"\x3c/div\x3e";pa+="\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e"}return pa},_toSpatiallyLocalTimeString:function(H,R){var W=new Date(R),pa=new Date(W.getTime()+6E4*W.getTimezoneOffset());pa=D.date.locale.format(pa,{selector:"time"});var ra="";H?(ra=(R-H)/1E3/60/60,W=Math.floor(ra),ra=60*(ra-W),W=B.widgets.directions.GMT+(0>W?"":"+")+A.format(W,{pattern:"00"})+A.format(ra,{pattern:"00"}),ra=pa+" "+W):ra="now"===this.startTime?D.date.locale.format(W,
{selector:"time"}):pa;return ra},_addStopWrapperToGraphic:function(H,R){return{extent:new oa({xmin:H.geometry.x-.25,ymin:H.geometry.y-.25,xmax:H.geometry.x+.25,ymax:H.geometry.y+.25,spatialReference:H.geometry.spatialReference}),feature:H,name:R}},_clearBarriersGraphics:function(){this._barriersLayer.clear();this._polylineBarriersLayer.clear();this._polygonBarriersLayer.clear()},_showBarriers:function(){this._clearBarriersGraphics();var H=this.routeParams,R=H.polylineBarriers&&H.polylineBarriers.features||
[],W=H.polygonBarriers&&H.polygonBarriers.features||[];z.forEach(H.barriers&&H.barriers.features||[],a.hitch(this,function(pa){this._barriersLayer.add(pa)}));z.forEach(R,a.hitch(this,function(pa){this._polylineBarriersLayer.add(pa)}));z.forEach(W,a.hitch(this,function(pa){this._polygonBarriersLayer.add(pa)}));this._barriersLayer.refresh();this._polylineBarriersLayer.refresh();this._polygonBarriersLayer.refresh()},_showRoute:function(H){this._clearDisplayAfterSolve();var R=H.routeResults[0].directions,
W=new K;if(R){this.set("solveResult",H);this.set("directions",R);var pa=H.routeResults[0].stops,ra,Aa;if(pa&&pa.length){var Ba=[];for(ra=0;ra<pa.length;ra++){var Ja=pa[ra];Ja.attributes.isWaypoint=Ja.attributes.Name===this._waypointName||Ja.attributes.isWaypoint;Ja=this._addStopWrapperToGraphic(Ja,Ja.attributes.Name);this.stops[ra]&&this.stops[ra].feature&&this.stops[ra].feature.attributes&&this.stops[ra].feature.attributes.Name===this._userDefinedStopName&&(Ja.feature.attributes.Name=this._userDefinedStopName);
this._returnToStartStop&&this._returnToStartStop._resultsStopIndex===ra?this._returnToStartStop=Ja:Ba.push(Ja)}if(this.stops.length>Ba.length)for(ra=0;ra<this.stops.length;ra++)this.stops[ra].feature||""!==this.stops[ra].name||Ba.splice(ra,0,this._emptyStop);this.stops=Ba;for(ra=0;ra<this.stops.length;ra++)this._updateStop(this.stops[ra],ra);this._setStops();this._setMenuNodeValues()}this.set("mergedRouteGraphic",new N(R.mergedGeometry,this.get("routeSymbol")));pa=[];Ba=[];for(ra=Ja=0;ra<R.featuresWithWaypoints.length;ra++){var Ka=
R.featuresWithWaypoints[ra];if("esriDMTDepart"===Ka.attributes.maneuverType)for(Aa=0;Aa<this.stops.length;Aa++)if(this.stops[Aa].feature===Ka._associatedStop){Ja=Aa+1;break}Ka.setSymbol(this.get("routeSymbol"));this._routeLayer.add(Ka);pa.push(Ka);(Aa=Ka.getDojoShape())&&Aa.moveToBack();Aa=new N(Ka.geometry,this._symbolEventPaddingDirections,Ka.attributes);Aa._nextStopIndex=Ja-.5;Aa._isSnapFeature=!0;Ka._associatedSnapFeature=Aa;this._waypointsEventLayer.add(Aa);"esriDMTDepart"!==Ka.attributes.maneuverType&&
(Aa=Ka.geometry.getPoint(0,0))&&(Aa=new N(Aa,this.maneuverSymbol),Aa._directionsFeature=Ka._associatedFeatureNoWaypoints,Ba.push(Aa),this._waypointsEventLayer.add(Ba[Ba.length-1]))}this.set("displayedRouteGraphics",pa);this.set("displayedManeuverPointGraphics",Ba);this._renderDirections();for(ra=0;ra<this.stops.length;ra++)if(this._isStopAWaypoint(this.stops[ra])&&this._modifiedWaypointIndex===ra){for(Aa=0;Aa<R.featuresWithWaypoints.length;Aa++)if(pa=R.featuresWithWaypoints[Aa],pa._associatedStop===
this.stops[ra].feature){if("esriDMTStop"===pa.attributes.maneuverType||"esriDMTDepart"===pa.attributes.maneuverType)this.stops[ra].feature.geometry.x=pa.geometry.paths[0][0][0],this.stops[ra].feature.geometry.y=pa.geometry.paths[0][0][1];break}this._modifiedWaypointIndex=null;break}u.set(this._savePrintBtnContainer,"display","inline-block");this.onDirectionsFinish(H)}else H=H.routeResults[0].route,H.setSymbol(this.routeSymbol),this._routeLayer.add(H),this._incrementalRouteSegment=H;W.resolve();this._moveLayersToFront();
this.createRouteSymbols();return W.promise},_setGeocodersStopReference:function(){if(this.geocoders)for(var H=0;H<this.geocoders.length;H++)this.geocoders[H]&&this.stops[H]&&(this.geocoders[H]._stopReference=this.stops[H])},_setStops:function(){this._setGeocodersStopReference();this.createRouteSymbols();this._set("stops",this.stops);this.onStopsUpdate(this.stops)},_getCandidates:function(H){var R=[];if(H&&H.length){for(var W=0;W<H.length;W++)R.push(this._getCandidate(H[W]));return L(R)}H=new K;H.resolve([]);
return H.promise},_clearResultsHTML:function(){this._resultsNode.innerHTML="";u.set(this._savePrintBtnContainer,"display","none")},_showSegmentPopup:function(H){if(H&&this.get("showSegmentPopup")&&this.get("map").infoWindow){var R=H.geometry.getPoint(0,0);H=new N(R,null,H.attributes,this.get("segmentInfoTemplate"));var W=this.get("map").infoWindow;W.setFeatures([H]);W.show(R)}},_addStopButton:function(){this.addStop().then(a.hitch(this,function(){this.get("focusOnNewStop")&&this.geocoders[this.stops.length-
1].focus()}))},_sortGeocoders:function(){var H=this._dnd.getAllNodes();this.geocoders.sort(a.hitch(this,function(W,pa){return W.domNode&&W.domNode.parentNode&&W.domNode.parentNode.parentNode&&pa.domNode&&pa.domNode.parentNode&&pa.domNode.parentNode.parentNode?z.indexOf(H,W.domNode.parentNode.parentNode)>z.indexOf(H,pa.domNode.parentNode.parentNode)?1:-1:0}));this.stops.length===this.geocoders.length&&this._sortStops();for(var R=0;R<this.geocoders.length;R++)this.geocoders[R]&&this.geocoders[R].inputNode&&
(this.geocoders[R].inputNode.title=B.widgets.directions.stopNoTitle+(R+1));this._setLocateButtonVisibilityEvents()},_disconnectResults:function(){if(this._resultEvents&&this._resultEvents.length)for(var H=0;H<this._resultEvents.length;H++)this._resultEvents[H]&&this._resultEvents[H].remove();this._resultEvents=[]},_formatArbitraryCostsForRouteTooltip:function(H){var R="",W;for(W in H)if(0===W.indexOf("Total_")&&H.hasOwnProperty(W)){var pa=this._getCostAttribute(W.substr(6));pa&&(R+=this._isTimeUnits(pa.units)?
this._formatTime(H[W],!1,pa.units):this._formatDistance(H[W],!0,pa.units),R+=R?" \x26middot; ":"")}R&&(R=B.widgets.directions.toNearbyStops+": \x3cb\x3e"+R.substr(0,R.length-10)+"\x3c/b\x3e");return R},_formatTime:function(H,R,W){W||(W=(this._getDirectionsTimeAttribute()||{}).units);var pa="";W=Math.round(this._convertCostValue(H,W,"esriNAUMinutes"));H=Math.floor(W/60);W=Math.floor(W%60);R?pa=A.format(H,{pattern:100>H?"00":"000"})+":"+A.format(W,{pattern:"00"}):(H&&(pa+=H+" "+B.widgets.directions.time.hr+
" "),pa+=H||W?W+" "+B.widgets.directions.time.min:"");return pa},_formatDistance:function(H,R,W){W||(W=this.directionsLengthUnits);var pa=this.directionsLengthUnits,ra=B.widgets.directions.units[pa],Aa=pa.replace("esri","").toLowerCase();H=this._convertCostValue(H,W,pa);ra&&(Aa=R?ra.abbr:ra.name);return H?A.format(H,{locale:"root",places:2})+" "+Aa:""},_projectToGeographic:function(H){var R=new K;if(!H)return R.reject("Directions:: 'geometry' is not defined.",{geometry:H}),R.promise;if(4326==H.spatialReference.wkid)return R.resolve(H),
R.promise;if(!this._geometryService)return R.reject("Directions:: Geometry service is not defined."),R.promise;var W=new O;W.outSR=new V(4326);W.geometries=[H];this._geometryService.project(W).then(function(pa){R.resolve(pa&&pa[0])},R.reject);return R.promise},_createToolbars:function(){this.editToolbar||(this.editToolbar=new U(this.map));this.drawToolbar||(this.drawToolbar=new fa(this.map),B.toolbars.draw.freehand=B.widgets.directions.lineBarrierFreehand,this.drawToolbar.onDrawComplete=a.hitch(this,
function(H){var R=new N(H.geometry,null,{BarrierType:0});this._projectToGeographic(H.geographicGeometry||H.geometry).then(a.hitch(this,function(W){1<ma.geodesicLengths([W],Z.METERS)[0]&&(this._polylineBarriersLayer.add(R),this.routeParams.polylineBarriers||(this.routeParams.polylineBarriers=new ta),this.routeParams.polylineBarriers.features.push(R),this._clearStopsStatusAttr(),this.getDirections(!0))}))}))},_destroyGlobalGeocoder:function(){this._globalGeocoder&&(this._globalGeocoder.destroy(),this._globalGeocoder=
null)},_createGlobalGeocoder:function(){var H=new K;this._globalGeocoder=new va(this.get("searchOptions"));k.once(this._globalGeocoder,"load",H.resolve,H.reject);this._globalGeocoder.startup();return H.promise},_init:function(){var H=new K;this.set("loaded",!1);this._enableButton(this._getDirectionsButtonNode,!1);u.set(this._saveAsButton,"display","none");this.clearMessages();if(this.get("map").loaded)this._configure().always(H.resolve);else k.once(this.get("map"),"load",a.hitch(this,function(){this._configure().always(H.resolve)}));
return H.promise},_setDefaultStops:function(){var H=new K;this.defaults.stops&&this.defaults.stops.length?this._updateStops(this.defaults.stops).then(a.hitch(this,function(){this._removeEmptyStops();H.resolve()}),H.reject):H.resolve();return H.promise},_configure:function(){var H=new K;this._handle&&this._handle._remove();this._createDnD();this._createDepartAtControls();this._setSearchOptions();this._createGlobalGeocoder().then(a.hitch(this,function(){this._createToolbars();this._usingAGOL()||(this.printTaskUrl=
this.geometryTaskUrl=null);this._createGeometryTask();this._createPrintTask();this._showActivateButton();this._showBarriersButton();this._createTravelModesDDL();this._createSearchSourceDDL();var R=[this._createRouteTask(),this._setDefaultStops()];L(R).then(a.hitch(this,function(){this._setDefaultUnits();this._setTrafficOptions();this._setMenuNodeValues();this._setupEvents();var W=this.directionsLanguage||this.userOptions.routeParams&&this.userOptions.routeParams.directionsLanguage||D.locale.toLowerCase();
this._setDirectionsLanguageByLocale(W);this._setupTravelModes().then(a.hitch(this,function(){this.set("loaded",!0);this.onLoad();H.resolve(!0)}),function(pa){H.reject(pa)})}),function(W){H.reject(W)})}),function(R){H.reject(R)});this._naRouteSharing=null;return H.promise},_setDirectionsLanguageByLocale:function(H){var R=this.serviceDescription.directionsSupportedLanguages,W=function(ra){if(R)for(var Aa=0;Aa<R.length;Aa++)if(R[Aa].toLowerCase().substr(0,2)===ra)return R[Aa];return null},pa=W(H);pa||
(H=H.substr(0,2),pa=W(H));this.directionsLanguage=pa;return this.routeParams.directionsLanguage=pa},_getStopSymbol:function(H,R){var W=H&&(H.feature&&H.feature.attributes||H.attributes),pa=this.stopSymbol;W&&(pa=this._isStopAWaypoint(H)?this.waypointSymbol:void 0===W.Status||0===W.Status||6===W.Status?null===W.ArriveCurbApproach&&null!==W.DepartCurbApproach?this.get(R?"fromSymbolDrag":"fromSymbol"):null!==W.ArriveCurbApproach&&null===W.DepartCurbApproach?this.get(R?"toSymbolDrag":"toSymbol"):this.get(R?
"stopSymbolDrag":"stopSymbol"):this.get(R?"unreachedSymbolDrag":"unreachedSymbol"));return pa},_addTrafficLayer:function(){this.trafficLayer&&!this._trafficLayerAdded&&this.map&&(this.map.addLayer(this.trafficLayer),this.trafficLayer.show(),this._trafficLayerAdded=!0)},_toggleUnits:function(H){H.target===this._useMilesNode?this.setDirectionsLengthUnits(Z.MILES):H.target===this._useKilometersNode&&this.setDirectionsLengthUnits(Z.KILOMETERS)},_toggleCheckbox:function(H){var R=l.get(H.target,"checked");
H.target===this._findOptimalOrderNode?this.set("optimalRoute",R):H.target===this._useTrafficNode?this.set("traffic",R):H.target===this._returnToStartNode&&this.set("returnToStart",R)},_isStopLocated:function(H){return H&&H.feature&&H.feature.attributes&&(!H.feature.attributes.Status||6===H.feature.attributes.Status)},_configureRouteOptions:function(){var H=this.get("routeParams"),R;this.get("directionsLengthUnits")?H.directionsLengthUnits=this.get("directionsLengthUnits"):this.set("directionsLengthUnits",
H.directionsLengthUnits);H.findBestSequence=this.get("optimalRoute");if(H.findBestSequence)for(H.preserveFirstStop=this._isStopLocated(this.stops[0]),H.preserveLastStop=!this.returnToStart&&this._isStopLocated(this.stops[this.stops.length-1])||this.returnToStart&&this._isStopLocated(this.stops[0]),R=0;R<this.stops.length;)this._isStopAWaypoint(this.stops[R])?this._removeStop(R,!0,!0):R++;if(!this.returnToStart&&this.stops.length&&this._isStopAWaypoint(this.stops[this.stops.length-1]))for(R=this.stops.length-
1;0<R;)this._isStopAWaypoint(this.stops[R])&&this._removeStop(R,!0,!0),R--;if(this._isTimeUnits(this._getImpedanceAttribute().units)||this.serviceDescription&&10.6<=this.serviceDescription.currentVersion)if(H.useTimeWindows=!0,"now"===this.startTime)H.timeWindowsAreUTC=!0,H.startTimeIsUTC=!0,H.startTime=new Date;else if("none"===this.startTime)H.startTime=null;else{H.timeWindowsAreUTC=!1;H.startTimeIsUTC=!1;var W=this._departAtTime,pa=6E4*W.getValue().getTimezoneOffset();W=new Date(W.getValue().getTime()+
this._departAtDate.getValue().getTime()-pa);W=new Date(W.getTime()-6E4*W.getTimezoneOffset());H.startTime=W}else H.startTime=null,H.useTimeWindows=!1;W=this._getImpedanceAttribute();pa=this._getTimeNeutralAttribute();var ra=this._getDirectionsTimeAttribute();R=this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames;pa&&-1===z.indexOf(R,pa.name)&&R.push(pa.name);!this._isTimeUnits(W.units)&&this.serviceDescription&&10.6<=this.serviceDescription.currentVersion&&ra&&-1===
z.indexOf(R,ra.name)&&R.push(ra.name);this.routeParams.accumulateAttributes=R;H.returnStops=!0;ra=[];for(R=0;R<this.stopGraphics.length;R++)if(this.stopGraphics[R]&&(ra.push(new N(this.stopGraphics[R].toJson())),R)){var Aa=ra[0].attributes,Ba=ra[R].attributes;for(Ja in Ba)Ba.hasOwnProperty(Ja)&&!Aa.hasOwnProperty(Ja)&&(Aa[Ja]=null)}if(this.get("returnToStart")&&this.stopGraphics.length&&this._isStopLocated(this.stops[0])){var Ja=new N(this.stopGraphics[0].toJson());this._returnToStartStop=this._addStopWrapperToGraphic(Ja,
Ja.attributes.Name);ra.push(Ja)}else this._returnToStartStop=null;H.stops.features=ra;if(pa)for(R=0;R<ra.length;R++)ra[R].attributes["Attr_"+pa.name]=this._convertCostValue(ra[R].attributes["Attr_"+W.name],W.units,pa.units);this.set("routeParams",H)},_configureRoute:function(){var H=new K;H.promise.always(a.hitch(this,function(){this._checkMaxStops()}));this.createRouteSymbols();this._configureRouteOptions();if(this.routeParams.returnRoutes&&this._incrementalSolveStopRange){var R=this._incrementalSolveStopRange;
R.start<R.end?this.routeParams.stops.features=this.routeParams.stops.features.slice(R.start,R.end+1):R.start>R.end&&(this.routeParams.stops.features=this.routeParams.stops.features.slice(R.start,this.routeParams.stops.features.length-1).concat(this.routeParams.stops.features.slice(0,R.end+1)))}else this._incrementalSolveStopRange=null;var W={},pa=this.routeParams.stops.features;for(R=0;R<pa.length;R++){var ra=pa[R].attributes.address;var Aa=(R===this._handle._index&&!this._handle.attributes.isWaypoint&&
this._incrementalSolveStopRange?this._waypointName:ra)+"_"+this._stopSequence++;pa[R].attributes.Name=Aa;W[Aa]=ra;delete pa[R].attributes.address;delete pa[R].attributes.isWaypoint;delete pa[R].attributes.Status}this._solveInProgress=!0;var Ba={_incrementalSolveStopRange:this._incrementalSolveStopRange};this.routeTask.solve(this.routeParams,a.hitch(this,function(Ja){this._solveResultProcessing(Ja,W,Ba).then(H.resolve,H.reject)}),a.hitch(this,function(Ja){a.mixin(this,Ba);this._solveInProgress=!1;
for(var Ka=0;Ka<this.stops.length;Ka++)this.stops[Ka].feature&&(this.stops[Ka].feature.attributes=a.mixin(this.stops[Ka].feature.attributes,{Status:5}));this.set("directions",null);this._clearDisplayAfterSolve();this.createRouteSymbols();this._routeTaskError(Ja);H.reject(Ja)}));return H.promise},_solveResultProcessing:function(H,R,W){var pa=new K;a.mixin(this,W);this._solveInProgress=!1;W=H.routeResults[0];var ra=W.directions;W=W.stops;if(ra){this._solverMessages=H.messages;var Aa=function(Va){for(var ab in R)if(Va&&
0===ra.routeName.indexOf(ab)||!Va&&0<ra.routeName.indexOf(ab))return R[ab];return""};var Ba=Aa(!0);Aa=Aa(!1);ra.routeName=(Ba!==this._waypointName?Ba:B.widgets.directions.waypoint)+" \u2014 "+(Aa!==this._waypointName?Aa:B.widgets.directions.waypoint);for(Ba=0;Ba<ra.features.length;Ba++)if(Aa=ra.features[Ba].attributes,"esriDMTDepart"===Aa.maneuverType||"esriDMTStop"===Aa.maneuverType)for(var Ja in R)if(R.hasOwnProperty(Ja)&&-1<Aa.text.indexOf(Ja)){Aa.text=Aa.text.replace(Ja,R[Ja]);for(var Ka=0;Ka<
W.length;Ka++){var Ra=W[Ka].attributes;if(Ra.Name===Ja){a.mixin(ra.features[Ba],{_associatedStop:W[this.returnToStart&&Ka===W.length-1?0:Ka],_associatedStopWithReturnToStart:W[Ka]});if(!Ra.ArriveTime&&!Ra.ArriveTimeUTC&&Aa.ETA&&Aa.arriveTimeUTC){Ra.ArriveTime=Aa.ETA;Ra.ArriveTimeUTC=Aa.arriveTimeUTC;Ka=0;if(0==Ba&&"esriDMTDepart"===Aa.maneuverType||0<Ba&&"esriDMTStop"===Aa.maneuverType)Ka=this._convertCostValue(Aa.time,(this._getDirectionsTimeAttribute()||{}).units,"milliseconds");Ra.DepartTime=Ra.ArriveTime+
Ka;Ra.DepartTimeUTC=Ra.ArriveTimeUTC+Ka}break}}}for(Ba=0;Ba<W.length;Ba++)this._returnToStartStop&&W[Ba].attributes.Name===this._returnToStartStop.feature.attributes.Name&&(this._returnToStartStop._resultsStopIndex=Ba),W[Ba].attributes.Name=R[W[Ba].attributes.Name];this._directionsPostprocessing(ra);this.traffic&&this._updateMapTimeExtent()}this._showRoute(H).always(a.hitch(this,function(){this._incrementalSolveStopRange=null;pa.resolve(H)}));return pa.promise},_directionsPostprocessing:function(H){var R,
W=function(Aa,Ba){var Ja=H.features[Aa]._associatedFeaturesWithWaypoints||[];Ja.push(H.featuresWithWaypoints[Ba]);H.features[Aa]._associatedFeaturesWithWaypoints=Ja;H.featuresWithWaypoints[Ba]._associatedFeatureNoWaypoints=H.features[Aa]};var pa=a.hitch(this,function(Aa){return"\x3cdiv class\x3d'"+this.theme+"'\x3e\x3ctable class\x3d'esriRoutesTooltip'\x3e"+this._renderDirectionsItemTR(Aa._associatedFeatureNoWaypoints)+"\x3c/table\x3e\x3c/div\x3e"});H.featuresWithWaypoints=[];for(R=0;R<H.features.length;R++){var ra=
new N(H.features[R].toJson());ra.setInfoTemplate(new qa({title:this._i18n.widgets.directions.maneuver,content:pa}));H.featuresWithWaypoints.push(ra);H.featuresWithWaypoints[R]._associatedStop=H.features[R]._associatedStop;H.featuresWithWaypoints[R]._associatedStopWithReturnToStart=H.features[R]._associatedStopWithReturnToStart}H.stringsWithWaypoints=a.mixin([],H.strings);H.eventsWithWaypoints=a.mixin([],H.events);for(pa=R=0;R<H.features.length;)H.features[R]._associatedStop&&H.features[R]._associatedStop.attributes.Name===
this._waypointName?(H.features.splice(R,R?2:1),H.strings.splice(R,R?2:1),H.events.splice(R,R?2:1),R&&H.features[R]&&"esriDMTStraight"===H.features[R].attributes.maneuverType?(ra=H.features.splice(R,1)[0],H.strings[R-1]=(H.strings[R-1]||[]).concat(H.strings.splice(R,1)[0]||[]),H.strings[R-1].length||(H.strings[R-1]=void 0),H.events[R-1]=(H.events[R-1]||[]).concat(H.events.splice(R,1)[0]||[]),H.events[R-1].length||(H.events[R-1]=void 0),H.features[R-1].attributes.length+=ra.attributes.length,H.features[R-
1].attributes.time+=ra.attributes.time,H.features[R-1].geometry.paths[0]=H.features[R-1].geometry.paths[0].concat(ra.geometry.paths[0]),W(R-1,pa++),W(R-1,pa++),W(R-1,pa++)):(R&&W(R-1,pa++),R<H.features.length&&W(R,pa++))):(W(R,pa++),R++)},_boldText:function(H,R){var W=H;try{var pa=new RegExp("[^\x3cstrong\x3e\x26nbsp;]"+R.replace(/(\||\$|\^|\(|\)|\[|\]|\{|\}|\/|\.|\+|\*|\?|\?)/g,"\\$1")+"[^\x26nbsp;\x3c/strong\x3e]","g");W=(" "+W+" ").replace(pa,"\x3cstrong\x3e\x26nbsp;"+R+"\x26nbsp;\x3c/strong\x3e");
W=W.trim()}catch(ra){}return W},_clearStopGraphics:function(){if(this.stopGraphics&&this.stopGraphics.length)for(var H=0;H<this.stopGraphics.length;H++)this._stopLayer.remove(this.stopGraphics[H]),this._stopLayer.remove(this.textGraphics[H]);this.set("stopGraphics",[]);this.set("textGraphics",[])},_updateMapTimeExtent:function(){if(this.map){var H=this.directions&&this.directions.features[0]&&this.directions.features[0].attributes||{},R=(new Date).getTime();R="none"==this.startTime?R:H.arriveTimeUTC||
R;this._useTrafficItemNode.title="none"!==this.startTime&&H.arriveTimeUTC?B.widgets.directions.trafficLabelDepartAt+": "+this._toSpatiallyLocalTimeString(H.arriveTimeUTC,H.ETA):"";this._myTimeExtentUpdate=!0;H=new Date(R);this.map.setTimeExtent(new Y(H,H))}},_restoreMapTimeExtent:function(){this.map&&(this._myTimeExtentUpdate=!0,this.map.setTimeExtent(this._externalTimeExtent))},_clearRouteGraphics:function(){for(var H=this.displayedRouteGraphics,R=this.displayedManeuverPointGraphics,W=this._routeLayer,
pa=this._waypointsEventLayer,ra=0,Aa=0,Ba=this._incrementalSolveStopRange?this._incrementalSolveStopRange:{start:0,end:this.stops?this.stops.length:-1};H&&Aa<H.length;){if(H[Aa]._associatedStop)for(var Ja=0;Ja<this.stops.length;Ja++)if(this.stops[Ja].feature===H[Aa]._associatedStop){ra=Ja;break}ra>=Ba.start&&ra<Ba.end||Ba.start>=Ba.end&&(ra>=Ba.start||ra<Ba.end)?(W.remove(H[Aa]),H.splice(Aa,1)):Aa++}W.remove(this._incrementalRouteSegment);this.set("displayedRouteGraphics",H?H:[]);R&&R.length&&z.forEach(R,
function(Ka){pa.remove(Ka)});this.set("displayedManeuverPointGraphics",[]);this._waypointsEventLayer.clear();this.unhighlightSegment(!0)},_clearInfoWindow:function(){var H=this.get("map").infoWindow;H&&(H.hide(),H.clearFeatures())},_clearDisplayBeforeSolve:function(){this._toggleSaveMenu(!1);this._clearInfoWindow();this._clearResultsHTML()},_clearDisplayAfterSolve:function(){this._clearStopGraphics();this._clearRouteGraphics();this._clearBarriersGraphics();this.clearMessages()},_getLetter:function(H){var R=
this.alphabet,W="",pa=function(Ba){var Ja="";"0123456789"===R||"1234567890"===R?Ja=String(Ba+1):(Ba=Ba||0,Ba>=R.length&&(Ja=pa(Math.floor(Ba/R.length)-1),Ba%=R.length),Ja+=R[Ba]);return Ja},ra=H instanceof N?a.hitch(this,function(){for(var Ba=this.get("returnToStart")?0:-1,Ja=0;Ja<this.stops.length;Ja++)if(this.stops[Ja].feature===H){Ba=Ja;break}return Ba})():H;if(-1<ra&&R&&R.length){R instanceof Array&&(R=R.toString().replace(/,/g,""));W=-1;for(var Aa=0;Aa<=ra;Aa++)W+=this._isStopAWaypoint(this.stops[Aa])?
0:1;W=pa(W)}return W},_solveAndZoom:function(H){if(this.autoSolve)return this._getDirections().then(a.hitch(this,function(){H||this.zoomToFullRoute()}));var R=new K;R.resolve();return R.promise},_setupEvents:function(){this._onEvents.push(k(this.domNode,"[data-blur-on-click]:click",function(){this.blur()}));this._onEvents.push(k(this._dndNode,"[data-reverse-stops]:click, [data-reverse-stops]:keydown",a.hitch(this,function(ra){ra&&("click"===ra.type||"keydown"===ra.type&&ra.keyCode===h.ENTER)&&this.modifyStopSequence()})));
this._onEvents.push(k(this._printButton,"click, keydown",a.hitch(this,function(ra){ra&&("click"===ra.type||"keydown"===ra.type&&ra.keyCode===h.ENTER)&&this._printDirections()})));this._onEvents.push(k(this._resultsNode,"[data-full-route]:click, [data-full-route]:keydown",a.hitch(this,function(ra){ra&&("click"===ra.type||"keydown"===ra.type&&ra.keyCode===h.ENTER)&&this.zoomToFullRoute()})));this._onEvents.push(k(this._dndNode,"[data-remove]:click, [data-remove]:keydown",a.hitch(this,function(ra){if(ra&&
("click"===ra.type||"keydown"===ra.type&&ra.keyCode===h.ENTER)){var Aa=v("[data-remove]",this._dndNode);ra=z.indexOf(Aa,ra.target);this.removeStop(ra)}})));this._onEvents.push(k(this._dndNode,"[data-center-at]:click, [data-center-at]:keydown",a.hitch(this,function(ra){if(ra&&("click"===ra.type||"keydown"===ra.type&&ra.keyCode===h.ENTER)){var Aa=v("[data-center-at]",this._dndNode);ra=z.indexOf(Aa,ra.target);this.stops[ra]&&this.stops[ra].feature&&this.stops[ra].feature.geometry&&this.map.centerAndZoom(this.stops[ra].feature.geometry)}})));
this._onEvents.push(k(this.map,"zoom-end",a.hitch(this,function(){var ra=this._segmentGraphics;ra&&ra[0]&&void 0!==ra[0].attributes._index&&this.highlightSegment(ra[0].attributes._index,!0)})));this._onEvents.push(k(this._dnd,"Drop",a.hitch(this,function(){this._dnd.sync();this.set("optimalRoute",!1);var ra,Aa=!1,Ba=[],Ja=this._dnd.getAllNodes();for(ra=0;ra<this.geocoders.length;ra++){var Ka=z.indexOf(Ja,this.geocoders[ra]._tr);if(-1<Ka&&ra!==Ka&&ra!==Ka-1){for(;0<Ka&&this._isStopAWaypoint(this.stops[Ka]);)Ka--;
Aa=!0;break}}Aa&&(Ba=this._markWPsForRemovalAfterUserChangedStopSequence(ra,Ka));this._sortGeocoders();this.setListIcons();this._removeSomeWaypoints(Ba);this.stops[Ka].name&&this.getDirections()})));this._onEvents.push(k(this._dnd,"DndStart",a.hitch(this,function(){var ra=v("body")[0];x.add(ra,this._css.dndDragBodyClass);this._removeLocateButtonVisibilityEvents()})));this._onEvents.push(k(this._dnd,"DndDrop, DndCancel",a.hitch(this,function(){var ra=v("body")[0];x.remove(ra,this._css.dndDragBodyClass);
this._setLocateButtonVisibilityEvents()})));var H=this._handle,R=a.hitch(this,function(ra){var Aa=a.hitch(this,function(Ja,Ka,Ra,Va,ab){var db=H._isShown();H.setGeometry(Ja);H._tooltip.style.left=ra.screenPoint.x+"px";H._tooltip.style.top=ra.screenPoint.y+"px";!db||H._index===Ra&&H.attributes.isWaypoint===Va||(H._remove(),db=!1);H.setSymbol(Ka);H._index=Ra;H._isStopIcon=H._index===Math.floor(H._index);H.attributes.isWaypoint=Va;H._isStopIcon&&(H.attributes.address=this.stopGraphics[Ra].attributes.address,
H.setInfoTemplate(this.stopGraphics[Ra].infoTemplate));if(this.canModifyWaypoints||H._isStopIcon)db||(this._stopLayer.add(H),(Ja=H.getDojoShape())&&Ja[Va?"moveToBack":"moveToFront"].call(Ja)),this.editToolbar.activate(U.MOVE,H);Va=Va?H._isStopIcon?B.widgets.directions.dragWaypoint:this.canModifyWaypoints?B.widgets.directions.dragRoute:"":B.widgets.directions.dragStop;H._showTooltip(ab||Va)});this.unhighlightSegment();if(this.mapClickActive&&this.dragging&&!this._solveInProgress&&!this._moveInProgress&&
!H._solveTimeout)if(clearTimeout(H._removeTimeout),(ra.graphic._isStopIcon||ra.graphic._isStopLabel)&&!ra.graphic.attributes.isWaypoint&&this.canModifyStops||ra.graphic._isStopIcon&&ra.graphic.attributes.isWaypoint&&this.canModifyWaypoints){var Ba=ra.graphic._isStopLabel?this.stopGraphics[ra.graphic._index]:ra.graphic;Aa(Ba.geometry,this._getStopSymbol(this.stops[Ba._index],!0),Ba._index,!0===Ba.attributes.isWaypoint);this._stopLayer.remove(this.stopGraphics[Ba._index]);this._stopLayer.remove(this.textGraphics[Ba._index])}else if(ra.graphic._isSnapFeature||
ra.graphic._isHandle&&!ra.graphic._isStopIcon)this._snappingManager||(this._snappingManager=this.map.snappingManager),this._snappingManager.getSnappingPoint(ra.screenPoint).then(a.hitch(this,function(Ja){if(!this.maxStopsReached&&!this._moveInProgress&&Ja){for(var Ka=this.displayedManeuverPointGraphics,Ra=null,Va=0;Va<Ka.length;Va++)if(Ka[Va].geometry.x===Ja.x&&Ka[Va].geometry.y===Ja.y){Ra=Ka[Va]._directionsFeature;Ka=z.indexOf(this.directions.features,Ra);-1<Ka&&this.highlightSegment(Ka);break}Aa(Ja,
ra.graphic._isHandle?H.symbol:this.waypointSymbol,ra.graphic._isHandle?H._index:ra.graphic._nextStopIndex,ra.graphic._isHandle?H.attributes.isWaypoint:!0,Ra)}}))}),W=a.hitch(this,function(){clearTimeout(H._removeTimeout);H._removeTimeout=setTimeout(H._remove,100);this.unhighlightSegment()}),pa=a.hitch(this,function(ra){if(this.barrierToolActive){ra=ra.graphic;var Aa=this.routeParams,Ba=Aa.barriers?z.indexOf(Aa.barriers.features,ra):-1,Ja=Aa.polygonBarriers?z.indexOf(Aa.polygonBarriers.features,ra):
-1,Ka=Aa.polylineBarriers?z.indexOf(Aa.polylineBarriers.features,ra):-1;-1<Ba&&Aa.barriers.features.splice(Ba,1);-1<Ja&&Aa.polygonBarriers.features.splice(Ja,1);-1<Ka&&Aa.polylineBarriers.features.splice(Ka,1);this._barriersLayer.remove(ra);this._polygonBarriersLayer.remove(ra);this._polylineBarriersLayer.remove(ra);this._clearStopsStatusAttr();this.getDirections(!0)}});this._onEvents.push(this._waypointsEventLayer.on("mouse-move",R));this._onEvents.push(this._waypointsEventLayer.on("mouse-out",W));
this._onEvents.push(this._stopLayer.on("mouse-move",R));this._onEvents.push(this._stopLayer.on("mouse-out",W));this._onEvents.push(this._barriersLayer.on("click",pa));this._onEvents.push(this._polylineBarriersLayer.on("click",pa));this._onEvents.push(this._polygonBarriersLayer.on("click",pa));this._editToolbarEvents();this._watchEvents.push(this.watch("theme",this._updateThemeWatch));this._watchEvents.push(this.watch("canModifyStops",this._updateCanModifyStops));this._watchEvents.push(this.watch("canModifyWaypoints",
this._updateCanAddWaypoints));this._watchEvents.push(this.watch("showReturnToStartOption",this._optionsMenu));this._watchEvents.push(this.watch("showOptimalRouteOption",this._optionsMenu));this._watchEvents.push(this.watch("returnToStart",this._setMenuNodeValues));this._watchEvents.push(this.watch("optimalRoute",this._setMenuNodeValues));this._watchEvents.push(this.watch("startTime",this._setStartTime));this._watchEvents.push(this.watch("traffic",this._setMenuNodeValues));this._watchEvents.push(this.watch("trafficLayer",
this._trafficLayerUpdate));this._watchEvents.push(this.watch("routeTaskUrl",a.hitch(this,function(){this._createRouteTask();this._setTrafficOptions()})));this._watchEvents.push(this.watch("printTaskUrl",a.hitch(this,function(){this._createPrintTask()})));this._watchEvents.push(this.watch("geometryTaskUrl",a.hitch(this,function(){this._createGeometryTask()})));this._watchEvents.push(this.watch("routeParams",a.hitch(this,function(){this._createRouteParams();this._setDefaultUnits()})));this._watchEvents.push(this.watch("searchOptions",
a.hitch(this,function(){this._setSearchOptions();this._createGlobalGeocoder();var ra=this.get("searchOptions").sources;if(ra)for(var Aa=0;Aa<this.geocoders.length;Aa++)this.geocoders[Aa].set("sources",ra)})));this._watchEvents.push(this.watch("showReverseStopsButton",this.setListIcons));this._watchEvents.push(this.watch("editToolbar",this._editToolbarEvents));this._watchEvents.push(this.watch("showTravelModesOption",this._showTravelModesOption));this._watchEvents.push(this.watch("showMilesKilometersOption",
this._showMilesKilometersOption));this._watchEvents.push(this.watch("showClearButton",this._showClearButton));this._watchEvents.push(this.watch("directionsLengthUnits",this.setDirectionsLengthUnits));this._watchEvents.push(this.watch("directionsLanguage",this.setDirectionsLanguage));this._watchEvents.push(this.watch("mapClickActive",this._activate));this._watchEvents.push(this.watch("barrierToolActive",this._activateBarrierTool));this._watchEvents.push(this.watch("showActivateButton",this._showActivateButton));
this._watchEvents.push(this.watch("showBarriersButton",this._showBarriersButton));this._watchEvents.push(this.watch("showPrintPage",function(){u.set(this._printButton,"display",this.showPrintPage?"inline-block":"none")}));this._watchEvents.push(this.watch("showSaveButton",function(){u.set(this._saveMenuButton,"display",this.showSaveButton&&this.owningSystemUrl?"inline-block":"none")}))},_editToolbarEvents:function(){var H=a.hitch(this,function(W){var pa="";if((W=W.routeResults?W.routeResults[0]:null)&&
W.route){W=W.route.attributes;var ra=this.routeParams.travelMode;if(ra){pa+="\x3cb\x3e"+ra.name+"\x3c/b\x3e "+B.widgets.directions.toNearbyStops+": ";var Aa=void 0!==W["Total_"+ra.timeAttributeName]?this._formatTime(W["Total_"+ra.timeAttributeName],!1,(this._getCostAttribute(ra.timeAttributeName)||{}).units):"";pa+=(void 0!==W["Total_"+ra.distanceAttributeName]?this._formatDistance(W["Total_"+ra.distanceAttributeName],!0,(this._getCostAttribute(ra.distanceAttributeName)||{}).units):"")+(Aa?" \x26middot; "+
Aa:"")}else pa=this._formatArbitraryCostsForRouteTooltip(W)}this._handle._showTooltip(pa)}),R=a.hitch(this,function(W,pa){var ra=new K,Aa=this._handle,Ba=this.map.toScreen(Aa._origPoint).offset(W.transform.dx+Aa.symbol.xoffset,W.transform.dy+Aa.symbol.yoffset);W.origMapPoint||(W.origMapPoint=this.map.toMap(Ba));u.set(Aa._tooltip,"left",Ba.x+"px");u.set(Aa._tooltip,"top",Ba.y+"px");clearTimeout(Aa._solveTimeout);if(this._solveInProgress||!this._requestQueueTail.isFulfilled())Aa._solveTimeout=setTimeout(function(){R(W,
pa).always(ra.resolve)},100);else if(Aa._isStopIcon){Ba=W.graphic._index;var Ja=this.stops[Ba];(Ja=Ja?{name:Ja.name,extent:Ja.extent,feature:new N(Ja.feature.toJson())}:null)?(Ja.feature.setGeometry(W.origMapPoint),this._modifiedWaypointIndex=this._isStopAWaypoint(this.stops[Ba])?Ba:null,this._incrementalSolveStopRange={start:this.returnToStart?(this.stops.length+Ba-1)%this.stops.length:Math.max(0,Ba-1),end:this.returnToStart?(Ba+1)%this.stops.length:Math.min(this.stops.length-1,Ba+1)},this.updateStop(Ja,
Ba,pa).always(a.hitch(this,function(Ka){Aa._solveTimeout=null;Ka.routeResults&&H(Ka);ra.resolve()}))):ra.resolve()}else ra.resolve();return ra.promise});this._onEvents.push(k(this.editToolbar,"graphic-click",a.hitch(this,function(W){if(W.graphic.attributes.isWaypoint)!W.graphic._isStopIcon||this._moveInProgress||this._solveInProgress||(this._handle._remove(),this._moveInProgress=!0,this.removeStop(W.graphic._index,!0).always(a.hitch(this,function(){this._moveInProgress=!1})));else{var pa=this.get("map").infoWindow;
pa&&(pa.setFeatures([W.graphic]),pa.show(W.graphic.geometry))}})));this._onEvents.push(k(this.editToolbar,"graphic-move-start",a.hitch(this,function(W){this._blurGeocoders();this._moveInProgress=!0;this._removeEmptyStops();this.routeParams.returnDirections=!1;this.routeParams.returnRoutes=!0;W=W.graphic;W._origPoint=new X(W.geometry.toJson());W._maxDeviation=0;W._solveHasHappened=!1;this.map.disableMapNavigation()})));this._onEvents.push(k(this.editToolbar,"graphic-move-stop",a.hitch(this,function(W){this.map.enableMapNavigation();
this.routeParams.returnDirections=!0;this.routeParams.returnRoutes=!1;if(this._handle._isStopIcon)if(this._handle._solveHasHappened)if(this._handle.attributes.isWaypoint)R(W,!0).always(a.hitch(this,function(){this._moveInProgress=!1;this._handle._isStopIcon=!0;this._handle._remove();this._showLoadingSpinner()}));else{clearTimeout(this._handle._solveTimeout);this._handle._solveTimeout=null;var pa=this.stops[W.graphic._index],ra=(pa&&pa.feature&&pa.feature.attributes&&pa.feature.attributes.Name)===
this._userDefinedStopName,Aa=pa&&pa.name;this._reverseGeocode(new N(W.graphic.toJson())).then(a.hitch(this,function(Ba){ra&&(Ba.name=Aa,Ba.feature.attributes.Name=this._userDefinedStopName);this._setReverseGeocode(Ba,Ba.feature.geometry,W.graphic._index).always(a.hitch(this,function(){this._moveInProgress=!1;this._handle._remove();this._showLoadingSpinner()}))}))}else this._moveInProgress=!1;else this._moveInProgress=!1})));this._onEvents.push(k(this.editToolbar,"graphic-move",a.hitch(this,function(W){var pa=
this._handle,ra=W.transform;ra.dx&&ra.dy&&(W.graphic._maxDeviation=Math.max(pa._maxDeviation,Math.sqrt(ra.dx*ra.dx+ra.dy*ra.dy)));10<pa._maxDeviation&&(pa._solveHasHappened=!0,W.graphic===pa&&pa.attributes.isWaypoint&&!pa._isStopIcon?(this.set("optimalRoute",!1),pa._index+=.5,pa._isStopIcon=!0,W.graphic._stopIndex=pa._index,this._incrementalSolveStopRange={start:this.returnToStart?(this.stops.length+pa._index-1)%this.stops.length:Math.max(0,pa._index-1),end:this.returnToStart?(pa._index+1)%(this.stops.length+
1):Math.min(this.stops.length,pa._index+1)},this.addStop({name:this._waypointName,feature:new N(pa.geometry,pa.symbol,{isWaypoint:!0,CurbApproach:3})},W.graphic._stopIndex)):((pa=W.graphic.getDojoShape())&&pa.moveToFront(),R(W)))})))},_isStopAWaypoint:function(H){return H&&H.feature&&H.feature.attributes&&H.feature.attributes.isWaypoint},_getStopCount:function(){var H=0,R;for(R=0;R<this.stops.length;R++)H+=!this._isStopAWaypoint(this.stops[R])&&this.stops[R].name?1:0;return H},_getWaypointCount:function(){var H=
0,R;for(R=0;R<this.stops.length;R++)H+=this._isStopAWaypoint(this.stops[R])?1:0;return H},_decorateUngeocodedStop:function(H){var R=new K,W=function(ra,Aa){R.resolve({name:void 0===ra?B.widgets.directions.unlocatedStop:ra.toFixed(6)+" "+Aa.toFixed(6),feature:H})};if(H.geometry)if(H.geometry.spatialReference&&4326!==H.geometry.spatialReference.wkid)if(this.map&&this.map.spatialReference&&this.map.spatialReference.isWebMercator()){var pa=S.xyToLngLat(H.geometry.x,H.geometry.y);W(pa[0],pa[1])}else this._geometryService?
(pa=new O,pa.outSR=new V(4326),pa.geometries=[H.geometry],this._geometryService.project(pa).then(a.hitch(this,function(ra){ra&&ra.length?W(ra[0].x,ra[0].y):W(H.geometry.x,H.geometry.y)}),a.hitch(this,function(){W()}))):W(H.geometry.x,H.geometry.y);else W(H.geometry.x,H.geometry.y);else W();return R.promise},_trafficLayerUpdate:function(H,R,W){H=this.get("map");R&&this._trafficLayerAdded&&(H.removeLayer(R),this._trafficLayerAdded=!1);W&&this.get("traffic")&&!this._trafficLayerAdded&&(H.addLayer(W),
W.show(),this._trafficLayerAdded=!0)},_routeTaskError:function(H){var R=B.widgets.directions.error.routeTask,W=H.details,pa=function(ra){return(res=ra.match(/(\d+)/))?": "+res[0]:"."};W&&1===W.length&&("The distance between any inputs must be less than 50 miles (80 kilometers) when walking."===W[0]?R=B.widgets.directions.error.maxWalkingDistance:"Driving a truck is currently not supported outside of North America and Central America."===W[0]?R=B.widgets.directions.error.nonNAmTruckingMode:0===W[0].indexOf("The number of input locations loaded into Barriers")?
R=B.widgets.directions.error.tooManyBarriers+pa(W[0]):0===W[0].indexOf("The number of input locations loaded into PolygonBarriers")?R=B.widgets.directions.error.tooManyPolygonBarriers+pa(W[0]):0===W[0].indexOf("The number of input locations loaded into PolylineBarriers")&&(R=B.widgets.directions.error.tooManyPolylineBarriers+pa(W[0])));this._showMessage(R);this.onDirectionsFinish(H)},_showMessage:function(H,R){var W="";this.messages.push({msg:H,error:!R});if(this.messages.length){W+="\x3cul\x3e";
for(var pa=0;pa<this.messages.length;pa++)W+='\x3cli class\x3d"'+(this.messages[pa].error?this._css.routesErrorClass:this._css.routesInfoClass)+'"\x3e'+this.messages[pa].msg+"\x3c/li\x3e";W+="\x3c/ul\x3e"}this._msgNode&&(this._msgNode.innerHTML=W);if(!R)this.onError(H)},_isTimeUnits:function(H){return"milliseconds"===H||"esriNAUSeconds"===H||"esriNAUMinutes"===H||"esriNAUHours"===H||"esriNAUDays"===H},_getImpedanceAttribute:function(){return this._getCostAttribute(this.routeParams&&this.routeParams.travelMode&&
this.routeParams.travelMode.impedanceAttributeName||this.routeParams.impedanceAttribute||this.serviceDescription.impedance)},_getDirectionsTimeAttribute:function(){return this._getCostAttribute(this.routeParams&&this.routeParams.travelMode&&this.routeParams.travelMode.timeAttributeName||this.routeParams.directionsTimeAttribute||this.serviceDescription.directionsTimeAttribute)},_getTimeNeutralAttribute:function(){var H=(this._getDirectionsTimeAttribute()||{}).timeNeutralAttributeName;return this._getCostAttribute(H)},
_getCostAttribute:function(H){for(var R=this.serviceDescription&&this.serviceDescription.networkDataset.networkAttributes||[],W,pa=0;pa<R.length;pa++)if(R[pa].name===H&&"esriNAUTCost"===R[pa].usageType){W=R[pa];break}return W},_convertCostValue:function(H,R,W){var pa=this._isTimeUnits(R),ra=this._isTimeUnits(W);R=pa?this._toMinutes(H,R):this._toMeters(H,R);return pa===ra?ra?this._fromMinutes(R,W):this._fromMeters(R,W):H},_toMinutes:function(H,R,W){H=H||0;switch(R){case "milliseconds":H/=Math.pow(6E4,
W?-1:1);break;case "esriNAUSeconds":H/=Math.pow(60,W?-1:1);break;case "esriNAUHours":H*=Math.pow(60,W?-1:1);break;case "esriNAUDays":H*=Math.pow(1440,W?-1:1)}return H},_fromMinutes:function(H,R){return this._toMinutes(H,R,!0)},_toMeters:function(H,R,W){H=H||0;switch((R||"").replace("esriNAU","esri")){case "esriInches":H*=Math.pow(.0254,W?-1:1);break;case "esriFeet":H*=Math.pow(.3048,W?-1:1);break;case "esriYards":H*=Math.pow(.9144,W?-1:1);break;case "esriMiles":H*=Math.pow(1609.344,W?-1:1);break;
case "esriNauticalMiles":H*=Math.pow(1851.995396854,W?-1:1);break;case "esriMillimeters":H/=Math.pow(1E3,W?-1:1);break;case "esriCentimeters":H/=Math.pow(100,W?-1:1);break;case "esriKilometers":H*=Math.pow(1E3,W?-1:1);break;case "esriDecimeters":H/=Math.pow(10,W?-1:1)}return H},_fromMeters:function(H,R){return this._toMeters(H,R,!0)},_createRouteTask:function(){var H=new K;this.set("routeTask",new M(this.get("routeTaskUrl")));this._createRouteParams();this.routeTask.getServiceDescription(this.travelModesServiceUrl,
this.doNotFetchTravelModesFromOwningSystem).then(a.hitch(this,function(R){R.networkDataset?(this.set("serviceDescription",R),this.set("maxStops",parseInt(this.userOptions.maxStops||R.serviceLimits&&R.serviceLimits.Route_MaxStops||this.defaults.maxStops)),this.defaults.portalUrl?(this.owningSystemUrl=this.defaults.portalUrl,H.resolve()):this.routeTask.getOwningSystemUrl().then(a.hitch(this,function(W){this.owningSystemUrl=W;H.resolve()}),H.reject)):(this._showMessage(B.widgets.directions.error.cantFindRouteServiceDescription),
H.reject(Error(B.widgets.directions.error.cantFindRouteServiceDescription)))}),a.hitch(this,function(){this._showMessage(B.widgets.directions.error.cantFindRouteServiceDescription);H.reject(Error(B.widgets.directions.error.cantFindRouteServiceDescription));this.mapClickActive=!1;this._activate()}));return H.promise},_createSearchSourceDDL:function(){if(this._globalGeocoder&&this._globalGeocoder.sources&&1<this._globalGeocoder.sources.length){var H=a.hitch(this,function(pa){this._searchSourceSelector.domNode.blur();
this._globalGeocoder.set("activeSourceIndex",pa);for(var ra=0;ra<this.geocoders.length;ra++)this.geocoders[ra].set("activeSourceIndex",pa);this._truncateSearchSourceIfNeeded()});if(!this._searchSourceSelector){for(var R=[{value:"all",label:B.widgets.Search.main.all,selected:!0}],W=0;W<this._globalGeocoder.sources.length;W++)R.push({value:String(W),label:this._globalGeocoder.sources[W].name});this._searchSourceSelector=new n({className:"esriSearchSourcesDDL",style:"width:100%;",options:R},this._searchSourceSelectorContainer);
this._searchSourceSelector.startup();this._searchSourceSelector.on("change",H);this._searchSourceSelector.domNode.style.width=""}H("all")}else 2>this._globalGeocoder.sources.length&&(this._searchSourceContainerNode.style.display="none")},_createTravelModesDDL:function(){this._travelModeSelector||(this._travelModeSelector=new n({className:"esriTravelModesDDL",style:"width:100%;"},this._travelModeSelectorContainer),this._travelModeSelector.startup(),this._travelModeSelector._interractive=!0,this._travelModeSelector.on("change",
a.hitch(this,function(H){this._travelModeSelector._interractive?this._enqueue(function(){return this._setTravelMode(H).always(a.hitch(this,function(){this._travelModeSelector._interractive=!0}))}):this._travelModeSelector._interractive=!0})))},_setupTravelModes:function(){var H=this.get("serviceDescription"),R=H.supportedTravelModes,W=new K;if(R&&R.length&&this._travelModeSelector){for(var pa=R[0].name,ra=[],Aa=0;Aa<R.length;Aa++){for(var Ba="AUTOMOBILE"===R[Aa].type?"Driving":"TRUCK"===R[Aa].type?
"Trucking":"WALK"===R[Aa].type?"Walking":"Other",Ja="",Ka=H.networkDataset.networkAttributes,Ra=0;Ra<Ka.length;Ra++){var Va=Ka[Ra];if(Va.name===R[Aa].impedanceAttributeName){if("esriNAUCentimeters"===Va.units||"esriNAUDecimalDegrees"===Va.units||"esriNAUDecimeters"===Va.units||"esriNAUFeet"===Va.units||"esriNAUInches"===Va.units||"esriNAUKilometers"===Va.units||"esriNAUMeters"===Va.units||"esriNAUMiles"===Va.units||"esriNAUMillimeters"===Va.units||"esriNAUNauticalMiles"===Va.units||"esriNAUYards"===
Va.units)Ja="Distance";else if("esriNAUDays"===Va.units||"esriNAUHours"===Va.units||"esriNAUMinutes"===Va.units||"esriNAUSeconds"===Va.units)Ja="Time";break}}ra.push({id:R[Aa].name,label:'\x3cdiv class\x3d"esriTravelModesDirectionsIcon esriTravelModesType'+Ba+Ja+'"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"esriTravelModesTypeName" title\x3d"'+R[Aa].description+'"\x3e'+R[Aa].name+"\x3c/div\x3e"});!H.defaultTravelMode||R[Aa].id!==H.defaultTravelMode&&R[Aa].itemId!==H.defaultTravelMode||(pa=R[Aa].name)}this._showTravelModesOption();
this._travelModeSelector.setStore(new c({objectStore:new b({data:ra})}));this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(pa);this._setTravelMode(pa).always(W.resolve)}else this._checkStartTimeUIAvailability(),this.set("showTravelModesOption",!1),W.resolve();return W.promise},_createPrintTask:function(){this._printService=(this.printTaskUrl=this._usingAGOL()?this.printTaskUrl:this.defaults.printTaskUrl)?new Ya(this.printTaskUrl,{async:!1}):null;var H=new Ea;H.exportOptions=
{width:670,height:750,dpi:96};H.format="PNG32";H.layout="MAP_ONLY";H.preserveScale=!1;H.showAttribution=!1;var R=new Wa;R.map=this.map;R.outSpatialReference=this.map.spatialReference;R.template=H;this._printParams=R},_createGeometryTask:function(){this._geometryService=null;this._usingAGOL()?this._geometryService=new La(this.geometryTaskUrl):this.geometryTaskUrl=(this._geometryService=this.defaults.geometryTaskUrl?new La(this.defaults.geometryTaskUrl):sa.defaults.geometryService)?this._geometryService.url:
null},_showTravelModesOption:function(){var H=this.get("serviceDescription");u.set(this._travelModeContainerNode,"display",this.showTravelModesOption&&H&&H.supportedTravelModes&&H.supportedTravelModes.length&&!this.doNotFetchTravelModesFromOwningSystem?"block":"none")},_showMilesKilometersOption:function(){u.set(this._agolDistanceUnitsNode,"display",this.showMilesKilometersOption?"block":"none")},_showClearButton:function(){u.set(this._clearDirectionsButtonNode,"display",this.showClearButton?"inline-block":
"none")},_showActivateButton:function(){u.set(this._activateButtonNode,"display",this.showActivateButton?"inline-block":"none");this.showActivateButton||this.deactivate()},_showBarriersButton:function(){u.set(this._lineBarrierButtonNode,"display",this.showBarriersButton?"inline-block":"none");this.showBarriersButton||this.deactivateBarrierTool()},_createRouteParams:function(){var H={returnDirections:!0,returnRoutes:!1,outputLines:"esriNAOutputLineTrueShape",preserveFirstStop:!0,preserveLastStop:!0,
directionsOutputType:"complete",stops:new ta,ignoreInvalidLocations:!0,doNotLocateOnRestrictedElements:!0,outSpatialReference:this.get("map").spatialReference};this.get("routeParams")||(this.routeParams={});var R=new Ga;this.routeParams=a.mixin(R,{outputGeometryPrecision:0,outputGeometryPrecisionUnits:"esriMeters",restrictUTurns:"esriNFSBAtDeadEndsOnly"},this.get("routeParams"),H)},_markWPsForRemovalAfterUserChangedStopSequence:function(H,R){for(var W=H-1,pa=[];0<=W&&this._isStopAWaypoint(this.stops[W]);)pa.push(this.stops[W]),
W--;for(W=H+1;W<this.stops.length&&this._isStopAWaypoint(this.stops[W]);)pa.push(this.stops[W]),W++;if(R>H)for(W=R+1;W<this.stops.length&&this._isStopAWaypoint(this.stops[W]);)pa.push(this.stops[W]),W++;else if(void 0!==R)for(W=R-1;0<=W&&this._isStopAWaypoint(this.stops[W]);)pa.push(this.stops[W]),W--;else if(this.returnToStart&&0===H)for(W=this.stops.length-1;0<=W&&this._isStopAWaypoint(this.stops[W]);)pa.push(this.stops[W]),W--;return pa},_removeSomeWaypoints:function(H){for(var R=new K,W=[],pa=
0;pa<H.length;pa++){var ra=z.indexOf(this.stops,H[pa]);-1<ra&&W.push(this._removeStop(ra,!0,!0))}L(W).always(R.resolve);return R.promise},_modifyStopSequence:function(H,R){var W=this._dnd.getAllNodes(),pa=new K,ra,Aa=[];if(W.length)if(this._removeLocateButtonVisibilityEvents(),arguments.length&&void 0!==H)if(0<=H&&0<=R&&H<this.stops.length&&R<this.stops.length&&H!==R){W=this._markWPsForRemovalAfterUserChangedStopSequence(H,R);var Ba=this.stops.splice(H,1);this.stops.splice(R,0,Ba[0]);for(ra=0;ra<
this.stops.length;ra++)Aa.push(this._updateStop(this.stops[ra],ra));Aa.push(this._removeSomeWaypoints(W));L(Aa).always(a.hitch(this,function(){this._solveAndZoom().always(pa.resolve)}))}else pa.reject("Invalid From and To values.");else{for(ra=0;ra<this.stops.length;)this._isStopAWaypoint(this.stops[ra])?Aa.push(this._removeStop(ra,!0,!0)):ra++;L(Aa).always(a.hitch(this,function(){Aa=[];this.stops.reverse();for(ra=0;ra<this.stops.length;ra++)Aa.push(this._updateStop(this.stops[ra],ra));L(Aa).always(a.hitch(this,
function(){this._solveAndZoom().always(pa.resolve)}))}))}else pa.resolve();return pa.promise},_setMenuNodeValues:function(H){"traffic"!==H&&this._clearDisplayBeforeSolve();H=this.get("optimalRoute");this._findOptimalOrderNode&&l.set(this._findOptimalOrderNode,"checked",H);this._returnToStartNode&&(H=this.returnToStart&&!this.maxStopsReached&&this.stops[0]&&(!this.stops[0].feature||this._isStopLocated(this.stops[0])),l.set(this._returnToStartNode,"checked",H),this.set("returnToStart",H),this.maxStopsReached&&
this.returnToStart&&this._showMessage(B.widgets.directions.error.maximumStops));if(!this.returnToStart&&!this._incrementalSolveStopRange&&this.directions)for(this._incrementalSolveStopRange={start:this.stops.length-1,end:this.stops.length},this._clearRouteGraphics(),this._incrementalSolveStopRange=null,H=this.stops.length;0<H--&&this._isStopAWaypoint(this.stops[H]);)this._removeSomeWaypoints([this.stops[H]]);this._useTrafficNode&&(l.set(this._useTrafficNode,"checked",this.traffic),this.traffic?(this._updateMapTimeExtent(),
this._addTrafficLayer()):(this._removeTrafficLayer(),this._restoreMapTimeExtent()));switch(this.get("directionsLengthUnits")){case Z.KILOMETERS:l.set(this._useKilometersNode,"checked",!0);l.set(this._useMilesNode,"checked",!1);break;case Z.MILES:l.set(this._useKilometersNode,"checked",!1),l.set(this._useMilesNode,"checked",!0)}u.set(this._printButton,"display",this.showPrintPage?"inline-block":"none");u.set(this._saveMenuButton,"display",this.showSaveButton&&this.owningSystemUrl?"inline-block":"none");
this._showMilesKilometersOption();this._showClearButton()},_optionsMenu:function(){this._useTrafficItemNode&&u.set(this._useTrafficItemNode,"display",this.get("showTrafficOption")?"block":"none");this._returnToStartItemNode&&u.set(this._returnToStartItemNode,"display",this.get("showReturnToStartOption")?"block":"none");this._findOptimalOrderItemNode&&u.set(this._findOptimalOrderItemNode,"display",this.get("showOptimalRouteOption")&&3<this._getStopCount()?"block":"none");this.stops.length>=this.get("minStops")?
x.add(this._widgetContainer,this._css.stopsOptionsOptionsEnabledClass):(x.remove(this._widgetContainer,this._css.stopsOptionsOptionsEnabledClass),this._optionsMenuNode&&"block"===u.get(this._optionsMenuNode,"display")&&this._toggleOptionsMenu())},_stopsRemovable:function(){2<this._dnd.getAllNodes().length-this._getWaypointCount()?x.add(this._widgetContainer,this._css.stopsRemovableClass):x.remove(this._widgetContainer,this._css.stopsRemovableClass)},_checkMaxStops:function(){this.set("maxStopsReached",
this._getStopCount()+this._getWaypointCount()+(this.returnToStart?1:0)>=this.maxStops);this._showAddDestination()},_updateThemeWatch:function(H,R,W){x.remove(this.domNode,R);x.add(this.domNode,W)},_toggleOptionsMenu:function(){"block"===u.get(this._optionsMenuNode,"display")?(u.set(this._optionsMenuNode,"display","none"),x.remove(this._optionsButtonNode,"esriStopsOptionsOpen"),this._optionsButtonNode.innerHTML=B.widgets.directions.showOptions):(u.set(this._optionsMenuNode,"display","block"),x.add(this._optionsButtonNode,
"esriStopsOptionsOpen"),this._optionsButtonNode.innerHTML=B.widgets.directions.hideOptions)},_toggleSaveMenu:function(H){"block"===u.get(this._saveMenuNode,"display")||!1===H?(u.set(this._saveMenuNode,"display","none"),x.remove(this._saveMenuButton,this._css.stopsPressedButtonClass)):(this.clearMessages(),u.set(this._saveMenuNode,"display","block"),x.add(this._saveMenuButton,this._css.stopsPressedButtonClass),this._enableSharing().then(a.hitch(this,function(){this._outputLayer.setValue(this.routeLayer.title?
this.routeLayer.title:this.directions&&this.directions.routeName);if(this.routeLayer.ownerFolder)for(var R=this._folderSelector.store.objectStore.data,W=0;W<R.length;W++)if(R[W].folderId===this.routeLayer.ownerFolder){this._folderSelector.getValue()!==R[W].id&&(this._folderSelector._interractive=!1,this._folderSelector.setValue(R[W].id));break}this._enableButton(this._saveButton,this.routeLayer.isItemOwner||!this._userCanCreatePortalItem);this._outputLayer.set("disabled",!1)})))},_showToolbar:function(){x[this.stops.length<
this.maxStops&&this.canModifyStops||this.canModifyWaypoints?"add":"remove"].call(I,this._widgetContainer,this._css.addStopsClass)},_showAddDestination:function(){this._showToolbar();this._addDestinationNode.style.display=this.stops.length<this.maxStops&&this.canModifyStops?"inline":"none"},_showMapClickActiveButton:function(){this._showToolbar();this._activateButtonNode.style.display=this.canModifyStops||this.canModifyWaypoints?"inline-block":"none"},_getAbsoluteUrl:function(H){H=F.toUrl(H);return/^https?:/i.test(H)?
H:/^\/\//i.test(H)?ca+H:/^\//i.test(H)?ca+"//"+window.location.host+H:H},_getManeuverImage:function(H){return H?"esriDMTStop"===H||"esriDMTDepart"===H?"":this._getAbsoluteUrl("./images/Directions/maneuvers/"+H+".png"):""},_loadPrintDirections:function(H){var R=this.get("printTemplate"),W=new K;this.directionsLengthUnits!==this.routeParams.directionsLengthUnits?this.getDirections().then(W.resolve,W.reject):W.resolve();W.then(a.hitch(this,function(){if(!R&&this.directions){var pa=this._getAbsoluteUrl("./css/Directions.css"),
ra=this._getAbsoluteUrl("./css/DirectionsPrint.css"),Aa=this._getAbsoluteUrl("./images/Directions/print-logo.png");var Ba=C.isBodyLtr()?"ltr":"rtl";R="";R+="\x3c!DOCTYPE HTML\x3e";R+='\x3chtml lang\x3d"en" class\x3d"'+this.get("theme")+'" dir\x3d"'+Ba+'"\x3e';R+="\x3chead\x3e";R+='\x3cmeta charset\x3d"utf-8"\x3e';R+='\x3cmeta http-equiv\x3d"X-UA-Compatible" content\x3d"IE\x3dEdge,chrome\x3d1"\x3e';R+="\x3ctitle\x3e"+this.get("directions").routeName+"\x3c/title\x3e";R+='\x3clink rel\x3d"stylesheet" media\x3d"screen" type\x3d"text/css" href\x3d"'+
pa+'" /\x3e';R+='\x3clink rel\x3d"stylesheet" media\x3d"print" type\x3d"text/css" href\x3d"'+ra+'" /\x3e';R+="\x3c/head\x3e";R+='\x3cbody class\x3d"'+this._css.esriPrintPageClass+'"\x3e';R+='\x3cdiv class\x3d"'+this._css.esriPrintBarClass+'"\x3e';R+='\x3cdiv class\x3d"'+this._css.esriCloseButtonClass+'" title\x3d"'+B.common.close+'" onclick\x3d"window.close();"\x3e'+B.common.close+"\x3c/div\x3e";R+='\x3cdiv id\x3d"printButton" class\x3d"'+this._css.esriPrintButtonClass+'" title\x3d"'+B.widgets.directions.print+
'" onclick\x3d"window.print();"\x3e'+B.widgets.directions.print+"\x3c/div\x3e";R+="\x3c/div\x3e";R+='\x3cdiv class\x3d"'+this._css.esriPrintMainClass+'"\x3e';R+='\x3cdiv class\x3d"'+this._css.esriPrintHeaderClass+'"\x3e';R+='\x3cimg class\x3d"'+this._css.esriPrintLogoClass+'" src\x3d"'+Aa+'" /\x3e';R+='\x3cdiv class\x3d"'+this._css.esriPrintNameClass+'"\x3e'+this.get("directions").routeName+"\x3c/div\x3e";R+=this._renderDirectionsSummary(this.directions);H&&(R+='\x3cdiv id\x3d"divMap" class\x3d"esriPrintMap esriPrintWait"\x3e\x3c/div\x3e',
R+='\x3chr class\x3d"esriNoPrint"/\x3e');R+='\x3cdiv id\x3d"print_helper"\x3e\x3c/div\x3e';R+='\x3ctextarea onkeyup\x3d"document.getElementById(\'print_helper\').innerHTML\x3dthis.value;" id\x3d"print_area" class\x3d"'+this._css.esriPrintNotesClass+'" placeholder\x3d"'+B.widgets.directions.printNotes+'"\x3e\x3c/textarea\x3e';R+='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e';R+="\x3c/div\x3e";R+='\x3cdiv class\x3d"'+this._css.esriPrintDirectionsClass+'"\x3e';R+=this._renderDirectionsTable(this.directions);
R+="\x3c/div\x3e";R+="\x3c/div\x3e";R+="\x3c/div\x3e";R+="\x3c/body\x3e";R+="\x3c/html\x3e"}this._printWindow.document.open("text/html","replace");this._printWindow.document.write(R);this._printWindow.document.close()}))},resize:function(){this._truncateSearchSourceIfNeeded()},_truncateSearchSourceIfNeeded:function(){var H=this._searchSourceSelector;if(this._searchSourceSelector){var R=H.containerNode.firstChild;u.set(R,"width","");H.domNode.clientWidth>this.domNode.clientWidth&&u.set(R,"width",this._searchSourceContainerNode.clientWidth-
20+"px")}},_printDirections:function(){if(this.directions){var H=screen.width/2,R=screen.height/1.5;H="toolbar\x3dno, location\x3dno, directories\x3dno, status\x3dyes, menubar\x3dno, scrollbars\x3dyes, resizable\x3dyes, width\x3d"+H+", height\x3d"+R+", top\x3d"+(screen.height/2-R/2)+", left\x3d"+(screen.width/2-H/2);this.get("printPage")?(window.directions=this.get("directions"),window.open(this.get("printPage"),"directions_widget_print",H,!0)):(this._printWindow=window.open("","directions_widget_print",
H,!0),this._loadPrintDirections(!!this._printService),this._printService&&F(["dojo/_base/window"],a.hitch(this,function(W){this.zoomToFullRoute().then(a.hitch(this,function(){this._printService.execute(this._printParams,a.hitch(this,function(pa){W.withDoc(this._printWindow.document,function(){var ra=t.byId("divMap");ra&&(x.remove(ra,"esriPrintWait"),x.add(ra,"esriPageBreak"),I.create("img",{src:pa.url,"class":"esriPrintMapImg"},ra))})}),a.hitch(this,function(pa){W.withDoc(this._printWindow.document,
function(){var ra=t.byId("divMap");ra&&x.remove(ra,"esriPrintWait")})}))}))})))}},_enableButton:function(H,R){var W=R||void 0===R;x[W?"remove":"add"].apply(this,[H,"esriDisabledDirectionsButton"]);H._enabled=W},_clearStopsStatusAttr:function(){for(var H=0;H<this.stops.length;H++)this.stops[H].feature&&this.stops[H].feature.attributes&&(this.stops[H].feature.attributes.Status=void 0)},_enableSharing:function(){var H=new K;!this._naRouteSharing&&this.owningSystemUrl?F(["../tasks/NARouteSharing"],a.hitch(this,
function(R){this._naRouteSharing=new R(this.owningSystemUrl,this.map.spatialReference);this._folderSelector||(this._folderSelector=new n({className:"esriFoldersDDL",style:"width: 100%;",sortByLabel:!1,disabled:!0,_interractive:!0,onChange:a.hitch(this,function(){this._folderSelector._interractive?this._enableButton(this._saveButton,!this.routeLayer.itemId):this._folderSelector._interractive=!0})},this._folderSelectorContainer),this._folderSelector.startup(),this._outputLayer=new f({style:"width: 100%",
required:!0,trim:!0,regExp:'[^\x26|\x3c|\x3e|%|#|?|\\|"|/|+]+',maxLength:98,disabled:!0,onKeyPress:a.hitch(this,function(){this._enableButton(this._saveButton,!this.routeLayer.itemId||!this._userCanCreatePortalItem)}),onFocus:a.hitch(this,function(){this.map&&this.map.disableKeyboardNavigation()}),onBlur:a.hitch(this,function(){this.map&&this.map.enableKeyboardNavigation()})},this._outputLayerContainer),this._outputLayer.startup());this._naRouteSharing.getFolders().then(a.hitch(this,function(W){for(var pa=
[],ra=0;ra<W.length;ra++)pa.push({id:W[ra].url,folderId:W[ra].id,label:W[ra].title});this._folderSelector.setStore(new c({objectStore:new b({data:pa})}));this._naRouteSharing.canCreateItem().then(a.hitch(this,function(Aa){this._folderSelector.set("disabled",!Aa);this._userCanCreatePortalItem=Aa}));this._enableButton(this._saveButton);H.resolve()}),a.hitch(this,function(W){this._naRouteSharing=null;this._toggleSaveMenu(!1);H.reject(W)}))})):this.owningSystemUrl?H.resolve():(H.reject(Error("Owning system is not defined, or the Directions widget is not done initializing.")),
this._naRouteSharing=null);return H.promise},_storeRouteUI:function(){var H=new K;this._outputLayer&&this._outputLayer.isValid()?this._storeRoute(this._outputLayer.getValue(),this._folderSelector.getValue(),this._folderSelector.store.objectStore.get(this._folderSelector.getValue()).folderId).then(H.resolve,H.reject):(this._outputLayer&&this._outputLayer.focus(),H.reject(Error("Need result layer name specified.")));return H.promise},_storeRoute:function(H,R,W){var pa=new K,ra=this.directions;if(this._savingRoute||
!this._naRouteSharing)return this._saveButton.blur(),pa.reject(Error("Not ready to store route.")),pa.promise;this.clearMessages();pa.then(null,a.hitch(this,function(rb){this._showMessage(B.widgets.directions.error.cantSaveRoute)}));pa.promise.always(a.hitch(this,function(){this._enableButton(this._saveButton);u.set(this._saveAsButton,"display",this.routeLayer.itemId&&this._userCanCreatePortalItem?"inline-block":"none");this._showLoadingSpinner();this._savingRoute=!1}));if(ra&&ra.features&&ra.features.length&&
this.stops&&this.stops.length)if(this.owningSystemUrl)if(this.routeParams&&this.routeParams.travelMode)if(H&&R){var Aa=a.hitch(this,function(rb){return this._naRouteSharing.getAttributeUnits(rb,this.serviceDescription)});var Ba=this.routeParams.travelMode.timeAttributeName;var Ja=this.routeParams.travelMode.distanceAttributeName,Ka=Aa(Ba),Ra=Aa(Ja),Va=this.routeParams.directionsLengthUnits||this.serviceDescription.directionsLengthUnits,ab=this._naRouteSharing.toMeters,db=this._naRouteSharing.toMinutes,
jb=function(rb,wb,yb){var zb;for(zb in rb)if(rb.hasOwnProperty(zb)&&0===zb.indexOf(wb)&&-1===z.indexOf(yb,zb.substr(wb.length))){var bc=bc||{};bc[zb.substr(wb.length)]=rb[zb]}return bc},hb=[],fb=[],nb=[];if(Ba&&Ka&&Ja&&Ra){var qb=[],xb=this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames||[],ub=this.serviceDescription.networkDataset.networkAttributes;for(Aa=0;Aa<ub.length;Aa++)"esriNAUTCost"===ub[Aa].usageType&&-1===z.indexOf(xb,ub[Aa].name)&&ub[Aa].name!==Ba&&ub[Aa].name!==
Ja&&qb.push(ub[Aa].name);xb=this.get("stops");var pb={xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity};for(Aa=0;Aa<xb.length;Aa++)if(xb[Aa].feature&&xb[Aa].feature.toJson){ub=xb[Aa].feature.toJson();var ob=ub.attributes;var mb=ub.geometry,Ab=this._naRouteSharing.getUTCOffset(ob.ArriveTime,ob.ArriveTimeUTC),Db=this._naRouteSharing.getUTCOffset(ob.DepartTime,ob.DepartTimeUTC);a.mixin(pb,{xmin:pb.xmin>mb.x?mb.x:pb.xmin,ymin:pb.ymin>mb.y?mb.y:pb.ymin,xmax:pb.xmax<mb.x?mb.x:pb.xmax,ymax:pb.ymax<
mb.y?mb.y:pb.ymax});ub.attributes={__OBJECTID:Aa+1,CurbApproach:ob.CurbApproach,ArrivalCurbApproach:ob.ArriveCurbApproach,DepartureCurbApproach:ob.DepartCurbApproach,Name:ob.Name===this._waypointName?B.widgets.directions.waypoint:ob.Name===this._userDefinedStopName?xb[Aa].name:ob.Name,RouteName:ra.routeName,Sequence:ob.Sequence,Status:ob.Status,LocationType:ob.isWaypoint?1:0,TimeWindowStart:ob.TimeWindowStart,TimeWindowEnd:ob.TimeWindowEnd,TimeWindowStartUTCOffset:Ab,TimeWindowEndUTCOffset:Ab,ServiceMinutes:db(ob["Attr_"+
Ba],Ka),ServiceMeters:ab(ob["Attr_"+Ja],Ra),ServiceCosts:T.stringify(jb(ob,"Attr_",qb)),CumulativeMinutes:db(ob["Cumul_"+Ba],Ka),CumulativeMeters:ab(ob["Cumul_"+Ja],Ra),CumulativeCosts:T.stringify(jb(ob,"Cumul_",qb)),LateMinutes:db(ob["Violation_"+Ba],Ka),WaitMinutes:db(ob["Wait_"+Ba],Ka),ArrivalTime:this._naRouteSharing.toUTCTime(ob.ArriveTime,Ab),DepartureTime:this._naRouteSharing.toUTCTime(ob.DepartTime,Db),ArrivalUTCOffset:Ab,DepartureUTCOffset:Db};hb.push(ub)}Ja=0;Ra=function(rb){try{rb.strings=
T.parse(rb.strings)}catch(yb){Nb.strings=void 0}if(rb.strings&&rb.strings.length)for(var wb=0;wb<rb.strings.length;wb++)if("esriDSTGeneral"===rb.strings[wb].stringType)return rb.strings[wb].string};xb=function(rb,wb){for(var yb=[],zb=0;zb<(rb||[]).length;zb++)rb[zb].stringType!==wb&&wb||yb.push(rb[zb].string);return yb.length?yb.toString():void 0};ub=function(rb){switch(rb){case "esriDMTStop":return"esriDPTManeuverArrive";case "esriDMTDepart":return"esriDPTManeuverDepart";case "esriDMTDoorPassage":return"esriDPTManeuverDoor";
case "esriDMTBearLeft":return"esriDPTManeuverBearLeft";case "esriDMTBearRight":return"esriDPTManeuverBearRight";case "esriDMTElevator":return"esriDPTManeuverElevator";case "esriDMTEscalator":return"esriDPTManeuverEscalator";case "esriDMTFerry":return"esriDPTManeuverFerryOn";case "esriDMTEndOfFerry":return"esriDPTManeuverFerryOff";case "esriDMTForkCenter":return"esriDPTManeuverForkCenter";case "esriDMTForkLeft":return"esriDPTManeuverForkLeft";case "esriDMTForkRight":return"esriDPTManeuverForkRight";
case "esriDMTPedestrianRamp":return"esriDPTManeuverPedestrianRamp";case "esriDMTRampLeft":return"esriDPTManeuverRampLeft";case "esriDMTRampRight":return"esriDPTManeuverRampRight";case "esriDMTRoundabout":return"esriDPTManeuverRoundabout";case "esriDMTTurnLeft":return"esriDPTManeuverTurnLeft";case "esriDMTLeftLeft":return"esriDPTManeuverTurnLeftLeft";case "esriDMTLeftRight":return"esriDPTManeuverTurnLeftRight";case "esriDMTTurnRight":return"esriDPTManeuverTurnRight";case "esriDMTRightLeft":return"esriDPTManeuverTurnRightLeft";
case "esriDMTRightRight":return"esriDPTManeuverTurnRightRight";case "esriDMTSharpLeft":return"esriDPTManeuverSharpLeft";case "esriDMTSharpRight":return"esriDPTManeuverSharpRight";case "esriDMTStraight":return"esriDPTManeuverStraight";case "esriDMTStrairs":return"esriDPTManeuverStairs";case "esriDMTUTurn":return"esriDPTManeuverUTurn"}return"esriDPTUnknown"};for(Aa=0;Aa<ra.featuresWithWaypoints.length;Aa++){var Jb=ra.featuresWithWaypoints[Aa];mb=Jb.toJson();Ab=mb.attributes;Db=mb.geometry&&mb.geometry.paths&&
mb.geometry.paths[0]||[];var Ub=mb.geometry.hasM||Db[0]&&3===Db[0].length;ob=this._naRouteSharing.getUTCOffset(Ab.ETA,Ab.arriveTimeUTC);mb.attributes={__OBJECTID:Aa+1,Sequence:++Ja,StopID:function(){var rb=void 0,wb=Jb._associatedStopWithReturnToStart&&Jb._associatedStopWithReturnToStart.attributes.Sequence;if(wb)for(var yb=0;yb<hb.length;yb++)if(hb[yb].attributes.Sequence===wb){rb=hb[yb].attributes.__OBJECTID;break}return rb}(),DirectionPointType:ub(Ab.maneuverType),DisplayText:Jb._associatedStopWithReturnToStart&&
Jb._associatedStopWithReturnToStart.attributes.isWaypoint?Ab.text.replace(this._waypointName,B.widgets.directions.waypoint):Ab.text,ArrivalTime:this._naRouteSharing.toUTCTime(Ab.ETA,ob),ArrivalUTCOffset:ob,Azimuth:void 0,Name:xb(ra.stringsWithWaypoints[Aa],"esriDSTStreetName"),AlternateName:xb(ra.stringsWithWaypoints[Aa],"esriDSTAltName"),ExitName:xb(ra.stringsWithWaypoints[Aa],"esriDSTExit"),IntersectingName:xb(ra.stringsWithWaypoints[Aa],"esriDSTCrossStreet"),BranchName:xb(ra.stringsWithWaypoints[Aa],
"esriDSTBranch"),TowardName:xb(ra.stringsWithWaypoints[Aa],"esriDSTToward"),ShortVoiceInstruction:void 0,VoiceInstruction:void 0,Level:void 0};delete mb.symbol;delete mb.infoTemplate;Db.length?(mb.geometry={x:Db[0][0],y:Db[0][1],spatialReference:mb.geometry.spatialReference},Ub&&a.mixin(mb.geometry,{m:Db[0][2]})):delete mb.geometry;fb.push(mb);mb=Jb.toJson();Ab=mb.attributes;Db=mb.geometry&&mb.geometry.paths&&mb.geometry.paths[0]||[];ob=!0;for(Ba=0;Ba<Db.length-1;Ba++)if(Db[Ba][0]!==Db[Ba+1][0]||
Db[Ba][1]!==Db[Ba+1][1]){ob=!1;break}ob||(mb.attributes={DirectionPointID:Aa+1,DirectionLineType:"esriDLTSegment",Meters:ab(Ab.length,Va),Minutes:db(Ab.time,Ka),FromLevel:void 0,ToLevel:void 0},mb.geometry.hasM=Ub,delete mb.symbol,delete mb.infoTemplate,nb.push(mb));var Nb=ra.eventsWithWaypoints[mb.attributes.Sequence]||[];for(Ba=0;Ba<Nb.length;Ba++)mb=Nb[Ba].toJson(),Ab=mb.attributes,ob=this._naRouteSharing.getUTCOffset(Ab.ETA,Ab.arriveTimeUTC),mb.attributes={Sequence:++Ja,DirectionPointType:"esriDPTEvent",
DisplayText:Ra(Ab),ArrivalTime:this._naRouteSharing.toUTCTime(Ab.ETA,ob),ArrivalUTCOffset:ob,Name:Ab.strings},fb.push(mb)}Ba=this.routeParams.barriers&&this.routeParams.barriers.features||[];var Rb=[];for(Aa=0;Aa<Ba.length;Aa++)Ja=Ba[Aa].toJson(),Ra=Ja.attributes,Ja.attributes={BarrierType:Ra.BarrierType||0,FullEdge:Ra.FullEdge||!1,AddedCost:Ra["Attr_"+this._getImpedanceAttribute().name]||0,Costs:T.stringify(jb(Ra,"Attr_",qb)),CurbApproach:Ra.CurbApproach||0,Name:Ra.Name},Rb.push(Ja);Ba=this.routeParams.polylineBarriers&&
this.routeParams.polylineBarriers.features||[];var $b=[];for(Aa=0;Aa<Ba.length;Aa++)Ja=Ba[Aa].toJson(),Ra=Ja.attributes,Ja.attributes={BarrierType:Ra.BarrierType||0,ScaleFactor:Ra["Attr_"+this._getImpedanceAttribute().name]||1,Costs:T.stringify(jb(Ra,"Attr_",qb)),Name:Ra.Name},$b.push(Ja);Ba=this.routeParams.polygonBarriers&&this.routeParams.polygonBarriers.features||[];var ac=[];for(Aa=0;Aa<Ba.length;Aa++)Ja=Ba[Aa].toJson(),Ra=Ja.attributes,Ja.attributes={BarrierType:Ra.BarrierType||0,ScaleFactor:Ra["Attr_"+
this._getImpedanceAttribute().name]||1,Costs:T.stringify(jb(Ra,"Attr_",qb)),Name:Ra.Name},ac.push(Ja);var cc={geometry:ra.mergedGeometry,attributes:{RouteName:ra.routeName,TotalMinutes:db(ra.totalTime,Ka),TotalMeters:ab(ra.totalLength,Va),TotalLateMinutes:function(){for(var rb=0,wb=0;wb<hb.length;wb++)rb+=hb[wb].attributes.LateMinutes||0;return rb}(),TotalWaitMinutes:function(){for(var rb=0,wb=0;wb<hb.length;wb++)rb+=hb[wb].attributes.WaitMinutes||0;return rb}(),TotalCosts:hb[hb.length-1].attributes.CumulativeCosts,
StartTime:"none"!==this.startTime?hb[0].attributes.ArrivalTime:null,EndTime:"none"!==this.startTime?hb[hb.length-1].attributes.DepartureTime:null,StartUTCOffset:hb[0].attributes.ArrivalUTCOffset,EndUTCOffset:hb[hb.length-1].attributes.DepartureUTCOffset,Messages:T.stringify(this._solverMessages),AnalysisSettings:T.stringify({travelMode:a.hitch(this,function(){var rb=a.clone(this.routeParams.travelMode);"\x26lt;"===rb.name.substr(0,4)&&"\x26gt;"===rb.name.substr(rb.name.length-4,4)&&(rb.name=rb.name.substr(4,
rb.name.length-8));return rb})(),directionsLanguage:this.routeParams.directionsLanguage||this.serviceDescription.directionsLanguage,startTimeIsUTC:this.routeParams.startTimeIsUTC,timeWindowsAreUTC:this.routeParams.timeWindowsAreUTC,findBestSequence:this.routeParams.findBestSequence,preserveFirstStop:this.routeParams.preserveFirstStop,preserveLastStop:this.routeParams.preserveLastStop,accumulateAttributeNames:this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames})}};
this._enableButton(this._saveButton,!1);this._savingRoute=!0;this._showLoadingSpinner(!0);a.hitch(this,function(){var rb=new K;this._printService?this.zoomToFullRoute().then(a.hitch(this,function(){var wb=this._printParams.template,yb=wb.exportOptions;wb.exportOptions={width:200,height:133,dpi:96};this._printService.execute(this._printParams,function(zb){wb.exportOptions=yb;rb.resolve(zb.url)},function(zb){wb.exportOptions=yb;rb.resolve()})})):rb.resolve();return rb.promise})().then(a.hitch(this,
function(rb){var wb={folder:R,name:H,stops:hb,directionPoints:fb,directionLines:nb,barriers:Rb,polylineBarriers:$b,polygonBarriers:ac,extent:a.mixin(a.clone(ra.extent),{xmin:pb.xmin>ra.extent.xmin?ra.extent.xmin:pb.xmin,ymin:pb.ymin>ra.extent.ymin?ra.extent.ymin:pb.ymin,xmax:pb.xmax<ra.extent.xmax?ra.extent.xmax:pb.xmax,ymax:pb.ymax<ra.extent.ymax?ra.extent.ymax:pb.ymax}),routeInfo:cc,thumbnail:rb};this._userCanCreatePortalItem?this._naRouteSharing.store(wb,this.routeLayer.itemId,"1.0.0").then(a.hitch(this,
function(yb){if(yb.success){var zb=this._naRouteSharing.portal;zb="//"+(zb.isPortal?zb.portalHostname:zb.urlKey+"."+zb.customBaseUrl);this._toggleSaveMenu();this._showMessage(B.widgets.directions.routeIsSaved+"\x3cbr/\x3e\x3ca class\x3d'esriLinkButton' target\x3d'_blank' href\x3d'"+zb+"/home/item.html?id\x3d"+yb.id+"'\x3e"+B.widgets.directions.share+"\x3c/a\x3e",!0);if(this.routeLayer.itemId)this.onRouteItemUpdated(yb.id);else this.onRouteItemCreated(yb.id);a.mixin(this.routeLayer,{itemId:yb.id,title:wb.name,
isItemOwner:!0,ownerFolder:W});pa.resolve(yb)}else pa.reject(yb)}),pa.reject):this._naRouteSharing.createFeatureCollection(wb,"1.0.0").then(a.hitch(this,function(yb){pa.resolve(yb);this._toggleSaveMenu();this.onFeatureCollectionCreated(yb)}),pa.reject)}))}else pa.reject(Error("Cannot deduce the impedance used."))}else pa.reject(Error("Missing required parameter: layerName, folder must be specified."));else pa.reject(Error("Shared route must be built using a Travel Mode."));else pa.reject(Error("Cannot store route: owning system to store routes is not defined. Please specify Portal or ArcGIS Online Url in constructor."));
else pa.reject(Error("No route to share. Build a route first."));return pa.promise},_loadRoute:function(H){var R=new K;R.promise.always(a.hitch(this,function(){this._showLoadingSpinner(!1);u.set(this._saveAsButton,"display",this.routeLayer.itemId&&this._userCanCreatePortalItem?"inline-block":"none");this._enableButton(this._saveButton,this.routeLayer.isItemOwner)}));this._reset().then(a.hitch(this,function(){this._showLoadingSpinner(!0);this._enableSharing().then(a.hitch(this,function(){var W=a.clone(this.serviceDescription),
pa=a.hitch(this,function(Ka){a.mixin(this.routeLayer,{itemId:H,title:Ka.title,isItemOwner:Ka.isItemOwner,ownerFolder:Ka.ownerFolder})}),ra,Aa,Ba,Ja;W.directionsLengthUnits=this.directionsLengthUnits;this._naRouteSharing.load(H,W).then(a.hitch(this,function(Ka){if(Ka.routeParameters){a.mixin(this.routeParams,Ka.routeParameters);this.routeParams.accumulateAttributes=Ka.routeParameters.accumulateAttributeNames;this.set("optimalRoute",this.routeParams.findBestSequence);this.startTime=this.routeParams.startTime?
this.routeParams.startTime:"none";this._setStartTime(void 0,void 0,this.startTime);var Ra=Ka.routeParameters.travelMode,Va=Ra?this._getCostAttribute(Ra.impedanceAttributeName):void 0;Va=Va?this._isTimeUnits(Va.units)?"Time":"Distance":"";Ja=W.supportedTravelModes&&W.supportedTravelModes.length?this._travelModeSelector.store.objectStore.data.slice():[];if(canUseRouteLayerTM=1!==Ka.successCode&&Va){var ab="AUTOMOBILE"===Ra.type?"Driving":"TRUCK"===Ra.type?"Trucking":"WALK"===Ra.type?"Walking":"Other";
Ra.name="\x26lt;"+Ra.name+"\x26gt;";this.serviceDescription.supportedTravelModes=(W.supportedTravelModes||[]).concat(Ra);Ja.push({id:Ra.name,label:'\x3cdiv class\x3d"esriTravelModesDirectionsIcon esriTravelModesType'+ab+Va+'"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"esriTravelModesTypeName"\x3e'+Ra.name+"\x3c/div\x3e"});this._travelModeSelector.setStore(new c({objectStore:new b({data:Ja})}));this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(Ra.name)}else{Va=!1;if(Ra&&Ra.name)for(Ja=
W.supportedTravelModes||[],ra=0;ra<Ja.length;ra++)if(Ja[ra].name===Ra.name){Va=!0;this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(Ra.name);this.routeParams.travelMode=Ja[ra].impedanceAttributeName?Ja[ra]:Ja[ra].itemId;Ka.loadMessages.push({message:B.widgets.directions.error.tmFromPortalSameName+" "+Ra.name,messageType:"Warning"});break}if(!Va)if((Ra=W.defaultTravelMode)&&Ja)for(ra=0;ra<Ja.length;ra++){if(Ja[ra].id===Ra){this.routeParams.travelMode=Ja[ra].impedanceAttributeName?
Ja[ra]:Ja[ra].itemId;Ka.loadMessages.push({message:B.widgets.directions.error.tmFromPortalDefault+" "+(Ja[ra].name?Ja[ra].name:Ja[ra].itemId),messageType:"Warning"});break}}else this.routeParams.travelMode=null}this._checkStartTimeUIAvailability()}if(Ka.solveResult&&Ka.solveResult.routeResults){var db=Infinity,jb=-Infinity;Ra=Ka.solveResult.routeResults[0].stops;var hb=Ka.solveResult.routeResults[0].directions.features;Va={};for(ra=0;ra<Ra.length;ra++){var fb=Ra[ra].attributes;if(fb.isWaypoint)for(Aa=
0;Aa<hb.length;Aa++)ab=hb[Aa].attributes,ab._stopSequence===fb.Sequence&&(ab.text=ab.text.replace(fb.Name,this._waypointName));Ba=fb.Name+"_"+this._stopSequence++;Va[Ba]=fb.isWaypoint?this._waypointName:fb.Name;fb.Name=Ba;if(fb.Sequence<db&&(null!==fb.ArriveCurbApproach||null!==fb.DepartCurbApproach)){var nb=fb.Name;db=fb.Sequence}if(fb.Sequence>jb&&(null!==fb.ArriveCurbApproach||null!==fb.DepartCurbApproach)){var qb=fb.Name;jb=fb.Sequence}}Ba=nb+" - "+qb;Ka.solveResult.routeResults[0].routeName=
Ba;Ka.solveResult.routeResults[0].directions.routeName=Ba;for(ra=0;ra<hb.length;ra++)if(ab=hb[ra].attributes,void 0!==ab._stopSequence)for(Aa=0;Aa<Ra.length;Aa++)if(ab._stopSequence===Ra[Aa].attributes.Sequence){Ba=Ra[Aa].attributes.Name;ab.text=(ab.text||"").replace(Va[Ba],Ba);delete ab._stopSequence;break}nb=Ra[Ra.length-1];Ra[0].geometry.x===nb.geometry.x&&Ra[0].geometry.y===nb.geometry.y&&(this._returnToStartStop=this._addStopWrapperToGraphic(new N(nb.geometry,null,nb.attributes),Va[nb.attributes.Name]),
this.set("returnToStart",!0));this._solveResultProcessing(Ka.solveResult,Va).then(a.hitch(this,function(){this._setStartTime(void 0,void 0,this.startTime);pa(Ka);this.zoomToFullRoute();R.resolve(Ka)}),R.reject)}else{if(Ka.routeParameters){nb=Ka.routeParameters.stops.features;this.stops=[];for(ra=0;ra<nb.length;ra++)this.stops.push(this._addStopWrapperToGraphic(nb[ra],nb[ra].attributes.Name)),this._updateStop(this.stops[ra],ra);this._setStops();Ka.loadMessages.push({message:B.widgets.directions.routeLayerStopsOnly,
messageType:"Warning"})}else Ka.loadMessages.push({message:B.widgets.directions.routeLayerEmpty,messageType:"Warning"});pa(Ka);R.resolve(Ka)}for(ra=0;ra<Ka.loadMessages.length;ra++)this._showMessage(Ka.loadMessages[ra].message)}),a.hitch(this,function(Ka){R.reject(Ka);this._showMessage("GWM_0003"===Ka.messageCode?B.widgets.directions.error.accessDenied+this._naRouteSharing.portal.getPortalUser().username:B.widgets.directions.error.loadError)}))}),R.reject)}),R.reject);return R.promise}});a.setObject("dijit.Directions",
m,P);return m})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(F,m,a,D,z,y){return F("dijit.MenuSeparator",[a,D,z],{templateString:y,buildRendering:function(){this.inherited(arguments);m.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"esri/layers/ArcGISDynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/sniff dojo/io-query ../kernel ../config ../lang ../request ../urlUtils ../layerUtils ../geometry/scaleUtils ./DynamicMapServiceLayer ./ArcGISMapServiceLayer ./TimeInfo ./LayerTimeOptions ./ImageParameters ./DynamicLayerInfo ./LayerMapSource".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C){F=F([c,h],{declaredClass:"esri.layers.ArcGISDynamicMapServiceLayer",_eventMap:{"visible-layers-change":["visibleLayers"]},constructor:function(u,x,l){u=x&&x.imageParameters;var v=m.hitch;if(u){var A=u.layerDefinitions;A&&this.setLayerDefinitions(A);u.layerOption===w.LAYER_OPTION_SHOW&&(this.visibleLayers=[].concat(u.layerIds),this.onVisibleLayersChange(this.visibleLayers))}this._setIsPNG32=v(this,this._setIsPNG32);this.dpi=u&&u.dpi||96;this.imageFormat=
u&&u.format||"png8";this.imageTransparency=u&&!1===u.transparent?!1:!0;this._setIsPNG32();this.gdbVersion=x&&x.gdbVersion;this._params.gdbVersion=this.gdbVersion;A=u&&u.layerDefinitions;m.mixin(this._params,this._url.query,{dpi:this.dpi,transparent:this.imageTransparency,format:this.imageFormat},u?u.toJson():{});A&&(this._params.layerDefs=A);this.getImageUrl=v(this,this.getImageUrl);this._initLayer=v(this,this._initLayer);this._load=v(this,this._load);this.useMapImage=x?x.useMapImage:!1;this._loadCallback=
x&&x.loadCallback;(x=x&&x.resourceInfo)?this._initLayer(x):(void 0===l||!1===l)&&this._load();this.registerConnectEvents()},disableClientCaching:!1,layerDefinitions:null,_initLayer:function(u,x){this.inherited(arguments);u.timeInfo&&(this.timeInfo=new g(u.timeInfo));this.loaded=!0;this.onLoad(this);var l=this._loadCallback;l&&(delete this._loadCallback,l(this))},getImageUrl:function(u,x,l,v){var A=this._url.path+"/export",B=this._params,E=B.token=this._getToken(),G=u.spatialReference.wkid||D.toJson(u.spatialReference.toJson()),
I=this._errorHandler;delete B._ts;m.mixin(B,{bbox:u.xmin+","+u.ymin+","+u.xmax+","+u.ymax,bboxSR:G,imageSR:G,size:x+","+l},this.disableClientCaching?{_ts:(new Date).getTime()}:{});B.layerDefs&&(u=e._serializeLayerDefinitions(B.layerDefs,10.5<=this.version),B=m.mixin({},B),delete B.layerDefs,B.layerDefs=u);u=d.addProxy(d.normalize(A)+"?"+y.objectToQuery(m.mixin({},B,{f:"image"})));u.length>q.defaults.io.postLength||this.useMapImage?this._jsonRequest=f({url:A,content:m.mixin(B,{f:"json"}),callbackParamName:"callback",
load:function(L){L.imageData?L="data:"+(L.contentType||"image")+";base64,"+L.imageData:(L=L.href,E&&(L+=-1===L.indexOf("?")?"?token\x3d"+E:"\x26token\x3d"+E),L=d.addProxy(L));v(L)},error:I}):v(u)},_setIsPNG32:function(){var u=this.imageFormat.toLowerCase(),x=z("ie");this.isPNG32=x&&6===x&&("png32"===u||"png24"===u)&&this.imageTransparency},_setTime:function(u){var x=this.timeInfo;u=this._params.time=u?u.toJson().join(","):null;if(10.02>this.version&&x)if(u)this._params.layerTimeOptions=e._serializeTimeOptions(this.layerTimeOptions);
else{var l=this.layerInfos;if(l){var v=this.layerTimeOptions,A=v?v.slice(0):[],B=[];a.forEach(l,function(E){E.subLayerIds||B.push(E.id)});B.length&&(a.forEach(B,function(E){if(!A[E]){var G=new k;G.useTime=!1;A[E]=G}}),this._params.layerTimeOptions=e._serializeTimeOptions(A,B))}}10.02<=this.version&&x&&!u&&!x.hasLiveData&&(this._params.time="null,null")},setDPI:function(u,x){this.dpi=this._params.dpi=u;x||this.refresh(!0)},setImageFormat:function(u,x){this.imageFormat=this._params.format=u;this._setIsPNG32();
x||this.refresh(!0)},setImageTransparency:function(u,x){this.imageTransparency=this._params.transparent=u;this._setIsPNG32();x||this.refresh(!0)},setVisibleLayers:function(u,x){this.visibleLayers=u;this._params.layers=w.LAYER_OPTION_SHOW+":"+(u.length?u.join():"-1");this._updateDynamicLayers();x||this.refresh(!0);this.onVisibleLayersChange(this.visibleLayers)},onVisibleLayersChange:function(){},setDefaultVisibleLayers:function(u){this.visibleLayers=this._defaultVisibleLayers;this._params.layers=null;
this._updateDynamicLayers();u||this.refresh(!0);this.onVisibleLayersChange(this.visibleLayers)},setLayerDefinitions:function(u,x){this.layerDefinitions=u;this._params.layerDefs=u;this._updateDynamicLayers();x||this.refresh(!0)},setDefaultLayerDefinitions:function(u){this.layerDefinitions=this._params.layerDefs=null;this._updateDynamicLayers();u||this.refresh(!0)},setDisableClientCaching:function(u){this.disableClientCaching=u},setLayerTimeOptions:function(u,x){this.layerTimeOptions=u;this._params.layerTimeOptions=
e._serializeTimeOptions(u);this._updateDynamicLayers();x||this.refresh(!0)},refresh:function(u){if(!0===u)this.inherited(arguments);else{var x=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=x}},setLayerDrawingOptions:function(u,x){this.layerDrawingOptions=u;this._updateDynamicLayers();x||this.refresh(!0)},setDynamicLayerInfos:function(u,x){u&&0<u.length?(this.dynamicLayerInfos=u,this.visibleLayers=e._getDefaultVisibleLayers(u),this.onVisibleLayersChange(this.visibleLayers)):
this.dynamicLayerInfos=this.layerDrawingOptions=null;this._updateDynamicLayers();x||this.refresh(!0)},createDynamicLayerInfosFromLayerInfos:function(){var u=[],x;a.forEach(this.layerInfos,function(l){x=new t(l.toJson());x.source=new C({mapLayerId:l.id});u.push(x)});return u},_onDynamicLayersChange:function(){},_updateDynamicLayers:function(){if(this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length||this.layerDrawingOptions&&0<this.layerDrawingOptions.length){this.dynamicLayerInfos&&0!==this.dynamicLayerInfos.length||
(this.dynamicLayerInfos=this.createDynamicLayerInfosFromLayerInfos());var u=this._map&&b.getScale(this._map);u=this._getDynLayerObjs(u);u=D.toJson(u);this._params.dynamicLayers&&this._params.dynamicLayers.length===u.length&&this._params.dynamicLayers===u||(this._params.dynamicLayers=u,this._onDynamicLayersChange(this._params.dynamicLayers))}else this._params.dynamicLayers?(this._params.dynamicLayers=null,this._onDynamicLayersChange(null)):this._params.dynamicLayers=null},_getDynLayerObjs:function(u){var x=
this.dynamicLayerInfos,l=[],v=this.visibleLayers,A=u?e._getLayersForScale(u,x):v;a.forEach(x,function(B){if(!B.subLayerIds){var E=B.id;if(-1!==a.indexOf(v,E)&&-1!==a.indexOf(A,E)){var G={id:E,name:B.name};G.source=B.source&&B.source.toJson();var I;this.layerDefinitions&&this.layerDefinitions[E]&&(I=this.layerDefinitions[E]);I&&(G.definitionExpression=I);var L;this.layerDrawingOptions&&this.layerDrawingOptions[E]&&(L=this.layerDrawingOptions[E]);L&&(I=L.toJson(),this._fixMarkerColor(I.renderer),G.drawingInfo=
I);var K;this.layerTimeOptions&&this.layerTimeOptions[E]&&(K=this.layerTimeOptions[E]);K&&(G.layerTimeOptions=K.toJson());G.minScale=B.minScale||0;G.maxScale=B.maxScale||0;l.push(G)}}},this);return l},_fixMarkerColor:function(u){a.forEach(this._getAllSimpleMarkerSymbols(u),function(x){if(!x.color){var l=[0,0,0,0],v=x.outline&&x.outline.color;"esriSMSX"!==x.style&&"esriSMSCross"!==x.style||!v||(l=v.slice(0));x.color=l}})},_getAllSimpleMarkerSymbols:function(u){return a.filter(this._getAllSymbols(u),
function(x){return"esriSMS"===x.type})},_getAllSymbols:function(u){var x=[];u&&(x.push(u.symbol),x.push(u.defaultSymbol),a.forEach(u.uniqueValueInfos||u.classBreakInfos,function(l){x.push(l.symbol)}),x=a.filter(x,n.isDefined));return x},_onExtentChangeHandler:function(u,x,l){l&&this._updateDynamicLayers();this.inherited(arguments)},_setMap:function(u,x,l){this._map=u;this._updateDynamicLayers();return this.inherited(arguments)},onGDBVersionChange:function(){},setGDBVersion:function(u,x){this.gdbVersion=
u;this._params.gdbVersion=u;this.onGDBVersionChange();x||this.refresh(!0)},exportMapImage:function(u,x){var l=m.hitch(this,function(){var v=q.defaults.map,A=u&&u.layerDefinitions;u=u?u.toJson(this.normalization):{};A&&(u.layerDefs=A);u=m.mixin({size:v.width+","+v.height},this._params,u,{f:"json"});delete u._ts;u.layerDefs&&(v=e._serializeLayerDefinitions(u.layerDefs,10.5<=this.version),delete u.layerDefs,u.layerDefs=v);this._exportMapImage(this._url.path+"/export",u,x)});if(this.loaded)l();else this.on("load",
l)}});m.setObject("layers.ArcGISDynamicMapServiceLayer",F,r);return F})},"esri/layers/ImageParameters":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang ../layerUtils".split(" "),function(F,m,a,D,z,y,r,q){m=m(null,{declaredClass:"esri.layers.ImageParameters",constructor:function(){this.layerDefinitions=[]},bbox:null,extent:null,width:null,height:null,dpi:null,format:null,imageSpatialReference:null,layerOption:null,layerIds:null,transparent:null,
timeExtent:null,layerTimeOptions:null,toJson:function(n){this.bbox&&F.deprecated(this.declaredClass+" : Property 'bbox' deprecated. Use property 'extent'.");var f=this.bbox||this.extent;f=f&&n&&f._normalize(!0);n=this.layerOption;var d=f?f.spatialReference.wkid||D.toJson(f.spatialReference.toJson()):null,e=this.imageSpatialReference;f={dpi:this.dpi,format:this.format,transparent:this.transparent,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,bbox:f?f.xmin+","+f.ymin+","+
f.xmax+","+f.ymax:null,bboxSR:d,layers:n?n+":"+this.layerIds.join(","):null,imageSR:e?e.wkid||D.toJson(e.toJson()):d};f.layerDefs=q._serializeLayerDefinitions(this.layerDefinitions);n=this.timeExtent;f.time=n?n.toJson().join(","):null;f.layerTimeOptions=q._serializeTimeOptions(this.layerTimeOptions);return r.filter(f,function(b){if(null!==b)return!0})}});a.mixin(m,{LAYER_OPTION_SHOW:"show",LAYER_OPTION_HIDE:"hide",LAYER_OPTION_INCLUDE:"include",LAYER_OPTION_EXCLUDE:"exclude"});a.setObject("layers.ImageParameters",
m,y);return m})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff dojox/gfx/_base ../kernel ../config ../Color ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K,ba,T){function P(da){return!(!da||"BingMapsAerial"!==da.layerType&&"BingMapsAerial"!==da.type)}function J(da){return!(!da||"BingMapsRoad"!==da.layerType&&"BingMapsRoad"!==da.type)}function N(da){return P(da)||J(da)||!(!da||"BingMapsHybrid"!==da.layerType&&"BingMapsHybrid"!==da.type)}function Z(da){return!(!da||"OpenStreetMap"!==da.layerType&&"OpenStreetMap"!==da.type)}function Y(da){return!!(da&&da.url&&(-1<"ArcGISFeatureLayer ArcGISImageServiceLayer ArcGISImageServiceVectorLayer ArcGISMapServiceLayer ArcGISStreamLayer ArcGISTiledImageServiceLayer ArcGISTiledMapServiceLayer".split(" ").indexOf(da.layerType)||
!da.layerType&&!da.type))}function qa(da){return k({url:Hb.arcgisUrl+"/"+da.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function V(da,Sa){var Oa={f:"json"};Sa&&(Oa.token=Sa);return k({url:da,content:Oa,callbackParamName:"callback"},{disableIdentityLookup:!0})}function na(da){!da.layerDefinition||da.layerDefinition.drawingInfo&&da.layerDefinition.drawingInfo.labelingInfo||(da.showLabels=!1);da.itemProperties.layerDefinition&&(da.layerDefinition?
(da.layerDefinition.drawingInfo||(da.layerDefinition.drawingInfo=da.itemProperties.layerDefinition.drawingInfo),g.isDefined(da.layerDefinition.definitionExpression)||(da.layerDefinition.definitionExpression=da.itemProperties.layerDefinition.definitionExpression),g.isDefined(da.layerDefinition.minScale)||(da.layerDefinition.minScale=da.itemProperties.layerDefinition.minScale),g.isDefined(da.layerDefinition.maxScale)||(da.layerDefinition.maxScale=da.itemProperties.layerDefinition.maxScale)):da.layerDefinition=
da.itemProperties.layerDefinition);!da.itemProperties.popupInfo||da.popupInfo||da.disablePopup||(da.popupInfo=da.itemProperties.popupInfo);g.isDefined(da.itemProperties.showLabels)&&!g.isDefined(da.showLabels)&&(da.showLabels=da.itemProperties.showLabels);g.isDefined(da.itemProperties.showLegend)&&!g.isDefined(da.showLegend)&&(da.showLegend=da.itemProperties.showLegend);g.isDefined(da.itemProperties.refreshInterval)&&!g.isDefined(da.refreshInterval)&&(da.refreshInterval=da.itemProperties.refreshInterval)}
function ya(da){na(da);da.itemProperties.layerDefinition&&da.layerDefinition&&(!g.isDefined(da.layerDefinition.maximumTrackPoints)&&g.isDefined(da.itemProperties.layerDefinition.maximumTrackPoints)&&(da.layerDefinition.maximumTrackPoints=da.itemProperties.layerDefinition.maximumTrackPoints),!da.layerDefinition.definitionGeometry&&da.itemProperties.layerDefinition.definitionGeometry&&(da.layerDefinition.definitionGeometry=da.itemProperties.layerDefinition.definitionGeometry));da.itemProperties.purgeOptions&&
!da.purgeOptions&&(da.purgeOptions=da.itemProperties.purgeOptions)}function S(da,Sa){var Oa=new z,Ma=da.itemData,Na=[],Ua=[];a.forEach(Ma.operationalLayers,function(Pa){if(Pa.itemId&&Y(Pa)){var $a=Pa.url.toLowerCase();-1<$a.indexOf("/featureserver")||-1<$a.indexOf("/mapserver/")?(Ua.push(Pa),Na.push(qa(Pa))):-1<$a.indexOf("/mapserver")&&-1===$a.indexOf("/mapserver/")&&(!Pa.layers||!g.isDefined(Pa.minScale)&&!g.isDefined(Pa.maxScale))?(Ua.push(Pa),Na.push(qa(Pa))):-1<$a.indexOf("/imageserver")?(Ua.push(Pa),
Na.push(qa(Pa))):-1<$a.indexOf("/streamserver")&&(Ua.push(Pa),Na.push(qa(Pa)))}});Ma.baseMap&&Ma.baseMap.baseMapLayers&&a.forEach(Ma.baseMap.baseMapLayers,function(Pa){Pa.itemId&&"VectorTileLayer"!==Pa.layerType&&(Ua.push(Pa),Na.push(qa(Pa)))});if(0<Na.length){var Ta={};(new n(Na)).addCallback(function(Pa){a.forEach(Ua,function($a,cb){var bb=Pa[cb][1];if(bb&&!(bb instanceof Error)&&(Ta[$a.itemId]=bb,Y($a))){var kb=$a.url.toLowerCase();(-1<kb.indexOf("/featureserver")||-1<kb.indexOf("/mapserver/"))&&
bb.layers?a.forEach(bb.layers,function(Za){var gb="/featureserver/"+Za.id;(gb=kb.match(gb+"$")==gb)||(gb="/mapserver/"+Za.id,gb=kb.match(gb+"$")==gb);gb&&($a.itemProperties=Za,na($a))}):-1<kb.indexOf("/streamserver")?($a.itemProperties=bb,ya($a)):-1<kb.indexOf("/mapserver")?(bb.layers&&!$a.layers&&($a.layers=bb.layers),g.isDefined(bb.minScale)&&!g.isDefined($a.minScale)&&($a.minScale=bb.minScale),g.isDefined(bb.maxScale)&&!g.isDefined($a.maxScale)&&($a.maxScale=bb.maxScale),g.isDefined(bb.refreshInterval)&&
!g.isDefined($a.refreshInterval)&&($a.refreshInterval=bb.refreshInterval),bb.visibleLayers&&!$a.visibleLayers&&($a.visibleLayers=bb.visibleLayers)):-1<kb.indexOf("/imageserver")&&(g.isDefined(bb.minScale)&&!g.isDefined($a.minScale)&&($a.minScale=bb.minScale),g.isDefined(bb.maxScale)&&!g.isDefined($a.maxScale)&&($a.maxScale=bb.maxScale),g.isDefined(bb.refreshInterval)&&!g.isDefined($a.refreshInterval)&&($a.refreshInterval=bb.refreshInterval),!bb.popupInfo||$a.popupInfo||$a.disablePopup||($a.popupInfo=
bb.popupInfo),bb.renderingRule&&!$a.renderingRule&&($a.renderingRule=bb.renderingRule,bb.renderingRule.functionName&&($a.renderingRule.rasterFunction=bb.renderingRule.functionName)),bb.bandIds&&!$a.bandIds&&($a.bandIds=bb.bandIds),bb.mosaicRule&&!$a.mosaicRule&&($a.mosaicRule=bb.mosaicRule),bb.format&&!$a.format&&($a.format=bb.format),g.isDefined(bb.compressionQuality)&&!g.isDefined($a.compressionQuality)&&($a.compressionQuality=bb.compressionQuality),!bb.layerDefinition||!bb.layerDefinition.definitionExpression||
g.isDefined($a.layerDefinition)&&g.isDefined($a.layerDefinition.definitionExpression)||($a.layerDefinition=$a.layerDefinition||{},$a.layerDefinition.definitionExpression=bb.layerDefinition.definitionExpression),bb=m.getObject("layerDefinition.drawingInfo.renderer",!1,bb),null==m.getObject("layerDefinition.drawingInfo.renderer",!1,$a)&&null!=bb&&($a.layerDefinition=$a.layerDefinition||{},$a.layerDefinition.drawingInfo=$a.layerDefinition.drawingInfo||{},$a.layerDefinition.drawingInfo.renderer=bb))}});
da.relatedItemsData=Ta;Oa.callback(da)})}else Oa.callback(da);return Oa}function ma(da,Sa){var Oa=new z,Ma=da.itemData,Na=Ma.baseMap.baseMapLayers[0];if(N(Na))if(Na.portalUrl&&b.id)delete Sa.bingMapsKey,b.id.checkSignInStatus(C.urlToObject(Hb.arcgisUrl).path).then(m.hitch(null,function(Ta,Pa,$a,cb,bb){V(Na.portalUrl,bb.token).then(m.hitch(null,X,Ta,Pa,$a,cb),m.hitch(null,oa,Ta,Pa,$a,cb))},da,Sa,Ma,Oa),m.hitch(null,function(Ta,Pa,$a,cb,bb){V(Na.portalUrl).then(m.hitch(null,X,Ta,Pa,$a,cb),m.hitch(null,
oa,Ta,Pa,$a,cb))},da,Sa,Ma,Oa));else if(Sa.bingMapsKey){var Ua=new Tb({bingMapsKey:Sa.bingMapsKey,mapStyle:Tb.MAP_STYLE_AERIAL});D.connect(Ua,"onLoad",m.hitch(this,function(){Oa.callback([da,Sa])}));D.connect(Ua,"onError",function(Ta){delete Sa.bingMapsKey;da.itemData=xa(Ma);Na=da.itemData.baseMap.baseMapLayers[0];Na.errors=[];Na.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});Oa.callback([da,Sa])})}else da.itemData=
xa(Ma),Na=da.itemData.baseMap.baseMapLayers[0],Na.errors=[],Na.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),Oa.callback([da,Sa]);else Oa.callback([da,Sa]);return Oa}function ja(da){var Sa=new z;da=da.itemData;var Oa=da.baseMap&&da.baseMap.baseMapLayers;if(zb&&!zb.supported())for(da=0;da<Oa.length;da++){var Ma=Oa[da];if(!Ma.isReference){if("VectorTileLayer"===Ma.layerType){var Na=Ma.itemId;var Ua=da}break}}Na?
qb(Na,!1).addBoth(function(Ta){var Pa=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;Ta&&Ta.item&&Pa.test(Ta.item.url)&&(Oa[Ua]={id:"FB_"+Ma.id,layerType:"ArcGISTiledMapServiceLayer",opacity:"opacity"in Ma?Ma.opacity:1,visibility:"visibility"in Ma?Ma.visibility:!0,url:"https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});Sa.resolve()}):Sa.resolve();return Sa}function X(da,Sa,Oa,Ma,Na){Na.bingKey?(Sa.bingMapsKey=Na.bingKey,
Na=new Tb({bingMapsKey:Sa.bingMapsKey,mapStyle:Tb.MAP_STYLE_AERIAL}),D.connect(Na,"onLoad",m.hitch(this,function(){Ma.callback([da,Sa])})),D.connect(Na,"onError",function(Ua){delete Sa.bingMapsKey;da.itemData=xa(Oa);Ua=da.itemData.baseMap.baseMapLayers[0];Ua.errors=[];Ua.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});Ma.callback([da,Sa])})):oa(da,Sa,Oa,Ma)}function oa(da,Sa,Oa,Ma){delete Sa.bingMapsKey;da.itemData=
xa(Oa);Oa=da.itemData.baseMap.baseMapLayers[0];Oa.errors=[];Oa.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});Ma.callback([da,Sa])}function xa(da){P(da.baseMap.baseMapLayers[0])?da.baseMap={title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:J(da.baseMap.baseMapLayers[0])?da.baseMap={title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",
opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:da.baseMap={title:"Imagery with Labels",baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return da}
function Ha(da,Sa,Oa,Ma){var Na=da.dynamicLayerInfos||da.layerInfos,Ua=Sa.layers;if(Ua&&Na)if(Ma.usePopupManager){var Ta;a.forEach(Na,function(gb){var ib=gb.id;if(!gb.subLayerIds)for(gb=0;gb<Ua.length;gb++){var tb=Ua[gb];if(tb.id===ib&&tb.popupInfo&&!tb.disablePopup){Ta||(Ta={});Ta[ib]={infoTemplate:new Oa(tb.popupInfo),layerUrl:tb.layerUrl};break}}});Ta&&da.setInfoTemplates(Ta)}else{var Pa=[],$a=[],cb=[],bb=[],kb=[],Za=[];a.forEach(Na,function(gb){var ib=gb.id;if(!gb.subLayerIds&&-1!==a.indexOf(da.visibleLayers,
ib))for(gb=0;gb<Ua.length;gb++){var tb=Ua[gb];if(tb.id===ib){$a.push(ib);Pa.push(tb.popupInfo);cb.push(tb.layerUrl||"");tb.layerDefinition&&tb.layerDefinition.definitionExpression?bb.push(tb.layerDefinition.definitionExpression):bb.push("");kb.push(g.isDefined(tb.minScale)?tb.minScale:null);Za.push(g.isDefined(tb.maxScale)?tb.maxScale:null);break}}});Pa.length&&(da.__popups=Pa,da.__popupIds=$a,da.__popupUrls=cb,da.__popupWhereClauses=bb,da.__popupMinScales=kb,da.__popupMaxScales=Za,da.__resourceInfo=
Sa.resourceInfo)}}function Ia(da){if(!da)return!1;var Sa=(new r(Hb.arcgisUrl)).authority;return-1!==da.indexOf(".arcgis.com/")||-1!==da.indexOf(Sa)}function ia(da){return da?-1!==da.indexOf("/services.arcgisonline.com/")||-1!==da.indexOf("/server.arcgisonline.com/"):!1}function ea(da){"https:"===location.protocol&&(Ia(da)||ia(da))&&(da=da.replace("http:","https:"));return da}function za(da,Sa,Oa){var Ma=[];da.displayLevels||(Ma=a.map(da.resourceInfo.tileInfo.lods,function(Ta){return Ta.level}));if(da.exclusionAreas){var Na=
m.clone(da.exclusionAreas);Na=a.map(Na,function(Ta){Ta.geometry=new l(Ta.geometry);return Ta})}var Ua=da.resourceInfo&&"Raster"===da.resourceInfo.cacheType;Ua?(Ma=da.layerDefinition&&da.layerDefinition.drawingInfo&&da.layerDefinition.drawingInfo.renderer,Ma=new rb(ea(da.url),{resourceInfo:da.resourceInfo,opacity:da.opacity,visible:da.visibility,id:da.id,minScale:da.minScale,maxScale:da.maxScale,refreshInterval:da.refreshInterval,multidimensionalDefinition:da.multidimensionalDefinition,bandIds:da.bandIds,
renderer:Ma||null})):Ma=new K(ea(da.url),{resourceInfo:da.resourceInfo,opacity:da.opacity,visible:da.visibility,displayLevels:da.displayLevels||Ma,id:da.id,minScale:da.minScale,maxScale:da.maxScale,refreshInterval:da.refreshInterval,exclusionAreas:Na});Oa.ignorePopups||(Ua&&da.popupInfo&&!da.disablePopup?Ma.setInfoTemplate(new Sa(da.popupInfo)):Ha(Ma,da,Sa,Oa));return Ma}function Ca(da,Sa){if(!da||!Sa||0===Sa.length)return[];var Oa=","+Sa+",",Ma=[],Na,Ua=",";for(Na=0;Na<da.length;Na++)if(null!==da[Na].subLayerIds){if(-1===
Oa.indexOf(","+da[Na].id+",")||-1<Ua.indexOf(","+da[Na].id+","))Ua+=da[Na].subLayerIds.toString()+","}else-1<Oa.indexOf(","+da[Na].id+",")&&-1===Ua.indexOf(","+da[Na].id+",")&&Ma.push(da[Na].id);return Ma}function Da(da,Sa,Oa){var Ma=new Db;Ma.format="png24";da.resourceInfo&&da.resourceInfo.supportedImageFormatTypes&&-1<da.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")&&(Ma.format="png32");Ma=new xb(ea(da.url),{resourceInfo:da.resourceInfo,opacity:da.opacity,visible:da.visibility,id:da.id,
imageParameters:Ma,minScale:da.minScale,maxScale:da.maxScale,refreshInterval:da.refreshInterval});var Na=da.visibleLayers;if(!da.visibleLayers){var Ua="";a.forEach(Ma.layerInfos,function(Za){Za.defaultVisibility&&(Ua+=(0<Ua.length?",":"")+Za.id)});Na=Ua}if(da.layers&&0<da.layers.length){var Ta=[],Pa=[],$a,cb=[],bb,kb;a.forEach(da.layers,function(Za){var gb=Za.layerDefinition;gb&&gb.definitionExpression&&(Ta[Za.id]=gb.definitionExpression);if(gb&&gb.source){$a=null;kb=gb.source;if("mapLayer"===kb.type){var ib=
a.filter(da.resourceInfo.layers,function(tb){return tb.id===kb.mapLayerId});ib.length&&($a=m.mixin(ib[0],Za))}else $a=m.mixin({},Za);$a&&($a.source=kb,delete $a.popupInfo,$a=new mb($a),da.visibleLayers&&(ib="string"==typeof da.visibleLayers?da.visibleLayers.split(","):da.visibleLayers,-1<a.indexOf(ib,Za.id)?$a.defaultVisibility=!0:$a.defaultVisibility=!1),Pa.push($a))}gb&&null!=gb.transparency&&(ib=gb.drawingInfo||{},null==ib.transparency&&(ib.transparency=gb.transparency,gb.drawingInfo=ib));gb&&
gb.source&&gb.drawingInfo&&(bb=new Rb(gb.drawingInfo),cb[Za.id]=bb)},this);0<Ta.length&&Ma.setLayerDefinitions(Ta);0<Pa.length?(Ma.setDynamicLayerInfos(Pa,!0),0<cb.length&&Ma.setLayerDrawingOptions(cb,!0)):(Na=Ca(Ma.layerInfos,Na),Ma.setVisibleLayers(Na))}else Na=Ca(Ma.layerInfos,Na),Ma.setVisibleLayers(Na);Oa.ignorePopups||Ha(Ma,da,Sa,Oa);return Ma}function ka(da,Sa,Oa){var Ma=new Jb;Ma.bandIds=da.bandIds;null!=da.format&&(Ma.format=da.format,null!=da.compressionQuality&&(Ma.compressionQuality=da.compressionQuality));
if(da.renderingRule&&da.renderingRule.rasterFunction){var Na=new cc(da.renderingRule);Ma.renderingRule=Na}da.mosaicRule&&(Na=new $b(da.mosaicRule),Ma.mosaicRule=Na);g.isDefined(da.noData)&&(Ma.noData=da.noData);g.isDefined(da.noDataInterpretation)&&(Ma.noDataInterpretation=da.noDataInterpretation);g.isDefined(da.interpolation)&&(Ma.interpolation=da.interpolation);Na=da.layerType?"ArcGISImageServiceVectorLayer"===da.layerType:!1;g.isDefined(da.layerType)||(Na=da.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===
da.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===da.resourceInfo.serviceDataType));Ma={resourceInfo:da.resourceInfo,opacity:da.opacity,visible:da.visibility,id:da.id,imageServiceParameters:Ma,minScale:da.minScale,maxScale:da.maxScale,refreshInterval:da.refreshInterval};Ma=Na?new pb(ea(da.url),Ma):new ub(ea(da.url),Ma);da.layerDefinition&&(da.layerDefinition.drawingInfo&&da.layerDefinition.drawingInfo.renderer&&(Na=B.fromJson(da.layerDefinition.drawingInfo.renderer),Ma.setRenderer(Na)),
da.layerDefinition.definitionExpression&&Ma.setDefinitionExpression(da.layerDefinition.definitionExpression,!0));Oa.ignorePopups||!da.popupInfo||da.disablePopup||Ma.setInfoTemplate(new Sa(da.popupInfo));return Ma}function ta(da,Sa,Oa){var Ma=[102113,102100,3857],Na=Oa||new w(Sa[0].layerObject.fullExtent.spatialReference),Ua=new w(da.resourceInfo.fullExtent.spatialReference);return Na.wkt==Ua.wkt&&(Na.wkid==Ua.wkid||g.isDefined(Na.latestWkid)&&Na.latestWkid==Ua.wkid||g.isDefined(Ua.latestWkid)&&Na.wkid==
Ua.latestWkid||g.isDefined(Na.latestWkid)&&Na.latestWkid==Ua.latestWkid)||Na.wkid&&Ua.wkid&&a.some(Ma,function(Ta){return Ta===Ua.wkid})&&a.some(Ma,function(Ta){return Ta===Na.wkid})?!0:!1}function M(da,Sa,Oa){if(!Sa[0].layerObject.tileInfo)return!1;da=da.resourceInfo.tileInfo;Sa=Sa[0].layerObject.tileInfo;Oa=Oa.width>Oa.height?Oa.width:Oa.height;for(var Ma=!1,Na=!1,Ua=0;Ua<da.lods.length;Ua++){for(var Ta=da.lods[Ua].scale/da.dpi,Pa=0;Pa<Sa.lods.length;Pa++){var $a=Sa.lods[Pa].scale/Sa.dpi;if(Math.abs($a-
Ta)/$a<1/Oa)if(Ma){Na=!0;break}else Ma=!0}if(Na)break}return Na||Ma&&(1===da.lods.length||1===Sa.lods.length)?!0:!1}function Ga(da,Sa,Oa,Ma,Na,Ua){var Ta=Oa._clazz;if(Z(da))var Pa=new ac({id:da.id,opacity:da.opacity,visible:null!==da.visibility&&void 0!==da.visibility?da.visibility:!0});else if(da&&("WFS"===da.layerType||"WFS"===da.type)){var $a={customParameters:da.wfsInfo.customParameters,geometryType:da.layerDefinition.geometryType,id:da.id,labelingInfo:da.layerDefinition.drawingInfo.labelingInfo,
maxFeatures:da.wfsInfo.maxFeatures,mode:da.mode,name:da.wfsInfo.name,showLabels:!0,swapXY:da.wfsInfo.swapXY,title:da.title,url:da.url,version:da.wfsInfo.version,visible:da.visibility,wkid:da.layerDefinition.spatialReference.wkid};Pa=new Zb;Pa.fromJson($a,function(){g.isDefined(da.opacity)&&Pa.setOpacity(da.opacity);g.isDefined(da.visibility)&&Pa.setVisibility(da.visibility);(da.minScale||da.maxScale)&&Pa.setScaleRange(da.minScale,da.maxScale);Pa.renderer=B.fromJson(da.layerDefinition.drawingInfo.renderer,
{geometryType:$a.geometryType});!Oa.ignorePopups&&da.popupInfo&&Pa.setInfoTemplate(new Ta(da.popupInfo));Pa.emit("fromJsonComplete")})}else if(da&&("WMS"===da.layerType||"WMS"===da.type)){var cb=[],bb=[];a.forEach(da.layers,function(ib){bb.push(new Lb({name:ib.name,title:ib.title,legendURL:ib.legendURL||ib.legendUrl,queryable:ib.queryable,showPopup:ib.showPopup}));cb.push(ib.name)},this);da.visibleLayers&&(cb=da.visibleLayers);Ma=new l(da.extent[0][0],da.extent[0][1],da.extent[1][0],da.extent[1][1],
new w({wkid:4326}));Ma={customLayerParameters:da.customLayerParameters,customParameters:da.customParameters,extent:Ma,layerInfos:bb,version:da.version,maxWidth:da.maxWidth,maxHeight:da.maxHeight,featureInfoFormat:da.featureInfoFormat,getFeatureInfoURL:da.featureInfoUrl,getMapURL:da.mapUrl,spatialReferences:da.spatialReferences,title:da.title,copyright:da.copyright,minScale:da.minScale||0,maxScale:da.maxScale||0,format:da.format};Pa=new hc(da.url,{id:da.id,visibleLayers:cb,format:"png",transparent:da.firstLayer?
!1:!0,opacity:da.opacity,visible:null!==da.visibility?da.visibility:!0,resourceInfo:Ma,refreshInterval:da.refreshInterval});Pa.spatialReference.wkid=Ma.spatialReferences[0]}else if(da&&("KML"===da.layerType||"KML"===da.type)){var kb=da.url;if(b.id){var Za=b.id.findCredential(C.urlToObject(Hb.arcgisUrl).path);Za&&(Sa=Hb.arcgisUrl.substring(Hb.arcgisUrl.indexOf("//")+2,Hb.arcgisUrl.indexOf("/",Hb.arcgisUrl.indexOf("//")+3)),Na=Sa.split("."),Na=Na[Na.length-2]+"."+Na[Na.length-1],Ua=kb.indexOf(Na),-1<
Ua&&(kb="https://"+Sa+kb.substring(Ua+Na.length),kb+="?token\x3d"+Za.token))}Pa=new Ub(kb,{id:da.id,visible:null!==da.visibility?da.visibility:!0,outSR:Ma,refreshInterval:da.refreshInterval});D.connect(Pa,"onLoad",function(){(da.opacity||0===da.opacity)&&Pa.setOpacity(da.opacity);g.isDefined(da.minScale)&&g.isDefined(da.maxScale)&&Pa.setScaleRange(da.minScale,da.maxScale);da.visibleFolders&&a.forEach(Pa.folders,function(ib){-1<a.indexOf(da.visibleFolders,ib.id)?Pa.setFolderVisibility(ib,!0):Pa.setFolderVisibility(ib,
!1)},this)})}else if(!da||"WebTiledLayer"!==da.layerType&&"WebTiledLayer"!==da.type)if(!da||"GeoRSS"!==da.layerType&&"GeoRSS"!==da.type)if(da&&("CSV"===da.layerType||"CSV"===da.type)&&da.url)Ma={layerDefinition:da.layerDefinition,columnDelimiter:da.columnDelimiter,id:da.id?da.id:null,visible:null!==da.visibility?da.visibility:!0,opacity:da.opacity,refreshInterval:da.refreshInterval},da.locationInfo&&(Ma.latitudeFieldName=da.locationInfo.latitudeFieldName,Ma.longitudeFieldName=da.locationInfo.longitudeFieldName),
!Oa.ignorePopups&&da.popupInfo&&(Ma.infoTemplate=new Ta(da.popupInfo)),Pa=new ob(da.url,Ma);else if("VectorTileLayer"!==da.layerType||!da.styleUrl||da.resourceInfo&&da.resourceInfo instanceof Error)if(da.layerDefinition&&!da.url)Ma=y.fromJson(y.toJson(da)),delete Ma.id,delete Ma.opacity,delete Ma.visibility,Pa=new ba(Ma,{id:da.id,opacity:da.opacity,visible:da.visibility,outFields:["*"],autoGeneralize:!0}),Oa.ignorePopups||!Ma.popupInfo||Ma.disablePopup||Pa.setInfoTemplate(new Ta(Ma.popupInfo)),Wa(Pa);
else if(N(da))Oa.bingMapsKey?(Ma=Tb.MAP_STYLE_AERIAL_WITH_LABELS,P(da)?Ma=Tb.MAP_STYLE_AERIAL:J(da)&&(Ma=Tb.MAP_STYLE_ROAD),Pa=new Tb({bingMapsKey:Oa.bingMapsKey,mapStyle:Ma,opacity:da.opacity,id:da.id}),D.connect(Pa,"onError",m.hitch(this,function(ib){ib.errors=ib.errors||[];ib.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+(ib?ib.layerType||ib.type:"")+"]"})},da))):(da.errors=da.errors||[],da.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+
(da?da.layerType||da.type:"")+"]"}));else if(da.resourceInfo&&(da.resourceInfo.mapName||""===da.resourceInfo.mapName))Pa=!0===da.resourceInfo.singleFusedMapCache&&(da.baseMapLayer||ta(da,Sa,Ma)&&M(da,Na,Ua))?za(da,Ta,Oa):Da(da,Ta,Oa);else if(da.resourceInfo&&da.resourceInfo.pixelSizeX)Pa=!0===da.resourceInfo.singleFusedMapCache&&"ArcGISImageServiceLayer"!==da.layerType&&(da.baseMapLayer||"Raster"===da.resourceInfo.cacheType||ta(da,Sa,Ma)&&M(da,Na,Ua))?za(da,Ta,Oa):ka(da,Ta,Oa);else if(da.resourceInfo&&
"Feature Layer"===da.resourceInfo.type){da.capabilities&&(da.resourceInfo.capabilities=da.capabilities);var gb;!1===Oa.editable?gb=!1:Oa.privileges&&-1===a.indexOf(Oa.privileges,"features:user:edit")&&b.id&&b.id.findCredential(da.url)&&(gb=!1);Pa=new ba(ea(da.url),{resourceInfo:da.resourceInfo,opacity:da.opacity,visible:da.visibility,id:da.id,mode:da.mode===ba.MODE_SELECTION?ba.MODE_SELECTION:ba.MODE_AUTO,editable:gb,outFields:["*"],autoGeneralize:!0,refreshInterval:da.refreshInterval});Oa.ignorePopups||
!da.popupInfo||da.disablePopup||Pa.setInfoTemplate(new Ta(da.popupInfo));da.layerDefinition&&(da.layerDefinition.drawingInfo&&da.layerDefinition.drawingInfo.renderer&&(Ma=B.fromJson(da.layerDefinition.drawingInfo.renderer,{geometryType:Pa.geometryType}),Ma.isMaxInclusive=!0,Pa.setRenderer(Ma)),da.layerDefinition.drawingInfo&&da.layerDefinition.drawingInfo.labelingInfo&&(Ma=a.map(da.layerDefinition.drawingInfo.labelingInfo,function(ib){return new Nb(ib)}),Pa.setLabelingInfo(Ma)),da.layerDefinition.definitionExpression&&
Pa.setDefinitionExpression(da.layerDefinition.definitionExpression),g.isDefined(da.layerDefinition.minScale)&&Pa.setMinScale(da.layerDefinition.minScale),g.isDefined(da.layerDefinition.maxScale)&&Pa.setMaxScale(da.layerDefinition.maxScale));Wa(Pa)}else da.resourceInfo&&da.resourceInfo.streamUrls&&(Ma={resourceInfo:da.resourceInfo,opacity:da.opacity,visible:da.visibility,id:da.id},da.layerDefinition&&(kb=da.layerDefinition.drawingInfo,da.layerDefinition.definitionGeometry&&(Za=Za||{},Za.geometry=da.layerDefinition.definitionGeometry),
g.isDefined(da.layerDefinition.definitionExpression)&&(Za=Za||{},Za.where=da.layerDefinition.definitionExpression),g.isDefined(da.layerDefinition.maximumTrackPoints)&&(Ma.maximumTrackPoints=da.layerDefinition.maximumTrackPoints)),Za&&(Ma.filter=Za),da.purgeOptions&&(Ma.purgeOptions=da.purgeOptions),Pa=new wb(ea(da.url),Ma),kb&&kb.renderer&&(Ma=kb.renderer,Pa.setRenderer(B.fromJson(Ma,{geometryType:da.resourceInfo.geometryType}))),kb&&kb.labelingInfo&&(Ma=a.map(kb.labelingInfo,function(ib){return new Nb(ib)}),
Pa.setLabelingInfo(Ma)),Oa.ignorePopups||!da.popupInfo||da.disablePopup||Pa.setInfoTemplate(new Ta(da.popupInfo)),da.layerDefinition&&(g.isDefined(da.layerDefinition.minScale)&&Pa.setMinScale(da.layerDefinition.minScale),g.isDefined(da.layerDefinition.maxScale)&&Pa.setMaxScale(da.layerDefinition.maxScale)),q.once(Pa,"error",function(ib){da.errors.push({message:"Error loading stream layer. Check websocket url"})}));else Pa=new zb(da.styleUrl,{id:da.id,minScale:da.minScale,maxScale:da.maxScale,opacity:da.opacity,
visible:da.visibility,resourceInfo:da.resourceInfo});else Pa=new Ab(da.url,{id:da.id,opacity:da.opacity,outSpatialReference:Ma,refreshInterval:da.refreshInterval}),D.connect(Pa,"onLoad",function(){!1===da.visibility&&Pa.hide();g.isDefined(da.minScale)&&g.isDefined(da.maxScale)&&Pa.setScaleRange(da.minScale,da.maxScale);var ib=Pa.getFeatureLayers();a.forEach(ib,function(tb){da.pointSymbol&&"esriGeometryPoint"===tb.geometryType?(tb.renderer.symbol=A.fromJson(da.pointSymbol),1===ib.length&&(Pa.pointSymbol=
A.fromJson(da.pointSymbol))):da.lineSymbol&&"esriGeometryPolyline"===tb.geometryType?(tb.renderer.symbol=A.fromJson(da.lineSymbol),1===ib.length&&(Pa.polylineSymbol=A.fromJson(da.lineSymbol))):da.polygonSymbol&&"esriGeometryPolygon"===tb.geometryType&&(tb.renderer.symbol=A.fromJson(da.polygonSymbol),1===ib.length&&(Pa.polygonSymbol=A.fromJson(da.polygonSymbol)))})});else if(Pa=new oc(da.templateUrl,{id:da.id,visible:null!==da.visibility?da.visibility:!0,opacity:da.opacity,copyright:da.copyright,fullExtent:da.fullExtent&&
new l(da.fullExtent),initialExtent:da.fullExtent&&new l(da.fullExtent),subDomains:da.subDomains,tileInfo:da.tileInfo?new yb(da.tileInfo):null,refreshInterval:da.refreshInterval,wmtsInfo:da.wmtsInfo}),g.isDefined(da.minScale)||g.isDefined(da.maxScale))Pa.loaded?Pa.setScaleRange(da.minScale,da.maxScale):D.connect(Pa,"onLoad",function(){Pa.setScaleRange(da.minScale,da.maxScale)});Pa&&(Pa.arcgisProps={title:da.title},da.baseMapLayer&&(da.isReference?(Pa.attr("data-reference",!0),Pa._basemapGalleryLayerType=
"reference"):Pa._basemapGalleryLayerType="basemap"),Pa instanceof ba&&da.layerDefinition&&da.layerDefinition.featureReduction&&"cluster"===da.layerDefinition.featureReduction.type&&(Ma=da.layerDefinition.featureReduction,Ma.clusterSize&&(Ma.clusterSize=e.pt2px(Ma.clusterSize)),Ma.clusterRadius&&(Ma.clusterRadius=e.pt2px(Ma.clusterRadius)),Ma.popupInfo&&(Ma.infoTemplate=new E(Ma.popupInfo),delete Ma.popupInfo),Pa.setFeatureReduction(Ma)));return Pa}function La(da,Sa,Oa,Ma,Na){a.forEach(da,function(Pa){Pa.layerObject=
Ga(Pa,da,Sa,Oa,Ma,Na)});var Ua=a.filter(da,function(Pa){return!Pa.isReference}),Ta=a.filter(da,function(Pa){return!!Pa.isReference});return da=Ua.concat(Ta)}function aa(da){var Sa=null;da=da[0];da.url&&Y(da)&&da.resourceInfo.spatialReference&&(Sa=new w,da.resourceInfo.spatialReference.wkid&&(Sa.wkid=da.resourceInfo.spatialReference.wkid),da.resourceInfo.spatialReference.wkt&&(Sa.wkt=da.resourceInfo.spatialReference.wkt));N(da)||Z(da)?Sa=new w({wkid:102100}):da&&("WMS"===da.layerType||"WMS"===da.type)&&
(Sa=new w({wkid:da.spatialReferences[0]}));return Sa}function Ya(da,Sa,Oa,Ma,Na,Ua,Ta,Pa){a.forEach(Sa,function($a){if(Y($a)||$a&&"VectorTileLayer"===$a.layerType)$a.resourceInfo=da[$a.deferredsPos][1],delete $a.deferredsPos});Ua=Ua||aa(Sa);Sa=La(Sa,Oa,Ua,Ta,Pa);Na.callback(Sa);return Na}function Wa(da){!window.CanvasRenderingContext2D&&da.renderer&&"esri.renderer.HeatmapRenderer"===da.renderer.declaredClass&&da.setRenderer(B.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,
yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function Ea(da,Sa,Oa){da.message=da.message?da.message+(" [url:"+Sa+"]"):"[url:"+Sa+"]";Oa.push(da);c.defaults.io.errorHandler(da)}function U(da,Sa){var Oa=ea(da);return k({url:Oa,content:{f:"json"},callbackParamName:"callback",error:function(Ma,Na){Ea(Ma,Oa,Sa)}})}function fa(da){var Sa=Hb.arcgisUrl+"/"+da.itemId+"/data";return k({url:Sa,content:{f:"json"},callbackParamName:"callback",
error:function(Oa,Ma){da.errors=da.errors||[];Ea(Oa,Sa,da.errors)}})}function sa(da,Sa){return bc.loadMetadata(da).otherwise(function(Oa){Ea(Oa,da,Sa);return Oa})}function O(da,Sa,Oa){var Ma=new z;if(!(Oa.featureCollection&&Oa.featureCollection.layers||Oa.layers))return da.errors=da.errors||[],da.errors.push({message:"Invalid Feature Collection item data. [item id: "+da.itemId+"]"}),Ma.errback(),Ma;Oa.layers&&(Oa.featureCollection={layers:Oa.layers},delete Oa.layers,g.isDefined(Oa.showLegend)&&(Oa.featureCollection.showLegend=
Oa.showLegend,delete Oa.showLegend));ca(da,Oa.featureCollection,Sa).then(function(Na){Oa.featureCollection=Na;da.featureCollection&&da.featureCollection.layers?a.forEach(Oa.featureCollection.layers,function(Ua,Ta){var Pa=da.featureCollection.layers[Ta];Pa.popupInfo||Pa.layerDefinition?Pa.layerDefinition?(g.isDefined(Pa.layerDefinition.minScale)&&g.isDefined(Pa.layerDefinition.maxScale)&&(Pa.layerDefinition.minScale!==Ua.layerDefinition.minScale||Pa.layerDefinition.maxScale!==Ua.layerDefinition.maxScale)&&
(delete Ua.layerDefinition.minScale,delete Ua.layerDefinition.maxScale),Pa.layerDefinition.drawingInfo&&y.toJson(Pa.layerDefinition.drawingInfo)!==y.toJson(Ua.layerDefinition.drawingInfo)&&delete Ua.layerDefinition.drawingInfo,Pa.layerDefinition.showLegend!==Ua.layerDefinition.showLegend&&delete Ua.layerDefinition.showLegend,Pa.layerDefinition=m.mixin(Pa.layerDefinition,Ua.layerDefinition)):Pa.layerDefinition=Ua.layerDefinition:(Pa.popupInfo=Ua.popupInfo,Pa.layerDefinition=Ua.layerDefinition);Pa.featureSet=
Ua.featureSet;Pa.nextObjectId=Ua.nextObjectId}):(da.featureCollection=da.featureCollection||{},da.featureCollection=m.mixin(da.featureCollection,Oa.featureCollection));Ma.callback(da)});return Ma}function ca(da,Sa,Oa){var Ma=new z;F(["./csv"],function(Na){var Ua=[];a.forEach(Sa.layers,function(Ta){Ta.featureSet&&Ta.featureSet.features&&Ta.featureSet.features.length&&Ta.featureSet.features[0].geometry&&Ta.featureSet.features[0].geometry.spatialReference&&(Ta.deferredsPos=Ua.length,Ua.push(Na.projectFeatureCollection(Ta,
Oa,Ta.featureSet.features[0].geometry.spatialReference)))});(new n(Ua)).addCallback(function(){a.forEach(Sa.layers,function(Ta){g.isDefined(Ta.deferredsPos)&&(Ua[Ta.deferredsPos].results&&Ua[Ta.deferredsPos].results.length?Ta=Ua[Ta.deferredsPos].results[0]:(Ta.errors=Ta.errors||[],Ta.errors.push({message:"Errors projecting feature collection. ["+da.title+" - "+Ta.layerDefinition.name+"]"})),delete Ta.deferredsPos)});Ma.callback(Sa)})});return Ma}function va(da,Sa,Oa,Ma,Na){var Ua=new z,Ta=new z,Pa=
[];a.forEach(da.operationalLayers,function(cb){cb.itemId&&"Feature Collection"==cb.type&&Pa.push(fa(cb).then(m.hitch(null,O,cb,Oa)))});if(0===Pa.length)H(da,Sa,Oa,Ma,Ta,Na);else{var $a=new n(Pa);$a.addCallback(function(cb){H(da,Sa,Oa,Ma,Ta,Na)})}Ta.then(function(cb){Pa=[];a.forEach(cb,function(kb){kb=kb.layerObject;if(kb instanceof ba&&!kb.loaded&&!kb.loadError){var Za=new z;q.once(kb,"load, error",function(){Za.callback(kb)});Pa.push(Za)}else kb&&"esri.layers.WFSLayer"===kb.declaredClass&&!kb.loadError&&
(Za=new z,q.once(kb,"fromJsonComplete, error",function(gb){Za.callback(kb)}),Pa.push(Za))});if(Pa.length){var bb=new z;$a=new n(Pa);$a.addCallback(function(){bb.callback(cb)});return bb.promise}return cb}).then(function(cb){var bb=[];a.forEach(cb,function(kb){var Za=kb.layerObject;Za&&(Za instanceof ba||"esri.layers.StreamLayer"===Za.declaredClass)?Za.loaded&&Za.labelingInfo&&(kb.showLabels||Za._collection?bb.push(Za):Za.setShowLabels&&Za.setShowLabels(!1)):Za&&"esri.layers.WFSLayer"===Za.declaredClass&&
Za.loaded&&Za.labelingInfo&&bb.push(Za)});bb.length?F(["../layers/LabelLayer"],function(kb){var Za=new kb;a.forEach(bb,function(gb){Za.addFeatureLayer(gb)});cb.push({layerObject:Za});Ua.callback(cb)}):Ua.callback(cb)});return Ua}function H(da,Sa,Oa,Ma,Na,Ua){var Ta=[],Pa=[],$a=[];a.forEach(da.operationalLayers,function(cb,bb){if(cb.featureCollection&&cb.featureCollection.layers){var kb=cb.featureCollection.layers.length;a.forEach(cb.featureCollection.layers,function(Za,gb){var ib=!0;cb.visibleLayers&&
-1==a.indexOf(cb.visibleLayers,gb)&&(ib=!1);Za.visibility=(null!=cb.visibility?!!cb.visibility:!0)&&ib;Za.opacity=cb.opacity;Za.id=(cb.id||"operational"+bb)+"_"+gb;cb.title&&(Za.title=1!==kb&&Za.layerDefinition.name&&cb.title!==Za.layerDefinition.name?cb.title+" - "+Za.layerDefinition.name:cb.title);null==Za.disablePopup&&(Za.disablePopup=cb.disablePopup);$a.push(Za)},this)}else $a.push(cb)});a.forEach(da.baseMap.baseMapLayers,function(cb,bb){cb.baseMapLayer=!0;cb.id=cb.id||"base"+bb;Ta.push(cb)});
a.forEach($a,function(cb,bb){cb.id=cb.id||"operational"+bb;Ta.push(cb)});a.forEach(Ta,function(cb){if(Y(cb)||cb&&"VectorTileLayer"===cb.layerType)cb.deferredsPos=Pa.length,cb.errors=cb.errors||[],cb.url?Pa.push(U(cb.url,cb.errors)):Pa.push(sa(cb.styleUrl,cb.errors))});0===Pa.length?(Oa=Oa||aa(Ta),Ta=La(Ta,Sa,Oa,Ma,Ua),Na.callback(Ta)):(new n(Pa)).addCallback(function(cb){Ya(cb,Ta,Sa,Pa,Na,Oa,Ma,Ua)});return Na}function R(da,Sa,Oa,Ma){var Na=da.minScale,Ua=da.maxScale;if(10.1>=Oa.version&&Sa)for(da=
Sa.length-1;0<=da;da--){if(Sa[da].id==Ma)if(0==Na&&0<Sa[da].minScale?Na=Sa[da].minScale:0<Na&&0==Sa[da].minScale?Na=Oa.minScale:0<Na&&0<Sa[da].minScale&&(Na=Math.min(Na,Sa[da].minScale)),Ua=Math.max(Oa.maxScale||0,Sa[da].maxScale||0),Oa.setScaleRange(Na,Ua),-1<Sa[da].parentLayerId)Ma=Sa[da].parentLayerId;else break}else 10.1<Oa.version&&(a.forEach(da.layerInfos,function(Ta){Ta.id==Ma&&(0==Na&&0<Ta.minScale?Na=Ta.minScale:0<Na&&0==Ta.minScale||0<Na&&0<Ta.minScale&&(Na=Math.min(Na,Ta.minScale)),Ua=
Math.max(Ua||0,Ta.maxScale||0))}),Oa.setScaleRange(Na,Ua))}function W(da,Sa,Oa,Ma){var Na=da.url,Ua=da.__popupIds,Ta=da.__popupUrls,Pa=da.__popupWhereClauses,$a=da.__popupMinScales,cb=da.__popupMaxScales,bb=da.__resourceInfo,kb=[];a.forEach(da.__popups,function(Za,gb){if(Za){var ib=[];a.forEach(Za.fieldInfos,function(Eb){"shape"!==Eb.fieldName.toLowerCase()&&ib.push(Eb.fieldName)});if(da.dynamicLayerInfos&&0<da.dynamicLayerInfos.length){var tb=a.filter(da.dynamicLayerInfos,function(Eb){return Ua[gb]==
Eb.id})[0].source;var Kb=new ba(Na+"/dynamicLayer",{parentLayer:da,id:da.id+"_"+Ua[gb],source:tb,outFields:ib,mode:ba.MODE_SELECTION,infoTemplate:Za&&new Oa(Za),drawMode:!1,visible:da.visible,autoGeneralize:!0});var jc=function(Eb,dc){0<Pa[Eb].length&&dc.setDefinitionExpression(Pa[Eb]);if(g.isDefined($a[Eb])||g.isDefined(cb[Eb]))if(g.isDefined(da.minScale)||g.isDefined(da.maxScale)){var Vb=da.minScale,gc=da.maxScale;0==Vb&&0<$a[Eb]?Vb=$a[Eb]:0<Vb&&0==$a[Eb]||0<Vb&&0<$a[Eb]&&(Vb=Math.min(Vb,$a[Eb]));
gc=Math.max(gc||0,cb[Eb]||0);dc.setScaleRange(Vb,gc)}else dc.setScaleRange($a[Eb],cb[Eb]);else R(da,Sa||bb.layers,dc,Ua[Eb])};Kb.loaded?jc(gb,Kb):D.connect(Kb,"onLoad",function(Eb){jc(gb,Kb)})}else{var kc=null,lc=Na+"/"+Ua[gb];if(Ta[gb].length)lc=Ta[gb];else if(Sa)for(tb=0;tb<Sa.length;tb++)if(Sa[tb].id===Ua[gb]){kc=Sa[tb];break}Kb=new ba(ea(lc),{parentLayer:da,id:da.id+"_"+Ua[gb],outFields:ib,mode:ba.MODE_SELECTION,infoTemplate:Za&&new Oa(Za),drawMode:!1,visible:da.visible,resourceInfo:kc,autoGeneralize:!0});
Kb.loaded?(0<Pa[gb].length&&Kb.setDefinitionExpression(Pa[gb]),R(da,Sa||bb.layers,Kb,Ua[gb])):D.connect(Kb,"onLoad",function(Eb){0<Pa[gb].length&&Kb.setDefinitionExpression(Pa[gb]);R(da,Sa||bb.layers,Eb,Ua[gb])})}kb.push(Kb)}});0<kb.length&&(D.connect(da,"onVisibilityChange",m.hitch(this,function(Za,gb){a.forEach(Za,function(ib){gb?ib.show():ib.hide()})},kb)),D.connect(Ma,"onLayerRemove",m.hitch(this,function(Za,gb,ib){Za.id===ib.id&&a.forEach(gb,function(tb){Ma.removeLayer(tb)})},da,kb)));delete da.__popups;
delete da.__popupIds;delete da.__popupUrls;delete da.__popupWhereClauses;delete da.__popupMinScales;delete da.__popupMaxScales;delete da.__resourceInfo;return kb}function pa(da){return k({url:ea(da.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function ra(da,Sa,Oa){var Ma=[];a.forEach(da,function(Ua){var Ta=Ua.__popups;Ta&&1<Ta.length&&10<=Ua.version&&(Ua.__deferredsPos=Ma.length,Ma.push(pa(Ua)))});var Na=[];0<Ma.length?(new n(Ma)).addCallback(function(Ua){a.forEach(da,
function(Ta){Ta.__popups&&0<Ta.__popups.length&&(Ta.__deferredsPos||0===Ta.__deferredsPos?(Na=Na.concat(W(Ta,Ua[Ta.__deferredsPos][1].layers,Oa,Sa)),delete Ta.__deferredsPos):Na=Na.concat(W(Ta,null,Oa,Sa)))});Sa.addLayers(Na)}):(a.forEach(da,function(Ua){Ua.__popups&&0<Ua.__popups.length&&(Na=Na.concat(W(Ua,null,Oa,Sa)))}),Sa.addLayers(Na))}function Aa(da){a.forEach(da,function(Sa){var Oa=Sa.layer;Oa.toJson&&(Sa=Oa.toJson(),Sa.featureSet&&Oa.name&&-1<Oa.name.indexOf("Text")&&a.forEach(Sa.featureSet.features,
function(Ma,Na){if(Ma.attributes.TEXT){var Ua=Oa.graphics[Na];Ua.symbol.setText(Ma.attributes.TEXT);Ma.symbol.horizontalAlignment&&(Ua.symbol.align=Ma.symbol.horizontalAlignment);Ua.setSymbol(Ua.symbol);Ua.setAttributes(Ma.attributes)}},this))})}function Ba(da){var Sa=6;a.forEach(da,function(Oa){if(Oa=Oa.renderer)"esri.renderer.SimpleRenderer"===Oa.declaredClass?((Oa=Oa.symbol)&&Oa.xoffset&&(Sa=Math.max(Sa,Math.abs(Oa.xoffset))),Oa&&Oa.yoffset&&(Sa=Math.max(Sa,Math.abs(Oa.yoffset)))):"esri.renderer.UniqueValueRenderer"!==
Oa.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==Oa.declaredClass||a.forEach(Oa.infos,function(Ma){(Ma=Ma.symbol)&&Ma.xoffset&&(Sa=Math.max(Sa,Math.abs(Ma.xoffset)));Ma&&Ma.yoffset&&(Sa=Math.max(Sa,Math.abs(Ma.yoffset)))})});return Sa}function Ja(da){var Sa=this,Oa=Sa.infoWindow,Ma=da.graphic;if(Sa.loaded){Oa.hide();Oa.clearFeatures();var Na=[];a.forEach(Sa.graphicsLayerIds,function(Za){(Za=Sa.getLayer(Za))&&Za instanceof ba&&Za.loaded&&Za.visible&&(Za.clearSelection(),Za.infoTemplate&&!Za.suspended&&
Na.push(Za))});a.forEach(Sa.layerIds,function(Za){(Za=Sa.getLayer(Za))&&(-1!==Za.declaredClass.indexOf("ArcGISImageServiceLayer")||-1!==Za.declaredClass.indexOf("RasterXLayer"))&&Za.loaded&&Za.visible&&Za.infoTemplate&&Na.push(Za)});Ma=Ma&&Ma.getInfoTemplate()?Ma:null;if(Na.length||Ma){var Ua=Ba(Na),Ta=da.screenPoint,Pa=Sa.toMap(new x(Ta.x-Ua,Ta.y+Ua));Ua=Sa.toMap(new x(Ta.x+Ua,Ta.y-Ua));var $a=new l(Pa.x,Pa.y,Ua.x,Ua.y,Sa.spatialReference),cb=new I;cb.geometry=$a;cb.timeExtent=Sa.timeExtent;var bb=
!0;Pa=a.map(Na,function(Za){Za=Za&&Za.isFeatureReductionActive&&Za.isFeatureReductionActive()?Za.getFeatureReductionLayer():Za;if(-1!==Za.declaredClass.indexOf("ArcGISImageServiceLayer")){cb.geometry=da.mapPoint;bb=!1;var gb=Za.queryVisibleRasters(cb,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0});gb.addCallback(function(){return Za.getVisibleRasters()})}else if(-1!==Za.declaredClass.indexOf("RasterXLayer"))gb=Za.fetchPopupFromTiles({geometry:da.mapPoint});else if("function"===
typeof Za.selectFeatures)gb=Za.selectFeatures(cb),gb.addCallback(function(){return Za.getSelectedFeatures()});else{gb=new z;var ib=a.filter(Za.graphics,function(tb){return tb&&tb.visible&&$a.intersects(tb.geometry)});gb.resolve(ib)}return gb});Ma&&(Ua=new z,Ua.callback([Ma]),Pa.splice(0,0,Ua));if(!a.some(Pa,function(Za){return-1===Za.fired})){var kb=Ma?1:0;a.forEach(Na,function(Za){kb=-1!==Za.declaredClass.indexOf("ArcGISImageServiceLayer")?kb+Za.getVisibleRasters().length:-1!==Za.declaredClass.indexOf("RasterXLayer")?
kb+Za.getPopupFromTiles().length:kb+Za.getSelectedFeatures().length});if(!kb)return}Oa.setFeatures(Pa);Oa.show(da.mapPoint,{closestFirst:bb})}}}function Ka(da,Sa){var Oa=Sa.mapOptions||{};if(!Oa.infoWindow){var Ma=new G({visibleWhenEmpty:!1},f.create("div"));Oa.infoWindow=Ma}g.isDefined(Oa.showInfoWindowOnClick)||Sa.usePopupManager||(Oa.showInfoWindowOnClick=!1);Oa=new t(da,Oa);D.connect(Oa,"onLayersAddResult",Aa);return Oa}function Ra(da,Sa,Oa,Ma,Na,Ua){if(Ma.map){var Ta=Ma.map;var Pa=Ma.clickEventHandle;
var $a=Ma.clickEventListener;var cb=Ma.errors}else{var bb=Oa.itemData;!Na.mapOptions.backgroundColor&&bb.background&&bb.background.color&&null!=bb.background.color[0]&&(Na.mapOptions.backgroundColor=h.toDojoColor(bb.background.color));Ta=Ka(Ma,Na);Na.ignorePopups||Na.disableClickBehavior||Na.usePopupManager||(Pa=D.connect(Ta,"onClick",Ja),$a=Ja)}Ta.addLayers(da);Na.ignorePopups||Na.usePopupManager||ra(da,Ta,Na._clazz);var kb=cb||[];a.forEach(Sa,function(Za){Za.errors&&(kb=kb.concat(Za.errors))},this);
Ta.loaded?Ua.callback({map:Ta,itemInfo:Oa,errors:kb,clickEventHandle:Pa,clickEventListener:$a}):D.connect(Ta,"onLoad",function(){Ua.callback({map:Ta,itemInfo:Oa,errors:kb,clickEventHandle:Pa,clickEventListener:$a})})}function Va(da,Sa,Oa,Ma,Na){var Ua=[];a.forEach(Na,function($a){m.isArray($a.layerObject)?a.forEach($a.layerObject,function(cb){Ua.push(cb)}):Ua.push($a.layerObject)});if(N(Na[0]))var Ta=setInterval(function(){if(Na[0].layerObject&&Na[0].layerObject.loaded)clearInterval(Ta),ab(da,Sa,
Oa,Ma,Na,Ua);else if(Na[0].errors){clearInterval(Ta);var $a="";Na[0].errors&&Na[0].errors.length&&($a=" ("+Na[0].errors[0].message+")");Ma.errback(Error(T.arcgis.utils.baseLayerError+$a))}},10);else if(!Ua[0]&&Na[0].baseMapLayer){var Pa="";Na[0].errors&&Na[0].errors.length&&(Pa=" ("+Na[0].errors[0].message+")");Ma.errback(Error(T.arcgis.utils.baseLayerError+Pa))}else ab(da,Sa,Oa,Ma,Na,Ua)}function ab(da,Sa,Oa,Ma,Na,Ua){try{var Ta=Oa.mapOptions||{};Oa.mapOptions=Ta;Ua=a.filter(Ua,g.isDefined);if(Sa.map||
Ta.extent)Ra(Ua,Na,da,Sa,Oa,Ma);else{var Pa=Ua[0].spatialReference;if(Ta.center&&(null!=Ta.zoom||Ta.scale)&&(m.isArray(Ta.center)&&(Ta.center=new u(Ta.center)),v.canProject(Ta.center,Pa))){Ra(Ua,Na,da,Sa,Oa,Ma);return}var $a=da.item;if($a&&$a.extent&&$a.extent.length){var cb=new l($a.extent[0][0],$a.extent[0][1],$a.extent[1][0],$a.extent[1][1],new w({wkid:4326}));4326===Pa.wkid?(Ta.extent=cb,Ra(Ua,Na,da,Sa,Oa,Ma)):900913===Pa.wkid||102100===Pa.wkid||102113===Pa.wkid||3857===Pa.wkid?(cb.xmin=Math.max(cb.xmin,
-180),cb.xmax=Math.min(cb.xmax,180),cb.ymin=Math.max(cb.ymin,-89.99),cb.ymax=Math.min(cb.ymax,89.99),Ta.extent=v.geographicToWebMercator(cb),Ra(Ua,Na,da,Sa,Oa,Ma)):Oa.geometryServiceURL||c.defaults.geometryService?(Oa.geometryServiceURL?new L(Oa.geometryServiceURL):c.defaults.geometryService).project([cb],Pa,function(bb){bb=bb[0];Ta.extent=Ta.extent||bb;Ra(Ua,Na,da,Sa,Oa,Ma)},function(){Ra(Ua,Na,da,Sa,Oa,Ma)}):Ma.errback(Error(T.arcgis.utils.geometryServiceError))}else Ra(Ua,Na,da,Sa,Oa,Ma)}}catch(bb){Ma.errback(bb)}}
function db(da){var Sa=[];a.forEach(da.operationalLayers,function(Oa){Oa.featureCollection?Sa.push({featureCollection:Oa.featureCollection,visibility:null!=Oa.visibility?!!Oa.visibility:!0,title:Oa.title}):Oa.layerObject&&Sa.push({layer:Oa.layerObject,visibility:null!=Oa.visibility?!!Oa.visibility:!0,title:Oa.title})});return Sa}function jb(da){var Sa=[],Oa=da.baseMap.baseMapLayers;da.operationalLayers&&(Oa=Oa.concat(da.operationalLayers));a.forEach(Oa,function(Ma){var Na={};if(Ma.featureCollection&&
(!Ma||"CSV"!==Ma.layerType&&"CSV"!==Ma.type))!0===Ma.featureCollection.showLegend&&a.forEach(Ma.featureCollection.layers,function(Pa){if(!1!==Pa.showLegend){var $a=Pa.layerObject.renderer;Na={layer:Pa.layerObject,title:Ma.title,defaultSymbol:$a&&$a.defaultSymbol&&$a.defaultLabel?!0:!1};1<Ma.featureCollection.layers.length&&(Na.title+=" - "+Pa.layerDefinition.name);Sa.push(Na)}});else if(Ma.baseMapLayer&&!0===Ma.showLegend&&Ma.layerObject||!Ma.baseMapLayer&&!1!==Ma.showLegend&&Ma.layerObject&&!(Ma.layerObject instanceof
ba&&Ma.layerObject.mode===ba.MODE_SELECTION)){var Ua=Ma.layerObject.renderer,Ta=Ma.layerObject.declaredClass;Ua=!Ua||Ua&&Ua.defaultSymbol&&Ua.defaultLabel?!0:!1;if(10.1>Ma.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===Ta||"esri.layers.ArcGISTiledMapServiceLayer"===Ta)||"esri.layers.ArcGISImageServiceLayer"===Ta)Ua=!0;Na={layer:Ma.layerObject,title:Ma.title,defaultSymbol:Ua};Ma.layers&&(Ta=a.map(a.filter(Ma.layers,function(Pa){return!1===Pa.showLegend}),function(Pa){return Pa.id}),
Ta.length&&(Na.hideLayers=Ta));Sa.push(Na)}});return Sa}function hb(da,Sa){function Oa(cb,bb){a.forEach(cb,function(kb,Za){switch(kb){case "../layers/ArcGISDynamicMapServiceLayer":xb=bb[Za];break;case "../layers/ArcGISImageServiceLayer":ub=bb[Za];break;case "../layers/ArcGISImageServiceVectorLayer":pb=bb[Za];break;case "../layers/CSVLayer":ob=bb[Za];break;case "../layers/DynamicLayerInfo":mb=bb[Za];break;case "../layers/GeoRSSLayer":Ab=bb[Za];break;case "../layers/ImageParameters":Db=bb[Za];break;
case "../layers/ImageServiceParameters":Jb=bb[Za];break;case "../layers/KMLLayer":Ub=bb[Za];break;case "../layers/LabelClass":Nb=bb[Za];break;case "../layers/LayerDrawingOptions":Rb=bb[Za];break;case "../layers/MosaicRule":$b=bb[Za];break;case "../layers/OpenStreetMapLayer":ac=bb[Za];break;case "../layers/RasterFunction":cc=bb[Za];break;case "../layers/RasterXLayer":rb=bb[Za];break;case "../layers/StreamLayer":wb=bb[Za];break;case "../layers/TileInfo":yb=bb[Za];break;case "../layers/VectorTileLayer":zb=
bb[Za];break;case "../layers/vectorTiles/layers/support/vectorTileLayerLoader":bc=bb[Za];break;case "../virtualearth/VETiledLayer":Tb=bb[Za];break;case "../layers/WebTiledLayer":oc=bb[Za];break;case "../layers/WFSLayer":Zb=bb[Za];break;case "../layers/WMSLayer":hc=bb[Za];break;case "../layers/WMSLayerInfo":Lb=bb[Za]}})}var Ma=new z,Na=da.itemData,Ua=[];Na.baseMap&&Na.baseMap.baseMapLayers&&(Ua=Ua.concat(Na.baseMap.baseMapLayers));Na.operationalLayers&&(Ua=Ua.concat(Na.operationalLayers));Na=a.map(Ua,
function(cb){return cb&&cb.layerType});var Ta=[],Pa=[];Ua=!1;for(var $a=0;$a<Na.length;$a++){switch(Na[$a]){case "ArcGISFeatureLayer":-1===a.indexOf(Ta,"../layers/LabelClass")&&Ta.push("../layers/LabelClass");break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===a.indexOf(Ta,"../layers/ArcGISImageServiceLayer")&&(Ta.push("../layers/ArcGISImageServiceLayer"),Pa.push("../layers/ImageServiceParameters"),Pa.push("../layers/MosaicRule"),Pa.push("../layers/RasterFunction"),Ta.push("../layers/RasterXLayer"));
break;case "ArcGISImageServiceVectorLayer":-1===a.indexOf(Ta,"../layers/ArcGISImageServiceVectorLayer")&&(Ta.push("../layers/ArcGISImageServiceVectorLayer"),Pa.push("../layers/ImageServiceParameters"),Pa.push("../layers/MosaicRule"),Pa.push("../layers/RasterFunction"));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===a.indexOf(Ta,"../layers/ArcGISDynamicMapServiceLayer")&&(Ta.push("../layers/ArcGISDynamicMapServiceLayer"),Pa.push("../layers/DynamicLayerInfo"),Pa.push("../layers/ImageParameters"),
Pa.push("../layers/LayerDrawingOptions"));break;case "ArcGISStreamLayer":-1===a.indexOf(Ta,"../layers/StreamLayer")&&Ta.push("../layers/StreamLayer");-1===a.indexOf(Ta,"../layers/LabelClass")&&Ta.push("../layers/LabelClass");break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===a.indexOf(Ta,"../virtualearth/VETiledLayer")&&Ta.push("../virtualearth/VETiledLayer");break;case "CSV":-1===a.indexOf(Ta,"../layers/CSVLayer")&&(Ta.push("../layers/CSVLayer"),Pa.push("./csv"));break;case "GeoRSS":-1===
a.indexOf(Ta,"../layers/GeoRSSLayer")&&Ta.push("../layers/GeoRSSLayer");break;case "KML":-1===a.indexOf(Ta,"../layers/KMLLayer")&&Ta.push("../layers/KMLLayer");break;case "OpenStreetMap":-1===a.indexOf(Ta,"../layers/OpenStreetMapLayer")&&Ta.push("../layers/OpenStreetMapLayer");break;case "VectorTileLayer":-1===a.indexOf(Ta,"../layers/VectorTileLayer")&&Ta.push("../layers/VectorTileLayer");-1===a.indexOf(Pa,"../layers/vectorTiles/layers/support/vectorTileLayerLoader")&&Pa.push("../layers/vectorTiles/layers/support/vectorTileLayerLoader");
break;case "WebTiledLayer":-1===a.indexOf(Ta,"../layers/WebTiledLayer")&&(Ta.push("../layers/WebTiledLayer"),Pa.push("../layers/TileInfo"));break;case "WFS":-1===a.indexOf(Ta,"../layers/WFSLayer")&&Ta.push("../layers/WFSLayer");break;case "WMS":-1===a.indexOf(Ta,"../layers/WMSLayer")&&(Ta.push("../layers/WMSLayer"),Pa.push("../layers/WMSLayerInfo"));break;default:Ua=!0}if(Ua)break}Ua&&(Ta=Xb,Pa=ic);Ta.length?F(Ta,function(){Oa(Ta,arguments);Pa.length?F(Pa,function(){Oa(Pa,arguments);Ma.resolve()}):
Ma.resolve()}):Ma.resolve();return Ma}function fb(da){da=da.itemData;var Sa=function(Ma,Na){"GroupLayer"===Ma.layerType?a.forEach(Ma.layers,function(Ua){Ua.visibility=!1===Ma.visibility?!1:Ua.visibility;Ua.opacity=g.isDefined(Ma.opacity)?g.isDefined(Ua.opacity)?Ua.opacity*Ma.opacity:Ma.opacity:Ua.opacity;Sa(Ua,Na)}):Na.push(Ma)},Oa=[];a.forEach(da.operationalLayers,function(Ma){Sa(Ma,Oa)});da.operationalLayers=Oa}function nb(da,Sa,Oa,Ma){fb(Ma);var Na=Ma.itemData;Na.baseMap&&Na.baseMap.baseMapLayers&&
Na.baseMap.baseMapLayers.length&&(Na.baseMap.baseMapLayers[0].firstLayer=!0);var Ua=Sa.layerMixins,Ta=Ua&&Ua.length;if(Ta){var Pa=function($a){for(var cb=0;cb<Ta;cb++){var bb=Ua[cb];if(bb.mixin)if(bb.hasOwnProperty("id")){if($a.id===bb.id){m.mixin($a,bb.mixin);break}}else if($a.url===bb.url){m.mixin($a,bb.mixin);break}}};a.forEach(Na.baseMap&&Na.baseMap.baseMapLayers,Pa);a.forEach(Na.operationalLayers,Pa)}hb(Ma,Sa).then(function(){return ja(Ma,Sa)}).then(function(){return ma(Ma,Sa)}).then(function($a){var cb=
$a[0],bb=$a[1];if(cb.itemData.operationalLayers&&0!==cb.itemData.operationalLayers.length){var kb=new z,Za=cb.itemData.baseMap.baseMapLayers.slice(),gb=a.filter(cb.itemData.baseMap.baseMapLayers,function(ib){return!ib.isReference});$a={item:cb.item,itemData:{baseMap:{baseMapLayers:gb},background:m.clone(cb.itemData.background)}};cb.itemData.baseMap.baseMapLayers=a.filter(cb.itemData.baseMap.baseMapLayers,function(ib){return ib.isReference});S($a,bb).addCallback(function(ib){va(ib.itemData,bb).addCallback(m.hitch(null,
Va,ib,da,bb,kb))});kb.then(function(ib){S(cb,bb).addCallback(function(tb){va(tb.itemData,bb,ib.map.spatialReference,gb,ib.map).addCallback(function(Kb){tb.itemData.baseMap.baseMapLayers=Za;Va(tb,ib,bb,Oa,Kb)})})},m.hitch(Oa,Oa.errback))}else S(cb,bb).addCallback(function(ib){va(ib.itemData,bb).addCallback(m.hitch(null,Va,ib,da,bb,Oa))})})}function qb(da,Sa){"undefined"===typeof Sa&&(Sa=!0);Hb._arcgisUrl&&0<Hb._arcgisUrl.length&&(Hb.arcgisUrl=Hb._arcgisUrl);var Oa={},Ma=new z;k({url:Hb.arcgisUrl+"/"+
da,content:{f:"json"},callbackParamName:"callback",load:function(Na){Oa.item=Na;Sa?k({url:Hb.arcgisUrl+"/"+da+"/data",content:{f:"json"},callbackParamName:"callback",load:function(Ua){Oa.itemData=Ua;Ma.callback(Oa)},error:function(Ua){Ma.errback(Ua)}}):Ma.callback(Oa)},error:function(Na){Ma.errback(Na)}});return Ma}var xb,ub,pb,ob,mb,Ab,Db,Jb,Ub,Nb,Rb,$b,ac,cc,rb,wb,yb,zb,bc,Tb,oc,Zb,hc,Lb,Xb="../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/ArcGISImageServiceVectorLayer ../layers/CSVLayer ../layers/GeoRSSLayer ../layers/KMLLayer ../layers/LabelClass ../layers/OpenStreetMapLayer ../layers/RasterXLayer ../layers/StreamLayer ../layers/VectorTileLayer ../virtualearth/VETiledLayer ../layers/WebTiledLayer ../layers/WFSLayer ../layers/WMSLayer".split(" "),
ic="./csv ../layers/DynamicLayerInfo ../layers/ImageParameters ../layers/ImageServiceParameters ../layers/LayerDrawingOptions ../layers/MosaicRule ../layers/RasterFunction ../layers/TileInfo ../layers/vectorTiles/layers/support/vectorTileLayerLoader ../layers/WMSLayerInfo".split(" ");var Hb={arcgisUrl:C.getProtocolForWebResource()+"//www.arcgis.com/sharing/rest/content/items",getItem:qb,createMap:function(da,Sa,Oa){var Ma=new z;Oa=Oa||{};var Na=Oa.infoTemplateClass;Oa._clazz=Na&&(m.isObject(Na)?Na:
m.getObject(Na))||E;m.isString(da)?qb(da).addCallback(m.hitch(null,nb,Sa,Oa,Ma)).addErrback(m.hitch(Ma,Ma.errback)):nb(Sa,Oa,Ma,da);Ma.addCallback(function(Ua){var Ta=Ua.map;Ta&&(Ta.tables=m.getObject("itemInfo.itemData.tables",!1,Ua)||[])});return Ma},getLayerList:function(da){return da&&da.itemInfo&&da.itemInfo.itemData?db(da.itemInfo.itemData):[]},getLegendLayers:function(da){return da&&da.itemInfo&&da.itemInfo.itemData?jb(da.itemInfo.itemData):[]},_arcgisUrl:null,_getItemProps:S,_getItemData:qa,
_getBingKey:V,_portalUrlResponse:X,_portalUrlFailure:oa,_processFSItemProperties:na,_processSSItemProperties:ya,_getLayers:va,_preBuildLayerObjects:Ya,_buildLayerObjects:La,_preCreateMap:Va,_getMapSR:aa,_createMap:Ra,_addSelectionLayers:ra,_createSelectionFeatureLayers:W,_getServiceInfo:U,_getFeatureCollectionItem:fa,_mergeFeatureCollectionItem:O,_projectFeatureCollection:ca,_getLayersInfo:pa,_initLayer:Ga,_loadAsCached:za,_loadAsDynamic:Da,_processPopups:Ha,_onLayersAddResult:Aa,_sameSpatialReferenceAsBasemap:ta,
_sameTilingSchemeAsBasemap:M,_showPopup:Ja,_calculateClickTolerance:Ba,_getVisibleFeatureLayers:Ca,_updateLayerScaleInfo:R,_checkUrl:ea,_isHostedService:Ia,_isAgolService:ia,_getLegendLayers:jb};m.setObject("arcgis.utils",Hb,b);return Hb})},"esri/tasks/RouteTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../request ../geometry/normalizeUtils ./Task ./RouteResult ./NAMessage ./NAServiceDescription".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,
e){F=F([n,e],{declaredClass:"esri.tasks.RouteTask",_eventMap:{"solve-complete":["result"]},constructor:function(b){this._url.orig=this._url.path;this._url.path+="/solve";this._handler=m.hitch(this,this._handler);this.registerConnectEvents()},__msigns:[{n:"solve",c:3,a:[{i:0,p:["stops.features","barriers.features","polylineBarriers.features","polygonBarriers.features"]}],e:2}],_handler:function(b,c,h,g,k){try{var w=[],t=[],C=b.directions||[],u=b.routes?b.routes.features:[],x=b.stops?b.stops.features:
[],l=b.barriers?b.barriers.features:[],v=b.polygonBarriers?b.polygonBarriers.features:[],A=b.polylineBarriers?b.polylineBarriers.features:[],B=b.messages,E=a.forEach,G=a.indexOf,I=!0,L,K,ba=b.routes&&b.routes.spatialReference||b.stops&&b.stops.spatialReference||b.barriers&&b.barriers.spatialReference||b.polygonBarriers&&b.polygonBarriers.spatialReference||b.polylineBarriers&&b.polylineBarriers.spatialReference;this._chk=b.checksum;E(C,function(J){w.push(L=J.routeName);t[L]={directions:J}});E(u,function(J){-1===
G(w,L=J.attributes.Name)&&(w.push(L),t[L]={});t[L].route=J});E(x,function(J){K=J.attributes;-1===G(w,L=K.RouteName||"esri.tasks.RouteTask.NULL_ROUTE_NAME")&&(w.push(L),t[L]={});"esri.tasks.RouteTask.NULL_ROUTE_NAME"!==L&&(I=!1);void 0===t[L].stops&&(t[L].stops=[]);t[L].stops.push(J)});0<x.length&&!0===I&&(t[w[0]].stops=t["esri.tasks.RouteTask.NULL_ROUTE_NAME"].stops,delete t["esri.tasks.RouteTask.NULL_ROUTE_NAME"],w.splice(a.indexOf(w,"esri.tasks.RouteTask.NULL_ROUTE_NAME"),1));var T=[];E(w,function(J,
N){t[J].routeName="esri.tasks.RouteTask.NULL_ROUTE_NAME"===J?null:J;t[J].spatialReference=ba;T.push(new f(t[J]))});b=function(J){E(J,function(N,Z){N.geometry&&(N.geometry.spatialReference=ba);J[Z]=new y(N)});return J};E(B,function(J,N){B[N]=new d(J)});var P={routeResults:T,barriers:b(l),polygonBarriers:b(v),polylineBarriers:b(A),messages:B};this._successHandler([P],"onSolveComplete",h,k)}catch(J){this._errorHandler(J,g,k)}},solve:function(b,c,h,g){var k=g.assembly;b=this._encode(m.mixin({},this._url.query,
{f:"json"},b.toJson(k&&k[0]),this._chk?{checksum:this._chk}:{}));var w=this._handler,t=this._errorHandler;return r({url:this._url.path,timeout:25E4,content:b,callbackParamName:"callback",load:function(C,u){w(C,u,c,h,g.dfd)},error:function(C){t(C,h,g.dfd)}})},onSolveComplete:function(){}});q._createWrappers(F);m.setObject("tasks.RouteTask",F,z);return F})},"esri/tasks/RouteResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ./DirectionsFeatureSet".split(" "),
function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.tasks.RouteResult",constructor:function(q){var n=q.spatialReference,f=q.route;if(q.directions){var d=[],e=[],b=[];a.forEach(q.directions.features,function(h,g){e[g]=h.compressedGeometry;d[g]=h.strings;b[g]=h.events});q.directions.strings=d;q.directions.events=b;this.directions=new r(q.directions,e)}this.routeName=q.routeName;f&&(f.geometry&&(f.geometry.spatialReference=n),this.route=new y(f));if(q.stops){var c=this.stops=[];a.forEach(q.stops,function(h,
g){h.geometry&&(h.geometry.spatialReference=n);c[h.attributes.Sequence-1]=new y(h)})}},routeName:null,directions:null,route:null,stops:null});m.setObject("tasks.RouteResult",F,z);return F})},"esri/tasks/DirectionsFeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/json ../kernel ../geometry/Extent ../geometry/Polyline ../geometry/Point ../graphic ./FeatureSet".split(" "),function(F,m,a,D,z,y,r,q,n,f,d){F=F(d,{declaredClass:"esri.tasks.DirectionsFeatureSet",
constructor:function(e,b){this.routeId=e.routeId;this.routeName=e.routeName;m.mixin(this,e.summary);this.extent=new r(this.envelope);var c=this._fromCompressedGeometry,h=this.features,g=this.extent.spatialReference,k=[];a.forEach(b,function(w,t){h[t].setGeometry(k[t]=w?c(w,g):h[t].geometry)});this.mergedGeometry=this._mergePolylinesToSinglePath(k,g);this.geometryType="esriGeometryPolyline";a.forEach(e.events,function(w,t){a.forEach(w,function(C,u){w[u]=new f(new n(C.point.x,C.point.y,g),null,{ETA:C.ETA,
strings:z.stringify(C.strings),arriveTimeUTC:C.arriveTimeUTC})});e.events[t]=w});delete this.envelope},_fromCompressedGeometry:function(e,b){var c=0,h=0,g=0,k=0,w=[],t,C=0,u=0,x=0;(t=e.match(/((\+|\-)[^\+\-\|]+|\|)/g))||(t=[]);if(0===parseInt(t[C],32)){C=2;var l=parseInt(t[C],32);C++;var v=parseInt(t[C],32);C++;if(l&1){u=a.indexOf(t,"|")+1;var A=parseInt(t[u],32);u++}if(l&2){x=a.indexOf(t,"|",u)+1;var B=parseInt(t[x],32);x++}}else v=parseInt(t[C],32),C++;for(;C<t.length&&"|"!==t[C];){l=parseInt(t[C],
32)+c;C++;c=l;var E=parseInt(t[C],32)+h;C++;h=E;l=[l/v,E/v];u&&(E=parseInt(t[u],32)+g,u++,g=E,l.push(E/A));x&&(E=parseInt(t[x],32)+k,x++,k=E,l.push(E/B));w.push(l)}c=new q({paths:[w],hasZ:0<u,hasM:0<x});c.setSpatialReference(b);return c},_mergePolylinesToSinglePath:function(e,b){var c=[],h=!1;a.forEach(e,function(w){a.forEach(w.paths,function(t){h=h||w.hasM;c=c.concat(t)})});var g=[],k=[0,0];a.forEach(c,function(w){if(w[0]!==k[0]||w[1]!==k[1])g.push(w),k=w});return new q({paths:[g],spatialReference:b,
hasM:h})}});m.setObject("tasks.DirectionsFeatureSet",F,y);return F})},"esri/tasks/NAMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.NAMessage",constructor:function(z){m.mixin(this,z)}});m.mixin(F,{TYPE_INFORMATIVE:0,TYPE_PROCESS_DEFINITION:1,TYPE_PROCESS_START:2,TYPE_PROCESS_STOP:3,TYPE_WARNING:50,TYPE_ERROR:100,TYPE_EMPTY:101,TYPE_ABORT:200});m.setObject("tasks.NAMessage",F,D);return F})},"esri/tasks/NAServiceDescription":function(){define(["dojo/_base/declare",
"dojo/json","dojo/Deferred","dojo/_base/lang","../request"],function(F,m,a,D,z){return F(null,{declaredClass:"esri.tasks._NAServiceDescription",_sd:null,getServiceDescription:function(y,r){var q=new a;if(this._sd)q.resolve(this._sd);else if(this._url&&this._url.orig){var n=this._url.orig,f=(this._url.path.match(/\/solve$/)||[]).length?"Route":(this._url.path.match(/\/solveClosestFacility$/)||[]).length?"ClosestFacility":"ServiceAreas",d,e=function(b){z({url:b+("/"===b[b.length-1]?"":"/")+"GetTravelModes/execute",
content:{f:"json",serviceName:f},callbackParamName:"callback"}).then(function(c){var h=[],g=null;if(c&&c.results&&c.results.length)for(var k=0;k<c.results.length;k++)if("supportedTravelModes"===c.results[k].paramName){if(c.results[k].value&&c.results[k].value.features)for(var w=0;w<c.results[k].value.features.length;w++)if(c.results[k].value.features[w].attributes){var t=m.parse(c.results[k].value.features[w].attributes.TravelMode);h.push(t)}}else"defaultTravelMode"===c.results[k].paramName&&(g=c.results[k].value);
d.supportedTravelModes=h;d.defaultTravelMode=g;q.resolve(d)},function(c){q.reject(c)})};z({url:n,content:{f:"json"},callbackParamName:"callback"}).then(function(b){d=b;d.supportedTravelModes||(d.supportedTravelModes=[]);for(b=0;b<d.supportedTravelModes.length;b++)d.supportedTravelModes[b].id||(d.supportedTravelModes[b].id=d.supportedTravelModes[b].itemId);r?q.resolve(d):y?e(y):10.4<=d.currentVersion?z({url:n+("/"===n[n.length-1]?"":"/")+"retrieveTravelModes",content:{f:"json"},callbackParamName:"callback"}).then(function(c){d.supportedTravelModes=
c.supportedTravelModes;d.defaultTravelMode=c.defaultTravelMode;q.resolve(d)},function(c){q.reject(c)}):z({url:n.substring(0,n.indexOf("/rest/")+6)+"info",content:{f:"json"},callbackParamName:"callback"}).then(function(c){c.owningSystemUrl?(n=c.owningSystemUrl,z({url:n+("/"===n[n.length-1]?"":"/")+"sharing/rest/portals/self",content:{f:"json"},callbackParamName:"callback"}).then(function(h){h&&h.helperServices&&h.helperServices.routingUtilities&&h.helperServices.routingUtilities.url?e(h.helperServices.routingUtilities.url):
q.resolve(d)},function(h){q.reject(h)})):q.resolve(d)},function(c){q.reject(c)})},function(b){q.reject(b)})}else q.reject("NA Task has no URL specified.");q.then(D.hitch(this,function(b){this._sd=b}),D.hitch(this,function(){this._sd=null}));return q.promise},getOwningSystemUrl:function(){var y=new a;if(this._url&&this._url.orig){var r=this._url.orig;z({url:r.substring(0,r.indexOf("/rest/")+6)+"info",content:{f:"json"},callbackParamName:"callback"}).promise.always(function(q){y.resolve(q.owningSystemUrl)})}else y.resolve(void 0);
return y.promise}})})},"esri/tasks/RouteParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang ../graphicsUtils ./NATypes".split(" "),function(F,m,a,D,z,y,r,q){F=F(null,{declaredClass:"esri.tasks.RouteParameters",accumulateAttributes:null,attributeParameterValues:null,barriers:null,directionsLanguage:null,directionsLengthUnits:null,directionsOutputType:null,directionsStyleName:null,directionsTimeAttribute:null,doNotLocateOnRestrictedElements:!0,
findBestSequence:null,ignoreInvalidLocations:null,impedanceAttribute:null,outputLines:"esriNAOutputLineTrueShape",outputGeometryPrecision:null,outputGeometryPrecisionUnits:null,outSpatialReference:null,overrides:null,polygonBarriers:null,polylineBarriers:null,preserveFirstStop:null,preserveLastStop:null,restrictionAttributes:null,restrictUTurns:null,returnBarriers:!1,returnDirections:!1,returnPolygonBarriers:!1,returnPolylineBarriers:!1,returnRoutes:!0,returnStops:!1,returnZ:!0,startTime:null,startTimeIsUTC:null,
timeWindowsAreUTC:null,stops:null,useHierarchy:null,useTimeWindows:null,travelMode:null,toJson:function(n){var f={returnDirections:this.returnDirections,returnRoutes:this.returnRoutes,returnZ:this.returnZ,returnStops:this.returnStops,returnBarriers:this.returnBarriers,returnPolygonBarriers:this.returnPolygonBarriers,returnPolylineBarriers:this.returnPolylineBarriers,attributeParameterValues:this.attributeParameterValues&&a.toJson(this.attributeParameterValues),outSR:this.outSpatialReference?this.outSpatialReference.wkid||
a.toJson(this.outSpatialReference.toJson()):null,outputLines:this.outputLines,overrides:this.overrides,findBestSequence:this.findBestSequence,preserveFirstStop:this.preserveFirstStop,preserveLastStop:this.preserveLastStop,useTimeWindows:this.useTimeWindows,startTime:this.startTime?this.startTime.getTime():null,startTimeIsUTC:this.startTimeIsUTC,timeWindowsAreUTC:this.timeWindowsAreUTC,accumulateAttributeNames:this.accumulateAttributes?this.accumulateAttributes.join(","):null,ignoreInvalidLocations:this.ignoreInvalidLocations,
impedanceAttributeName:this.impedanceAttribute,restrictionAttributeNames:this.restrictionAttributes?this.restrictionAttributes.join(","):null,restrictUTurns:this.restrictUTurns,useHierarchy:this.useHierarchy,directionsLanguage:this.directionsLanguage,outputGeometryPrecision:this.outputGeometryPrecision,outputGeometryPrecisionUnits:this.outputGeometryPrecisionUnits,directionsLengthUnits:q.LengthUnit[this.directionsLengthUnits],directionsTimeAttributeName:this.directionsTimeAttribute,directionsStyleName:this.directionsStyleName,
travelMode:"object"===typeof this.travelMode?a.toJson(this.travelMode):this.travelMode},d=this.stops;"esri.tasks.FeatureSet"===d.declaredClass&&0<d.features.length?f.stops=a.toJson({type:"features",features:r._encodeGraphics(d.features,n&&n["stops.features"]),doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements}):"esri.tasks.DataLayer"===d.declaredClass?f.stops=d:"esri.tasks.DataFile"===d.declaredClass&&(f.stops=a.toJson({type:"features",url:d.url,doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements}));
if(this.directionsOutputType)switch(this.directionsOutputType.toLowerCase()){case "complete":f.directionsOutputType="esriDOTComplete";break;case "complete-no-events":f.directionsOutputType="esriDOTCompleteNoEvents";break;case "instructions-only":f.directionsOutputType="esriDOTInstructionsOnly";break;case "standard":f.directionsOutputType="esriDOTStandard";break;case "summary-only":f.directionsOutputType="esriDOTSummaryOnly";break;default:f.directionsOutputType=this.directionsOutputType}d=function(e,
b){return e?"esri.tasks.FeatureSet"===e.declaredClass?0<e.features.length?a.toJson({type:"features",features:r._encodeGraphics(e.features,n&&n[b])}):null:"esri.tasks.DataLayer"===e.declaredClass?e:"esri.tasks.DataFile"===e.declaredClass?a.toJson({type:"features",url:e.url}):a.toJson(e):null};this.barriers&&(f.barriers=d(this.barriers,"barriers.features"));this.polygonBarriers&&(f.polygonBarriers=d(this.polygonBarriers,"polygonBarriers.features"));this.polylineBarriers&&(f.polylineBarriers=d(this.polylineBarriers,
"polylineBarriers.features"));return y.filter(f,function(e){if(null!==e)return!0})}});m.setObject("tasks.RouteParameters",F,z);return F})},"esri/tasks/NATypes":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(F,m,a){m={esriFeet:"esriNAUFeet",esriKilometers:"esriNAUKilometers",esriMeters:"esriNAUMeters",esriMiles:"esriNAUMiles",esriNauticalMiles:"esriNAUNauticalMiles",esriYards:"esriNAUYards"};var D={NONE:"esriNAOutputLineNone",STRAIGHT:"esriNAOutputLineStraight",TRUE_SHAPE:"esriNAOutputLineTrueShape",
TRUE_SHAPE_WITH_MEASURE:"esriNAOutputLineTrueShapeWithMeasure"},z={ALLOW_BACKTRACK:"esriNFSBAllowBacktrack",AT_DEAD_ENDS_ONLY:"esriNFSBAtDeadEndsOnly",NO_BACKTRACK:"esriNFSBNoBacktrack",AT_DEAD_ENDS_AND_INTERSECTIONS:"esriNFSBAtDeadEndsAndIntersections"},y={NONE:"esriNAOutputPolygonNone",SIMPLIFIED:"esriNAOutputPolygonSimplified",DETAILED:"esriNAOutputPolygonDetailed"},r={FROM_FACILITY:"esriNATravelDirectionFromFacility",TO_FACILITY:"esriNATravelDirectionToFacility"},q={LengthUnit:m,OutputLine:D,
UTurn:z,OutputPolygon:y,TravelDirection:r};F.setObject("tasks._NALengthUnit",m,a);F.setObject("tasks.NAOutputLine",D,a);F.setObject("tasks.NAUTurn",z,a);F.setObject("tasks.NAOutputPolygon",y,a);F.setObject("tasks.NATravelDirection",r,a);return q})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ../request ../urlUtils ../geometry/Polygon ../renderers/SimpleRenderer ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate ./Task dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query ./PrintParameters ./LegendLayer".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v){F=F(t,{declaredClass:"esri.tasks.PrintTask",constructor:function(A,B){this.url=A;this.printGp=new k(this.url);this._handler=m.hitch(this,this._handler);B&&B.async&&(this.async=!0);this._colorEvaluator=v("$..color")},async:!1,_vtlExtent:null,_cimVersion:null,_is11xService:!1,_loadGpServerMetadata:!0,execute:function(A,B,E){if(!this._loadGpServerMetadata)return this._execute(A,B,E);var G=new z(f._dfdCanceller),I=this._url.path,L=I.lastIndexOf("/GPServer/");
0<L&&(I=I.slice(0,L+9));G._pendingDfd=e({url:I,callbackParamName:"callback",content:m.mixin({},this._url.query,{f:"json"})}).then(m.hitch(this,function(K){this._loadGpServerMetadata=!1;this.async="esriExecutionTypeAsynchronous"===K.executionType;this._cimVersion=K.cimVersion;this._is11xService=!!this._cimVersion;G._pendingDfd=this._execute(A);return G._pendingDfd})).then(m.hitch(this,function(K){this._successHandler([K],null,B,G)})).otherwise(function(K){E&&E(K);G.errback(K)});return G},_handler:function(A,
B,E,G,I){try{if(this.async)"esriJobSucceeded"===A.jobStatus?this.printGp.getResultData(A.jobId,"Output_File",m.hitch(this,function(K){L=K.value;this._successHandler([L],"onComplete",E,I)})):this._errorHandler(Error(A.jobStatus),G,I);else{var L=A[0].value;this._successHandler([L],"onComplete",E,I)}}catch(K){this._errorHandler(K,G,I)}},_execute:function(A,B,E){var G=this._handler,I=this._errorHandler,L=A.template||new w;L.hasOwnProperty("showLabels")||(L.showLabels=!0);var K=L.exportOptions,ba;K&&(ba=
{outputSize:[K.width,K.height],dpi:K.dpi});K=L.layoutOptions;var T=[];if(K){this.legendAll=!1;K.legendLayers?a.forEach(K.legendLayers,function(ma){var ja={};ja.id=ma.layerId;ma.subLayerIds&&(ja.subLayerIds=ma.subLayerIds);T.push(ja)}):this.legendAll=!0;if("Miles"===K.scalebarUnit||"Kilometers"===K.scalebarUnit){var P="esriKilometers";var J="esriMiles"}else if("Meters"===K.scalebarUnit||"Feet"===K.scalebarUnit)P="esriMeters",J="esriFeet";var N={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};
N={titleText:K.titleText,authorText:K.authorText,copyrightText:K.copyrightText,customTextElements:K.customTextElements,scaleBarOptions:{metricUnit:P,metricLabel:N[P],nonMetricUnit:J,nonMetricLabel:N[J]},legendOptions:{operationalLayers:T}}}P=this._getPrintDefinition(A.map,L);A.outSpatialReference&&(P.mapOptions.spatialReference=A.outSpatialReference.toJson());A.template&&q.isDefined(A.template.showAttribution)&&(P.mapOptions.showAttribution=A.template.showAttribution);m.mixin(P,{exportOptions:ba,
layoutOptions:N});this.allLayerslegend&&m.mixin(P.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});if(P.operationalLayers){ba=P.operationalLayers;var Z=function(ma){return q.fixJson(m.mixin(ma,{type:"esriSLS",cap:void 0,join:void 0,meterLimit:void 0}))},Y=RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),qa=/[\u0600-\u06FF]/,V=function(ma){var ja=ma.text,X=(ma=ma.font)&&ma.family&&ma.family.toLowerCase();ja&&ma&&("arial"===
X||"arial unicode ms"===X)&&(ma.family=Y.test(ja)?"Arial Unicode MS":"Arial","normal"!==ma.style&&qa.test(ja)&&(ma.family="Arial Unicode MS"))};for(N=0;N<ba.length;N++)if(ba[N].featureCollection&&ba[N].featureCollection.layers)for(J=0;J<ba[N].featureCollection.layers.length;J++){var na=ba[N].featureCollection.layers[J];if(na.layerDefinition&&na.layerDefinition.drawingInfo&&na.layerDefinition.drawingInfo.renderer&&na.layerDefinition.drawingInfo.renderer.symbol){var ya=na.layerDefinition.drawingInfo.renderer;
"esriCLS"===ya.symbol.type?ya.symbol=Z(ya.symbol):"esriTS"===ya.symbol.type?V(ya.symbol):ya.symbol.outline&&"esriCLS"===ya.symbol.outline.type&&(ya.symbol.outline=Z(ya.symbol.outline))}if(na.featureSet&&na.featureSet.features)for(K=0;K<na.featureSet.features.length;K++)ya=na.featureSet.features[K],ya.symbol&&("esriCLS"===ya.symbol.type?ya.symbol=Z(ya.symbol):"esriTS"===ya.symbol.type?V(ya.symbol):ya.symbol.outline&&"esriCLS"===ya.symbol.outline.type&&(ya.symbol.outline=Z(ya.symbol.outline)))}}L={Web_Map_as_JSON:D.toJson(q.fixJson(P)),
Format:L.format,Layout_Template:L.layout};A.extraParameters&&(L=m.mixin(L,A.extraParameters));var S=new z(f._dfdCanceller);A=function(ma,ja){G(ma,ja,B,E,S)};P=function(ma){I(ma,E,S)};S._pendingDfd=this.async?this.printGp.submitJob(L,A,null,P):this.printGp.execute(L,A,P);return S},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",
features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",
drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(A){if(!(8>=y("ie")||!A.path&&"image/svg+xml"!==A.contentType)){var B=l.createSurface(u.create("div"),1024,1024);var E="image/svg+xml"===A.contentType?B.createObject(l.Image,{src:"data:image/svg+xml;base64,"+A.imageData,width:x.pt2px(A.width),height:x.pt2px(A.height),x:0,y:0}):B.createObject(l.Path,A.path).setFill(A.color).setStroke(A.outline);"pendingRender"in B&&B._render(!0);var G=
B.rawNode.getContext("2d"),I=Math.ceil(E.getBoundingBox().width),L=Math.ceil(E.getBoundingBox().height);E=G.getImageData(E.getBoundingBox().x,E.getBoundingBox().y,I,L);G.canvas.width=I;G.canvas.height=L;G.putImageData(E,0,0);G=G.canvas.toDataURL("image/png");A={type:"esriPMS",imageData:G.substr(22,G.length),angle:A.angle,contentType:"image/png",height:A.size?A.size:x.px2pt(L),width:A.size?I/L*A.size:x.px2pt(I),xoffset:A.xoffset,yoffset:A.yoffset};B.destroy();return A}},_convertSvgRenderer:function(A){"simple"===
A.type&&A.symbol&&(A.symbol.path||"image/svg+xml"===A.symbol.contentType)?A.symbol=this._convertSvgSymbol(A.symbol):"uniqueValue"===A.type?(A.defaultSymbol&&(A.defaultSymbol.path||"image/svg+xml"===A.defaultSymbol.contentType)&&(A.defaultSymbol=this._convertSvgSymbol(A.defaultSymbol)),A.uniqueValueInfos&&a.forEach(A.uniqueValueInfos,function(B){if(B.symbol.path||"image/svg+xml"===B.symbol.contentType)B.symbol=this._convertSvgSymbol(B.symbol)},this)):"classBreaks"===A.type&&(A.defaultSymbol&&(A.defaultSymbol.path||
"image/svg+xml"===A.defaultSymbol.contentType)&&(A.defaultSymbol=this._convertSvgSymbol(A.defaultSymbol)),A.classBreakInfos&&a.forEach(A.classBreakInfos,function(B){if(B.symbol.path||"image/svg+xml"===B.symbol.contentType)B.symbol=this._convertSvgSymbol(B.symbol)},this))},_createFeatureCollection:function(A,B,E,G){var I=this._createPolygonLayer(),L=this._createPolylineLayer(),K=this._createPointLayer(),ba=this._createMultipointLayer(),T=this._createPointLayer();T.layerDefinition.name="textLayer";
delete T.layerDefinition.drawingInfo;if("esri.layers.FeatureLayer"===A.declaredClass||"esri.layers.StreamLayer"===A.declaredClass)I.layerDefinition.name=L.layerDefinition.name=K.layerDefinition.name=ba.layerDefinition.name=m.getObject("arcgisProps.title",!1,A)||A.name||A.id;var P=A.renderer&&"esri.renderer.SimpleRenderer"===A.renderer.declaredClass;if(!A.renderer||A.renderer.valueExpression||m.isFunction(A.renderer.attributeField))delete I.layerDefinition.drawingInfo,delete L.layerDefinition.drawingInfo,
delete K.layerDefinition.drawingInfo,delete ba.layerDefinition.drawingInfo;else{var J=A.renderer.toJson({useLegacyRotationProperties:!0});if("temporal"===J.type){J={latestObservationRenderer:J.latestObservationRenderer,trackLinesRenderer:J.trackRenderer,observationAger:J.observationAger,renderer:J.observationRenderer};var N={};A._trackIdField&&(N.trackIdField=A._trackIdField);A._startTimeField&&(N.startTimeField=A._startTimeField);A._endTimeField&&(N.endTimeField=A._endTimeField);I.layerDefinition.drawingInfo=
J;I.layerDefinition.timeInfo=N;L.layerDefinition.drawingInfo=J;L.layerDefinition.timeInfo=N;K.layerDefinition.drawingInfo=J;K.layerDefinition.timeInfo=N;ba.layerDefinition.drawingInfo=J;ba.layerDefinition.timeInfo=N}else I.layerDefinition.drawingInfo.renderer=J,L.layerDefinition.drawingInfo.renderer=J,K.layerDefinition.drawingInfo.renderer=J,ba.layerDefinition.drawingInfo.renderer=J}J=A.fields;J||!A.renderer||A.renderer.valueExpression||m.isFunction(A.renderer.attributeField)||("esri.renderer.ClassBreaksRenderer"===
A.renderer.declaredClass?(J=[{name:A.renderer.attributeField,type:"esriFieldTypeDouble"}],A.renderer.normalizationField&&J.push({name:A.renderer.normalizationField,type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===A.renderer.declaredClass&&(J=[{name:A.renderer.attributeField,type:"esriFieldTypeString"}],A.renderer.attributeField2&&J.push({name:A.renderer.attributeField2,type:"esriFieldTypeString"}),A.renderer.attributeField3&&J.push({name:A.renderer.attributeField3,type:"esriFieldTypeString"})));
J&&(I.layerDefinition.fields=J,L.layerDefinition.fields=J,K.layerDefinition.fields=J,ba.layerDefinition.fields=J);J=A.graphics;A.isFeatureReductionActive&&A.isFeatureReductionActive()&&(J=A.getSingleGraphics());N=J.length;var Z;for(Z=0;Z<N;Z++){var Y=J[Z];if(!1!==Y.visible&&Y.geometry){var qa=Y.toJson();qa.symbol&&qa.symbol.outline&&qa.symbol.outline.color&&qa.symbol.outline.color[3]&&!this._is11xService&&(qa.symbol.outline.color[3]=255);if(A.renderer&&!qa.symbol&&(m.isFunction(A.renderer.attributeField)||
A.renderer.valueExpression||this._isFeatureCollectionRequired(A.renderer,A)||"esri.renderer.DotDensityRenderer"===A.renderer.declaredClass||E)){E=E||A.renderer;var V=null;try{V=E.getSymbol(Y)}catch(na){}if(!V)continue;qa.symbol=V.toJson();this._isFeatureCollectionRequired(E,A)&&this._applyVisualVariables(qa.symbol,{renderer:E,graphic:Y,symbol:V,mapResolution:B&&B.getResolutionInMeters(),mapScale:B&&B.getScale()})}qa.symbol&&(qa.symbol.path||"image/svg+xml"===qa.symbol.contentType?qa.symbol=this._convertSvgSymbol(qa.symbol):
qa.symbol.text&&delete qa.attributes);switch(Y.geometry.type){case "polygon":I.featureSet.features.push(qa);break;case "polyline":L.featureSet.features.push(qa);break;case "point":qa.symbol&&qa.symbol.text?T.featureSet.features.push(qa):K.featureSet.features.push(qa);break;case "multipoint":ba.featureSet.features.push(qa);break;case "extent":qa.geometry=c.fromExtent(Y.geometry).toJson(),I.featureSet.features.push(qa)}}}B=[];0<I.featureSet.features.length&&B.push(I);0<L.featureSet.features.length&&
B.push(L);0<ba.featureSet.features.length&&B.push(ba);0<K.featureSet.features.length&&B.push(K);0<T.featureSet.features.length&&B.push(T);if(!B.length)return null;a.forEach(B,function(na){var ya=a.every(na.featureSet.features,function(S){return S.symbol});if(P||ya)G&&G.forceFeatureAttributes||a.forEach(na.featureSet.features,function(S){delete S.attributes}),G.forceFeatureAttributes||delete na.layerDefinition.fields;ya&&delete na.layerDefinition.drawingInfo});a.forEach(B,function(na){na.layerDefinition.drawingInfo&&
na.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(na.layerDefinition.drawingInfo.renderer)},this);return{id:A.id,opacity:A.opacity,minScale:A.minScale||0,maxScale:A.maxScale||0,featureCollection:{layers:B}}},_getPrintDefinition:function(A,B){var E={operationalLayers:this._createOperationalLayers(A,B)},G=this._vtlExtent||A.extent,I=A.spatialReference;this._vtlExtent=null;A.spatialReference._isWrappable()&&(G=G._normalize(!0),I=G.spatialReference);G={mapOptions:{showAttribution:A.showAttribution,
extent:G.toJson(),spatialReference:I.toJson()}};B.preserveScale&&m.mixin(G.mapOptions,{scale:B.outScale||A.getScale()});A.timeExtent&&m.mixin(G.mapOptions,{time:[A.timeExtent.startTime.getTime(),A.timeExtent.endTime.getTime()]});I={};m.mixin(I,G,E);return I},_createOperationalLayers:function(A,B){var E,G=[],I=0;B.preserveScale&&(I=B.outScale||A.getScale());this.allLayerslegend=this.legendAll?[]:null;this._vtlExtent=null;var L=a.map(A.layerIds,A.getLayer,A);A._mapImageLyr&&L.push(A._mapImageLyr);for(E=
0;E<L.length;E++){var K=L[E];if(K.loaded&&K.visible&&(!I||K.isVisibleAtScale(I))){var ba=K.declaredClass;var T={id:K.id,title:m.getObject("arcgisProps.title",!1,K)||K.id,opacity:K.opacity,minScale:K.minScale||0,maxScale:K.maxScale||0};T=m.mixin(T,this._getUrlAndToken(K));K.getNode()&&C.get(K.getNode(),"data-reference")&&(T._isRefLayer=!0);switch(ba){case "esri.layers.ArcGISDynamicMapServiceLayer":var P=[];ba=!!K._params.layers;if(K._params.dynamicLayers)ba=B.outScale?K._getDynLayerObjs(B.outScale):
D.fromJson(K._params.dynamicLayers),a.forEach(ba,function(qa){P.push({id:qa.id,name:qa.name,layerDefinition:qa});delete qa.id;delete qa.name;delete qa.maxScale;delete qa.minScale}),0===P.length&&(T.visibleLayers=[-1]);else if(K.supportsDynamicLayers){if(ba||K.layerDefinitions||K.layerTimeOptions){var J=K.createDynamicLayerInfosFromLayerInfos(),N=null;ba&&(N=K.visibleLayers);N=n._getVisibleLayers(J,N);var Z=n._getLayersForScale(B.outScale||A.getScale(),J);a.forEach(J,function(qa){if(!qa.subLayerIds){var V=
qa.id;-1<a.indexOf(N,V)&&-1<a.indexOf(Z,V)&&(qa={source:qa.source.toJson()},K.layerDefinitions&&K.layerDefinitions[V]&&(qa.definitionExpression=K.layerDefinitions[V]),K.layerTimeOptions&&K.layerTimeOptions[V]&&(qa.layerTimeOptions=K.layerTimeOptions[V].toJson()),P.push({id:V,layerDefinition:qa}))}});0===P.length&&(T.visibleLayers=[-1])}}else a.forEach(K.layerInfos,function(qa){var V={id:qa.id,layerDefinition:{}};K.layerDefinitions&&K.layerDefinitions[qa.id]&&(V.layerDefinition.definitionExpression=
K.layerDefinitions[qa.id]);K.layerTimeOptions&&K.layerTimeOptions[qa.id]&&(V.layerDefinition.layerTimeOptions=K.layerTimeOptions[qa.id].toJson());(V.layerDefinition.definitionExpression||V.layerDefinition.layerTimeOptions)&&P.push(V)}),ba&&(T.visibleLayers=K.visibleLayers.length?K.visibleLayers:[-1]);P.length&&(T.layers=P);G.push(T);this.allLayerslegend&&this.allLayerslegend.push({id:K.id,subLayerIds:K.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":T=m.mixin(T,{url:K.url,bandIds:K.bandIds,
compressionQuality:K.compressionQuality,format:K.format,interpolation:K.interpolation});K.mosaicRule&&m.mixin(T,{mosaicRule:K.mosaicRule.toJson()});if(K.renderingRule||K.renderer)this._is11xService?(K.renderingRule&&(T.renderingRule=K.renderingRule.toJson()),K.renderer&&(T.layerDefinition=T.layerDefinition||{},T.layerDefinition.drawingInfo=T.layerDefinition.drawingInfo||{},T.layerDefinition.drawingInfo.renderer=K.renderer.toJson())):(ba=K.getExportImageRenderingRule())&&m.mixin(T,{renderingRule:ba.toJson()});
G.push(T);this.allLayerslegend&&this.allLayerslegend.push({id:K.id});break;case "esri.layers.RasterXLayer":this._is11xService&&(T=m.mixin(T,{url:K.url,bandIds:K.bandIds,interpolation:K.interpolation}),K.renderer&&(T.layerDefinition=T.layerDefinition||{},T.layerDefinition.drawingInfo=T.layerDefinition.drawingInfo||{},T.layerDefinition.drawingInfo.renderer=K.renderer.toJson()),G.push(T),this.allLayerslegend&&this.allLayerslegend.push({id:K.id}));break;case "esri.layers.WMSLayer":T=m.mixin(T,{url:K.url,
title:K.title,type:"wms",version:K.version,transparentBackground:K.imageTransparency,visibleLayers:K.visibleLayers});G.push(T);this.allLayerslegend&&this.allLayerslegend.push({id:K.id,subLayerIds:K.visibleLayers});break;case "esri.virtualearth.VETiledLayer":ba=K.mapStyle;"roadOnDemand"===ba?ba="Road":"aerialWithLabelsOnDemand"===ba&&(ba="Hybrid");T=m.mixin(T,{visibility:K.visible,type:"BingMaps"+ba,culture:K.culture,key:K.bingMapsKey});G.push(T);break;case "esri.layers.OpenStreetMapLayer":T=m.mixin(T,
{credits:K.copyright,type:"OpenStreetMap",url:b.getAbsoluteUrl(K.tileServers[0])});G.push(T);break;case "esri.layers.WMTSLayer":T=m.mixin(T,{url:K.url,type:"wmts",layer:K._identifier,style:K._style,format:K.format,tileMatrixSet:K._tileMatrixSetId});G.push(T);break;case "esri.layers.MapImageLayer":ba=K.getImages();a.forEach(ba,function(qa,V){qa.visible&&qa.href&&(T={id:K.id+"_image"+V,type:"image",title:K.id,minScale:K.minScale||0,maxScale:K.maxScale||0,opacity:K.opacity*qa.opacity,extent:qa.extent.toJson()},
"data:image/png;base64,"===qa.href.substr(0,22)?T.imageData=qa.href.substr(22):T.url=qa.href,G.push(T))});break;case "esri.layers.VectorTileLayer":delete T.url;delete T.token;if(this._is11xService&&K.currentStyleInfo.serviceUrl&&K.currentStyleInfo.styleUrl&&(ba=r.id&&r.id.findCredential(K.currentStyleInfo.styleUrl),J=r.id&&r.id.findCredential(K.currentStyleInfo.serviceUrl),!ba&&!J||"2.1.0"!==this._cimVersion)){T.type="VectorTileLayer";T.styleUrl=K.currentStyleInfo.styleUrl;ba&&(T.token=ba.token);
J&&J.token!==T.token&&(T.additionalTokens=[{url:K.currentStyleInfo.serviceUrl,token:J.token}]);G.push(T);break}T.type="image";ba=this._vtlExtent||A.extent.offset(0,0);var Y=B.exportOptions&&B.exportOptions.dpi||96;J={format:"png",pixelRatio:Y/96};"MAP_ONLY"!==B.layout||!B.preserveScale||B.outScale&&B.outScale!==A.getScale()||96!==Y||!B.exportOptions||B.exportOptions.width%2===A.width%2&&B.exportOptions.height%2===A.height%2||(J.area={x:0,y:0,width:A.width,height:A.height},B.exportOptions.width%2!==
A.width%2&&--J.area.width,B.exportOptions.height%2!==A.height%2&&--J.area.height,this._vtlExtent||(Y=A.toMap({x:J.area.width,y:J.area.height}),ba.update(ba.xmin,Y.y,Y.x,ba.ymax,ba.spatialReference),this._vtlExtent=ba));T.extent=ba._normalize(!0).toJson();ba=K.takeScreenshot(J);ba.isResolved()&&ba.then(function(qa){"data:image/png;base64,"===qa.dataURL.substr(0,22)&&(T.imageData=qa.dataURL.substr(22))});T.imageData&&G.push(T);break;case "esri.layers.WebTiledLayer":ba=K.url.replace(/\$\{/g,"{");T=m.mixin(T,
{type:"WebTiledLayer",urlTemplate:ba,credits:K.copyright});K.subDomains&&0<K.subDomains.length&&(T.subDomains=K.subDomains);K._wmtsInfo&&(T.wmtsInfo=K._wmtsInfo);delete T.url;G.push(T);break;default:if(K.getTileUrl||K.getImageUrl)T=m.mixin(T,{url:K.url}),G.push(T)}}}L=a.map(A.graphicsLayerIds,A.getLayer,A);for(E=0;E<L.length;E++)K=L[E],K.isFeatureReductionActive&&K.isFeatureReductionActive()&&(K.getSingleGraphics().length?L.splice(++E,0,K.getFeatureReductionLayer()):L[E]=K.getFeatureReductionLayer());
for(E=0;E<L.length;E++)if(K=L[E],K.loaded&&K.visible&&(!I||K.isVisibleAtScale(I)))switch(ba=K.declaredClass,ba){case "esri.layers.CSVLayer":if(this._is11xService){T={id:K.id,url:K.url,title:K.title,opacity:K.opacity,minScale:K.minScale||0,maxScale:K.maxScale||0,type:"CSV",locationInfo:{latitudeFieldName:K.latitudeFieldName,longitudeFieldName:K.longitudeFieldName},layerDefinition:{drawingInfo:{renderer:K.renderer&&K.renderer.toJson()}}};G.push(T);break}case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===
ba&&!B.showLabels||K.renderer&&"esri.renderer.HeatmapRenderer"===K.renderer.declaredClass)continue;ba=null;K.url&&K.renderer&&("esri.renderer.ScaleDependentRenderer"===K.renderer.declaredClass?"scale"===K.renderer.rangeType?ba=K.renderer.getRendererInfoByScale(A.getScale())&&K.renderer.getRendererInfoByScale(A.getScale()).renderer:"zoom"===K.renderer.rangeType&&(ba=K.renderer.getRendererInfoByZoom(A.getZoom())&&K.renderer.getRendererInfoByZoom(A.getZoom()).renderer):ba=K.renderer);J=ba&&"esri.layers.CSVLayer"!==
K.declaredClass&&!this._isFeatureCollectionRequired(ba,K)&&!ba.valueExpression;Y=K.isFeatureReductionActive&&K.isFeatureReductionActive();if(ba&&!Y&&"esri.renderer.DotDensityRenderer"!==ba.declaredClass&&"esri.layers.StreamLayer"!==K.declaredClass&&(this._is11xService||J)&&("esri.renderer.SimpleRenderer"===ba.declaredClass||"esri.renderer.TemporalRenderer"===ba.declaredClass||null==ba.attributeField||m.isString(ba.attributeField)&&K._getField(ba.attributeField,!0)))if(T={id:K.id,title:m.getObject("arcgisProps.title",
!1,K)||K.id,opacity:K.opacity,minScale:K.minScale||0,maxScale:K.maxScale||0,layerDefinition:{drawingInfo:{renderer:ba.toJson({useLegacyRotationProperties:!this._is11xService})}}},T=m.mixin(T,this._getUrlAndToken(K)),"esri.renderer.TemporalRenderer"===ba.declaredClass&&(J=T.layerDefinition.drawingInfo,J.latestObservationRenderer=J.renderer.latestObservationRenderer,J.trackLinesRenderer=J.renderer.trackRenderer,J.observationAger=J.renderer.observationAger,J.renderer=J.renderer.observationRenderer,K._trackIdField&&
(T.layerDefinition.timeInfo={trackIdField:K._trackIdField})),this._convertSvgRenderer(T.layerDefinition.drawingInfo.renderer),this._is11xService||1>K.opacity||"esri.renderer.TemporalRenderer"===ba.declaredClass||this._updateLayerOpacity(T))if(K._params.source&&(ba=K._params.source.toJson(),m.mixin(T.layerDefinition,{source:ba})),K.getDefinitionExpression()&&m.mixin(T.layerDefinition,{definitionExpression:K.getDefinitionExpression()}),2!==K.mode)0<K.getSelectedFeatures().length&&(ba=a.map(K.getSelectedFeatures(),
function(qa){return qa.attributes[K.objectIdField]}),0<ba.length&&K.getSelectionSymbol()&&m.mixin(T,{selectionObjectIds:ba,selectionSymbol:K.getSelectionSymbol().toJson()}));else{ba=a.map(K.getSelectedFeatures(),function(qa){return qa.attributes[K.objectIdField]});if(0===ba.length||!K._params.drawMode)break;m.mixin(T.layerDefinition,{objectIds:ba});ba=null;K.getSelectionSymbol()&&(ba=new h(K.getSelectionSymbol()));m.mixin(T.layerDefinition.drawingInfo,{renderer:ba&&ba.toJson()})}else T=this._createFeatureCollection(K,
A,null,B);else T=ba&&(ba.valueExpression||this._isFeatureCollectionRequired(ba,K)||"esri.renderer.DotDensityRenderer"===ba.declaredClass)?this._createFeatureCollection(K,A,ba,B):this._createFeatureCollection(K,A,null,B);if(!T)continue;G.push(T);this.allLayerslegend&&this.allLayerslegend.push({id:K.id});break;case "esri.layers._GraphicsLayer":case "esri.layers.GraphicsLayer":case "esri.layers.WFSLayer":T=this._createFeatureCollection(K,A,null,B);if(!T)continue;G.push(T);this.allLayerslegend&&this.allLayerslegend.push({id:K.id});
break;case "esri.layers.ArcGISImageServiceVectorLayer":T={id:K.id,title:m.getObject("arcgisProps.title",!1,K)||K.id,opacity:K.opacity,minScale:K.minScale||0,maxScale:K.maxScale||0,visibility:K.visible,symbolTileSize:K.symbolTileSize,layerDefinition:{drawingInfo:{renderer:K.renderer.toJson({useLegacyRotationProperties:!this._is11xService})}}},T=m.mixin(T,this._getUrlAndToken(K)),K.mosaicRule&&m.mixin(T,{mosaicRule:K.mosaicRule.toJson()}),G.push(T),this.allLayerslegend&&this.allLayerslegend.push({id:K.id})}I&&
a.forEach(G,function(qa){qa.minScale=0;qa.maxScale=0});A.graphics&&0<A.graphics.graphics.length&&(T=this._createFeatureCollection(A.graphics,A,null,B))&&G.push(T);A._labels&&B.showLabels&&(T=this._createFeatureCollection(A._labels,A,null,B))&&G.push(T);a.forEach(G,function(qa,V,na){qa._isRefLayer&&(delete qa._isRefLayer,na.splice(V,1),na.push(qa))});return G},_getUrlAndToken:function(A){return{token:A._getToken(),url:A._url?A._url.path:null}},_updateLayerOpacity:function(A){var B=this._colorEvaluator(A);
B=a.filter(B,function(L){return m.isArray(L)&&4===L.length});var E=!0;if(B.length){var G=B[0][3],I;for(I=1;I<B.length;I++)if(G!==B[I][3]){E=!1;break}if(E)for(A.opacity=G/255,I=0;I<B.length;I++)B[I][3]=255}return E},_isFeatureCollectionRequired:function(A,B){if(B&&B.isFeatureReductionActive&&B.isFeatureReductionActive())return!0;var E=!1,G=this._getVariable(A,"rotationInfo",!1);G&&(E=(E=G.field)&&m.isFunction(E)||G.valueExpression);return A.hasVisualVariables("sizeInfo")||A.hasVisualVariables("colorInfo")||
A.hasVisualVariables("opacityInfo")||E},_getVariable:function(A,B,E){if(A)var G=(A=A.getVisualVariablesForType(B,E))&&A[0];return G},_applyVisualVariables:function(A,B){var E=B.renderer,G=B.graphic,I=B.symbol,L=B.mapResolution,K=B.mapScale,ba=I.type;if("textsymbol"!==ba&&"shieldlabelsymbol"!==ba){var T=this._getVariable(E,"sizeInfo",!1),P=this._getVariable(E,"colorInfo",!1),J=this._getVariable(E,"opacityInfo",!1),N=this._getVariable(E,"rotationInfo",!1);I instanceof g&&(T=this._getVariable(E,"sizeInfo",
"outline")||T);L=T?E.getSize(G,{sizeInfo:T,shape:"simplemarkersymbol"===ba?I.style:null,resolution:L,scale:K}):G.size;null!=L&&("simplemarkersymbol"===ba?A.size=x.px2pt(L):"picturemarkersymbol"===ba?(K=I.width/I.height*L,A.width=x.px2pt(K),A.height=x.px2pt(L),0!==I.xoffset&&(A.xoffset=x.px2pt(I.xoffset/I.width*K)),0!==I.yoffset&&(A.yoffset=x.px2pt(I.yoffset/I.height*L))):"simplelinesymbol"===ba?A.width=x.px2pt(L):A.outline&&(A.outline.width=x.px2pt(L)));P&&(!(I=E.getColor(G,{colorInfo:P}))||"simplemarkersymbol"!==
ba&&"simplelinesymbol"!==ba&&"simplefillsymbol"!==ba||(A.color=d.toJsonColor(I)));J&&(ba=E.getOpacity(G,{opacityInfo:J}),null!=ba&&A.color&&(A.color[3]=Math.round(255*ba)));N&&(E=E.getRotationAngle(G,{rotationInfo:N}))&&(A.angle=-E)}}});m.setObject("tasks.PrintTask",F,r);return F})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l){F=F(e,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(v){this._jobUpdateHandler=m.hitch(this,this._jobUpdateHandler);this._getJobStatus=m.hitch(this,this._getJobStatus);this._getResultDataHandler=
m.hitch(this,this._getResultDataHandler);this._getResultImageHandler=m.hitch(this,this._getResultImageHandler);this._executeHandler=m.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(v){this.updateDelay=v},setProcessSpatialReference:function(v){this.processSpatialReference=v},setOutputSpatialReference:function(v){this._setOutSR(v)},setOutSpatialReference:function(v){this._setOutSR(v)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(v){this.outSpatialReference=this.outputSpatialReference=v},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(v,A,B){for(var E in v){var G=v[E];m.isArray(G)?v[E]=z.toJson(a.map(G,function(I){return this._gpEncode({item:I},!0).item},this)):G instanceof Date&&(v[E]=G.getTime())}return this._encode(v,A,B)},_decode:function(v){var A=v.dataType,
B=new C(v);if(-1!==a.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],A))return B;if("GPLinearUnit"===A)B.value=new g(B.value);else if("GPFeatureRecordSetLayer"===A||"GPRecordSet"===A)B.value=new b(B.value);else if("GPDataFile"===A)B.value=new k(B.value);else if("GPDate"===A)v=B.value,m.isString(v)?B.value=new t({date:v}):B.value=new Date(v);else if("GPRasterData"===A||"GPRasterDataLayer"===A)v=v.value.mapImage,B.value=v?new l(v):new w(B.value);else if(-1!==A.indexOf("GPMultiValue:")){var E=A.split(":")[1];
v=B.value;B.value=a.map(v,function(G){return this._decode({paramName:"_name",dataType:E,value:G}).value},this)}else B=null;return B},submitJob:function(v,A,B,E,G){var I=this._getOutSR(),L=G.assembly;v=this._gpEncode(m.mixin({},this._url.query,{f:"json","env:outSR":I?I.wkid||z.toJson(I.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||z.toJson(this.processSpatialReference.toJson()):null},v),null,L&&L[0]);var K=this._jobUpdateHandler,ba=this._errorHandler;
return n({url:this._url.path+"/submitJob",content:v,callbackParamName:"callback",load:function(T,P){K(T,P,!1,A,B,G.dfd)},error:function(T){ba(T,E,G.dfd)}})},_jobUpdateHandler:function(v,A,B,E,G,I){var L=v.jobId;A=new c(v);this._successHandler([A],"onStatusUpdate",G,B&&I);if(!B)switch(clearTimeout(this._updateTimers[L]),this._updateTimers[L]=null,I&&I.progress(A),v.jobStatus){case c.STATUS_SUBMITTED:case c.STATUS_EXECUTING:case c.STATUS_WAITING:case c.STATUS_NEW:var K=this._getJobStatus;this._updateTimers[L]=
setTimeout(function(){K(L,B,E,G,I)},this.updateDelay);break;default:this._successHandler([A],"onJobComplete",E,I)}},_getJobStatus:function(v,A,B,E,G){var I=this._jobUpdateHandler;n({url:this._url.path+"/jobs/"+v,content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(L,K){I(L,K,A,B,E,G)},error:this._errorHandler})},_getResultDataHandler:function(v,A,B,E,G){try{var I=this._decode(v);this._successHandler([I],"onGetResultDataComplete",B,G)}catch(L){this._errorHandler(L,
E,G)}},getResultData:function(v,A,B,E){var G=this._getResultDataHandler,I=this._errorHandler,L=new D(f._dfdCanceller);L._pendingDfd=n({url:this._url.path+"/jobs/"+v+"/results/"+A,content:m.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(K,ba){G(K,ba,B,E,L)},error:function(K){I(K,E,L)}});return L},checkJobStatus:function(v,A,B){var E=this._jobUpdateHandler,G=this._errorHandler,I=new D(f._dfdCanceller);I._pendingDfd=n({url:this._url.path+"/jobs/"+v,
content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(L,K){E(L,K,!0,null,A,I)},error:function(L){G(L,B,I)}});return I},cancelJob:function(v,A,B){var E=this._errorHandler,G=new D(f._dfdCanceller);G._pendingDfd=n({url:this._url.path+"/jobs/"+v+"/cancel",content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:m.hitch(this,function(I,L){this._successHandler([I],"onJobCancel",A,G)}),error:function(I){E(I,B,G)}});return G},execute:function(v,
A,B,E){var G=this._getOutSR(),I=E.assembly;v=this._gpEncode(m.mixin({},this._url.query,{f:"json","env:outSR":G?G.wkid||z.toJson(G.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||z.toJson(this.processSpatialReference.toJson()):null},v),null,I&&I[0]);var L=this._executeHandler,K=this._errorHandler;return n({url:this._url.path+"/execute",content:v,callbackParamName:"callback",load:function(ba,T){L(ba,T,A,B,E.dfd)},error:function(ba){K(ba,B,E.dfd)}})},_executeHandler:function(v,
A,B,E,G){try{var I=v.results,L,K=v.messages;var ba=0;for(L=I.length;ba<L;ba++)I[ba]=this._decode(I[ba]);ba=0;for(L=K.length;ba<L;ba++)K[ba]=new h(K[ba]);this._successHandler([I,K],"onExecuteComplete",B,G)}catch(T){this._errorHandler(T,E,G)}},_getResultImageHandler:function(v,A,B,E,G){try{var I=this._decode(v);this._successHandler([I],"onGetResultImageComplete",B,G)}catch(L){this._errorHandler(L,E,G)}},getResultImage:function(v,A,B,E,G){var I=this._getResultImageHandler,L=this._errorHandler;B=this._gpEncode(m.mixin({},
this._url.query,{f:"json"},B.toJson()));var K=new D(f._dfdCanceller);K._pendingDfd=n({url:this._url.path+"/jobs/"+v+"/results/"+A,content:B,callbackParamName:"callback",load:function(ba,T){I(ba,T,E,G,K)},error:function(ba){L(ba,G,K)}});return K},cancelJobStatusUpdates:function(v){clearTimeout(this._updateTimers[v]);this._updateTimers[v]=null},getResultImageLayer:function(v,A,B,E){if(null==A){var G=this._url.path.indexOf("/GPServer/");v=this._url.path.substring(0,G)+"/MapServer/jobs/"+v}else v=this._url.path+
"/jobs/"+v+"/results/"+A;this._url.query&&(v+="?"+r.objectToQuery(this._url.query));A=null==A?new x(v,{imageParameters:B}):new u(v,{imageParameters:B},!0);this.onGetResultImageLayerComplete(A);E&&E(A);return A},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});d._createWrappers(F);m.setObject("tasks.Geoprocessor",F,q);
return F})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(y){this.messages=[];m.mixin(this,y);y=this.messages;var r,q=y.length;for(r=0;r<q;r++)y[r]=new z(y[r])},jobId:"",jobStatus:""});m.mixin(F,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",
STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});m.setObject("tasks.JobInfo",F,D);return F})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(z){m.mixin(this,z)}});m.mixin(F,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",
TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});m.setObject("tasks.GPMessage",F,D);return F})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.LinearUnit",
constructor:function(z){z&&m.mixin(this,z)},distance:0,units:null,toJson:function(){var z={};this.distance&&(z.distance=this.distance);this.units&&(z.units=this.units);return z}});m.setObject("tasks.LinearUnit",F,D);return F})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.DataFile",constructor:function(z){z&&m.mixin(this,z)},url:null,itemID:null,toJson:function(){var z={};this.url&&(z.url=
this.url);this.itemID&&(z.itemID=this.itemID);return z}});m.setObject("tasks.DataFile",F,D);return F})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.RasterData",constructor:function(z){z&&m.mixin(this,z)},url:null,format:null,itemID:null,toJson:function(){var z={};this.url&&(z.url=this.url);this.format&&(z.format=this.format);this.itemID&&(z.itemID=this.itemID);return z}});m.setObject("tasks.RasterData",
F,D);return F})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(F,m,a,D,z){F=F(null,{declaredClass:"esri.tasks.Date",constructor:function(y){y&&(y.format&&(this.format=y.format),this.date=a.parse(y.date,{selector:"date",datePattern:this.format}))},date:new Date,format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:a.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}});m.setObject("tasks.Date",
F,z);return F})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(z){m.mixin(this,z)}});m.setObject("tasks.ParameterValue",F,D);return F})},"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(F,m,a,D,z,y,r){F=
F(r,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(q,n){n&&n.imageParameters&&n.imageParameters.extent&&(this.initialExtent=this.fullExtent=n.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=m.hitch(this,this.getImageUrl);this.loaded=!0;this.onLoad(this)},getImageUrl:function(q,n,f,d){var e=q.spatialReference.wkid;d(this._url.path+"?"+z.objectToQuery(m.mixin(this._params,{f:"image",bbox:a.toJson(q.toJson()),bboxSR:e,imageSR:e,
size:n+","+f})))}});m.setObject("tasks._GPResultImageLayer",F,y);return F})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,height:1100,dpi:96},layoutOptions:null,format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,forceFeatureAttributes:!1,showAttribution:null,showLabels:!0});m.setObject("tasks.PrintTemplate",F,D);return F})},
"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b){function c(P,J,N,Z,Y,qa,V,na,ya,S){var ma=J.length,ja=0;if(S){var X=S.l/Y;ja=S.i}else X=J[0]/Y;for(;qa<V;){if(qa+X>V){var oa={l:(qa+X-V)*Y,i:ja};X=V-qa}ja%2||(P.beginPath(),P.arc(N,Z,Y,qa,qa+X,na),ya&&P.stroke());qa+=X;++ja;X=J[ja%ma]/Y}return oa}function h(P,
J,N,Z){var Y=0,qa=0,V=0;if(Z){var na=Z.l;V=Z.i}else na=J[0];for(;1>qa;)qa=b.tAtLength(P,na),1==qa&&(Y=b.computeLength(P),Y={l:na-Y,i:V}),P=b.splitBezierAtT(P,qa),V%2||N.push(P[0]),P=P[1],++V,na=J[V%J.length];return Y}function g(P,J,N,Z){var Y=[J.last.x,J.last.y].concat(N),qa=!(P instanceof Array);N=4===N.length?"quadraticCurveTo":"bezierCurveTo";var V=[];J=h(Y,J.canvasDash,V,Z);for(Z=0;Z<V.length;++Z)Y=V[Z],qa?(P.moveTo(Y[0],Y[1]),P[N].apply(P,Y.slice(2))):(P.push("moveTo",[Y[0],Y[1]]),P.push(N,Y.slice(2)));
return J}function k(P,J,N,Z,Y,qa,V){var na=0,ya=0,S=0,ma=b.distance(N,Z,Y,qa),ja=0;J=J.canvasDash;var X=N,oa=Z,xa=!(P instanceof Array);V?(S=V.l,ja=V.i):S+=J[0];for(;.01<Math.abs(1-ya);){S>ma&&(na={l:S-ma,i:ja},S=ma);ya=S/ma;V=N+(Y-N)*ya;var Ha=Z+(qa-Z)*ya;ja++%2||(xa?(P.moveTo(X,oa),P.lineTo(V,Ha)):(P.push("moveTo",[X,oa]),P.push("lineTo",[V,Ha])));X=V;oa=Ha;S+=J[ja%J.length]}return na}var w=F.canvas={},t=null,C=d.multiplyPoint,u=Math.PI,x=2*u,l=u/2;e=m.extend;if(z.global.CanvasRenderingContext2D){z=
z.doc.createElement("canvas").getContext("2d");var v="function"==typeof z.setLineDash,A="function"==typeof z.fillText}var B={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};w.Shape=D("dojox.gfx.canvas.Shape",q.Shape,{_render:function(P){P.save();this._renderTransform(P);this._renderClip(P);this._renderShape(P);this._renderFill(P,!0);this._renderStroke(P,
!0);P.restore()},_renderClip:function(P){this.canvasClip&&(this.canvasClip.render(P),P.clip())},_renderTransform:function(P){if("canvasTransform"in this){var J=this.canvasTransform;P.translate(J.dx,J.dy);P.rotate(J.angle2);P.scale(J.sx,J.sy);P.rotate(J.angle1)}},_renderShape:function(P){},_renderFill:function(P,J){if("canvasFill"in this){var N=this.fillStyle;if("canvasFillImage"in this){var Z=N.width,Y=N.height,qa=this.canvasFillImage.width,V=this.canvasFillImage.height,na=Math.min(Z==qa?1:Z/qa,Y==
V?1:Y/V),ya=(Z-na*qa)/2,S=(Y-na*V)/2;t.width=Z;t.height=Y;var ma=t.getContext("2d");ma.clearRect(0,0,Z,Y);ma.drawImage(this.canvasFillImage,0,0,qa,V,ya,S,na*qa,na*V);this.canvasFill=P.createPattern(t,"repeat");delete this.canvasFillImage}P.fillStyle=this.canvasFill;J&&("pattern"!==N.type||0===N.x&&0===N.y||P.translate(N.x,N.y),P.fill())}else P.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(P,J){var N=this.strokeStyle;N?(P.strokeStyle=N.color.toString(),P.lineWidth=N.width,P.lineCap=N.cap,"number"==
typeof N.join?(P.lineJoin="miter",P.miterLimit=N.join):P.lineJoin=N.join,this.canvasDash?v?(P.setLineDash(this.canvasDash),J&&P.stroke()):this._renderDashedStroke(P,J):J&&P.stroke()):J||(P.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(P,J){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(P){this.inherited(arguments);var J=P?"width"in P?"rect":"cx"in P?"ellipse":"points"in P?"polyline":"d"in P?"path":
null:null;if(P&&!J)return this;this.canvasClip=P?E(J,P):null;this.parent&&this.parent._makeDirty();return this}});var E=function(P,J){switch(P){case "ellipse":return{canvasEllipse:K({shape:J}),render:function(N){return w.Ellipse.prototype._renderShape.call(this,N)}};case "rect":return{shape:m.delegate(J,{r:0}),render:function(N){return w.Rect.prototype._renderShape.call(this,N)}};case "path":return{canvasPath:G(J),render:function(N){this.canvasPath._renderShape(N)}};case "polyline":return{canvasPolyline:J.points,
render:function(N){return w.Polyline.prototype._renderShape.call(this,N)}}}return null},G=function(P){var J=new dojox.gfx.canvas.Path;J.canvasPath=[];J._setPath(P.d);return J},I=function(P,J,N){var Z=P.prototype[J];P.prototype[J]=N?function(){this.parent&&this.parent._makeDirty();Z.apply(this,arguments);N.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return Z.apply(this,arguments)}};I(w.Shape,"setTransform",function(){this.matrix?this.canvasTransform=F.decompose(this.matrix):
delete this.canvasTransform});I(w.Shape,"setFill",function(){var P=this.fillStyle;if(P){if("object"==typeof P&&"type"in P){var J=this.surface.rawNode.getContext("2d");switch(P.type){case "linear":case "radial":var N="linear"==P.type?J.createLinearGradient(P.x1,P.y1,P.x2,P.y2):J.createRadialGradient(P.cx,P.cy,0,P.cx,P.cy,P.r);a.forEach(P.colors,function(Z){N.addColorStop(Z.offset,F.normalizeColor(Z.color).toString())});break;case "pattern":t||(t=document.createElement("canvas")),J=new Image,this.surface.downloadImage(J,
P.src),this.canvasFillImage=J}}else N=P.toString();this.canvasFill=N}else delete this.canvasFill});I(w.Shape,"setStroke",function(){var P=this.strokeStyle;if(P){var J=this.strokeStyle.style.toLowerCase();J in B&&(J=B[J]);if(J instanceof Array){this.canvasDash=J=J.slice();var N;for(N=0;N<J.length;++N)J[N]*=P.width;if("butt"!=P.cap){for(N=0;N<J.length;N+=2)J[N]-=P.width,1>J[N]&&(J[N]=1);for(N=1;N<J.length;N+=2)J[N]+=P.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!v&&
!!this.canvasDash});I(w.Shape,"setShape");w.Group=D("dojox.gfx.canvas.Group",w.Shape,{constructor:function(){q.Container._init.call(this)},_render:function(P){P.save();this._renderTransform(P);this._renderClip(P);for(var J=0;J<this.children.length;++J)this.children[J]._render(P);P.restore()},destroy:function(){q.Container.clear.call(this,!0);w.Shape.prototype.destroy.apply(this,arguments)}});w.Rect=D("dojox.gfx.canvas.Rect",[w.Shape,q.Rect],{_renderShape:function(P){var J=this.shape,N=Math.min(J.r,
J.height/2,J.width/2),Z=J.x,Y=Z+J.width,qa=J.y;J=qa+J.height;var V=Z+N,na=Y-N,ya=qa+N,S=J-N;P.beginPath();P.moveTo(V,qa);N?(P.arc(na,ya,N,-l,0,!1),P.arc(na,S,N,0,l,!1),P.arc(V,S,N,l,u,!1),P.arc(V,ya,N,u,u+l,!1)):(P.lineTo(na,qa),P.lineTo(Y,S),P.lineTo(V,J),P.lineTo(Z,ya));P.closePath()},_renderDashedStroke:function(P,J){var N=this.shape,Z=Math.min(N.r,N.height/2,N.width/2),Y=N.x,qa=Y+N.width,V=N.y,na=V+N.height,ya=Y+Z,S=qa-Z,ma=V+Z,ja=na-Z;Z?(P.beginPath(),N=k(P,this,ya,V,S,V),J&&P.stroke(),N=c(P,
this.canvasDash,S,ma,Z,-l,0,!1,J,N),P.beginPath(),N=k(P,this,qa,ma,qa,ja,N),J&&P.stroke(),N=c(P,this.canvasDash,S,ja,Z,0,l,!1,J,N),P.beginPath(),N=k(P,this,S,na,ya,na,N),J&&P.stroke(),N=c(P,this.canvasDash,ya,ja,Z,l,u,!1,J,N),P.beginPath(),N=k(P,this,Y,ja,Y,ma,N),J&&P.stroke(),c(P,this.canvasDash,ya,ma,Z,u,u+l,!1,J,N)):(P.beginPath(),N=k(P,this,ya,V,S,V),N=k(P,this,S,V,qa,ja,N),N=k(P,this,qa,ja,ya,na,N),k(P,this,ya,na,Y,ma,N),J&&P.stroke())}});var L=[];(function(){var P=f.curvePI4;L.push(P.s,P.c1,
P.c2,P.e);for(var J=45;360>J;J+=45){var N=d.rotateg(J);L.push(C(N,P.c1),C(N,P.c2),C(N,P.e))}})();var K=function(P){var J=[],N=P.shape,Z=d.normalize([d.translate(N.cx,N.cy),d.scale(N.rx,N.ry)]);var Y=C(Z,L[0]);J.push([Y.x,Y.y]);for(N=1;N<L.length;N+=3){var qa=C(Z,L[N]);var V=C(Z,L[N+1]);Y=C(Z,L[N+2]);J.push([qa.x,qa.y,V.x,V.y,Y.x,Y.y])}if(P._needsDash){Y=[];qa=J[0];for(N=1;N<J.length;++N)V=[],h(qa.concat(J[N]),P.canvasDash,V),qa=[J[N][4],J[N][5]],Y.push(V);P._dashedPoints=Y}return J};w.Ellipse=D("dojox.gfx.canvas.Ellipse",
[w.Shape,q.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=K(this);return this},setStroke:function(){this.inherited(arguments);v||(this.canvasEllipse=K(this));return this},_renderShape:function(P){var J=this.canvasEllipse,N;P.beginPath();P.moveTo.apply(P,J[0]);for(N=1;N<J.length;++N)P.bezierCurveTo.apply(P,J[N]);P.closePath()},_renderDashedStroke:function(P,J){var N=this._dashedPoints;P.beginPath();for(var Z=0;Z<N.length;++Z)for(var Y=N[Z],qa=0;qa<Y.length;++qa){var V=Y[qa];
P.moveTo(V[0],V[1]);P.bezierCurveTo(V[2],V[3],V[4],V[5],V[6],V[7])}J&&P.stroke()}});w.Circle=D("dojox.gfx.canvas.Circle",[w.Shape,q.Circle],{_renderShape:function(P){var J=this.shape;P.beginPath();P.arc(J.cx,J.cy,J.r,0,x,1)},_renderDashedStroke:function(P,J){var N=this.shape,Z=0,Y=this.canvasDash.length;for(i=0;Z<x;){var qa=this.canvasDash[i%Y]/N.r;i%2||(P.beginPath(),P.arc(N.cx,N.cy,N.r,Z,Z+qa,0),J&&P.stroke());Z+=qa;++i}}});w.Line=D("dojox.gfx.canvas.Line",[w.Shape,q.Line],{_renderShape:function(P){var J=
this.shape;P.beginPath();P.moveTo(J.x1,J.y1);P.lineTo(J.x2,J.y2)},_renderDashedStroke:function(P,J){var N=this.shape;P.beginPath();k(P,this,N.x1,N.y1,N.x2,N.y2);J&&P.stroke()}});w.Polyline=D("dojox.gfx.canvas.Polyline",[w.Shape,q.Polyline],{setShape:function(){this.inherited(arguments);var P=this.shape.points,J=P[0],N;this.bbox=null;this._normalizePoints();if(P.length)if("number"==typeof J)J=P;else for(J=[],N=0;N<P.length;++N){var Z=P[N];J.push(Z.x,Z.y)}else J=[];this.canvasPolyline=J;return this},
_renderShape:function(P){var J=this.canvasPolyline;if(J.length){P.beginPath();P.moveTo(J[0],J[1]);for(var N=2;N<J.length;N+=2)P.lineTo(J[N],J[N+1])}},_renderDashedStroke:function(P,J){var N=this.canvasPolyline,Z=0;P.beginPath();for(var Y=0;Y<N.length;Y+=2)Z=k(P,this,N[Y],N[Y+1],N[Y+2],N[Y+3],Z);J&&P.stroke()}});w.Image=D("dojox.gfx.canvas.Image",[w.Shape,q.Image],{setShape:function(){this.inherited(arguments);var P=new Image;this.surface.downloadImage(P,this.shape.src);this.canvasImage=P;return this},
_renderShape:function(P){var J=this.shape;P.drawImage(this.canvasImage,J.x,J.y,J.width,J.height)}});w.Text=D("dojox.gfx.canvas.Text",[w.Shape,q.Text],{_setFont:function(){this.fontStyle?this.canvasFont=F.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var P=this.shape,J=0;if(P.text){var N=this.surface.rawNode.getContext("2d");N.save();this._renderTransform(N);this._renderFill(N,!1);this._renderStroke(N,!1);this.canvasFont&&(N.font=this.canvasFont);J=N.measureText(P.text).width;
N.restore()}return J},_render:function(P){P.save();this._renderTransform(P);this._renderFill(P,!1);this._renderStroke(P,!1);this._renderShape(P);P.restore()},_renderShape:function(P){var J=this.shape;J.text&&(P.textAlign="middle"===J.align?"center":J.align,this.canvasFont&&(P.font=this.canvasFont),this.canvasFill&&P.fillText(J.text,J.x,J.y),this.strokeStyle&&(P.beginPath(),P.strokeText(J.text,J.x,J.y),P.closePath()))}});I(w.Text,"setFont");A||w.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},
_renderShape:function(){}});var ba={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};w.Path=D("dojox.gfx.canvas.Path",[w.Shape,n.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},
setStroke:function(){this.inherited(arguments);v||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(P){var J=m.clone(this.last);this[ba[P.action]](this.canvasPath,P.action,P.args,this._needsDash?this._dashedPath:null);this.last=J;this.inherited(arguments)},_renderShape:function(P){var J=this.canvasPath;P.beginPath();for(var N=0;N<J.length;N+=2)P[J[N]].apply(P,J[N+1])},_renderDashedStroke:v?function(){}:
function(P,J){var N=this._dashedPath;P.beginPath();for(var Z=0;Z<N.length;Z+=2)P[N[Z]].apply(P,N[Z+1]);J&&P.stroke()},_moveToA:function(P,J,N,Z){P.push("moveTo",[N[0],N[1]]);Z&&Z.push("moveTo",[N[0],N[1]]);for(J=2;J<N.length;J+=2)P.push("lineTo",[N[J],N[J+1]]),Z&&(this._dashResidue=k(Z,this,N[J-2],N[J-1],N[J],N[J+1],this._dashResidue));this.last.x=N[N.length-2];this.last.y=N[N.length-1];this.lastControl={}},_moveToR:function(P,J,N,Z){J="x"in this.last?[this.last.x+=N[0],this.last.y+=N[1]]:[this.last.x=
N[0],this.last.y=N[1]];P.push("moveTo",J);Z&&Z.push("moveTo",J);for(J=2;J<N.length;J+=2)P.push("lineTo",[this.last.x+=N[J],this.last.y+=N[J+1]]),Z&&(this._dashResidue=k(Z,this,Z[Z.length-1][0],Z[Z.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(P,J,N,Z){for(J=0;J<N.length;J+=2)Z&&(this._dashResidue=k(Z,this,this.last.x,this.last.y,N[J],N[J+1],this._dashResidue)),P.push("lineTo",[N[J],N[J+1]]);this.last.x=N[N.length-2];this.last.y=N[N.length-1];this.lastControl=
{}},_lineToR:function(P,J,N,Z){for(J=0;J<N.length;J+=2)P.push("lineTo",[this.last.x+=N[J],this.last.y+=N[J+1]]),Z&&(this._dashResidue=k(Z,this,Z[Z.length-1][0],Z[Z.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(P,J,N,Z){for(J=0;J<N.length;++J)P.push("lineTo",[N[J],this.last.y]),Z&&(this._dashResidue=k(Z,this,Z[Z.length-1][0],Z[Z.length-1][1],N[J],this.last.y,this._dashResidue));this.last.x=N[N.length-1];this.lastControl={}},_hLineToR:function(P,J,
N,Z){for(J=0;J<N.length;++J)P.push("lineTo",[this.last.x+=N[J],this.last.y]),Z&&(this._dashResidue=k(Z,this,Z[Z.length-1][0],Z[Z.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(P,J,N,Z){for(J=0;J<N.length;++J)P.push("lineTo",[this.last.x,N[J]]),Z&&(this._dashResidue=k(Z,this,Z[Z.length-1][0],Z[Z.length-1][1],this.last.x,N[J],this._dashResidue));this.last.y=N[N.length-1];this.lastControl={}},_vLineToR:function(P,J,N,Z){for(J=0;J<N.length;++J)P.push("lineTo",
[this.last.x,this.last.y+=N[J]]),Z&&(this._dashResidue=k(Z,this,Z[Z.length-1][0],Z[Z.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(P,J,N,Z){for(J=0;J<N.length;J+=6)P.push("bezierCurveTo",N.slice(J,J+6)),Z&&(this._dashResidue=g(Z,this,P[P.length-1],this._dashResidue));this.last.x=N[N.length-2];this.last.y=N[N.length-1];this.lastControl.x=N[N.length-4];this.lastControl.y=N[N.length-3];this.lastControl.type="C"},_curveToR:function(P,J,N,Z){for(J=0;J<
N.length;J+=6)P.push("bezierCurveTo",[this.last.x+N[J],this.last.y+N[J+1],this.lastControl.x=this.last.x+N[J+2],this.lastControl.y=this.last.y+N[J+3],this.last.x+N[J+4],this.last.y+N[J+5]]),Z&&(this._dashResidue=g(Z,this,P[P.length-1],this._dashResidue)),this.last.x+=N[J+4],this.last.y+=N[J+5];this.lastControl.type="C"},_smoothCurveToA:function(P,J,N,Z){for(J=0;J<N.length;J+=4){var Y="C"==this.lastControl.type;P.push("bezierCurveTo",[Y?2*this.last.x-this.lastControl.x:this.last.x,Y?2*this.last.y-
this.lastControl.y:this.last.y,N[J],N[J+1],N[J+2],N[J+3]]);Z&&(this._dashResidue=g(Z,this,P[P.length-1],this._dashResidue));this.lastControl.x=N[J];this.lastControl.y=N[J+1];this.lastControl.type="C"}this.last.x=N[N.length-2];this.last.y=N[N.length-1]},_smoothCurveToR:function(P,J,N,Z){for(J=0;J<N.length;J+=4){var Y="C"==this.lastControl.type;P.push("bezierCurveTo",[Y?2*this.last.x-this.lastControl.x:this.last.x,Y?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+N[J],this.last.y+N[J+1],this.last.x+
N[J+2],this.last.y+N[J+3]]);Z&&(this._dashResidue=g(Z,this,P[P.length-1],this._dashResidue));this.lastControl.x=this.last.x+N[J];this.lastControl.y=this.last.y+N[J+1];this.lastControl.type="C";this.last.x+=N[J+2];this.last.y+=N[J+3]}},_qCurveToA:function(P,J,N,Z){for(J=0;J<N.length;J+=4)P.push("quadraticCurveTo",N.slice(J,J+4));Z&&(this._dashResidue=g(Z,this,P[P.length-1],this._dashResidue));this.last.x=N[N.length-2];this.last.y=N[N.length-1];this.lastControl.x=N[N.length-4];this.lastControl.y=N[N.length-
3];this.lastControl.type="Q"},_qCurveToR:function(P,J,N,Z){for(J=0;J<N.length;J+=4)P.push("quadraticCurveTo",[this.lastControl.x=this.last.x+N[J],this.lastControl.y=this.last.y+N[J+1],this.last.x+N[J+2],this.last.y+N[J+3]]),Z&&(this._dashResidue=g(Z,this,P[P.length-1],this._dashResidue)),this.last.x+=N[J+2],this.last.y+=N[J+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(P,J,N,Z){for(J=0;J<N.length;J+=2){var Y="Q"==this.lastControl.type;P.push("quadraticCurveTo",[this.lastControl.x=Y?2*this.last.x-
this.lastControl.x:this.last.x,this.lastControl.y=Y?2*this.last.y-this.lastControl.y:this.last.y,N[J],N[J+1]]);Z&&(this._dashResidue=g(Z,this,P[P.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=N[N.length-2];this.last.y=N[N.length-1]},_qSmoothCurveToR:function(P,J,N,Z){for(J=0;J<N.length;J+=2){var Y="Q"==this.lastControl.type;P.push("quadraticCurveTo",[this.lastControl.x=Y?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=Y?2*this.last.y-this.lastControl.y:this.last.y,
this.last.x+N[J],this.last.y+N[J+1]]);Z&&(this._dashResidue=g(Z,this,P[P.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=N[J];this.last.y+=N[J+1]}},_arcTo:function(P,J,N,Z){J="a"==J;for(var Y=0;Y<N.length;Y+=7){var qa=N[Y+5],V=N[Y+6];J&&(qa+=this.last.x,V+=this.last.y);var na=f.arcAsBezier(this.last,N[Y],N[Y+1],N[Y+2],N[Y+3]?1:0,N[Y+4]?1:0,qa,V);a.forEach(na,function(ya){P.push("bezierCurveTo",ya)});Z&&(this._dashResidue=g(Z,this,p,this._dashResidue));this.last.x=qa;this.last.y=
V}this.lastControl={}},_closePath:function(P,J,N,Z){P.push("closePath",[]);Z&&(this._dashResidue=k(Z,this,this.last.x,this.last.y,Z[1][0],Z[1][1],this._dashResidue));this.lastControl={}}});a.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(P){I(w.Path,P)});w.TextPath=D("dojox.gfx.canvas.TextPath",[w.Shape,n.TextPath],{_renderShape:function(P){},_setText:function(){},_setFont:function(){}});w.Surface=D("dojox.gfx.canvas.Surface",
q.Surface,{constructor:function(){q.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){q.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(P,J){this.width=F.normalizedLength(P);this.height=F.normalizedLength(J);if(!this.rawNode)return this;var N=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,N=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,N=!0);N&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?
{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(P){!this.rawNode||!P&&this.pendingImageCount||(P=this.rawNode.getContext("2d"),P.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(P),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender))},render:function(P){P.save();for(var J=0;J<this.children.length;++J)this.children[J]._render(P);P.restore()},makeDirty:function(){this.pendingImagesCount||"pendingRender"in this||this._batch||
(this.pendingRender=setTimeout(m.hitch(this,this._render),0))},downloadImage:function(P,J){var N=m.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);P.onload=N;P.onerror=N;P.onabort=N;P.src=J},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});
w.createSurface=function(P,J,N){if(!J&&!N){var Z=y.position(P);J=J||Z.w;N=N||Z.h}"number"==typeof J&&(J+="px");"number"==typeof N&&(N+="px");Z=new w.Surface;P=r.byId(P);var Y=P.ownerDocument.createElement("canvas");Y.width=F.normalizedLength(J);Y.height=F.normalizedLength(N);P.appendChild(Y);Z.rawNode=Y;Z._parent=P;return Z.surface=Z};var T=q.Container;D={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},
_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(P){this._makeDirty();return T.add.apply(this,arguments)},remove:function(P,J){this._makeDirty();return T.remove.apply(this,arguments)},clear:function(){this._makeDirty();return T.clear.apply(this,arguments)},getBoundingBox:T.getBoundingBox,_moveChildToFront:function(P){this._makeDirty();return T._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(P){this._makeDirty();return T._moveChildToBack.apply(this,arguments)}};
n={createObject:function(P,J){var N=new P;N.surface=this.surface;N.setShape(J);this.add(N);return N}};e(w.Group,D);e(w.Group,q.Creator);e(w.Group,n);e(w.Surface,D);e(w.Surface,q.Creator);e(w.Surface,n);w.fixTarget=function(P,J){return!0};return w})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(F,m,a){function D(f){var d=Math.cos(f);f=Math.sin(f);var e={x:d+4/3*(1-d),y:f-4/3*d*(1-d)/f};return{s:{x:d,y:-f},c1:{x:e.x,y:-e.y},c2:e,e:{x:d,y:f}}}var z=2*Math.PI,y=
Math.PI/4,r=Math.PI/8,q=y+r,n=D(r);return F.arc={unitArcAsBezier:D,curvePI4:n,arcAsBezier:function(f,d,e,b,c,h,g,k){c=!!c;h=!!h;var w=a._degToRad(b);b=d*d;var t=e*e,C=a.multiplyPoint(a.rotate(-w),{x:(f.x-g)/2,y:(f.y-k)/2}),u=C.x*C.x,x=C.y*C.y;b=Math.sqrt((b*t-b*x-t*u)/(b*x+t*u));isNaN(b)&&(b=0);b={x:b*d*C.y/e,y:-b*e*C.x/d};c==h&&(b={x:-b.x,y:-b.y});b=a.multiplyPoint([a.translate((f.x+g)/2,(f.y+k)/2),a.rotate(w)],b);d=a.normalize([a.translate(b.x,b.y),a.rotate(w),a.scale(d,e)]);b=a.invert(d);f=a.multiplyPoint(b,
f);k=a.multiplyPoint(b,g,k);g=Math.atan2(f.y,f.x);b=g-Math.atan2(k.y,k.x);h&&(b=-b);0>b?b+=z:b>z&&(b-=z);e=r;k=n;e=h?e:-e;f=[];for(c=b;0<c;c-=y)c<q&&(e=c/2,k=D(e),e=h?e:-e,c=0),C=a.normalize([d,a.rotate(g+e)]),h?(b=a.multiplyPoint(C,k.c1),w=a.multiplyPoint(C,k.c2),C=a.multiplyPoint(C,k.e)):(b=a.multiplyPoint(C,k.c2),w=a.multiplyPoint(C,k.c1),C=a.multiplyPoint(C,k.s)),f.push([b.x,b.y,w.x,w.y,C.x,C.y]),g+=2*e;return f}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],
function(F,m,a){function D(n,f){return Math.abs(n-f)<=1E-6*(Math.abs(n)+Math.abs(f))}function z(n,f,d,e){if(!isFinite(n))return d;if(!isFinite(d))return n;f=Math.abs(f);e=Math.abs(e);return(f*n+e*d)/(f+e)}function y(n){n=a.normalize(n);var f=-n.xx-n.yy,d=n.xx*n.yy-n.xy*n.yx,e=Math.sqrt(f*f-4*d);f=-(f+(0>f?-e:e))/2;d/=f;e=n.xy/(f-n.xx);var b=1,c=n.xy/(d-n.xx),h=1;D(f,d)&&(e=1,c=b=0,h=1);isFinite(e)||(e=1,b=(f-n.xx)/n.xy,isFinite(b)||(e=(f-n.yy)/n.yx,b=1,isFinite(e)||(e=1,b=n.yx/(f-n.yy))));isFinite(c)||
(c=1,h=(d-n.xx)/n.xy,isFinite(h)||(c=(d-n.yy)/n.yx,h=1,isFinite(c)||(c=1,h=n.yx/(d-n.yy))));n=Math.sqrt(e*e+b*b);var g=Math.sqrt(c*c+h*h);isFinite(e/=n)||(e=0);isFinite(b/=n)||(b=0);isFinite(c/=g)||(c=0);isFinite(h/=g)||(h=0);return{value1:f,value2:d,vector1:{x:e,y:b},vector2:{x:c,y:h}}}function r(n,f){var d=0>n.xx*n.yy||0<n.xy*n.yx?-1:1,e=f.angle1=(Math.atan2(n.yx,n.yy)+Math.atan2(-d*n.xy,d*n.xx))/2;d=Math.cos(e);e=Math.sin(e);f.sx=z(n.xx/d,d,-n.xy/e,e);f.sy=z(n.yy/d,d,n.yx/e,e);return f}function q(n,
f){var d=0>n.xx*n.yy||0<n.xy*n.yx?-1:1,e=f.angle2=(Math.atan2(d*n.yx,d*n.xx)+Math.atan2(-n.xy,n.yy))/2;d=Math.cos(e);e=Math.sin(e);f.sx=z(n.xx/d,d,n.yx/e,e);f.sy=z(n.yy/d,d,-n.xy/e,e);return f}return F.decompose=function(n){var f=a.normalize(n);n={dx:f.dx,dy:f.dy,sx:1,sy:1,angle1:0,angle2:0};if(D(f.xy,0)&&D(f.yx,0))return m.mixin(n,{sx:f.xx,sy:f.yy});if(D(f.xx*f.yx,-f.xy*f.yy))return r(f,n);if(D(f.xx*f.xy,-f.yx*f.yy))return q(f,n);var d=new a.Matrix2D(f);var e=m.mixin(d,{dx:0,dy:0,xy:d.yx,yx:d.xy});
d=y([f,e]);e=y([e,f]);d=new a.Matrix2D({xx:d.vector1.x,xy:d.vector2.x,yx:d.vector1.y,yy:d.vector2.y});e=new a.Matrix2D({xx:e.vector1.x,xy:e.vector1.y,yx:e.vector2.x,yy:e.vector2.y});f=new a.Matrix2D([a.invert(d),f,a.invert(e)]);r(e,n);f.xx*=n.sx;f.yy*=n.sy;q(d,n);f.xx*=n.sx;f.yy*=n.sy;return m.mixin(n,{sx:f.xx,sy:f.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(F){F=F.bezierutils={};F.tAtLength=function(r,q){var n=0,f=6==r.length,d=0,e=0,b=f?D:y,c=function(h,g){for(var k=
0,w=0;w<h.length-2;w+=2)k+=a(h[w],h[w+1],h[w+2],h[w+3]);w=f?a(r[0],r[1],r[4],r[5]):a(r[0],r[1],r[6],r[7]);k-w>g||d+k>q+g?(++e,k=b(h,.5),c(k[0],g),Math.abs(d-q)<=g||c(k[1],g)):(d+=k,n+=1/(1<<e))};q&&c(r,.5);return n};var m=F.computeLength=function(r){for(var q=6==r.length,n=0,f=0;f<r.length-2;f+=2)n+=a(r[f],r[f+1],r[f+2],r[f+3]);f=q?a(r[0],r[1],r[4],r[5]):a(r[0],r[1],r[6],r[7]);return.1<n-f?(r=q?D(r,.5):z(r,.5),n=m(r[0],q),n+=m(r[1],q)):n},a=F.distance=function(r,q,n,f){return Math.sqrt((n-r)*(n-r)+
(f-q)*(f-q))},D=function(r,q){var n=1-q,f=n*n,d=q*q,e=r[0],b=r[1],c=r[2],h=r[3],g=r[4],k=r[5],w=f*e+2*n*q*c+d*g;f=f*b+2*n*q*h+d*k;return[[e,b,n*e+q*c,n*b+q*h,w,f],[w,f,n*c+q*g,n*h+q*k,g,k]]},z=function(r,q){var n=1-q,f=n*n,d=f*n,e=q*q,b=e*q,c=r[0],h=r[1],g=r[2],k=r[3],w=r[4],t=r[5],C=r[6],u=r[7],x=d*c+3*f*q*g+3*n*e*w+b*C;d=d*h+3*f*q*k+3*n*e*t+b*u;return[[c,h,n*c+q*g,n*h+q*k,f*c+2*n*q*g+e*w,f*h+2*n*q*k+e*t,x,d],[x,d,f*g+2*n*q*w+e*C,f*k+2*n*q*t+e*u,n*w+q*C,n*t+q*u,C,u]]},y=F.splitBezierAtT=function(r,
q){return 6==r.length?D(r,q):z(r,q)};return F})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],function(F,m,a){m.getObject("json",!0,a);a.json._slice=function(D,z,y,r){var q=D.length,n=[];y=y||q;z=0>z?Math.max(0,z+q):Math.min(q,z);for(y=0>y?Math.max(0,y+q):Math.min(q,y);z<y;z+=r)n.push(D[z]);return n};a.json._find=function(D,z){function y(n){z&&(!0!==z||n instanceof Array?n[z]&&r.push(n[z]):r.push(n));for(var f in n){var d=n[f];z?d&&"object"==
typeof d&&y(d):r.push(d)}}var r=[];if(z instanceof Array){if(1==z.length)return D[z[0]];for(var q=0;q<z.length;q++)r.push(D[z[q]])}else y(D);return r};a.json._distinctFilter=function(D,z){for(var y=[],r={},q=0,n=D.length;q<n;++q){var f=D[q];z(f,q,D)&&("object"==typeof f&&f?f.__included||(f.__included=!0,y.push(f)):r[f+typeof f]||(r[f+typeof f]=!0,y.push(f)))}q=0;for(n=y.length;q<n;++q)y[q]&&delete y[q].__included;return y};return a.json.query=function(D,z){function y(e,b,c,h,g,k,w,t){return q[t].match(/[\*\?]/)||
"~"==w?"/^"+q[t].substring(1,q[t].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==w?"$/i":"$/")+".test("+b+")":e}var r=0,q=[];D=D.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(e){r+="["==e?1:"]"==e?-1:0;return"]"==e&&0<r?"`]":'"'==e.charAt(0)||"'"==e.charAt(0)?"`"+(q.push(e)-1):e});var n="";D.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});D=D.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,
function(e){return"."==e.charAt(0)?e:"@"==e?"$obj":(e.match(/:|^(\$|Math|true|false|null)$/)?"":"$obj.")+e}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(e,b,c){return(b=e.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?(c="",e.match(/^\./)&&(n="dojox.json._find("+n,c=",true)"),n=(b[1].match(/=/)?"dojo.map":b[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter")+"("+n,c+",function($obj){return "+b[2]+"})"):(b=e.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+
b[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(h,g,k){return"var av\x3d "+k.replace(/\$obj/,"a")+",bv\x3d "+k.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==g?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==g?-1:1)+";}\n"})+"return 0;})":(b=e.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(n="dojox.json._slice("+n,","+(b[1]||0)+","+(b[2]||0)+","+(b[3]||1)+")"):e.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(n="dojox.json._find("+n,("."==e.charAt(1)?",'"+c+"'":e.match(/,/)?
","+e:"")+")"):e}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,y).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(e,b,c,h,g,k,w,t){return y(e,h,g,k,w,t,c,b)});D=n+("$"==D.charAt(0)?"":"$")+D.replace(/`([0-9]+|\])/g,function(e,b){return"]"==b?"]":q[b]});for(var f=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+D+"}"),d=0;d<arguments.length-1;d++)arguments[d]=arguments[d+1];return z?f.apply(this,
arguments):f}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,extraParameters:null});m.setObject("tasks.PrintParameters",F,D);return F})},"esri/tasks/LegendLayer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.tasks.LegendLayer",layerId:null,
subLayerIds:null});m.setObject("tasks.LegendLayer",F,D);return F})},"esri/dijit/Geocoder":function(){define("require dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/_base/event dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/keys dojo/on dojo/query dojo/i18n!../nls/jsapi dojo/text!./templates/Geocoder.html dojo/uacss dojo/_base/kernel dijit/a11yclick dijit/_TemplatedMixin dijit/focus dijit/_FocusMixin ../kernel ../urlUtils ../SpatialReference ../graphic ../symbols/PictureMarkerSymbol ./_EventedWidget ../geometry/Point ../geometry/Extent ../tasks/locator ../tasks/query ../tasks/QueryTask ../geometry/scaleUtils".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K,ba){m=m("esri.dijit.Geocoder",[B,w,C],{templateString:c,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,_eventMap:{select:["result"],"find-results":["results"],"auto-complete":["results"],"geocoder-select":["geocoder"],clear:!0,"enter-key-select":!0,load:!0},constructor:function(T,P){g.deprecated("esri.dijit.Geocoder","Use esri.dijit.Search instead","4.0");this._css={GeocoderContainerClass:"esriGeocoderContainer",GeocoderClass:"esriGeocoder",
GeocoderMultipleClass:"esriGeocoderMultiple",GeocoderIconClass:"esriGeocoderIcon",GeocoderActiveClass:"esriGeocoderActive",GeocoderResultsOpenClass:"esriGeocoderResultsOpen",GeocoderMenuOpenClass:"esriGeocoderMenuOpen",loadingClass:"esriGeocoderLoading",resultsContainerClass:"esriGeocoderResults",resultsItemClass:"esriGeocoderResult",resultsItemEvenClass:"esriGeocoderResultEven",resultsItemOddClass:"esriGeocoderResultOdd",resultsItemFirstClass:"esriGeocoderResultFirst",resultsItemLastClass:"esriGeocoderResultLast",
resultsPartialMatchClass:"esriGeocoderResultPartial",searchButtonClass:"esriGeocoderSearch",clearButtonClass:"esriGeocoderReset",hasValueClass:"esriGeocoderHasValue",geocoderMenuClass:"esriGeocoderMenu",geocoderMenuHeaderClass:"esriGeocoderMenuHeader",geocoderMenuCloseClass:"esriGeocoderMenuClose",activeMenuClass:"esriGeocoderMenuActive",geocoderMenuArrowClass:"esriGeocoderMenuArrow",geocoderSelectedClass:"esriGeocoderSelected",geocoderSelectedCheckClass:"esriGeocoderSelectedCheck",GeocoderClearClass:"esriGeocoderClearFloat"};
this.options={autoComplete:!1,arcgisGeocoder:!0,value:"",theme:"simpleGeocoder",activeGeocoderIndex:0,maxLocations:6,minCharacters:3,searchDelay:300,geocoderMenu:!0,autoNavigate:!0,showResults:!0,map:null,activeGeocoder:null,geocoders:null,zoomScale:1E4,highlightLocation:!1,symbol:new A(F.toUrl("./images/sdk_gps_location.png"),28,28),graphicsLayer:null};var J=a.mixin({},this.options,T);this.set("autoComplete",J.autoComplete);this.set("arcgisGeocoder",J.arcgisGeocoder);this.set("value",J.value);this.set("theme",
J.theme);this.set("activeGeocoderIndex",J.activeGeocoderIndex);this.set("maxLocations",J.maxLocations);this.set("minCharacters",J.minCharacters);this.set("searchDelay",J.searchDelay);this.set("geocoderMenu",J.geocoderMenu);this.set("autoNavigate",J.autoNavigate);this.set("showResults",J.showResults);this.set("map",J.map);this.set("activeGeocoder",J.activeGeocoder);this.set("geocoders",J.geocoders);this.set("zoomScale",J.zoomScale);this.set("highlightLocation",J.highlightLocation);this.set("symbol",
J.symbol);this.set("graphicsLayer",J.graphicsLayer);this.set("results",[]);this._i18n=b;this._deferreds=[];this._defaultSR=new l(4326);this.watch("value",this._updateValue);this.watch("theme",this._updateTheme);this.watch("activeGeocoder",this._setActiveGeocoder);this.watch("activeGeocoderIndex",this._setActiveGeocoderIndex);this.watch("geocoders",this._updateGeocoder);this.watch("arcgisGeocoder",this._updateGeocoder);this.watch("geocoderMenu",this._updateGeocoder);this.watch("map",this._setupEvents);
this.domNode=P},startup:function(){this.inherited(arguments);if(this._geocoders.length)if(this.domNode)if(this.get("map"))if(this.get("map").loaded)this._init();else d.once(this.get("map"),"load",a.hitch(this,function(){this._init()}));else this._init();else this.destroy();else this.destroy()},postCreate:function(){this.inherited(arguments);this.own(d(this.submitNode,k,a.hitch(this,this._findThenSelect)));this.own(d(this.geocoderMenuArrowNode,k,a.hitch(this,this._toggleGeolocatorMenu)));this.own(d(this.inputNode,
k,a.hitch(this,this._inputClick)));this.own(d(this.clearNode,k,a.hitch(this,this.clear)));this.own(d(this.geocoderMenuCloseNode,k,a.hitch(this,this._hideGeolocatorMenu)));this._updateGeocoder();this._setupEvents();this.get("value")&&this._checkStatus();this._hideMenus()},destroy:function(){this._removeEvents();n.empty(this.domNode);this.inherited(arguments)},clear:function(){this.onClear();var T=this.get("highlightGraphic"),P=this.get("graphicsLayer");T&&(P?P.remove(T):this.get("map").graphics.remove(T),
this.set("highlightGraphic",null));y.set(this.inputNode,"value","");this.set("value","");this.set("results",[]);r.remove(this.containerNode,this._css.hasValueClass);y.set(this.clearNode,"title","");this._hideMenus();this._hideLoading()},show:function(){q.set(this.domNode,"display","block")},hide:function(){q.set(this.domNode,"display","none")},find:function(T){var P=new D;if(T)if("string"===typeof T)this._findQuery(T).then(function(N){P.resolve(N)});else if("object"===typeof T&&T.hasOwnProperty("geometry")){switch(T.geometry.type){case "extent":var J=
T.geometry.getCenter();break;case "multipoint":J=T.geometry.getExtent().getCenter();break;case "point":J=T.geometry;break;case "polygon":J=T.geometry.getExtent().getCenter();break;case "polyline":J=T.geometry.getExtent().getCenter()}J&&this._reverseGeocodePoint(J,T.geometry).then(function(N){N.results[0]&&(T.hasOwnProperty("attributes")&&N.results[0].feature.setAttributes(a.mixin(N.results[0].feature.attributes,T.attributes)),T.hasOwnProperty("infoTemplate")&&N.results[0].feature.setInfoTemplate(T.infoTemplate),
T.hasOwnProperty("symbol")&&N.results[0].feature.setSymbol(T.symbol));P.resolve(N)},function(N){P.reject(N)})}else"object"===typeof T&&"point"===T.type?this._reverseGeocodePoint(T).then(function(N){P.resolve(N)},function(N){P.reject(N)}):T instanceof Array&&2===T.length?(J=new E(T,new l({wkid:4326})),this._reverseGeocodePoint(J).then(function(N){P.resolve(N)},function(N){P.reject(N)})):P.reject("Geocoder:: Invalid find type");else this._findQuery(this.get("value")).then(function(N){P.resolve(N)});
return P.promise},focus:function(){t.focus(this.inputNode);var T=this.get("map");T&&T.disableKeyboardNavigation()},blur:function(){t.curNode&&t.curNode.blur();this.inputNode.blur();this._hideMenus();var T=this.get("map");T&&T.enableKeyboardNavigation()},select:function(T){this.onSelect(T);this._hideMenus();this._hideLoading();this.get("autoNavigate")&&T&&T.hasOwnProperty("extent")&&this.get("map")&&this.get("map").setExtent(T.extent);if(T.feature){var P=this.get("highlightGraphic"),J=this.get("graphicsLayer"),
N=this.get("symbol")||T.feature.symbol;P?(P.setGeometry(T.feature.geometry),P.setAttributes(T.feature.attributes),P.setInfoTemplate(T.feature.infoTemplate),P.setSymbol(N)):(P=T.feature,this.get("highlightLocation")&&(P.setSymbol(N),J?J.add(P):this.get("map").graphics.add(P)));this.set("highlightGraphic",P)}},onSelect:function(){},onFindResults:function(){},onAutoComplete:function(){},onGeocoderSelect:function(){},onClear:function(){},onEnterKeySelect:function(){},onLoad:function(){},_onFocus:function(){this.focus();
this.inherited(arguments)},_onBlur:function(){this.blur();this.inherited(arguments)},_autoComplete:function(){var T=this.get("activeGeocoder"),P=this.reHostedFS.test(T.url);("query"!==T.type||P)&&this._query({delay:this.get("searchDelay"),autoComplete:!0,search:this.get("value")}).then(a.hitch(this,function(J){this.onAutoComplete(J);this.get("showResults")&&this._showResults(J)}))},_init:function(){this.set("loaded",!0);this.onLoad()},_containsNonLatinCharacter:function(T){for(var P=0;P<T.length;P++)if(255<
T.charCodeAt(P))return!0;return!1},_findQuery:function(T){var P=new D;this._query({delay:0,search:T}).then(a.hitch(this,function(J){this.onFindResults(J);P.resolve(J)}),a.hitch(this,function(J){this.onFindResults(J);P.reject(J)}));return P.promise},_reverseGeocodePoint:function(T,P){var J=new D;if(T&&this.get("activeGeocoder")){var N=P||T,Z=this.get("activeGeocoder").distance||1500;this._task.outSpatialReference=this._defaultSR;this.get("map")&&(this._task.outSpatialReference=this.get("map").spatialReference);
this._task.locationToAddress(T,Z,a.hitch(this,function(Y){Y={results:[this._hydrateResult(Y)],geometry:N};this.onFindResults(Y);J.resolve(Y)}),a.hitch(this,function(Y){J.reject(Y)}))}else J.reject("Geocoder:: no point or active geocoder defined");return J.promise},_setEsriGeocoder:function(){this.get("arcgisGeocoder")?("object"===typeof this.get("arcgisGeocoder")?this._arcgisGeocoder=this.get("arcgisGeocoder"):this._arcgisGeocoder={},this._arcgisGeocoder.hasOwnProperty("suggest")||(this._arcgisGeocoder.suggest=
!0),this._arcgisGeocoder.hasOwnProperty("singleLineFieldName")||(this._arcgisGeocoder.singleLineFieldName="SingleLine"),this._arcgisGeocoder.url||(this._arcgisGeocoder.url=x.getProtocolForWebResource()+"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),this._arcgisGeocoder.name||(this._arcgisGeocoder.name=b.widgets.Geocoder.esriGeocoderName),this._arcgisGeocoder.hasOwnProperty("localSearchOptions")||(this._arcgisGeocoder.localSearchOptions={minScale:3E5,distance:5E4}),this.set("arcgisGeocoder",
this._arcgisGeocoder)):this.set("arcgisGeocoder",!1)},_setActiveGeocoder:function(){this.set("activeGeocoder",this._geocoders[this.get("activeGeocoderIndex")]);this._task="query"===this.activeGeocoder.type?new K(this.get("activeGeocoder").url):new I(this.get("activeGeocoder").url);this._updatePlaceholder()},_setGeocoderList:function(){var T=[];this.get("arcgisGeocoder")&&(T=T.concat([this._arcgisGeocoder]));this.get("geocoders")&&this.get("geocoders").length&&(T=T.concat(this.get("geocoders")));this._geocoders=
T},_updateGeocoder:function(){this.set("activeGeocoderIndex",0);this._setEsriGeocoder();this._setGeocoderList();this._setActiveGeocoder();this._insertGeocoderMenuItems()},_updatePlaceholder:function(){this._placeholder="";this.get("activeGeocoder")&&this.get("activeGeocoder").placeholder&&(this._placeholder=this.get("activeGeocoder").placeholder);y.set(this.inputNode,"placeholder",this._placeholder);y.set(this.submitNode,"title",this._placeholder)},_updateValue:function(T,P,J){this._ignoreUpdateValue||
(y.set(this.inputNode,"value",J),this._checkStatus())},_updateTheme:function(T,P,J){r.remove(this.domNode,P);r.add(this.domNode,J)},_setActiveGeocoderIndex:function(T,P,J){this.set("activeGeocoderIndex",J);this._setActiveGeocoder();this._hideMenus();this._insertGeocoderMenuItems();T={attr:this.get("activeGeocoder"),oldVal:P,newVal:J};this.onGeocoderSelect(T)},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_query:function(T){T||(T={delay:0});T.search||(T.search=this.get("value"));
var P=new D;this._deferreds.push(P);T.delay?(this._clearQueryTimeout(),this._queryTimer=setTimeout(a.hitch(this,function(){this._performTask(P,T)}),T.delay)):this._performTask(P,T);return P.promise},_performTask:function(T,P){if(P.search){this._hideGeolocatorMenu();this._showLoading();var J="";this.get("activeGeocoder").prefix&&(J+=this.get("activeGeocoder").prefix);J+=P.search;this.get("activeGeocoder").suffix&&(J+=this.get("activeGeocoder").suffix);var N=this.get("activeGeocoder").outFields;N&&
(N instanceof Array||(N=[N]));var Z=this.get("maxLocations")||6,Y=this.get("activeGeocoder").searchExtent,qa=this._defaultSR;this.get("map")&&(qa=this.get("map").spatialReference);if("query"===this.get("activeGeocoder").type){var V=new L;V.outSpatialReference=qa;V.returnGeometry=!0;V.num=Z;Y&&(V.geometry=Y);Z=this.get("activeGeocoder").exactMatch;Y=this.get("activeGeocoder").field;qa="";this.reHostedFS.test(this.get("activeGeocoder").url)&&this._containsNonLatinCharacter(J)&&(qa="N");V.where=Z?Y+
" \x3d "+qa+"'"+J+"'":"UPPER("+Y+") LIKE "+qa+"'%"+J.toUpperCase()+"%'";N&&(V.outFields=N);this._task.execute(V,a.hitch(this,function(na){this._receivedResults(na.features,T,P)}),a.hitch(this,function(na){this._receivedResults([],T,P)}))}else V={},this.get("activeGeocoder").categories&&(V.categories=this.get("activeGeocoder").categories),this._task.outSpatialReference=qa,this.get("map")&&this.get("activeGeocoder").localSearchOptions&&this.get("activeGeocoder").localSearchOptions.hasOwnProperty("distance")&&
this.get("activeGeocoder").localSearchOptions.hasOwnProperty("minScale")&&(qa=this.get("map").getScale(),!this.get("activeGeocoder").localSearchOptions.minScale||qa&&qa<=parseFloat(this.get("activeGeocoder").localSearchOptions.minScale))&&(V.location=this.get("map").extent.getCenter(),V.distance=this.get("activeGeocoder").localSearchOptions.distance),this.get("activeGeocoder").suggest&&P.autoComplete?(V.text=J,Y&&(V.searchExtent=Y),this._task.suggestLocations(V).then(a.hitch(this,function(na){this._receivedResults(na,
T,P)}),a.hitch(this,function(na){this._receivedResults(na,T,P)}))):(V.address={},V.maxLocations=Z,Y&&(V.searchExtent=Y),this.get("activeGeocoder").sourceCountry&&(V.countryCode=this.get("activeGeocoder").sourceCountry),P.magicKey&&(V.magicKey=P.magicKey),this.get("activeGeocoder").singleLineFieldName?V.address[this.get("activeGeocoder").singleLineFieldName]=J:V.address["Single Line Input"]=J,N&&(V.outFields=N),this._task.addressToLocations(V,a.hitch(this,function(na){this._receivedResults(na,T,P)}),
a.hitch(this,function(na){this._receivedResults(na,T,P)})))}else this._hideLoading(),T.reject("Geocoder:: no search to perform")},_showResults:function(){this._hideGeolocatorMenu();var T="";if(this.get("results")&&this.get("results").length&&this.resultsNode){var P=this.get("value"),J=new RegExp("("+P+")","gi");T+='\x3cul role\x3d"presentation"\x3e';for(P=0;P<this.get("results").length&&5>P;++P){var N=this.get("results")[P].text||this.get("results")[P].name,Z=this._css.resultsItemClass+" ";Z=0===
P%2?Z+this._css.resultsItemOddClass:Z+this._css.resultsItemEvenClass;0===P?Z+=" "+this._css.resultsItemFirstClass:P===this.get("results").length-1&&(Z+=" "+this._css.resultsItemLastClass);T+='\x3cli title\x3d"'+N+'" data-text\x3d"'+N+'" data-item\x3d"true" data-index\x3d"'+P+'" role\x3d"menuitem" tabindex\x3d"0" class\x3d"'+Z+'"\x3e'+N.replace(J,'\x3cstrong class\x3d"'+this._css.resultsPartialMatchClass+'"\x3e$1\x3c/strong\x3e')+"\x3c/li\x3e"}T+="\x3c/ul\x3e";this.resultsNode&&(this.resultsNode.innerHTML=
T);this._autoCompleteEvent();this._showResultsMenu()}else this.resultsNode&&(this.resultsNode.innerHTML=T),this._hideResultsMenu()},_receivedResults:function(T,P){this._hideLoading();var J=this._hydrateResults(T);this.set("results",J);J={results:J,value:this.get("value")};P.resolve(J)},_showLoading:function(){r.add(this.containerNode,this._css.loadingClass)},_hideLoading:function(){r.remove(this.containerNode,this._css.loadingClass)},_showGeolocatorMenu:function(){r.add(this.containerNode,this._css.activeMenuClass);
r.add(this.domNode,this._css.GeocoderMenuOpenClass);q.set(this.geocoderMenuNode,"display","block");y.set(this.geocoderMenuInsertNode,"aria-hidden","false");y.set(this.geocoderMenuArrowNode,"aria-expanded","true")},_hideGeolocatorMenu:function(){r.remove(this.containerNode,this._css.activeMenuClass);r.remove(this.domNode,this._css.GeocoderMenuOpenClass);q.set(this.geocoderMenuNode,"display","none");y.set(this.geocoderMenuInsertNode,"aria-hidden","true");y.set(this.geocoderMenuArrowNode,"aria-expanded",
"false")},_toggleGeolocatorMenu:function(){this._hideResultsMenu();"block"===q.get(this.geocoderMenuNode,"display")?this._hideGeolocatorMenu():this._showGeolocatorMenu()},_showResultsMenu:function(){r.add(this.containerNode,this._css.GeocoderActiveClass);r.add(this.domNode,this._css.GeocoderResultsOpenClass);q.set(this.resultsNode,"display","block");y.set(this.resultsNode,"aria-hidden","false")},_hideResultsMenu:function(){q.set(this.resultsNode,"display","none");r.remove(this.containerNode,this._css.GeocoderActiveClass);
r.remove(this.domNode,this._css.GeocoderResultsOpenClass);y.set(this.resultsNode,"aria-hidden","true")},_hideMenus:function(){this._hideGeolocatorMenu();this._hideResultsMenu()},_insertGeocoderMenuItems:function(){if(this.get("geocoderMenu")&&this._geocoders&&1<this._geocoders.length){var T="",P;var J='\x3cul role\x3d"presentation"\x3e';for(P=0;P<this._geocoders.length;P++){T=this._css.resultsItemClass+" ";T=0===P%2?T+this._css.resultsItemOddClass:T+this._css.resultsItemEvenClass;P===this.get("activeGeocoderIndex")&&
(T+=" "+this._css.geocoderSelectedClass);0===P?T+=" "+this._css.resultsItemFirstClass:P===this._geocoders.length-1&&(T+=" "+this._css.resultsItemLastClass);var N=this._geocoders[P].name||b.widgets.Geocoder.main.untitledGeocoder;J+='\x3cli data-index\x3d"'+P+'" data-item\x3d"true" role\x3d"menuitem" tabindex\x3d"0" class\x3d"'+T+'"\x3e';J+='\x3cdiv class\x3d"'+this._css.geocoderSelectedCheckClass+'"\x3e\x3c/div\x3e';J+=N;J+='\x3cdiv class\x3d"'+this._css.GeocoderClearClass+'"\x3e\x3c/div\x3e';J+="\x3c/li\x3e"}this.geocoderMenuInsertNode.innerHTML=
J+"\x3c/ul\x3e";this._geocoderMenuEvent();q.set(this.geocoderMenuNode,"display","none");q.set(this.geocoderMenuArrowNode,"display","block");r.add(this.containerNode,this._css.GeocoderMultipleClass)}else this.geocoderMenuInsertNode.innerHTML="",q.set(this.geocoderMenuNode,"display","none"),q.set(this.geocoderMenuArrowNode,"display","none"),r.remove(this.containerNode,this._css.GeocoderMultipleClass)},_checkStatus:function(){this.get("value")?(r.add(this.containerNode,this._css.hasValueClass),y.set(this.clearNode,
"title",b.widgets.Geocoder.main.clearButtonTitle)):this.clear()},_autoCompleteEvent:function(){var T=e('[data-item\x3d"true"]',this.resultsNode);this._acEvent&&this._acEvent.remove();this._acEvent=d(T,"click, keydown",a.hitch(this,function(P){this._clearQueryTimeout();var J=parseInt(y.get(P.currentTarget,"data-index"),10),N=y.get(P.currentTarget,"data-text");"click"===P.type||"keydown"===P.type&&P.keyCode===f.ENTER?(y.set(this.inputNode,"value",N),this.set("value",N),this.get("results")&&this.get("results")[J]&&
(P=this.get("results")[J],P.name?this.select(P):this._query({delay:0,search:P.text,magicKey:P.magicKey||null}).then(a.hitch(this,function(Z){this.select(Z.results[0])})))):"keydown"!==P.type||P.keyCode!==f.BACKSPACE&&P.keyCode!==f.DELETE?"keydown"===P.type&&P.keyCode===f.UP_ARROW?(z.stop(P),P=J-1,0>P?this.inputNode.focus():T[P].focus()):"keydown"===P.type&&P.keyCode===f.DOWN_ARROW?(z.stop(P),P=J+1,P>=T.length?this.inputNode.focus():T[P].focus()):P.keyCode===f.ESCAPE&&this._hideMenus():(z.stop(P),
this.inputNode.focus(),P=this.inputNode.value.slice(0,-1),y.set(this.inputNode,"value",P),this.set("value",P))}))},_geocoderMenuEvent:function(){var T=e('[data-item\x3d"true"]',this.geocoderMenuInsertNode);this._gmEvent&&this._gmEvent.remove();this._gmEvent=d(T,"click, keydown",a.hitch(this,function(P){var J=parseInt(y.get(P.currentTarget,"data-index"),10);"click"===P.type||"keydown"===P.type&&P.keyCode===f.ENTER?(this._setActiveGeocoderIndex(null,null,J),this._hideGeolocatorMenu()):"keydown"===P.type&&
P.keyCode===f.UP_ARROW?(z.stop(P),P=J-1,0>P?this.geocoderMenuArrowNode.focus():T[P].focus()):"keydown"===P.type&&P.keyCode===f.DOWN_ARROW?(z.stop(P),P=J+1,P>=T.length?this.geocoderMenuArrowNode.focus():T[P].focus()):P.keyCode===f.ESCAPE&&this._hideGeolocatorMenu()}))},_removeEvents:function(){var T;if(this._events&&this._events.length)for(T=0;T<this._events.length;T++)this._events[T].remove();this._acEvent&&this._acEvent.remove();this._gmEvent&&this._gmEvent.remove();this._events=[]},_setupEvents:function(){this._removeEvents();
var T=d(document,"click",a.hitch(this,function(P){this._hideResultsMenu(P)}));this._events.push(T);T=d(this.inputNode,"keyup",a.hitch(this,function(P){this._inputKeyUp(P)}));this._events.push(T);T=d(this.inputNode,"keydown",a.hitch(this,function(P){this._inputKeyDown(P)}));this._events.push(T);T=d(this.geocoderMenuArrowNode,"keydown",this._geocoderMenuButtonKeyDown());this._events.push(T);this.get("map")&&(T=d(this.get("map"),"mouse-down",a.hitch(this,function(){this.blur()})),this._events.push(T));
this._geocoderMenuEvent();this._autoCompleteEvent()},_findThenSelect:function(){this.find().then(a.hitch(this,function(T){T.results&&T.results.length&&(this.select(T.results[0]),this.onEnterKeySelect())}))},_inputKeyUp:function(T){if(T){this._clearQueryTimeout();var P=this.inputNode.value;this._ignoreUpdateValue=!0;this.set("value",P);this._ignoreUpdateValue=!1;var J=0;P&&(J=P.length);if(T.ctrlKey||T.metaKey||T.altKey||T.keyCode===f.copyKey||T.keyCode===f.ALT||T.keyCode===f.CTRL||T.keyCode===f.META||
T.keyCode===f.SHIFT||T.keyCode===f.UP_ARROW||T.keyCode===f.DOWN_ARROW||T.keyCode===f.LEFT_ARROW||T.keyCode===f.RIGHT_ARROW)return T;T&&T.keyCode===f.ENTER?(this._cancelDeferreds(),this._findThenSelect()):T&&T.keyCode===f.ESCAPE?(this._cancelDeferreds(),this._hideMenus()):T&&T.keyCode===f.TAB?(this._cancelDeferreds(),this._hideMenus()):this.get("autoComplete")&&J>=this.get("minCharacters")?this._autoComplete():this._hideMenus();this._checkStatus()}},_cancelDeferreds:function(){if(this._deferreds.length){for(var T=
0;T<this._deferreds.length;T++)this._deferreds[T].cancel("Geocoder:: stop query");this._deferreds=[]}},_inputKeyDown:function(T){var P=e('[data-item\x3d"true"]',this.resultsNode);T&&T.keyCode===f.TAB?(this._cancelDeferreds(),this._hideMenus()):T&&T.keyCode===f.UP_ARROW?(z.stop(T),(T=P.length)&&P[T-1].focus()):T&&T.keyCode===f.DOWN_ARROW&&(z.stop(T),P[0]&&P[0].focus())},_geocoderMenuButtonKeyDown:function(T){var P=e('[data-item\x3d"true"]',this.geocoderMenuInsertNode);T&&T.keyCode===f.UP_ARROW?(z.stop(T),
this._showGeolocatorMenu(),(T=P.length)&&P[T-1].focus()):T&&T.keyCode===f.DOWN_ARROW&&(z.stop(T),this._showGeolocatorMenu(),P[0]&&P[0].focus())},_inputClick:function(){this._hideGeolocatorMenu()},_hydrateResult:function(T){var P={},J=this._defaultSR,N;this.get("map")&&(J=this.get("map").spatialReference);if(T.hasOwnProperty("text")&&T.hasOwnProperty("magicKey"))return T;if(T.hasOwnProperty("feature"))P.feature=new v(T.feature),(N=P.feature.geometry)&&N.setSpatialReference(J);else if(T.hasOwnProperty("geometry")){var Z=
T.symbol||null;N=T.attributes||{};P.feature=new v(T.geometry,Z,N,T.infoTemplate||null);(N=P.feature.geometry)&&N.setSpatialReference(J)}else T.hasOwnProperty("location")?(Z=new E(T.location.x,T.location.y,J),N={},T.hasOwnProperty("attributes")&&(N=T.attributes),T.hasOwnProperty("score")&&(N.score=T.score),P.feature=new v(Z,null,N,null)):P.feature=null;if(T.hasOwnProperty("extent"))P.extent=new G(T.extent),P.extent.setSpatialReference(new l(J));else if(P.feature&&P.feature.geometry)switch(P.feature.geometry.type){case "extent":P.extent=
P.feature.geometry;break;case "multipoint":P.extent=P.feature.geometry.getExtent();break;case "polygon":P.extent=P.feature.geometry.getExtent();break;case "polyline":P.extent=P.feature.geometry.getExtent();break;case "point":this.get("map")?this.get("map").getScale()>this.get("zoomScale")?P.extent=ba.getExtentForScale(this.get("map"),this.get("zoomScale")).centerAt(P.feature.geometry):P.extent=this.get("map").extent.centerAt(P.feature.geometry):P.extent=new G({xmin:P.feature.geometry.x-.25,ymin:P.feature.geometry.y-
.25,xmax:P.feature.geometry.x+.25,ymax:P.feature.geometry.y+.25,spatialReference:{wkid:4326}})}else P.extent=null;T.hasOwnProperty("name")?P.name=T.name:"query"===this.activeGeocoder.type&&this.activeGeocoder.field&&T.hasOwnProperty("attributes")&&T.attributes.hasOwnProperty(this.activeGeocoder.field)?P.name=T.attributes[this.activeGeocoder.field]:T.hasOwnProperty("Match_addr")&&"string"===typeof T.Match_addr?P.name=T.Match_addr:T.hasOwnProperty("address")&&"object"===typeof T.address&&T.address.hasOwnProperty("Match_addr")?
P.name=T.address.Match_addr:T.hasOwnProperty("address")&&"string"===typeof T.address?P.name=T.address:T.hasOwnProperty("address")&&"object"===typeof T.address&&T.address.hasOwnProperty("Address")?P.name=T.address.Address:P.name=P.feature&&P.feature.geometry?P.feature.geometry.x+","+P.feature.geometry.y:"";return P},_hydrateResults:function(T){var P=[],J=0;if(T&&T.length)for(J;J<T.length;J++){var N=this._hydrateResult(T[J]);P.push(N)}return P}});a.setObject("dijit.Geocoder",m,u);return m})},"esri/dijit/OverviewMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/html dojo/has dojo/dom-class dojo/dom-style dojo/dnd/Moveable dijit/_Widget dijit/_Templated ../map ../geometry/Point ../geometry/ScreenPoint ../layers/TiledMapServiceLayer ../layers/DynamicMapServiceLayer ../layers/VectorTileLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/RasterXLayer ../layers/OpenStreetMapLayer ../virtualearth/VETiledLayer ../kernel ../config ../domUtils dojo/text!./templates/OverviewMap.html dojo/i18n!../nls/jsapi".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E){F=F([n,f],{declaredClass:"esri.dijit.OverviewMap",widgetsInTemplate:!0,templateString:B,constructor:function(G,I){m.mixin(this,E.widgets.overviewMap);G=G||{};if(G.map){var L={};I&&(this._detached=!0,L=D.coords(I,!0));this.map=G.map;this.baseLayer=G.baseLayer;this.width=G.width||L.w||this.map.width/4;this.height=G.height||L.h||this.map.height/4;this.attachTo=G.attachTo||"top-right";this.expandFactor=G.expandFactor||2;this.color=G.color||
"#000000";this.opacity=G.opacity||.5;this.maximizeButton=!!G.maximizeButton;this.visible=!!G.visible;if(this.map.loaded)this._initialSetup();else var K=a.connect(this.map,"onLoad",this,function(){a.disconnect(K);K=null;this._initialSetup()});this._detached&&(this.visible=!0);this._maximized=!1}},startup:function(){this.inherited(arguments);(!this.domNode.parentNode||9>z("ie")&&"DIV"!==this.domNode.parentNode.nodeName)&&this.map.container.appendChild(this.domNode);this._detached?(r.set(this._body,
"display","block"),r.set(this._controllerDiv,"display","none"),r.set(this._maximizerDiv,"display","none"),this.map.loaded?this._initialize():a.connect(this.map,"onLoad",this,this._initialize)):("bottom"===this.attachTo.split("-")[0]&&this.domNode.insertBefore(this._maximizerDiv,this._controllerDiv),this.maximizeButton||y.add(this._maximizerDiv,"ovwDisabledButton"),y.add(this.domNode,{"top-left":"ovwTL","top-right":"ovwTR","bottom-left":"ovwBL","bottom-right":"ovwBR"}[this.attachTo]),y.add(this._controllerDiv,
"ovwShow"),y.add(this._maximizerDiv,"ovwMaximize"),this.visible&&this.map.loaded&&(this.visible=!1,this.show()));r.set(this._focusDiv,"opacity",this.opacity)},destroy:function(){this._deactivate();this.overviewMap&&this.overviewMap.destroy();this.overviewMap=this.baseLayer=null;this.inherited(arguments)},resize:function(G){!G||0>=G.w||0>=G.h||this._resize(G.w,G.h)},show:function(){if(!this.visible){var G=this._controllerDiv;G.title=this.NLS_hide;y.remove(G,"ovwShow");y.add(G,"ovwHide");A.show(this._body);
A.show(this._maximizerDiv);this._initialize();this.visible=!0}},hide:function(){if(this.visible){var G=this._controllerDiv;G.title=this.NLS_show;y.remove(G,"ovwHide");y.add(G,"ovwShow");this._maximized&&this._maximizeHandler();A.hide(this._body);A.hide(this._maximizerDiv);this._deactivate();this.visible=!1}},_initialSetup:function(){if(this._mainMapLayer=this.map.getLayer(this.map.layerIds[0])){var G=this.baseLayer||this._mainMapLayer,I=this.map.spatialReference,L=G.spatialReference;if(L.wkid===I.wkid||
L.wkt===I.wkt){I=G.declaredClass;if(G instanceof c)if(-1!==I.indexOf("VETiledLayer"))this.baseLayer=new x({resourceInfo:G.getResourceInfo(),culture:G.culture,mapStyle:G.mapStyle,bingMapsKey:G.bingMapsKey});else if(-1!==I.indexOf("OpenStreetMapLayer"))this.baseLayer=new u({tileServers:G.tileServers});else if(-1!==I.indexOf("WebTiledLayer")){I=G.initialExtent;L=G.fullExtent;var K=G.tileInfo;this.baseLayer=new G.constructor(G.urlTemplate,{initialExtent:I&&new I.constructor(I.toJson()),fullExtent:L&&
new L.constructor(L.toJson()),tileInfo:K&&new K.constructor(K.toJson()),tileServers:G.tileServers&&G.tileServers.slice(0)})}else this.baseLayer=new k(G.url,{resourceInfo:G.getResourceInfo()});else if(G instanceof h)-1!==I.indexOf("ArcGISImageServiceLayer")?this.baseLayer=new t(G.url):(this.baseLayer=new w(G.url),this.baseLayer.setImageFormat("png24"));else if(G instanceof C)this.baseLayer=new C(G.url);else if(G instanceof g)this.baseLayer=new k("https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer",
{});else return;!this._detached&&this.visible&&this._controllerDiv&&(G=function(){this.visible=!1;this.show()},this.baseLayer.loaded?G.call(this):a.connect(this.baseLayer,"onLoad",this,G))}}},_visibilityHandler:function(){this.visible?this.hide():this.show()},_maximizeHandler:function(){var G=this._maximizerDiv;this._maximized?(G.title=this.NLS_maximize,y.remove(G,"ovwRestore"),y.add(G,"ovwMaximize"),this._resize(this.width,this.height)):(G.title=this.NLS_restore,y.remove(G,"ovwMaximize"),y.add(G,
"ovwRestore"),this._resize(this.map.width,this.map.height));this._maximized=!this._maximized},_resize:function(G,I){r.set(this._body,{width:G+"px",height:I+"px"});var L=v.defaults.map.panDuration,K=this.overviewMap;v.defaults.map.panDuration=0;K&&(K.resize(!0),K.centerAt(this._focusExtent.getCenter()));v.defaults.map.panDuration=L},_initialize:function(){if(this.overviewMap)this._activate();else{var G;var I=9>z("ie")?this._body.firstChild:this._body.firstElementChild;this.overviewMap=G=new d(I,{slider:!1,
showAttribution:!1,logo:!1,lods:this._overviewLods,wrapAround180:this.map.wrapAround180});a.connect(G,"onLoad",this,function(){this._map_resize_override=m.hitch(G,this._map_resize_override);G.disableMapNavigation();this._activate()});G.addLayer(this.baseLayer)}},_activate:function(){var G=this.map,I=this.overviewMap;this._moveableHandle=new q(this._focusDiv);this._soeConnect=a.connect(G,"onExtentChange",this,this._syncOverviewMap);this._ufoConnect=a.connect(G,"onPan",this,this._updateFocus);this._oecConnect=
a.connect(I,"onExtentChange",this,this._ovwExtentChangeHandler);this._opaConnect=a.connect(I,"onPan",this,this._ovwPanHandler);this._ozsConnect=a.connect(I,"onZoomStart",this,function(){A.hide(this._focusDiv)});this._ozeConnect=a.connect(I,"onZoomEnd",this,function(){A.show(this._focusDiv)});this._omsConnect=a.connect(this._moveableHandle,"onMoveStop",this,this._moveStopHandler);this._syncOverviewMap(G.extent,null,null,null)},_deactivate:function(){a.disconnect(this._soeConnect);a.disconnect(this._ufoConnect);
a.disconnect(this._oecConnect);a.disconnect(this._opaConnect);a.disconnect(this._ozsConnect);a.disconnect(this._ozeConnect);a.disconnect(this._omsConnect);this._moveableHandle&&(this._moveableHandle.destroy(),this._moveableHandle=null)},_syncOverviewMap:function(G,I,L,K){this._suspendPanHandling?this._suspendPanHandling=!1:(this._focusExtent=G,this.overviewMap.setExtent(G.expand(this.expandFactor),!0))},_updateFocus:function(G){this._suspendPanHandling||(this._focusExtent=G,this._drawFocusDiv(G))},
_drawFocusDiv:function(G,I){var L=this.overviewMap,K=L.toScreen(new e(G.xmin,G.ymax,L.spatialReference)),ba=L.toScreen(new e(G.xmax,G.ymin,L.spatialReference));L=ba.x-K.x;ba=ba.y-K.y;var T=!0;L>this.overviewMap.width&&ba>this.overviewMap.height&&(T=!1);r.set(this._focusDiv,{left:K.x+(I?I.x:0)+"px",top:K.y+(I?I.y:0)+"px",width:L+"px",height:ba+"px",display:T?"block":"none"})},_moveStopHandler:function(G){var I=this._moveableHandle.node.style;G=this._focusExtent;var L=this.overviewMap;I=L.toMap(new b(parseInt(I.left,
10),parseInt(I.top,10)));var K=new e(G.xmin,G.ymax,L.spatialReference);this._focusExtent=G.offset(I.x-K.x,I.y-K.y);this._maximized?this._maximizeHandler():L.centerAt(this._focusExtent.getCenter());this._suspendPanHandling=!0;this.map.setExtent(this._focusExtent)},_ovwExtentChangeHandler:function(){this._drawFocusDiv(this._focusExtent)},_ovwPanHandler:function(G,I){this._drawFocusDiv(this._focusExtent,I)}});m.setObject("dijit.OverviewMap",F,l);return F})},"esri/dijit/TimeSlider":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/kernel dojo/has dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dom-geometry dijit/_Widget dijit/_Templated dijit/form/HorizontalSlider dijit/form/HorizontalRule dijit/form/HorizontalRuleLabels dojox/timing/_base dojox/form/RangeSlider dojo/text!dojox/form/resources/HorizontalRangeSlider.html ../kernel ../lang ../TimeExtent ./_EventedWidget dojo/text!./templates/TimeSlider.html dojo/i18n!../nls/jsapi".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l){z=F([u,f,d],{declaredClass:"esri.dijit.TimeSlider",widgetsInTemplate:!0,templateString:x,intermediateChanges:!1,_slideDuration:1E3,_defaultCount:10,_eventMap:{"time-extent-change":!0,play:!0,pause:!0,next:!0,previous:!0},constructor:function(v,A){m.mixin(this,l.widgets.timeSlider);this._iconClass="tsButton tsPlayButton";this.loop=this.playing=!1;this.thumbCount=1;this.thumbMovingRate=1E3;this._createTimeInstants=!1;this._options=m.mixin({excludeDataAtTrailingThumb:!1,
excludeDataAtLeadingThumb:!1},v.options||{})},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this._timer=new h.Timer;this._timer.setInterval(this.thumbMovingRate);this._timer.onTick=m.hitch(this,"_bumpSlider",1);this._createSlider()},destroy:function(){this._timer.stop();this.timeStops=this._timer=null;this._slider.destroy();this._slider=null;this._hTicks&&(this._hTicks.destroyRecursive(),this._hTicks=null);this._hLabels&&(this._hLabels.destroyRecursive(),
this._hLabels=null);this.inherited(arguments)},onTimeExtentChange:function(){},onPlay:function(){},onPause:function(){},onNext:function(){},onPrevious:function(){},_onHorizontalChange:function(){var v=this._sliderToTimeExtent();this.onTimeExtentChange(v)},_onPlay:function(){this.playing=!this.playing;this._updateUI();this.playing?(this._timer.start(),this.onPlay(this._sliderToTimeExtent())):(this._timer.stop(),this.onPause(this._sliderToTimeExtent()));var v=this._getSliderValue();this._offset=m.isArray(v)?
v[1]-v[0]:0},_onNext:function(){this.playing||(this._bumpSlider(1),this.onNext(this._sliderToTimeExtent()))},_onPrev:function(){this.playing||(this._bumpSlider(-1),this.onPrevious(this._sliderToTimeExtent()))},createTimeStopsByCount:function(v,A){v&&v.startTime&&v.endTime&&(A=A||this._defaultCount,this.createTimeStopsByTimeInterval(v,Math.ceil((v.endTime-v.startTime)/(A-1)),"esriTimeUnitsMilliseconds"))},createTimeStopsByTimeInterval:function(v,A,B,E){if(v&&v.startTime&&v.endTime){this.fullTimeExtent=
new C(v.startTime,v.endTime);E&&!0===E.resetStartTime&&this._resetStartTime(this.fullTimeExtent,B);this._timeIntervalUnits=B;E=this.fullTimeExtent.startTime;for(var G=[];E<=v.endTime;)G.push(E),E=v._getOffsettedDate(E,A,B);0<G.length&&G[G.length-1]<v.endTime&&G.push(E);this.setTimeStops(G)}},getCurrentTimeExtent:function(){return this._sliderToTimeExtent()},setTimeStops:function(v){this.timeStops=v||[];this._numTicks=this._numStops=this.timeStops.length;!1===t.isDefined(this.fullTimeExtent)&&(this.fullTimeExtent=
new C(v[0],v[v.length-1]))},setLoop:function(v){this.loop=v},setThumbCount:function(v){this.thumbCount=v;this.singleThumbAsTimeInstant(this._createTimeInstants);this._slider&&this._createSlider()},setThumbIndexes:function(v){this.thumbIndexes=m.clone(v)||[0,1];this._initializeThumbs()},setThumbMovingRate:function(v){this.thumbMovingRate=v;this._timer&&this._timer.setInterval(this.thumbMovingRate)},setLabels:function(v){this.labels=v;this._slider&&this._createSlider()},setTickCount:function(v){this._numTicks=
v;this._slider&&this._createSlider()},singleThumbAsTimeInstant:function(v){this._createTimeInstants=v&&1===this.thumbCount},next:function(){this._onNext()},pause:function(){this.playing=!1;this._updateUI();this._timer.stop()},play:function(){!0!==this.playing&&(this.playing=!1,this._onPlay())},previous:function(){this._onPrev()},_setIntermediateChangesAttr:function(v){this.intermediateChanges=!!v;this._slider&&this._slider.set("intermediateChanges",!!v)},_updateUI:function(){y.remove(this.playPauseBtn.iconNode,
this._iconClass);this._iconClass=this.playing?"tsButton tsPauseButton":"tsButton tsPlayButton";y.add(this.playPauseBtn.iconNode,this._iconClass);this.previousBtn.set("disabled",this.playing);this.nextBtn.set("disabled",this.playing)},_createSlider:function(){this._slider&&(this._slider.destroy(),this._slider=null);for(var v=this.domNode;v.parentNode&&!v.dir;)v=v.parentNode;v={onChange:m.hitch(this,"_onHorizontalChange"),showButtons:!1,discreteValues:this._numStops,slideDuration:this._slideDuration,
"class":"ts",dir:"ltr",intermediateChanges:this.intermediateChanges};this._ts=r.create("div",{},D.query(".tsTmp",this.domNode)[0],"first");this._timeSliderTicks=r.create("div",{},this._ts,"first");this._timeSliderLabels=r.create("div",{},this._ts);2===this.thumbCount?this._createRangeSlider(v):this._createSingleSlider(v);this.thumbIndexes=this.thumbIndexes||[0,1];this._createHorizRule();this._createLabels();!0===this._createTimeInstants&&D.query(".dijitSliderProgressBarH, .dijitSliderLeftBumper, .dijitSliderRightBumper",
this._ts).forEach(function(A){q.set(A,{background:"none"})});this._initializeThumbs();a.disconnect(this._onChangeConnect);this._onChangeConnect=a.connect(this._slider,"onChange",m.hitch(this,"_updateThumbIndexes"))},_createRangeSlider:function(v){this._isRangeSlider=!0;this._slider=new (F([e,g],{templateString:k}))(v,this._ts)},_createSingleSlider:function(v){this._isRangeSlider=!1;this._slider=new e(v,this._ts)},_createHorizRule:function(){this._hTicks&&(this._hTicks.destroyRecursive(),this._hTicks=
null);2>this._numTicks||(this._hTicks=new b({container:"topDecoration",ruleStyle:"","class":"tsTicks",count:this._numTicks},this._timeSliderTicks))},_createLabels:function(){this._hLabels&&(this._hLabels.destroyRecursive(),this._hLabels=null);this.labels&&0<this.labels.length&&(this._hLabels=new c({labels:this.labels,labelStyle:"","class":"tsLabels"},this._timeSliderLabels))},_initializeThumbs:function(){if(this._slider){this._offset=this._toSliderValue(this.thumbIndexes[1])||0;var v=this._toSliderValue(this.thumbIndexes[0]);
v=v>this._slider.maximum||v<this._slider.minimum?this._slider.minimum:v;if(!0===this._isRangeSlider){var A=this._toSliderValue(this.thumbIndexes[1]);A=A>this._slider.maximum||A<this._slider.minimum?this._slider.maximum:A;this._setSliderValue([v,A<v?v:A])}else this._setSliderValue(v);this._onHorizontalChange()}},_bumpSlider:function(v){var A=this._getSliderValue(),B=A,E=B,G=v;m.isArray(A)&&(E=A[0],B=A[1],G=[{change:v,useMaxValue:!0},{change:v,useMaxValue:!1}]);1E-10>Math.abs(E-this._slider.minimum)&&
0>v||1E-10>Math.abs(B-this._slider.maximum)&&0<v?this._timer.isRunning&&(this.loop?(this._timer.stop(),this._setSliderValue(this._getSliderMinValue()),v=this._sliderToTimeExtent(),this.onTimeExtentChange(v),this._timer.start(),this.playing=!0):this.pause()):this._slider._bumpValue(G)},_updateThumbIndexes:function(){var v=this._getSliderValue();m.isArray(v)?(this.thumbIndexes[0]=this._toSliderIndex(v[0]),this.thumbIndexes[1]=this._toSliderIndex(v[1])):this.thumbIndexes[0]=this._toSliderIndex(v)},_sliderToTimeExtent:function(){if(this.timeStops&&
0!==this.timeStops.length){var v=new C,A=this._getSliderValue();if(m.isArray(A)){if(A[0]>A[1]){var B=A[0];var E=A[1]}else E=A[0],B=A[1];v.startTime=new Date(this.timeStops[this._toSliderIndex(E)]);v.endTime=new Date(this.timeStops[this._toSliderIndex(B)]);this._adjustTimeExtent(v)}else v.startTime=!0===this._createTimeInstants?new Date(this.timeStops[this._toSliderIndex(A)]):new Date(this.fullTimeExtent.startTime),v.endTime=!0===this._createTimeInstants?v.startTime:new Date(this.timeStops[this._toSliderIndex(A)]);
return v}},_adjustTimeExtent:function(v){if((!1!==this._options.excludeDataAtTrailingThumb||!1!==this._options.excludeDataAtLeadingThumb)&&v.startTime.getTime()!==v.endTime.getTime()){if(this._options.excludeDataAtTrailingThumb){var A=v.startTime;A.setUTCSeconds(A.getUTCSeconds()+1)}this._options.excludeDataAtLeadingThumb&&(v=v.endTime,v.setUTCSeconds(v.getUTCSeconds()-1))}},_resetStartTime:function(v,A){switch(A){case "esriTimeUnitsSeconds":v.startTime.setUTCMilliseconds(0);break;case "esriTimeUnitsMinutes":v.startTime.setUTCSeconds(0,
0,0);break;case "esriTimeUnitsHours":v.startTime.setUTCMinutes(0,0,0);break;case "esriTimeUnitsDays":v.startTime.setUTCHours(0,0,0,0);break;case "esriTimeUnitsWeeks":v.startTime.setUTCDate(v.startTime.getUTCDate()-v.startTime.getUTCDay());break;case "esriTimeUnitsMonths":v.startTime.setUTCDate(1);v.startTime.setUTCHours(0,0,0,0);break;case "esriTimeUnitsDecades":v.startTime.setUTCFullYear(v.startTime.getUTCFullYear()-v.startTime.getUTCFullYear()%10);break;case "esriTimeUnitsCenturies":v.startTime.setUTCFullYear(v.startTime.getUTCFullYear()-
v.startTime.getUTCFullYear()%100)}},_getSliderMinValue:function(){return this._isRangeSlider?[this._slider.minimum,this._slider.minimum+this._offset]:this._slider.minimum},_toSliderIndex:function(v){v=Math.floor((v-this._slider.minimum)*this._numStops/(this._slider.maximum-this._slider.minimum));0>v&&(v=0);v>=this._numStops&&(v=this._numStops-1);return v},_toSliderValue:function(v){return v*(this._slider.maximum-this._slider.minimum)/(this._numStops-1)+this._slider.minimum},_getSliderValue:function(){return this._slider.get("value")},
_setSliderValue:function(v){this._slider._setValueAttr(v,!1,!1)}});m.setObject("dijit.TimeSlider",z,w);return z})},"esri/dijit/MultidimensionalSlider":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/on dojo/json dijit/form/VerticalSlider dojox/form/VerticalRangeSlider dijit/form/VerticalRule dijit/form/VerticalRuleLabels dijit/form/HorizontalSlider dojox/form/HorizontalRangeSlider dijit/form/HorizontalRule dijit/form/HorizontalRuleLabels dijit/_Widget dijit/_Templated dojox/timing/_base dojo/_base/array dojo/Deferred dojo/DeferredList ../layers/MosaicRule ../layers/DimensionalDefinition ../kernel ../lang ./_EventedWidget dojo/text!./templates/MultidimensionalSlider_vertical.html dojo/text!./templates/MultidimensionalSlider_horizontal.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style dojo/dom-geometry dojo/touch dojo/query dojo/dom-construct dojo/_base/sniff".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K,ba,T){var P={LAYOUT_VERTICAL:"vertical",LAYOUT_HORIZONTAL:"horizontal"};c=F([v,c,h],{declaredClass:"esri.dijit.MultidimensionalSlider",widgetsInTemplate:!0,templateString:A,nLabels:10,_thumbCount:1,useRanges:void 0,loop:!0,useLayersDimSlices:!0,prefetch:!0,prefetchedValues:{},showPlayButton:!0,prefetchFactor:2,_hasUnitConflict:!1,_update:!0,useDefaults:!1,playDirectionAscending:!0,unitSymbols:{meter:"m",pascal:"Pa"},_eventMap:{"dimension-value-change":!0,
play:!0,pause:!0,next:!0,previous:!0,change:!0,"dimension-array-create":!0},onChange:function(){},onPlay:function(){},onPause:function(){},onDimensionValueChange:function(){},_onPlay:function(){this.playing=!this.playing;this._updateUI();this.playing?(this._timer.start(),this.onPlay()):(this._timer.stop(),this.onPause())},constructor:function(J,N){F.safeMixin(this,J);this.playing=!1;this._iconClass="mdsButton mdsPlayButton";this.map&&this._getImageLayers();this.layout===P.LAYOUT_HORIZONTAL&&(this.templateString=
B);this.thumbMovingRate=this.thumbMovingRate||3E3;this._i18n=E;this.prefetchImgNodes={}},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);var J=this;this._getAllLayersMDInfo().then(function(){J._sortDimensionValues();J.dimensionValues=J.dimensionValues&&J.dimensionValues.length&&!J.useLayersDimSlices?J.dimensionValues:J._mapSortedDimensionValues;J.getUnit();J._setupSlider()});this._timer=new g.Timer;this._timer.setInterval(this.thumbMovingRate);this._timer.onTick=
m.hitch(this,function(){this.playDirectionAscending?this._bumpSlider(1):this._bumpSlider(-1)});this.layout===P.LAYOUT_VERTICAL&&(this.computeSliderStyle(),this.on("resize",m.hitch(this,"computeSliderStyle")));this._setupHandles()},_insertPassiveLabels:function(){var J=ba(".dijitSliderMoveable.dijitSliderMoveableV",this.domNode);this._passiveLbl1=T.create("div");G.add(this._passiveLbl1,"esriMdSliderPassiveLbl");T.place(this._passiveLbl1,J[0]);2===this._thumbCount&&(this._passiveLbl2=T.create("div"),
G.add(this._passiveLbl2,"esriMdSliderPassiveLbl"),T.place(this._passiveLbl2,J[1]))},_setupHandles:function(){this._eventHandles=[];this._eventHandles.push(D(this.domNode,"mouseover",m.hitch(this,"activateSlider")));this._eventHandles.push(D(this.domNode,"mouseleave",m.hitch(this,"deactivateSlider")));this._eventHandles.push(D(this.domNode,K.press,m.hitch(this,"activateSlider")));this._eventHandles.push(D(this.domNode,K.release,m.hitch(this,"deactivateSlider")));this._eventHandles.push(D(this.prevBtn.domNode,
K.press,m.hitch(this,"activateSlider")));this._eventHandles.push(D(this.playPauseBtn.domNode,K.press,m.hitch(this,"activateSlider")));this._eventHandles.push(D(this.nextBtn.domNode,K.press,m.hitch(this,"activateSlider")));var J=ba(".dijitSliderImageHandle.dijitSliderImageHandleV",this.domNode);k.forEach(J,function(N){this._eventHandles.push(D(N,K.press,m.hitch(this,"activateSlider")));this._eventHandles.push(D(N,K.release,m.hitch(this,"deactivateSlider")))},this)},_removeHandles:function(){k.forEach(this._eventHandles,
function(J){J&&J.remove()})},activateSlider:function(){9>a("ie")&&I.set(this.domNode,"background","#fff");this.sliderActive=!0;this.deactivateTimer&&clearTimeout(this.deactivateTimer);G.remove(this.domNode,"esriMdSliderPassive");G.add(this.domNode,"esriMdSliderActive");I.set(this._passiveLbl1,"display","none");this._passiveLbl2&&I.set(this._passiveLbl2,"display","none")},deactivateSlider:function(){if(!(10>a("ie"))){var J=this;this.deactivateTimer=setTimeout(function(){J.sliderActive=!1;J.updatePassiveLabels();
G.remove(J.domNode,"esriMdSliderActive");G.add(J.domNode,"esriMdSliderPassive");J._showPassiveLabels()},2500)}},updatePassiveLabels:function(){this._slider&&l.isDefined(this._slider.value)&&(this._passiveLbl1.innerHTML=this.value.length?this.value[0]:this.value,this._slider.value.length&&(this._passiveLbl2.innerHTML=this.value[1]),this.sliderActive||this._showPassiveLabels())},_showPassiveLabels:function(){l.isDefined(this.value)&&(I.set(this._passiveLbl1,"display","inline-block"),this.value.length?
I.set(this._passiveLbl2,"display","inline-block"):this._passiveLbl2&&I.set(this._passiveLbl2,"display","none"))},increment:function(){var J=1;!this.playDirectionAscending&&this.playing&&(J=-1);this._bumpSlider(J)},decrement:function(){var J=-1;!this.playDirectionAscending&&this.playing&&(J=1);this._bumpSlider(J)},_setDimensionAttr:function(J){this._slider&&(J.dimension&&(this.dimension=J.dimension),this.dimensionValues=J.dimensionValues&&J.dimensionValues.length?J.dimensionValues:[],this.update())},
update:function(){var J=this;this._mapSortedDimensionValues=[];this._getImageLayers();this.value=this.dimensionValues[this._slider.value];this._getAllLayersMDInfo().then(function(){J._sortDimensionValues();J.getUnit();J.dimensionValues&&J.dimensionValues.length&&!J.useLayersDimSlices||(J.dimensionValues=J._mapSortedDimensionValues);J._setupSlider()})},pause:function(){this.playing=!1;this._updateUI();this._timer.stop()},play:function(J){!0!==this.playing&&(this.playing=!1,this._onPlay())},_setupSlider:function(){this._destroySlider();
this.dimensionValues&&this.dimensionValues.length&&(this.sliderNode=document.createElement("div"),this._getDimensionAlias(),this._layers&&this._layers.length&&1===this._layers.length&&this._readMosaicRule(),this._createRule(),this._createLabels(),this._createSlider(),this._insertPassiveLabels(),this._slider.onChange(this._slider.value))},_createLabels:function(){this.layout===P.LAYOUT_HORIZONTAL?this._createHorizontalLabels():this._createVerticalLabels()},_createRule:function(){this.layout===P.LAYOUT_HORIZONTAL?
this._createHorizontalRule():this._createVerticalRule()},_createVerticalLabels:function(){this.labelsNode=document.createElement("div");this.sliderNode.appendChild(this.labelsNode);this._sliderLabels=new n({labels:this._filterLabels(),labelStyle:"font-size: 83%; padding-left: 5px;"},this.labelsNode)},_createVerticalRule:function(){this.rulesNode=document.createElement("div");this.sliderNode.appendChild(this.rulesNode);100>=this.dimensionValues.length&&(this._sliderRules=new q({count:this.dimensionValues.length,
style:"width:5px;"},this.rulesNode),this._sliderRules.startup())},_createHorizontalLabels:function(){this.labelsNode=document.createElement("div");this.sliderNode.appendChild(this.labelsNode);this._sliderLabels=new b({labels:this._filterLabels(),labelStyle:"font-size: 83%"},this.labelsNode)},_createHorizontalRule:function(){this.rulesNode=document.createElement("div");this.sliderNode.appendChild(this.rulesNode);100>=this.dimensionValues.length&&(this._sliderRules=new e({count:this.dimensionValues.length,
style:"height:5px;"},this.rulesNode),this._sliderRules.startup())},_createHorizontalSingleSlider:function(J){J=J?J:this.playDirectionAscending?0:this.dimensionValues.length-1;this._slider=new f({name:"horizontal",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:"width: 100%;",increment:m.hitch(this,"increment"),decrement:m.hitch(this,"decrement"),value:J||0,onChange:m.hitch(this,this._onSingleSliderChange),showButtons:!1},this.sliderNode);
this._slider.startup()},_createHorizontalRangeSlider:function(J){J=J?J:this.playDirectionAscending?[0,1]:[this.dimensionValues.length-2,this.dimensionValues.length-1];this._slider=new d({name:"horizontal",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:"width:100%;",increment:m.hitch(this,"increment"),decrement:m.hitch(this,"decrement"),value:J||[0,1],onChange:m.hitch(this,this._onRangeSliderChange),showButtons:!1},this.sliderNode);
this._slider.startup();D(this._slider.incrementButton,"click",this._slider.increment);D(this._slider.decrementButton,"click",this._slider.decrement);this._slider._typematicCallback=function(){}},_createVerticalSingleSlider:function(J){J=l.isDefined(J)?J:this.playDirectionAscending?0:this.dimensionValues.length-1;this._slider=new y({name:"vertical",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:this.computeSliderStyle(),increment:m.hitch(this,
"increment"),decrement:m.hitch(this,"decrement"),value:J||0,onChange:m.hitch(this,this._onSingleSliderChange),showButtons:!1},this.sliderNode);this._slider.startup()},_createVerticalRangeSlider:function(J){J=J?J:this.playDirectionAscending?[0,1]:[this.dimensionValues.length-2,this.dimensionValues.length-1];this._slider=new r({name:"vertical",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:this.computeSliderStyle(),increment:m.hitch(this,
"increment"),decrement:m.hitch(this,"decrement"),value:J||[0,1],onChange:m.hitch(this,this._onRangeSliderChange),showButtons:!1},this.sliderNode);this._slider.startup();this._slider._typematicCallback=function(){}},_onSingleSliderChange:function(J){var N=this.dimensionValues[J];this.setDimensionInfoText(N);k.forEach(this._layers,function(Z){this._updateMosaicRule(Z,N);this.prefetch&&this.playing&&"esri.layers.RasterXLayer"!==Z.declaredClass&&this._prefetchData(J,Z)},this);this._oldValue=J;this.value=
N;this.updatePassiveLabels();this.onChange(N)},_onRangeSliderChange:function(J){if(this._update){this._snap&&(J=this._snapToNearestRange(J));var N=[this.dimensionValues[J[1]],this.dimensionValues[J[0]]];N.sort(this._sortCompareFunction);this.value=N;this.setDimensionInfoText(N);this.updatePassiveLabels();k.forEach(this._layers,function(Z){this._updateMosaicRule(Z,N);this.prefetch&&this.playing&&this._prefetchData(J,Z)},this);this._update=!0;this._oldValue=m.clone(J);this.onChange(N)}},destroy:function(){this.inherited(arguments);
this._timer.stop();this._destroySlider();this._removeHandles()},_destroySlider:function(){if(this._slider)try{this._slider.destroy()}catch(J){this._slider.domNode&&T.destroy(this._slider.domNode)}finally{this._slider=null}},_createSlider:function(){this.mdSliderCell.appendChild(this.sliderNode);if(this.value&&this.value.length&&0<=k.indexOf(this.dimensionValues,this.value[0])&&0<=k.indexOf(this.dimensionValues,this.value[1]))var J=[k.indexOf(this.dimensionValues,this.value[0]),k.indexOf(this.dimensionValues,
this.value[1])];else if(l.isDefined(this.value)){var N=k.indexOf(this.dimensionValues,this.value);0<=N&&(J=N)}l.isDefined(J)||(J=this._getDefaultSliderValue());this.useDefaults&&l.isDefined(J)&&(J===this.dimensionValues.length-1||J.length&&0<=k.indexOf(J,this.dimensionValues.length-1))&&(this.playDirectionAscending=!1);2===this._thumbCount?this.layout===P.LAYOUT_HORIZONTAL?this._createHorizontalRangeSlider(J):this._createVerticalRangeSlider(J):this.layout===P.LAYOUT_HORIZONTAL?this._createHorizontalSingleSlider(J):
this._createVerticalSingleSlider(J)},_getDefaultSliderValue:function(){if(this.dimensionValues&&this.dimensionValues.length){var J=Infinity,N=1,Z;if(this.dimension&&"stdz"===this.dimension.toLowerCase())for(Z=0;Z<this.dimensionValues.length;Z++){var Y=this.dimensionValues[Z];var qa=Math.abs(Y-0);if(qa<J){J=qa;var V=Y}if(0===qa)break}else V=this.dimensionValues[0];V=k.indexOf(this.dimensionValues,V);V=0>V?0:V;2===this._thumbCount&&(V===this.dimensionValues.length-1&&(N=-1),V=[V,V+N]);return V}},_getMultidimensionalInfo:function(J){function N(){J.getMultidimensionalInfo().then(function(Y){J.multidimensionalInfo=
Y;Z.resolve(J)},function(Y){Z.reject(Y)})}var Z=new w;if(J.multidimensionalInfo)Z.resolve(J);else if(J.loaded)N();else J.on("load",function(){N()});return Z},_getAllLayersMDInfo:function(){var J=[];k.forEach(this._layers,function(N){J.push(this._getMultidimensionalInfo(N))},this);return new t(J)},_getImageLayers:function(){var J=this.map.layerIds.concat(this.map.graphicsLayerIds),N;this._layers=[];k.forEach(J,function(Z){N=this.map.getLayer(Z);"esri.layers.ArcGISImageServiceLayer"!==N.declaredClass&&
"esri.layers.ArcGISImageServiceVectorLayer"!==N.declaredClass&&"esri.layers.RasterLayer"!==N.declaredClass&&"esri.layers.WCSLayer"!==N.declaredClass&&"esri.layers.RasterXLayer"!==N.declaredClass||this._layers.push(N)},this);return this._layers},_sortCompareFunction:function(J,N){return l.isDefined(J)&&l.isDefined(N)?J-N:!1},_getDimensionObjects:function(){function J(Y){if(Y&&Y.values&&Y.hasRanges){var qa=[];k.forEach(Y.values,function(V){V.length?qa=N(qa,V):qa.push.apply(N(qa.sort(this._sortCompareFunction),
[V]))},this);qa=qa.sort(Z._sortCompareFunction);Y.decodedValues=qa}return Y}var N=this._merge,Z=this;this._allRangeValues=!0;this._thumbCount=1;this._snap=!1;this._dimensionObjects=[];this._layers=this._filterLayers();k.forEach(this._layers,function(Y){Y.multidimensionalInfo&&k.some(Y.multidimensionalInfo.variables,function(qa){k.some(qa.dimensions,function(V){V.name!==this.dimension||V.hasRanges||(this._allRangeValues=!1)},this)},this)},this);this.useRanges?(this._thumbCount=2,this._snap=!1):this._allRangeValues&&
this.useLayersDimSlices?(this._thumbCount=2,this._snap=!0):this._snap=!1;k.forEach(this._layers,function(Y){Y.multidimensionalInfo&&k.some(Y.multidimensionalInfo.variables,function(qa){k.some(qa.dimensions,function(V){V.name===this.dimension&&(this._allRangeValues&&V.hasRanges||this.useRanges?this._dimensionObjects.push(J(m.clone(V))):this._dimensionObjects.push(m.clone(V)))},this)},this)},this)},_merge:function(J,N){for(var Z=[],Y=0,qa=0;Y<J.length&&qa<N.length;)J[Y]<N[qa]?Z.push(J[Y++]):J[Y]>N[qa]?
Z.push(N[qa++]):(Z.push(N[qa++]),Y++);Z=Z.concat(J.slice(Y)).concat(N.slice(qa));return Z=k.filter(Z,function(V,na,ya){return ya.indexOf(V)===na})},_mergeRangeArrays:function(J,N){for(var Z=[],Y=0,qa=0;Y<J.length&&qa<N.length;)J[Y][0]<N[qa][0]||J[Y][0]===N[qa][0]&&J[Y][1]<N[qa][1]?Z.push(J[Y++]):J[Y][0]>N[qa][0]||J[Y][0]===N[qa][0]&&J[Y][1]>N[qa][1]?Z.push(N[qa++]):(Z.push(N[qa++]),Y++);Z=Z.concat(J.slice(Y)).concat(N.slice(qa));return Z=k.filter(Z,function(V,na,ya){return ya.indexOf(V)===na},this)},
_sortDimensionValues:function(){var J=0,N=this._merge,Z=this._mergeRangeArrays;this._getDimensionObjects();1<=this._dimensionObjects.length&&(this._mapSortedDimensionValues=this._dimensionObjects[0].decodedValues||this._dimensionObjects[0].values,this._allRangeValues&&(this._dimensionRangeValues=this._dimensionObjects[0].values));if(1<this._dimensionObjects.length)for(J=1;J<this._dimensionObjects.length;J++)this._mapSortedDimensionValues=N(this._mapSortedDimensionValues,this._dimensionObjects[J].decodedValues||
this._dimensionObjects[J].values),this._allRangeValues&&(this._dimensionRangeValues=Z(this._dimensionRangeValues,this._dimensionObjects[J].values))},_createDimensionalDefinition:function(J,N){var Z=[J];return new u({variableName:N,dimensionName:this.dimension,values:Z,isSlice:1===Z.length})},_updateMosaicRule:function(J,N){var Z=!1,Y=J.mosaicRule||J.defaultMosaicRule||new C({multidimensionalDefinition:[]}),qa="esri.layers.WCSLayer"===J.declaredClass,V="esri.layers.RasterXLayer"===J.declaredClass,
na=(qa?J.multidimensionalDefinition:Y.multidimensionalDefinition)||[];N.length&&N.sort(this._sortCompareFunction);k.forEach(na,function(ma){ma.dimensionName===this.dimension&&(ma.values=[N],ma.isSlice=!this.useRanges,Z=!0)},this);if(!Z){var ya="",S=k.filter(J.multidimensionalInfo.variables,function(ma){return k.some(na,function(ja){return ja.variableName&&ja.variableName.toLowerCase()===ma.name.toLowerCase()},this)},this);0===S.length&&(S=J.multidimensionalInfo.variables);k.some(S,function(ma){if(k.some(ma.dimensions,
function(ja){if(ja.name===this.dimension){if(qa||V)ya=ma.name;return!0}},this))return!0},this)&&(na.push(this._createDimensionalDefinition(N,ya)),Z=!0)}Z&&(qa&&J.setMultidimensionalDefinition(na),V?J.setMultiDimensionalDefinition(Y):(Y.multidimensionalDefinition=na,J.setMosaicRule(Y)))},_prefetchData:function(J,N){if(N&&(N.mosaicRule||N.multidimensionalDefinition)){var Z,Y,qa=!1,V,na=this,ya;this.prefetchedValues[N.id]||(this.prefetchedValues[N.id]=[]);this.prefetchImgNodes[N.id]=[];var S=m.clone(N._params);
var ma=(Y=m.clone(N.mosaicRule))&&Y.multidimensionalDefinition||m.clone(N.multidimensionalDefinition);for(Z=1;Z<=this.prefetchFactor;Z++)qa=!1,k.forEach(ma,function(ja){ja.dimensionName===this.dimension&&(this.playDirectionAscending?J.length?(this.snap?(V=this._getNextRangeIndex(J)||J,ja.values=[this.dimensionValues[V[0]],this.dimensionValues[V[1]]]):ja.values=[this.dimensionValues[(J[0]+Z)%this.dimensionValues.length],this.dimensionValues[(J[1]+Z)%this.dimensionValues.length]],ja.values.sort(this._sortCompareFunction)):
ja.values=[this.dimensionValues[(J+Z)%this.dimensionValues.length]]:J.length?(this.snap?(V=this._getNextRangeIndex(J,-1)||J,ja.values=[this.dimensionValues[V[0]],this.dimensionValues[V[1]]]):ja.values=[this.dimensionValues[(this.dimensionValues.length+J[0]-Z)%this.dimensionValues.length],this.dimensionValues[(this.dimensionValues.length+J[1]-Z)%this.dimensionValues.length]],ja.values.sort(this._sortCompareFunction)):ja.values=[this.dimensionValues[(this.dimensionValues.length+J-Z)%this.dimensionValues.length]],
k.some(this.prefetchedValues[N.id],function(X){if(z.stringify(X)===z.stringify(ja.values))return!0})||(qa=!0,this.prefetchedValues[N.id].push(ja.values)))},this),qa&&"esri.layers.WCSLayer"!==N.declaredClass&&(S.mosaicRule=z.stringify(Y.toJson()),N.getImageUrl(this.map.extent,this.map.width,this.map.height,function(ja){ya=new Image;na.prefetchImgNodes[N.id].push(ya);ya.src=ja},S))}},setDimensionInfoText:function(J){if(l.isDefined(J)){var N=this.unitSymbol||this.unit;if("number"!==typeof J){J=m.clone(J.sort(this._sortCompareFunction));
if(0!==J[0]%1||0!==J[1]%1)J[0]=parseFloat(J[0].toFixed(2)),J[1]=parseFloat(J[1].toFixed(2));J="["+J[0]+", "+J[1]+"]"}else 0!==J%1&&(J=J.toFixed(2));this.dimensionInfo.innerHTML=this.unitSymbol?"\x3clabel style\x3d'font-weight:700;'\x3e"+this.dimensionAlias+" ("+N+")\x3c/label\x3e":"\x3clabel style\x3d'font-weight:700;'\x3e"+this.dimensionAlias+"\x3c/label\x3e";this.dimensionInfo.innerHTML=this.layout===P.LAYOUT_HORIZONTAL?this.dimensionInfo.innerHTML+(": "+J):this.dimensionInfo.innerHTML+("\x3cbr/\x3e "+
J)}},setLabels:function(J){},_filterLabels:function(){if(this.nLabels&&this.dimensionValues&&this.dimensionValues.length){var J=Math.ceil(this.dimensionValues.length/this.nLabels);return k.map(this.dimensionValues,function(N,Z){return 0===Z%J||Z===this.dimensionValues.length-1?(0!==N%1&&(N=parseFloat(N.toFixed(2))),N):""},this)}},_filterLayers:function(){return k.filter(this._layers,function(J){if(J.multidimensionalInfo&&J.visible&&J.useMapDimensionValue&&k.some(J.multidimensionalInfo.variables,function(N){if(k.some(N.dimensions,
function(Z){if(Z.name===this.dimension)return!0},this))return!0},this))return!0},this)},_updateUI:function(){G.remove(this.playPauseBtn.iconNode,this._iconClass);this._iconClass=this.playing?"mdsButton mdsPauseButton":"mdsButton mdsPlayButton";G.add(this.playPauseBtn.iconNode,this._iconClass)},_bumpSlider:function(J){var N=this._slider.value;if(0<=J)!this._snap&&(0>N||N>=this.dimensionValues.length-1||N[0]>=this.dimensionValues.length-1||N[1]>=this.dimensionValues.length-1)?this._timer.isRunning&&
(this.loop?(this._timer.stop(),this.prefetchedValues={},this.prefetchImgNodes={},2===this._thumbCount?this._snap?this._slider.set("value",this._getNextRangeIndex(N)):this._slider.set("value",[0,Math.abs(N[0]-N[1])]):this._slider.set("value",0),this._timer.start(),this.playing=!0):this.pause()):2===this._thumbCount&&!this._snap&&N[0]<this.dimensionValues.length-1&&N[1]<this.dimensionValues.length-1?this._slider.set("value",[N[0]+1,N[1]+1]):1===this._thumbCount&&N<this.dimensionValues.length-1?this._slider.set("value",
N+1):this._snap&&this._slider.set("value",this._getNextRangeIndex(N));else if(0>=N||0>=N[0]||0>=N[1])this._timer.isRunning&&(this.loop?(this._timer.stop(),this.prefetchedValues={},2===this._thumbCount?this._snap?this._slider.set("value",this._getNextRangeIndex(N,-1)):this._slider.set("value",[this.dimensionValues.length-1,this.dimensionValues.length-1-Math.abs(N[0]-N[1])]):this._slider.set("value",this.dimensionValues.length-1),this._timer.start(),this.playing=!0):this.pause());else if(0<=N||0<=N[1])2===
this._thumbCount&&0<N[1]&&0<N[0]?this._snap?this._slider.set("value",this._getNextRangeIndex(N,-1)):this._slider.set("value",[N[0]-1,N[1]-1]):1===this._thumbCount&&0<N&&this._slider.set("value",N-1)},setThumbMovingRate:function(J){this.thumbMovingRate=J;this._timer&&this._timer.setInterval(this.thumbMovingRate)},getFullDimensionRange:function(J){J=J||this.dimension;var N,Z;k.forEach(this._layers,function(Y){Y.multidimensionalInfo&&Y.multidimensionalInfo.variables&&k.forEach(Y.multidimensionalInfo.variables,
function(qa){k.forEach(qa.dimensions,function(V){if(V.name===J&&V.extent&&V.extent.length&&1<V.extent.length){if(!l.isDefined(N)||V.extent[0]<N)N=V.extent[0];if(!l.isDefined(Z)||V.extent[1]>Z)Z=V.extent[1]}},this)},this)},this);return[N,Z]},setThumbCount:function(J){this._thumbCount=2==J?2:1;this.value=this.dimensionValues[this._slider.value];this._setupSlider()},clearDimensionalDefinition:function(J){var N=[];if(J&&J.mosaicRule&&J.mosaicRule.multidimensionalDefinition){var Z=J.mosaicRule;var Y=Z.multidimensionalDefinition;
k.forEach(Y,function(qa){qa.dimensionName!==this.dimension&&N.push(qa)},this);Z.multidimensionalDefinition=N;J.setMosaicRule(Z)}},getUnit:function(){var J=null,N=!1;this.unit=null;k.forEach(this._layers,function(Z){Z.multidimensionalInfo&&k.forEach(Z.multidimensionalInfo.variables,function(Y){k.forEach(Y.dimensions,function(qa){qa.name===this.dimension&&qa.unit&&(null!=J||N?l.isDefined(qa.unit)&&qa.unit.replace("esri","").toLowerCase()!==J.toLowerCase()&&(J=null,N=!0):J=qa.unit.replace("esri",""))},
this)},this)},this);J&&(J=J.replace("esri",""));this.unit=J;this.unitSymbol=this.getUnitSymbol();this._hasUnitConflict=N;return J},_getDimensionAlias:function(){this.dimensionAlias=this.dimension;k.some(this._layers,function(J){if(J.fields&&J.fields.length&&k.some(J.fields,function(N){if(N.name&&N.name===this.dimension&&N.alias)return this.dimensionAlias=N.alias,!0},this))return!0},this)},_readMosaicRule:function(){var J;k.forEach(this._layers,function(N){(N=N.mosaicRule&&N.mosaicRule.multidimensionalDefinition||
N.multidimensionalDefinition)&&k.forEach(N,function(Z){Z&&Z.dimensionName===this.dimension&&Z.values&&(J=Z.values.length&&Z.values[0]&&Z.values[0].length?Z.values[0]:Z.values)},this)},this);this.useRanges=l.isDefined(this.useRanges)?this.useRanges:J&&1!==J.length?!0:!1;J&&(this.useRanges?(this._thumbCount=2,this.value=1===J.length?[J[0],this.dimensionValues[this.dimensionValues.length-1]]:J):1<J.length&&this._snap?(this._thumbCount=2,this.value=J):(this._thumbCount=1,this.useRanges=!1,this.value=
J[0]))},hasUnitConflict:function(){this.getUnit();return this._hasUnitConflict},resizeSlider:function(J,N){I.set(this.domNode,{height:J+"px",width:N+"px"});I.set(this.mdSliderTable,{height:J+"px",width:N+"px"});this.computeSliderStyle()},computeSliderStyle:function(){var J=L.getContentBox(this.domNode).h-L.getContentBox(this.dimensionInfo).h-(L.getContentBox(this.playPauseBtnRow).h+20);10>=a("ie")&&(J-=53);var N="height: "+J+"px;";this._slider&&this._slider.domNode&&I.set(this._slider.domNode,"height",
J+"px");return N},getUnitSymbol:function(){if(!l.isDefined(this.unit))return null;var J=this.unit.toLowerCase();if("meters"===J||"meter"===J)return this.unitSymbols.meter;if("pascal"===J||"pascals"===J)return this.unitSymbols.pascal},_snapToNearestRange:function(J){if(J&&J.length&&this._snap){var N,Z,Y,qa=this;var V=[this.dimensionValues[J[1]],this.dimensionValues[J[0]]];V.sort(this._sortCompareFunction);if(k.some(this._dimensionObjects,function(ja){if(k.some(ja.values,function(X){if(X&&X.length&&
X[0]===V[0]&&X[1]===V[1])return!0}))return!0},this))return J;if(k.some(this._dimensionObjects,function(ja){if(k.some(ja.values,function(X){if(X&&X.length&&X[0]===V[0])return N=m.clone(X.sort(this._sortCompareFunction)),!0},this))return!0},this)){k.some(this.dimensionValues,function(ja,X){ja===N[0]&&(Z=X);ja===N[1]&&(Y=X)});var na=Math.abs(J[0]-Z);var ya=[Z,Y]}if(k.some(this._dimensionObjects,function(ja){if(k.some(ja.values,function(X){if(X&&X.length&&X[1]===V[1])return N=m.clone(X.sort(this._sortCompareFunction)),
!0},this))return!0},this)){k.some(this.dimensionValues,function(ja,X){ja===N[1]&&(Y=X);ja===N[0]&&(Z=X)});var S=Math.abs(J[1]-Y);var ma=[Z,Y]}J=na&&S?this._oldValue&&this._oldValue.length&&this._arraysEqual(this._oldValue,ya)?ma:this._oldValue&&this._oldValue.length&&this._arraysEqual(this._oldValue,ma)?ya:na<=S?ya:ma:ya||ma||J;this._update=!1;setTimeout(function(){qa._slider.set("value",J)},100);return J}},_arraysEqual:function(J,N){var Z;if(!l.isDefined(J)||!l.isDefined(N))return!1;if(J===N)return!0;
if(J.length!==N.length)return!1;J.sort(this._sortCompareFunction);N.sort(this._sortCompareFunction);for(Z=0;Z<J.length;++Z)if(J[Z]!==N[Z])return!1;return!0},_getNextRangeIndex:function(J,N){if(!this._dimensionRangeValues||!this._dimensionRangeValues.length)return null;var Z,Y,qa;N=l.isDefined(N)?N:1;k.some(this._dimensionRangeValues,function(na,ya){if(this._arraysEqual(na,[this.dimensionValues[J[0]],this.dimensionValues[J[1]]]))return Z=ya,!0},this);var V=this._dimensionRangeValues[0<N?(Z+1)%this._dimensionRangeValues.length:
(this._dimensionRangeValues.length+Z-1)%this._dimensionRangeValues.length];k.some(this.dimensionValues,function(na,ya){na===V[0]&&(Y=ya);na===V[1]&&(qa=ya);if(Y&&qa)return!0},this);return[Y,qa]}});m.mixin(c,P);m.setObject("dijit.MultidimensionalSlider",c,x);return c})},"dijit/form/VerticalRule":function(){define(["dojo/_base/declare","./HorizontalRule"],function(F,m){return F("dijit.form.VerticalRule",m,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerV"\x3e\x3c/div\x3e',_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkV" style\x3d"top:',
_isHorizontal:!1})})},"dijit/form/VerticalRuleLabels":function(){define(["dojo/_base/declare","./HorizontalRuleLabels"],function(F,m){return F("dijit.form.VerticalRuleLabels",m,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerV dijitRuleLabelsContainer dijitRuleLabelsContainerV"\x3e\x3c/div\x3e',_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerV" style\x3d"top:',_labelPrefix:'"\x3e\x3cspan class\x3d"dijitRuleLabel dijitRuleLabelV"\x3e',_calcPosition:function(a){return 100-
a},_isHorizontal:!1})})},"esri/dijit/BasemapGallery":function(){define("require dojo/_base/declare dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/_base/kernel dojo/_base/sniff dojo/has dojo/query dojo/Deferred dojo/DeferredList dojo/dom dojo/dom-construct dojo/dom-class dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ../request ../geometry/Extent ../SpatialReference ../virtualearth/VETiledLayer ../layers/OpenStreetMapLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/WebTiledLayer ../layers/VectorTileLayer ../layers/TileInfo ../layers/ArcGISImageServiceLayer ../layers/ImageServiceParameters ../layers/ImageParameters ../layers/RasterFunction ../layers/RasterXLayer ./Basemap ./_EventedWidget dojo/text!./templates/BasemapGallery.html".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l,v,A,B,E,G,I,L,K,ba,T,P,J,N,Z){m=m([N,h,g],{declaredClass:"esri.dijit.BasemapGallery",widgetsInTemplate:!0,templateString:Z,loaded:!1,basemaps:[],bingMapsKey:null,flowContainer:null,_hasUI:!1,_supportsVTL:null,_selectedBasemap:null,_selectBasemapInProgress:!1,_eventMap:{load:!0,"selection-change":!0,add:["basemap"],remove:["basemap"],error:["message"]},constructor:function(Y,qa){Y=Y||{};this.map=Y.map;this._hasUI=qa?!0:!1;this.bingMapsKey=Y.bingMapsKey&&
0<Y.bingMapsKey.length?Y.bingMapsKey:null;this.showArcGISBasemaps=!1!==Y.showArcGISBasemaps;this.basemaps=Y.basemaps||[];this.basemapIds=Y.basemapIds;this.referenceIds=Y.referenceIds;this.basemapsGroup=Y.basemapsGroup;this.arcgisUrl=k.dijit._arcgisUrl;Y.portalUrl&&(this.arcgisUrl=Y.portalUrl+"/sharing/rest");0>this.arcgisUrl.indexOf("://")?this.arcgisUrl=t.getProtocolForWebResource()+"//"+this.arcgisUrl:"https:"===window.location.protocol&&(this.arcgisUrl=this.arcgisUrl.replace("http:","https:"));
this.init()},init:function(){this.inherited(arguments);this._checkVTLSupport().then(z.hitch(this,function(Y){this._supportsVTL=Y}));a.forEach(this.basemaps,function(Y){Y.id&&0!==Y.id.length||(Y.id=this._getUniqueId());a.forEach(Y.layers,function(qa){qa.opacity=0<=qa.opacity?qa.opacity:1;qa.visibility=!0},this)},this);this.basemapIds&&0<this.basemapIds.length&&a.forEach(this.basemapIds,function(Y){this.map.getLayer(Y)._basemapGalleryLayerType="basemap"},this);this.referenceIds&&0<this.referenceIds.length&&
a.forEach(this.referenceIds,function(Y){Y=this.map.getLayer(Y);Y._basemapGalleryLayerType="reference";Y.attr("data-reference",!0)},this);this.basemapsGroup&&(this.basemapsGroup.owner&&this.basemapsGroup.title||this.basemapsGroup.id)?this._findCustomBasemapsGroup(z.hitch(this,"_handleArcGISBasemapsResponse")):this.showArcGISBasemaps?this._findArcGISBasemapsGroup(z.hitch(this,"_handleArcGISBasemapsResponse")):this._finishStartup()},startup:function(){this.loaded?this._refreshUI():D.connect(this,"onLoad",
z.hitch(this,function(){this._refreshUI()}))},select:function(Y){this._select(Y)},getSelected:function(){return this._selectedBasemap},get:function(Y){var qa;for(qa=0;qa<this.basemaps.length;qa++)if(this.basemaps[qa].id===Y)return this.basemaps[qa];return null},add:function(Y){return Y&&!Y.id?(Y.id=this._getUniqueId(),this.basemaps.push(Y),this._refreshUI(),this.onAdd(Y),!0):Y&&this._isUniqueId(Y.id)?(this.basemaps.push(Y),this._refreshUI(),this.onAdd(Y),!0):!1},remove:function(Y){var qa;for(qa=0;qa<
this.basemaps.length;qa++){var V=this.basemaps[qa];if(V.id===Y)return this._selectedBasemap&&this._selectedBasemap.id===V.id&&(this._selectedBasemap=null),this.basemaps.splice(qa,1),this._refreshUI(),this.onRemove(V),V}return null},onLoad:function(){},onSelectionChange:function(){},onAdd:function(Y){},onRemove:function(Y){},onError:function(Y){},_defaultBasemapGalleryGroupQuery:'title:"ArcGIS Online Basemaps" AND owner:esri',_basemapGalleryGroupQuery:null,_finishStartup:function(){this.loaded=!0;
this.onLoad();0===this.map.layerIds.length&&0<this.basemaps.length&&!this._selectBasemapInProgress&&this._select(this.basemaps[0].id)},_findCustomBasemapsGroup:function(Y){this.basemapsGroup&&this.basemapsGroup.id?this._findArcGISBasemaps(this.basemapsGroup.id,Y):(this._basemapGalleryGroupQuery='title:"'+this.basemapsGroup.title+'" AND owner:'+this.basemapsGroup.owner,this._findArcGISBasemapsGroup(Y))},_findArcGISBasemapsGroup:function(Y){if(this._basemapGalleryGroupQuery)this._findArcGISBasemapsGroupContent(Y);
else{var qa=this.arcgisUrl+"/portals/self",V={f:"json"};V.culture=y.locale;C({url:qa,content:V,callbackParamName:"callback",load:z.hitch(this,function(na,ya){na&&na.useVectorBasemaps&&na.vectorBasemapGalleryGroupQuery?this._checkVTLSupport().then(z.hitch(this,function(S){this._basemapGalleryGroupQuery=S?na.vectorBasemapGalleryGroupQuery:na&&na.basemapGalleryGroupQuery?na.basemapGalleryGroupQuery:this._defaultBasemapGalleryGroupQuery;this._findArcGISBasemapsGroupContent(Y)})):(this._basemapGalleryGroupQuery=
na&&na.basemapGalleryGroupQuery?na.basemapGalleryGroupQuery:this._defaultBasemapGalleryGroupQuery,this._findArcGISBasemapsGroupContent(Y))}),error:z.hitch(this,function(na,ya){this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery})})}},_findArcGISBasemapsGroupContent:function(Y){var qa=z.hitch(this,"_findArcGISBasemaps"),V=this.arcgisUrl+"/community/groups",na={};na.q=this._basemapGalleryGroupQuery;na.f="json";C({url:V,content:na,callbackParamName:"callback",load:z.hitch(this,function(ya,
S){if(0<ya.results.length)qa(ya.results[0].id,Y,ya.results[0].sortField,ya.results[0].sortOrder);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:z.hitch(this,function(ya){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})},_findArcGISBasemaps:function(Y,qa,V,na){var ya=z.hitch(this,function(S,ma,ja,X){var oa=this.arcgisUrl+"/search",xa={};xa.q="group:"+S+' AND type:"web map" NOT type:"web mapping application"';xa.sortField=
ja;xa.sortOrder="asc"===X?"desc":"asc";xa.num=100;xa.f="json";C({url:oa,content:xa,callbackParamName:"callback",load:z.hitch(this,function(Ha,Ia){if(0<Ha.results.length)ma(Ha.results);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:z.hitch(this,function(Ha,Ia){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})});V&&na?ya(Y,qa,V,na):C({url:this.arcgisUrl+"/community/groups/"+Y,content:{f:"json"},callbackParamName:"callback",
load:z.hitch(this,function(S,ma){S.sortField?ya(Y,qa,S.sortField,S.sortOrder):ya(Y,qa,"name","desc")}),error:z.hitch(this,function(S,ma){ya(Y,qa,"name","desc")})})},_handleArcGISBasemapsResponse:function(Y){0<Y.length&&(a.forEach(Y,function(qa,V){if(this.bingMapsKey||!this.bingMapsKey&&qa.title&&-1===qa.title.indexOf("Bing Maps")){var na={};na.id=this._getUniqueId();na.title=qa.title;na.thumbnailUrl="";if(qa.thumbnail&&qa.thumbnail.length&&(na.thumbnailUrl=this.arcgisUrl+"/content/items/"+qa.id+"/info/"+
qa.thumbnail,k.id)){var ya=k.id.findCredential(t.urlToObject(this.arcgisUrl).path);ya&&(na.thumbnailUrl+="?token\x3d"+ya.token)}na.itemId=qa.id;na=new J(na,this);this.basemaps.splice(0,0,na)}},this),this._finishStartup())},_refreshUI:function(){this._hasUI&&(b.empty(this.flowContainer),a.forEach(this.basemaps,function(Y,qa){Y.id||(Y.id="basemap_"+qa);this.flowContainer.appendChild(this._buildNodeLayout(Y))},this),b.create("br",{style:{clear:"both"}},this.flowContainer),this._markSelected(this._selectedBasemap))},
_buildNodeLayout:function(Y){var qa=b.create("div",{id:"galleryNode_"+Y.id,"class":"esriBasemapGalleryNode"}),V=b.create("a",{href:"javascript:void(0);"},qa);D.connect(V,"onclick",z.hitch(this,"_onNodeClick",Y));var na=Y.title||"";Y.thumbnailUrl?b.create("img",{"class":"esriBasemapGalleryThumbnail",src:Y.thumbnailUrl,title:na,alt:na},V):b.create("img",{"class":"esriBasemapGalleryThumbnail",src:F.toUrl("./images/transparent.gif"),title:na,alt:na},V);Y=b.create("div",{"class":"esriBasemapGalleryLabelContainer"},
qa);b.create("span",{innerHTML:na,alt:na,title:na},Y);return qa},_onNodeClick:function(Y,qa){qa.preventDefault();this._markSelected(Y);this.select(Y.id)},_markSelected:function(Y){Y&&(a.forEach(y.query(".esriBasemapGallerySelectedNode",this.domNode),function(qa){c.remove(qa,"esriBasemapGallerySelectedNode")}),(Y=e.byId("galleryNode_"+Y.id))&&c.add(Y,"esriBasemapGallerySelectedNode"))},_select:function(Y){this._selectBasemapInProgress=!0;var qa=this.get(Y);qa?(qa.layers?this._getServiceInfos(qa):(Y=
qa.getLayers(this.arcgisUrl),z.isArray(Y)?this._getServiceInfos(qa):Y.addCallback(z.hitch(this,function(V){this._getServiceInfos(qa)}))),this._markSelected(qa)):this._selectBasemapInProgress=!1},_getServiceInfos:function(Y){"https:"===location.protocol&&a.forEach(Y.layers,function(V){if(this._isAgolService(V.url)||this._isHostedService(V.url))V.url=V.url.replace("http:","https:")},this);this._selectedBasemap=Y;var qa=[];a.forEach(Y.layers,function(V){V.url&&0<V.url.length&&!V.isReference&&!V.type&&
(V.deferredsPos=qa.length,qa.push(this._getServiceInfo(V.url)))},this);0<qa.length?(new d(qa)).addCallback(z.hitch(this,function(V){var na=null;a.forEach(Y.layers,function(ya){if(0===ya.deferredsPos||ya.deferredsPos){ya.serviceInfoResponse=V[ya.deferredsPos][1];var S=ya.serviceInfoResponse.fullExtent;S||(S=ya.serviceInfoResponse.extent);na=na?na.union(new u(S)):new u(S)}},this);this.map.extent&&5>this._getIntersectionPercent(na,this.map.extent)&&this.map.setExtent(na,!0);this._switchBasemapLayers(Y);
this._updateReferenceLayer(Y)})):(this._switchBasemapLayers(Y),this._updateReferenceLayer(Y))},_checkVTLSupport:function(){var Y=new f;r("ie")?Y.resolve(!1):Y.resolve(G.supported());return Y},_switchBasemapLayers:function(Y){var qa=Y.layers,V=!1,na,ya,S;a.forEach(qa,function(ja){"VectorTileLayer"===ja.type&&(V=!0)});if(V&&!0!==this._supportsVTL)this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because layer type is not supported by your current browser version.");else if(0<this.map.layerIds.length&&
0===this.map.getNumLevels()&&("OpenStreetMap"===qa[0].type||qa[0].type&&-1<qa[0].type.indexOf("BingMaps")||"WebTiledLayer"===qa[0].type||"VectorTileLayer"===qa[0].type))this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");else{a.forEach(qa,function(ja){if(!ja.isReference&&ja.type&&-1<ja.type.indexOf("BingMaps")&&!this.bingMapsKey)this.onError("esri.dijit.BasemapGallery: Invalid Bing Maps key.")},this);var ma=
0;a.forEach(qa,function(ja,X){if(!ja.isReference){if("OpenStreetMap"===ja.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");return}var oa=new v({id:"layer_osm",opacity:ja.opacity})}else if(ja.type&&-1<ja.type.indexOf("BingMaps")){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");
return}oa=l.MAP_STYLE_AERIAL_WITH_LABELS;"BingMapsAerial"===ja.type?oa=l.MAP_STYLE_AERIAL:"BingMapsRoad"===ja.type&&(oa=l.MAP_STYLE_ROAD);oa=new l({id:"layer_bing",bingMapsKey:this.bingMapsKey,mapStyle:oa,opacity:ja.opacity})}else if("WebTiledLayer"===ja.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");return}oa=ja.initialExtent||ja.fullExtent;
oa=new E(ja.templateUrl||ja.url,{visible:ja.visibility,opacity:ja.opacity,copyright:ja.copyright,fullExtent:ja.fullExtent&&new u(ja.fullExtent),initialExtent:oa&&new u(oa),subDomains:ja.subDomains,tileInfo:ja.tileInfo?new I(ja.tileInfo):null,tileServers:ja.tileServers})}else if("VectorTileLayer"===ja.type){oa=new G(ja.styleUrl,{visible:ja.visibility,opacity:ja.opacity});0===X&&1<qa.length&&this._removeBasemapLayers();var xa=this;D.connect(oa,"onLoad",z.hitch(this,function(Ha,Ia,ia){var ea=xa._sameSpatialReference(ia.spatialReference,
xa.map.spatialReference);if(xa.map.spatialReference&&!ea)xa.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.");else{if(0<xa.map.getNumLevels()){if(ea=xa._sameTilingScheme(ia.tileInfo,xa.map.__tileInfo),!ea){xa.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");return}}else if(xa.map.loaded){xa.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a vector tile layer and cannot be loaded as a dynamic layer.");
return}0===Ia&&1===qa.length&&xa._removeBasemapLayers();ia._basemapGalleryLayerType="basemap";xa.map.addLayer(ia,Ha)}},ma,X))}else if(ja.serviceInfoResponse&&ja.serviceInfoResponse.mapName){na=new x(ja.serviceInfoResponse.spatialReference);ya=this._sameSpatialReference(na,this.map.spatialReference);if(this.map.spatialReference&&!ya){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.");return}if(!0===ja.serviceInfoResponse.singleFusedMapCache&&
0<this.map.getNumLevels()){if(S=this._sameTilingScheme(ja.serviceInfoResponse.tileInfo,this.map.__tileInfo),!S){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");return}}else if(!0===ja.serviceInfoResponse.singleFusedMapCache&&-1<ja.serviceInfoResponse.capabilities.toLowerCase().indexOf("tilesonly")&&this.map.loaded&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");
return}oa=(0===this.map.layerIds.length||0<this.map.getNumLevels())&&!0===ja.serviceInfoResponse.singleFusedMapCache?this._loadAsCached(ja):this._loadAsDynamic(ja)}else if(ja.serviceInfoResponse&&ja.serviceInfoResponse.pixelSizeX){na=new x(ja.serviceInfoResponse.spatialReference);ya=this._sameSpatialReference(na,this.map.spatialReference);if(this.map.spatialReference&&!ya){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.");return}if(!0===
ja.serviceInfoResponse.singleFusedMapCache&&0<this.map.getNumLevels()&&(S=this._sameTilingScheme(ja.serviceInfoResponse.tileInfo,this.map.__tileInfo),!S)){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");return}ja.serviceInfoResponse.singleFusedMapCache&&"ArcGISImageServiceLayer"!==ja.type?oa="Raster"===ja.serviceInfoResponse.cacheType?new P(ja.url,{serviceInfo:ja.serviceInfoResponse,opacity:ja.opacity,visible:ja.visibility,bandIds:ja.bandIds&&
0<ja.bandIds.length?ja.bandIds:null}):new A(ja.url,{resourceInfo:ja.serviceInfoResponse,opacity:ja.opacity,visible:ja.visibility}):ja.serviceInfoResponse.pixelSizeX?(oa=new K,oa.bandIds=ja.bandIds,ja.renderingRule?oa.renderingRule=new T(ja.renderingRule):!ja.bandIds&&ja.serviceInfoResponse.bandCount&&3<parseInt(ja.serviceInfoResponse.bandCount,10)&&(oa.bandIds=[0,1,2]),oa=new L(ja.url,{resourceInfo:ja.serviceInfoResponse,opacity:ja.opacity,visible:ja.visibility,imageServiceParameters:oa})):(oa=new ba,
oa.format="png24",ja.serviceInfoResponse.supportedImageFormatTypes&&-1<ja.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(oa.format="png32"),oa=new B(ja.url,{resourceInfo:ja.serviceInfoResponse,opacity:ja.opacity,visible:ja.visibility,imageParameters:oa}))}"VectorTileLayer"===ja.type?ma++:oa&&(0===X&&this._removeBasemapLayers(),oa._basemapGalleryLayerType="basemap",this.map.addLayer(oa,ma),ma++)}},this);this._selectBasemapInProgress=!1;this.onSelectionChange()}},_removeBasemapLayers:function(){var Y=
this.map.layerIds,qa=[];a.forEach(Y,function(V){V=this.map.getLayer(V);"basemap"===V._basemapGalleryLayerType&&qa.push(V)},this);0===qa.length&&0<Y.length&&qa.push(this.map.getLayer(Y[0]));0<qa.length&&a.forEach(qa,function(V){this.map.removeLayer(V)},this)},_updateReferenceLayer:function(Y){var qa;this._removeReferenceLayer();for(qa=0;qa<Y.layers.length;qa++)!0===Y.layers[qa].isReference&&this._addReferenceLayer(Y.layers[qa])},_removeReferenceLayer:function(){var Y;for(Y=this.map.layerIds.length-
1;0<=Y;Y--){var qa=this.map.getLayer(this.map.layerIds[Y]);"reference"===qa._basemapGalleryLayerType&&this.map.removeLayer(qa)}},_addReferenceLayer:function(Y){"VectorTileLayer"===Y.type?this._handleReferenceServiceInfoResponse(Y):this._getServiceInfo(Y.url,z.hitch(this,"_handleReferenceServiceInfoResponse",Y))},_handleReferenceServiceInfoResponse:function(Y,qa,V){Y.serviceInfoResponse=qa;if("VectorTileLayer"===Y.type)var na=new G(Y.styleUrl,{visible:Y.visibility,opacity:Y.opacity});else qa&&qa.mapName?
na=!0===qa.singleFusedMapCache?this._loadAsCached(Y):this._loadAsDynamic(Y):qa&&qa.pixelSizeX&&(Y.serviceInfoResponse.singleFusedMapCache?na=new A(Y.url,{resourceInfo:Y.serviceInfoResponse,opacity:Y.opacity,visible:Y.visibility}):Y.serviceInfoResponse.pixelSizeX?(V=new K,V.bandIds=Y.bandIds,Y.renderingRule?V.renderingRule=new T(Y.renderingRule):!Y.bandIds&&qa.bandCount&&3<parseInt(qa.bandCount,10)&&(V.bandIds=[0,1,2]),na=new L(Y.url,{resourceInfo:qa,opacity:Y.opacity,visible:Y.visibility,imageServiceParameters:V})):
(qa=new ba,qa.format="png24",Y.serviceInfoResponse.supportedImageFormatTypes&&-1<Y.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(qa.format="png32"),qa.transparent=!0,na=new B(Y.url,{resourceInfo:Y.serviceInfoResponse,opacity:Y.opacity,visible:Y.visibility,imageParameters:qa})));na&&(na._basemapGalleryLayerType="reference",na.attr("data-reference",!0),this.map.addLayer(na))},_getServiceInfo:function(Y,qa){return C({url:Y,content:{f:"json"},callbackParamName:"callback",load:function(V,
na){qa&&qa(V,na)},error:z.hitch(this,function(V,na){this.onError("esri.dijit.BasemapGallery: service not accessible.")})})},_loadAsCached:function(Y){var qa=[];Y.displayLevels||(qa=a.map(Y.serviceInfoResponse.tileInfo.lods,function(na){return na.level}));var V=null;Y.exclusionAreas&&Y.exclusionAreas.length&&(V=[],a.forEach(Y.exclusionAreas,function(na){V.push({minZoom:na.minZoom,maxZoom:na.maxZoom,minScale:na.minScale,maxScale:na.maxScale,geometry:new u(na.geometry)})}));return new A(Y.url,{resourceInfo:Y.serviceInfoResponse,
opacity:Y.opacity,visible:Y.visibility,exclusionAreas:V,displayLevels:Y.displayLevels||qa})},_loadAsDynamic:function(Y){var qa=new B(Y.url,{resourceInfo:Y.serviceInfoResponse,opacity:Y.opacity,visible:Y.visibility});Y.visibleLayers&&qa.setVisibleLayers(Y.visibleLayers);return qa},_getIntersectionPercent:function(Y,qa){var V=qa.intersects(Y);if(V){V=V.getWidth()*V.getHeight();var na=qa.getWidth()*qa.getHeight();return V/na*100}return 0},_getIds:function(){var Y=[];a.forEach(this.basemaps,function(qa){Y.push(qa.id)},
this);return Y},_getUniqueId:function(){for(var Y=","+this._getIds().toString()+",",qa=0;;)if(-1<Y.indexOf(",basemap_"+qa+","))qa++;else return"basemap_"+qa},_isUniqueId:function(Y){return-1===(","+this._getIds().toString()+",").indexOf(","+Y+",")?!0:!1},_isAgolService:function(Y){return Y?-1!==Y.indexOf("/services.arcgisonline.com/")||-1!==Y.indexOf("/server.arcgisonline.com/"):!1},_isHostedService:function(Y){return Y?-1!==Y.indexOf(".arcgis.com/"):!1},_sameSpatialReference:function(Y,qa){return Y&&
qa&&Y.wkt==qa.wkt&&(Y.wkid===qa.wkid||w.isDefined(Y.latestWkid)&&Y.latestWkid===qa.wkid||w.isDefined(qa.latestWkid)&&Y.wkid===qa.latestWkid||w.isDefined(Y.latestWkid)&&Y.latestWkid===qa.latestWkid)||Y&&qa&&Y.isWebMercator()&&qa.isWebMercator()?!0:!1},_sameTilingScheme:function(Y,qa){var V=this.map;V=V.width>V.height?V.width:V.height;var na=!1,ya=!1,S,ma;for(S=0;S<Y.lods.length;S++){var ja=Y.lods[S].scale;Y.dpi!==qa.dpi&&(ja=Y.lods[S].scale/Y.dpi);for(ma=0;ma<qa.lods.length;ma++){var X=qa.lods[ma].scale;
Y.dpi!==qa.dpi&&(X=qa.lods[ma].scale/qa.dpi);if(Math.abs(X-ja)/X<1/V)if(na){ya=!0;break}else na=!0;if(X<ja)break}if(ya)break}return ya||na&&(1===Y.lods.length||1===qa.lods.length)?!0:!1}});z.setObject("dijit.BasemapGallery",m,k);return m})},"esri/dijit/Basemap":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../request ./BasemapLayer".split(" "),function(F,m,a,D,z,y,r){F=F(null,{declaredClass:"esri.dijit.Basemap",id:null,title:"",thumbnailUrl:null,layers:null,
itemId:null,basemapGallery:null,constructor:function(q,n){q=q||{};this.id=q.id;this.itemId=q.itemId;this.layers=q.layers;this.title=q.title||"";this.thumbnailUrl=q.thumbnailUrl;this.basemapGallery=n},getLayers:function(q){if(this.layers)return this.layers;if(this.itemId)return q=y({url:(q||z.dijit._arcgisUrl)+"/content/items/"+this.itemId+"/data",content:{f:"json"},callbackParamName:"callback",error:a.hitch(this,function(n,f){if(this.basemapGallery)this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item.")})}),
q.addCallback(a.hitch(this,function(n,f){if(n.baseMap)return this.layers=[],m.forEach(n.baseMap.baseMapLayers,function(d){this.layers.push(new r(d))},this),this.layers;if(this.basemapGallery)this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item.");return[]})),q}});a.setObject("dijit.Basemap",F,z);return F})},"esri/dijit/BasemapLayer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(F,m,a,D){F=F(null,{declaredClass:"esri.dijit.BasemapLayer",
constructor:function(z){z=z||{};this.url=z.url;this.type=z.type;this.isReference=!0===z.isReference?!0:!1;this.opacity=z.opacity;this.visibleLayers=z.visibleLayers;this.displayLevels=z.displayLevels;this.exclusionAreas=z.exclusionAreas;this.bandIds=z.bandIds;this.renderingRule=z.renderingRule;this.templateUrl=z.templateUrl;this.copyright=z.copyright;this.subDomains=z.subDomains;this.fullExtent=z.fullExtent;this.initialExtent=z.initialExtent;this.tileInfo=z.tileInfo;this.tileServers=z.tileServers;
this.styleUrl=z.styleUrl}});m.setObject("dijit.BasemapLayer",F,D);return F})},"esri/dijit/HomeButton":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/text!./templates/HomeButton.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style".split(" "),function(F,m,a,D,z,y,r,q,n,f,d,e,b,c){F=m("esri.dijit.HomeButton",[y,q,F],{templateString:d,options:{theme:"HomeButton",map:null,extent:null,
fit:!1,visible:!0},constructor:function(h,g){var k=a.mixin({},this.options,h);this.domNode=g;this._i18n=e;this.set("map",k.map);this.set("theme",k.theme);this.set("visible",k.visible);this.set("extent",k.extent);this.set("fit",k.fit);this.watch("theme",this._updateThemeWatch);this.watch("visible",this._visible);this._css={container:"homeContainer",home:"home",loading:"loading"}},postCreate:function(){this.inherited(arguments);this.own(n(this._homeNode,r,a.hitch(this,this.home)))},startup:function(){this.inherited(arguments);
this.map||this.destroy();if(this.map.loaded)this._init();else n.once(this.map,"load",a.hitch(this,function(){this._init()}))},destroy:function(){this.inherited(arguments)},home:function(){var h=new f,g=this.get("extent");this._showLoading();var k={extent:g};g?this.map.extent!==g?this.map.setExtent(g,this.get("fit")).then(a.hitch(this,function(){this._hideLoading();this.emit("home",k);h.resolve(k)}),a.hitch(this,function(w){w||(w=Error("HomeButton::Error setting map extent"));k.error=w;this.emit("home",
k);h.reject(w)})):(this._hideLoading(),this.emit("home",k),h.resolve(k)):(this._hideLoading(),g=Error("HomeButton::home extent is undefined"),k.error=g,this.emit("home",k),h.reject(g));return h.promise},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_init:function(){this._visible();this.get("extent")||this.set("extent",this.map.extent);this.set("loaded",!0);this.emit("load",{})},_showLoading:function(){b.add(this._homeNode,this._css.loading)},_hideLoading:function(){b.remove(this._homeNode,
this._css.loading)},_updateThemeWatch:function(h,g,k){b.remove(this.domNode,g);b.add(this.domNode,k)},_visible:function(){this.get("visible")?c.set(this.domNode,"display","block"):c.set(this.domNode,"display","none")}});a.setObject("dijit.HomeButton",F,z);return F})},"esri/dijit/LocateButton":function(){define("require dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/text!./templates/LocateButton.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style dojo/dom-attr ../geometry/webMercatorUtils ../geometry/Point ../SpatialReference ../graphic ../symbols/PictureMarkerSymbol ../tasks/ProjectParameters".split(" "),
function(F,m,a,D,z,y,r,q,n,f,d,e,b,c,h,g,k,w,t,C,u,x,l){F=a("esri.dijit.LocateButton",[q,f,m],{templateString:b,options:{theme:"LocateButton",map:null,visible:!0,highlightLocation:!0,symbol:new x(F.toUrl("./images/sdk_gps_location.png"),28,28),infoTemplate:null,scale:null,useTracking:!1,clearOnTrackingStop:!1,setScale:!0,centerAt:!0,timeout:15E3,graphicsLayer:null,geolocationOptions:{maximumAge:0,timeout:15E3,enableHighAccuracy:!0}},constructor:function(v,A){var B=D.mixin({},this.options,v);this.domNode=
A;this._i18n=c;var E=navigator.geolocation,G=window.hasOwnProperty("isSecureContext");(G&&window.isSecureContext||!G&&"https:"===window.location.protocol)&&E||(B.visible=!1);this.set("map",B.map);this.set("theme",B.theme);this.set("visible",B.visible);this.set("scale",B.scale);this.set("highlightLocation",B.highlightLocation);this.set("symbol",B.symbol);this.set("infoTemplate",B.infoTemplate);this.set("geolocationOptions",B.geolocationOptions);this.set("useTracking",B.useTracking);this.set("setScale",
B.setScale);this.set("centerAt",B.centerAt);this.set("timeout",B.timeout);this.set("graphicsLayer",B.graphicsLayer);this.set("clearOnTrackingStop",B.clearOnTrackingStop);this.watch("theme",this._updateThemeWatch);this.watch("visible",this._visible);this.watch("tracking",this._locate);this.watch("useTracking",D.hitch(this,function(){this.get("tracking")&&!this.get("useTracking")&&this._stopTracking();this._setTitle()}));this._css={container:"locateContainer",locate:"zoomLocateButton",loading:"loading",
tracking:"tracking"}},postCreate:function(){this.inherited(arguments);this.own(d(this._locateNode,n,D.hitch(this,this.locate)))},startup:function(){this.inherited(arguments);this.get("map")||this.set("visible",!1);if(this.get("map").loaded)this._init();else d.once(this.get("map"),"load",D.hitch(this,function(){this._init()}))},destroy:function(){this.clear();this._graphicsEvent&&this._graphicsEvent.remove();this._removeWatchPosition();this.inherited(arguments)},clear:function(){var v=this.get("highlightGraphic"),
A=this.get("graphicsLayer");v&&(A?A.remove(v):this.get("map").graphics.remove(v),this.set("highlightGraphic",null))},locate:function(){this.get("useTracking")&&this.set("tracking",!this.get("tracking"));return this._locate()},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_setTitle:function(){this.get("useTracking")?this.get("tracking")?k.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.stopTracking):k.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.tracking):
k.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.title)},_removeWatchPosition:function(){this.get("watchId")&&(navigator.geolocation.clearWatch(this.get("watchId")),this.set("watchId",null));this._removePrivateVars()},_stopTracking:function(){h.remove(this._locateNode,this._css.tracking);this._removeWatchPosition();this.get("clearOnTrackingStop")&&this.clear();this._hideLoading()},_positionToObject:function(v){return v?{coords:D.mixin({},v.coords),timestamp:v.timestamp}:{}},_startTracking:function(){h.add(this._locateNode,
this._css.tracking);this._removeWatchPosition();var v=navigator.geolocation.watchPosition(D.hitch(this,function(A){A=this._positionToObject(A);this._setPosition(A).then(D.hitch(this,function(B){this._locateEvent(B)}),D.hitch(this,function(B){B||(B=Error("LocateButton::Error setting the position."));this._locateError(B)}))}),D.hitch(this,function(A){this.set("tracking",!1);A||(A=Error("LocateButton::Could not get tracking position."));this._locateError(A)}),this.get("geolocationOptions"));this.set("watchId",
v)},_removePrivateVars:function(){this._scale=this._position=this._graphic=null},_getCurrentPosition:function(){var v=new e;this._removePrivateVars();var A=setTimeout(D.hitch(this,function(){clearTimeout(A);v.reject(Error("LocateButton::time expired for getting location."))}),this.get("timeout"));navigator.geolocation.getCurrentPosition(D.hitch(this,function(B){B=this._positionToObject(B);clearTimeout(A);this._setPosition(B).then(D.hitch(this,function(E){v.resolve(E)}),D.hitch(this,function(E){E||
(E=Error("LocateButton::Error setting map position."));v.reject(E)}))}),D.hitch(this,function(B){B||(B=Error("LocateButton::Could not get current position."));v.reject(B)}),this.get("geolocationOptions"));return v.promise},_locate:function(){var v=new e;this._showLoading();if(navigator.geolocation)this.get("useTracking")?this.get("tracking")?(this._startTracking(),v.resolve({tracking:!0})):(this._stopTracking(),v.resolve({tracking:!1})):this._getCurrentPosition().then(D.hitch(this,function(B){this._locateEvent(B);
v.resolve(B)}),D.hitch(this,function(B){B||(B=Error("LocateButton::Could not get current position."));this._locateError(B);v.reject(B)}));else{var A=Error("LocateButton::geolocation unsupported");this._locateError(A);v.reject(A)}this._setTitle();return v.promise},_projectPoint:function(v){var A=new e,B=this.get("map").spatialReference,E=B.wkid;B.isWebMercator()?(v=w.geographicToWebMercator(v),A.resolve(v)):r.defaults.geometryService&&4326!==E?(E=new l,E.geometries=[v],E.outSR=B,r.defaults.geometryService.project(E).then(D.hitch(this,
function(G){G&&G.length?A.resolve(G[0]):A.reject(Error("LocateButton::Point was not projected."))}),function(G){G||(G=Error("LocateButton::please specify a geometry service on esri/config to project."));A.reject(G)})):A.resolve(v);return A.promise},_getScale:function(v){var A=this.get("scale");return v&&v.coords?A||v.coords.accuracy||5E4:A||5E4},_createPoint:function(v){var A;v&&v.coords&&(A=new t([v.coords.longitude,v.coords.latitude],new C({wkid:4326})));return A},_setPosition:function(v){var A=
new e,B,E;this._removePrivateVars();if((this._position=v)&&v.coords){if(B=this._createPoint(v))this._graphic=E=this._createGraphic(B,v);var G=this._getScale(v);this._scale=G;B?this._projectPoint(B).then(D.hitch(this,function(I){this._graphic=E=this._createGraphic(I,v);var L={graphic:E,scale:G,position:v};this.get("setScale")&&this.get("map").setScale(G);this.get("centerAt")?this.get("map").centerAt(I).then(D.hitch(this,function(){A.resolve(L)}),D.hitch(this,function(K){K||(K=Error("LocateButton::Could not center map."));
A.reject(K)})):A.resolve(L)}),D.hitch(this,function(I){I||(I=Error("LocateButton::Error projecting point."));A.reject(I)})):(B=Error("LocateButton::Invalid point"),A.reject(B))}else B=Error("LocateButton::Invalid position"),A.reject(B);return A.promise},_createGraphic:function(v,A){if(v){var B={position:A};B=new u(v,this.get("symbol"),B,this.get("infoTemplate"))}return B},_locateEvent:function(v){if(v.graphic){var A=this.get("highlightGraphic"),B=this.get("graphicsLayer");A?(A.setGeometry(v.graphic.geometry),
A.setAttributes(v.graphic.attributes),A.setInfoTemplate(v.graphic.infoTemplate),A.setSymbol(v.graphic.symbol)):(A=v.graphic,this.get("highlightLocation")&&(B?B.add(A):this.get("map").graphics.add(A)));this.set("highlightGraphic",A)}this._hideLoading();this.emit("locate",v)},_locateError:function(v){v={graphic:this._graphic,scale:this._scale,position:this._position,error:v};this._hideLoading();this.emit("locate",v)},_showLoading:function(){this.get("useTracking")||h.add(this._locateNode,this._css.loading)},
_hideLoading:function(){this.get("useTracking")||h.remove(this._locateNode,this._css.loading)},_init:function(){this._visible();this._setTitle();this.get("tracking")&&this.get("useTracking")&&this._locate();this.set("loaded",!0);this.emit("load",{})},_updateThemeWatch:function(v,A,B){h.remove(this.domNode,A);h.add(this.domNode,B)},_visible:function(){this.get("visible")?g.set(this.domNode,"display","block"):g.set(this.domNode,"display","none")}});D.setObject("dijit.LocateButton",F,y);return F})},
"esri/main":function(){define(["./kernel","dojo/i18n!./nls/jsapi","./config","./sniff"],function(F,m){F.bundle=m;return F})},"url:esri/core/request/iframe.html":'\x3c!DOCTYPE html\x3e\r\n\x3chtml\x3e\r\n\x3chead\x3e\r\n  \x3cmeta http-equiv\x3d"Content-Security-Policy" content\x3d"default-src \'none\'; script-src * \'unsafe-inline\'"\x3e\r\n\r\n  \x3cscript\x3e\r\n    var dojoConfig \x3d {\r\n      async: true,\r\n      baseUrl: "../../../dojo/",\r\n      has: {\r\n        "csp-restrictions": true,\r\n        "dojo-preload-i18n-Api": false\r\n      }\r\n    };\r\n  \x3c/script\x3e\r\n  \x3c!--\r\n  This src is relative to this page and assumes dojo is a sibling to esri.\r\n  It is updated when this file is set as the iframe\'s `srcdoc` value.\r\n  --\x3e\r\n  \x3cscript src\x3d"../../../dojo/dojo.js"\x3e\x3c/script\x3e\r\n\r\n  \x3cscript\x3e\r\n    function windowMessageHandler(event) {\r\n      window.removeEventListener("message", windowMessageHandler);\r\n\r\n      var port \x3d event.ports[0];\r\n\r\n      require([\r\n        "dojo/request/script"\r\n      ], function(script) {\r\n        port.postMessage("ready");\r\n\r\n        port.addEventListener("message", function(event) {\r\n          var data \x3d event.data;\r\n          script.get(data.url, data.options)\r\n              .then(function(response) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  response: response\r\n                });\r\n              })\r\n              .otherwise(function(error) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  isError: true,\r\n                  message: error.message\r\n                });\r\n              });\r\n        });\r\n        port.start();\r\n      });\r\n    }\r\n\r\n    window.addEventListener("message", windowMessageHandler);\r\n  \x3c/script\x3e\r\n\x3c/head\x3e\r\n\x3cbody\x3e\r\n\x3c/body\x3e\r\n\x3c/html\x3e\r\n',
"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/ComboButton.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tcellspacing\x3d\'0\' cellpadding\x3d\'0\' role\x3d"presentation"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point\x3d"buttonNode" data-dojo-attach-event\x3d"ondijitclick:__onClick,onkeydown:_onButtonKeyDown"\r\n\t\t\x3e\x3cdiv id\x3d"${id}_button" class\x3d"dijitReset dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitButtonText" id\x3d"${id}_label" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd id\x3d"${id}_arrow" class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'\r\n\t\t\tdata-dojo-attach-point\x3d"_popupStateNode,focusNode,_buttonNode"\r\n\t\t\tdata-dojo-attach-event\x3d"onkeydown:_onArrowKeyDown"\r\n\t\t\ttitle\x3d"${optionsTitle}"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonInner" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonChar" role\x3d"presentation"\x3e\x26#9660;\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd style\x3d"display:none !important;"\r\n\t\t\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" data-dojo-attach-point\x3d"valueNode"\r\n\t\t\t\tclass\x3d"dijitOffScreen" aria-hidden\x3d"true" data-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\t/\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:esri/dijit/editing/templates/Editor.html":'\x3cdiv class\x3d"esriEditor"\x3e\r\n    \x3cdiv class\x3d"esriTemplatePicker" dojoAttachPoint\x3d"templatePickerDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriDrawingToolbar" dojoAttachPoint\x3d"drawingToolbarDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"progressBar" dojoAttachPoint\x3d"progressBar" indeterminate\x3d"true" dojoType\x3d"dijit.ProgressBar" /\x3e\r\n\x3c/div\x3e',"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:esri/dijit/templates/Directions.html":'\x3cdiv class\x3d"${options.theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_widgetContainer" class\x3d"${_css.widgetContainerClass}" role\x3d"presentation"\x3e\r\n        \x3cdiv class\x3d"${_css.stopsContainerClass}" role\x3d"presentation"\x3e\r\n            \x3cdiv id\x3d"search-source-container" class\x3d"${_css.searchSourceContainerClass}" data-dojo-attach-point\x3d"_searchSourceContainerNode"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_searchSourceSelectorContainer"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"${_css.stopsTableContainerClass}"\x3e\r\n                \x3ctable class\x3d"${_css.stopsClass}" data-dojo-attach-point\x3d"_dndNode"\x3e\x3c/table\x3e\r\n                \x3cdiv class\x3d"${_css.stopsTableCoverClass}" data-dojo-attach-point\x3d"_stopsTableCover"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"${_css.stopsButtonContainerClass}"\x3e\r\n                \x3cdiv class\x3d"${_css.stopsAddDestinationClass}"\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"_activateButtonNode" title\x3d"${_i18n.widgets.directions.activate}" class\x3d"${_css.activateButtonClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass} ${_css.stopsPressedButtonClass}" data-blur-on-click\x3d"true"\x3e\x3c/div\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"_lineBarrierButtonNode" title\x3d"${_i18n.widgets.directions.lineBarrier}" class\x3d"${_css.lineBarrierButtonClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true"\x3e\x3c/div\x3e\r\n                    \x3cdiv role\x3d"button" tabindex\x3d"0" class\x3d"${_css.linkButtonClass} ${_css.stopsAddDestinationBtnClass}" data-dojo-attach-point\x3d"_addDestinationNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.addDestination}\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.travelModesContainerClass}" data-dojo-attach-point\x3d"_travelModeContainerNode"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_travelModeSelectorContainer"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} startTimeMenuButton" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_startTimeButtonNodeContainer"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_startTimeButtonNode"\x3e\r\n                        \x3cspan data-dojo-attach-point\x3d"_startTimeButtonLabel"\x3e${_i18n.widgets.directions.leaveNow}\x3c/span\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_startTimeDDLArrow" class\x3d"esriDirectionsDDLArrow"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"startTimeMenu" data-dojo-attach-point\x3d"_startTimeMenu"\x3e\r\n                        \x3cul role\x3d"menu"\x3e\r\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuLeaveNow" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio" aria-checked\x3d"true"\x3e${_i18n.widgets.directions.leaveNow}\x3c/li\x3e\r\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuDepartAt" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio"\x3e${_i18n.widgets.directions.departAt}\x3c/li\x3e\r\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuNone" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio"\x3e${_i18n.widgets.directions.noStartTime}\x3c/li\x3e\r\n                        \x3c/ul\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} ${_css.stopsOptionsButtonClass}" data-dojo-attach-point\x3d"_optionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.showOptions}\x3c/div\x3e\r\n            \t\x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"departAtContainer" data-dojo-attach-point\x3d"_departAtContainer"\x3e\r\n                    \x3cdiv id\x3d"${id}_directionsDepartAtTime" data-dojo-attach-point\x3d"_departAtTimeContainer"\x3e\x3c/div\x3e\r\n                    \x3cdiv id\x3d"${id}_directionsDepartAtDate" data-dojo-attach-point\x3d"_departAtDateContainer"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv role\x3d"presentation" class\x3d"${_css.stopsOptionsMenuClass}" data-dojo-attach-point\x3d"_optionsMenuNode"\x3e\r\n                \x3cdiv class\x3d"${_css.stopsOptionsCheckboxesClass}"\x3e\r\n                    \x3cul\x3e\r\n                        \x3cli class\x3d"${_css.stopsFindOptimalOrderClass}" data-dojo-attach-point\x3d"_findOptimalOrderItemNode"\x3e\x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_findOptimalOrderNode" type\x3d"checkbox" id\x3d"${id}_find_optimal_order" /\x3e\x3clabel for\x3d"${id}_find_optimal_order"\x3e${_i18n.widgets.directions.findOptimalOrder}\x3c/label\x3e\x3c/li\x3e\r\n                        \x3cli class\x3d"${_css.stopsReturnToStartClass}" data-dojo-attach-point\x3d"_returnToStartItemNode"\x3e\x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_returnToStartNode" type\x3d"checkbox" id\x3d"${id}_stopsReturnToStart" /\x3e\x3clabel for\x3d"${id}_stopsReturnToStart"\x3e${_i18n.widgets.directions.returnToStart}\x3c/label\x3e\x3c/li\x3e\r\n                        \x3cli class\x3d"${_css.stopsUseTrafficClass}" data-dojo-attach-point\x3d"_useTrafficItemNode" title\x3d"${_i18n.widgets.directions.trafficLabelLive}"\x3e\r\n                            \x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_useTrafficNode" type\x3d"checkbox" id\x3d"${id}_stopsUseTraffic" /\x3e\x3clabel for\x3d"${id}_stopsUseTraffic"\x3e${_i18n.widgets.directions.useTraffic}\x3c/label\x3e\r\n                            \x3ca data-dojo-attach-point\x3d"_trafficAvailabilityButton" style\x3d"display: none;" href\x3d"http://www.arcgis.com/home/item.html?id\x3db7a893e8e1e04311bd925ea25cb8d7c7" target\x3d"_blank"\x3e\x3cdiv class\x3d"esriTrafficAvailabilityButton" title\x3d"${_i18n.widgets.directions.seeTrafficAvailability}"\x3e\x3c/div\x3e\x3c/a\x3e\r\n                        \x3c/li\x3e\r\n                    \x3c/ul\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.stopsOptionsToggleContainerClass}"\x3e\r\n                    \x3cdiv class\x3d"${_css.stopsOptionsUnitsContainerClass}"  data-dojo-attach-point\x3d"_agolDistanceUnitsNode"\x3e\r\n                        \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsOptionsUnitsMiClass} ${_css.stopsButtonClass}" data-dojo-attach-point\x3d"_useMilesNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.units.esriMiles.abbr}\x3c/div\x3e\r\n                        \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsOptionsUnitsKmClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabLastClass} ${_css.stopsPressedButtonClass}" data-dojo-attach-point\x3d"_useKilometersNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.units.esriKilometers.abbr}\x3c/div\x3e\r\n                        \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"${_css.stopsGetDirectionsContainerClass}"\x3e\r\n                \x3cdiv class\x3d"getDirectionsBtnContainer"\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsButtonClass} ${_css.stopsGetDirectionsClass} esriDisabledDirectionsButton" data-dojo-attach-point\x3d"_getDirectionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.getDirections}\x3c/div\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} ${_css.stopsClearDirectionsClass}" data-dojo-attach-point\x3d"_clearDirectionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.clearDirections}\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"savePrintBtnContainer" data-dojo-attach-point\x3d"_savePrintBtnContainer"\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.resultsSaveClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_saveMenuButton" title\x3d"${_i18n.widgets.directions.saveTitle}" \x3e\x3c/div\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.resultsPrintClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_printButton" title\x3d"${_i18n.widgets.directions.print}" \x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv role\x3d"presentation" class\x3d"${_css.stopsOptionsMenuClass} esriSaveContainer" data-dojo-attach-point\x3d"_saveMenuNode"\x3e\r\n                \x3cdiv class\x3d"esriLayerNameLabel"\x3e${_i18n.widgets.directions.layerName}\x3c/div\x3e\r\n                \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_outputLayerContainer"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_folderSelectorContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsButtonClass} esriSaveButton esriDisabledDirectionsButton" data-dojo-attach-point\x3d"_saveButton" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.save}\x3c/div\x3e\r\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"esriLinkButton esriSaveAsButton" data-dojo-attach-point\x3d"_saveAsButton" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.saveAs}\x3c/div\x3e\r\n            \x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n    \t\x3cdiv data-dojo-attach-point\x3d"_msgNode" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.resultsContainerClass}" role\x3d"presentation"\x3e\r\n        \t\x3cdiv class\x3d"${_css.routesContainerClass}" data-dojo-attach-point\x3d"_resultsNode" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/Geocoder.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv class\x3d"${_css.GeocoderContainerClass}" role\x3d"presentation"\x3e\r\n    \t\x3cdiv class\x3d"${_css.GeocoderClass}" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\r\n    \t\t\x3cdiv title\x3d"${_i18n.widgets.Geocoder.main.searchButtonTitle}" tabindex\x3d"0" class\x3d"${_css.searchButtonClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"submitNode" role\x3d"button"\x3e\x3c/div\x3e\r\n    \t\t\x3cdiv aria-haspopup\x3d"true" id\x3d"${id}_menu_button" title\x3d"${_i18n.widgets.Geocoder.main.geocoderMenuButtonTitle}" tabindex\x3d"0" class\x3d"${_css.geocoderMenuArrowClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"geocoderMenuArrowNode" role\x3d"button" aria-expanded\x3d"false"\x3e\x3c/div\x3e\r\n    \t\t\x3cinput aria-haspopup\x3d"true" id\x3d"${id}_input" tabindex\x3d"0" placeholder\x3d"" value\x3d"${value}" autocomplete\x3d"off" type\x3d"text" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n    \t\t\x3cdiv tabindex\x3d"0" class\x3d"${_css.clearButtonClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"clearNode" role\x3d"button"\x3e\x3c/div\x3e\r\n    \t\t\x3cdiv class\x3d"${_css.GeocoderClearClass}" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.resultsContainerClass}" data-dojo-attach-point\x3d"resultsNode" aria-labelledby\x3d"${id}_input" role\x3d"menu" aria-hidden\x3d"true"\x3e\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.geocoderMenuClass}" data-dojo-attach-point\x3d"geocoderMenuNode" role\x3d"presentation"\x3e\r\n    \t\t\x3cdiv class\x3d"${_css.geocoderMenuHeaderClass}"\x3e\r\n    \t\t\t${_i18n.widgets.Geocoder.main.geocoderMenuHeader}\r\n    \t\t\t\x3cdiv role\x3d"button" data-dojo-attach-point\x3d"geocoderMenuCloseNode" title\x3d"${_i18n.widgets.Geocoder.main.geocoderMenuCloseTitle}" tabindex\x3d"0" class\x3d"${_css.geocoderMenuCloseClass}"\x3e\x3c/div\x3e\r\n    \t\t\t\x3cdiv class\x3d"${_css.GeocoderClearClass}" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\t\x3c/div\x3e\r\n    \t\t\x3cdiv data-dojo-attach-point\x3d"geocoderMenuInsertNode" aria-labelledby\x3d"${id}_menu_button" role\x3d"menu" aria-hidden\x3d"true"\x3e\x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/OverviewMap.html":'\x3cdiv class\x3d"esriOverviewMap"\x3e\r\n  \x3cdiv class\x3d"ovwContainer" dojoattachpoint\x3d"_body" style\x3d"width: ${width}px; height: ${height}px;"\x3e\r\n    \x3cdiv id\x3d"${id}-map" style\x3d"width: 100%; height: 100%;"\x3e\r\n      \x3cdiv class\x3d"ovwHighlight" dojoattachpoint\x3d"_focusDiv" title\x3d"${NLS_drag}" style\x3d"border: 1px solid ${color}; background-color: ${color};"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"ovwButton ovwController" title\x3d"${NLS_show}" dojoattachpoint\x3d"_controllerDiv" dojoattachevent\x3d"onclick: _visibilityHandler"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"ovwButton ovwMaximizer" title\x3d"${NLS_maximize}" dojoattachpoint\x3d"_maximizerDiv" dojoattachevent\x3d"onclick: _maximizeHandler"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/TimeSlider.html":'   \x3cdiv class\x3d"esriTimeSlider"\x3e\r\n   \x3ctable width\x3d"100%" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e\r\n   \x3ctr\x3e\r\n   \x3ctd align\x3d"right" valign\x3d"middle"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsPlayButton" dojoAttachEvent\x3d"onClick:_onPlay" dojoAttachPoint\x3d"playPauseBtn" type\x3d"button"\x3e${NLS_play}\x3c/button\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"center" valign\x3d"middle" width\x3d"80%" class\x3d"tsTmp"\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"left" valign\x3d"middle" width\x3d"30"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsPrevButton" dojoAttachEvent\x3d"onClick:_onPrev" dojoAttachPoint\x3d"previousBtn" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"left" valign\x3d"middle"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsNextButton" dojoAttachEvent\x3d"onClick:_onNext" dojoAttachPoint\x3d"nextBtn" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\x3c/td\x3e\r\n   \x3c/tr\x3e    \r\n   \x3c/table\x3e\r\n   \x3c/div\x3e',
"url:esri/dijit/templates/MultidimensionalSlider_vertical.html":'\x3cdiv class\x3d"esriMdSliderVertical esriMdSliderPassive"\x3e\r\n  \x3ctable class\x3d"esriMdSliderTableVertical" data-dojo-attach-point\x3d"mdSliderTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"3" class\x3d"esriMdSliderInfoCellVertical"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dimensionInfo" class\x3d"esriMdSliderInfo"\x3e\r\n          \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"3" class\x3d"esriMdSliderCellVertical" data-dojo-attach-point\x3d"mdSliderCell"\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr  class\x3d"esriMdSliderPlayButtonRow"  data-dojo-attach-point\x3d"playPauseBtnRow"\x3e\r\n      \x3ctd class\x3d"esriMdSliderPrevButtonCell"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsPrevButton\'" data-dojo-attach-event\x3d"onClick:decrement" data-dojo-attach-point\x3d"prevBtn" type\x3d"button"\r\n                title\x3d"${_i18n.widgets.mdSlider.NLS_previous}"\x3e\r\n        \x3c/button\x3e\x3c/td\x3e\r\n      \x3ctd class\x3d"esriMdSliderPlayButtonCell"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsPlayButton\'" data-dojo-attach-event\x3d"onClick:_onPlay" data-dojo-attach-point\x3d"playPauseBtn" type\x3d"button"\r\n                title\x3d"${_i18n.widgets.mdSlider.NLS_play}"\x3e\r\n        \x3c/button\x3e\x3c/td\x3e\r\n      \x3ctd class\x3d"esriMdSliderNextButtonCell"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsNextButton\'" data-dojo-attach-event\x3d"onClick:increment" data-dojo-attach-point\x3d"nextBtn" type\x3d"button"\r\n                title\x3d"${_i18n.widgets.mdSlider.NLS_next}"\x3e\r\n        \x3c/button\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/MultidimensionalSlider_horizontal.html":'\x3cdiv class\x3d"esriMdSliderHorizontal"\x3e\r\n  \x3ctable class\x3d"esriMdSliderTableHorizontal"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol class\x3d"esriMdSliderHorizontalCol1"\x3e\r\n      \x3ccol\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd class\x3d"esriMdSliderDimensionInfoCellHorizontal" colspan\x3d"2"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dimensionInfo"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd align\x3d"right" valign\x3d"middle"\x3e\x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsPlayButton\'" data-dojo-attach-event\x3d"onClick:_onPlay" \r\n                                               data-dojo-attach-point\x3d"playPauseBtn" type\x3d"button" title\x3d"${_i18n.widgets.mdSlider.NLS_play}"\x3e\x3c/button\x3e\x3c/td\x3e\r\n      \x3ctd class\x3d"esriMdSliderCellHorizontal" data-dojo-attach-point\x3d"mdSliderCell"\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/BasemapGallery.html":'\x3cdiv class\x3d"esriBasemapGallery"\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"flowContainer"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:esri/dijit/templates/HomeButton.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv class\x3d"${_css.container}"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_homeNode" title\x3d"${_i18n.widgets.homeButton.home.title}" role\x3d"button" class\x3d"${_css.home}" tabindex\x3d"0"\x3e\x3cspan\x3e${_i18n.widgets.homeButton.home.button}\x3c/span\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/LocateButton.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv class\x3d"${_css.container}"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_locateNode" role\x3d"button" class\x3d"${_css.locate}" tabindex\x3d"0"\x3e\x3cspan\x3e${_i18n.widgets.locateButton.locate.button}\x3c/span\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"*now":function(F){F(['dojo/i18n!*preload*arcgisonline/nls/viewer*["ar","bg","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},
"*noref":1}});
define("arcgisonline/viewer",["dojo","dijit","dojox","dojo/require!esri/map,esri/dijit/Attribution,esri/IdentityManager,esri/SnappingManager,esri/tasks/identify,esri/tasks/geometry,esri/layers/FeatureLayer,esri/layers/CSVLayer,esri/layers/KMLLayer,esri/layers/GeoRSSLayer,esri/layers/WebTiledLayer,esri/layers/StreamLayer,esri/layers/osm,esri/layers/VectorTileLayer,esri/layers/wms,esri/layers/wmts,esri/layers/WFSLayer,esri/layers/ArcGISImageServiceVectorLayer,esri/tasks/locator,esri/virtualearth/VEGeocoder,esri/virtualearth/VETiledLayer,esri/dijit/editing/Editor,esri/dijit/editing/TemplatePicker,esri/dijit/Directions,esri/dijit/Geocoder,esri/dijit/OverviewMap,esri/dijit/Scalebar,esri/dijit/Legend,esri/dijit/TimeSlider,esri/dijit/MultidimensionalSlider,esri/dijit/BasemapGallery,esri/dijit/Popup,esri/dijit/HomeButton,esri/dijit/LocateButton,esri/dijit/Search"],function(F,
m,a){F.provide("arcgisonline.viewer");F.require("esri.map");F.require("esri.dijit.Attribution");F.require("esri.IdentityManager");F.require("esri.SnappingManager");F.require("esri.tasks.identify");F.require("esri.tasks.geometry");F.require("esri.layers.FeatureLayer");F.require("esri.layers.CSVLayer");F.require("esri.layers.KMLLayer");F.require("esri.layers.GeoRSSLayer");F.require("esri.layers.WebTiledLayer");F.require("esri.layers.StreamLayer");F.require("esri.layers.osm");F.require("esri.layers.VectorTileLayer");
F.require("esri.layers.wms");F.require("esri.layers.wmts");F.require("esri.layers.WFSLayer");F.require("esri.layers.ArcGISImageServiceVectorLayer");F.require("esri.tasks.locator");F.require("esri.virtualearth.VEGeocoder");F.require("esri.virtualearth.VETiledLayer");F.require("esri.dijit.editing.Editor");F.require("esri.dijit.editing.TemplatePicker");F.require("esri.dijit.Directions");F.require("esri.dijit.Geocoder");F.require("esri.dijit.OverviewMap");F.require("esri.dijit.Scalebar");F.require("esri.dijit.Legend");
F.require("esri.dijit.TimeSlider");F.require("esri.dijit.MultidimensionalSlider");F.require("esri.dijit.BasemapGallery");F.require("esri.dijit.Popup");F.require("esri.dijit.HomeButton");F.require("esri.dijit.LocateButton");F.require("esri.dijit.Search")});